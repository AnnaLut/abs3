Application Description: Вкладные операции
	Outline Version - 4.0.26
	Design-time Settings
.data VIEWINFO
0000: 6F00000004000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 00000000001D0100 002C000000020000 0003000000000000 00D7020000F8FFFF
0040: FFE2FFFFFF010000 0004000000F00400 00C7010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000000001 8002000200000000
0080: 000000000000002C 0000000000000001 000000FFFFFFFFFF FFFFFFF8FFFFFFE2
00A0: FFFFFF6400000064 00000051040000CF 0200000000000000 000000050000000F
00C0: 4170706C69636174 696F6E4974656D07 57696E646F777302 464708546F6F6C20
00E0: 4261720870624669 6C69616C00000000 0180020002000000 0000000000000000
0100: 2C00000000000000 01000000FFFFFFFF FFFFFFFFF8FFFFFF E2FFFFFF96000000
0120: 9600000083040000 0103000000000000 0000000005000000 0F4170706C696361
0140: 74696F6E4974656D 0757696E646F7773 0F66726D5F566964 6444657461696C73
0160: 0D4368696C642057 696E646F77730563 6D62425200000000
.enddata
.data DT_MAKERUNDLG
0000: 02000000001D513A 5C4241525339385C 4C4942524152595C 424152533031352E
0020: 6578651D513A5C42 41525339385C4C49 42524152595C4241 52533031352E646C
0040: 6C1D513A5C424152 5339385C4C494252 4152595C42415253 3031352E61706300
0060: 000101011D513A5C 4241525339385C4C 4942524152595C42 4152533031352E72
0080: 756E1D513A5C4241 525339385C4C4942 524152595C424152 533031352E646C6C
00A0: 1D513A5C42415253 39385C4C49425241 52595C4241525330 31352E6170630000
00C0: 01010123463A5C62 61727339385C4249 4E5C424152533031 36662E6170642E61
00E0: 70642E6170642019 463A5C6261727339 385C42494E5C4241 52533031352E646C
0100: 6C19463A5C626172 7339385C42494E5C 424152533031352E 6170630000010101
0120: 1D513A5C42415253 39385C4C49425241 52595C4241525330 31352E61706C1D51
0140: 3A5C424152533938 5C4C494252415259 5C42415253303135 2E646C6C1D513A5C
0160: 4241525339385C4C 4942524152595C42 4152533031352E61 70630000010101
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left:   -0.013"
			Top:    0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: 0418B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left:   4.15"
			Top:    1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left:   0.575"
			Top:    0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left:   6.388"
			Top:    0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		Dynalib: Absapi.apd
		Dynalib: Global.apd
		Dynalib: BARS016.APD 
		Dynalib: CC_DOC.APD
		Dynalib: Custacnt.apd
		Dynalib: OTCN.APD
		File Include: Winapi.apl
		File Include: GENLBUTN.APL
		File Include: Genlist.apl
		File Include: Gentbl.apl
		File Include: GENTBLS.APL
		File Include: GENTBLF.APL
		File Include: XSALCPT.APL
		File Include: XSALIMG.APL
		File Include: XSALSPL.APL
		File Include: VTCOMM.APL
		File Include: QCKTABS.APL
		File Include: VTTBLWIN.APL
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
			Date/Time: d
			Number: 00000
			Date/Time: dd-MM-yyyy
			Date/Time: dd/MM/yyyy
			Input: 99/99/9999
			Input: 99.99.9999
			Number: 00000000
			Date/Time: dd/MM/yyyy hh:mm
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
				! ! << Версія бібліотеки >>
				String: ApdNum   =  '16F'
				String: sLibraryVersion = ' від 21/05/2014.'
		Resources
		Variables
			Window Handle: hWin0
			Window Handle: hWinA
			Window Handle: hWin1
			Window Handle: hWin2
			Window Handle: hWin6
			Window Handle: hWin7
			Window Handle: hWin10
			Window Handle: hWin12
			Window Handle: hWin13
			Window Handle: hWin14
			Window Handle: hWin15
			Window Handle: hWin16
			Window Handle: hWin17
			Window Handle: hWin18
			Window Handle: hWin19
			Window Handle: hWin20
			!
			Window Handle: hWinV
			Window Handle: hWinVD
			Window Handle: hWinN
			Window Handle: hWinW 
			Window Handle: hWinP 
			Window Handle: hWinZ
			Window Handle: hWinZS
			Window Handle: hWinPI 
			Window Handle: hWinPR
			Window Handle: hWinTT
			Window Handle: hWinTB
			Window Handle: hWinTemplates
			Window Handle: hWinShDetails
			Window Handle: hWinField
			Window Handle: hWinUser
			Window Handle: hWinBranch
			Window Handle: hWinViddParams
			Boolean: bApdInited
			Number: nHaveTOBO
			Number: nFetchRes
		Internal Functions
			Function: IniBars016f
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: strPathToLangResources
					String: strLangId
					String: strFileName
				Actions
					If not bApdInited
						Set nHaveTOBO = GetGlobalOptionEx('HAVETOBO')
						!
						Set bStaticsAsWindows = TRUE
						Set strPathToLangResources = GetLangPath()
						Set strLangId = GetLang()
						Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars016f.lng"
						If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile(strFileName, strLangId))
							Call CurrentLangTable.Init()
							! ====================================================
							Call CurrentLangTable.AddAtom('cTAt','Внимание!')
							Call CurrentLangTable.AddAtom('cTErr','Ошибка!')
							Call CurrentLangTable.AddAtom('cTInfo','Информация')
							Call CurrentLangTable.AddAtom('cTQuestion','Вопрос')
							Call CurrentLangTable.AddAtom('cTIsp','Исполнитель')
							Call CurrentLangTable.AddAtom('cTVidd','Вид вклада')
							Call CurrentLangTable.AddAtom('cTKV','Валюта')
							Call CurrentLangTable.AddAtom('cTBS','Бал.счет')
							Call CurrentLangTable.AddAtom('cTFilial','Подразделение')
							Call CurrentLangTable.AddAtom('cTBranch','Отделение')
							! ====================================================
							! ITOG
							Call CurrentLangTable.AddAtom('ITOG.cTWndTitle','ПОРТФЕЛЬ депозитных  вкладов  населения за период с')
							Call CurrentLangTable.AddAtom('ITOG.cTWndTitle_','по')
							!
							Call CurrentLangTable.AddAtom('ITOG.sBRANCH',    'Код~подразделения')
							Call CurrentLangTable.AddAtom('ITOG.sBRANCHNAME','Название~подразделения')
							Call CurrentLangTable.AddAtom('ITOG.nISP','ФИО~исполнителя')
							Call CurrentLangTable.AddAtom('ITOG.nVID','Вид~вклада')
							Call CurrentLangTable.AddAtom('ITOG.nKV','Код~ВАЛ')
							Call CurrentLangTable.AddAtom('ITOG.sKV','ВАЛ')
							Call CurrentLangTable.AddAtom('ITOG.nBS','Бал.~счет')
							Call CurrentLangTable.AddAtom('ITOG.sOST1','Сумма~вкладов~на начало')
							Call CurrentLangTable.AddAtom('ITOG.RAT1','Средневзв.~ставка~на начало')
							Call CurrentLangTable.AddAtom('ITOG.sDOS1','Сумма Дт~оборотов~по вкладам')
							Call CurrentLangTable.AddAtom('ITOG.sKOS1','Сумма Кт~оборотов~по вкладам')
							Call CurrentLangTable.AddAtom('ITOG.sSAL1','Сумма~вкладов~на конец')
							Call CurrentLangTable.AddAtom('ITOG.RAT2','Средневзв.~ставка~на конец')
							Call CurrentLangTable.AddAtom('ITOG.sOST2','Сумма~начисл.%%~на начало ')
							Call CurrentLangTable.AddAtom('ITOG.sDOS2','Сумма Дт~оборотов~по начисл.%%')
							Call CurrentLangTable.AddAtom('ITOG.sKOS2','Сумма Кт~оборотов~по начисл.%%')
							Call CurrentLangTable.AddAtom('ITOG.sSAL2','Сумма~начисл.%%~на конец ')
							Call CurrentLangTable.AddAtom('ITOG.nKOL1','Кол-во~счетов~на начало')
							Call CurrentLangTable.AddAtom('ITOG.nKOL2','Открыто~счетов')
							Call CurrentLangTable.AddAtom('ITOG.nKOL3','Закрыто~ счетов')
							Call CurrentLangTable.AddAtom('ITOG.nKOL4','Кол-во~счетов~на конец ')
							! Button strTip
							Call CurrentLangTable.AddAtom('ITOG.cBTipIns','Порядок сортировки...')
							Call CurrentLangTable.AddAtom('ITOG.cBTipVidd','Общие параметры видов вкладов')
							Call CurrentLangTable.AddAtom('ITOG.cBTipSort','Ресурс по срокам погашения')
							! bg
							Call CurrentLangTable.AddAtom('ITOG.bgTbl1','Критерии формирования')
							Call CurrentLangTable.AddAtom('ITOG.bgDate','Задайте период')
							! tbl1
							Call CurrentLangTable.AddAtom('ITOG.tbl1.nSORT','Порядок')
							Call CurrentLangTable.AddAtom('ITOG.tbl1.sNAME','Разрез')
							Call CurrentLangTable.AddAtom('ITOG.tbl1.nFLAG','Отм')
							! ====================================================
							! tbl_Archive
							Call CurrentLangTable.AddAtom('tbl_Archive.cTWndTitle','Архив депозитов')
							Call CurrentLangTable.AddAtom('tbl_Archive.cTWndTitle1','Состояние депозитного портфеля на')
							! columns
							Call CurrentLangTable.AddAtom('tbl_Archive.nID','№~вклада')
							Call CurrentLangTable.AddAtom('tbl_Archive.sND','Номер~депозита')
							Call CurrentLangTable.AddAtom('tbl_Archive.sBRANCH','Код~отделения')
							Call CurrentLangTable.AddAtom('tbl_Archive.sNLS','Лиц.счет')
							Call CurrentLangTable.AddAtom('tbl_Archive.sKV','ВАЛ')
							Call CurrentLangTable.AddAtom('tbl_Archive.sNMK','Имя~вкладчика')
							Call CurrentLangTable.AddAtom('tbl_Archive.sS','Сумма~вклада')
							Call CurrentLangTable.AddAtom('tbl_Archive.sSN','Сумма~нач %')
							Call CurrentLangTable.AddAtom('tbl_Archive.sVID','Вид~вклада')
							Call CurrentLangTable.AddAtom('tbl_Archive.nPROC','%~ставка')
							Call CurrentLangTable.AddAtom('tbl_Archive.dDAT1','Дата~открытия~вклада')
							Call CurrentLangTable.AddAtom('tbl_Archive.dDAT2','Дата~окончания~вклада')
							Call CurrentLangTable.AddAtom('tbl_Archive.sNLSN','Лиц.счет~нач %')
							Call CurrentLangTable.AddAtom('tbl_Archive.nISP','Исп')
							Call CurrentLangTable.AddAtom('tbl_Archive.dDATF','Дата~закрытия~(фактич.)')
							Call CurrentLangTable.AddAtom('tbl_Archive.sDOS','Обороты~Дт')
							Call CurrentLangTable.AddAtom('tbl_Archive.sKOS','Обороты~Кт')
							! bg
							Call CurrentLangTable.AddAtom('tbl_Archive.bgVIDD','Вид вклада:')
							Call CurrentLangTable.AddAtom('tbl_Archive.bgDAT','Дата:')
							Call CurrentLangTable.AddAtom('tbl_Archive.bgBranch','Код отделения:')
							! Field strTip
							Call CurrentLangTable.AddAtom('tbl_Archive.cFTipVIDD','Код вида вклада')
							Call CurrentLangTable.AddAtom('tbl_Archive.cFTipBranch','Код отделения')
							! constants
							Call CurrentLangTable.AddAtom('tbl_Archive.cTAllBranch','Все подразделения')
							! ====================================================
							! dlg_AvtoExtendDat
							Call CurrentLangTable.AddAtom('dlg_AvtoExtendDat.cTWndTitle','Установка даты окончания переоформляемого вклада')
							Call CurrentLangTable.AddAtom('dlg_AvtoExtendDat.pbOk','Выбрать')
							! bg
							Call CurrentLangTable.AddAtom('dlg_AvtoExtendDat.bgDATT','Введите дату окончания вклада:')
							! message text
							Call CurrentLangTable.AddAtom('dlg_AvtoExtendDat.cTMessDat','Введенная дата превышает допустимую дату окончания вклада!')
							! ====================================================
							! dlg_CorrectDates
							Call CurrentLangTable.AddAtom('dlg_CorrectDates.cTWndTitle','Коррекция срока вклада')
							Call CurrentLangTable.AddAtom('dlg_CorrectDates.pbLook','Найти')
							Call CurrentLangTable.AddAtom('dlg_CorrectDates.pbOk','Выполнить')
							Call CurrentLangTable.AddAtom('dlg_CorrectDates.cTDone', 'Изменен срок вклада №')
							! bg
							Call CurrentLangTable.AddAtom('dlg_CorrectDates.bgParams','Задайте параметры')
							Call CurrentLangTable.AddAtom('dlg_CorrectDates.bgDPT_ID','№ вклада:')
							Call CurrentLangTable.AddAtom('dlg_CorrectDates.bgDAT_BEGIN','Дата начала:')
							Call CurrentLangTable.AddAtom('dlg_CorrectDates.bgDAT_END','Дата окончания:')
							Call CurrentLangTable.AddAtom('dlg_CorrectDates.bgDAT',     'Укажите новый срок вклада')
							Call CurrentLangTable.AddAtom('dlg_CorrectDates.bgCNTDUBL', 'Кол-во пролонгаций:')
							! ====================================================
							! dlg_Reason
							Call CurrentLangTable.AddAtom('dlg_Reason.cTWndTitle','Причина відхилення запиту')
							! bg
							Call CurrentLangTable.AddAtom('dlg_Reason.bgREASON','Вкажіть причину відхилення запиту:')
							! ====================================================
							! FG
							Call CurrentLangTable.AddAtom('FG.cTWndTitle','Формирование базы для Фонда гарантирования вкладов')
							! columns
							Call CurrentLangTable.AddAtom('FG.NPP','№~п/п')
							Call CurrentLangTable.AddAtom('FG.DAT','Дата~формиров.')
							Call CurrentLangTable.AddAtom('FG.MFO','МФО~банка')
							Call CurrentLangTable.AddAtom('FG.FIO','ФИО вкладчика')
							Call CurrentLangTable.AddAtom('FG.OKPO','Идентиф.код')
							Call CurrentLangTable.AddAtom('FG.OBL','Область')
							Call CurrentLangTable.AddAtom('FG.DST','Район')
							Call CurrentLangTable.AddAtom('FG.TOWN','Населенный~пункт')
							Call CurrentLangTable.AddAtom('FG.ADR','Адрес')
							Call CurrentLangTable.AddAtom('FG.PASP','Паспортные данные')
							Call CurrentLangTable.AddAtom('FG.DATZ','Дата~договора')
							Call CurrentLangTable.AddAtom('FG.ND','№~договора')
							Call CurrentLangTable.AddAtom('FG.KV','Код~вал')
							Call CurrentLangTable.AddAtom('FG.OST','Остаток~(коп)')
							Call CurrentLangTable.AddAtom('FG.OSTN','Остаток~начисл.%%')
							Call CurrentLangTable.AddAtom('FG.NLS','Лицевой счет')
							Call CurrentLangTable.AddAtom('FG.GAR','Гарант.~вкл.')
							! bg
							Call CurrentLangTable.AddAtom('FG.bgDAT','Дата формирования:')
							! Button strTip
							Call CurrentLangTable.AddAtom('FG.cBTipBank','Наполнить таблицу данными по Банку')
							Call CurrentLangTable.AddAtom('FG.cBTipFilial','Наполнить таблицу данными по Филиалам')
							Call CurrentLangTable.AddAtom('FG.cBTipAll','Просмотр Консолидированного отчета')
							Call CurrentLangTable.AddAtom('FG.cBTipReport','Печать Консолидированного отчета')
							! constants
							Call CurrentLangTable.AddAtom('FG.cTFiles','Список файлов от филиалов')
							! error text
							Call CurrentLangTable.AddAtom('FG.cTErrFileName','Неверное имя файла!')
							Call CurrentLangTable.AddAtom('FG.cTErrConnect','Ошибка подсоединения к Базе данных:')
							!
							Call CurrentLangTable.AddAtom('FG.cTAttention','Внимание!')
							Call CurrentLangTable.AddAtom('FG.cTConsolidDone','Возможно, не был принят файл VKLAD_FG.DBF. Продолжить?')
							! ====================================================
							! frm_BindFields
							Call CurrentLangTable.AddAtom('frm_BindFields.cTWndTitle','Допустимые доп.реквизиты для данного вида вклада')
							! tbl
							Call CurrentLangTable.AddAtom('frm_BindFields.tbl.colID','Код')
							Call CurrentLangTable.AddAtom('frm_BindFields.tbl.colOBZ','ОБЗ')
							Call CurrentLangTable.AddAtom('frm_BindFields.tbl.colNAME','ВЫБРАННЫЕ доп.реквизиты')
							! tbl2
							Call CurrentLangTable.AddAtom('frm_BindFields.tbl2.colID','Код')
							Call CurrentLangTable.AddAtom('frm_BindFields.tbl2.colNAME','ДОСТУПНЫЕ доп.реквизиты')
							! constants
							Call CurrentLangTable.AddAtom('frm_BindFields.cTUpdateObz','Изменен признак обязат-ти доп.реквизита')
							Call CurrentLangTable.AddAtom('frm_BindFields.cTForVidd','для вида вклада')
							Call CurrentLangTable.AddAtom('frm_BindFields.cTDropDR','Отвязан доп.реквизит')
							Call CurrentLangTable.AddAtom('frm_BindFields.cTFromVidd','от вида вклада')
							Call CurrentLangTable.AddAtom('frm_BindFields.cTAddDR','Привязан доп.реквизит')
							Call CurrentLangTable.AddAtom('frm_BindFields.cTToVidd','к виду вклада')
							! message text
							Call CurrentLangTable.AddAtom('frm_BindFields.cTMessObz','Доп.реквизит ОБЯЗАТЕЛЕН для заполнения?')
							! ====================================================
							! frm_BindTemplate
							Call CurrentLangTable.AddAtom('frm_BindTemplate.cTWndTitle','Допустимые шаблоны договоров для данного вида вклада')
							! tbl
							Call CurrentLangTable.AddAtom('frm_BindTemplate.tbl.colID','Код')
							Call CurrentLangTable.AddAtom('frm_BindTemplate.tbl.colNAME','ВЫБРАННЫЕ шаблоны')
							Call CurrentLangTable.AddAtom('frm_BindTemplate.tbl.colFLAG','Флаг')
							Call CurrentLangTable.AddAtom('frm_BindTemplate.tbl.cmbFLAGNAME','Наименование флага')
							! tbl2
							Call CurrentLangTable.AddAtom('frm_BindTemplate.tbl2.colID','Код')
							Call CurrentLangTable.AddAtom('frm_BindTemplate.tbl2.colNAME','ДОСТУПНЫЕ шаблоны')
							! constants
							Call CurrentLangTable.AddAtom('frm_BindTemplate.cTDropShablon','Отвязан шаблон')
							Call CurrentLangTable.AddAtom('frm_BindTemplate.cTFromvidd','от вида вклада')
							Call CurrentLangTable.AddAtom('frm_BindTemplate.cTAddShablon','Привязан шаблон')
							Call CurrentLangTable.AddAtom('frm_BindTemplate.cTToVidd','к виду вклада')
							! message text
							Call CurrentLangTable.AddAtom('frm_BindTemplate.cTMessFlag','Неверно указан код флага!')
							! ====================================================
							! frm_BindTts
							Call CurrentLangTable.AddAtom('frm_BindTts.cTWndTitle','Допустимые операции для данного вида вклада')
							! tbl
							Call CurrentLangTable.AddAtom('frm_BindTts.tbl.TT','Код')
							Call CurrentLangTable.AddAtom('frm_BindTts.tbl.NN','ВЫБРАННЫЕ операции')
							! tbl2
							Call CurrentLangTable.AddAtom('frm_BindTts.tbl2.TT2','Код')
							Call CurrentLangTable.AddAtom('frm_BindTts.tbl2.NN2','НЕ выбранные операции')
							! constants
							Call CurrentLangTable.AddAtom('frm_BindTts.cTDropTt','Отвязана операция')
							Call CurrentLangTable.AddAtom('frm_BindTts.cTFromVidd','от вида вклада')
							Call CurrentLangTable.AddAtom('frm_BindTts.cTAddTtt','Привязана операция')
							Call CurrentLangTable.AddAtom('frm_BindTts.cTToVidd','к виду вклада')
							! ====================================================
							! frm_BindUsers
							Call CurrentLangTable.AddAtom('frm_BindUsers.cTWndTitle','Пользователи, которым доступен для открытия данный вид вклада')
							! tbl
							Call CurrentLangTable.AddAtom('frm_BindUsers.tbl.colID','Код')
							Call CurrentLangTable.AddAtom('frm_BindUsers.tbl.colNAME','ВЫБРАННЫЕ пользователи')
							! tbl2
							Call CurrentLangTable.AddAtom('frm_BindUsers.tbl2.colID','Код')
							Call CurrentLangTable.AddAtom('frm_BindUsers.tbl2.colNAME','ДОСТУПНЫЕ пользователи')
							! constants
							Call CurrentLangTable.AddAtom('frm_BindUsers.cTDropUser','Отвязан пользователь')
							Call CurrentLangTable.AddAtom('frm_BindUsers.cTFromVidd','от вида вклада')
							Call CurrentLangTable.AddAtom('frm_BindUsers.cTAddUser','Привязан пользователь')
							Call CurrentLangTable.AddAtom('frm_BindUsers.cTToVidd','к виду вклада')
							! ====================================================
							! frm_BindBranches
							Call CurrentLangTable.AddAtom('frm_BindBranches.cTWndTitle',  'Подразделения банка, пользователям которого доступен для открытия данный вид вклада')
							Call CurrentLangTable.AddAtom('frm_BindBranches.tbl.colID',   'Код')
							Call CurrentLangTable.AddAtom('frm_BindBranches.tbl.colNAME', 'ВЫБРАННЫЕ подразделения')
							Call CurrentLangTable.AddAtom('frm_BindBranches.tbl2.colID',  'Код')
							Call CurrentLangTable.AddAtom('frm_BindBranches.tbl2.colNAME','ДОСТУПНЫЕ подразделения')
							! constants
							Call CurrentLangTable.AddAtom('frm_BindBranches.cTDropBranch','Отвязано подразделение')
							Call CurrentLangTable.AddAtom('frm_BindBranches.cTFromVidd',  'от вида вклада')
							Call CurrentLangTable.AddAtom('frm_BindBranches.cTAddBranch', 'Привязано подразделение')
							Call CurrentLangTable.AddAtom('frm_BindBranches.cTToVidd',    'к виду вклада')
							! ====================================================
							! frm_ShtrafDetails
							Call CurrentLangTable.AddAtom('frm_ShtrafDetails.cTWndTitle','Редактирование штрафа')
							Call CurrentLangTable.AddAtom('frm_ShtrafDetails.cbIsDiffSH','Тип штрафа зависит от срока вклада')
							Call CurrentLangTable.AddAtom('frm_ShtrafDetails.cbIsDiffSHTerm','Срок штрафной ставки зависит от срока вклада')
							Call CurrentLangTable.AddAtom('frm_ShtrafDetails.cbCruelShtraf','Если вклад не "вылежал" полный месяц - проценты не выплачиваются')
							! tblSHPeriod
							Call CurrentLangTable.AddAtom('frm_ShtrafDetails.tblSHPeriod.colFrom','C')
							Call CurrentLangTable.AddAtom('frm_ShtrafDetails.tblSHPeriod.colTo','По')
							Call CurrentLangTable.AddAtom('frm_ShtrafDetails.tblSHPeriod.colSHType','Тип штрафа')
							Call CurrentLangTable.AddAtom('frm_ShtrafDetails.tblSHPeriod.colValue','Значение')
							Call CurrentLangTable.AddAtom('frm_ShtrafDetails.tblSHPeriod.colSHTermType','Тип cрока штрафа')
							Call CurrentLangTable.AddAtom('frm_ShtrafDetails.tblSHPeriod.colSHTermValue','Значение~срока штрафа')
							! bg
							Call CurrentLangTable.AddAtom('frm_ShtrafDetails.bgSHType','Тип штрафа')
							Call CurrentLangTable.AddAtom('frm_ShtrafDetails.bgOstType','Тип вычисления остатка')
							Call CurrentLangTable.AddAtom('frm_ShtrafDetails.bgSrokType','Срок вычисляется в')
							Call CurrentLangTable.AddAtom('frm_ShtrafDetails.bgSHTermType','Срок штрафной ставки')
							! error text
							Call CurrentLangTable.AddAtom('frm_ShtrafDetails.cTErrSrok','Невозможно сделать обновления для поля срока')
							Call CurrentLangTable.AddAtom('frm_ShtrafDetails.cTErrOst','Невозможно сделать обновления для поля остатка')
							Call CurrentLangTable.AddAtom('frm_ShtrafDetails.cTErrUpdate','Невозможно сделать обновления для поля')
							Call CurrentLangTable.AddAtom('frm_ShtrafDetails.cTErrPeriod1','Неправильно указаны граничные значения в добавленных записях')
							Call CurrentLangTable.AddAtom('frm_ShtrafDetails.cTErrPeriod2','Неправильно указаны граничные значения для смежных периодов')
							Call CurrentLangTable.AddAtom('frm_ShtrafDetails.cTErrSHType','Невозможно сделать обновления для поля типа штрафа')
							Call CurrentLangTable.AddAtom('frm_ShtrafDetails.cTErrSHTermType','Невозможно сделать обновления для поля типа срока штрафа')
							! ====================================================
							! tbl_AvtoExtend
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cTWndTitle','Автопереоформление депозитных договоров')
							!
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cbCheckAll', 'Отметить все вклады')
							! columns
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cIsExtend','П')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cDeposit_id','№~вклада')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cND','Номер~депозита')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cRnk','РНК')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cKlient','Клиент')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cNls','Основной~счет')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cKv','Код~вал')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.sOst','Сумма~вклада')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cDaos','Дата открытия~вклада')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cVidd','Вид вклада')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cViddName','Вид вклада')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cTerm','Кол-во~переоформлений')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cPeriod_m','Срок вклада')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cPeriod_d','Срок вклада')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cDatBegin','Дата~начала')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cDatEnd','Дата~окончания')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cNewDatBegin','Новая дата~начала')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cNewDatEnd','Новая дата~окончания')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.dDatX','Граничная~дата')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cIr','Индивид.~% ставка')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cOp','Оп.')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cBr','Базовая~% ставка')
							! Button strTip
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cBTipDetails','Печать доп.соглашения')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cBTipRun','Выполнить переоформление отмеченных договоров')
							! message text  
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cTMessAvtoDep',      'Вы действительно хотите переоформить отмеченные вклады?')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cTMessFormDopSogl',  'Сформировать доп.соглашение к договору №')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cTMessFormDopCancel','Для отмены для всех нажмите ОТМЕНА')
							Call CurrentLangTable.AddAtom('tbl_AvtoExtend.cTAvtoDep',          'Автопереоформление депозита')
							! ====================================================
							! tbl_InsiderRequest
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cTWndTitle','Обробка запитів на зміну відсоткової ставки по вкладах інсайдерів')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cTWndTitle_','архів')
							! columns
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cDPT_ID','№ вкладу')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cRNK','Рег.№~клієнта')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cNMK','Прізвище, імя, по-батькові~клієнта')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cOKPO','Ідентифікац.~код')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cBONUS_RATE','Значения~ставки')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cRBRANCH_ID','Код підрозділу~замовника')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cRBRANCH_NAME','Підрозділ~замовника')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cRUSER_ID','Код~виконавця')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cRUSER_NAME','Виконавець~- замовник')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cRDATE','Дата~запиту')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cSBRANCH_ID','Код підрозділу~обробка')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cSBRANCH_NAME','Підрозділ~обробки')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cSUSER_ID','Код~виконавця')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cSUSER_NAME','Виконавець~обробка')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cSDATE','Дата~обробки')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cFL_DECLINE','Флаг~обробки')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cDECLINE_REASON','Причина~відмови')
							! Button strTip
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cBTipUpdate','Підтвердити запит')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cBTipDel','Відхилити запит')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cBTipDetails','Необроблені запити/Архів запитів')
							! message text
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cTMessAddBonus','ВВЕСТИ В ДІЮ бонусну відсоткову ставку')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cTMessVklad','по вкладу №')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cTMessKlient','клієнта')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cTMessDelBonus','ВІДХИЛИТИ бонусну відсоткову ставку')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cTMessUpdate','Ви дійсно бажаєте підтвердити відмічені запити?')
							Call CurrentLangTable.AddAtom('tbl_InsiderRequest.cTMessDel','Ви дійсно бажаєте відхилити відмічені запити?')
							! ====================================================
							! tbl_Resource
							Call CurrentLangTable.AddAtom('tbl_Resource.cTWndTitle','Привлеченный ресурс по срокам погашения')
							! columns
							Call CurrentLangTable.AddAtom('tbl_Resource.KV','Вал')
							Call CurrentLangTable.AddAtom('tbl_Resource.LCV','ISO')
							Call CurrentLangTable.AddAtom('tbl_Resource.MMDD','Год +Мес ')
							Call CurrentLangTable.AddAtom('tbl_Resource.DAT','Дата')
							Call CurrentLangTable.AddAtom('tbl_Resource.sS','Сумма')
							Call CurrentLangTable.AddAtom('tbl_Resource.BRANCH','Код~отделения')
							! Button strTip
							Call CurrentLangTable.AddAtom('tbl_Resource.cBTipSynchro','По Дням/Месяцам')
							! ====================================================
							! tbl_Shtraf
							Call CurrentLangTable.AddAtom('tbl_Shtraf.cTWndTitle','Настройка видов штрафов')
							! columns
							Call CurrentLangTable.AddAtom('tbl_Shtraf.colId','№ штрафа')
							Call CurrentLangTable.AddAtom('tbl_Shtraf.colName','Наименование штрафа')
							Call CurrentLangTable.AddAtom('tbl_Shtraf.colcmbPeriodType','Период задан ')
							Call CurrentLangTable.AddAtom('tbl_Shtraf.colcmbOstType','Тип вычисления остатка')
							! ====================================================
							! tbl_Vidd
							Call CurrentLangTable.AddAtom('tbl_Vidd.cTWndTitle','Виды договоров (вкладов)')
							! columns
							Call CurrentLangTable.AddAtom('tbl_Vidd.FLAG','Флаг~акт.')
							Call CurrentLangTable.AddAtom('tbl_Vidd.VIDD','Числ.~код')
							Call CurrentLangTable.AddAtom('tbl_Vidd.TYPE_COD','Симв.~код')
							Call CurrentLangTable.AddAtom('tbl_Vidd.KV','Код~ВАЛ')
							Call CurrentLangTable.AddAtom('tbl_Vidd.TYPE_NAME','Наименование')
							Call CurrentLangTable.AddAtom('tbl_Vidd.KOL', 'Есть~акт.~вклады')
							Call CurrentLangTable.AddAtom('tbl_Vidd.DURATION_M','Срок~вклада~в мес.')
							Call CurrentLangTable.AddAtom('tbl_Vidd.DURATION_D','Срок~вклада~в днях')
							Call CurrentLangTable.AddAtom('tbl_Vidd.sMIN_SUMM','Миним.~сумма~вклада')
							Call CurrentLangTable.AddAtom('tbl_Vidd.sLIMIT','Миним.~сумма~пополнения')
							Call CurrentLangTable.AddAtom('tbl_Vidd.FREQ','Период-ть~выплаты %%')
							Call CurrentLangTable.AddAtom('tbl_Vidd.FL_DUBL','Авто-~пролон-~гация')
							Call CurrentLangTable.AddAtom('tbl_Vidd.COMMENTS','Подробности')
							!
							Call CurrentLangTable.AddAtom('tbl_Vidd.TYPEID',       '№~типа')
							Call CurrentLangTable.AddAtom('tbl_Vidd.cmbTYPENAME',  'Тип~депозитного~договора')
							Call CurrentLangTable.AddAtom('tbl_Vidd.pbTypes',      'Показать/скрыть инф-цию о типах договоров')
							Call CurrentLangTable.AddAtom('tbl_Vidd.InvalidTypeId','Тип договора с указанным номером не существует!')
							!
							Call CurrentLangTable.AddAtom('tbl_Vidd.pbExport',             'Экспорт в SQL-сценарий') 
							Call CurrentLangTable.AddAtom('tbl_Vidd.GenScriptFailed',      'Ошибка экспорта вида вклада в сценарий')
							Call CurrentLangTable.AddAtom('tbl_Vidd.GenScriptFileOpenErr', 'Невозможно создать файл')
							Call CurrentLangTable.AddAtom('tbl_Vidd.GenScriptDone',        'Сценарий сохранен в')
							!
							! ====================================================
							! frm_ViddDetails
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTWndTitle','Карточка вида вклада')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTabs0','Основные параметры')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTabs1','Параметры начисления %%')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTabs2','Параметры возврата депозита')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTabs3','Доп.параметры')
							!
							! Call CurrentLangTable.AddAtom('frm_ViddDetails.cbFIX_DURAT','Фиксированная длительность')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.rbTermFix',  'Фиксированый строк')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.rbTermList', '1,2,..N')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.rbTermRange','Диапазон')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cbCOMPROC','Капитализация начисленных процентов')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cbFIXRATE','Фиксированная длительность')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cbAmortisation','Авансовый вклад')
							! !!!
							! Call CurrentLangTable.AddAtom('frm_ViddDetails.cb_',   'Ставка после окончания срока депозита')
							! Call CurrentLangTable.AddAtom('frm_ViddDetails.cbDUBL','АВТО-переоформление вклада, но не более')
							! Call CurrentLangTable.AddAtom('frm_ViddDetails.cb2620','Перенос на вклад "До востребования"')
							! Call CurrentLangTable.AddAtom('frm_ViddDetails.cbNO',  'Ни один их перечисленных вариантов')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cbProlong', 'Ставка после окончания срока')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cbExtent1', 'АВТО-переоформление')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cbExtent2', 'АВТО-переоформление(Web)')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cbPerekr',  'Перенос на технический вклад/счет')
							!
							! Button strTip
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cBTipUpdate',   'Изменить параметры вида договора')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cBTipRefresh',  'Перечитать')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cBTipTT',       'Допустимые операции для данного вида вклада')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cBTipTemplates','Допустимые шаблоны договоров для данного вида вклада')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cBTipFields',   'Допустимые доп.реквизиты для данного вида вклада')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cBTipUsers',    'Допустимые пользователи для данного вида вклада')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cBTipBranches', 'Допустимые подразделения для данного вида вклада')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cBTipTags',     'Значения доп.параметров для данного вида вклада')
							!
							!
							!
							!
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cBTipCancel','Завершить')
							! Field strTip
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipVIDD','Код вида вклада')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipTYPE_NAME','Наименование вида вклада')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipTYPE_COD','Тип вклада')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipKV','Код валюты вклада')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipCmbKV','Наименование валюты вклада')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipLCV','Наименование валюты вклада (ISO)')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipDURATION_M','Длительность в месяцах')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipDURATION_D','Длительность в днях')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipMIN_SUMM','Минимальная сумма вклада')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipBSD','Балансовый счет вклада')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipBSN','Балансовый счет начисленных процентов')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipBSA','Балансовый счет амортизации')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipLIMIT','Минимальная сумма пополнения')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipMAX_LIMIT','Максимальная сумма пополнения')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipSROK_ADD_M','Срок пополнения в месяцах')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipSROK_ADD_D','Срок пополнения в днях')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipDATN','Дата начала действия вида вклада')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipDATK','Дата окончания действия вида вклада')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipBASEY','Код базового года')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipCmbBASEY','Наименование базового года')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipFREQN','Код периодичности начисления %%')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipCmbFREQN','Периодичность начисления %%')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipMETR','Код метода расчета процентов')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipAMRMETR','Код метода амортизации процентов')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipCmbMETR','Наименование метода расчета процентов')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipCmbAMRMETR','Наименование метода амортизации процентов')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipTT','Код операции по начислению процентов')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipOST','Код метода расчета остатка')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipNLS7','Cчет расходов')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipFREQV','Код периодичности выплаты %%')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipCmbFREQV','Периодичность выплаты %%')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipBR','Код основной процентной ставки')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipCmbBR','Наименование основной процентной ставки')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipDAT_BRAT','Последняя дата установки основной процентной ставки')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipPROC','Актуальное значение основной процентной ставки')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipSTOP','Код штрафа')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipCmbSTOP','Наименование штрафа')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipBRW','Код процентной ставки для част.снятия')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipCmbBRW','Наименование процентной ставки для част.снятия')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipPROC_WD','Последнее значение процентной ставки пролонгации')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipDAT_WD','Последняя дата установки процентной ставки пролонгации')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipBRL','Код процентной ставки пролонгации')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipCmbBRL','Наименование процентной ставки пролонгации')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipDAT_BRAT_L','Последняя дата установки процентной ставки пролонгации')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipPROC_L','Актуальное значение процентной ставки пролонгации')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipTERM_DUBL','Максимальное количество автопереоформлений вклада')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipEXT','Код метода автопереоформления')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipCmbEXT','Метод автопереоформления')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipIDG','Код группы перекрытия')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipCmbIDG','Наименование группы перекрытия')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipIDS','Код схемы перекрытия')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipCmbIDS','Наименование схемы перекрытия')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipKODZ','Код каталогизированного зароса')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipCmbKODZ','Наименование каталогизированного зароса')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipFORMAT','Код формата')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipCmbFORMAT','Наименование формата')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipBR_BONUS','Код бонусной ставки')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipCmbBR_BONUS','Наименование бонусной процентной ставки')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cFTipBR_OP','Операция между основной и бонусной ставками')
							! bg
							Call CurrentLangTable.AddAtom('frm_ViddDetails.gboxBS','Балансовые счета')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.gboxVklad','Пополнение вклада')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.gboxProc1','Начисление %%')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.gboxProc2','Выплата %%')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.gboxProc3','%% ставка')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.gboxProc4','Досрочное расторжение')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.gboxDR1','Перекрытие счетов начисленных %%')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.gboxDR2','Печать выписки по вкладу')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.gboxDR3','Бонусные процентные ставки')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.gboxDR4','Комментарий')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgVIDD','Наименование вида вклада:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgKV','Валюта вклада:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgDURATION','Срок действия:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgDURATION_M','мес. +')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgDURATION_D','дней')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgMIN_SUMM','Минимальная сумма:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgBSD','Баланс.счет депозитного счета:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgBSN','Баланс.счет начисленных %%:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgBSA','Баланс.счет амортизац.%%:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgLIMIT','Миним.сумма пополнения:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgMAX_LIMIT','Максим.сумма пополнения:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgSROK_ADD','Срок пополнения:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgSROK_ADD_M','мес. +')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgSROK_ADD_D','дней')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgDATN','Период действия вида вклада:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgBASEY','Базовые параметры:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgFREQN','Периодичность начисления %%:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgMETR','Метод начисления:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgOST','Тип вычисления остатка:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgNLS7','Аналитический счет расходов:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgFREQV','Периодичность выплаты %%:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgBR','Процентная ставка по вкладу:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgSTOP','Штраф:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgBRW','Ставка для частичного снятия:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgTERM_DUBL','Макс.кол-во:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgBRL',      'Ставка до востребования:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgEXT',      'Метод изменения ставки:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgIDG','Группа перекрытия:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgIDS','Схема перекрытия:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgKODZ','Каталогизир.запрос:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgFORMAT','Формат отгрузки:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgBR_BONUS','Бонусная ставка:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.bgBR_OP','Операция:')
							! message text
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTMessViddUpdate','Изменены параметры вида вклада №')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTMessViddNotSave','Не удалось сохранить параметры вклада')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTMessViddNotGet','Не удалось получить код вида вклада!')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTMessViddNotCreate','Не удалось создать вид вклада')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTMessViddOpc',  'Не включена опция администрирования видов вкладов по пользователям!')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTMessViddOpcB', 'Не включена опция администрирования видов вкладов по подразделениям!')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTMessNext','Продолжить?')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTMessNotSetMIN_AUMM','Для данного вида вклада не установлена миним.сумма!')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTMessNotSetSTOP','Для данного вида вклада не установлен штраф!')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTMessNotSetBRL','Для данного вида вклада не установлена ставка пролонгации!')
							!
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTMessDuplTitle',    'Проверка уникальности вида вклада')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTMessDuplQuestion', 'Найдены дубли данного вида вклада:')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTMessDuplContinue', 'Продолжить сохранение параметров вида вклада?')
							!
							! error text
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTErrBS','Бал.счет отсутствует в плане счетов!')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTErrKODZ','Нет такого каталог.запроса')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTErrRekc','Ошибка заполнения реквизитов')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTErrExtMethod','Указан несуществующий метод!')
							! constants
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTViddUpdate','Изменен вид вклада')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTViddCreate','Создан вид вклада')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTOst0','Исключая последний день')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTOst1','Исключая первый и последний дни')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTRekv','Не заполнен реквизит')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTDURATION','Срок вида вклада')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTBR','Базовая ставка')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTBASEY','Базовый год')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTMETR',   'Метод начисления %%')
							Call CurrentLangTable.AddAtom('frm_ViddDetails.cTAMRMETR','Метод амортизации %%')
							! ====================================================
							! frm_ViddParams
							Call CurrentLangTable.AddAtom('frm_ViddParams.cTWndTitle',     'Дополнительные параметры вида вклада')
							Call CurrentLangTable.AddAtom('frm_ViddParams.dfTitle',        'Перечень дополнительных параметров для вида вклада')
							Call CurrentLangTable.AddAtom('frm_ViddParams.tbl.colTag',     'Код параметра')
							Call CurrentLangTable.AddAtom('frm_ViddParams.tbl.colValue',   'Значение параметра')
							Call CurrentLangTable.AddAtom('frm_ViddParams.tbl.colDescr',   'Описание параметра')
							! ====================================================
							! frm_ViddBonuses
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.cTWndTitle','Управление привязкой льгот к видам вкладов')
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.cTWndTitle0','Просмотр привязок льгот к видам вкладов')
							! Button strTip
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.cBTipRefresh','Перечитать данные')
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.cBTipFilter','Установить фильтр')
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.cBTipEdit','Параметры привязки')
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.cBTipAdd','Привязать')
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.cBTipCancel','Выйти')
							! tblViddSel
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.tblViddSel.colVId','№')
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.tblViddSel.colVCode','Симв.~код')
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.tblViddSel.colVName','Наименование~вида договора')
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.tblViddSel.colVActivity','Активность~вида договора')
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.tblViddSel.colRang','Ранг~привязки')
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.tblViddSel.colFinally','Признак~окончания~просмотра')
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.tblViddSel.colCondition','Условие привязки')
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.tblViddSel.colActivity','Активность~привязки')
							! tblViddAll
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.tblViddAll.colVId','№')
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.tblViddAll.colVCode','Симв.~код')
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.tblViddAll.colVName','Наименование~вида договора')
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.tblViddAll.colVActivity','Активность~вида договора')
							! bg
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.bgBonus','Льгота')
							! Constant
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.cTSetParamsOk','Установлены параметры привязки льготы')
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.cTSetParamsNo','Неуспешная попытка установить параметры привязки льготы')
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.cTSetParams',  'к виду договора')
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.cTViddSel','Привязанные виды договоров')
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.cTViddAll','Непривязанные виды договоров')
							Call CurrentLangTable.AddAtom('frm_ViddBonuses.cTViddFolter','фильтр')
							! ====================================================
							! dlg_ViddBonus
							Call CurrentLangTable.AddAtom('dlg_ViddBonus.cTWndTitle','Установка параметров привязки')
							Call CurrentLangTable.AddAtom('dlg_ViddBonus.cTWndTitle0','Просмотр параметров привязки')
							Call CurrentLangTable.AddAtom('dlg_ViddBonus.cbActivity','Признак активности привязки')
							Call CurrentLangTable.AddAtom('dlg_ViddBonus.cbFinally','Признак окончания просмотра')
							Call CurrentLangTable.AddAtom('dlg_ViddBonus.pbApplyForAll','Применить для всех')
							Call CurrentLangTable.AddAtom('dlg_ViddBonus.pbApply','Применить')
							! bg
							Call CurrentLangTable.AddAtom('dlg_ViddBonus.bgParams','Параметры привязки')
							Call CurrentLangTable.AddAtom('dlg_ViddBonus.bgRang','Ранг привязки льготы к виду договора (№ пп)')
							Call CurrentLangTable.AddAtom('dlg_ViddBonus.bgCondition','Условие привязки льготы к виду договора')
							! Constant
							Call CurrentLangTable.AddAtom('dlg_ViddBonus.cTTextCondition','Поле должно содержать SQL-запрос, который возвращает значение Y/N')
							! Err
							Call CurrentLangTable.AddAtom('dlg_ViddBonus.cTErrRang','Не заполнен Ранг привязки льготы к виду договора!')
							! ====================================================
							! frm_DptBonusRequest
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.cTWndTitle','Обработка запросов на полуние льгот по депозитным договорам ФЛ')
							! pb
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.pbVisa','Визировать')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.pbStorno','Сторнировать')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.pbAccept','Принять')
							! tblDpt
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblDpt.colDptId','Ид.~договора')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblDpt.colDptNum','Номер~договора')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblDpt.colDptDat','Дата~договора')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblDpt.colDptRate','Тек.%%~ставка')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblDpt.colCustId','Рег.№~клиента')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblDpt.colCustName','ФИО~клиента')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblDpt.colCustCode','Ид.код~клиента')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblDpt.colViddId','Ид.вида~вклада')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblDpt.colViddName','Наименование~вида вклада')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblDpt.colViddCode','Симв.код~вида вклада')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblDpt.colBranchId','Код~подразделения')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblDpt.colBranchName','Наименование~подразделения')
							! tblBonuses
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblBonuses.colDptId','Ид.~договора')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblBonuses.colBonusId','Ид.~льготы')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblBonuses.colBonusName','Наименование~льготы')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblBonuses.colBonusValPlan','Расчетная~льготная ставка')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblBonuses.colBonusValFact','Установленная~льготная ставка')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblBonuses.colReqStateId','Код статуса~запроса')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblBonuses.colReqStateName','Статус~запроса')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblBonuses.colReqAuto','Автомат.~формирование')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblBonuses.colReqConfirm','Необходимость~подтверждения')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblBonuses.colReqRecalc','Необходимость~перерасчета')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblBonuses.colReqDate','Дата форм.~запроса')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblBonuses.colReqUserId','Код пользователя-~инициатора запроса')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.tblBonuses.colReqUserName','ФИО пользователя-~инициатора запроса')
							! Constant
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.cTItogo','Итого')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.cTSetBonusRateRollback','Неуспешное выполнение процедуры расчета и установки бонусной %-ной ставки по договору')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.cTSetBonusRateCommit','Успешно выполнена процедура расчета и установки бонусной %-ной ставки по договору')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.cTDptRequestConfirmationRollbackAdd','Неуспешное выполнение процедуры подтверждения запроса на получение льготы')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.cTDptRequestConfirmationRollbackDel','Неуспешное выполнение процедуры удаления запроса на получение льготы')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.cTDptRequestConfirmationCommitAdd','Успешно выполнена процедура подтверждения запроса на получение льготы')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.cTDptRequestConfirmationCommitDel','Успешно выполнена процедура удаления запроса на получение льготы')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.cTDptRequestConfirmationDpt','по договору')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.cTRequestRecalculationCommit','Перерасчет значения льготы по договору')
							Call CurrentLangTable.AddAtom('frm_DptBonusRequest.cTRequestRecalculationRollback','Неуспешное выполнение процедуры перерасчета значения льготы по договору')
							! ====================================================
							! tbl_DptCommisReq
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.cTWndTitle','Обробка запитів за відміну комісій за оформлення додаткових угод до депозитних договорів ФО')
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.cTWndTitleArc','Архів запитів за відміну комісій за оформлення додаткових угод до депозитних договорів ФО')
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.pbVisa','Подтвердить запрос')
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.pbStorno','Отклонить запрос')
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.pbArc','Архив запросов')
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.pbArc_','Необработанные запросы')
							!
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.colReqId','Ид.~запроса')
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.colReqCrDate','Дата создания~запроса')
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.colReqCrUser','Пользователь,~созд. запрос')
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.colReqPrcDate','Дата подтв.~запроса')
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.colReqPrcUser','Пользователь,~подтв. запрос')
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.colDptId','Ид.~договора')
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.colDptNd','Номер~договора')
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.colDptDate','Дата закл.~договора')
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.colAgrmntType','Код типа~доп. соглашения')
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.colAgrmntTypeName','Тип~доп. соглашения')
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.colBranch','Код~подразделения')
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.colBranchName','Наименование~подразделения')
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.colReqState','Код~состояния~запроса')
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.colReqStateName','Состояние~запроса')
							! Constant
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.cTReqCheckCommitVisa','Успешно выполнена процедура подтверждения запроса на отмену комиссии по договору')
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.cTReqCheckCommitStorno','Успешно выполнена процедура отклонения запроса на отмену комиссии по договору')
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.cTReqCheckRollbackVisa','Неуспешное выполнение процедуры подтверждения запроса на отмену комиссии по договору')
							Call CurrentLangTable.AddAtom('tbl_DptCommisReq.cTReqCheckRollbackStorno','Неуспешное выполнение процедуры отклонения запроса на отмену комиссии по договору')
							! ====================================================
							! tbl_DptCreateChgIntDpt
							Call CurrentLangTable.AddAtom('tbl_DptCreateChgIntDpt.cTWndTitle','Создание запросов на изменение %% ставки по договору')
							Call CurrentLangTable.AddAtom('tbl_DptCreateChgIntDpt.colDptId','Ид.~вклада')
							Call CurrentLangTable.AddAtom('tbl_DptCreateChgIntDpt.colDptNd','Номер~вклада')
							Call CurrentLangTable.AddAtom('tbl_DptCreateChgIntDpt.colDptDat','Дата закл.~вклада')
							Call CurrentLangTable.AddAtom('tbl_DptCreateChgIntDpt.colCustName','ФИО клиента')
							Call CurrentLangTable.AddAtom('tbl_DptCreateChgIntDpt.colCustIdCode','Ид.код~клиента')
							Call CurrentLangTable.AddAtom('tbl_DptCreateChgIntDpt.colViddCode','Код вида~вклада')
							Call CurrentLangTable.AddAtom('tbl_DptCreateChgIntDpt.colViddName','Наименование~вида вклада')
							Call CurrentLangTable.AddAtom('tbl_DptCreateChgIntDpt.colDatBegin','Дата~начала')
							Call CurrentLangTable.AddAtom('tbl_DptCreateChgIntDpt.colDatEnd','Дата~окончания')
							Call CurrentLangTable.AddAtom('tbl_DptCreateChgIntDpt.colRate','%-ная~ставка')
							Call CurrentLangTable.AddAtom('tbl_DptCreateChgIntDpt.colFlag','Формувати')
							! Constant
							Call CurrentLangTable.AddAtom('tbl_DptCreateChgIntDpt.cTChgIntDptCommit','Успешно выполнена процедура формирования запроса на изменение %% ставкии по договору')
							Call CurrentLangTable.AddAtom('tbl_DptCreateChgIntDpt.cTChgIntDptRollback','Неуспешное выполнение процедуры формирования запроса на изменение %% ставкии по договору')
							! Msg
							Call CurrentLangTable.AddAtom('tbl_DptCreateChgIntDpt.cTMsgQuestionFormReq','Сформировать запрос на изменение %-ной ставки по договору')
							Call CurrentLangTable.AddAtom('tbl_DptCreateChgIntDpt.cTMsgDptNotSelected','Не отмечены договора для формирования запроса!')
							! ====================================================
							! dlg_DptSetIntDpt
							Call CurrentLangTable.AddAtom('dlg_DptSetIntDpt.cTWndTitle','Подтверждение запроса')
							Call CurrentLangTable.AddAtom('dlg_DptSetIntDpt.pbApply','Создать запрос')
							! bg
							Call CurrentLangTable.AddAtom('dlg_DptSetIntDpt.bgNewParams','Укажите новые реквизиты %-й ставки')
							Call CurrentLangTable.AddAtom('dlg_DptSetIntDpt.bgNewRate','Значение ставки')
							Call CurrentLangTable.AddAtom('dlg_DptSetIntDpt.bgExpDate','Граничная дата заключения доп. соглашения')
							! constant
							Call CurrentLangTable.AddAtom('dlg_DptSetIntDpt.cTCheckBrates','Не установлена %-я ставка!')
							Call CurrentLangTable.AddAtom('dlg_DptSetIntDpt.cTCheckExpDate','Не установлена граничная дата заключения доп. соглашения!')
							! ====================================================
							! frm_DptCreateChgIntVid
							Call CurrentLangTable.AddAtom('frm_DptCreateChgIntVid.cTWndTitle','Создание запросов на изменение %% ставки по виду договора')
							Call CurrentLangTable.AddAtom('frm_DptCreateChgIntVid.pbApply','Создать запрос')
							! bg
							Call CurrentLangTable.AddAtom('frm_DptCreateChgIntVid.bgVidd','Вид договора')
							Call CurrentLangTable.AddAtom('frm_DptCreateChgIntVid.bgCondition','Укажите условия для отбора договоров')
							Call CurrentLangTable.AddAtom('frm_DptCreateChgIntVid.bgBranch','Подразделение')
							Call CurrentLangTable.AddAtom('frm_DptCreateChgIntVid.bgDates','Диапазон открытия договоров')
							Call CurrentLangTable.AddAtom('frm_DptCreateChgIntVid.bgDatBegin','С')
							Call CurrentLangTable.AddAtom('frm_DptCreateChgIntVid.bgDatEnd','По')
							Call CurrentLangTable.AddAtom('frm_DptCreateChgIntVid.bgNewParams','Укажите новые реквизиты базовой ставки')
							Call CurrentLangTable.AddAtom('frm_DptCreateChgIntVid.bgBrates','Базовая ставка')
							Call CurrentLangTable.AddAtom('frm_DptCreateChgIntVid.bgBratesDate','Дата начала действия базовой %-ной ставки')
							Call CurrentLangTable.AddAtom('frm_DptCreateChgIntVid.bgExpDate','Граничная дата заключения доп. соглашения')
							! constant
							Call CurrentLangTable.AddAtom('frm_DptCreateChgIntVid.cTAllBranches','Все подразделения')
							Call CurrentLangTable.AddAtom('frm_DptCreateChgIntVid.cTCheckVidd','Не выбран вид договора!')
							Call CurrentLangTable.AddAtom('frm_DptCreateChgIntVid.cTCheckBrates','Не установлена базовая ставка!')
							Call CurrentLangTable.AddAtom('frm_DptCreateChgIntVid.cTCheckBratesDate','Не установлена дата начала действия базовой %-ной ставки!')
							Call CurrentLangTable.AddAtom('frm_DptCreateChgIntVid.cTCheckExpDate','Не установлена граничная дата заключения доп. соглашения!')
							Call CurrentLangTable.AddAtom('frm_DptCreateChgIntVid.cTChgIntVidCommit','Успешно выполнена процедура формирования запроса на изменение %% ставкии по виду договора')
							Call CurrentLangTable.AddAtom('frm_DptCreateChgIntVid.cTChgIntVidRollback','Неуспешное выполнение процедуры формирования запроса на изменение %% ставкии по виду договора')
							Call CurrentLangTable.AddAtom('frm_DptCreateChgIntVid.cTChgIntVidBranch','для подразделения')
							! Err
							Call CurrentLangTable.AddAtom('frm_DptCreateChgIntVid.cTErrVidd','Неизвестный код вида договора!')
							Call CurrentLangTable.AddAtom('frm_DptCreateChgIntVid.cTErrBrates','Неизвестный код базовой ставки!')
							! ====================================================
							! dlg_DptSetIntVid
							Call CurrentLangTable.AddAtom('dlg_DptSetIntVid.cTWndTitle','ППрогноз выполнения')
							Call CurrentLangTable.AddAtom('dlg_DptSetIntVid.pbApply','Создать запрос')
							! tblInfo
							Call CurrentLangTable.AddAtom('dlg_DptSetIntVid.tblInfo.colBranch','Подразделение')
							Call CurrentLangTable.AddAtom('dlg_DptSetIntVid.tblInfo.colBranchName','Название подразделения')
							Call CurrentLangTable.AddAtom('dlg_DptSetIntVid.tblInfo.colCountVidd','Количество~договоров')
							! constant
							Call CurrentLangTable.AddAtom('dlg_DptSetIntVid.cTItogo','Всего договоров')
							! ====================================================
							! tbl_DptChgIntReq
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.cTWndTitle','Обробка запитів на зміну %-х ставок')
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.cTWndTitleArc','Архів запитів на зміну %-х ставок')
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.pbStorno','Удалить запрос')
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.pbArc','Архив запросов')
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.pbArc_','Необработанные запросы')
							!
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.colReqId','Ид.~запроса')
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.colReqCrDate','Дата создания~запроса')
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.colReqCrUser','Пользователь,~создавший запрос')
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.colReqPrcDate','Дата подтв.~запроса')
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.colReqPrcUser','Пользователь,~подтв. запрос')
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.colDptId','Ид.~договора')
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.colDptNd','Номер~договора')
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.colDptDate','Дата закл.~договора')
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.colReqcType','Код типа~изменения~проц. ставки')
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.colReqcTypeName','Тип изменения~проц. ставки')
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.colReqcExpDate','Конечная дата~закл. сглашения')
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.colReqcOldInt','Текущее~значение~проц. ставки')
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.colReqcNewInt','Новое~значение~проц. ставки')
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.colReqcNewBr','Новая~базовая~проц. ставка')
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.colBranch','Код~подразделения')
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.colBranchName','Наименование~подразделения')
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.colReqState','Код~состояния~запроса')
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.colReqStateName','Состояние~запроса')
							! Constant
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.cTDeleteReqCommitStorno','Успешно выполнена процедура удаления запроса на изменение %% ставкии по договору')
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.cTDeleteReqRollbackStorno','Неуспешное выполнение процедуры удаления запроса на изменение %% ставкии по договору')
							! Msg
							Call CurrentLangTable.AddAtom('tbl_DptChgIntReq.cTMsgSetFilter','Укажите условие фильтра!')
							!
							! ====================================================
							! tbl_ZvitFiles
							! ====================================================
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.WindowTitle',      'Формирование и просмотр ZVIT-файлов')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl.colFILEID',      '№~файла')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl.colFILENAME',    'Имя~файла')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl.colFILEDATE',    'Дата~файла')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl.colFILEVERS',    'Версия~файла')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl.colDATRPT',      'Отчетная~дата')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl.colDATBEG',      'Начало~отч.периода')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl.colDATEND',      'Окончание~отч.периода')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl.colBNKMFO',      'МФО банка')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl.colINFCNT',      'Кол-во инф.строк')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl2.colACCNUM',     '№ счета')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl2.colKV',         '~Вал')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl2.colDATBEG',     'Дата~начала')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl2.colDATEND',     'Дата~окончания')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl2.colRATE',       'Процентная~ставка')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl2.colDK',         'Дт/~Кт')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl2.colAMOUNT',     'Сумма~номинал')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl2.colAMOUNTQ',    'Сумма~эквивалент')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl2.colR013',       '~R013')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl2.colVED',  	  '~K110')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl2.colISE', 	  '~K070')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl2.colS180', 	  '~S180')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl2.colREZID', 	  '~РЗД')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl2.colD020',  	  '~D020')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl2.colBRANCH',  	  'Код~отд.')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.tbl2.colBNKDATE',    'Дата~выполнения')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.FileMaket',          'макет нового файла')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.Total',              'Итого:')
							!
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.pbUpdate',           'Формирование ZVIT-файла')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.MakeZvitQuestion',   'Сформировать ZVIT-файл?')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.MakeZvitFileDone',   'Сформирован файл')          
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.MakeZvitFileFailed', 'Ошибка формирования файла')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.pbPrint',            'Выгрузка ZVIT-файла')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.ExportZvitQuestion', 'Выгрузить выделенный ZVIT-файл?')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.ExportDone',         'Файл выгружен в каталог')
							Call CurrentLangTable.AddAtom('tbl_ZvitFiles.OpenZvitFileFailed', 'Ошибка выгрузки файла') 
							! ====================================================
						Set bApdInited = TRUE
					! Call CurrentLangTable.SaveToFile('C:\\TEMP\\bars016f.lng','RUS')
					Return bApdInited
			Function: Sel016f			! __exported
				Description: Bars016_Selector
				Returns
				Parameters
					Window Handle: hWndParent
					Number: nMode
					Number: nPar
					String: strPar01
					String: strPar02
				Static Variables
				Local variables
				Actions
					Call IniBars016f()
					Select Case nMode
						Case 0  !! портфель руководителя
							If not IsWindow(hWin0)
								Set hWin0 = SalCreateWindow(ITOG, hWndMDI, nPar, strPar01, strPar02)
							Break
						Case 2  !! Настройка видов вкладов
							If not IsWindow(hWin2)
								Set hWin2 = SalCreateWindow(tbl_Vidd, hWndMDI, nPar)
							Break
						Case 5  !! Автопереоформление
							If not IsWindow(hWin1)
								Set hWin1 = SalCreateWindow(tbl_AvtoExtend, hWndMDI, nPar)
							Break
						Case 6  !! Архив депозитов
							If not IsWindow(hWin6)
								Set hWin6 = SalCreateWindow(tbl_Archive, hWndMDI, nPar, strPar01, strPar02)
							Break
						Case 7  !! Редактирование штрафов
							If not IsWindow(hWin7)
								Set hWin7 = SalCreateWindow(tbl_Shtraf, hWndMDI, nPar, strPar01 )
							Break
						Case 8  !! Корректировка дат вклада
							Call SalModalDialog(dlg_CorrectDates, hWndNULL, nPar)
							Break
						Case 10 !! Фонд гарантирования
							If not IsWindow(hWin10)
								Set hWin10 = SalCreateWindow(FG, hWndMDI, nPar, strPar01, strPar02)
							Break
						Case 13	!! Бонусы
							If not IsWindow(hWin13)
								Set hWin13 = SalCreateWindow(frm_ViddBonuses, hWndParent, nPar, strPar01, strPar02)
							Else
								Call SalBringWindowToTop(hWin13)
							Break
						Case 14	!! Обробка запитів на отримання пільг
							If not IsWindow(hWin14)
								Set hWin14 = SalCreateWindow(frm_DptBonusRequest, hWndParent, nPar, strPar01, strPar02)
							Else
								Call SalBringWindowToTop(hWin14)
							Break
						Case 15	!! Подтверждение запросов на отмену комиссии
							If not IsWindow(hWin15)
								Set hWin15 = SalCreateWindow(tbl_DptCommisReq, hWndParent, nPar, strPar01, strPar02)
							Else
								Call SalBringWindowToTop(hWin15)
							Break
						Case 16	!! Подтверждение запросов на изменение %% ставки
							If not IsWindow(hWin16)
								Set hWin16 = SalCreateWindow(tbl_DptChgIntReq, hWndParent, nPar, strPar01, strPar02)
							Else
								Call SalBringWindowToTop(hWin16)
							Break
						Case 17	!! Инд.
							If not IsWindow(hWin17)
								Set hWin17 = SalCreateWindow(tbl_DptCreateChgIntDpt, hWndParent, nPar, strPar01, strPar02)
							Else
								Call SalBringWindowToTop(hWin17)
							Break
						Case 18	!! по виду договора
							If not IsWindow(hWin18)
								Set hWin18 = SalCreateWindow(frm_DptCreateChgIntVid, hWndParent, nPar, strPar01, strPar02)
							Else
								Call SalBringWindowToTop(hWin18)
							Break
						Case 19	!! Формирование ZVIT-файлов по переоформленным вкладам 
							If not IsWindow(hWin19)
								Set hWin19 = SalCreateWindow(tbl_ZvitFiles, hWndParent, nPar, strPar01, strPar02)
							Else
								Call SalBringWindowToTop(hWin19)
							Break
						Case 20	!! Історія змін кодів базових ставок по видам банківських продуктів
							If not IsWindow(hWin20)
								Set hWin20 = SalCreateWindow( tbl_HistChgViddBRID, hWndParent, strPar01 )
							Else
								Call SalBringWindowToTop( hWin20 )
							Break
						Default
							Break
			Function: F_VIDD
				Description:
				Returns
					Number:
				Parameters
					Number: nVid
					Number: nEdit
					Window Handle: hWndFormParent
				Static Variables
				Local variables
				Actions
					If not IsWindow(hWinVD)
						Set hWinVD = SalCreateWindow(frm_ViddDetails, hWndMDI, nVid, nEdit, hWndFormParent)
			Function: DptGetDateClose		! __exported
				Description: Возвращает дату окончания договора
				Returns
					Date/Time:
				Parameters
					Date/Time: OpenDate !! начальная дата
					Number: mDuration   !! период в мес 
					Number: dDuration   !! период в днях
				Static Variables
				Local variables
					Date/Time: CloseDate
					Number: nFetchRes
				Actions
					If mDuration=NUMBER_Null
						Set mDuration=0
					If dDuration=NUMBER_Null
						Set dDuration=0
					If mDuration=0 AND dDuration=0
						Return DATETIME_Null
					If SqlPrepareAndExecute(hSql(), 
							   "SELECT bars.dpt.f_duration(:OpenDate,:mDuration,:dDuration) 
							    INTO :CloseDate FROM dual")
							and SqlFetchNext(hSql(),nFetchRes)
						Return CloseDate
					Return DATETIME_Null
			Function: CreateDepDoc			! __exported
				Description: Изготовление депозитного договора
				Returns
					Number:
				Parameters
					! № договора
					Number: nND
					! Код вида вклада
					Number: nID
				Static Variables
				Local variables
					String: sTemplateId
					Long String: sDoc
					Number: nFetchRes
					Boolean: fExists
					String: sTmp
					: cCnc
						Class: cABSConnect
					: cCnc2
						Class: cABSConnect
					Number: nADD
					Boolean: bADD
				Actions
					! Выбираем вид шаблон
						! If nID and SqlPrepareAndExecute( hSql(),
								    "SELECT v.shablon
								     INTO :sTemplateId
								     FROM dpt_deposit d, dpt_vidd v
								     WHERE d.deposit_id=:nID and v.vidd=d.vidd" )
								and SqlFetchNext(hSql(), nFetchRes)
						! Else
							                                                                                                                                                                                                                                                                                            Return 0
					If nID
						If NOT cdoc_SelectDocTemplate("DPT_DOCS", "ID", "NAME", 
								  " ID IN ( SELECT ID FROM DPT_VIDD_SCHEME WHERE VIDD=" ||
								  SalNumberToStrX(nID, 0) || " )", sTemplateId)
							Return 0
						If sTemplateId
							! Получаем документ из шаблона
							Call XConnectGetParams(cCnc)
							If cCnc.Connect() and cCnc2.Clone(cCnc, TRUE)
								Set sDoc=cdoc_CreateDocFromTemplate(cCnc.hSql(), cCnc2.hSql(), sTemplateId,  nND, 0)
								If sDoc
									! Показываем документ с редактированием
									If cdoc_ShowDoc(sDoc, TRUE, FALSE) != 3
										! Сохраняем документ в БД
										Set bADD = (Subs(sTemplateId,1,7) = 'DPT_ADD')
										! Если доп.соглашение - вычисляем его номер
										If bADD
											If SqlPrepareAndExecute(hSql(), 
													"SELECT TO_CHAR(NVL(MAX(adds),0)+1) INTO :nADD
													 FROM cc_docs WHERE id LIKE 'DPT_ADD%' AND nd=:nND ") AND 
													not SqlFetchNext(hSql(), nFetchRes)
												Set nADD=0
											If NOT cdoc_SetDocText(hSql(), TRUE,
													  sTemplateId, nND, nADD, DATETIME_Null, sDoc)
												Call SqlRollback(hSql())
											Else
												Call SqlCommitEx(hSql(), 'Текст доп.соглашения № ' || SalNumberToStrX(nID,0) || '/' || SalNumberToStrX(nADD,0) || ' сохранен в БД!')
											! If SqlPrepare(hSql(), 'INSERT INTO CC_DOCS (id,nd,text,adds)
													 VALUES (:sTemplateId,:nND,:sDoc,:nADD)' )
												                                                                                                                                                                                                                              If SqlSetLongBindDatatype( 3, 23 )
													                                                                                                                                                                                                                              If SqlExecute( hSql() )
										Else
											If NOT cdoc_SetDocText(hSql(), TRUE,
													  sTemplateId, nND, 0, DATETIME_Null, sDoc)
												Call SqlRollback(hSql())
											Else
												Call SqlCommitEx(hSql(), 'Текст договора № ' || SalNumberToStrX(nID,0) || ' сохранен в БД!')
											! If SqlPrepare( hSql(), 'INSERT INTO CC_DOCS (id,nd,text,adds)
													 VALUES (:sTemplateId,:nND,:sDoc,0)' )
												                                                                                                                                                                                                                              If SqlSetLongBindDatatype( 3, 23 )
													                                                                                                                                                                                                                              If SqlExecute( hSql() )
														                                                                                                                                                                                                                              Call SqlCommitEx( hSql(), 'Текст договора № ' || SalNumberToStrX(nID,0) || ' сохранен в БД!' )
														! Return 1
								Call cCnc.Disconnect()
								Call cCnc2.Disconnect()
						Else
							Return 0
						!
			Function: CreateDepAddDoc               ! __exported
				Description: Изготовление доп.соглашений для депозитного договора
				Returns
					Number:
				Parameters
					! № договора
					Number: nND 
					! Вид вклада
					Number: nID 
					! Тип: доп.согл. на изменение ост.(=S)\%ставки(=P)\сроков(=D)
					String: sTYPE  
				Static Variables
				Local variables
					Number: nFetchRes
					String: sTmp
					String: sTemplateId
					Long String: sDoc
					Boolean: fExists
					: cCnc
						Class: cABSConnect
					: cCnc2
						Class: cABSConnect
					Number: nADD
				Actions
					If sTYPE = 'S'
						If nID
							If NOT cdoc_SelectDocTemplate("DPT_DOCS", "ID", "NAME", 
									  " ID IN ( SELECT ID FROM DPT_VIDD_SCHEME WHERE ID LIKE '%ADD_SUM%' AND VIDD=" ||
									  SalNumberToStrX(nID, 0) || " )", sTemplateId)
								Return 0
							If sTemplateId
								Call XConnectGetParams(cCnc)
								If cCnc.Connect() and cCnc2.Clone(cCnc, TRUE)
									Set sDoc=cdoc_CreateDocFromTemplate(cCnc.hSql(), cCnc2.hSql(), sTemplateId,  nND, 0)
									If sDoc
										If cdoc_ShowDoc(sDoc, TRUE, FALSE) != 3
											If SqlPrepareAndExecute(hSql(), 
													 "SELECT TO_CHAR(NVL(MAX(adds),0)+1) INTO :nADD
													  FROM cc_docs WHERE id LIKE 'DPT_ADD%' AND nd=:nND ") AND 
													not SqlFetchNext(hSql(), nFetchRes)
												Set nADD=1
											If NOT cdoc_SetDocText(hSql(), TRUE,
													  sTemplateId, nND, nADD, DATETIME_Null, sDoc)
												Call SqlRollback(hSql())
											Else
												Call SqlCommitEx(hSql(), 'Текст доп.соглашения № ' || SalNumberToStrX(nID,0) || '/' ||SalNumberToStrX(nADD,0) || ' сохранен в БД!')
											! If SqlPrepare( hSql(), 'INSERT INTO CC_DOCS (id,nd,text,adds)
													 VALUES (:sTemplateId,:nND,:sDoc,:nADD)' )
												                                                                                                                                                                                                                              If SqlSetLongBindDatatype( 3, 23 )
													                                                                                                                                                                                                                              If SqlExecute( hSql() )
														                                                                                                                                                                                                                              Call SqlCommitEx( hSql(), 'Текст доп.соглашения № ' || SalNumberToStrX(nID,0) ||'/'||SalNumberToStrX(nADD,0) ||' сохранен в БД!' )
									Call cCnc.Disconnect()
									Call cCnc2.Disconnect()
							Else
								Return 0
					Else If sTYPE='D'
						If nID
							If NOT cdoc_SelectDocTemplate("DPT_DOCS", "ID", "NAME", 
									  " ID IN ( SELECT ID FROM DPT_VIDD_SCHEME WHERE ID LIKE '%ADD_SROK%' AND VIDD=" ||
									  SalNumberToStrX(nID, 0) || " )", sTemplateId)
								Return 0
							If sTemplateId
								Call XConnectGetParams(cCnc)
								If cCnc.Connect() and cCnc2.Clone(cCnc, TRUE)
									Set sDoc = cdoc_CreateDocFromTemplate(cCnc.hSql(), cCnc2.hSql(), sTemplateId,  nND, 0)
									If sDoc
										If cdoc_ShowDoc(sDoc, TRUE, FALSE) != 3
											If SqlPrepareAndExecute(hSql(), 
													  " SELECT TO_CHAR(NVL(MAX(adds),0)+1) INTO :nADD
													  FROM cc_docs WHERE id LIKE 'DPT_ADD%' AND nd=:nND ") AND 
													not SqlFetchNext(hSql(), nFetchRes)
												Set nADD=1
											If NOT cdoc_SetDocText(hSql(), TRUE,
													  sTemplateId, nND, nADD, DATETIME_Null, sDoc)
												Call SqlRollback(hSql())
											Else
												Call SqlCommitEx(hSql(), 'Текст доп.соглашения № ' || SalNumberToStrX(nID,0) || '/' || SalNumberToStrX(nADD,0) || ' сохранен в БД!')
											! If SqlPrepare( hSql(), 'INSERT INTO CC_DOCS (id,nd,text,adds)
													 VALUES (:sTemplateId,:nND,:sDoc,:nADD)' )
												                                                                                                                                                                                                                              If SqlSetLongBindDatatype( 3, 23 )
													                                                                                                                                                                                                                              If SqlExecute( hSql() )
														! Call SqlCommitEx( hSql(), 'Текст доп.соглашения № ' || SalNumberToStrX(nID,0) || ' сохранен в БД!' )
														                                                                                                                                                                                                                              Call SqlCommitEx( hSql(), 'Текст доп.соглашения № ' || SalNumberToStrX(nID,0) ||'/'||SalNumberToStrX(nADD,0) ||' сохранен в БД!' )
									Call cCnc.Disconnect()
									Call cCnc2.Disconnect()
							Else
								Return 0
					Else
						If nID
							If NOT cdoc_SelectDocTemplate("DPT_DOCS", "ID", "NAME", 
									  " ID IN ( SELECT ID FROM DPT_VIDD_SCHEME WHERE ID LIKE '%ADD_PROC%' AND VIDD=" ||
									  SalNumberToStrX(nID, 0) || " )", sTemplateId)
								Return 0
							If sTemplateId
								Call XConnectGetParams(cCnc)
								If cCnc.Connect() and cCnc2.Clone(cCnc, TRUE)
									Set sDoc=cdoc_CreateDocFromTemplate(cCnc.hSql(), cCnc2.hSql(), sTemplateId,  nND, 0)
									If sDoc
										If cdoc_ShowDoc(sDoc, TRUE, FALSE) != 3
											If SqlPrepareAndExecute(hSql(), 
													"SELECT TO_CHAR(NVL(MAX(adds),0)+1) INTO :nADD
													 FROM cc_docs WHERE id LIKE 'DPT_ADD%' AND nd=:nND ") AND 
													not SqlFetchNext(hSql(), nFetchRes)
												Set nADD=1
											If NOT cdoc_SetDocText(hSql(), TRUE,
													  sTemplateId, nND, nADD, DATETIME_Null, sDoc)
												Call SqlRollback(hSql())
											Else
												Call SqlCommitEx(hSql(), 'Текст доп.соглашения № ' || SalNumberToStrX(nID,0) || '/' ||SalNumberToStrX(nADD,0) || ' сохранен в БД!')
											! If SqlPrepare( hSql(), 'INSERT INTO CC_DOCS (id,nd,text,adds)
													 VALUES (:sTemplateId,:nND,:sDoc,:nADD)' )
												                                                                                                                                                                                                                              If SqlSetLongBindDatatype( 3, 23 )
													                                                                                                                                                                                                                              If SqlExecute( hSql() )
														! Call SqlCommitEx( hSql(), 'Текст доп.соглашения № ' || SalNumberToStrX(nID,0) || ' сохранен в БД!' )
														                                                                                                                                                                                                                              Call SqlCommitEx( hSql(), 'Текст доп.соглашения № ' || SalNumberToStrX(nID,0) ||'/'||SalNumberToStrX(nADD,0) ||' сохранен в БД!' )
									Call cCnc.Disconnect()
									Call cCnc2.Disconnect()
							Else
								Return 0
			Function: QuotedStr
				Description: !! << Добавляєм одинарні кавички на початку та в кінці строки >>
				Returns
					String:
				Parameters
					String: sString
				Static Variables
				Local variables
				Actions
					Return (Chr(39) || sString || Chr(39))
			Function: get_OneStringValue
				Description: ф-я повертає результат виконання переданого запиту в строку sResult
				Returns
					String:
				Parameters
					String: sSqlText
				Static Variables
				Local variables
					Number: nFetchRes
					String: sResult
				Actions
					If SqlPrepareAndExecute( hSql(), sSqlText ) AND NOT SqlFetchNext(hSql(), nFetchRes)
						Set sResult = STRING_Null
					Return sResult
			Function: get_LibraryVersion
				Description: Показати версію бібліотеки
				Returns
				Parameters
				Static Variables
				Local variables
					String: sPackageVersion
				Actions
					Set sPackageVersion = get_OneStringValue( "SELECT SubStr(dpt.header_version, 9, 37) || SubStr(dpt.body_version, 9, 35) 
							|| SubStr(dpt_web.header_version, 9, 41) || SubStr(dpt_web.body_version, 9, 41)
							|| SubStr(dpt_utils.header_version,  9, 42) || SubStr(dpt_utils.body_version,  9, 40) INTO :sResult FROM dual" )
					Call SalMessageBox ( 'Модуль: Депозити ФО' || Chr(10) ||
							                                             'Версія: '|| sLibraryVersion || Chr(10) ||
							                                              'PL/SQL: ' || Chr(10) ||  sPackageVersion,
							                                             'Aboute', MB_Ok )
			!
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 25218691
0000: 37010000A2000000 0000000000000000 0200000200FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F22003C00 000A630047656E46
0040: 696C746500727400 00000400001E0002 0400C10001000000 3F8001F800000037
0060: 040001F00D000000 FF1F110000DC0002 00FF7F1570000000 0100FFFF21018022
0080: 000001C200000B63 47F8444669B30004 00770200F601004F 800100FE008D0400
00A0: 010DFD00FF371100 02F700FFDF15DC00 0100FF7F
.enddata
			Column Class: cGenColComboBoxX_StrId
				Title:
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				List in Tool Palette? Yes
				Property Template:
				Class DLL Name:
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				Description:
				Derived From
					Class: cGenList_StrId
				Class Variables
				Instance Variables
				Functions
				List Values
				Message Actions
			Column Class: cGenColComboBoxX_NumId
				Title:
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				List in Tool Palette? Yes
				Property Template:
				Class DLL Name:
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				Description:
				Derived From
					Class: cGenList_NumId
				Class Variables
				Instance Variables
				Functions
				List Values
				Message Actions
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton: cpbAttachedButton
			Radio Button:
			Option Button:
			Check Box: cCheckBoxLabeled
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box: cGenComboBox_NumId
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control: cXSalVSplitterInvisible
		Application Actions
	Table Window: tbl_Vidd
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Виды договоров (вкладов)
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.47"
				Top:    0.2"
				Width:  12.633"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 20000
			Discardable? Class Default
		Description: Виды вкладов
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call F_VIDD(NUMBER_Null, 2, hWndForm)
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 60955
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If nEdit = 0
								Set nTmp = 0
							Else If tbl_Vidd.FLAG = 1 OR tbl_Vidd.KOL > 0
								Set nTmp = 1
							Else
								Set nTmp = 2
							Call F_VIDD(tbl_Vidd.VIDD, nTmp, hWndForm)
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 60956
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Option Button: pbTypes
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.017"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\BOOKS.BMP
					Picture Transparent Color: None
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nShowTypeCol = 1 - nShowTypeCol
							If nShowTypeCol = 0
								Call SalHideWindow (TYPEID)
								Call SalHideWindow (cmbTYPENAME)
							Else
								Call SalShowWindow (TYPEID)
								Call SalShowWindow (cmbTYPENAME)
						On SAM_TooltipSetText
							! показать/скрыть инф-цию о типах договоров 
							Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('tbl_Vidd.pbTypes'))
				Pushbutton: pbExport
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSynchro
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.65"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\saved.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_TooltipSetText
							! экспорт в SQL-сценарий
							Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('tbl_Vidd.pbExport'))
						On SAM_Click
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(tbl_Vidd, nRow, ROW_Selected, 0)
								Call SalTblSetContext(tbl_Vidd, nRow)
								If tbl_Vidd.VIDD != NUMBER_Null
									Call GenScript (tbl_Vidd.VIDD)
							Call SalTblClearSelection(tbl_Vidd)
				Line
					Resource Id: 60957
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.3"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 46680
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  5.167"
						Begin Y:  -0.012"
						End X:  5.167"
						End Y:  0.452"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Line
					Resource Id: 23996
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  5.85"
						Begin Y:  -0.012"
						End X:  5.85"
						End Y:  0.452"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbVERSION
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbHelp
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.967"
						Top:    0.07"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call get_LibraryVersion()
		Contents
			Column: FLAG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Флаг
						акт.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VIDD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Числ.
						код
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.657"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TYPE_COD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Симв. 
						код 
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 4
				Data Type: String
				Justify: Left
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TYPEID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: № 
						типа
				Visible? Class Default
				Editable? Yes
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  0.667"
				Width Editable? Class Default
				Format: #0
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_Validate
						Call cmbTYPENAME.SetSelectById(TYPEID)
						If cmbTYPENAME.nCurrentId >= 0
							Call SalSendMsg(cmbTYPENAME, SAM_Click, 0, 0)
							Return VALIDATE_Ok
						Else
							! Тип договора с указанным номером не существует!
							Call SalMessageBox(CurrentLangTable.GetAtomTitle('tbl_Vidd.InvalidTypeId'), 
									                   CurrentLangTable.GetAtomTitle('cTErr'), 
									                   MB_IconStop)
							Return VALIDATE_Cancel
			Column: cmbTYPENAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_NumId
				Property Template:
				Class DLL Name:
				Title: Тип
						депозитного
						договора
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  1.817"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_Create
						Call SalTblSetColumnTitle(tbl_Vidd.cmbTYPENAME, CurrentLangTable.GetAtomTitle('tbl_Vidd.cmbTYPENAME'))
						Call cmbTYPENAME.Init(hWndItem)
						Call cmbTYPENAME.Populate(hSql(), "TYPE_ID", "TYPE_NAME", "DPT_TYPES", "ORDER BY SORT_ORD")
						Call cmbTYPENAME.SetSelectById(TYPEID)
						Call SalListSetSelect(hWndItem, 0)
						Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
					On SAM_AnyEdit
						Set TYPEID = cmbTYPENAME.GetKey(SalListQuerySelection(cmbTYPENAME))
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						ВАЛ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TYPE_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Наименование 
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOL    
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Есть
						акт.
						вклады
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DURATION_M       
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Срок
						вклада
						в мес.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.717"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DURATION_D       
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Срок
						вклада
						в днях
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.717"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MIN_SUMM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Миним.
						сумма
						вклада
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.083"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sMIN_SUMM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Миним.
						сумма
						вклада
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: LIMIT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Миним.
						сумма
						пополнения
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sLIMIT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Миним.
						сумма
						пополнения
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FREQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Период-ть
						выплаты %%
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FL_DUBL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Авто-
						пролон-
						гация
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
			Column: COMMENTS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Подробности
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  4.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DIG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: DIG
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: GenScript
				Description: выгрузка вида вклада в сценарий
				Returns
				Parameters
					Number: nVidd
				Static Variables
				Local variables
					Number: nExpId
					Number: nLength
					File Handle: hFile
					String: sFileName
					Long String: sText
					Number: i
				Actions
					If NOT SqlPLSQLCommand(hSql(), "dpt_utils.gen_script4vidd(nVidd)")
						! Ошибка экспорта вида вклада в сценарий
						Call SalMessageBox(CurrentLangTable.GetAtomTitle('tbl_Vidd.GenScriptFailed'),
								                   CurrentLangTable.GetAtomTitle('cTErr'),
								                   MB_IconStop)
						Call SqlRollback(hSql())
						Return FALSE
					If SqlPrepareAndExecute(hSql(),
							   "SELECT clobleng
							      INTO :nLength
							      FROM tmp_expdptype
							     WHERE modcode = 'DPT'
							       AND typeid  = to_char(:nVidd)")
							   AND SqlFetchNext(hSql(), nFetchRes)
						If nLength > 0
							Set sFileName = GetPrnDir()
									             || IifS(Right(GetPrnDir(), 1) = '\\', '', '\\')
									             || 'dptype_'||Str(nVidd)||'.sql'
							If NOT SalFileOpen(hFile, sFileName, OF_Create|OF_Write|OF_Text)
								! Невозможно создать файл sFileName
								Call SalMessageBox(CurrentLangTable.GetAtomTitle('tbl_Vidd.GenScriptFileOpenErr')||' '||sFileName,
										                   CurrentLangTable.GetAtomTitle('cTErr'),
										                   MB_IconStop)
								Call SqlRollback(hSql())
								Return FALSE
							Call SqlSetLongBindDatatype(1, 22)
							Set i = 1
							While i <= nLength
								Call SqlPrepareAndExecute(hSql(),
										"SELECT dbms_lob.substr((SELECT clobdata
										                           FROM tmp_expdptype
										                          WHERE modcode = 'DPT'
										                            AND typeid  = to_char(:nVidd)),
										                 2000,
										                 :i)
										   INTO :sText
										   FROM dual")
								Call SqlFetchNext(hSql(), nFetchRes)
								Call SalFileSeek (hFile, i - 1, FILE_SeekBegin)
								Call SalFileWrite(hFile, sText, Len(sText))
								Set i = i + 2000
							Call SalFileClose(hFile)
							! Сценарий сохранен в sFileName
							Call SalMessageBox(CurrentLangTable.GetAtomTitle('tbl_Vidd.GenScriptDone')||' '||sFileName,
									                   CurrentLangTable.GetAtomTitle('cTInfo'),
									                   MB_IconInformation|MB_Ok)
					Call SqlCommit(hSql())
		Window Parameters
			Number: nEdit
			! 0 - только просмотр
			! 1 - по обстоятельствам
		Window Variables
			Number: nTmp
			Number: nRow
			Number: nMaxDig
			Number: nLastSortRow
			Number: nSortOrder
			Number: nShowTypeCol
			Window Handle: hColumn
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tbl_Vidd.cTWndTitle'))
				Call PrepareWindow(hWndForm)
				Call SetWindowFullSize(hWndForm)
				Set tbl_Vidd.strPrintFileName = 'DPT_VIDD'
				Set tbl_Vidd.strFilterTblName = 'DPT_VIDD'
				Set tbl_Vidd.fFilterAtStart = TRUE
				If nEdit = 0
					Call SalDisableWindow( pbIns )
					Call SalDisableWindow( pbDel )
					Call SalDisableWindow( pbUpdate )
				! отображение типов депозитных договоров
				Set nShowTypeCol = 0
				Call SalHideWindow (TYPEID)
				Call SalHideWindow (cmbTYPENAME)
				Set tbl_Vidd.strSqlPopulate =
						   "SELECT nvl(dpt_vidd.flag, 0), 
						           dpt_vidd.vidd, 
						           dpt_vidd.kv, 
						           dpt_vidd.type_name, 
						           dpt_vidd.type_cod, 
						           dpt_vidd.comments, 
						           nvl(dpt_vidd.duration, 0), 
						           nvl(dpt_vidd.duration_days, 0),
						           dpt_vidd.min_summ, 
						           dpt_vidd.limit, 
						           f.name, 
						           decode(dpt_vidd.fl_dubl, 1, 1, 2, 1, 0), 
						           v.dig,
						           t.type_id, 
						           t.type_name
						      INTO :tbl_Vidd.FLAG, 
						           :tbl_Vidd.VIDD,
						           :tbl_Vidd.KV, 
						           :tbl_Vidd.TYPE_NAME,
						           :tbl_Vidd.TYPE_COD,
						           :tbl_Vidd.COMMENTS, 
						           :tbl_Vidd.DURATION_M,
						           :tbl_Vidd.DURATION_D,
						           :tbl_Vidd.MIN_SUMM,
						           :tbl_Vidd.LIMIT,
						           :tbl_Vidd.FREQ, 
						           :tbl_Vidd.FL_DUBL,
						           :tbl_Vidd.DIG,
						           :tbl_Vidd.TYPEID,
						           :tbl_Vidd.cmbTYPENAME
						      FROM dpt_vidd, freq f, tabval v, dpt_types t 
						     WHERE dpt_vidd.freq_k  = f.freq 
						       AND dpt_vidd.kv      = v.kv
						       AND dpt_vidd.type_id = t.type_id
						     ORDER BY 1, 2" 
				!
				Set tbl_Vidd.strSqlDelete = 
						   "DELETE FROM dpt_vidd 
						     WHERE vidd = :tbl_Vidd.VIDD 
						       AND NVL(flag, 0) <> 1 
						       AND vidd NOT IN (SELECT UNIQUE vidd FROM dpt_deposit_clos)"
				!
				Set tbl_Vidd.strSqlUpdate = 
						   "UPDATE dpt_vidd SET 
						           flag = :tbl_Vidd.FLAG, 
						       type_cod = :tbl_Vidd.TYPE_COD, 
						      type_name = :tbl_Vidd.TYPE_NAME,
						        type_id = :tbl_Vidd.TYPEID,
						       comments = :tbl_Vidd.COMMENTS
						     WHERE vidd = :tbl_Vidd.VIDD"
				!
				If DigInit() != -1
					Set nMaxDig = DigInit()
				Else
					Set nMaxDig = 4
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				If MIN_SUMM != NUMBER_Null
					Set sMIN_SUMM = Dig4(MIN_SUMM * SalNumberPower(10, DIG) / 100, DIG, nMaxDig)
				If LIMIT    != NUMBER_Null
					Set sLIMIT    = Dig4(LIMIT    * SalNumberPower(10, DIG) / 100, DIG, nMaxDig)
				If SqlPrepareAndExecute(hSql(), "SELECT count(*) 
						                                   INTO :tbl_Vidd.KOL 
						                                   FROM dpt_deposit
						                                  WHERE vidd = :tbl_Vidd.VIDD 
						                                    AND rownum = 1")
					Call SqlFetchNext(hSql(), nTmp)
			On SAM_DoubleClick
				Call SalSendMsg( pbDetails, SAM_Click, 0, 0 )
			On SAM_ColumnSelectClick
				Call SalWaitCursor (TRUE)
				If wParam != nLastSortRow
					Set nLastSortRow = wParam
					Set nSortOrder = TBL_SortIncreasing
				Else
					Set nSortOrder = 1 - nSortOrder
				Set hColumn = SalNumberToWindowHandle(wParam)
				Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
				! сортировка строковых столбцов по числовым
				If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(sMIN_SUMM), COL_GetID)
					Set wParam = SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(MIN_SUMM), COL_GetID))
				If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(sLIMIT), COL_GetID)
					Set wParam = SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(LIMIT), COL_GetID))
				!
				Set hColumn = SalNumberToWindowHandle(wParam)
				Call SalTblSortRows( hWndForm, SalTblQueryColumnID(hColumn), nSortOrder)
				Call SalSendMsg(hWndForm, SAM_RowSetContext, 0, 0)
				Call SalWaitCursor(FALSE)
	Form Window: tbl_ZvitFiles
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  14.75"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.167"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7000
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  0.717"
						Begin Y:  0.429"
						End X:  0.717"
						End Y:  0.012"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbUpdate
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.85"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\CREATE.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('tbl_ZvitFiles.pbUpdate')
						On SAM_Click
							If MessageQuestion(CurrentLangTable.GetAtomTitle('tbl_ZvitFiles.MakeZvitQuestion')) = IDYES
								Call SalWaitCursor(TRUE)
								Set nCreatedFileId   = NUMBER_Null
								Set sCreatedFileName = STRING_Null
								If MakeZvitFile(GetBankDate(), nCreatedFileId, sCreatedFileName)
									If nCreatedFileId  > 0
										Call SqlCommitEx(hSql(), CurrentLangTable.GetAtomTitle('tbl_ZvitFiles.MakeZvitFileDone')
												                         || sCreatedFileName
												                         || " (№"
												                         || Str(nCreatedFileId)
												                         || ")!")                    
								Else
									Call SqlRollbackEx(hSql(), CurrentLangTable.GetAtomTitle('tbl_ZvitFiles.MakeZvitFileFailed')) 
								Call SalPostMsg(tbl_ZvitFiles.tbl, UM_Populate, 0, 0)
								Call SalWaitCursor(FALSE)
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.333"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\PACH.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = CurrentLangTable.GetAtomTitle('tbl_ZvitFiles.pbPrint') 
						On SAM_Click
							If MessageQuestion(CurrentLangTable.GetAtomTitle('tbl_ZvitFiles.ExportZvitQuestion')) = IDYES
								Call SalWaitCursor(TRUE)
								Call SalPostMsg(tbl_ZvitFiles.tbl, UM_Update, 0, 0)
								Call SalWaitCursor(FALSE)
				Line
					Resource Id: 7001
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  1.9"
						Begin Y:  0.393"
						End X:  1.9"
						End Y:  -0.024"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.033"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.55"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7002
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  3.867"
						Begin Y:  Class Default
						End X:  3.867"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.3"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7003
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  3.167"
						Begin Y:  0.452"
						End X:  3.167"
						End Y:  0.036"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				!
				Pushbutton: pbIns
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.017"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\DELREC.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.95"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\OPEN.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
		Contents
			Custom Control: ccSplitter
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    1.619"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    0.0"
						Width:  14.333"
						Width Editable? Class Default
						Height: 1.619"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 1000000
					Discardable? Class Default
				Contents
					Column: colFILEID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: № 
								файла
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.1"
						Width Editable? Class Default
						Format: #0
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colFILENAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Имя 
								файла
						Visible? Class Default
						Editable? No
						Maximum Data Length: 12
						Data Type: Class Default
						Justify: Class Default
						Width:  1.6"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colFILEDATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								файла
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.85"
						Width Editable? Yes
						Format: DateTime
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colFILEVERS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Версия
								файла
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.85"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colDATRPT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Отчетная
								дата
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.2"
						Width Editable? Class Default
						Format: dd/MM/yyyy
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colDATBEG
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Начало 
								отч.периода
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.2"
						Width Editable? Class Default
						Format: dd/MM/yyyy
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colDATEND
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Окончание
								отч.периода
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.2"
						Width Editable? Class Default
						Format: dd/MM/yyyy
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colBNKMFO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: МФО банка
						Visible? Class Default
						Editable? No
						Maximum Data Length: 12
						Data Type: Class Default
						Justify: Class Default
						Width:  1.45"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colINFCNT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Кол-во инф.строк
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.683"
						Width Editable? Class Default
						Format: #0
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On UM_Create
						Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
					On UM_Populate
						! население главной таблицы
						Call SalSendClassMessage(UM_Populate, 0, 0)
						! первая строка
						Call SalTblSetContext (hWndForm, SalTblInsertRow(hWndForm, 0))
						Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
						Set tbl_ZvitFiles.tbl.colFILEID = 0
						Set tbl_ZvitFiles.tbl.colFILENAME = CurrentLangTable.GetAtomTitle('tbl_ZvitFiles.FileMaket')
						Call SetTblRowColor(tbl_ZvitFiles.tbl, COLOR_Periwinkle)
					On SAM_TblDoDetails
						! население дочерней таблицы
						Set nFileId = tbl_ZvitFiles.tbl.colFILEID
						Call SalSendMsg(tbl2, UM_Populate, 0, 0)
					On SAM_SetFocus
						If SalTblQueryRowFlags (hWndForm, lParam, ROW_New)
							Set nFileId = tbl_ZvitFiles.tbl.colFILEID
					On UM_Update
						Set nRow = TBL_MinRow 
						While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
							Call SalTblSetContext(hWndForm, nRow)
							If tbl_ZvitFiles.tbl.colFILEID > 0 AND colINFCNT > 0
								Set sPath  = GetPrnDir(  ) || '\\' || tbl_ZvitFiles.tbl.colFILENAME
								If not SalFileOpen(hFile, sPath, OF_Create | OF_ReadWrite)
									Call SalMessageBox(CurrentLangTable.GetAtomTitle('tbl_ZvitFiles.OpenZvitFileFailed')||sPath||"!", 
											                   CurrentLangTable.GetAtomTitle('cTErr'), 
											                   MB_IconStop)
								Else
									! заголовок
									Call SalFilePutStr(hFile, PadR("Deposits, Bars Millenium", 100))
									! служебная строка
									Call SalFilePutStr(hFile, PadR(SalFmtFormatDateTime(tbl_ZvitFiles.tbl.colDATRPT,   'ddMMyyyy'), 8)  || "=" ||
											                          PadR(SalFmtFormatDateTime(tbl_ZvitFiles.tbl.colDATBEG,   'ddMMyyyy'), 8)  || "=" ||
											                          PadR(SalFmtFormatDateTime(tbl_ZvitFiles.tbl.colDATEND,   'ddMMyyyy'), 8)  || "=" ||
											                          PadR(SalFmtFormatDateTime(tbl_ZvitFiles.tbl.colFILEDATE, 'ddMMyyyy'), 8)  || "=" ||
											                          PadR(SalFmtFormatDateTime(tbl_ZvitFiles.tbl.colFILEDATE, 'hhmm'),     4)  || "=" ||
											                          PadR(tbl_ZvitFiles.tbl.colFILENAME,                                  12)  || "=" ||
											                          PadL(Str(tbl_ZvitFiles.tbl.colINFCNT),                                9)  || "=" ||
											                          PadR(Str(tbl_ZvitFiles.tbl.colFILEVERS),                              1) )
									! подзаголовочная строка
									Call SalFilePutStr(hFile, "#1" || "=" || PadR(colBNKMFO, 6) )
									! информационные строки
									Set nRow2 = TBL_MinRow
									While SalTblFindNextRow(tbl_ZvitFiles.tbl2, nRow2, 0, 0)
										Call SalTblSetContext(tbl_ZvitFiles.tbl2, nRow2)
										If tbl_ZvitFiles.tbl2.colKV != STRING_Null
											Call SalFilePutStr(hFile, PadR(tbl_ZvitFiles.tbl2.colACCNUM,  14) || '=' ||
													                          PadR(tbl_ZvitFiles.tbl2.colDK,       1) || '=' ||
													                          PadL(tbl_ZvitFiles.tbl2.colAMOUNTQ, 16) || '=' ||
													                          PadR(tbl_ZvitFiles.tbl2.colR013,     1) || '=' ||
													                          PadR(tbl_ZvitFiles.tbl2.colVED,      5) || '=' ||
													                          PadR(tbl_ZvitFiles.tbl2.colISE,      5) || '=' ||
													                          PadR(tbl_ZvitFiles.tbl2.colS180,     1) || '=' ||
													                          PadR(tbl_ZvitFiles.tbl2.colREZID,    1) || '=' ||
													                          PadR(tbl_ZvitFiles.tbl2.colKV,       3) || '=' ||
													                          PadR(tbl_ZvitFiles.tbl2.colDATBEG,   8) || '=' ||
													                          PadR(tbl_ZvitFiles.tbl2.colDATEND,   8) || '=' ||
													                          PadR(tbl_ZvitFiles.tbl2.colD020,     1) || '=' ||
													                          PadL(tbl_ZvitFiles.tbl2.colRATE,     9) || '=' ||
													                          PadR(tbl_ZvitFiles.tbl2.colBRANCH,   3))
									Call SalFileClose(hFile)
									Call SalMessageBox(CurrentLangTable.GetAtomTitle('tbl_ZvitFiles.ExportDone')||" "||sPath||"!",
											                   CurrentLangTable.GetAtomTitle('cTAt'), 
											                   MB_IconInformation)
			Child Table: tbl2
				Class Child Ref Key: 27
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    1.69"
						Width:  14.35"
						Width Editable? Class Default
						Height: 3.179"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 1000000
					Discardable? Class Default
				Contents
					Column: colACCNUM
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: № счета
						Visible? Class Default
						Editable? No
						Maximum Data Length: 14
						Data Type: Class Default
						Justify: Class Default
						Width:  1.6"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colKV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Вал
						Visible? Class Default
						Editable? No
						Maximum Data Length: 3
						Data Type: Class Default
						Justify: Center
						Width:  0.533"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colDATBEG
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								начала
						Visible? Class Default
						Editable? No
						Maximum Data Length: 8
						Data Type: Class Default
						Justify: Center
						Width:  1.2"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colDATEND
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								окончания
						Visible? Class Default
						Editable? No
						Maximum Data Length: 8
						Data Type: Class Default
						Justify: Center
						Width:  1.2"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colRATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Процентная
								ставка
						Visible? Class Default
						Editable? No
						Maximum Data Length: 9
						Data Type: Class Default
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colDK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дт/
								Кт
						Visible? Class Default
						Editable? No
						Maximum Data Length: 1
						Data Type: Class Default
						Justify: Center
						Width:  0.5"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colAMOUNT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сумма
								номинал
						Visible? Class Default
						Editable? No
						Maximum Data Length: 16
						Data Type: Class Default
						Justify: Right
						Width:  1.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colAMOUNTQ
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сумма 
								эквивалент
						Visible? Class Default
						Editable? No
						Maximum Data Length: 16
						Data Type: Class Default
						Justify: Right
						Width:  1.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colR013
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								R013
						Visible? Class Default
						Editable? No
						Maximum Data Length: 1
						Data Type: Class Default
						Justify: Center
						Width:  0.5"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colVED
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								K110
						Visible? Class Default
						Editable? No
						Maximum Data Length: 5
						Data Type: Class Default
						Justify: Center
						Width:  0.7"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colISE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								K070
						Visible? Class Default
						Editable? No
						Maximum Data Length: 5
						Data Type: Class Default
						Justify: Center
						Width:  0.7"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colS180
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								S180
						Visible? Class Default
						Editable? No
						Maximum Data Length: 1
						Data Type: Class Default
						Justify: Center
						Width:  0.5"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colREZID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								РЗД
						Visible? Class Default
						Editable? No
						Maximum Data Length: 1
						Data Type: Class Default
						Justify: Center
						Width:  0.5"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colD020
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								D020
						Visible? Class Default
						Editable? No
						Maximum Data Length: 1
						Data Type: Class Default
						Justify: Center
						Width:  0.5"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colBRANCH
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
								отд.
						Visible? Class Default
						Editable? No
						Maximum Data Length: 3
						Data Type: Class Default
						Justify: Center
						Width:  0.617"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colONE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colBNKDATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								выполнения
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: dd/MM/yyyy
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
					String: strSql
				Message Actions
					On UM_Populate
						Call SalWaitCursor(TRUE)
						Set strSql =
								   "SELECT accnum, kv, datbeg, datend, 
								           rate, dk, amount, amountQ, 
								           r013, ved, ise, s180, 
								           rezid, d020, branch, 1, bnkdat 
								      INTO :tbl_ZvitFiles.tbl2.colACCNUM, 
								           :tbl_ZvitFiles.tbl2.colKV, 
								           :tbl_ZvitFiles.tbl2.colDATBEG, 
								           :tbl_ZvitFiles.tbl2.colDATEND, 
								           :tbl_ZvitFiles.tbl2.colRATE, 
								           :tbl_ZvitFiles.tbl2.colDK, 
								           :tbl_ZvitFiles.tbl2.colAMOUNT, 
								           :tbl_ZvitFiles.tbl2.colAMOUNTQ, 
								           :tbl_ZvitFiles.tbl2.colR013, 
								           :tbl_ZvitFiles.tbl2.colVED, 
								           :tbl_ZvitFiles.tbl2.colISE, 
								           :tbl_ZvitFiles.tbl2.colS180, 
								           :tbl_ZvitFiles.tbl2.colREZID, 
								           :tbl_ZvitFiles.tbl2.colD020, 
								           :tbl_ZvitFiles.tbl2.colBRANCH,
								           :tbl_ZvitFiles.tbl2.colONE,
								           :tbl_ZvitFiles.tbl2.colBNKDATE 
								      FROM v_dptext_filesdata 
								     WHERE fileid = :nFileId
								     ORDER BY datbeg, accnum, kv"
						Call SalTblPopulate(hWndForm, hSql(), strSql, TBL_FillAll)
						! итоговая строка
						Call SalTblDefineSplitWindow (hWndForm, 1, TRUE)
						Call SalTblSetContext (hWndForm, SalTblInsertRow(hWndForm, TBL_MinRow))
						Set tbl_ZvitFiles.tbl2.colACCNUM  = CurrentLangTable.GetAtomTitle('tbl_ZvitFiles.Total')||" "||
								                                    Str(SalTblColumnSum(hWndForm, 16, 0, 0))
						Set tbl_ZvitFiles.tbl2.colAMOUNTQ = Str(SalTblColumnSum(hWndForm, 8, 0, 0)) 
						Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
						Call SalWaitCursor(FALSE)
		Functions
			Function: MakeZvitFile
				Description:
				Returns
				Parameters
					Date/Time: pDATE
					Receive Number: pFULEID
					Receive String: pFILENAME
				Static Variables
				Local variables
				Actions
					If SqlPLSQLCommand(hSql(), "bars.make_zvitfile (pDATE, pFULEID, pFILENAME)")
						Return TRUE
					Else
						Return FALSE
		Window Parameters
			Number: nPar1
			String: sPar2
			String: sPar3
		Window Variables
			Number: nFetchRes
			Number: nRow
			Number: nRow2
			Number: nFileId
			Number: nCreatedFileId
			String: sCreatedFileName
			String: sPath
			File Handle: hFile
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tbl_ZvitFiles.WindowTitle'))
				Call PrepareWindow(hWndForm)
				Call SalMapEnterToTab(TRUE)
				!
				Set tbl_ZvitFiles.strFilterTblName = 'dpt_extension_file'
				Set tbl_ZvitFiles.strPrintFileName = 'ZvitFile'
				Set tbl_ZvitFiles.fFilterAtStart = TRUE
				Call SalDisableWindow(pbIns)
				Call SalDisableWindow(pbDel)
				Call SalDisableWindow(pbDetails)
				!
				Set tbl_ZvitFiles.strSqlPopulate =
						   "SELECT fileid, filename, filedate, filevers, 
						           datrpt, datbeg, datend, bnkmfo, infcnt
						      INTO :tbl_ZvitFiles.tbl.colFILEID, 
						           :tbl_ZvitFiles.tbl.colFILENAME, 
						           :tbl_ZvitFiles.tbl.colFILEDATE,
						           :tbl_ZvitFiles.tbl.colFILEVERS,
						           :tbl_ZvitFiles.tbl.colDATRPT,
						           :tbl_ZvitFiles.tbl.colDATBEG, 
						           :tbl_ZvitFiles.tbl.colDATEND, 
						           :tbl_ZvitFiles.tbl.colBNKMFO, 
						           :tbl_ZvitFiles.tbl.colINFCNT
						      FROM dpt_extension_file    
						     ORDER BY datrpt, filename"
				Call SalSendClassMessage(SAM_Create, 0, 0)
	Table Window: ITOG
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: ПОРТФЕЛЬ депозитных  вкладов  населения. ИТОГИ.
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.113"
				Top:    0.229"
				Width:  14.633"
				Width Editable? Class Default
				Height: 9.214"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? No
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.8"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.686"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \Bars98\RESOURCE\BMP\Sort.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Порядок сортировки
							Set strTip = CurrentLangTable.GetAtomTitle('ITOG.cBTipOns')
						On SAM_Click
							Call SalTblSortRows( tbl1, 1, TBL_SortIncreasing )
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 12164
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.486"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.086"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.686"
						Top:    0.073"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 12165
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 12166
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Child Table: tbl1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Display Settings
						Window Location and Size
							Left:   3.083"
							Top:    0.321"
							Width:  4.1"
							Width Editable? Yes
							Height: 1.38"
							Height Editable? Yes
						Visible? Yes
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						View: Table
						Allow Row Sizing? No
						Lines Per Row: 1
					Memory Settings
						Maximum Rows in Memory: Default
						Discardable? No
					Contents
						Column: nSORT
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class: cColumnLabeled
							Property Template:
							Class DLL Name:
							Title: Порядок
							Visible? Yes
							Editable? No
							Maximum Data Length: 1
							Data Type: Number
							Justify: Center
							Width:  0.85"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: sSELE
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class: cColumnLabeled
							Property Template:
							Class DLL Name:
							Title:
							Visible? No
							Editable? No
							Maximum Data Length: Default
							Data Type: String
							Justify: Left
							Width:  Default
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: sINTO
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class: cColumnLabeled
							Property Template:
							Class DLL Name:
							Title:
							Visible? No
							Editable? No
							Maximum Data Length: Default
							Data Type: String
							Justify: Left
							Width:  Default
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: sNAME
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class: cColumnLabeled
							Property Template:
							Class DLL Name:
							Title: Разрез
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: String
							Justify: Left
							Width:  1.833"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: nFLAG
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class: cColumnLabeled
							Property Template:
							Class DLL Name:
							Title: Отм
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: Number
							Justify: Left
							Width:  0.517"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Check Box
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value: 1
									Uncheck Value: 0
									Ignore Case? No
							List Values
							Message Actions
								On SAM_AnyEdit
									If nFLAG != 0
										Set n3 = n3 + 1
										Set colN = n3
										Call SalTblSortRows(tbl1, SalTblQueryColumnID(colN), TBL_SortIncreasing)
										Set nN = 0
										Set nRw = TBL_MinRow
										While SalTblFindNextRow(hWndForm, nRw, 0, 0)
											Call SalTblSetContext(hWndForm, nRw)
											If nFLAG
												Set nN = nN + 1
												Set nSORT = nN
									Else
										Set colN = 0
										Set nSORT = NUMBER_Null
										Set nN = 0
										Call SalTblSortRows(tbl1, SalTblQueryColumnID(colN), TBL_SortIncreasing)
										Set nRw = TBL_MinRow
										While SalTblFindNextRow(hWndForm, nRw, 0, 0)
											Call SalTblSetContext(hWndForm, nRw)
											If nFLAG
												Set nN = nN + 1
												Set nSORT = nN
						Column: colN
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class: cColumnLabeled
							Property Template:
							Class DLL Name:
							Title:
							Visible? No
							Editable? Yes
							Maximum Data Length: Default
							Data Type: Number
							Justify: Left
							Width:  Default
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
					Functions
					Window Variables
						Number: nRw
						Number: nN
					Message Actions
						On SAM_Create
							Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
						On SAM_DoubleClick
							Set nFLAG=1-nFLAG
							Call SalSendMsg(nFLAG,SAM_AnyEdit,0,0)
						On SAM_FetchRowDone
							Set colN = 0
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.45"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Печать
							Set strTip = CurrentLangTable.GetAtomTitle('ITOG.cBTipPrint')
						On SAM_Click
							Call SalPostMsg(hWndForm, UM_Print, 0, 0)
				Pushbutton: pbRefresh	 !!!
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.1"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalWaitCursor(TRUE)
							Call ZAGOLOVOK(dfDate1, dfDate2)
							Call SalTblSortRows(tbl1, 1, TBL_SortIncreasing)
							Set SELE = ""
							Set INTO = ""
							Set fKV  = FALSE
							Set HAV  = "
									nvl(sum(gl.p_icurval(dpt_vidd.kv,
									                 fost(d.acc,:DAT2)+fdos(d.acc,:DAT1,:DAT2)-
									                             fkos(d.acc,:DAT1,:DAT2),:DAT1)),0)<>0 OR
									nvl(sum(gl.p_icurval(dpt_vidd.kv,
									                 fost(decode(i.acc,i.acra, 0,i.acra),:DAT2)+
									                 fdos(decode(i.acc,i.acra, 0,i.acra),:DAT1,:DAT2)-
									                 fkos(decode(i.acc,i.acra, 0,i.acra),:DAT1,:DAT2),:DAT1)),0)<>0 OR
									nvl(sum(fdosN(dpt_vidd.kv,d.acc,:DAT1,:DAT2)),0)<>0 OR
									nvl(sum(fdosN(dpt_vidd.kv,decode(i.acc,i.acra, 0,i.acra),:DAT1,:DAT2)),0)<>0 OR
									nvl(sum(fkosN(dpt_vidd.kv,d.acc,:DAT1,:DAT2)),0)<>0 OR
									nvl(sum(fkosN(dpt_vidd.kv,decode(i.acc,i.acra, 0,i.acra),:DAT1,:DAT2)),0)<>0 OR
									nvl(sum(gl.p_icurval(dpt_vidd.kv,fost(d.acc,:DAT2),:DAT2)),0)<>0 OR
									nvl(sum(gl.p_icurval(dpt_vidd.kv,fost(decode(i.acc,i.acra, 0,i.acra),:DAT2),:DAT2)),0)<>0 OR
									sum(iif_d(a.daos,:DAT1,iif_d(a.dazs,:DAT1,0,1,1),0,0))<>0 OR
									sum(iif_d(a.daos,:DAT1,0,1,iif_d(a.daos,:DAT2,1,1,0)))<>0 OR
									sum(iif_d(a.dazs,:DAT1,0,1,iif_d(a.dazs,:DAT2,1,1,0)))<>0 "
							Set nTmp = TBL_MinRow
							While SalTblFindNextRow(tbl1, nTmp, 0, 0)
								Call SalTblSetContext(tbl1, nTmp)
								If SalStrScan(tbl1.sINTO, 'nISP') > 0
									Set hColumnHandle = hWndForm.ITOG.nISP
								Else If SalStrScan(tbl1.sINTO, 'nVID') > 0
									Set hColumnHandle = hWndForm.ITOG.nVID
								Else If SalStrScan(tbl1.sINTO, 'nKV') > 0
									Set hColumnHandle = hWndForm.ITOG.nKV
								Else If SalStrScan(tbl1.sINTO, 'nBS') > 0
									Set hColumnHandle = hWndForm.ITOG.nBS
								Else If SalStrScan(tbl1.sINTO, 'sBRANCH') > 0
									Set hColumnHandle = hWndForm.ITOG.sBRANCH
								If tbl1.nFLAG = 1
									Call SalShowWindow(hColumnHandle)
									Set SELE = SELE || tbl1.sSELE
									Set INTO = INTO || tbl1.sINTO
									If tbl1.sSELE = 'tabval.lcv,'
										Set fKV = TRUE
										Set HAV =
												"    nvl(sum(fdos(d.acc,:DAT1,:DAT2)),0)<>0 OR
												     nvl(sum(fdos(decode(i.acc,i.acra, 0,i.acra),:DAT1,:DAT2)),0)<>0 OR
												     nvl(sum(fkos(d.acc,:DAT1,:DAT2)),0)<>0 OR
												     nvl(sum(fkos(decode(i.acc,i.acra, 0,i.acra),:DAT1,:DAT2)),0)<>0 OR
												     nvl(sum(fost(d.acc,:DAT2)),0)<>0 OR
												     nvl(sum(fost(decode(i.acc,i.acra, 0,i.acra),:DAT2)),0)<>0 OR
												     sum(iif_d(a.daos,:DAT1,iif_d(a.dazs,:DAT1,0,1,1),0,0))<>0 OR
												     sum(iif_d(a.daos,:DAT1,0,1,iif_d(a.daos,:DAT2,1,1,0)))<>0 OR
												     sum(iif_d(a.dazs,:DAT1,0,1,iif_d(a.dazs,:DAT2,1,1,0)))<>0 "
									If tbl1.sSELE = 'd.branch, b.name, '
										Call SalShowWindow(sBRANCHNAME)
								Else
									Call SalHideWindow(hColumnHandle)
									If tbl1.sSELE = 'd.branch, b.name, '
										Call SalHideWindow(sBRANCHNAME)
							Set ORDE = SalStrTrimX(SELE)
							If Len(ORDE) > 2
								Set ORDE = Left(ORDE,Len(ORDE)-1)
								Set ORDE = " GROUP BY " || IifS(fKV=TRUE, "tabval.dig,", "") || ORDE || " HAVING "|| HAV || " ORDER BY " || ORDE
							Else
								Set ORDE = IifS(fKV=TRUE, "GROUP BY tabval.dig", "")
							If fKV
								Set HAV=
										"    nvl(sum(fdos(d.acc,:DAT1,:DAT2)),0)<>0 OR
										     nvl(sum(fdos(decode(i.acc,i.acra, 0,i.acra),:DAT1,:DAT2)),0)<>0 OR
										     nvl(sum(fkos(d.acc,:DAT1,:DAT2)),0)<>0 OR
										     nvl(sum(fkos(decode(i.acc,i.acra, 0,i.acra),:DAT1,:DAT2)),0)<>0 OR
										     nvl(sum(fost(d.acc,:DAT2)),0)<>0 OR
										     nvl(sum(fost(decode(i.acc,i.acra, 0,i.acra),:DAT2)),0)<>0 OR
										     sum(iif_d(a.daos,:DAT1,iif_d(a.dazs,:DAT1,0,1,1),0,0))<>0 OR
										     sum(iif_d(a.daos,:DAT1,0,1,iif_d(a.daos,:DAT2,1,1,0)))<>0 OR
										     sum(iif_d(a.dazs,:DAT1,0,1,iif_d(a.dazs,:DAT2,1,1,0)))<>0 "
								!
								Set ITOG.strSqlPopulate = "SELECT " || SELE || " 
										nvl(sum(fdos(d.acc,:DAT1,:DAT2)),0) DOS1,
										nvl(sum(fdos(decode(i.acc,i.acra, 0,i.acra),:DAT1,:DAT2)),0) DOS2,
										nvl(sum(fkos(d.acc,:DAT1,:DAT2)),0) KOS1,
										nvl(sum(fkos(decode(i.acc,i.acra, 0,i.acra),:DAT1,:DAT2)),0) KOS2,
										nvl(sum(fost(d.acc,:DAT2)),0) SAL1,
										nvl(sum(fost(decode(i.acc,i.acra, 0,i.acra),:DAT2)),0) SAL2, 
										sum(iif_d(a.daos,:DAT1,iif_d(a.dazs,:DAT1,0,1,1),0,0)) KOL1,
										sum(iif_d(a.daos,:DAT1,0,1,iif_d(a.daos,:DAT2,1,1,0))) KOL2,
										sum(iif_d(a.dazs,:DAT1,0,1,iif_d(a.dazs,:DAT2,1,1,0))) KOL3,
										sum(nvl(acrn.fproc(d.acc,:DAT1),0)*nvl(fost(d.acc,:DAT1),0))/power(10,tabval.dig) RAT1,
										sum(nvl(acrn.fproc(d.acc,:DAT2),0)*nvl(fost(d.acc,:DAT2),0))/power(10,tabval.dig) RAT2, 
										tabval.dig 
										INTO  "||INTO||" :ITOG.DOS1, :ITOG.DOS2,
										                 :ITOG.KOS1, :ITOG.KOS2,
										                 :ITOG.SAL1, :ITOG.SAL2,
										                 :ITOG.nKOL1,:ITOG.nKOL2, 
										                 :ITOG.nKOL3,
										                 :ITOG.RAT1, :ITOG.RAT2, :ITOG.DIG 
										FROM dpt_vidd, dpt_acc d, accounts a, int_accn i, staff, tabval "||
										IifS (nHaveTOBO = 2, ", branch b", " ")||"  
										WHERE staff.id=a.isp       AND tabval.kv=dpt_vidd.kv AND   
										      dpt_vidd.vidd=d.vidd AND d.acc=a.acc           AND 
										      i.acc=a.acc          AND i.id=1                
										"||IifS (nHaveTOBO = 2, " and d.branch = b.branch ", " ")|| sF1 || ORDE
							Else
								Set ITOG.strSqlPopulate = "SELECT "||SELE||" 
										nvl(sum(gl.p_icurval(dpt_vidd.kv,
										                 fost(d.acc,:DAT2)+
										                 fdos(d.acc,:DAT1,:DAT2)-
										                 fkos(d.acc,:DAT1,:DAT2),:DAT1)),0) OST1,
										nvl(sum(gl.p_icurval(dpt_vidd.kv,
										                 fost(decode(i.acc,i.acra, 0,i.acra),:DAT2)+
										                 fdos(decode(i.acc,i.acra, 0,i.acra),:DAT1,:DAT2)-
										                 fkos(decode(i.acc,i.acra, 0,i.acra),:DAT1,:DAT2),:DAT1)),0) OST2,
										nvl(sum(fdosN(dpt_vidd.kv,d.acc,:DAT1,:DAT2)),0) DOS1,
										nvl(sum(fdosN(dpt_vidd.kv,decode(i.acc,i.acra, 0,i.acra),:DAT1,:DAT2)),0) DOS2,
										nvl(sum(fkosN(dpt_vidd.kv,d.acc,:DAT1,:DAT2)),0) KOS1,
										nvl(sum(fkosN(dpt_vidd.kv,decode(i.acc,i.acra, 0,i.acra),:DAT1,:DAT2)),0) KOS2,
										nvl(sum(gl.p_icurval(dpt_vidd.kv,fost(d.acc,:DAT2),:DAT2)),0) SAL1,
										nvl(sum(gl.p_icurval(dpt_vidd.kv,fost(decode(i.acc,i.acra, 0,i.acra),:DAT2),:DAT2)),0) SAL2, 
										sum(iif_d(a.daos,:DAT1,iif_d(a.dazs,:DAT1,0,1,1),0,0)) KOL1,
										sum(iif_d(a.daos,:DAT1,0,1,iif_d(a.daos,:DAT2,1,1,0))) KOL2,
										sum(iif_d(a.dazs,:DAT1,0,1,iif_d(a.dazs,:DAT2,1,1,0))) KOL3,
										sum(nvl(acrn.fproc(d.acc,:DAT1),0)*nvl(gl.p_icurval(dpt_vidd.kv,fost(d.acc,:DAT1),:DAT1),0))/power(10,2) RAT1,
										sum(nvl(acrn.fproc(d.acc,:DAT2),0)*nvl(gl.p_icurval(dpt_vidd.kv,fost(d.acc,:DAT2),:DAT2),0))/power(10,2) RAT2, 
										2 DIG
										INTO  "||INTO||" :ITOG.OST1, :ITOG.OST2, 
										                 :ITOG.DOS1, :ITOG.DOS2,
										                 :ITOG.KOS1, :ITOG.KOS2,
										                 :ITOG.SAL1, :ITOG.SAL2,
										                 :ITOG.nKOL1,:ITOG.nKOL2, 
										                 :ITOG.nKOL3,
										                 :ITOG.RAT1, :ITOG.RAT2, :ITOG.DIG  
										FROM dpt_vidd, dpt_acc d, accounts a, int_accn i, staff, tabval "||
										IifS (nHaveTOBO = 2, ", branch b", " ") ||"   
										WHERE staff.id=a.isp       AND tabval.kv=dpt_vidd.kv AND   
										      dpt_vidd.vidd=d.vidd AND d.acc=a.acc           AND 
										      i.acc=a.acc          AND i.id=1 
										"||IifS (nHaveTOBO = 2, " and d.branch = b.branch ", " ")
										|| sF1 || ORDE
							Call SalTblPopulate(hWndForm, hSql(), ITOG.strSqlPopulate, TBL_FillAll)
							! Call SaveInfoToLog(ITOG.strSqlPopulate)
							Call SalWaitCursor(FALSE)
				Background Text: Критерии формирования
					Resource Id: 47483
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   3.083"
						Top:    0.05"
						Width:  3.0"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: 3D Shadow Color
					Background Color: Default
				Data Field: bgTbl1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cLabelControl
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Class Default
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   Default
							Top:    Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Border? Class Default
						Justify: Class Default
						Format: Class Default
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
				Pushbutton: pbVidd
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.55"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Book.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Общие параметры видов вкладов
							Set strTip = CurrentLangTable.GetAtomTitle('ITOG.cBTipVidd')
						On SAM_Click
							Call Sel016f(hWndMDI,2,0,""," ")
				Pushbutton: pbSort
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSort
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.0"
						Top:    0.071"
						Width:  0.43"
						Width Editable? Yes
						Height: 0.317"
						Height Editable? Yes
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: MS Sans Serif
					Font Size: 8
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\Sort.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							! Ресурс по срокам погашения
							Set strTip = CurrentLangTable.GetAtomTitle('ITOG.cBTipSort')
						On SAM_Click
							If not IsWindow(hWinPR) 
								Set hWinPR= SalCreateWindow(tbl_Resource, hWndMDI, nUserId, sPar1, sFilter)
				Picture: Label
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   7.283"
						Top:    0.107"
						Width:  5.0"
						Width Editable? Yes
						Height: 1.214"
						Height Editable? Yes
					Visible? Yes
					Editable? No
					File Name: \bars98\resource\bmp\D_LABEL7.bmp
					Storage: Internal
					Picture Transparent Color: Gray
					Fit: Scale
					Scaling
						Width:  100
						Height:  100
					Corners: Square
					Border Style: No Border
					Border Thickness: 1
					Tile To Parent? No
					Border Color: Default
					Background Color: 3D Face Color
					Message Actions
						On SAM_Create
							Call SalColorSet( hWndItem, COLOR_IndexTransparent, SalColorFromRGB( 191, 191, 191 ) )
				Line
					Resource Id: 16844
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  1.967"
						Begin Y:  -0.024"
						End X:  1.967"
						End Y:  0.44"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Data Field: dfDate1
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000001010101 0101000000000000 01000000000A6464 2F4D4D2F79797979
0040: 00000000
.enddata
.data CLASSPROPSSIZE
0000: 4400
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.17"
							Top:    1.3"
							Width:  1.32"
							Width Editable? Yes
							Height: 0.313"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Validate
							! ПОРТФЕЛЬ депозитных  вкладов  населения за период с ... по ...
							If SqlPrepareAndExecute( hSql(),
									 "SELECT fdat INTO :DAT1 FROM fdat WHERE fdat=:dfDate1" ) AND 
									NOT SqlFetchNext( hSql(), nFetchRes )
								If SqlPrepareAndExecute( hSql(), 
										" SELECT min(fdat) INTO :DAT1 FROM fdat WHERE fdat > = :dfDate1" )
										AND SqlFetchNext( hSql(), nFetchRes )
				Data Field: dfDate2
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000001010101 0101000000000000 01000000000A6464 2F4D4D2F79797979
0040: 0000
.enddata
.data CLASSPROPSSIZE
0000: 4200
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.483"
							Top:    1.298"
							Width:  1.32"
							Width Editable? Yes
							Height: 0.313"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Validate
							! ПОРТФЕЛЬ депозитных  вкладов  населения за период с ... по ...
							If SqlPrepareAndExecute( hSql(),
									 "SELECT fdat INTO :DAT2 FROM fdat WHERE fdat=:dfDate2" ) AND 
									NOT SqlFetchNext( hSql(), nFetchRes )
								If SqlPrepareAndExecute( hSql(), 
										" SELECT max(fdat) INTO :DAT2 FROM fdat WHERE fdat < = :dfDate2" )
										AND SqlFetchNext( hSql(), nFetchRes )
				Data Field: DAT1
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000001010101 0101000000000000 01000000000A6464 2F4D4D2F79797979
0040: 00000000
.enddata
.data CLASSPROPSSIZE
0000: 4400
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.483"
							Top:    1.155"
							Width:  1.35"
							Width Editable? Yes
							Height: 0.313"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: 10
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: DAT2
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000001010101 0101000000000000 01000000000A6464 2F4D4D2F79797979
0040: 0000
.enddata
.data CLASSPROPSSIZE
0000: 4200
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.983"
							Top:    1.167"
							Width:  1.35"
							Width Editable? Yes
							Height: 0.313"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: 10
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Background Text: Задайте период
					Resource Id: 47484
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.167"
						Top:    1.0"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: 3D Shadow Color
					Background Color: Default
				Data Field: bgDate
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cLabelControl
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Class Default
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   Default
							Top:    Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Border? Class Default
						Justify: Class Default
						Format: Class Default
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
				Picture: pic2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   3.0"
						Top:    0.15"
						Width:  4.3"
						Width Editable? Yes
						Height: 1.6"
						Height Editable? Yes
					Visible? Yes
					Editable? No
					File Name:
					Storage: External
					Picture Transparent Color: None
					Fit: Scale
					Scaling
						Width:  100
						Height:  100
					Corners: Square
					Border Style: Etched
					Border Thickness: 1
					Tile To Parent? No
					Border Color: 3D Shadow Color
					Background Color: 3D Face Color
					Message Actions
				Picture: pic3
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   0.08"
						Top:    1.1"
						Width:  2.8"
						Width Editable? Yes
						Height: 0.65"
						Height Editable? Yes
					Visible? Yes
					Editable? No
					File Name:
					Storage: External
					Picture Transparent Color: None
					Fit: Scale
					Scaling
						Width:  100
						Height:  100
					Corners: Square
					Border Style: Etched
					Border Thickness: 1
					Tile To Parent? No
					Border Color: 3D Shadow Color
					Background Color: 3D Face Color
					Message Actions
		Contents
			Column: sBRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						отделения
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sBRANCHNAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Название
						отделения
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  2.467"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: nISP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: ФИО
						исполнителя
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.183"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nVID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Вид
						вклада
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nKV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						ВАЛ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sISP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: ФИО
						исполнителя
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.043"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sVID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Вид
						вклада
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sKV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: ВАЛ
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.829"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nBS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Бал.
						счет
				Visible? Yes
				Editable? No
				Maximum Data Length: 4
				Data Type: String
				Justify: Right
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: OST1	! реальная сумма в вал.
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма 
						вкладов 
						на начало
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.3"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sOST1	! строка с разделителем
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма 
						вкладов 
						на начало
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.3"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Средневзв. 
						ставка
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DOS1	! реальная сумма в вал.
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма Дт 
						оборотов
						по вкладам
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.317"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sDOS1	! строка с разделителем
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма Дт 
						оборотов
						по вкладам
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.3"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOS1	! реальная сумма в вал.
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма Кт 
						оборотов
						по вкладам
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.143"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sKOS1	! строка с разделителем
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма Кт 
						оборотов
						по вкладам
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.3"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SAL1	! реальная сумма в вал.
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма 
						вкладов
						на конец
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.071"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sSAL1	! строка с разделителем
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма 
						вкладов
						на конец
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.3"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RAT2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Средневзв.
						ставка
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.3"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST2	! реальная сумма в вал.
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма 
						начисл.%%
						на начало 
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.333"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sOST2	! строка с разделителем
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма 
						начисл.%%
						на начало 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.3"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DOS2	! реальная сумма в вал.
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма Дт 
						оборотов
						по начисл.%%
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.317"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sDOS2	! строка с разделителем
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма Дт 
						оборотов
						по начисл.%%
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.3"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOS2	! реальная сумма в вал.
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма Кт 
						оборотов
						по начисл.%%
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.243"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sKOS2	! строка с разделителем
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма Кт 
						оборотов
						по начисл.%%
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.3"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SAL2	! реальная сумма в вал.
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма 
						начисл.%%
						на конец 
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.283"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sSAL2	! строка с разделителем
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма 
						начисл.%%
						на конец 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.3"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: nKOL1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Кол-во 
						счетов 
						на начало
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.017"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nKOL2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Открыто
						счетов
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.817"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nKOL3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Закрыто
						 счетов
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nKOL4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Кол-во 
						счетов 
						на конец 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.05"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: DIG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: DIG
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: ZAGOLOVOK
				Description:
				Returns
					Boolean: bOK
				Parameters
					Date/Time: DAT1
					Date/Time: DAT2
				Static Variables
				Local variables
				Actions
					! ПОРТФЕЛЬ депозитных  вкладов  населения за период с dat1 по dat2
					Call SalSetWindowText(hWndForm, 
							     CurrentLangTable.GetAtomTitle('ITOG.cTWndTitle') || ' ' || SalFmtFormatDateTime(DAT1, 'dd-MM-yyyy') || ' ' ||
							     CurrentLangTable.GetAtomTitle('ITOG.cTWndTitle_')|| ' ' || SalFmtFormatDateTime(DAT2, 'dd-MM-yyyy') )
					! Сумма  вкладов на dat1
					Call SalTblSetColumnTitle(ITOG.sOST1, 
							     CurrentLangTable.GetAtomTitle('ITOG.sOST1') || PutCrLf() ||
							     SalFmtFormatDateTime(DAT1, 'dd-MM-yyyy')) 
					! Сумма  вкладов на dat2
					Call SalTblSetColumnTitle(ITOG.sSAL1, 
							     CurrentLangTable.GetAtomTitle('ITOG.sSAL1') || PutCrLf() ||
							     SalFmtFormatDateTime(DAT2, 'dd-MM-yyyy')) 
					! !!
					! Сумма  начисл.%% на dat1
					Call SalTblSetColumnTitle(ITOG.sOST2, 
							     CurrentLangTable.GetAtomTitle('ITOG.sOST2') || PutCrLf() || 
							     SalFmtFormatDateTime(DAT1, 'dd-MM-yyyy')) 
					! Сумма  начисл.%% на dat2
					Call SalTblSetColumnTitle(ITOG.sSAL2, 
							     CurrentLangTable.GetAtomTitle('ITOG.sSAL2') || PutCrLf() || 
							     SalFmtFormatDateTime(DAT2, 'dd-MM-yyyy')) 
					! Кол-во  счетов на dat1
					Call SalTblSetColumnTitle(ITOG.nKOL1, 
							     CurrentLangTable.GetAtomTitle('ITOG.nKOL1') || PutCrLf() || 
							     SalFmtFormatDateTime(DAT1, 'dd-MM-yyyy')) 
					! Кол-во  счетов на dat2
					Call SalTblSetColumnTitle(ITOG.nKOL4, 
							     CurrentLangTable.GetAtomTitle('ITOG.nKOL4') || PutCrLf() || 
							     SalFmtFormatDateTime(DAT2, 'dd-MM-yyyy')) 
					! Средневзв.  ставка на dat1
					Call SalTblSetColumnTitle(ITOG.RAT1, 
							     CurrentLangTable.GetAtomTitle('ITOG.RAT1') || PutCrLf() || 
							     SalFmtFormatDateTime(DAT1, 'dd-MM-yyyy')) 
					! Средневзв. ставка на dat2
					Call SalTblSetColumnTitle(ITOG.RAT2, 
							     CurrentLangTable.GetAtomTitle('ITOG.RAT2') || PutCrLf() || 
							     SalFmtFormatDateTime(DAT2, 'dd-MM-yyyy')) 
					Return TRUE
		Window Parameters
			Number: nUserId
			String: sPar1
			String: sFilter
		Window Variables
			Date/Time: BD
			Number: n3
			Number: nFetchRes
			Number: nTmp
			String: sTmp
			String: sF
			String: sF1
			String: SELE
			String: INTO
			String: HAV
			String: ORDE
			Boolean: fKV
			Number: L
			Number: nWW
			Number: nWH
			Number: nX
			Number: nY
			Number: nW
			Number: nH
			Number: nCX
			Number: nCY
			Number: nCW
			Number: nCH
			Window Handle: hColumnHandle
			Number: nMaxDig
			Number: nLastSortRow
			Number: nSortOrder
			Window Handle: hColumn
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('ITOG.cTWndTitle'))
				Call PrepareWindow(hWndForm)
				Call XSalTooltipSetUserDefault()
				Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
				If nHaveTOBO = 0
					Call SalHideWindow(sBRANCH)
				If nHaveTOBO < 2
					Call SalHideWindow(sBRANCHNAME)
				Call SalTblSetColumnTitle(sBRANCH, 'Код
						подразделения')
				Call SalTblSetColumnTitle(sBRANCHNAME, 'Название
						подразделения')
				Set dfDate1 = GetBankDate()
				Set dfDate2 = GetBankDate()
				Set DAT1 = GetBankDate()
				Set DAT2 = GetBankDate()
				Call ZAGOLOVOK(dfDate1,dfDate2)
				Call SetWindowFullSize(ITOG)
				! 'Исполнитель', 'Вид вклада', 'Валюта', 'Бал.счет', 'Подразделение', 'Отделение'
				Call SalTblPopulate(tbl1, hSql(),
						"SELECT 'staff.fio,',':ITOG.nISP,','" || CurrentLangTable.GetAtomTitle('cTIsp') || "', 0
						 INTO :tbl1.sSELE,:tbl1.sINTO,:tbl1.sNAME,:tbl1.nFLAG
						 FROM dual
						 UNION ALL 
						 SELECT 'dpt_vidd.type_name,',':ITOG.nVID,','" || CurrentLangTable.GetAtomTitle('cTVidd') || "', 0
						 FROM dual 
						 UNION ALL 
						 SELECT 'tabval.lcv,',':ITOG.nKV,','" || CurrentLangTable.GetAtomTitle('cTKV') || "',0
						 FROM dual 
						 UNION ALL 
						 SELECT 'a.nbs, ',':ITOG.nBS,','" || CurrentLangTable.GetAtomTitle('cTBS') || "',0
						 FROM dual " 
						|| IifS(nHaveTOBO=2, "
						 UNION ALL 
						 SELECT 'd.branch, b.name, ',':ITOG.sBRANCH,:ITOG.sBRANCHNAME,', '" || CurrentLangTable.GetAtomTitle('cTFilial') || "',0
						 FROM dual ", 
						IifS(nHaveTOBO=1, "
						 UNION ALL 
						 SELECT 'a.tobo, ',':ITOG.sBRANCH,','" || CurrentLangTable.GetAtomTitle('cTBranch') || "',0
						 FROM dual ", "")), TBL_FillAll)
				Set n3 = 0
				Set BD = GetBankDate()
				Set ITOG.strPrintFileName = 'DEPOSIT'
				Set sF1 = IifS(nUserId > 0, " and a.isp = "||Str(nUserId), "")
				If SalStrTrimX(sFilter) != STRING_Null
					Set sF1 = sF1||" and "||sFilter
				Call SalTblSetLockedColumns(hWndForm, 9)
				If DigInit() != -1
					Set nMaxDig = DigInit()
				Else
					Set nMaxDig = 4
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				Set OST1 = OST1 / SalNumberPower(10, DIG)
				Set DOS1 = DOS1 / SalNumberPower(10, DIG)
				Set KOS1 = KOS1 / SalNumberPower(10, DIG)
				Set SAL1 = SAL1 / SalNumberPower(10, DIG)
				Set OST2 = OST2 / SalNumberPower(10, DIG)
				Set DOS2 = DOS2 / SalNumberPower(10, DIG)
				Set KOS2 = KOS2 / SalNumberPower(10, DIG)
				Set SAL2 = SAL2 / SalNumberPower(10, DIG)
				If fKV
					Set ITOG.OST1 = ITOG.SAL1 + ITOG.DOS1 - ITOG.KOS1
					Set ITOG.OST2 = ITOG.SAL2 + ITOG.DOS2 - ITOG.KOS2
				Set ITOG.nKOL4 = ITOG.nKOL1 + ITOG.nKOL2 - ITOG.nKOL3
				!
				If ITOG.OST1 > 0 AND ITOG.OST1 != NUMBER_Null
					Set ITOG.RAT1 = ITOG.RAT1 / ITOG.OST1
				Else
					Set ITOG.RAT1 =0
				!
				If ITOG.SAL1 > 0 AND ITOG.SAL1 != NUMBER_Null
					Set ITOG.RAT2 = ITOG.RAT2 / ITOG.SAL1
				Else
					Set ITOG.RAT2 = 0
				!
				Set sOST1 = Dig4(OST1*SalNumberPower(10,DIG)/100, DIG, nMaxDig)
				Set sDOS1 = Dig4(DOS1*SalNumberPower(10,DIG)/100, DIG, nMaxDig)
				Set sKOS1 = Dig4(KOS1*SalNumberPower(10,DIG)/100, DIG, nMaxDig)
				Set sSAL1 = Dig4(SAL1*SalNumberPower(10,DIG)/100, DIG, nMaxDig)
				Set sOST2 = Dig4(OST2*SalNumberPower(10,DIG)/100, DIG, nMaxDig)
				Set sDOS2 = Dig4(DOS2*SalNumberPower(10,DIG)/100, DIG, nMaxDig)
				Set sKOS2 = Dig4(KOS2*SalNumberPower(10,DIG)/100, DIG, nMaxDig)
				Set sSAL2 = Dig4(SAL2*SalNumberPower(10,DIG)/100, DIG, nMaxDig)
			On SAM_ColumnSelectClick
				Call SalWaitCursor (TRUE)
				If wParam != nLastSortRow
					Set nLastSortRow = wParam
					Set nSortOrder = TBL_SortIncreasing
				Else
					Set nSortOrder = 1 - nSortOrder
				Set hColumn = SalNumberToWindowHandle(wParam)
				Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
				! сортировка строковых столбцов по числовым
				If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(sOST1), COL_GetID)
					Set wParam = SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(OST1), COL_GetID))
				If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(sDOS1), COL_GetID)
					Set wParam = SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(DOS1), COL_GetID))
				If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(sKOS1), COL_GetID)
					Set wParam = SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(KOS1), COL_GetID))
				If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(sSAL1), COL_GetID)
					Set wParam = SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(SAL1), COL_GetID))
				If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(sOST2), COL_GetID)
					Set wParam = SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(OST2), COL_GetID))
				If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(sDOS2), COL_GetID)
					Set wParam = SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(DOS2), COL_GetID))
				If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(sKOS2), COL_GetID)
					Set wParam = SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(KOS2), COL_GetID))
				If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(sSAL2), COL_GetID)
					Set wParam = SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(SAL2), COL_GetID))
				!
				Set hColumn = SalNumberToWindowHandle(wParam)
				Call SalTblSortRows( hWndForm, SalTblQueryColumnID(hColumn), nSortOrder)
				Call SalSendMsg(hWndForm, SAM_RowSetContext, 0, 0)
				Call SalWaitCursor(FALSE)
			On WM_Size
				Call SalGetWindowSize(hWndForm, nWW, nWH)
				If nWW >= 12.6
					If nWH < 4.5
						Call SalSetWindowSize(hWndForm, nWW, 4.5)
				Else
					If nWH < 4.5
						Call SalSetWindowSize(hWndForm, 12.6, 4.5)
					Else
						Call SalSetWindowSize(hWndForm, 12.6, nWH)
				Call GetClientRect(hWndForm, nX, nY, nW, nH)
				Call SalGetWindowSize(hWndForm.ITOG.Label, nCW, nCH)
				Call SalGetWindowLoc(hWndForm.ITOG.Label, nCX, nCY)
				Call SalSetWindowLoc(hWndForm.ITOG.Label,
						        SalPixelsToFormUnits(hWndForm, nW, FALSE)-nCW-0.1, nCY)
				Call SalInvalidateWindow(hWndForm)
			On UM_Print
				! Для друку відкриваєм колонки з числовими типом даних 
				Call SalShowWindow( nKV )
				Call SalShowWindow( OST1 )
				Call SalShowWindow( DOS1 )
				Call SalShowWindow( KOS1 )
				Call SalShowWindow( SAL1 )
				Call SalShowWindow( OST2 )
				Call SalShowWindow( DOS2 )
				Call SalShowWindow( KOS2 )
				Call SalShowWindow( SAL2 )
				! ховаєм текстові колонки
				Call SalHideWindow( sKV )
				Call SalHideWindow( sOST1 )
				Call SalHideWindow( sDOS1 )
				Call SalHideWindow( sKOS1 )
				Call SalHideWindow( sSAL1 )
				Call SalHideWindow( sOST2 )
				Call SalHideWindow( sDOS2 )
				Call SalHideWindow( sKOS2 )
				Call SalHideWindow( sSAL2 )
				! Синхронізуєм назви колонок
				Call SalTblGetColumnTitle(sKV, sTmp, 100)
				Call SalTblSetColumnTitle(nKV, sTmp)
				Call SalTblGetColumnTitle(sOST1, sTmp, 100)
				Call SalTblSetColumnTitle(   OST1, sTmp)
				Call SalTblGetColumnTitle(sDOS1, sTmp, 100)
				Call SalTblSetColumnTitle(   DOS1, sTmp)
				Call SalTblGetColumnTitle(sKOS1, sTmp, 100)
				Call SalTblSetColumnTitle(   KOS1, sTmp)
				Call SalTblGetColumnTitle(sSAL1, sTmp, 100)
				Call SalTblSetColumnTitle(   SAL1, sTmp)
				Call SalTblGetColumnTitle(sOST2, sTmp, 100)
				Call SalTblSetColumnTitle(   OST2, sTmp)
				Call SalTblGetColumnTitle(sDOS2, sTmp, 100)
				Call SalTblSetColumnTitle(   DOS2, sTmp)
				Call SalTblGetColumnTitle(sKOS2, sTmp, 100)
				Call SalTblSetColumnTitle(   KOS2, sTmp)
				Call SalTblGetColumnTitle( sSAL2, sTmp, 100)
				Call SalTblSetColumnTitle(   SAL2, sTmp)
				! ПОРТФЕЛЬ депозитних вкладів населення за період
				Call TablePrint( hWndForm,  CurrentLangTable.GetAtomTitle('ITOG.cTWndTitle') || ' ' || SalFmtFormatDateTime(DAT1, 'dd-MM-yyyy') || ' ' ||
						                                                        CurrentLangTable.GetAtomTitle('ITOG.cTWndTitle_')|| ' ' || SalFmtFormatDateTime(DAT2, 'dd-MM-yyyy'),
						                                GetPrnDir() || '\\DEPOSIT_FO.lst', '' )
				! Вертаєм назад все як було
				Call SalHideWindow( nKV )
				Call SalHideWindow( OST1 )
				Call SalHideWindow( DOS1 )
				Call SalHideWindow( KOS1 )
				Call SalHideWindow( SAL1 )
				Call SalHideWindow( OST2 )
				Call SalHideWindow( DOS2 )
				Call SalHideWindow( KOS2 )
				Call SalHideWindow( SAL2 )
				Call SalShowWindow( sKV )
				Call SalShowWindow( sOST1 )
				Call SalShowWindow( sDOS1 )
				Call SalShowWindow( sKOS1 )
				Call SalShowWindow( sSAL1 )
				Call SalShowWindow( sOST2 )
				Call SalShowWindow( sDOS2 )
				Call SalShowWindow( sKOS2 )
				Call SalShowWindow( sSAL2 )
	Table Window: tbl_Resource
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Привлеченный ресурс по срокам погашения
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.08"
				Top:    0.9"
				Width:  8.817"
				Width Editable? Class Default
				Height: 5.381"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000000
			Discardable? Class Default
		Description: Привлеченный ресурс
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.381"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.05"
						Top:    0.036"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 32365
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  3.267"
						Begin Y:  0.024"
						End X:  3.267"
						End Y:  0.488"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.183"
						Top:    0.036"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.617"
						Top:    0.036"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.067"
						Top:    0.036"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 32366
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.617"
						Begin Y:  -0.06"
						End X:  2.617"
						End Y:  0.405"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.733"
						Top:    0.036"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 32367
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  1.033"
						Begin Y:  Class Default
						End X:  1.033"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSynchro
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSynchro
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.483"
						Top:    0.036"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! По Дням/Месяцам
							Set strTip = CurrentLangTable.GetAtomTitle('tbl_Resource.cBTipSynchro')
						On SAM_Click
							Set bFlag = not bFlag
							Call SalSendMsg(hWndForm, UM_Populate, 0,0)
		Contents
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.757"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: LCV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: ISO
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.014"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MMDD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Год +Мес 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.014"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.2"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S	! сумма в вал.
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.371"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sS	! строковое значение с разделителем
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  2.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						отделения
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DIG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: DIG
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nUserId
			String: sPar1
			String: sFilter
		Window Variables
			String: sF1
			String: sF
			Boolean: bFlag
			Number: nWW
			Number: nWH
			Number: nColW
			Number: nMaxDig
			Number: nLastSortRow
			Number: nSortOrder
			Window Handle: hColumn
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tbl_Resource.cTWndTitle'))
				Call PrepareWindowEx(hWndForm)
				Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
				If nHaveTOBO = 0
					Call SalHideWindow(hWndForm.tbl_Resource.BRANCH)
				Else
					If nHaveTOBO = 2
						Call SalTblSetColumnTitle(BRANCH, 'Код
								подразделения')
					Call SalGetWindowSize(hWndForm, nWW, nWH)
					Call SalTblQueryColumnWidth(BRANCH, nColW)
					Call SalSetWindowSize(hWndForm, nWW + nColW, nWH)
				Call PrepareWindowEx(hWndForm)
				Set bFlag = TRUE
				Call XSalTooltipSetUserDefault()
				Set tbl_Resource.strPrintFileName = 'RESOURCE'
				Set tbl_Resource.strFilterTblName = 'DPT_1'
				Set tbl_Resource.sF1 = IifS(nUserId > 0, " and a.isp = "||Str(nUserId), "")
				If SalStrTrimX(sFilter) != STRING_Null
					Set tbl_Resource.sF1 = tbl_Resource.sF1||" and "||sFilter
				If DigInit() != -1
					Set nMaxDig = DigInit()
				Else
					Set nMaxDig = 4
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set sF = cF.GetFilterWhereClause(FALSE)
				If sF != ""
					Set sF = " AND " || sF
				If bFlag
					Set tbl_Resource.strSqlPopulate =
							   "SELECT dpt_1.kv, dpt_1.lcv, dpt_1.datk, 
							           sum(dpt_1.s)/power(10,tabval.dig), tabval.dig " || IifS(nHaveTOBO=0, "", ", dpt_1.branch") || "
							      INTO :tbl_Resource.KV, :tbl_Resource.LCV, 
							           :tbl_Resource.DAT, :tbl_Resource.S, :tbl_Resource.DIG " || IifS(nHaveTOBO=0, "", ", :tbl_Resource.BRANCH") || "
							      FROM dpt_1, tabval, accounts a 
							     WHERE dpt_1.kv=tabval.kv AND dpt_1.acc = a.acc " || sF1 || " 
							       AND dpt_1.s <> 0 " || sF || " 
							     GROUP BY dpt_1.kv, dpt_1.lcv, dpt_1.datk, tabval.dig " || IifS(nHaveTOBO=0, "", ", dpt_1.branch") || "
							     ORDER BY dpt_1.kv, dpt_1.datk"
				Else
					Set tbl_Resource.strSqlPopulate =
							   "SELECT dpt_1.kv, dpt_1.lcv, to_char(dpt_1.datk,'yyyy-mm'), 
							           sum(dpt_1.s)/power(10,tabval.dig), tabval.dig " || IifS(nHaveTOBO=0, "", ", dpt_1.branch") || "
							      INTO :tbl_Resource.KV, :tbl_Resource.LCV,
							           :tbl_Resource.MMDD, :tbl_Resource.S, :tbl_Resource.DIG " || IifS(nHaveTOBO=0, "", ", :tbl_Resource.BRANCH") || "
							      FROM dpt_1, tabval, accounts a 
							     WHERE dpt_1.kv=tabval.kv  AND dpt_1.acc = a.acc " || sF1 || " 
							       AND dpt_1.s <> 0 " || sF || "
							     GROUP BY dpt_1.kv, dpt_1.lcv, to_char(dpt_1.datk,'yyyy-mm'), tabval.dig " || IifS(nHaveTOBO=0, "", ", dpt_1.branch") || "
							     ORDER BY dpt_1.kv, to_char(dpt_1.datk,'yyyy-mm')  "
				Call SalTblPopulate(hWndForm, hSql(), tbl_Resource.strSqlPopulate, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				Set sS = Dig4(S * SalNumberPower(10, DIG) / 100, DIG, nMaxDig)
			On SAM_ColumnSelectClick
				Call SalWaitCursor (TRUE)
				If wParam != nLastSortRow
					Set nLastSortRow = wParam
					Set nSortOrder = TBL_SortIncreasing
				Else
					Set nSortOrder = 1 - nSortOrder
				Set hColumn = SalNumberToWindowHandle(wParam)
				Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
				! сортировка строковых столбцов по числовым
				If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(sS), COL_GetID)
					Set wParam = SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(S), COL_GetID))
				!
				Set hColumn = SalNumberToWindowHandle(wParam)
				Call SalTblSortRows( hWndForm, SalTblQueryColumnID(hColumn), nSortOrder)
				Call SalSendMsg(hWndForm, SAM_RowSetContext, 0, 0)
				Call SalWaitCursor(FALSE)
	Form Window: frm_ViddDetails
		Class: cQuickTabsForm
		Property Template:
		Class DLL Name:
		Title: Карточка вида вклада
		Icon File:
		Accesories Enabled? Yes
		Visible? No
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? No
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Yes
			Window Location and Size
				Left:   1.1"
				Top:    1.375"
				Width:  12.9"
				Width Editable? Class Default
				Height: 5.905"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description: Карточка вида вклада
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.429"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbUpdate
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbUpdate
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.033"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! 'Изменить параметры вида договора'
							Set strTip = CurrentLangTable.GetAtomTitle('frm_ViddDetails.cBTipUpdate')
						On SAM_Click
							Set nSROK_ADD = mSROK_ADD+(dSROK_ADD/100)
							If CheckData()
								If NotNullData() 
									If CheckDuplicates ()
										If pVidd != NUMBER_Null AND pVidd != 0 
											If SqlPrepareAndExecute( hSql(),
													"UPDATE dpt_vidd
													           SET type_name = :sTYPE_NAME,
													 type_cod = :sTYPE_COD, 
													 kv = :nKV, 
													 bsd = :sBSD, 
													 bsn = :sBSN, 
													 bsa = :sBSA, 
													 duration  = :mDURATION, 
													 duration_days = :dDURATION, 
													 duration_max = :mDURATION_MAX, 
													 duration_days_max = :dDURATION_MAX, 
													 term_type = :nTermType,
													 min_summ = :nMIN_SUMM, 
													 limit = :nLIMIT, 
													 max_limit = :nMAX_LIMIT, 
													 term_add = :nSROK_ADD,
													 basey = :nBASEY, 
													 metr = :nMETR, 
													 amr_metr = :nAMRMETR, 
													 freq_n = :nFREQN, 
													 tip_ost = :nOST, 
													 tt = :sTT, 
													 acc7 = :nACC7,
													 br_id = :nBR, 
													 basem = :cbFIXRATE, 
													 br_id_l = :nBRL, 
													 freq_k = :nFREQV, 
													 comproc = :cbCOMPROC, 
													 id_stop = :nSTOP, 
													 br_wd = :nBRW, 
													 fl_dubl = :nFlDubl, 
													 fl_2620 = :cbPerekr, 
													 term_dubl = :nTERM_DUBL, 
													 extension_id = :nEXT,
													 comments = :sCOMMENTS, 
													 idg = :nIDG, 
													 ids = :nIDS, 
													 nls_k = :sNLSD_K, 
													 nlsn_k = :sNLSN_K, 
													 datn = :dDATN, 
													 datk = :dDATK, 
													 kodz = :nKODZ, 
													 fmt = :nFORMAT,
													 AUTO_ADD = :AUTO_ADD,
													 DISABLE_ADD = :DISABLE_ADD
													 WHERE vidd = :nVIDD")
													AND SqlCommitEx( hSql(), CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTViddUpdate') || ' '||Str(nVIDD)||' '||sTYPE_NAME)
												! Изменены параметры вида вклада №
												Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessViddUpdate')||Str(nVIDD)||' '||sTYPE_NAME, 
														     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconAsterisk )
												Call F_POPULATE()
											Else
												! Не удалось сохранить параметры вида вклада №
												Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessViddNotSave') || ' '||Str(nVIDD)||' '||sTYPE_NAME, 
														     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop)
										Else
											If SqlPrepareAndExecute( hSql(),
													  "SELECT s_dpt_vidd.NEXTVAL INTO :nVIDD FROM dual")
													and not SqlFetchNext( hSql(), nFetchRes )
												! Не удалось получить код вида вклада
												Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessViddNotGet'), 
														     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop)
											Else
												If SqlPrepareAndExecute( hSql(),
														"INSERT INTO dpt_vidd 
														  (vidd, type_name, flag, type_cod, kv,
														   bsd, bsn,  bsa, term_type,
														   duration, duration_days, duration_max, duration_days_max,
														   min_summ, limit, max_limit, term_add,
														   basey, metr, amr_metr, freq_n, tip_ost, tt, acc7,
														   br_id, basem, br_id_l, freq_k, comproc, id_stop, br_wd, 
														   fl_dubl, fl_2620, term_dubl,  extension_id,
														   comments, idg, ids, nls_k, nlsn_k, datn, datk, 
														   kodz, fmt, auto_add, disable_add) 
														VALUES 
														  (:nVIDD,:sTYPE_NAME,0,:sTYPE_COD,:nKV,
														   :sBSD, :sBSN, :sBSA, :nTermType,
														   :mDURATION, :dDURATION, :mDURATION_MAX, :dDURATION_MAX,
														   :nMIN_SUMM,:nLIMIT,:nMAX_LIMIT,:nSROK_ADD,
														   :nBASEY,:nMETR,:nAMRMETR,:nFREQN,:nOST,:sTT,:nACC7, 
														   :nBR,:cbFIXRATE,:nBRL,:nFREQV,:cbCOMPROC,:nSTOP,:nBRW,
														   :nFlDubl, :cbPerekr, :nTERM_DUBL,:nEXT,
														   :sCOMMENTS,:nIDG,:nIDS,:sNLSD_K,:sNLSN_K,
														   :dDATN,:dDATK,:nKODZ,:nFORMAT,:AUTO_ADD,:DISABLE_ADD )") 
														and SqlCommitEx( hSql(),CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTViddCreate') || ' '||Str(nVIDD)||' '||sTYPE_NAME)
													! SqlCommitEx( hSql(),'Создан вид вклада '||Str(nVIDD)||' '||sTYPE_NAME)
													Set pVidd = nVIDD
													! Создан вид вклада №
													Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTViddCreate') || ' №'||Str(nVIDD)||' '||sTYPE_NAME, 
															     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconAsterisk )
													Call F_POPULATE()
												Else
													! Не удалось создать вид вклада
													Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessViddNotCreate') || ' '||sTYPE_NAME,
															     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop)
				Pushbutton: pbRefresh
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRefresh
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.467"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Перечитать
							Set strTip = CurrentLangTable.GetAtomTitle('frm_ViddDetails.cBTipRefresh')
						On SAM_Click
							If nVIDD != NUMBER_Null AND nVIDD != 0 
								Call F_POPULATE()
							Else
								Call F_START()
				Pushbutton: pb_TT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbChilds
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.9"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Childs.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Допустимые операции для данного вида вклада
							Set strTip = CurrentLangTable.GetAtomTitle('frm_ViddDetails.cBTipTT')
						On SAM_Click
							If not IsWindow(hWinTT)
								Set hWinTT = SalCreateWindow(frm_BindTts, hWndMDI, nVIDD)
				Pushbutton: pb_Templates
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbChilds
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.333"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\doc.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Допустимые шаблоны договоров для данного вида вклада
							Set strTip = CurrentLangTable.GetAtomTitle('frm_ViddDetails.cBTipTemplates')
						On SAM_Click
							If not IsWindow(hWinTemplates)
								Set hWinTemplates = SalCreateWindow(frm_BindTemplate,hWndMDI,nVIDD)
				Pushbutton: pb_Fields
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbChilds
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.767"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\SMTHING.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Допустимые доп.реквизиты для данного вида вклада
							Set strTip = CurrentLangTable.GetAtomTitle('frm_ViddDetails.cBTipFields')
						On SAM_Click
							If not IsWindow(hWinField)
								Set hWinField = SalCreateWindow(frm_BindFields,hWndMDI,nVIDD)
				Pushbutton: pb_Users
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbChilds
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.217"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\CUSTPERS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Допустимые пользователи для данного вида вклада
							Set strTip = CurrentLangTable.GetAtomTitle('frm_ViddDetails.cBTipUsers')
						On SAM_Click
							If GetGlobalOptionEx( 'DPT_ADM' ) = 0
								! Не включена опция администрирования видов вкладов
								Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessViddOpc'),
										     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconInformation )
							Else
								If not IsWindow(hWinUser)
									Set hWinUser = SalCreateWindow(frm_BindUsers,hWndMDI,nVIDD)
				Pushbutton: pb_Branches
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.667"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\CUSTBANK.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Допустимые подразделения для данного вида вклада
							Set strTip = CurrentLangTable.GetAtomTitle('frm_ViddDetails.cBTipBranches')
						On SAM_Click
							If GetGlobalOptionEx('DPT_ADM') = 2
								If not IsWindow(hWinBranch)
									Set hWinBranch = SalCreateWindow(frm_BindBranches, hWndMDI, nVIDD)
							Else
								! Не включена опция администрирования видов вкладов по подразделениям
								Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessViddOpcB'),
										                   CurrentLangTable.GetAtomTitle('cTAt'), 
										                   MB_IconInformation)
				Pushbutton: pbTags
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.117"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\CREATE.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Значения доп.парметров для данного вида вклада
							Set strTip = CurrentLangTable.GetAtomTitle('frm_ViddDetails.cBTipTags')
						On SAM_Click
							If not IsWindow(hWinViddParams)
								Set hWinViddParams = SalCreateWindow(frm_ViddParams, hWndMDI, nVIDD, sTYPE_NAME, nEdit)
							Else
								Call SalBringWindowToTop(hWinViddParams)
				Line
					Resource Id: 42919
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  3.717"
						Begin Y:  0.024"
						End X:  3.717"
						End Y:  0.452"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: Default
				Pushbutton: pbCancel
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbCancel
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.833"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Завершить
							Set strTip = CurrentLangTable.GetAtomTitle('frm_ViddDetails.cBTipCancel')
						On SAM_Click
							Call SalDestroyWindow(hWndForm)
		Contents
			Picture: picTabs
.data CLASSPROPS
0000: 546162557365466F 6E74000700437573 746F6D0000546162 466F6E744E616D65
0020: 000E004D53205361 6E73205365726966 00005461624C6566 744D617267696E00
0040: 0200300000546162 43757272656E7400 0500546162310000 546162426F74746F
0060: 6D4D617267696E00 0200300000546162 50616765436F756E 7400020031000054
0080: 61624C6162656C73 005500CEF1EDEEE2 EDFBE520EFE0F0E0 ECE5F2F0FB09CFE0
00A0: F0E0ECE5F2F0FB20 EDE0F7E8F1EBE5ED E8FF20252509CFE0 F0E0ECE5F2F0FB20
00C0: E2EEE7E2F0E0F2E0 20E4E5EFEEE7E8F2 E009C4EEEF2EEFE0 F0E0ECE5F2F0FB00
00E0: 005461624E616D65 7300140054616231 0954616232095461 6233095461623400
0100: 0054616252696768 744D617267696E00 0200300000546162 447261775374796C
0120: 65000B0057696E39 355374796C650000 546162466F726D50 6167657300040009
0140: 0909000054616254 6F704D617267696E 0002003000005461 624F7269656E7461
0160: 74696F6E00010000 00546162466F6E74 53697A6500020038 0000000000000000
0180: 0000000000000000 0000000000000000 000000000000
.enddata
.data CLASSPROPSSIZE
0000: 9601
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cQuickTabsForm
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				File Name:
				Storage: Class Default
				Picture Transparent Color: Class Default
				Fit: Class Default
				Scaling
					Width:  Class Default
					Height:  Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Tile To Parent? Yes
				Border Color: Black
				Background Color: 3D Face Color
				Message Actions
					On SAM_Create
						Call SalSendClassMessage(SAM_Create, wParam, lParam)
						Call picTabs.SetLabel(0, ' ' || CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTabs0') || ' ', TRUE)
						Call picTabs.SetLabel(1, ' ' || CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTabs1') || ' ', TRUE)
						Call picTabs.SetLabel(2, ' ' || CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTabs2') || ' ', TRUE)
						Call picTabs.SetLabel(3, ' ' || CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTabs3') || ' ', TRUE)
						! Показываем первую закладку
					On __TABSM_TabActivate
						Call SalSendClassMessage(__TABSM_TabActivate, 0, 0)
						Call SalSendMsg(sBSA, SAM_User, 0, 0)
						Call ShowTierRate()
						If ( ( GetGlobalOption( 'BANKTYPE' ) = 'SBER' ) AND ( picTabs.GetTop() = 1 ) )
							Call SalHideWindow( sNLS7 )
							Call SalHideWindow( sNMS7 )
							Call SalHideWindowAndLabel( bgNLS7 )
			!
			! Закладка "Основные параметры"
			!
			Frame
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42959
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    0.5"
					Width:  12.1"
					Width Editable? Yes
					Height: 1.84"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
			Background Text: Наименование вида вклада:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 27535
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    0.631"
					Width:  3.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgVIDD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: nVIDD
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    0.6"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 8
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Код вида вклада 
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipVIDD'))
			Data Field: sTYPE_NAME
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 50
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   5.1"
						Top:    0.595"
						Width:  5.15"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Наименование вида вклада
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipTYPE_NAME'))
			Data Field: sTYPE_COD
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 4
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   10.3"
						Top:    0.595"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Тип вклада
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipTYPE_COD'))
			Background Text: Валюта вклада:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 27538
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    0.9"
					Width:  3.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgKV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: nKV
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    0.857"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: MS Sans Serif
					Font Size: 8
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Код валюты вклада
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipKV'))
			Combo Box: cmbKV
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   5.12"
					Top:    0.857"
					Width:  6.0"
					Width Editable? Class Default
					Height: 1.655"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbKV.Init(hWndItem)
						Call cmbKV.Populate(hSql(), "KV","NAME","TABVAL"," WHERE d_close IS NULL ORDER BY 1 desc")
						Call cmbKV.SetSelectById(nKV)
					On SAM_Click
						Set nKV = cmbKV.GetKey(SalListQuerySelection(cmbKV))
						If SqlPrepareAndExecute(hSql(),
								  "SELECT lcv, dig INTO :sLCV, :nDig FROM tabval WHERE kv = :nKV")
								and SqlFetchNext( hSql(), nFetchRes )
						If nDig
							Call SalFmtSetPicture(nMIN_SUMM,  '# ##0' || getDecPoint() || SalStrRepeatX('0',nDig))
							Call SalFmtSetPicture(nLIMIT,     '# ##0' || getDecPoint() || SalStrRepeatX('0',nDig))
							Call SalFmtSetPicture(nMAX_LIMIT, '# ##0' || getDecPoint() || SalStrRepeatX('0',nDig))
					On SAM_TooltipSetText
						! Наименование валюты вклада
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipCmbKV'))
			Data Field: sLCV
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.1"
						Top:    1.119"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: MS Sans Serif
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Наименование валюты вклада (ISO)
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipLCV'))
			Data Field: bgDURATION
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: bgDURATION_M
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: bgDURATION_D
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Background Text: Минимальная сумма:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 27539
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    1.155"
					Width:  3.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgMIN_SUMM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: nMIN_SUMM
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    1.119"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: MS Sans Serif
					Font Size: 8
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Минимальная сумма вклада
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipMIN_SUMM'))
					On SAM_Validate
						Return IifN(nMIN_SUMM != NUMBER_Null AND nMIN_SUMM < 0, VALIDATE_Cancel, VALIDATE_Ok)
			!
			!
			Background Text: Балансовые счета
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 20865
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    2.369"
					Width:  3.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: gboxBS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Check Box: cbAmortisation
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data CLASSPROPSSIZE
0000: 1600
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCheckBoxLabeled
				Property Template:
				Class DLL Name:
				Title: Авансовый вклад
				Window Location and Size
					Left:   4.2"
					Top:    2.571"
					Width:  2.167"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalSendMsg(sBSA, SAM_User, 0, 0)
			Background Text: Баланс.счет депозитного счета:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42922
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    2.857"
					Width:  3.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgBSD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: sBSD
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 4
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    2.821"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Балансовый счет вклада
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipBSD'))
					On SAM_Validate
						If SqlPrepareAndExecute( hSql(), " SELECT nbs, name INTO :sBSD, :sBSDn FROM ps WHERE nbs = :sBSD" )
								AND SqlFetchNext(hSql(), nFetchRes)
							Set sBSN = Subs( sBSD, 1, 3 ) || '8' 
							Call SalSendMsg( sBSN, SAM_Validate, 0, 0 )
							If ( ( nACC7 = NUMBER_Null OR nACC7 = 0 ) AND GetGlobalOption( 'BANKTYPE' ) != 'SBER' )
								If SqlPrepareAndExecute(hSql(),
										" SELECT a.nls, a.acc, a.nms 
										         INTO :sNLS7,:nACC7,:sNMS7  
										       FROM proc_dr p, accounts a 
										    WHERE a.kv = :n980 
										      AND a.nls = decode(:nKV,:n980,p.g67,p.v67) 
										      AND p.nbs = :sBSD 
										      AND p.sour = 4 
										      AND p.rezid = 0")
										and SqlFetchNext(hSql(),nFetchRes)
							Return VALIDATE_Ok
						Else
							! Бал.счет <...> отсутствует в плане счетов
							Call SalMessageBox(sBSD || " - " || CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTErrBS'),
									     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop)
							Return VALIDATE_Cancel
			Data Field: sBSDn
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.1"
						Top:    2.821"
						Width:  6.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Балансовый счет вклада
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipBSD'))
			Background Text: Баланс.счет начисленных %%:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42923
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    3.119"
					Width:  3.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgBSN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: sBSN
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 4
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    3.083"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Балансовый счет начисленных процентов
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipBSN'))
					On SAM_Validate
						If SqlPrepareAndExecute( hSql(),
								  "SELECT nbs, name INTO :sBSN,:sBSNn FROM ps WHERE nbs = :sBSN")
								and SqlFetchNext( hSql(), nFetchRes )
							Return VALIDATE_Ok
						Else
							! Баланс.счет <...> отсутствует в плане счетов
							Call SalMessageBox(sBSN || " - " || CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTErrBS'),
									     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop)
							Return VALIDATE_Cancel
			Data Field: sBSNn
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.1"
						Top:    3.083"
						Width:  6.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Балансовый счет начисленных процентов
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipBSN'))
			Background Text: Баланс.счет амортизац.%%:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42924
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    3.369"
					Width:  3.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgBSA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: sBSA
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 4
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    3.333"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If SqlPrepareAndExecute( hSql(),
								  "SELECT nbs, name INTO :sBSA,:sBSAn FROM ps WHERE nbs = :sBSA")
								and SqlFetchNext( hSql(), nFetchRes )
							Return VALIDATE_Ok
						Else
							! Баланс.счет <...> отсутствует в плане счетов
							Call SalMessageBox(sBSA || " - " || CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTErrBS'),
									     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop)
							Return VALIDATE_Cancel
					On SAM_TooltipSetText
						! Балансовый счет амортизации
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipBSA'))
					On SAM_User
						If picTabs.GetTop() = 0
							If cbAmortisation
								If (nVIDD = NUMBER_Null OR nVIDD = 0)
									Call SalEnableWindow(sBSA)
								Else
									Call SalDisableWindow(sBSA)
								Call SalShowWindow(nAMRMETR)
								Call SalShowWindow(cmbAMRMETR)
							Else
								Set sBSA = STRING_Null
								Set sBSAn = STRING_Null
								Set nAMRMETR = 0
								Call SalDisableWindow(sBSA)
								Call SalHideWindow(nAMRMETR)
								Call SalHideWindow(cmbAMRMETR)
						Else
							Call SalHideWindow(nAMRMETR)
							Call SalHideWindow(cmbAMRMETR)
			Data Field: sBSAn
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.1"
						Top:    3.333"
						Width:  6.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Балансовый счет амортизации
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipBSA'))
			Background Text: Метод начисления:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 60209
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    1.25"
					Width:  3.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgAMRMETR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: nAMRMETR
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.4"
						Top:    2.571"
						Width:  0.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Код метода амортизации процентов
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipAMRMETR'))
			Combo Box: cmbAMRMETR
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   7.017"
					Top:    2.571"
					Width:  4.083"
					Width Editable? Class Default
					Height: 0.881"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbAMRMETR.Init(hWndItem)
						Call cmbAMRMETR.Populate(hSql(),"METR","NAME","INT_METR","ORDER BY 1")
						Call cmbAMRMETR.SetSelectById(nAMRMETR)
					On SAM_Click
						Set nAMRMETR = cmbAMRMETR.GetKey(SalListQuerySelection(cmbAMRMETR))
					On SAM_TooltipSetText
						! Наименование метода амортизации процентов
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipCmbAMRMETR'))
			!
			Background Text: Пополнение вклада
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 20864
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    3.667"
					Width:  3.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: gboxVklad
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Background Text: Миним.сумма пополнения:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 27548
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    3.952"
					Width:  3.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgLIMIT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: nLIMIT
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    3.917"
						Width:  1.583"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						Return IifN(nLIMIT != NUMBER_Null AND nLIMIT < 0, VALIDATE_Cancel, VALIDATE_Ok)
					On SAM_TooltipSetText
						! Минимальная сумма пополнения
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipLIMIT'))
			Background Text: Максим.сумма пополнения:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 27547
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    4.214"
					Width:  3.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgMAX_LIMIT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: nMAX_LIMIT
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    4.179"
						Width:  1.583"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						Return IifN(nMAX_LIMIT != NUMBER_Null AND nMAX_LIMIT < 0, VALIDATE_Cancel, VALIDATE_Ok)
					On SAM_TooltipSetText
						! Максимальная сумма пополнения
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipMAX_LIMIT'))
			Background Text: Срок пополнения:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42928
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    4.464"
					Width:  3.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgSROK_ADD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: mSROK_ADD
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    4.429"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If mSROK_ADD < 0 OR SalIsNull(mSROK_ADD)
							Return VALIDATE_Cancel
						Else
							Set nSROK_ADD = mSROK_ADD + (dSROK_ADD/100)
							Return VALIDATE_Ok
					On SAM_TooltipSetText
						! Срок пополнения в месяцах
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipSROK_ADD_M'))
			Background Text: мес. +
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 27542
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.1"
					Top:    4.464"
					Width:  1.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgSROK_ADD_M
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dSROK_ADD
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.2"
						Top:    4.429"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If dSROK_ADD < 0 OR dSROK_ADD > 30
							Return VALIDATE_Cancel
						Else
							Set nSROK_ADD = mSROK_ADD + (dSROK_ADD/100)
							Return VALIDATE_Ok
					On SAM_TooltipSetText
						! Срок пополнения в днях
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipSROK_ADD_D'))
			Background Text: дней
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 27536
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   7.1"
					Top:    4.464"
					Width:  0.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgSROK_ADD_D
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			!
			! Background Text: Период действия вида вклада:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.4"
					Top:    1.714"
					Width:  1.883"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
.end
			! cLabelControl: bgDATN
.winattr class Data Field:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  0.0"
						Width Editable? No
						Height: 0.0"
						Height Editable? No
					Visible? No
					Border? No
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: 3D Face Color
					Input Mask: Unformatted
.end
				                                   Message Actions 
			Data Field: dDATN
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.2"
						Top:    1.7"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Дата начала действия вида вклада
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipDATN'))
			Background Text: -
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42934
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.4"
					Top:    1.679"
					Width:  0.6"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: MS Sans Serif
				Font Size: 12
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dDATK
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   9.0"
						Top:    1.7"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.3"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Дата окончания действия вида вклада
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipDATK'))
			!
			! Закладка "Параметры начисления %%"
			!
			Background Text: Начисление %%
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 20866
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    0.5"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: gboxProc1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Background Text: Базовые параметры:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42939
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    0.738"
					Width:  3.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgBASEY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: nBASEY
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    0.7"
						Width:  0.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Код базового года
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipBASEY'))
			Combo Box: cmbBASEY
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   4.9"
					Top:    0.702"
					Width:  5.0"
					Width Editable? Class Default
					Height: 2.119"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbBASEY.Init(hWndItem)
						Call cmbBASEY.Populate(hSql(),"BASEY","NAME","BASEY","ORDER BY 1")
						Call cmbBASEY.SetSelectById( nBASEY )
					On SAM_Click
						Set nBASEY = cmbBASEY.GetKey( SalListQuerySelection( cmbBASEY))
					On SAM_TooltipSetText
						! Наименование базового года
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipCmbBASEY'))
			Background Text: Периодичность начисления %%:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42942
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    0.988"
					Width:  3.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgFREQN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: nFREQN
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    0.957"
						Width:  0.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Код периодичности начисления %%
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipFREQN'))
			Combo Box: cmbFREQN
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623200000000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   4.9"
					Top:    0.952"
					Width:  5.0"
					Width Editable? Class Default
					Height: 1.81"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbFREQN.Init(hWndItem)
						Call cmbFREQN.Populate(hSql(),"FREQ","NAME","FREQ","ORDER BY 1")
						Call cmbFREQN.SetSelectById( nFREQN )
					On SAM_Click
						Set nFREQN = cmbFREQN.GetKey(SalListQuerySelection( cmbFREQN))
					On SAM_TooltipSetText
						! Периодичность начисления %%
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipCmbFREQN'))
			Background Text: Метод начисления:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42941
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    1.25"
					Width:  3.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgMETR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: nMETR
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    1.214"
						Width:  0.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Код метода расчета процентов
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipMETR'))
			Combo Box: cmbMETR
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623200000000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   4.9"
					Top:    1.214"
					Width:  5.0"
					Width Editable? Class Default
					Height: 1.5"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbMETR.Init(hWndItem)
						Call cmbMETR.Populate(hSql(),"METR","NAME","INT_METR","ORDER BY 1")
						Call cmbMETR.SetSelectById( nMETR )
					On SAM_Click
						Set nMETR = cmbMETR.GetKey( SalListQuerySelection( cmbMETR))
					On SAM_TooltipSetText
						! Наименование метода расчета процентов
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipCmbMETR'))
			Data Field: sTT
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 3
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.95"
						Top:    1.202"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Код операции по начислению процентов
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipTT'))
			Background Text: Тип вычисления остатка:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 20874
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    1.512"
					Width:  3.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgOST
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: nOST
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    1.471"
						Width:  0.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Код метода расчета остатка
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipOST'))
			Combo Box: cmbOST
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623200000000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   4.9"
					Top:    1.476"
					Width:  5.0"
					Width Editable? Yes
					Height: 1.19"
					Height Editable? Yes
				Visible? No
				Editable? No
				String Type: String
				Maximum Data Length: Default
				Sorted? No
				Always Show List? No
				Vertical Scroll? Yes
				Font Name: Default
				Font Size: 8
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Input Mask: Unformatted
				List Initialization
				Message Actions
					On SAM_Create
						! If cmbOST.Init( hWndItem )
							                                                                                                                                    Call SalListClear(hWndItem)
							! Исключая последний день
							                                                                                                                                    Call cmbOST.Add(0, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTOst0')) 
							! Исключая первый и последний дни
							                                                                                                                                    Call cmbOST.Add(1, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTOst1'))
							                                                                                                                                    Call cmbOST.SetSelectById( nOST )
						Call cmbOST.Init(hWndItem)
						Call cmbOST.Populate(hSql(),"IO", "NAME", "INT_ION", "ORDER BY 1")
						Call cmbOST.SetSelectById(nOST)
					On SAM_Click
						Set nOST = cmbOST.GetKey(SalListQuerySelection(cmbOST))
			Background Text: Аналитический счет расходов:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 27544
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    1.762"
					Width:  3.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgNLS7
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: sNLS7
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 14
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    1.728"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If NOT SalIsNull(sNLS7)
							If SqlPrepareAndExecute(hSql(),
									   "SELECT acc, nms INTO :nACC7,:sNMS7
									      FROM accounts
									     WHERE kv = :n980 AND nls = :sNLS7 AND dazs IS NULL")
								If not SqlFetchNext( hSql(), nFetchRes)
									Return VALIDATE_Cancel
						Else
							Set nACC7 = NUMBER_Null
							Set sNMS7 = STRING_Null
						Return VALIDATE_Ok
					On SAM_TooltipSetText
						! Cчет расходов
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipNLS7'))
			Data Field: sNMS7
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.067"
						Top:    1.726"
						Width:  3.833"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Cчет расходов
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipNLS7'))
			!
			Background Text: Выплата %%
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 20868
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    2.1"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: gboxProc2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Background Text: Периодичность выплаты %%:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42943
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    2.429"
					Width:  3.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgFREQV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: nFREQV
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    2.393"
						Width:  0.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Код периодичности выплаты %%
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipFREQV'))
			Combo Box: cmbFREQV
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   4.9"
					Top:    2.393"
					Width:  5.0"
					Width Editable? Class Default
					Height: 1.19"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbFREQV.Init(hWndItem)
						Call cmbFREQV.Populate(hSql(),"FREQ","NAME","FREQ","ORDER BY 1")
						Call cmbFREQV.SetSelectById( nFREQV )
					On SAM_Click
						Set nFREQV = cmbFREQV.GetKey(SalListQuerySelection(cmbFREQV))
					On SAM_TooltipSetText
						! Периодичность выплаты %%
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipCmbFREQV'))
			Check Box: cbCOMPROC
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data CLASSPROPSSIZE
0000: 1600
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCheckBoxLabeled
				Property Template:
				Class DLL Name:
				Title: Капитализация начисленных процентов
				Window Location and Size
					Left:   4.2"
					Top:    2.65"
					Width:  5.667"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
				Message Actions
			!
			Background Text: %% ставка
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 20869
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    3.0"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: gboxProc3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Background Text: Процентная ставка по вкладу:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42944
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    3.286"
					Width:  3.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgBR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: nBR
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    3.25"
						Width:  0.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Код основной процентной ставки
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipBR'))
					On SAM_Validate
						If SalIsNull(nBR)
							Call SalListSetSelect(cmbBR, -1)
							Return VALIDATE_OkClearFlag
						Call cmbBR.SetSelectById(nBR)
						If cmbBR.nCurrentId
							Call SalSendMsg(cmbBR, SAM_Click, 0, 0)
							Return VALIDATE_Ok
						Else
							Return VALIDATE_Cancel
			Combo Box: cmbBR
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   4.9"
					Top:    3.25"
					Width:  5.0"
					Width Editable? Class Default
					Height: 1.345"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbBR.Init(hWndItem)
						Call cmbBR.Populate(hSql(),"BR_ID","NAME","BRATES","WHERE INUSE = 1 ORDER BY 1")
						Call cmbBR.SetSelectById(nBR)
					On SAM_Click
						Call SalClearField(DAT_BRAT)
						Call SalClearField(nPROC)
						Set nBR = cmbBR.GetKey( SalListQuerySelection( cmbBR))
						! тип ставки
						If SqlPrepareAndExecute(hSql(),
								   "SELECT br_type INTO :nBRTYPE FROM brates WHERE br_id = :nBR")
							Call SqlFetchNext( hSql(), nFetchRes)
						If nBRTYPE = 1
							If SqlPrepareAndExecute(hSql(),
									   "SELECT max(BDATE) INTO :DAT_BRAT 
									      FROM br_normal 
									     WHERE bdate <= bankdate AND kv = :nKV AND br_id = :nBR")
									and SqlFetchNext( hSql(), nFetchRes)
									and SqlPrepareAndExecute(hSql(),
									   "SELECT RATE INTO :nPROC 
									      FROM br_normal 
									    WHERE kv = :nKV AND br_id = :nBR AND bdate = :DAT_BRAT")
									and SqlFetchNext( hSql(), nFetchRes)
						Call ShowTierRate()
					On SAM_TooltipSetText
						! Наименование основной процентной ставки
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipCmbBR'))
			Data Field: DAT_BRAT
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.95"
						Top:    3.25"
						Width:  1.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: MS Sans Serif
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Последняя дата установки основной процентной ставки
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipDAT_BRAT'))
			Data Field: nPROC
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   11.1"
						Top:    3.25"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: MS Sans Serif
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Актуальное значение основной процентной ставки
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipPROC'))
			Check Box: cbFIXRATE
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data CLASSPROPSSIZE
0000: 1600
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCheckBoxLabeled
				Property Template:
				Class DLL Name:
				Title: Признак фиксированной процентной ставки
				Window Location and Size
					Left:   4.2"
					Top:    3.55"
					Width:  5.683"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
				Message Actions
			Pushbutton: pbTierBrate
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbPlainButton
				Property Template:
				Class DLL Name:
				Title: Ступ.ставка
				Window Location and Size
					Left:   9.95"
					Top:    3.548"
					Width:  1.967"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If not IsWindow(hWinTB) AND nBR != NUMBER_Null AND nKV != NUMBER_Null   
							Set hWinTB = SalCreateWindow(tbl_BrateDetails, hWndMDI, nBR, cmbBR, nKV)
			!
			Background Text: Досрочное расторжение
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 20867
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    3.9"
					Width:  3.6"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: gboxProc4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Background Text: Штраф:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42946
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    4.131"
					Width:  3.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgSTOP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: nSTOP
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    4.1"
						Width:  0.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Код штрафа
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipSTOP'))
			Combo Box: cmbSTOP
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   4.9"
					Top:    4.095"
					Width:  5.0"
					Width Editable? Class Default
					Height: 1.655"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbSTOP.Init(hWndItem)
						Call cmbSTOP.Populate(hSql(),"ID","NAME","DPT_STOP","ORDER BY 1")
						Call cmbSTOP.SetSelectById( nSTOP )
					On SAM_Click
						Set nSTOP = cmbSTOP.GetKey( SalListQuerySelection( cmbSTOP))
					On SAM_TooltipSetText
						! Наименование штрафа
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipCmbSTOP'))
			Background Text: Ставка для частичного снятия:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42945
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    4.393"
					Width:  3.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgBRW
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: nBRW
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    4.357"
						Width:  0.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Код процентной ставки для част.снятия
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipBRW'))
			Combo Box: cmbBRW
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   4.9"
					Top:    4.357"
					Width:  5.0"
					Width Editable? Class Default
					Height: 1.345"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbBRW.Init(hWndItem)
						Call cmbBRW.Populate(hSql(),"BR_ID","NAME","BRATES","ORDER BY 1")
						Call cmbBRW.SetSelectById( nBRW )
					On SAM_Click
						Call SalClearField(DAT_WD)
						Call SalClearField(nPROC_WD)
						Set nBRW = cmbBRW.GetKey( SalListQuerySelection(cmbBRW))
						If SqlPrepareAndExecute(hSql(),
								   "SELECT max(BDATE) INTO :DAT_WD FROM br_normal 
								    WHERE bdate<=bankdate AND kv=:nKV AND BR_ID=:nBRW")
								and SqlFetchNext( hSql(), nFetchRes)
								and SqlPrepareAndExecute(hSql(),
								   "SELECT RATE INTO :nPROC_WD FROM br_normal 
								    WHERE kv=:nKV AND BR_ID=:nBRW AND bdate=:DAT_WD")
								and SqlFetchNext( hSql(), nFetchRes)
					On SAM_TooltipSetText
						! Наименование процентной ставки для част.снятия
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipCmbBRW'))
			Data Field: nPROC_WD
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   11.1"
						Top:    4.357"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: MS Sans Serif
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Последнее значение процентной ставки пролонгации
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipPROC_WD'))
			Data Field: DAT_WD
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.95"
						Top:    4.357"
						Width:  1.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: MS Sans Serif
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Последняя дата установки процентной ставки пролонгации
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipDAT_WD'))
			!
			! Закладка "Параметры возврата депозита"
			!
			Frame
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42949
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    0.5"
					Width:  12.1"
					Width Editable? Yes
					Height: 2.345"
					Height Editable? Yes
				Visible? No
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: Default
			Check Box: cbPerekr
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCheckBoxLabeled
				Property Template:
				Class DLL Name:
				Title: Перенос на технический вклад/счет
				Window Location and Size
					Left:   0.4"
					Top:    0.7"
					Width:  8.683"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? No
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call ManageCheckButtons3()
			!
			Check Box: cbExtent1
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCheckBoxLabeled
				Property Template:
				Class DLL Name:
				Title: АВТО-переоформление
				Window Location and Size
					Left:   0.4"
					Top:    1.167"
					Width:  4.0"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? No
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If cbExtent1 = TRUE
							Set cbExtent2 = FALSE
						Call ManageCheckButtons3()
			Check Box: cbExtent2
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCheckBoxLabeled
				Property Template:
				Class DLL Name:
				Title: АВТО-переоформление (web)
				Window Location and Size
					Left:   0.4"
					Top:    1.631"
					Width:  4.0"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? No
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If cbExtent2 = TRUE
							Set cbExtent1 = FALSE
						Call ManageCheckButtons3()
			Background Text: Макс.кол-во:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 24651
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.5"
					Top:    1.202"
					Width:  2.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: bgTERM_DUBL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: nTERM_DUBL
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623300000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.4"
						Top:    1.167"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Максимальное количество автопереоформлений вклада
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipTERM_DUBL'))
			Background Text: Метод изменения ставки:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42952
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.5"
					Top:    1.667"
					Width:  2.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: bgEXT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: nEXT
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.4"
						Top:    1.619"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Код метода автопереоформления
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipEXT'))
					On SAM_Validate
						If SalIsNull(nEXT)
							Call SalListSetSelect(cmbEXT, -1)
							Return VALIDATE_OkClearFlag
						Call cmbEXT.SetSelectById(nEXT)
						If cmbEXT.nCurrentId
							Return VALIDATE_Ok
						Else
							! Указан несуществующий метод!
							Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTErrExtMethod'),
									                   CurrentLangTable.GetAtomTitle('cTErr'),
									                   MB_IconStop)
							Return VALIDATE_Cancel
			Combo Box: cmbEXT
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623300000000
.enddata
.data CLASSPROPSSIZE
0000: 1800
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   8.1"
					Top:    1.619"
					Width:  4.0"
					Width Editable? Class Default
					Height: 0.881"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbEXT.Init(hWndItem)
						Call cmbEXT.Populate(hSql(), "ID", "NAME", "DPT_VIDD_EXTYPES", " ORDER BY 1")
						Call cmbEXT.SetSelectById(nEXT)
					On SAM_Click
						Set nEXT = cmbEXT.GetKey(SalListQuerySelection(cmbEXT))
					On SAM_TooltipSetText
						! Метод автопереоформления
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipCmbEXT'))
			!
			Check Box: cbProlong
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCheckBoxLabeled
				Property Template:
				Class DLL Name:
				Title: Ставка после окончания срока
				Window Location and Size
					Left:   0.4"
					Top:    2.095"
					Width:  4.467"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? No
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call ManageCheckButtons3()
			Background Text: Базовая ставка:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 24652
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.95"
					Top:    2.155"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: bgBRL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: nBRL
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.4"
						Top:    2.095"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Код процентной ставки пролонгации
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipBRL'))
			Combo Box: cmbBRL
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   8.1"
					Top:    2.095"
					Width:  3.98"
					Width Editable? Class Default
					Height: 1.655"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbBRL.Init(hWndItem)
						Call cmbBRL.Populate(hSql(),"BR_ID","NAME","BRATES","ORDER BY 1")
						Call cmbBRL.SetSelectById( nBRL )
					On SAM_Click
						Set nBRL = cmbBRL.GetKey( SalListQuerySelection( cmbBRL))
					On SAM_TooltipSetText
						! Наименование процентной ставки пролонгации
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipCmbBRL'))
			!
			Check Box: cbTARIF
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCheckBoxLabeled
				Property Template:
				Class DLL Name:
				Title: Комісія за виплату коштів що надійшли беготівкою
				Window Location and Size
					Left:   0.4"
					Top:    2.488"
					Width:  5.483"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? No
				Font Name: Class Default
				Font Size: 8
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call ManageCheckButtons3()
			Background Text: Код тарифу:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 21526
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.133"
					Top:    2.52"
					Width:  1.25"
					Width Editable? Yes
					Height: 0.179"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: 8
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: nTARIF
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.4"
						Top:    2.47"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.27"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Combo Box: cmbTARIF
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   8.1"
					Top:    2.48"
					Width:  3.98"
					Width Editable? Class Default
					Height: 0.88"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbTARIF.Init(hWndItem)
					On SAM_Click
						Set nTARIF = cmbTARIF.GetKey( SalListQuerySelection(cmbTARIF) )
					! On SAM_TooltipSetText
						! Наименование формата
						                                                                         Return XSalTooltipSetText(lParam,CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipCmbFORMAT'))
			!
			! Закладка "Доп.параметры"
			!
			! Group Box: Перекрытие счетов начисленных %%
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.2"
					Top:    0.5"
					Width:  11.0"
					Width Editable? Yes
					Height: 1.0"
					Height Editable? Yes
				Visible? Yes
				Font Name: MS Sans Serif
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
.end
			Background Text: Перекрытие счетов начисленных %%
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 20871
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    0.5"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: gboxDR1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Background Text: Группа перекрытия:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42957
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    0.833"
					Width:  2.8"
					Width Editable? Yes
					Height: 0.214"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgIDG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: nIDG
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.2"
						Top:    0.821"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Код группы перекрытия
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipIDG'))
			Combo Box: cmbIDG
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   4.1"
					Top:    0.821"
					Width:  5.0"
					Width Editable? Class Default
					Height: 1.81"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbIDG.Init(hWndItem)
						Call cmbIDG.Populate(hSql(),"IDG","NAME","PEREKR_G","ORDER BY 1")
						Call cmbIDG.Add( -1, "" )
						Call cmbIDG.SetSelectById( nIDG )
					On SAM_Click
						Set nIDG = cmbIDG.GetKey( SalListQuerySelection( cmbIDG))
					On SAM_TooltipSetText
						! Наименование группы перекрытия
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipCmbIDG'))
			Background Text: Схема перекрытия:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 42956
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    1.131"
					Width:  2.8"
					Width Editable? Yes
					Height: 0.214"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgIDS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: nIDS
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.2"
						Top:    1.119"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Код схемы перекрытия
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipIDS'))
			Combo Box: cmbIDS
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   4.1"
					Top:    1.119"
					Width:  5.0"
					Width Editable? Class Default
					Height: 2.119"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbIDS.Init(hWndItem)
						Call cmbIDS.Populate(hSql(),"IDS","NAME","PEREKR_S","ORDER BY 1")
						Call cmbIDS.Add( -1, "" )
						Call cmbIDS.SetSelectById( nIDS )
					On SAM_Click
						Set nIDS = cmbIDS.GetKey( SalListQuerySelection( cmbIDS))
					On SAM_TooltipSetText
						! Наименование схемы перекрытия
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipCmbIDS'))
			Background Text: Печать выписки по вкладу
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623400000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 20873
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    1.5"
					Width:  4.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: gboxDR2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Background Text: Каталогизир.запрос:
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623400000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 36450
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    1.81"
					Width:  2.8"
					Width Editable? Yes
					Height: 0.214"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgKODZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: nKODZ
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.2"
						Top:    1.798"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Код каталогизированного зароса
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipKODZ'))
					On SAM_Validate
						If SalIsNull( nKODZ )
							Call SalListSetSelect( cmb_KODZ, -1 )
							Return VALIDATE_OkClearFlag
						Call cmb_KODZ.SetSelectById( nKODZ )
						If cmb_KODZ.nCurrentId
							Call SalSendMsg( cmb_KODZ, SAM_Click, 0, 0 )
							Return VALIDATE_Ok
						Else
							! Нет такого каталог.запроса
							Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTErrKODZ'), 
									     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconStop )
							Return VALIDATE_Cancel
			Combo Box: cmb_KODZ
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   4.1"
					Top:    1.798"
					Width:  5.0"
					Width Editable? Class Default
					Height: 1.19"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmb_KODZ.Init(hWndItem)
						Call cmb_KODZ.Populate(hSql(),"KODZ","NAME","ZAPROS","ORDER BY 1")
						Call cmb_KODZ.SetSelectById( nKODZ )
					On SAM_Click
						Set nKODZ = cmb_KODZ.GetKey( SalListQuerySelection(cmb_KODZ) )
					On SAM_TooltipSetText
						! Наименование каталогизированного зароса
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipCmbKODZ'))
			Background Text: Формат отгрузки:
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 36452
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    2.095"
					Width:  2.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgFORMAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: nFORMAT
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.2"
						Top:    2.06"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						! Код формата
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipFORMAT'))
			Combo Box: cmb_FORMAT
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   4.1"
					Top:    2.06"
					Width:  5.0"
					Width Editable? Class Default
					Height: 0.881"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmb_FORMAT.Init(hWndItem)
						Call cmb_FORMAT.Populate(hSql(),"ID","NAME","ZAPROS_FMT","ORDER BY 1")
						Call cmb_FORMAT.SetSelectById( nFORMAT )
					On SAM_Click
						Set nFORMAT = cmb_FORMAT.GetKey( SalListQuerySelection(cmb_FORMAT) )
					On SAM_TooltipSetText
						! Наименование формата
						Return XSalTooltipSetText(lParam,CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipCmbFORMAT'))
			Background Text: Комментарий
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623400000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 20870
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    3.1"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: gboxDR4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Multiline Field: sCOMMENTS
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 128
					String Type: String
					Editable? Yes
				Display Settings
					Border? Yes
					Word Wrap? Yes
					Vertical Scroll? Yes
					Window Location and Size
						Left:   0.417"
						Top:    3.38"
						Width:  11.6"
						Width Editable? Yes
						Height: 0.524"
						Height Editable? Yes
					Visible? No
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Message Actions
			Picture: picBS
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.2"
					Top:    2.464"
					Width:  12.1"
					Width Editable? Yes
					Height: 1.2"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
				Message Actions
			Picture: picLIMIT
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.2"
					Top:    3.762"
					Width:  12.1"
					Width Editable? Yes
					Height: 1.0"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
				Message Actions
			Picture: picPROC1
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.2"
					Top:    0.6"
					Width:  12.1"
					Width Editable? Yes
					Height: 1.5"
					Height Editable? Yes
				Visible? No
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
				Message Actions
			Picture: picPROC2
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.2"
					Top:    2.2"
					Width:  12.1"
					Width Editable? Yes
					Height: 0.8"
					Height Editable? Yes
				Visible? No
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
				Message Actions
			Picture: picPROC3
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.2"
					Top:    3.1"
					Width:  12.1"
					Width Editable? Yes
					Height: 0.8"
					Height Editable? Yes
				Visible? No
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
				Message Actions
			Picture: picPROC4
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.2"
					Top:    4.0"
					Width:  12.1"
					Width Editable? Yes
					Height: 0.7"
					Height Editable? Yes
				Visible? No
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
				Message Actions
			Picture: picDR1
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.2"
					Top:    0.6"
					Width:  12.1"
					Width Editable? Yes
					Height: 0.9"
					Height Editable? Yes
				Visible? No
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
				Message Actions
			Picture: picDR2
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.2"
					Top:    1.6"
					Width:  12.1"
					Width Editable? Yes
					Height: 0.8"
					Height Editable? Yes
				Visible? No
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
				Message Actions
			Picture: picDR3
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.2"
					Top:    2.5"
					Width:  12.1"
					Width Editable? Yes
					Height: 0.6"
					Height Editable? Yes
				Visible? No
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
				Message Actions
			Picture: picDR4
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.2"
					Top:    3.2"
					Width:  12.1"
					Width Editable? Yes
					Height: 0.8"
					Height Editable? Yes
				Visible? No
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
				Message Actions
			Check Box: AUTO_ADD
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCheckBoxLabeled
				Property Template:
				Class DLL Name:
				Title: Авто-пополнение 
				Window Location and Size
					Left:   6.2"
					Top:    4.119"
					Width:  2.283"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Yes
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
			Line
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162330000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 24653
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Coordinates
					Begin X:  0.233"
					Begin Y:  1.048"
					End X:  12.217"
					End Y:  1.048"
				Visible? No
				Line Style: Etched
				Line Thickness: 1
				Line Color: 3D Shadow Color
			Line
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623300000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 24654
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Coordinates
					Begin X:  0.25"
					Begin Y:  1.976"
					End X:  12.233"
					End Y:  1.976"
				Visible? No
				Line Style: Etched
				Line Thickness: 1
				Line Color: 3D Shadow Color
			Check Box: DISABLE_ADD
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCheckBoxLabeled
				Property Template:
				Class DLL Name:
				Title: Вклад без поповнення
				Window Location and Size
					Left:   6.2"
					Top:    3.869"
					Width:  2.75"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Yes
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Bold
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call F_DISABLE_ADD()
			Data Field: mDURATION
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    1.66"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: 8
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						Return IifN(mDURATION < 0 OR SalIsNull(mDURATION), VALIDATE_Cancel, VALIDATE_Ok)
					On SAM_TooltipSetText
						! Длительность в месяцах
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipDURATION_M'))
			Background Text: міс. +
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 6214
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.2"
					Top:    1.488"
					Width:  0.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dDURATION
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   5.1"
						Top:    1.66"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: 8
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						Return IifN(dDURATION < 0 OR SalIsNull(dDURATION), VALIDATE_Cancel, VALIDATE_Ok)
					On SAM_TooltipSetText
						! Длительность в днях
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipDURATION_D'))
			Background Text: днів
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 6215
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.0"
					Top:    1.488"
					Width:  0.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Radio Button: rbTermFix
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cRadioButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Фіксований
				Window Location and Size
					Left:   1.6"
					Top:    1.48"
					Width:  2.5"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Yes
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call F_TERMTYPE()
			Radio Button: rbTermList
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cRadioButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Плаваючий (1,2,...N)
				Window Location and Size
					Left:   1.6"
					Top:    1.71"
					Width:  2.5"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Yes
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call F_TERMTYPE()
			Radio Button: rbTermRange
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cRadioButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Діапазон
				Window Location and Size
					Left:   1.6"
					Top:    1.94"
					Width:  2.5"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Yes
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call F_TERMTYPE()
			Group Box: Термін вкладу
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 15903
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.4"
					Top:    1.35"
					Width:  5.7"
					Width Editable? Yes
					Height: 0.9"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: mDURATION_MAX
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.2"
						Top:    1.92"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: 8
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						Return IifN(mDURATION_MAX < 0 OR SalIsNull(mDURATION_MAX), VALIDATE_Cancel, VALIDATE_Ok)
					On SAM_TooltipSetText
						! Длительность в месяцах
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipDURATION_M'))
			Data Field: dDURATION_MAX
.data CLASSPROPSSIZE
0000: 1800
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 5461623100000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   5.1"
						Top:    1.92"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: 8
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						Return IifN(dDURATION_MAX < 0 OR SalIsNull(dDURATION_MAX), VALIDATE_Cancel, VALIDATE_Ok)
					On SAM_TooltipSetText
						! Длительность в днях
						Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipDURATION_D'))
			Group Box: Період дії виду депозиту
.data CLASSPROPSSIZE
0000: 1600
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000500 546162310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 15904
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.3"
					Top:    1.35"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.9"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
		Functions
			Function: F_POPULATE
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					If SqlPrepareAndExecute(hSql(),
							"SELECT v.type_name, v.type_cod,      v.datn,      v.datk,  
							        t.kv,        t.name,          t.lcv,       t.dig,
							        v.duration,  v.duration_days, v.duration_max,  v.duration_days_max, 
							        v.term_type, v.min_summ,
							        v.bsd,       v.bsn,           v.bsa,       v.amr_metr, am.name,
							        v.limit,     v.max_limit,     v.term_add,  v.auto_add,
							        v.basey,     y.name,          v.freq_n,    fn.name, 
							        v.metr,      m.name,          v.tip_ost,   o.name,  
							        v.tt,        v.acc7,          a.nls,       a.nms,
							        v.freq_k,    fv.name,         v.comproc,   v.disable_add,
							        v.br_id,     b.br_type,       b.name,      v.basem, 
							        v.id_stop,   s.name,          v.br_wd,     bw.name, 
							        v.fl_2620,   
							        decode(v.fl_dubl,1,1,0),   
							        decode(v.fl_dubl,2,1,0),   
							        v.term_dubl,     v.extension_id, de.name,         
							        decode(nvl(v.br_id_l, 0), 0, 0, 1),        
							        v.br_id_l,       bl.name,
							        v.idg,       pg.name,         v.ids,       ps.name,
							        v.kodz,      v.fmt,           v.comments, 
							        v.nls_k,     v.nlsn_k
							   INTO :sTYPE_NAME, :sTYPE_COD,  :dDATN,      :dDATK,
							        :nKV,        :cmbKV,      :sLCV,       :nDig,
							        :mDURATION,  :dDURATION, :mDURATION_MAX,  :dDURATION_MAX, 
							        :nTermType,  :nMIN_SUMM,       
							        :sBSD,       :sBSN,       :sBSA,       :nAMRMETR,  :cmbAMRMETR,
							        :nLIMIT,     :nMAX_LIMIT, :nSROK_ADD,  :AUTO_ADD,
							        :nBASEY,     :cmbBASEY,   :nFREQN,     :cmbFREQN,
							        :nMETR,      :cmbMETR,    :nOST,       :cmbOST,
							        :sTT,        :nACC7,      :sNLS7,      :sNMS7,
							        :nFREQV,     :cmbFREQV,   :cbCOMPROC,  :DISABLE_ADD,
							        :nBR,        :nBRTYPE,    :cmbBR,      :cbFIXRATE,
							        :nSTOP,      :cmbSTOP,    :nBRW,       :cmbBRW,
							        :cbPerekr,   :cbExtent1,  :cbExtent2,  
							        :nTERM_DUBL, :nEXT,       :cmbEXT, 
							        :cbProlong,  :nBRL,       :cmbBRL,
							        :nIDG,       :cmbIDG,     :nIDS,       :cmbIDS, 
							        :nKODZ,      :nFORMAT,    :sCOMMENTS,        
							        :sNLSD_K,    :sNLSN_K
							   FROM dpt_vidd         v, 
							        tabval           t, 
							        basey            y,         
							        int_ion          o,          
							        int_metr         m, 
							        int_metr         am, 
							        freq             fn, 
							        freq             fv, 
							        accounts         a,
							        brates           b, 
							        dpt_stop         s, 
							        brates           bw,
							        brates           bl, 
							        dpt_vidd_extypes de,
							        perekr_g         pg, 
							        perekr_s         ps
							  WHERE v.vidd         = "||Str(nVIDD)||" 
							    AND v.kv           = t.kv 
							    AND v.metr         = m.metr
							    AND v.amr_metr     = am.metr
							    AND v.basey        = y.basey
							    AND v.tip_ost      = o.io 
							    AND v.freq_n       = fn.freq
							    AND v.freq_k       = fv.freq
							    AND v.acc7         = a.acc(+)
							    AND v.id_stop      = s.id(+)
							    AND v.br_id        = b.br_id(+)
							    AND v.br_id_l      = bl.br_id(+)
							    AND v.br_wd        = bw.br_id(+)
							    AND v.extension_id = de.id(+)
							    AND v.idg          = pg.idg(+)
							    AND v.ids          = ps.ids(+) ")
					If SqlFetchNext( hSql(), nFetchRes) 
						If nDig
							Call SalFmtSetPicture(nMIN_SUMM,  '# ##0' || getDecPoint() || SalStrRepeatX('0',nDig))
							Call SalFmtSetPicture(nLIMIT,     '# ##0' || getDecPoint() || SalStrRepeatX('0',nDig))
							Call SalFmtSetPicture(nMAX_LIMIT, '# ##0' || getDecPoint() || SalStrRepeatX('0',nDig))
						! Наименования балансовых счетов
						If SqlPrepareAndExecute(hSql(),
								   "SELECT name INTO :sBSDn FROM ps WHERE nbs = :sBSD")
								and SqlFetchNext( hSql(), nFetchRes)
						If SqlPrepareAndExecute(hSql(),
								   "SELECT name INTO :sBSNn FROM ps WHERE nbs = :sBSN")
								and SqlFetchNext( hSql(), nFetchRes)
						If SqlPrepareAndExecute(hSql(),
								   "SELECT name INTO :sBSAn FROM ps WHERE nbs = :sBSA")
								and SqlFetchNext( hSql(), nFetchRes)
						! Значение основной ставки
						If nBRTYPE = 1
							If SqlPrepareAndExecute(hSql(),
									   "SELECT max(bdate) INTO :DAT_BRAT 
									      FROM br_normal 
									     WHERE bdate <= bankdate AND kv = :nKV AND br_id = :nBR")
									and SqlFetchNext( hSql(), nFetchRes)
									and SqlPrepareAndExecute(hSql(),
									   "SELECT rate INTO :nPROC 
									      FROM br_normal 
									     WHERE kv = :nKV AND br_id = :nBR AND bdate = :DAT_BRAT")
									and SqlFetchNext( hSql(), nFetchRes)
						! Ставка для частичного снятия
						If SqlPrepareAndExecute(hSql(),
								"SELECT max(bdate) INTO :DAT_WD 
								      FROM br_normal 
								  WHERE bdate <= bankdate AND kv = :nKV AND br_id = :nBRW")
								AND SqlFetchNext( hSql(), nFetchRes)
								AND SqlPrepareAndExecute(hSql(),
								   "SELECT rate INTO :nPROC_WD 
								      FROM br_normal 
								    WHERE kv = :nKV AND br_id = :nBRW AND bdate = :DAT_WD")
								and SqlFetchNext( hSql(), nFetchRes)
						! Длит-ть
						Set rbTermFix   = (nTermType = 1)
						Set rbTermList  = (nTermType = 0)
						Set rbTermRange = (nTermType = 2)
						! Амортизация 
						Set cbAmortisation = (nAMRMETR != 0)
						!
						Call SalSendMsg(sBSA, SAM_User, 0, 0)
						! параметры возврата депозита
						Call ManageCheckButtons3()
						! Срок пополнения вклада
						Set mSROK_ADD = SalNumberRound(nSROK_ADD)
						Set dSROK_ADD = SalNumberRound(SalNumberTruncate(SalNumberMod(nSROK_ADD,1),2,2)*100)
						! Выписка
						If SqlPrepareAndExecute(hSql(),
								   "SELECT name INTO :cmb_KODZ FROM zapros WHERE kodz = :nKODZ")
								and SqlFetchNext( hSql(), nFetchRes)
								and SqlPrepareAndExecute(hSql(),
								   "SELECT name INTO :cmb_FORMAT FROM zapros_fmt WHERE id = :nFORMAT")
								and SqlFetchNext( hSql(), nFetchRes)
						Call F_TERMTYPE()
						! Вид вкладу без поповнення
						Call F_DISABLE_ADD()
						Return TRUE
					Return FALSE
			Function: ManageCheckButtons3
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					! ставка пролонгации
					If cbProlong 
						Call SalEnableWindow(cmbBRL)
					Else
						Call SalDisableWindow(cmbBRL)
						Set nBRL = NUMBER_Null
						Set cmbBRL = STRING_Null
					! переоформление вклада
					If cbExtent1
						Set cbExtent2 = FALSE
						Set nFlDubl = 1
					Else If cbExtent2 = TRUE
						Set cbExtent1 = FALSE
						Set nFlDubl = 2
					Else
						Set cbExtent1 = FALSE
						Set cbExtent2 = FALSE
						Set nFlDubl   = 0
					If nFlDubl > 0
						Call SalEnableWindow(nTERM_DUBL)
						Call SalEnableWindow(cmbEXT)
						Call SalEnableWindow(nEXT)
					Else
						Call SalDisableWindow(nTERM_DUBL)
						Call SalDisableWindow(cmbEXT)
						Call SalDisableWindow(nEXT)
						Set nTERM_DUBL = 0
						Set nEXT = NUMBER_Null
						Set cmbEXT = STRING_Null
					! Комісія за виплату котів що надійшли безготівкою
					If cbTARIF = 0
						Call SalDisableWindow( cmbTARIF)
						Set nTARIF = NUMBER_Null
						Set cmbTARIF = STRING_Null
					Else
						Call SalEnableWindow( cmbTARIF)
						Call cmbTARIF.Populate(hSql(),"KOD","NAME","TARIF","WHERE KV = :frm_ViddDetails.nKV AND TAR = 0 AND TIP = 0 ORDER BY 1")
						Call cmbTARIF.SetSelectById( nTARIF )
			Function: F_TERMTYPE
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If rbTermRange
						! Діапазон
						Call SalShowWindow( mDURATION_MAX )
						Call SalShowWindow( dDURATION_MAX )
						Set nTermType = 2
					Else
						Set mDURATION_MAX = NUMBER_Null
						Set dDURATION_MAX = NUMBER_Null
						Call SalHideWindow( mDURATION_MAX )
						Call SalHideWindow( dDURATION_MAX )
						If rbTermFix 
							! Фіксований термін
							Set nTermType = 1
						Else If rbTermList
							! Плаваючий
							Set nTermType = 0
			Function: F_START
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Window Handle: hWndObject
				Actions
					Set hWndObject = SalGetFirstChild(hWndForm,TYPE_Any)
					While hWndObject != hWndNULL
						Set hWndObject = SalGetNextChild(hWndObject,TYPE_Any)  
						If SalGetType(hWndObject) = TYPE_DataField
							Call SalClearField(hWndObject)
					!
					Set cmbKV      = STRING_Null
					Set cmbBASEY   = STRING_Null
					Set cmbMETR    = STRING_Null
					Set cmbAMRMETR = STRING_Null
					Set cmbFREQN   = STRING_Null
					Set cmbFREQV   = STRING_Null
					Set cmbOST     = STRING_Null
					Set cmbBR      = STRING_Null
					Set cmbBRL     = STRING_Null
					Set cmbBRW     = STRING_Null 
					Set cmbEXT     = STRING_Null
					Set cmbIDG     = STRING_Null
					Set cmbIDS     = STRING_Null
					!
					Set rbTermFix      = TRUE
					Set cbAmortisation = FALSE
					Set cbCOMPROC      = FALSE
					Set cbFIXRATE      = TRUE
					Set cbProlong      = FALSE
					Set cbExtent1      = FALSE
					Set cbExtent2      = FALSE
					Set nFlDubl        = 0
					Set cbPerekr       = FALSE
					Set cbTARIF        = 0
					!
					Set nACC7      = NUMBER_Null
					!
					Set nBASEY     = 0 
					Set dDURATION  = 0
					Set dDURATION_MAX  = 0
					Set nTERM_DUBL = 0
					Set nMETR      = 0 
					Set nAMRMETR   = 0 
					Set nFREQN     = 1 
					Set sTT        = '%%1'
					Set nSTOP      = 0
					Set nOST       = NUMBER_Null
					Set nBR        = NUMBER_Null
					Set nBRTYPE    = NUMBER_Null
					Call cmbBASEY.SetSelectById(nBASEY)
					Call cmbMETR.SetSelectById(nMETR)
					Call cmbAMRMETR.SetSelectById(nAMRMETR)
					Call cmbFREQN.SetSelectById(nFREQN)
					Call cmbSTOP.SetSelectById(nSTOP)
					!
					Call SalSendMsg(sBSA, SAM_User, 0, 0)
					Call ManageCheckButtons3()
					Call F_TERMTYPE()
					Call ShowTierRate()
					Return TRUE
			Function: CheckData
				Description: Проверка заполнения обязательных полей
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: strErrorList
					Number: nErrorCount
				Actions
					Set strErrorList = ''
					Set nErrorCount = 0
					If SalIsNull(sTYPE_NAME)
						Set nErrorCount = nErrorCount + 1
						! Не заполнен реквизит <Наименование вида вклада>
						Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTRekv') || ' <' || 
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipTYPE_NAME') || '>' || PutCrLf()
					If SalIsNull(cmbKV)
						Set nErrorCount = nErrorCount + 1
						! Не заполнен реквизит <Валюта вида вклада>
						Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTRekv') || ' <' || 
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipKV') || '>' || PutCrLf()
					If SalIsNull(mDURATION) OR SalIsNull(dDURATION)
						Set nErrorCount = nErrorCount + 1
						! Не заполнен реквизит <Срок вида вклада>
						Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTRekv') || ' <' || 
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTDURATION') || '>' || PutCrLf()
					If SalIsNull(sBSD)
						Set nErrorCount = nErrorCount + 1
						! Не заполнен реквизит <Бал.счет вклада>
						Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTRekv') || ' <' || 
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipBSD') || '>' || PutCrLf()
					If SalIsNull(sBSN)
						Set nErrorCount = nErrorCount + 1
						! Не заполнен реквизит <Бал.счет начисл.%%>
						Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTRekv') || ' <' || 
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipBSN') || '>' || PutCrLf()
					If SalIsNull(cmbBR)
						Set nErrorCount = nErrorCount + 1
						! Не заполнен реквизит <Базовая ставка>
						Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTRekv') || ' <' || 
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTBR') || '>' || PutCrLf()
					If SalIsNull(cmbBASEY)
						Call picTabs.BringToTop(1, TRUE)
						Set nErrorCount = nErrorCount + 1
						! Не заполнен реквизит <Базовый год>
						Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTRekv') || ' <' || 
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTBASEY') || '>' || PutCrLf()
					If SalIsNull(cmbFREQV)
						Call picTabs.BringToTop(1, TRUE)
						Set nErrorCount = nErrorCount + 1
						! Не заполнен реквизит <Периодичность выплаты %%>
						Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTRekv') || ' <' || 
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipCmbFREQV') || '>' || PutCrLf()
					If SalIsNull(cmbFREQN)
						Call picTabs.BringToTop(1, TRUE)
						Set nErrorCount = nErrorCount + 1
						! Не заполнен реквизит <Периодичность начисл.%%>
						Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTRekv') || ' <' || 
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipCmbFREQN') || '>' || PutCrLf()
					If SalIsNull(cmbMETR)
						Call picTabs.BringToTop(1, TRUE)
						Set nErrorCount = nErrorCount + 1
						! Не заполнен реквизит <Метод начисления %%>
						Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTRekv') || ' <' || 
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMETR') || '>' || PutCrLf()
					If cbAmortisation AND SalIsNull(cmbAMRMETR)
						Call picTabs.BringToTop(1, TRUE)
						Set nErrorCount = nErrorCount + 1
						! Не заполнен реквизит <Метод амортизации %%>
						Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTRekv') || ' <' || 
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTAMRMETR') || '>' || PutCrLf()
					If rbTermRange
						If ( SalIsNull( mDURATION_MAX ) AND SalIsNull( dDURATION_MAX ) )
							Call picTabs.BringToTop(1, TRUE)
							Set nErrorCount = nErrorCount + 1
							! Не заповнений реквізит <Максимальний термін вкладу>
							Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
									    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTRekv') || ' <' || 
									    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTDURATION_MAX') || '>' || PutCrLf()
						If ( ( mDURATION + ( dDURATION/1000 ) ) >= ( mDURATION_MAX + ( dDURATION_MAX/1000 ) ) )
							Call picTabs.BringToTop(1, TRUE)
							Set nErrorCount = nErrorCount + 1
							! Невірно вказані значення <min термін вкладу >= max термін вкладу>
							Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
									    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTValue') || ' <' || 
									    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTDURATION_MAX2') || '>' || PutCrLf()
					If SalIsNull(nOST)
						Call picTabs.BringToTop(1, TRUE)
						Set nErrorCount = nErrorCount + 1
						! Не заполнен реквизит <Код метода расчета остатка>
						Set strErrorList = strErrorList || SalNumberToStrX(nErrorCount,0) || ': ' ||
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTRekv') || ' <' || 
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cFTipOST') || '>' || PutCrLf()
					!
					If nErrorCount > 0
						! Ошибка заполнения реквизитов
						Call SalMessageBox( strErrorList, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTErrRekv'), MB_Ok )
						Return FALSE
					Return TRUE
			! Function: NotNullData
				                                                                                                                                    Description: Проверка заполнения не совсем обязательных полей
				                                                                                                                                    Returns 
					                                                                                                                                    Boolean: 
				                                                                                                                                    Parameters 
				                                                                                                                                    Static Variables 
				                                                                                                                                    Local variables 
					                                                                                                                                    Number: n1
					                                                                                                                                    Number: n2
					                                                                                                                                    Number: n3
				                                                                                                                                    Actions 
					                                                                                                                                    If SalIsNull(nMIN_SUMM)  
						! Для данного вида вклада не установлена миним.сумма! Продолжить?
						                                                                                                                                    Set n1=SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessNotSetMIN_SUMM') || ' ' || 
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessNext'),
								    CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNo)
						                                                                                                                                    If n1=IDYES 
							                                                                                                                                    If nSTOP = 0 OR SalIsNull(cmbSTOP) 
								! Для данного вида вклада не установлен штраф! Продолжить?
								                                                                                                                                    Set n2=SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessNotSetSTOP') || ' ' || 
										    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessNext'),
										    CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNo)
								                                                                                                                                    If n2=IDYES
									                                                                                                                                    Set nSTOP = 0
									                                                                                                                                    If SalIsNull(cmbBRL)
										! Для данного вида вклада не установлена ставка пролонгации! Продолжить?
										                                                                                                                                    Set n3=SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessNotSetBRL') || ' ' || 
												    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessNext'),
												    CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNo)
										                                                                                                                                    If n3=IDYES
											                                                                                                                                    Return TRUE
										                                                                                                                                    Else 
											                                                                                                                                    Return FALSE
									                                                                                                                                    Else 
										                                                                                                                                    Return TRUE
								                                                                                                                                    Else 
									                                                                                                                                    Return FALSE
							                                                                                                                                    Else 
								                                                                                                                                    If SalIsNull(cmbBRL)
									! Для данного вида вклада не установлена ставка пролонгации! Продолжить?
									                                                                                                                                    Set n3=SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessNotSetBRL') || ' ' || 
											    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessNext'),
											    CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNo)
									                                                                                                                                    If n3=IDYES
										                                                                                                                                    Return TRUE
									                                                                                                                                    Else 
										                                                                                                                                    Return FALSE
								                                                                                                                                    Else 
									                                                                                                                                    Return TRUE
						                                                                                                                                    Else 
							                                                                                                                                    Return FALSE
					                                                                                                                                    Else If (nSTOP = 0 OR SalIsNull(cmbSTOP))
						! Для данного вида вклада не установлен штраф! Продолжить?
						                                                                                                                                    Set n2=SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessNotSetSTOP') || ' ' || 
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessNext'),
								    CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNo)
						                                                                                                                                    If n2=IDYES
							                                                                                                                                    Set nSTOP = 0
							                                                                                                                                    If SalIsNull(cmbBRL)
								! Для данного вида вклада не установлена ставка пролонгации! Продолжить?
								                                                                                                                                    Set n3=SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessNotSetBRL') || ' ' || 
										    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessNext'),
										    CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNo)
								                                                                                                                                    If n3=IDYES
									                                                                                                                                    Return TRUE
								                                                                                                                                    Else 
									                                                                                                                                    Return FALSE
							                                                                                                                                    Else 
								                                                                                                                                    Return TRUE
						                                                                                                                                    Else 
							                                                                                                                                    Return FALSE
					                                                                                                                                    Else If SalIsNull(cmbBRL)
						! Для данного вида вклада не установлена ставка пролонгации! Продолжить?
						                                                                                                                                    Set n3=SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessNotSetBRL') || ' ' || 
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessNext'),
								    CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNo)
						                                                                                                                                    If n3=IDYES
							                                                                                                                                    Return TRUE
						                                                                                                                                    Else 
							                                                                                                                                    Return FALSE
					                                                                                                                                    Else 
						                                                                                                                                    Return TRUE
			Function: NotNullData
				Description: Проверка заполнения не совсем обязательных полей
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: n1
					Number: n2
					Number: n3
				Actions
					If SalIsNull(nMIN_SUMM)  
						! Для данного вида вклада не установлена миним.сумма! Продолжить?
						Set n1=SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessNotSetMIN_SUMM') || ' ' || 
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessNext'),
								    CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNo)
						If n1=IDYES 
							If nSTOP = 0 OR SalIsNull(cmbSTOP) 
								! Для данного вида вклада не установлен штраф! Продолжить?
								Set n2=SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessNotSetSTOP') || ' ' || 
										    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessNext'),
										    CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNo)
								If n2=IDYES
									Set nSTOP = 0
									Return TRUE
								Else
									Return FALSE
							Else
								Return TRUE
						Else
							Return FALSE
					Else If (nSTOP = 0 OR SalIsNull(cmbSTOP))
						! Для данного вида вклада не установлен штраф! Продолжить?
						Set n2=SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessNotSetSTOP') || ' ' || 
								    CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessNext'),
								    CurrentLangTable.GetAtomTitle('cTAt'), MB_YesNo)
						If n2=IDYES
							Set nSTOP = 0
							Return TRUE
						Else
							Return FALSE
					Else
						Return TRUE
			Function: getDecPoint
				Description:
				Returns
					String:
				Parameters
				Static Variables
				Local variables
				Actions
					Return SalStrMidX(SalNumberToStrX(1.1,1),1,1)
			Function: ShowTierRate
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If picTabs.GetTop() = 1 
						If nBR != NUMBER_Null
							If nBRTYPE = 1
								Call SalShowWindow(nPROC)
								Call SalShowWindow(DAT_BRAT)
								Call SalHideWindow(pbTierBrate)
							Else
								Call SalHideWindow(nPROC)
								Call SalHideWindow(DAT_BRAT)
								Call SalShowWindow(pbTierBrate)
						Else
							Call SalShowWindow(nPROC)
							Call SalShowWindow(DAT_BRAT)
							Call SalHideWindow(pbTierBrate)
					Else
						Call SalHideWindow(nPROC)
						Call SalHideWindow(DAT_BRAT)
						Call SalHideWindow(pbTierBrate)
			Function: CheckDuplicates
				Description: Поиск дубликатов
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: sMsg
				Actions
					If SqlPLSQLCommand(hSql(), 
							   "check_duplicate_dpttypes (nVIDD, sTYPE_COD, nKV,    
							                              mDURATION, dDURATION, nTermType,
							                              sBSD, sBSN, sBSA,         
							                              nMIN_SUMM, nLIMIT, nMAX_LIMIT, nSROK_ADD, AUTO_ADD,  
							                              nBASEY, nMETR, nAMRMETR, nOST, nFREQN, nFREQV, nACC7,
							                              cbFIXRATE, cbCOMPROC, nBR, nBRL, nBRW, nSTOP,   
							                              cbPerekr, nFlDubl, nTERM_DUBL, nEXT, sMsg)")
						If sMsg = STRING_Null
							Return TRUE
						Else
							If SalMessageBox(CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessDuplQuestion')
									               ||PutCrLf()
									               ||sMsg
									               ||PutCrLf()
									               ||PutCrLf()
									               ||CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessDuplContinue'), 
									                 CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTMessDuplTitle'), 
									                 MB_IconQuestion|MB_YesNo) = IDYES
								Return TRUE
							Else
								Return FALSE
					Return TRUE
			Function: F_DISABLE_ADD
				Description: Для видів депозитів які не поповняються
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If DISABLE_ADD = 1
						Call SalDisableWindow( nLIMIT )
						Call SalDisableWindow( nMAX_LIMIT )
						Call SalDisableWindow( mSROK_ADD )
						Call SalDisableWindow( dSROK_ADD )
						Call SalDisableWindow( AUTO_ADD )
					Else
						Call SalEnableWindow( nLIMIT )
						Call SalEnableWindow( nMAX_LIMIT )
						Call SalEnableWindow( mSROK_ADD )
						Call SalEnableWindow( dSROK_ADD )
						Call SalEnableWindow( AUTO_ADD )
		Window Parameters
			Number: pVidd
			Number: nEdit
			! 0 - просмотр
			! 1 - редактирование - частичный доступ
			! 2 - редактирование - полный доступ
			Window Handle: hWndFormParent
		Window Variables
			Number: n980
			Number: nSROK_ADD
			Number: nACC7
			String: sNLSD_K
			String: sNLSN_K
			Number: nTmp
			Number: nFetchRes
			String: sEr
			Window Handle: hWndObject
			Number: nDig
			Number: nBRTYPE
			Number: nTermType
			Number: nFlDubl
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_ViddDetails.cTWndTitle'))
				Call PrepareWindowEx(hWndForm)
				Call XSalTooltipSetUserDefault()
				Set n980 = GetBaseVal()
				Set nVIDD = pVidd
				If nVIDD != NUMBER_Null AND nVIDD != 0
					Call F_POPULATE()
				Else
					Call F_START()
				If nEdit = 0
					Call SalDisableWindow( pbUpdate )
				Else If nEdit = 1
					Call SalEnableWindow( pbUpdate )
					!
					Set hWndObject = SalGetFirstChild(hWndForm, 
							                                  TYPE_CheckBox|
							                                  TYPE_ComboBox|
							                                  TYPE_DataField|
							                                  TYPE_RadioButton|
							                                  TYPE_MultilineText)
					While hWndObject != hWndNULL
						Call SalDisableWindow(hWndObject)
						Set hWndObject = SalGetNextChild(hWndObject, 
								                                 TYPE_CheckBox|
								                                 TYPE_ComboBox|
								                                 TYPE_DataField|
								                                 TYPE_RadioButton|
								                                 TYPE_MultilineText)
					!
					Call SalEnableWindow( sTYPE_NAME )
					Call SalEnableWindow( nMIN_SUMM )
					Call SalEnableWindow( dDATN )
					Call SalEnableWindow( dDATK )
					Call SalEnableWindow( DISABLE_ADD )
					!
					Call F_DISABLE_ADD()
					Call SalEnableWindow( sNLS7 )
					!
					Call SalEnableWindow( nKODZ )
					Call SalEnableWindow( cmb_KODZ )
					Call SalEnableWindow( cmb_FORMAT )
					Call SalEnableWindow( sCOMMENTS )
				Else
					Call SalEnableWindow( pbUpdate )
				Call SalMapEnterToTab( TRUE )
			On SAM_Destroy
				Call SalSendMsg(hWndFormParent, UM_Populate, 0, 0)
	Table Window: tbl_AvtoExtend
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Автопереоформление депозитных договоров
		Icon File:
		Accesories Enabled? Class Default
		Visible? No
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  13.533"
				Width Editable? Class Default
				Height: 6.298"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000000
			Discardable? Class Default
		Description: Автопереоформление депозитных договоров
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.533"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.433"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29779
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.567"
						Begin Y:  -0.024"
						End X:  4.567"
						End Y:  0.44"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.067"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.517"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.967"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Печать доп.соглашения
							Set strTip = CurrentLangTable.GetAtomTitle('tbl_AvtoExtend.cBTipDetails')
						On SAM_Click
							Call cdoc_ShowAllDocs(tbl_AvtoExtend.cDeposit_id, tbl_AvtoExtend) 
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.417"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29780
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.3"
						Begin Y:  0.012"
						End X:  5.3"
						End Y:  0.476"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.733"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29781
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  1.95"
						Begin Y:  0.0"
						End X:  1.95"
						End Y:  0.464"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbRun
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.867"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\EXECUTE.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Выполнить переоформление отмеченных договоров
							Set strTip = CurrentLangTable.GetAtomTitle('tbl_AvtoExtend.cBTipRun')
						On SAM_Click
							Call SalWaitCursor(TRUE)
							! Вы действительно хотите переоформить отмеченные вклады?
							If SalMessageBox(CurrentLangTable.GetAtomTitle('tbl_AvtoExtend.cTMessAvtoDep'), 
									                 CurrentLangTable.GetAtomTitle('cTAt'), 
									                 MB_YesNo) = IDYES
								Set nRow = TBL_MinRow
								Set nNoPrint = IDYES
								While SalTblFindNextRow (hWndForm, nRow, 0, 0)
									Call SalTblSetContext(hWndForm, nRow)
									If tbl_AvtoExtend.cIsExtend 
										If SqlPLSQLCommand(hSql(), "dpt.p_dpt_extension(tbl_AvtoExtend.cDeposit_id, tbl_AvtoExtend.cNewDatEnd)")
											! Автопереоформление депозита № ...
											Call SqlCommitEx(hSql(), CurrentLangTable.GetAtomTitle('tbl_AvtoExtend.cTAvtoDep') || ' '||SalNumberToStrX(tbl_AvtoExtend.cDeposit_id,0))
											If nNoPrint = IDYES OR nNoPrint = IDNO
												! Сформировать доп.соглашение к договору № ...?
												Set nNoPrint = SalMessageBox(CurrentLangTable.GetAtomTitle('tbl_AvtoExtend.cTMessFormDopSogl') 
														                           ||SalNumberToStrX(tbl_AvtoExtend.cDeposit_id,0)||'?'
														                           ||PutCrLf()
														                           ||CurrentLangTable.GetAtomTitle('tbl_AvtoExtend.cTMessFormDopCancel'), 
														                             CurrentLangTable.GetAtomTitle('cTAt'), 
														                             MB_YesNoCancel)
												If nNoPrint = IDYES
													Call SalSendMsg(pbDetails, SAM_Click, 0, 0)
										Else
											Call SqlRollback(hSql())
							Call SalWaitCursor(FALSE)
							Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
						! On SAM_Click
							                                                                                                                      Call SalWaitCursor(TRUE)
							                                                                                                                      Set nRow = TBL_MinRow
							! Вы действительно хотите переоформить отмеченные вклады?
							                                                                                                                      If SalMessageBox(CurrentLangTable.GetAtomTitle('tbl_AvtoExtend.cTMessAvtoDep'), 
									                 CurrentLangTable.GetAtomTitle('cTAt'), 
									                 MB_YesNo) = IDYES
								                                                                                                                      Loop 
									                                                                                                                      If SalTblFindNextRow(hWndForm, nRow, 0, 0)
										                                                                                                                      Call SalTblSetContext(hWndForm, nRow)
										                                                                                                                      If (nRow >= 0 AND tbl_AvtoExtend.cIsExtend) 
											                                                                                                                      If SqlPLSQLCommand(hSql(), "dpt.p_dpt_extension(tbl_AvtoExtend.cDeposit_id, tbl_AvtoExtend.cNewDatEnd)")
												! Автопереоформление депозита № ...
												                                                                                                                      Call SqlCommitEx(hSql(), CurrentLangTable.GetAtomTitle('tbl_AvtoExtend.cTAvtoDep') || ' '||SalNumberToStrX(tbl_AvtoExtend.cDeposit_id,0))
												! Сформировать доп.соглашение к договору № ...?
												                                                                                                                      If SalMessageBox(CurrentLangTable.GetAtomTitle('tbl_AvtoExtend.cTMessFormDopSogl') ||SalNumberToStrX(tbl_AvtoExtend.cDeposit_id,0)||'?', 
														                 CurrentLangTable.GetAtomTitle('cTAt'), 
														                 MB_YesNo) = IDYES
													                                                                                                                      Call SalSendMsg(pbDetails, SAM_Click, 0, 0)
											                                                                                                                      Else 
												                                                                                                                      Call SqlRollback(hSql())
									                                                                                                                      Else 
										                                                                                                                      Break 
							                                                                                                                      Call SalWaitCursor(FALSE)
							                                                                                                                      Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Check Box: cbCheckAll
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cCheckBoxLabeled
					Property Template:
					Class DLL Name:
					Title: Отметить все вклады
					Window Location and Size
						Left:   6.083"
						Top:    0.107"
						Width:  3.35"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: MS Sans Serif
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Charcoal
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call Check (IifN (cbCheckAll, 1, 0))
		Contents
			Column: cIsExtend
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: П
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.3"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cDeposit_id
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: №
						вклада
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.983"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Номер
						депозита
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.983"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cRnk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: РНК
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.9"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cKlient
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Клиент
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.85"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cAcc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cNls
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Основной
						счет
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cKv
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						вал
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Left
				Width:  0.433"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cOst
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма
						вклада
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sOst
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма
						вклада
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cDaos
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата открытия 
						вклада
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cVidd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Вид вклада
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cViddName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Вид вклада
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cTerm
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Кол-во 
						переоформлений
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cPeriod_m
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Срок вклада
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cPeriod_d
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Срок вклада
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cDatBegin
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата 
						начала
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.017"
				Width Editable? Yes
				Format: dd-MM-yyyy
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cDatEnd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата 
						окончания
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.05"
				Width Editable? Yes
				Format: dd-MM-yyyy
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cNewDatBegin
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Новая дата 
						начала
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.05"
				Width Editable? Yes
				Format: dd-MM-yyyy
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cNewDatEnd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Новая дата
						окончания
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.1"
				Width Editable? Yes
				Format: dd-MM-yyyy
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: dDatX
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Граничная
						 дата
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.067"
				Width Editable? Yes
				Format: dd-MM-yyyy
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DIG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: DIG
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: cIr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Индивид.
						% ставка
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  0.8"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: cOp
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Оп.
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  0.6"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: cBr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Базовая
						% ставка
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  0.8"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
		Functions
			Function: Check
				Description:
				Returns
				Parameters
					Number: pSetValue
				Static Variables
				Local variables
				Actions
					Call SalTblSetFlagsAnyRows (hWndForm, ROW_Edited, FALSE, 0, 0)
					Set nRow = TBL_MinRow
					While SalTblFindNextRow (hWndForm, nRow, 0, 0)
						Call SalTblSetContext(hWndForm, nRow)
						Set cIsExtend = pSetValue
		Window Parameters
			Number: nPar
		Window Variables
			Number: nRow
			Date/Time: dNewEndDate
			Number: nMaxDig
			Number: nLastSortRow
			Number: nSortOrder
			Window Handle: hColumn
			Number: nNoPrint
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tbl_AvtoExtend.cTWndTitle'))
				Call PrepareWindowEx(hWndForm)
				Set cbCheckAll = FALSE
				Set fFilterAtStart = TRUE
				Set tbl_AvtoExtend.nTabInstance = 1
				Set tbl_AvtoExtend.strPrintFileName = 'DPT_DUBL'
				Set tbl_AvtoExtend.strFilterTblName = 'DPT_AUTO_EXTEND'
				Call SalDisableWindow(pbDetails)
				Call SalDisableWindow(pbIns)
				Call SalDisableWindow(pbDel)
				Call SalDisableWindow(pbUpdate)
				Set tbl_AvtoExtend.strSqlPopulate =
						"SELECT dpt_id, nd, rnk, nmk, acc, nls, dpt_auto_extend.kv, 
						        ost/power(100,tabval.dig), 
						        dat_start, vidd, type_name, term_dubl,
						        term_m, term_d, dat_begin_old, dat_end_old,
						        dat_begin_new, dat_end_new, datx, 0, tabval.dig, 
						        ir, op, br 
						  INTO :tbl_AvtoExtend.cDeposit_id,  :tbl_AvtoExtend.cND,   
						       :tbl_AvtoExtend.cRnk,         :tbl_AvtoExtend.cKlient,
						       :tbl_AvtoExtend.cAcc,         :tbl_AvtoExtend.cNls,
						       :tbl_AvtoExtend.cKv,          :tbl_AvtoExtend.cOst,
						       :tbl_AvtoExtend.cDaos,        :tbl_AvtoExtend.cVidd,
						       :tbl_AvtoExtend.cViddName,    :tbl_AvtoExtend.cTerm,
						       :tbl_AvtoExtend.cPeriod_m,    :tbl_AvtoExtend.cPeriod_d,
						       :tbl_AvtoExtend.cDatBegin,    :tbl_AvtoExtend.cDatEnd,   
						       :tbl_AvtoExtend.cNewDatBegin, :tbl_AvtoExtend.cNewDatEnd,   
						       :tbl_AvtoExtend.dDatX,        :tbl_AvtoExtend.cIsExtend, 
						       :tbl_AvtoExtend.DIG,          :tbl_AvtoExtend.cIr,
						       :tbl_AvtoExtend.cOp,          :tbl_AvtoExtend.cBr
						  FROM dpt_auto_extend, tabval 
						 WHERE dpt_auto_extend.kv=tabval.kv 
						 ORDER BY dpt_id" 
				If DigInit() != -1
					Set nMaxDig = DigInit()
				Else
					Set nMaxDig = 4
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Set cbCheckAll = FALSE
				Call SalSendClassMessage(UM_Populate, 0, 0)
			On SAM_FetchRowDone
				Set sOst = Dig4(cOst * SalNumberPower(100, DIG) / 100, DIG, nMaxDig)
				If cBr = 0 AND cIr != NUMBER_Null AND cOp = STRING_Null
					Set cBr = NUMBER_Null
				If cIr = NUMBER_Null or cBr = NUMBER_Null
					Set cOp = STRING_Null
			On UM_CreateDoc
				Call CreateDepAddDoc(tbl_AvtoExtend.cDeposit_id,tbl_AvtoExtend.cVidd,'D')
			On WM_KeyDown
				If wParam = VK_F6
					Set dNewEndDate = DATETIME_Null
					If SalTblQueryContext(hWndItem) >= 0
						Call SalModalDialog(dlg_AvtoExtendDat, tbl_AvtoExtend, dDatX, dNewEndDate)
						If dNewEndDate != DATETIME_Null
							Set cNewDatEnd = dNewEndDate
			On SAM_ColumnSelectClick
				Call SalWaitCursor (TRUE)
				If wParam != nLastSortRow
					Set nLastSortRow = wParam
					Set nSortOrder = TBL_SortIncreasing
				Else
					Set nSortOrder = 1 - nSortOrder
				Set hColumn = SalNumberToWindowHandle(wParam)
				Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
				! сортировка строковых столбцов по числовым
				If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(sOst), COL_GetID)
					Set wParam = SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(cOst), COL_GetID))
				!
				Set hColumn = SalNumberToWindowHandle(wParam)
				Call SalTblSortRows( hWndForm, SalTblQueryColumnID(hColumn), nSortOrder)
				Call SalSendMsg(hWndForm, SAM_RowSetContext, 0, 0)
				Call SalWaitCursor(FALSE)
	Table Window: tbl_BrateDetails
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  6.967"
				Width Editable? Class Default
				Height: 2.774"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.44"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 37562
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 37563
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 37564
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: colDat
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Center
				Width:  Class Default
				Width Editable? Class Default
				Format: dd/MM/yyyy
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colCurrency
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Валюта
				Visible? Class Default
				Editable? No
				Maximum Data Length: 3
				Data Type: Class Default
				Justify: Center
				Width:  0.917"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colLimit
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Гран.сумма
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  2.5"
				Width Editable? Class Default
				Format: Unformatted
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colValue
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ставка
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  1.25"
				Width Editable? Class Default
				Format: 00000000
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nBrateId
			String: sBrateName
			Number: nCurrencyId
		Window Variables
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, sBrateName||' ('||Str(nBrateId)||')')
				Call PrepareWindowEx(hWndForm)
				Set tbl_BrateDetails.strPrintFileName = 'DPT_BRATE'
				Call SalDisableWindow(pbIns)
				Call SalDisableWindow(pbDel)
				Call SalDisableWindow(pbUpdate)
				Call SalDisableWindow(pbDetails)
				Set tbl_BrateDetails.strSqlPopulate =
						"SELECT b.bdate, v.lcv, b.s/100, b.rate
						   INTO :tbl_BrateDetails.colDat, 
						        :tbl_BrateDetails.colCurrency,        
						        :tbl_BrateDetails.colLimit,        
						        :tbl_BrateDetails.colValue      
						   FROM br_tier b, tabval v 
						  WHERE b.br_id = "||Str(tbl_BrateDetails.nBrateId)    ||
						"   AND b.kv    = "||Str(tbl_BrateDetails.nCurrencyId) ||
						"   AND b.kv    = v.kv
						    AND b.bdate = (SELECT max(t.bdate) 
						                     FROM br_tier t
						                    WHERE t.br_id = b.br_id
						                      AND t.kv = b.kv
						                      AND t.bdate <= bankdate) 
						  ORDER BY b.bdate, b.s" 
				Call SalSendClassMessage(SAM_Create, 0, 0)
	Dialog Box: dlg_AvtoExtendDat
		Class:
		Property Template:
		Class DLL Name:
		Title: Установка даты окончания переоформляемого вклада
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  6.15"
				Width Editable? Yes
				Height: 1.81"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Установка индивид.даты окончания вклада при автопереоформлении
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: Введите дату окончания вклада:
				Resource Id: 54743
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    0.262"
					Width:  4.2"
					Width Editable? Yes
					Height: 0.226"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: MS Sans Serif
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Teal
				Background Color: Default
			Data Field: bgDATT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfDATT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.483"
						Top:    0.238"
						Width:  1.233"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Teal
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If dfDATT > dX AND dX != DATETIME_Null
							! Введенная дата превышает допустимую дату окончания вклада
							Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_AvtoExtendDat.cTMessDat'),
									     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop)
							Return VALIDATE_Cancel
						Else
							Return VALIDATE_Ok
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledOk
				Property Template:
				Class DLL Name:
				Title: Выбрать
				Window Location and Size
					Left:   1.183"
					Top:    0.738"
					Width:  1.2"
					Width Editable? Class Default
					Height: 0.5"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\APPLY.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If NOT SalIsNull(dfDATT)
							Set newDatEnd = dfDATT
						Call SalEndDialog(hWndForm, TRUE)
			Pushbutton: pbExit
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledCancel
				Property Template:
				Class DLL Name:
				Title: Отменить
				Window Location and Size
					Left:   3.583"
					Top:    0.738"
					Width:  1.2"
					Width Editable? Class Default
					Height: 0.5"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, TRUE)
		Functions
		Window Parameters
			Date/Time: dX
			Receive Date/Time: newDatEnd
		Window Variables
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_AvtoExtendDat.cTWndTitle'))
				Call PrepareWindowEx(hWndForm)
				Call SalSetFocus(dfDATT)
	Form Window: frm_BindTts
		Class:
		Property Template:
		Class DLL Name:
		Title: Допустимые операции для данного вида вклада
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  12.8"
				Width Editable? Yes
				Height: 5.726"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Связь видов депозитных договоров с операциями
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.357"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Pushbutton: pb_Add
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.067"
						Top:    0.024"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Undo.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call F_Insert()
				Pushbutton: pb_Del
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.517"
						Top:    0.024"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Undo1.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call F_Delete()
				Pushbutton: pb_Close
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbCancel
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    0.024"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalDestroyWindow(hWndForm)
		Contents
			Custom Control: cSpltMain
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitterInvisible
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.733"
						Top:    0.56"
						Width:  9.283"
						Width Editable? Class Default
						Height: 3.19"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Yes
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.483"
						Top:    0.143"
						Width:  4.967"
						Width Editable? Yes
						Height: 1.595"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? No
				Contents
					Column: TT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.683"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NN
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ВЫБРАННЫЕ операции
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.417"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
					On SAM_DoubleClick
						Call F_Delete()
			Child Table: tbl2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   6.183"
						Top:    0.19"
						Width:  6.85"
						Width Editable? Yes
						Height: 3.881"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? No
				Contents
					Column: TT2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.683"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NN2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: НЕ выбранные операции
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.767"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
					On SAM_DoubleClick
						Call F_Insert()
		Functions
			Function: F_Populate
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalWaitCursor( TRUE )
					Call SalTblPopulate(tbl, hSql(), 
							    "SELECT tts.tt, name INTO :tbl.TT,:tbl.NN  
							       FROM tts, dpt_tts_vidd
							      WHERE tts.tt = dpt_tts_vidd.tt AND vidd = :VIDD 
							      ORDER  BY 1", TBL_FillAll)
					Call SalTblPopulate(tbl2, hSql(), 
							    "SELECT t.tt, t.name
							            INTO :tbl2.TT2, :tbl2.NN2 
							       FROM tts t, op_rules r
							      WHERE r.tag = 'DPTOP' 
							        AND r.tt = t.tt  
							        AND t.tt NOT LIKE 'DU%' 
							        AND t.tt NOT IN (SELECT tt FROM dpt_tts_vidd WHERE vidd = :VIDD) 
							        AND SubStr(t.flags,1,1) = decode(t.TT, 'PKR', '1' , '0')
							      ORDER BY 1 ", TBL_FillAll)
					Call SalWaitCursor(FALSE)
			Function: F_Insert
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set nRow = TBL_MinRow
					Call SalWaitCursor(TRUE)
					While SalTblFindNextRow(tbl2, nRow, ROW_Selected, 0)
						Call SalTblSetContext(tbl2, nRow)
						If SqlPrepareAndExecute(hSql(),
								  "INSERT INTO dpt_tts_vidd (vidd, tt) VALUES (:VIDD, :tbl2.TT2)") 
							! Привязана операция <...> к виду вклада <...>
							Call SqlCommitEx(hSql(), 
									                 CurrentLangTable.GetAtomTitle('frm_BindTts.cTAddTtt')||" "||tbl2.TT2||" "|| 
									                 CurrentLangTable.GetAtomTitle('frm_BindTts.cTToVidd')||" "||Str(VIDD))
					Call F_Populate()
					Call SalWaitCursor(FALSE)
			Function: F_Delete
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set nRow = TBL_MinRow
					Call SalWaitCursor(TRUE)
					While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
						Call SalTblSetContext(tbl, nRow)
						If SqlPrepareAndExecute(hSql(),
								  "DELETE FROM dpt_tts_vidd WHERE vidd = :VIDD AND tt = :tbl.TT") 
							! Отвязана операция <...> от вида вклада <...>
							Call SqlCommitEx(hSql(), 
									                 CurrentLangTable.GetAtomTitle('frm_BindTts.cTDropTt')  ||" "||tbl.TT||" "|| 
									                 CurrentLangTable.GetAtomTitle('frm_BindTts.cTFromVidd')||" "||Str(VIDD))
					Call F_Populate()
					Call SalWaitCursor(FALSE)
		Window Parameters
			Number: VIDD
		Window Variables
			Number: nRow
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_BindTts.cTWndTitle'))
				Call PrepareWindowEx(hWndForm)
				Call cSpltMain.setBarSize(1)
				Call cSpltMain.setBarPosition(500)
				Call cSpltMain.setLeftFrame(tbl)
				Call cSpltMain.setRightFrame(tbl2)
				Call F_Populate()
			On SAM_Destroy
				Set hWinTT = hWndNULL
	Form Window: frm_BindTemplate
		Class:
		Property Template:
		Class DLL Name:
		Title: Связь видов депозитных договоров с шаблонами
		Icon File:
		Accesories Enabled? Yes
		Visible? No
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   1.563"
				Top:    1.302"
				Width:  25.083"
				Width Editable? Yes
				Height: 9.857"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Связь видов депозитных договоров с шаблонами
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.357"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Pushbutton: pb_Add
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.067"
						Top:    0.024"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Undo.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call F_Insert()
				Pushbutton: pb_Del
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.517"
						Top:    0.024"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Undo1.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call F_Delete()
				Pushbutton: pb_Update
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbUpdate
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.967"
						Top:    0.024"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call F_Update()
				Pushbutton: pb_Close
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbCancel
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.433"
						Top:    0.036"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalDestroyWindow(hWndForm)
				Check Box: cbFastReport
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cCheckBoxLabeled
					Property Template:
					Class DLL Name:
					Title: Шаблони FastReport
					Window Location and Size
						Left:   2.083"
						Top:    0.071"
						Width:  2.5"
						Width Editable? Class Default
						Height: 0.25"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Bold
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call F_Populate()
		Contents
			Custom Control: cSpltMain
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitterInvisible
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.733"
						Top:    0.56"
						Width:  9.283"
						Width Editable? Class Default
						Height: 3.19"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Yes
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   -0.017"
						Top:    -0.012"
						Width:  12.0"
						Width Editable? Yes
						Height: 8.667"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? Yes
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? No
				Contents
					Column: colID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ВЫБРАННЫЕ шаблоны
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.783"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colFLAG
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Флаг
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.583"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Validate
								If colFLAG = NUMBER_Null
									Set cmbFLAGNAME = STRING_Null
									Return VALIDATE_Ok
								Call cmbFLAGNAME.SetSelectById(colFLAG)
								If cmbFLAGNAME.nCurrentId
									Return VALIDATE_Ok
								Else
									! Неверно указан код флага
									Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_BindTemplate.cTMessFlag'), 
											     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop)
									Return VALIDATE_Cancel
							!
					Column: cmbFLAGNAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Наименование флага
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  5.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_User
								Call cmbFLAGNAME.Init(hWndItem)
								Call cmbFLAGNAME.Populate(hSql(), "ID", "NAME", " DPT_VIDD_FLAGS ", " WHERE ACTIVITY = 1 " || 
										IifS( cbFastReport = TRUE, " AND ( ID = 1 OR USED_EBP <> 0 ) ", " " ) || " ORDER BY id ")
								Call SalListSetSelect(hWndItem, 0)
							On SAM_AnyEdit
								Set colFLAG = cmbFLAGNAME.GetKey(SalListQuerySelection(cmbFLAGNAME))
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
					On SAM_DoubleClick
						Call F_Delete()
					On SAM_FetchRowDone
						Call tbl.cmbFLAGNAME.SetSelectById(tbl.colFLAG)
			Child Table: tbl2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   12.283"
						Top:    0.0"
						Width:  12.2"
						Width Editable? Yes
						Height: 8.905"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? No
				Contents
					Column: colID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ДОСТУПНЫЕ шаблоны
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  4.333"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
					On SAM_DoubleClick
						Call F_Insert()
		Functions
			Function: F_Populate
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalWaitCursor( TRUE )
					Call SalSendMsg( tbl.cmbFLAGNAME, SAM_User, 0, 0 )
					If ( cbFastReport = FALSE )
						! Шаблони htm
						Call SalTblPopulate(tbl, hSql(), 
								    "SELECT d.id, d.name, f.id  
								            INTO :tbl.colID, :tbl.colNAME, :tbl.colFLAG
								          FROM dpt_docs d, dpt_vidd_scheme s, dpt_vidd_flags f
								      WHERE d.id = s.ID
								             AND f.id = s.flags 
								             AND s.vidd = :nVIDD 
								      ORDER BY 3, 2", TBL_FillAll)
						Call SalTblPopulate(tbl2, hSql(), 
								"SELECT d.id, d.name 
								        INTO :tbl2.colID,:tbl2.colNAME 
								      FROM bars.dpt_docs d 
								  WHERE id NOT IN ( SELECT id FROM dpt_vidd_scheme WHERE vidd = :nVIDD AND id is Not Null )
								         AND tip = 3 AND d.fr = 0
								   ORDER BY 2", TBL_FillAll)
					Else
						! Шаблони FastReport 
						Call SalTblPopulate(tbl, hSql(), 
								"  SELECT d.id, d.name, s.flags, f.id, f.used_ebp 
								    INTO :tbl.colID, :tbl.colNAME, :tbl.colFLAG
								    FROM dpt_docs d, dpt_vidd_scheme s, dpt_vidd_flags f
								   WHERE     d.id = s.ID_FR
								         AND f.id = s.flags
								         AND (f.id = 1 OR f.used_ebp <> 0)
								         AND s.vidd = :nVIDD
								ORDER BY 3, 2", TBL_FillAll)
						Call SalTblPopulate(tbl2, hSql(), 
								"  SELECT DISTINCT d.id, d.name
								    INTO :tbl2.colID, :tbl2.colNAME
								    FROM bars.dpt_docs d, dpt_vidd_scheme s, dpt_vidd_flags f
								   WHERE     d.id = s.ID_FR
								         AND f.id = s.flags
								         AND d.tip = 3
								         AND (f.id = 1 OR f.used_ebp <> 0)
								         AND d.fr = 1
								         AND d.id NOT IN (SELECT id_fr
								                            FROM dpt_vidd_scheme
								                           WHERE vidd = :nVIDD AND id_fr IS NOT NULL)
								ORDER BY 2", TBL_FillAll)
					Call SalWaitCursor(FALSE)
			Function: F_Insert
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set nRow = TBL_MinRow
					Call SalWaitCursor(TRUE)
					While SalTblFindNextRow(tbl2, nRow, ROW_Selected, 0)
						Call SalTblSetContext(tbl2, nRow)
						If SqlPLSQLCommand( hSql(), "BARS.DPT_UTILS.SET_VIDD_TEMPLATE( nVIDD, tbl2.colID, NUMBER_Null ) " )
							! Привязан шаблон <...> к виду вклада <...>
							Call SqlCommitEx( hSql(), CurrentLangTable.GetAtomTitle('frm_BindTemplate.cTAddShablon') ||
									               " "|| tbl2.colID ||" "|| CurrentLangTable.GetAtomTitle('frm_BindTemplate.cTToVidd') || " " || Str(nVIDD) )
					Call F_Populate()
					Call SalWaitCursor(FALSE)
			Function: F_Delete
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set nRow = TBL_MinRow
					Call SalWaitCursor(TRUE)
					While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
						Call SalTblSetContext(tbl, nRow)
						If ( cbFastReport = FALSE )
							If SqlPrepareAndExecute(hSql(),
									  "DELETE FROM dpt_vidd_scheme WHERE vidd = :nVIDD AND id = :tbl.colID") 
								! Отвязан шаблон <...> от вида вклада <...>
								Call SqlCommitEx( hSql(), 
										                 CurrentLangTable.GetAtomTitle('frm_BindTemplate.cTDropShablon')||" "||tbl.colID||" "|| 
										                 CurrentLangTable.GetAtomTitle('frm_BindTemplate.cTFromVidd')   ||" "||Str(nVIDD))
						Else
							If SqlPrepareAndExecute(hSql(),
									  "DELETE FROM dpt_vidd_scheme WHERE vidd = :nVIDD AND id_fr = :tbl.colID and flags = :tbl.colFLAG") 
							! Отвязан шаблон <...> от вида вклада <...>
							Call SqlCommitEx( hSql(), 
									                 CurrentLangTable.GetAtomTitle('frm_BindTemplate.cTDropShablon')||" "||tbl.colID||" "|| 
									                 CurrentLangTable.GetAtomTitle('frm_BindTemplate.cTFromVidd')   ||" "||Str(nVIDD))
					Call F_Populate()
					Call SalWaitCursor(FALSE)
			Function: F_Update
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set nRow = TBL_MinRow
					Call SalWaitCursor(TRUE)
					!
					If ( cbFastReport = FALSE )
						! Шаблони htm
						While SalTblFindNextRow(tbl, nRow, ROW_Edited, 0)
							Call SalTblSetContext(tbl, nRow)
							Call SqlPrepare( hSql(), "UPDATE bars.dpt_vidd_scheme SET flags = :tbl.colFLAG WHERE id = :tbl.colID" )
							Call SalTblDoUpdates( tbl, hSql(), TRUE )
							Call SqlCommit(hSql())
					Else
						! Шаблони FastReport 
						While SalTblFindNextRow(tbl, nRow, ROW_Edited, 0)
							Call SalTblSetContext(tbl, nRow)
							If SqlPLSQLCommand( hSql(), "BARS.DPT_UTILS.UPD_VIDD_TEMPLATE(nVIDD, tbl.colID, tbl.colFLAG) " )
								Call SqlCommitEx( hSql(), 
										                 CurrentLangTable.GetAtomTitle('frm_BindTemplate.cTDropShablon')||" "||tbl.colID||" "|| 
										                 CurrentLangTable.GetAtomTitle('frm_BindTemplate.cTFromVidd')   ||" "||Str(nVIDD))
					Call F_Populate()
					Call SalWaitCursor(FALSE)
		Window Parameters
			Number: nVIDD
		Window Variables
			Number: nRow
		Message Actions
			On SAM_Create
				! Допустимые шаблоны договоров для данного вида вклада
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_BindTemplate.cTWndTitle'))
				Call SalTblSetColumnTitle(hWndForm.frm_BindTemplate.tbl.cmbFLAGNAME,
						  CurrentLangTable.GetAtomTitle('frm_BindTemplate.tbl.cmbFLAGNAME'))
				Call PrepareWindowEx(hWndForm)
				Call cSpltMain.setBarSize(1)
				Call cSpltMain.setBarPosition(500)
				Call cSpltMain.setLeftFrame(tbl)
				Call cSpltMain.setRightFrame(tbl2)
				Call F_Populate()
			On SAM_Destroy
				Set hWinTemplates = hWndNULL
	Form Window: frm_BindFields
		Class:
		Property Template:
		Class DLL Name:
		Title: Допустимые доп.реквизиты для данного вида вклада
		Icon File:
		Accesories Enabled? Yes
		Visible? No
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  12.8"
				Width Editable? Yes
				Height: 5.726"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Связь видов депозитных договоров с доп.реквизитами
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.357"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Pushbutton: pb_Add
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.067"
						Top:    0.024"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Undo.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(tbl2, nRow, ROW_Selected, 0)
								Call SalSendMsg(tbl2, SAM_DoubleClick, 0, nRow)
				Pushbutton: pb_Del
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.517"
						Top:    0.024"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Undo1.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
								Call SalSendMsg(tbl, SAM_DoubleClick, 0, nRow)
				Pushbutton: pb_Close
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbCancel
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    0.024"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalDestroyWindow(hWndForm)
		Contents
			Custom Control: cSpltMain
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitterInvisible
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.733"
						Top:    0.56"
						Width:  9.283"
						Width Editable? Class Default
						Height: 3.19"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Yes
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.483"
						Top:    0.143"
						Width:  4.967"
						Width Editable? Yes
						Height: 1.595"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? No
				Contents
					Column: colID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
						Visible? Yes
						Editable? No
						Maximum Data Length: 5
						Data Type: String
						Justify: Left
						Width:  0.9"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colOBZ
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ОБЗ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.483"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Click
								If SqlPrepareAndExecute(hSql(), 
										  "UPDATE dpt_vidd_field SET 
										          obz = :colOBZ
										    WHERE vidd = :nVIDD AND tag = :colID" )
									! Изменен признак обязат-ти доп.реквизита <...> для вида вклада <...>
									Call SqlCommitEx(hSql(), CurrentLangTable.GetAtomTitle('frm_BindFields.cTUpdateObz') || " "||colID||" " || 
											     CurrentLangTable.GetAtomTitle('frm_BindFields.cTForVidd') || " "||Str(nVIDD))
								Else
									Call SqlRollback(hSql())
					Column: colNAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ВЫБРАННЫЕ доп.реквизиты
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.783"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
					On SAM_DoubleClick
						If SqlPrepareAndExecute( hSql(),
								   "DELETE FROM dpt_vidd_field 
								     WHERE vidd = :nVIDD AND tag = :tbl.colID" ) 
								and SqlCommitEx(hSql(), CurrentLangTable.GetAtomTitle('frm_BindFields.cTDropDR') || " "||colID||" " || 
								    CurrentLangTable.GetAtomTitle('frm_BindFields.cTFromVidd') ||" "||Str(nVIDD))
						! Отвязан доп.реквизит <...> от вида вклада <...>
						Call F_Populate()
			Child Table: tbl2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   6.183"
						Top:    0.19"
						Width:  6.85"
						Width Editable? Yes
						Height: 3.881"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? No
				Contents
					Column: colID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
						Visible? Yes
						Editable? No
						Maximum Data Length: 5
						Data Type: String
						Justify: Left
						Width:  0.9"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ДОСТУПНЫЕ доп.реквизиты
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  4.333"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
					On SAM_DoubleClick
						! Доп.реквизит ОБЯЗАТЕЛЕН для заполнения?
						If SalMessageBox(CurrentLangTable.GetAtomTitle('frm_BindFields.cTMessObz'),
								   CurrentLangTable.GetAtomTitle('cTQuestion'), MB_IconQuestion|MB_YesNo) = IDYES
							Set nObz = 1
						Else
							Set nObz = 0
						If SqlPrepareAndExecute(hSql(),
								  "INSERT INTO dpt_vidd_field (vidd,tag,obz) 
								   VALUES (:nVIDD,:tbl2.colID,:nObz)" ) 
								and SqlCommitEx(hSql(), CurrentLangTable.GetAtomTitle('frm_BindFields.cTAddDR') || " "||colID||" " || 
								    CurrentLangTable.GetAtomTitle('frm_BindFields.cTToVidd') || " "||Str(nVIDD))
						! Привязан доп.реквизит <...> к виду вклада <...>
						Call F_Populate()
		Functions
			Function: F_Populate
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalWaitCursor(TRUE)
					Call SalTblPopulate(tbl, hSql(), 
							    "SELECT f.tag, nvl(v.obz,0), f.name 
							       INTO :tbl.colID,:tbl.colOBZ,:tbl.colNAME  
							       FROM dpt_field f, dpt_vidd_field v
							      WHERE f.tag = v.tag AND v.vidd = :nVIDD 
							      ORDER BY 1", TBL_FillAll)
					Call SalTblPopulate(tbl2, hSql(), 
							    "SELECT f.tag, f.name
							       INTO :tbl2.colID,:tbl2.colNAME 
							       FROM dpt_field f 
							      WHERE tag NOT IN 
							             (SELECT tag FROM dpt_vidd_field WHERE vidd = :nVIDD) 
							      ORDER BY 1", TBL_FillAll)
					Call SalWaitCursor(FALSE)
		Window Parameters
			Number: nVIDD
		Window Variables
			Number: nRow
			Number: nObz
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_BindFields.cTWndTitle'))
				Call PrepareWindowEx(hWndForm)
				Call cSpltMain.setBarSize(1)
				Call cSpltMain.setBarPosition( 500)
				Call cSpltMain.setLeftFrame(tbl)
				Call cSpltMain.setRightFrame(tbl2)
				Call F_Populate()
			On SAM_Destroy
				Set hWinField = hWndNULL
	Form Window: frm_BindUsers
		Class:
		Property Template:
		Class DLL Name:
		Title: Пользователи, которым доступен для открытия данный вид вклада
		Icon File:
		Accesories Enabled? Yes
		Visible? No
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  12.8"
				Width Editable? Yes
				Height: 5.726"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Связь видов депозитных договоров с пользователями
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.357"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Pushbutton: pb_Add
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.067"
						Top:    0.024"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Undo.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call F_Insert()
				Pushbutton: pb_Del
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.517"
						Top:    0.024"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Undo1.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call F_Delete()
				Pushbutton: pb_Close
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbCancel
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    0.024"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalDestroyWindow(hWndForm)
		Contents
			Custom Control: cSpltMain
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitterInvisible
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.733"
						Top:    0.56"
						Width:  9.283"
						Width Editable? Class Default
						Height: 3.19"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Yes
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.483"
						Top:    0.143"
						Width:  4.967"
						Width Editable? Yes
						Height: 1.595"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? No
				Contents
					Column: colID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.9"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ВЫБРАННЫЕ пользователи
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.783"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
					On SAM_DoubleClick
						Call F_Delete()
			Child Table: tbl2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   6.183"
						Top:    0.19"
						Width:  6.85"
						Width Editable? Yes
						Height: 3.881"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? No
				Contents
					Column: colID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.9"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ДОСТУПНЫЕ пользователи
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  4.333"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
					On SAM_DoubleClick
						Call F_Insert()
		Functions
			Function: F_Populate
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalWaitCursor( TRUE )
					Call SalTblPopulate(tbl, hSql(), 
							    "SELECT s.id, s.fio 
							       INTO :tbl.colID,:tbl.colNAME  
							       FROM staff s, dpt_vidd_staff v
							      WHERE s.id = v.userid AND v.vidd = :nVIDD 
							      ORDER BY 1", TBL_FillAll)
					Call SalTblPopulate(tbl2, hSql(), 
							    "SELECT id, fio
							       INTO :tbl2.colID,:tbl2.colNAME 
							       FROM staff 
							      WHERE id NOT IN 
							             (SELECT userid FROM dpt_vidd_staff WHERE vidd = :nVIDD) 
							      ORDER BY 1", TBL_FillAll)
					Call SalWaitCursor(FALSE)
			Function: F_Insert
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set nRow = TBL_MinRow
					Call SalWaitCursor(TRUE)
					While SalTblFindNextRow(tbl2, nRow, ROW_Selected, 0)
						Call SalTblSetContext(tbl2, nRow)
						If SqlPrepareAndExecute(hSql(),
								  "INSERT INTO dpt_vidd_staff (vidd,userid) VALUES (:nVIDD,:tbl2.colID)") 
							! Привязан пользователь <...> к виду вклада <...>
							Call SqlCommitEx(hSql(), 
									                 CurrentLangTable.GetAtomTitle('frm_BindUsers.cTAddUser') ||" "||Str(tbl2.colID)||" "|| 
									                 CurrentLangTable.GetAtomTitle('frm_BindUsers.cTToVidd')  ||" "||Str(nVIDD))
					Call F_Populate()
					Call SalWaitCursor(FALSE)
			Function: F_Delete
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set nRow = TBL_MinRow
					Call SalWaitCursor(TRUE)
					While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
						Call SalTblSetContext(tbl, nRow)
						If SqlPrepareAndExecute(hSql(),
								  "DELETE FROM dpt_vidd_staff WHERE vidd = :nVIDD AND userid = :tbl.colID") 
							! Отвязан пользователь <...> от вида вклада <...>
							Call SqlCommitEx(hSql(), 
									                 CurrentLangTable.GetAtomTitle('frm_BindUsers.cTDropUser')|| " "||Str(tbl.colID)||" "|| 
									                 CurrentLangTable.GetAtomTitle('frm_BindUsers.cTFromVidd')|| " "||Str(nVIDD))
					Call F_Populate()
					Call SalWaitCursor(FALSE)
					!
		Window Parameters
			Number: nVIDD
		Window Variables
			Number: nRow
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_BindUsers.cTWndTitle'))
				Call PrepareWindowEx(hWndForm)
				Call cSpltMain.setBarSize(1)
				Call cSpltMain.setBarPosition( 500)
				Call cSpltMain.setLeftFrame(tbl)
				Call cSpltMain.setRightFrame(tbl2)
				Call F_Populate()
			On SAM_Destroy
				Set hWinUser = hWndNULL
	Form Window: frm_BindBranches
		Class:
		Property Template:
		Class DLL Name:
		Title: Подразделения, которым доступен для открытия данный вид вклада
		Icon File:
		Accesories Enabled? Yes
		Visible? No
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  12.8"
				Width Editable? Yes
				Height: 5.726"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Привязка видов вкладов к подразделениям банка
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.357"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Pushbutton: pb_Add
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.067"
						Top:    0.024"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Undo.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call F_Insert()
				Pushbutton: pb_Del
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.517"
						Top:    0.024"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Undo1.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call F_Delete()
				Pushbutton: pb_Close
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbCancel
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    0.024"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalDestroyWindow(hWndForm)
		Contents
			Custom Control: cSpltMain
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitterInvisible
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.733"
						Top:    0.56"
						Width:  9.283"
						Width Editable? Class Default
						Height: 3.19"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Yes
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.483"
						Top:    0.143"
						Width:  4.967"
						Width Editable? Yes
						Height: 1.595"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? No
				Contents
					Column: colID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.9"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ВЫБРАННЫЕ подразделения
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.783"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
					On SAM_DoubleClick
						Call F_Delete()
			Child Table: tbl2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   6.183"
						Top:    0.19"
						Width:  6.85"
						Width Editable? Yes
						Height: 3.881"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? No
				Contents
					Column: colID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.9"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ДОСТУПНЫЕ подразделения
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  4.333"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
					On SAM_DoubleClick
						Call F_Insert()
		Functions
			Function: F_Populate
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalWaitCursor( TRUE )
					! Схема безбалансовых - BRANCH
					If GetGlobalOptionEx('HAVETOBO') = 2
						Call SalTblPopulate(tbl, hSql(), 
								    "SELECT b.branch, b.name
								       INTO :tbl.colID,:tbl.colNAME  
								       FROM branch b, dpt_vidd_branch v
								      WHERE b.branch = v.branch AND v.vidd = :nVIDD 
								      ORDER BY 1", TBL_FillAll)
						Call SalTblPopulate(tbl2, hSql(), 
								    "SELECT b.branch, b.name
								       INTO :tbl2.colID,:tbl2.colNAME 
								       FROM branch b
								      WHERE b.branch NOT IN 
								             (SELECT branch FROM dpt_vidd_branch WHERE vidd = :nVIDD) 
								      ORDER BY 1", TBL_FillAll)
					! Схема безбалансовых - TOBO
					Else
						Call SalTblPopulate(tbl, hSql(), 
								    "SELECT t.tobo, t.name
								       INTO :tbl.colID,:tbl.colNAME  
								       FROM tobo t, dpt_vidd_branch v
								      WHERE t.tobo = v.branch AND v.vidd = :nVIDD 
								      ORDER BY 1", TBL_FillAll)
						Call SalTblPopulate(tbl2, hSql(), 
								    "SELECT t.tobo, t.name
								       INTO :tbl2.colID,:tbl2.colNAME 
								       FROM tobo t 
								      WHERE t.tobo NOT IN 
								             (SELECT branch FROM dpt_vidd_branch WHERE vidd = :nVIDD) 
								      ORDER BY 1", TBL_FillAll)
					Call SalWaitCursor(FALSE)
			Function: F_Insert
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set nRow = TBL_MinRow
					Call SalWaitCursor(TRUE)
					While SalTblFindNextRow(tbl2, nRow, ROW_Selected, 0)
						Call SalTblSetContext(tbl2, nRow)
						If SqlPrepareAndExecute(hSql(),
								  "INSERT INTO dpt_vidd_branch (vidd, branch) VALUES (:nVIDD, :tbl2.colID)") 
							Call SqlCommitEx(hSql(), 
									                 CurrentLangTable.GetAtomTitle('frm_BindBranches.cTAddBranch')||" "||tbl2.colID||" "||
									                 CurrentLangTable.GetAtomTitle('frm_BindBranches.cTToVidd')   ||" "||Str(nVIDD))
					Call F_Populate()
					Call SalWaitCursor(FALSE)
			Function: F_Delete
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set nRow = TBL_MinRow
					Call SalWaitCursor(TRUE)
					While SalTblFindNextRow(tbl, nRow, ROW_Selected, 0)
						Call SalTblSetContext(tbl, nRow)
						If SqlPrepareAndExecute(hSql(),
								  "DELETE FROM dpt_vidd_branch WHERE vidd = :nVIDD AND branch = :tbl.colID") 
							Call SqlCommitEx(hSql(), 
									                 CurrentLangTable.GetAtomTitle('frm_BindBranches.cTDropBranch')||" "||tbl.colID||" "||
									                 CurrentLangTable.GetAtomTitle('frm_BindBranches.cTFromVidd')  ||" "||Str(nVIDD))
					Call F_Populate()
					Call SalWaitCursor(FALSE)
		Window Parameters
			Number: nVIDD
		Window Variables
			Number: nRow
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_BindBranches.cTWndTitle'))
				Call PrepareWindowEx(hWndForm)
				Call cSpltMain.setBarSize(1)
				Call cSpltMain.setBarPosition( 500)
				Call cSpltMain.setLeftFrame(tbl)
				Call cSpltMain.setRightFrame(tbl2)
				Call F_Populate()
			On SAM_Destroy
				Set hWinUser = hWndNULL
	Table Window: tbl_Archive
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Архив депозитов
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.175"
				Top:    2.375"
				Width:  23.333"
				Width Editable? Class Default
				Height: 8.774"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000000
			Discardable? Class Default
		Description: Архив депозитов
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.68"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Background Text: Вид вклада:
					Resource Id: 44603
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   3.5"
						Top:    0.095"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: Default
				Data Field: bgVIDD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cLabelControl
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Class Default
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   Default
							Top:    Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Border? Class Default
						Justify: Class Default
						Format: Class Default
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
				Data Field: nVIDD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.25"
							Top:    0.07"
							Width:  0.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Blue
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							! Код вида вклада
							Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('tbl_Archive.cFTipVIDD'))
				Combo Box: cmb_VIDD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_NumId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   6.1"
						Top:    0.07"
						Width:  5.4"
						Width Editable? Class Default
						Height: 4.0"
						Height Editable? Class Default
					Visible? Class Default
					Editable? Class Default
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Blue
					Background Color: Class Default
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_TooltipSetText
							! Вид вклада
							Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('cTVidd'))
						On SAM_Create
							Call cmb_VIDD.Init(hWndItem)
							Call cmb_VIDD.Populate(hSql(),"VIDD","TYPE_NAME","DPT_VIDD","ORDER BY VIDD")
							Call cmb_VIDD.Add(-1, 'Весь портфель')
							Call cmb_VIDD.SetSelectById(nVIDD)
						On SAM_Click
							Set nVIDD = cmb_VIDD.GetKey(SalListQuerySelection(cmb_VIDD))
				Background Text: Дата:
					Resource Id: 44604
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   11.75"
						Top:    0.095"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Red
					Background Color: Default
				Data Field: bgDAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cLabelControl
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Class Default
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   Default
							Top:    Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Border? Class Default
						Justify: Class Default
						Format: Class Default
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
				Data Field: dfDAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   12.8"
							Top:    0.07"
							Width:  1.183"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: dd-MM-yyyy
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Background Text: Код отделения:
					Resource Id: 41939
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   2.2"
						Top:    0.381"
						Width:  3.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Data Field: bgBranch
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cLabelControl
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Class Default
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   Default
							Top:    Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Border? Class Default
						Justify: Class Default
						Format: Class Default
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
				Data Field: dfBranch
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.25"
							Top:    0.369"
							Width:  3.533"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Combo Box: cmbBranch
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_StrId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   8.85"
						Top:    0.369"
						Width:  5.15"
						Width Editable? Class Default
						Height: 4.0"
						Height Editable? Class Default
					Visible? Class Default
					Editable? Class Default
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? No
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_TooltipSetText
							! Код отделения
							Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('tbl_Archive.cFTipBranch'))
						On UM_ObjActivate
							If cmbBranch.Init(hWndItem)
								If nHaveTOBO = 2
									Call cmbBranch.Populate(hSql(), "branch", "branch||' '||name", "our_branch", "order by branch")
								Else
									Call cmbBranch.Populate(hSql(), "tobo", "tobo||' '||name", "tobo", "order by tobo")
								! Call cmbBranch.Add('-', 'Все подразделения')
								Call cmbBranch.Add('-', CurrentLangTable.GetAtomTitle('tbl_Archive.cTAllBranch'))
								Call cmbBranch.SetSelectById(dfBranch)
						On SAM_Click
							Call SalSendClassMessage(SAM_Click, 0, 0)
							Set dfBranch = cmbBranch.GetCurrentKey()
				!
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.05"
						Top:    0.048"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Enter
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.483"
						Top:    0.048"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.917"
						Top:    0.048"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.783"
						Top:    0.048"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Open.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.35"
						Top:    0.048"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.533"
						Top:    0.048"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 44600
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.383"
						Begin Y:  -0.024"
						End X:  2.383"
						End Y:  0.44"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 44601
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 44602
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: nID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: №
						вклада
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.757"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Номер
						депозита
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.95"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sBRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						отделения
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sNLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Лиц.счет
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nKV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sKV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: ВАЛ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nRNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sNMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Имя
						вкладчика
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.214"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма
						вклада
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.129"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nSQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма
						вклада
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.129"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма
						вклада
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nSN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма
						нач %
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.9"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nSNQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма
						нач %
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.9"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sSN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сумма
						нач %
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  0.9"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nVID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sVID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Вид
						вклада
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nPROC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: %
						ставка
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.717"
				Width Editable? Yes
				Format: 00000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: dDAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата
						открытия
						вклада
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.083"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: dDAT2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата
						окончания
						вклада
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.167"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nPROL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: К-ть
						пролон.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.833"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nACCN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sNLSN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Лиц.счет
						нач %
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.614"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nISP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Исп
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: dDATF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата
						закрытия
						(фактич.)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.167"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: dUNDO_EXT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата отказа от
						автопролонгации
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.6"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nDOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Обороты
						Дт
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sDOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Обороты
						Дт
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nKOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Обороты
						Кт
						
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sKOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Обороты
						Кт
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nDig
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DIG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nIdUpd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: nKT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sDOCTYP 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: sPASP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: dPASPDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Class Default
				Width:  Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: sPASPORG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
		Functions
			! BAA < Внесення даних в контекст для наповненя вюшки >
			Function: SetContecst
				Description: < Внесення даних в контекст для наповненя вюшки >
				Returns
				Parameters
				Static Variables
				Local variables
					String: sNAME
					String: sDAT
					! String: sBRANCH
				Actions
					Set sNAME = "dpt_dat"
					Set sDAT = SalFmtFormatDateTime(dfDAT, 'dd.MM.yyyy')
					Call SqlPLSQLCommand(hSqlAux(),"PUL.Set_Mas_Ini(sNAME, sDAT, sNAME)")
					Set sNAME = "dpt_branch"
					Call SqlPLSQLCommand(hSqlAux(),"PUL.Set_Mas_Ini(sNAME, dfBranch, sNAME)")
		Window Parameters
			Number: ISP
			String: sPar1	! Назва вюшки
			String: sPar2
		Window Variables
			String: sTable
			String: sF
			String: sAddFilter
			String: sSelectItogo
			Number: nFetchRes
			Number: nSortOrder
			Number: nLastSortRow
			Window Handle: hColumn
			!
			Number: nX
			Number: nY
			Window Handle: hWndToolBar
			Number: nMaxDig
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tbl_Archive.cTWndTitle'))
				Call PrepareWindow(hWndForm)
				Call SetWindowFullSize(hWndForm)
				Call SalSetFocus(cmb_VIDD)
				Call XSalTooltipSetUserDefault()
				Set dfBranch = '-'
				Set nVIDD = -1
				If nHaveTOBO = 0
					Call SalHideWindow(hWndForm.tbl_Archive.sBRANCH)
					Call SalHideWindow(dfBranch)
					Call SalHideWindow(cmbBranch)
					Call SalHideWindowAndLabel(bgBranch)
					Set hWndToolBar = SalGetFirstChild(hWndForm, TYPE_FormToolBar)
					Call SalGetWindowSize(hWndToolBar, nX, nY)
					Call SalTimerSet(hWndForm, 1, 0.01)
				Else
					If nHaveTOBO = 2
						! Код отделения
						Call SalTblSetColumnTitle(sBRANCH, CurrentLangTable.GetAtomTitle('tbl_Archive.sBRANCH'))
						Call SalSetWindowLabelText(bgBranch, CurrentLangTable.GetAtomTitle('tbl_Archive.bgBranch') )
					Call SalSendMsg(cmbBranch, UM_ObjActivate, 0, 0)
				Set dfDAT = GetBankDate()
				Set sTable = IifS(sPar1='', 'DPT_S', SalStrUpperX( sPar1 ) )
				Set tbl_Archive.nTabInstance = 1
				Set tbl_Archive.strFilterTblName = sTable
				Set tbl_Archive.strPrintFileName = 'ARCHIVE'
				Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
				If DigInit() != -1
					Set nMaxDig = DigInit()
				Else
					Set nMaxDig = 4
				! якщо Правекс або табл. не [V_DPT_S] ховаєм кнопку перегляду картки вкладу
				If (GetGlobalOption('BANKTYPE') = 'PRVX') or (sTable != "V_DPT_S")
					Call SalHideWindow ( tbl_Archive.pbDetails )
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				Call SalWaitCursor(FALSE)
			On SAM_DoubleClick
				If ( sTable = 'V_DPT_S' )
					Call GetCardVklad(hWndForm, -tbl_Archive.nID, tbl_Archive.sVID, tbl_Archive.sNMK, tbl_Archive.sDOCTYP,
							tbl_Archive.sPASP, DtoC(tbl_Archive.dPASPDAT)||" р. "|| tbl_Archive.sPASPORG, '@@@', STRING_Null, Str(tbl_Archive.nIdUpd),'')
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set sAddFilter = IifS(ISP > 0, " dpt_s.isp = " || Str(ISP), "")
				! якщо юзаєм <V_DPT_S>
				If sTable="V_DPT_S" 
					Set sAddFilter = sAddFilter || IifS(nVIDD != -1, " AND dpt_s.vidd = :tbl_Archive.nVIDD ", "")
					Call SetContecst()
				Else
					Set sAddFilter  =    "AND dpt_s.fdat = :tbl_Archive.dfDAT " || sAddFilter ||
							IifS( nVIDD != -1,     "AND dpt_s.vidd = :tbl_Archive.nVIDD ", "") || 
							IifS( dfBranch != '-', "AND dpt_s.branch = :tbl_Archive.dfBranch ", "")
				Set tbl_Archive.strSqlPopulate = "
						SELECT dpt_s.nls, t.lcv, dpt_s.kv, dpt_s.isp, dpt_s.id, dpt_s.nd,
						                  dpt_s.nam, dpt_s.datn, dpt_s.datk, dpt_s.nmk, dpt_s.pr,
						                  dpt_s.ost/power(10,t.dig), dpt_s.sn/power(10,t.dig), t.dig, dpt_s.real_expire, t.dig" ||
						IifS( sTable != 'V_DPT_S', ", dpt_s.dos/power(10,t.dig), dpt_s.kos/power(10,t.dig)",
						              ", dpt_s.IDUPD, dpt_s.DOCTYP, dpt_s.PASP, dpt_s.PASPDAT, dpt_s.PASPORG,
						                  dpt_s.prol, dpt_s.ostQ/power(10,t.dig), dpt_s.snQ/power(10,t.dig), KT, to_char(UNDO_EXT,'dd.mm.yyyy')" ) ||
						IifS(nHaveTOBO=0, "", ", dpt_s.branch") ||
						   " INTO :tbl_Archive.sNLS, :tbl_Archive.sKV,   :tbl_Archive.nKV,   :tbl_Archive.nISP,  :tbl_Archive.nID, :tbl_Archive.sND,
						                 :tbl_Archive.sVID, :tbl_Archive.dDAT1, :tbl_Archive.dDAT2, :tbl_Archive.sNMK,  :tbl_Archive.nPROC,
						                 :tbl_Archive.nS,   :tbl_Archive.nSN,   :tbl_Archive.nDig,  :tbl_Archive.dDATF, :tbl_Archive.DIG" ||
						IifS( sTable != 'V_DPT_S', ", :tbl_Archive.nDOS, :tbl_Archive.nKOS",
						             ", :tbl_Archive.nIdUpd,  :tbl_Archive.sDOCTYP,  :tbl_Archive.sPASP,  :tbl_Archive.dPASPDAT, 
						                 :tbl_Archive.sPASPORG, :tbl_Archive.nPROL,  :tbl_Archive.nSQ,  :tbl_Archive.nSNQ,  :tbl_Archive.nKT, :tbl_Archive.dUNDO_EXT " ) ||
						IifS( nHaveTOBO=0, "", ", :tbl_Archive.sBRANCH" ) ||
						 " FROM dpt_s, tabval t  
						WHERE dpt_s.kv = t.kv " || sAddFilter || " ORDER BY dpt_s.id "
				! Меняем в строке населения dpt_s на имя таблицы
				Set tbl_Archive.strSqlPopulate = VisStrSubstitute(tbl_Archive.strSqlPopulate, 'dpt_s', sTable)
				Call cQ.Init(tbl_Archive.strSqlPopulate)
				! Состояние депозитного портфеля на dat
				Call SalSetWindowText(hWndForm, 
						     CurrentLangTable.GetAtomTitle('tbl_Archive.cTWndTitle') || ' ' || SalFmtFormatDateTime(dfDAT,'dd-MM-yyyy') || 
						     IifS(nVIDD != -1, '. ' || CurrentLangTable.GetAtomTitle('cTVidd') || ' ' || tbl_Archive.cmb_VIDD, ''))
				Call SalSendClassMessage(UM_Populate, 0, 0)
				Set sF = ""
				Set sF = cF.GetFilterWhereClause(FALSE)
				If sF != ""
					Set sF = " AND " || sF
				! Итоговая строка
				Call SalWaitCursor(TRUE)
				Call SalTblDefineSplitWindow (hWndForm, 1, TRUE)
				Call SalTblSetContext (hWndForm, SalTblInsertRow(hWndForm,TBL_MinRow))
				! == якщо юзаєм <V_DPT_S> =====================================================
				If sTable="V_DPT_S" 
					Set tbl_Archive.sNLS= CurrentLangTable.GetAtomTitle('tbl_Archive.Total')||" "||
							                       Str(SalTblColumnSum(hWndForm, SalTblQueryColumnPos(nKT ), 0, 0))
					Set tbl_Archive.sS  = Dig4(SalTblColumnSum(hWndForm, SalTblQueryColumnPos(nSQ ), 0, 0), 2, nMaxDig)
					Set tbl_Archive.sSN = Dig4(SalTblColumnSum(hWndForm, SalTblQueryColumnPos(nSNQ), 0, 0), 2, nMaxDig)
					Call SalHideWindow ( tbl_Archive.sDOS )
					Call SalHideWindow ( tbl_Archive.sKOS )
				! =============================================================================
				Else
					! из select'а убрали /power(100,dig), т.к. это эквивалент (всегда /100)
					Set sSelectItogo = 
							   "SELECT TO_CHAR(count(dpt_s.id)), 
							           sum(gl.p_icurval(dpt_s.kv,dpt_s.ost,:dfDAT))/100,
							           sum(gl.p_icurval(dpt_s.kv,dpt_s.sn, :dfDAT))/100,
							           sum(gl.p_icurval(dpt_s.kv,dpt_s.dos,:dfDAT))/100,
							           sum(gl.p_icurval(dpt_s.kv,dpt_s.kos,:dfDAT))/100
							      INTO :tbl_Archive.sNLS, :tbl_Archive.nS, :tbl_Archive.nSN, :tbl_Archive.nDOS,:tbl_Archive.nKOS   
							      FROM dpt_s " || IifS(SalStrLength(sAddFilter) > 2, "WHERE " || Subs( sAddFilter,5,SalStrLength(sAddFilter)-4) ,"")
					! Меняем dpt_s на имя таблицы
					Set sSelectItogo = VisStrSubstitute(sSelectItogo, 'dpt_s', sTable)
					! sF уже содержит правильное имя таблицы
					Set sSelectItogo = sSelectItogo || sF
					! Call SalMessageBox ( sSelectItogo, 'PRAVEX', MB_Ok )
					If SqlPrepareAndExecute(hSqlAux(), sSelectItogo) 
							and SqlFetchNext(hSqlAux(), nFetchRes)
						Set sNLS = 'Итого: ' || sNLS
						Set sS   = Dig4(nS,   2, nMaxDig)
						Set sSN  = Dig4(nSN,  2, nMaxDig)
						Set sDOS = Dig4(nDOS, 2, nMaxDig)
						Set sKOS = Dig4(nKOS, 2, nMaxDig)
				Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_ColumnSelectClick
				Call SalWaitCursor (TRUE)
				If wParam != nLastSortRow
					Set nLastSortRow = wParam
					Set nSortOrder = TBL_SortIncreasing
				Else
					Set nSortOrder = 1 - nSortOrder
				Set hColumn = SalNumberToWindowHandle(wParam)
				Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
				! сортировка строковых столбцов по числовым
				If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(tbl_Archive, SalTblQueryColumnID(sS), COL_GetID)
					Set wParam = SalWindowHandleToNumber(SalTblGetColumnWindow(tbl_Archive, SalTblQueryColumnPos(nS), COL_GetID))
				If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(tbl_Archive, SalTblQueryColumnID(sSN), COL_GetID)
					Set wParam = SalWindowHandleToNumber(SalTblGetColumnWindow(tbl_Archive, SalTblQueryColumnPos(nSN), COL_GetID))
				If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(tbl_Archive, SalTblQueryColumnID(sDOS), COL_GetID)
					Set wParam = SalWindowHandleToNumber(SalTblGetColumnWindow(tbl_Archive, SalTblQueryColumnPos(nDOS), COL_GetID))
				If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(tbl_Archive, SalTblQueryColumnID(sKOS), COL_GetID)
					Set wParam = SalWindowHandleToNumber(SalTblGetColumnWindow(tbl_Archive, SalTblQueryColumnPos(nKOS), COL_GetID))
				!
				Call SalTblSortRows(hWndForm, SalTblQueryColumnID(hColumn), nSortOrder)
				Call SalSendMsg(hWndForm, SAM_RowSetContext, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				Set sS   = Dig4(nS   * SalNumberPower(10, DIG) / 100, DIG, nMaxDig)
				Set sSN  = Dig4(nSN  * SalNumberPower(10, DIG) / 100, DIG, nMaxDig)
				Set sDOS = Dig4(nDOS * SalNumberPower(10, DIG) / 100, DIG, nMaxDig)
				Set sKOS = Dig4(nKOS * SalNumberPower(10, DIG) / 100, DIG, nMaxDig)
			On SAM_Timer
				! Для изменения размера окна ToolBar'а
						(размер м. поменять только ПОСЛЕ CreateComplete окна)
				Call SalSetWindowSize(hWndToolBar, nX, 0.4)
				Call SalTimerKill(hWndForm, 1)
	Form Window: frm_ShtrafDetails
		Class:
		Property Template:
		Class DLL Name:
		Title: Редактирование штрафов
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   1.1"
				Top:    0.917"
				Width:  9.05"
				Width Editable? Yes
				Height: 5.345"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.464"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.05"
						Top:    0.095"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nNewRow=SalTblInsertRow ( tblSHPeriod, SalTblQueryContext ( tblSHPeriod ) +1 )
							Call SalTblSetFocusRow ( tblSHPeriod, nNewRow )
							Set nRow = tblSHPeriod.colTo
							Call SalTblSetContext( tblSHPeriod, nNewRow )
							Set tblSHPeriod.colFrom=nRow
				Pushbutton: pbDel
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.483"
						Top:    0.095"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalTblSetRowFlags(tblSHPeriod, SalTblQueryContext(tblSHPeriod), ROW_MarkDeleted, TRUE)
				Pushbutton: pbRefresh
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.917"
						Top:    0.095"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(hWndForm,SAM_CreateComplete,0,0)
				Pushbutton: pbUpdate
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.35"
						Top:    0.095"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalWaitCursor (TRUE)
							If UpdateFineParams(nFineId, hSql, sError) <0 
								Call SalMessageBox(sError,CurrentLangTable.GetAtomTitle('cTAt'),0)
								Call SalWaitCursor (FALSE)
								Call SqlRollback(hSql)
							Else
								Call SqlCommit(hSql)
							! Вычитка всех значений для штрафа nFineId
							Call RefreshFineParams(hSql,sError)
							! Установить вид окна в зависимости от значений cbIsDiffSHTerm и  cbIsDiffSH
							Call SetWindowState(cbIsDiffSH, cbIsDiffSHTerm, nShTerm_Id, nSh_Id,  hSql, sError)
							!
							Call SalWaitCursor (FALSE)
				Line
					Resource Id: 32985
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  2.517"
						Begin Y:  0.012"
						End X:  2.517"
						End Y:  0.476"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbExit
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.983"
						Top:    0.095"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: Esc
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalDestroyWindow(hWndForm)
				Line
					Resource Id: 32987
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  1.867"
						Begin Y:  0.012"
						End X:  1.867"
						End Y:  0.476"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
		Contents
			Background Text: Тип штрафа
				Resource Id: 28451
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.18"
					Top:    0.976"
					Width:  3.5"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: bgSHType
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Combo Box: cmbOstType
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.18"
					Top:    0.3"
					Width:  3.5"
					Width Editable? Class Default
					Height: 1.0"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
			Combo Box: cmbSrokType
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   3.8"
					Top:    0.3"
					Width:  3.5"
					Width Editable? Class Default
					Height: 1.0"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
			Background Text: Тип вычисления остатка
				Resource Id: 14581
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.18"
					Top:    0.095"
					Width:  3.5"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: bgOstType
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Background Text: Срок вычисляется в
				Resource Id: 14582
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.0"
					Top:    0.095"
					Width:  3.5"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: bgSrokType
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Check Box: cbIsDiffSH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCheckBoxLabeled
				Property Template:
				Class DLL Name:
				Title: Тип штрафа зависит от срока вклада
				Window Location and Size
					Left:   3.8"
					Top:    1.167"
					Width:  4.15"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SetWindowState(cbIsDiffSH, cbIsDiffSHTerm, 
								            cmbSHTermType.GetKey( SalListQuerySelection(cmbSHTermType)),
								            cmbSHType.GetKey( SalListQuerySelection(cmbSHType)),  
								            hSql, sError)
								
			Check Box: cbIsDiffSHTerm
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCheckBoxLabeled
				Property Template:
				Class DLL Name:
				Title: Срок штрафной ставки зависит от срока вклада
				Window Location and Size
					Left:   3.8"
					Top:    1.667"
					Width:  4.483"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SetWindowState(cbIsDiffSH, cbIsDiffSHTerm, 
								            cmbSHTermType.GetKey( SalListQuerySelection(cmbSHTermType)),
								            cmbSHType.GetKey( SalListQuerySelection(cmbSHType)),  
								            hSql, sError)
								
			Combo Box: cmbSHType
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.18"
					Top:    1.167"
					Width:  3.5"
					Width Editable? Class Default
					Height: 1.214"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
			Background Text: Срок штрафной ставки
				Resource Id: 2122
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.18"
					Top:    1.5"
					Width:  3.5"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: bgSHTermType
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Combo Box: cmbSHTermType
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.18"
					Top:    1.667"
					Width:  3.5"
					Width Editable? Class Default
					Height: 1.571"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Click
						Call SetWindowState(cbIsDiffSH, cbIsDiffSHTerm, 
								            cmbSHTermType.GetKey( SalListQuerySelection(cmbSHTermType)),
								            cmbSHType.GetKey( SalListQuerySelection(cmbSHType)),  
								            hSql, sError)
								
			Frame
				Resource Id: 39426
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   -0.017"
					Top:    -0.012"
					Width:  8.4"
					Width Editable? Yes
					Height: 0.917"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Child Table: tblSHPeriod
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    1.988"
						Width:  8.0"
						Width Editable? Yes
						Height: 1.75"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: colFrom
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: C
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.6"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colTo
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: По
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.583"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSHType
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Тип штрафа
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.067"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colValue
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Значение
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.967"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colnSHType
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colFromOld
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colToOld
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colValueOld
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSHTermType
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Тип cрока штрафа
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.817"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colnSHTermType
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colSHTermValue
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Значение
								срока штрафа
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.3"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_FetchRowDone
						Set colFromOld=colFrom
						Set colToOld=colTo
						Set colValueOld=colValue
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
						If tblSHPeriod.colSHTermType.Init(tblSHPeriod.colSHTermType)
							Call tblSHPeriod.colSHTermType.Populate(hSql, "ID", "NAME", "DPT_SHTERM"," ")
						If tblSHPeriod.colSHType.Init(tblSHPeriod.colSHType)
							Call tblSHPeriod.colSHType.Populate(hSql, "ID", "NAME", "DPT_SHTYPE"," ")
			Frame
				Resource Id: 39429
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   -0.017"
					Top:    0.905"
					Width:  8.4"
					Width Editable? Yes
					Height: 2.917"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Option Button: obIsDiffSH_Help
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.883"
					Top:    0.988"
					Width:  0.433"
					Width Editable? Yes
					Height: 0.31"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: \BARS98\RESOURCE\BMP\HELP.BMP
				Picture Transparent Color: None
				Button Style: Radio
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
			Option Button: obIsDiffSHTerm_Help
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.85"
					Top:    1.345"
					Width:  0.433"
					Width Editable? Yes
					Height: 0.31"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: \BARS98\RESOURCE\BMP\HELP.BMP
				Picture Transparent Color: None
				Button Style: Radio
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
			Check Box: cbCruelShtraf
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCheckBoxLabeled
				Property Template:
				Class DLL Name:
				Title: Если вклад не "вылежал" полный месяц - проценты не выплачиваются
				Window Location and Size
					Left:   0.18"
					Top:    0.571"
					Width:  7.1"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
		Functions
			Function: SetWindowState
				Description: Вызывается для установки параметров окна
				Returns
				Parameters
					Number: nSHType ! 1 -Разные периоды - разный тип штрафа
							                ! 0- Разные периоды - один тип штрафа
					Number: nSHTermType ! 1 -Разные периоды - разный срок штрафа
							                    ! 0- Разные периоды - один срок штрафа
					Number: nShTerm_Id_Selected  ! номер типа срока штрафа
					Number: nSh_Id_Selected      ! номер типа штрафа
					Sql Handle: hSql
					String: sErrMsg
				Static Variables
				Local variables
					String: sSql
					Number: nRow
					!
				Actions
					! Установка значения  выпадающего меню - тип остатка
					Call cmbOstType.SetSelectById(nOstType_Orig)
					!
					! Установка значения  выпадающего меню - тип срока
					Call cmbSrokType.SetSelectById(nSrokType_Orig)
					!
					! Установка значения выпадающего меню - тип штрафа
							! и таблицы значений
					If nSHType =0 
						Call SalEnableWindow(cmbSHType)
						Call SalDisableWindow(tblSHPeriod.colSHType)
						Call SalHideWindow(tblSHPeriod.colSHType)
						Call cmbSHType.SetSelectById(nSh_Id_Selected)
					Else
						Call SalDisableWindow(cmbSHType)
						Call SalEnableWindow(tblSHPeriod.colSHType)
						Call SalShowWindow(tblSHPeriod.colSHType)
						Call SalSetWindowText(cmbSHType, "")
					!
					! Установка значения  выпадающего меню - тип срока штрафа
							! и таблицы значений
					If nSHTermType=0
						Call SalEnableWindow(cmbSHTermType)
						Call SalHideWindow(tblSHPeriod.colSHTermType)
						Call SalHideWindow(tblSHPeriod.colSHTermValue)
						Call cmbSHTermType.SetSelectById(nShTerm_Id_Selected)
						! Если период штрафа расчитывается из "срока штрафа", значит
								  нужно показать еще и поле значения срока, например 20 дней
						If nShTerm_Id_Selected=2 
							Call SalShowWindow(tblSHPeriod.colSHTermValue)
					Else
						Call SalDisableWindow(cmbSHTermType)
						Call SalShowWindow(tblSHPeriod.colSHTermType)
						Call SalShowWindow(tblSHPeriod.colSHTermValue)
						Call SalSetWindowText(cmbSHTermType, "")
					!
					! Население таблицы значений
					Set sSql="SELECT a.k_srok asr, b.k_srok bsr, a.k_proc, a.sh_proc, a.k_term, a.sh_term
							     INTO :tblSHPeriod.colFrom,  :tblSHPeriod.colTo,
							          :tblSHPeriod.colValue, :tblSHPeriod.colnSHType,
							          :tblSHPeriod.colSHTermValue, :tblSHPeriod.colnSHTermType
							     FROM dpt_stop_a a, dpt_stop_a b
							     WHERE a.id=:nFineId AND b.id=:nFineId
							           AND a.k_srok<b.k_srok
								   AND b.K_SROK = (SELECT MIN(c.k_srok) FROM dpt_stop_a c
							                           WHERE c.k_srok>a.k_srok AND id=:nFineId)
							     ORDER BY a.k_srok  "
					Call SalTblPopulate ( tblSHPeriod, hSql, sSql, TBL_FillAll )
					Set nRow=TBL_MinRow
					While SalTblFindNextRow ( tblSHPeriod, nRow, 0, 0 )
						Call SalTblSetContext( tblSHPeriod, nRow )
						If nSHType=1
							Call tblSHPeriod.colSHType.SetSelectById(tblSHPeriod.colnSHType)
						If nSHTermType=1
							Call tblSHPeriod.colSHTermType.SetSelectById(tblSHPeriod.colnSHTermType)
					!
			Function: UpdateFineParams
				Description:
				Returns
					Number:
				Parameters
					Number: nFineId ! номер штрафа (1-22 ...)
					Sql Handle: hSql
					Receive String: sError
				Static Variables
				Local variables
					Number: nRow
					Number: nTo
					Number: nRowCount
					Boolean: bEdited
					!
					Number: nShTerm_Val_Selected ! новое выбранное значение срока штрафа (20 дней ....)
					Number: nShTerm_Id_Selected  ! новый выбранный номер типа срока штрафа (1-2)
					Number: nSh_Id_Selected      ! новый выбранный номер типа штрафа (1-4)
					Number: nSh_Val_Selected     ! новое значение штрафа (20 .. )
					Number: nSHType       ! 1 -Разные периоды - разный тип штрафа
							                      ! 0- Разные периоды - один тип штрафа
					Number: nSHTermType   ! 1 -Разные периоды - разный тип срока штрафа
							                      ! 0- Разные периоды - один тип срока штрафа
					Number: nSelected
				Actions
					Set sError=STRING_Null
					! По срокам
					Set nSelected=cmbSrokType.GetKey( SalListQuerySelection(cmbSrokType))
					If nSrokType_Orig!=nSelected
						If not SqlPrepareAndExecute(hSql, "UPDATE dpt_stop SET fl=:nSelected 
								                                   WHERE id=:nFineId")
							! Невозможно сделать обновления для поля срока
							Set sError=CurrentLangTable.GetAtomTitle('frm_ShtrafDetails.cTErrSrok')
							Return -1
					! По остаткам
					Set nSelected=cmbOstType.GetKey( SalListQuerySelection(cmbOstType))
					If nOstType_Orig!=nSelected
						If not SqlPrepareAndExecute(hSql, 
								    "UPDATE dpt_stop SET sh_ost=:nSelected WHERE id=:nFineId")
							! Невозможно сделать обновления для поля остатка
							Set sError=CurrentLangTable.GetAtomTitle('frm_ShtrafDetails.cTErrOst')
							Return -2
					! По штрафу до 1 мес
					If not SqlPrepareAndExecute(hSql, 
							    "UPDATE dpt_stop SET sh_proc=:cbCruelShtraf WHERE id=:nFineId")
						! Невозможно сделать обновления для поля sh_proc
						Set sError=CurrentLangTable.GetAtomTitle('frm_ShtrafDetails.cTErrUpdate')
						Return -3
					!
					! В разные периоды срока - разные ли тип штрафа или тип срока штрафа?
					Set nSHType=IifN(cbIsDiffSH,1,0)
					Set nSHTermType=IifN(cbIsDiffSHTerm,1,0)
					!
					!
					! Есть ли измененные, добавленные удаленные
					Set bEdited=FALSE
					Set nRow=TBL_MinRow 
					While SalTblFindNextRow ( tblSHPeriod, nRow, 0,0 )
						If SalTblQueryRowFlags ( tblSHPeriod, nRow, ROW_Edited|ROW_New|ROW_MarkDeleted )
							Set bEdited=TRUE
							Break
					!
					! Если за все периоды - один тип штрафа - инициализируем его сдесь
							! (поскольку для всех строк таблицы со значениями он одинаков)
					Set nSh_Id_Selected=
							  IifN(nSHType, 0, cmbSHType.GetKey( SalListQuerySelection(cmbSHType)))
					!
					! Если за все периоды - один тип срока штрафа - инициализируем его сдесь
							! (поскольку для всех строк таблицы со значениями он одинаков) 
					Set nShTerm_Id_Selected=
							  IifN(nSHTermType, 0, cmbSHTermType.GetKey( SalListQuerySelection(cmbSHTermType)))
					Set nShTerm_Val_Selected=IifN(nShTerm_Id_Selected!=2, NUMBER_Null, 0)
					!
					! Если были какие-то изменения - удалим все значения из таблицы 
							! для этотго штрафа и добавим новые
					! (так выходит намного легше и быстрее, чем делать UPDATE)
					If bEdited
						Call SqlPrepareAndExecute(hSql, "DELETE FROM dpt_stop_a WHERE id=:nFineId")
						! добавим новые
						Set nRow=TBL_MinRow 
						Set nTo=0
						While SalTblFindNextRow ( tblSHPeriod, nRow, 0, ROW_MarkDeleted )
							Call SalTblSetContext( tblSHPeriod, nRow )
							If (tblSHPeriod.colFrom!=nTo)  
								! Неправильно указаны граничные значения в добавленных записях
								Set sError=CurrentLangTable.GetAtomTitle('frm_ShtrafDetails.cTErrPeriod1')
								Return -1
							If ( tblSHPeriod.colFrom >=tblSHPeriod.colTo) 
								! Неправильно указаны граничные значения для смежных периодов
								Set sError=CurrentLangTable.GetAtomTitle('frm_ShtrafDetails.cTErrPeriod2')
								Return -1
							!
							!
							! выбранный тип штрафа 
							If nSHType
								Set nSh_Id_Selected=tblSHPeriod.colSHType.GetKey( SalListQuerySelection(tblSHPeriod.colSHType))
							! Значение штрафа
							Set nSh_Val_Selected=tblSHPeriod.colValue
							! выбранный тип срока штрафа
							If nSHTermType
								Set nShTerm_Id_Selected=tblSHPeriod.colSHTermType.GetKey( SalListQuerySelection(tblSHPeriod.colSHTermType))
							! значение срока штрафа (только для пита 2 - "Период штрафа расчитывается исходя из "срока штрафа")
							If nShTerm_Id_Selected=2
								Set nShTerm_Val_Selected=tblSHPeriod.colSHTermValue
							!
							Call SqlPrepareAndExecute(hSql, 
									    "INSERT INTO dpt_stop_a(id, k_srok, k_proc, sh_proc, k_term, sh_term) 
									     VALUES (:nFineId, :tblSHPeriod.colFrom, :nSh_Val_Selected, 
									             :nSh_Id_Selected, :nShTerm_Val_Selected, :nShTerm_Id_Selected)  ")
							Set nTo=tblSHPeriod.colTo
						! добавить нужно последнюю границу
						Call SqlPrepareAndExecute(hSql, 
								    "INSERT INTO dpt_stop_a(id, k_srok, k_proc, sh_proc, k_term, sh_term) 
								     VALUES (:nFineId, :tblSHPeriod.colTo, 100, 0, NULL, 0 )"  )
								
					!
					! Если изменений никаких не было, но могли поменять тип штрафа или тип 
							! тип срока штрафа для всех сроков 
					Else
						If (nSHType=0)
							If not SqlPrepareAndExecute(hSql, 
									    "UPDATE dpt_stop_a SET sh_proc=:nSh_Id_Selected WHERE id=:nFineId")
								! Невозможно сделать обновления для поля типа штрафа
								Set sError=CurrentLangTable.GetAtomTitle('frm_ShtrafDetails.cTErrSHType')
								Return -1
						If (nSHTermType=0)
							If not SqlPrepareAndExecute(hSql, 
									    "UPDATE dpt_stop_a SET sh_term=:nShTerm_Id_Selected, k_term=decode(:nShTerm_Id_Selected, 2, k_term, NULL) 
									     WHERE id=:nFineId ")
								! Невозможно сделать обновления для поля типа срока штрафа
								Set sError=CurrentLangTable.GetAtomTitle('frm_ShtrafDetails.cTErrSHTermType')
								Return -1
			Function: RefreshFineParams
				Description: Вызывается при перечитке параметров из БД, инициализирует все переменные 
				Returns
				Parameters
					Sql Handle: hSql
					String: sErrMsg
				Static Variables
				Local variables
					String: sSql 
				Actions
					Set sSql=
							" SELECT fl, sh_ost, nvl(sh_proc,0)
							  INTO  :nSrokType_Orig, :nOstType_Orig, :cbCruelShtraf          
							  FROM dpt_stop WHERE id=:nFineId "
					If SqlPrepareAndExecute(hSql, sSql)
						While SqlFetchNext(hSql,nRow)
					!
					! Найдем кол-во сроков с разными типами штрафной ставки (nSh_Count)    
							! и кол-во сроков с разными сроками штрафной ставки  (nShTerm_Count ) 
					Set sSql= 
							   "SELECT sum(shproc_count), sum(shterm_count) 
							    INTO  :nSh_Count, :nShTerm_Count
							    FROM ( SELECT UNIQUE sh_proc, 1 shproc_count, 0 shterm_count 
							           FROM dpt_stop_a
							           WHERE id=:nFineId AND sh_proc<>0 
							           UNION ALL 
							           SELECT UNIQUE sh_term, 0 shproc_count, 1 shterm_count 
							           FROM dpt_stop_a
							           WHERE id=:nFineId AND sh_proc<>0 
							         ) "
					If SqlPrepareAndExecute(hSql, sSql)
						While SqlFetchNext(hSql,nRow)
					! Вытащим значения, если для всех периодов - 
							! одно значение типа штрафа или типа срока штрафа
					! В разный период - один тип штрафа  
					If nSh_Count=1
						! Вытащим значение (номер типа) для этого одного типа штрафа
						If SqlPrepareAndExecute(hSql,"
								    SELECT unique sh_proc INTO :nSh_Id FROM dpt_stop_a
								    WHERE id=:nFineId AND sh_proc<>0 ")  
							While SqlFetchNext(hSql,nRow)
					!
					! В разный период - один срок штрафа  
					If nShTerm_Count =1 
						! Вытащим значение (номер типа срока) для этотго одного типа срока штрафа
						If SqlPrepareAndExecute(hSql,"
								    SELECT unique sh_term INTO :nShTerm_Id FROM dpt_stop_a
								    WHERE id=:nFineId AND sh_proc<>0 ")  
							While SqlFetchNext(hSql,nRow)
					!
		Window Parameters
			Number: nPar
			Number: nFineId  ! номер штрафа
			Sql Handle: hSql
		Window Variables
			Number: nRow
			String: sWndText
			String: sError
			! для update-а
			!
			Number: nOstType_Orig  ! Тип вычисления остатка 
			Number: nSrokType_Orig ! Тип вычисления срока (мес. или %%)
			! Number: nCruelShtraf   ! Признак безжалостного штрафования при невылежавшем 1 месяц 
			!
			Number: nSh_Count     ! Кол-во сроков с разными типами штрафной ставки    
			Number: nShTerm_Count ! Кол-во сроков с разными сроками штрафной ставки 
			Number: nSh_Id        ! Номер типа штрафа (если для всех периодов он один )
			Number: nShTerm_Id    ! Номер типа срока штрафа (если для всех периодов он один )
			Number: nNewRow 
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_ShtrafDetails.cTWndTitle') || " - " || tbl_Shtraf.colName)
				Call SalTblSetColumnTitle(hWndForm.frm_ShtrafDetails.tblSHPeriod.colSHType,
						  CurrentLangTable.GetAtomTitle('frm_ShtrafDetails.tblSHPeriod.colSHType'))
				Call SalTblSetColumnTitle(hWndForm.frm_ShtrafDetails.tblSHPeriod.colSHTermType,
						  CurrentLangTable.GetAtomTitle('frm_ShtrafDetails.tblSHPeriod.colSHTermType'))
				Call PrepareWindowEx(hWndForm)
				!
				! =====================================================
				! Set cbAddConditions = 0
				! Call SalHideWindow( tblAddConditions )
				Call SalSetWindowSize(frm_ShtrafDetails, 9, 5.3)
			On SAM_CreateComplete
				!
				! Инициализация выпадающего меню - тип остатка
				Call cmbOstType.Init(cmbOstType)
				Call cmbOstType.Populate(hSql, "ID", "NAME", "DPT_SHOST"," ")
				Call cmbOstType.SetSelectById(tbl_Shtraf.colnOstType)
				!
				! Инициализация выпадающего меню - тип срока
				Call cmbSrokType.Init(cmbSrokType)
				Call cmbSrokType.Populate(hSql, "ID", "NAME", "DPT_SHSROK"," ")
				Call cmbSrokType.SetSelectById(tbl_Shtraf.colnPeriodType)
				!
				! Инициализация выпадающего меню - тип штрафа
				Call cmbSHType.Init(cmbSHType)
				Call cmbSHType.Populate(hSql, "ID", "NAME", "DPT_SHTYPE"," ")
				Call cmbSHType.SetSelectById(nSh_Id)
				!
				! Инициализация выпадающего меню - тип срока штрафа
				Call cmbSHTermType.Init(cmbSHTermType)
				Call cmbSHTermType.Populate(hSql, "ID", "NAME", "DPT_SHTERM"," ")
				Call cmbSHTermType.SetSelectById(nShTerm_Id)
				!
				! Вычитка всех значений для штрафа nFineId
				Call RefreshFineParams(hSql,sError)
				!
				Set cbIsDiffSH =IifN(nSh_Count>1, 1, 0 )
				Set cbIsDiffSHTerm=IifN(nShTerm_Count>1, 1, 0 )
				!
				! Установить вид окна в зависимости от значений cbIsDiffSHTerm и  cbIsDiffSH
				Call SetWindowState(cbIsDiffSH, cbIsDiffSHTerm, nShTerm_Id, nSh_Id,  hSql, sError)
	Table Window: tbl_Shtraf
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Настройка видов штрафов
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.275"
				Top:    0.229"
				Width:  13.35"
				Width Editable? Class Default
				Height: 6.167"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description: Виды штрафов
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 44313
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If not IsWindow(hWinShDetails)
								Set hWinShDetails = SalCreateWindow(frm_ShtrafDetails, hWndMDI, 0, tbl_Shtraf.colId, hSql)
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 44314
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 44315
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbVERSION
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbHelp
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.7"
						Top:    0.083"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call get_LibraryVersion()
		Contents
			Column: colId
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_StrId
				Property Template:
				Class DLL Name:
				Title: № штрафа
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Наименование штрафа
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 50
				Data Type: String
				Justify: Left
				Width:  4.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colnPeriodType
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colnOstType
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colcmbPeriodType
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_NumId
				Property Template:
				Class DLL Name:
				Title: Период задан 
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  1.8"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_FieldEdit
						Set colnPeriodType = colcmbPeriodType.GetKey(SalListQuerySelection(colcmbPeriodType))
			Column: colcmbOstType
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_NumId
				Property Template:
				Class DLL Name:
				Title: Тип вычисления остатка
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  2.483"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_FieldEdit
						Set colnOstType = colcmbOstType.GetKey( SalListQuerySelection(colcmbOstType))
			Column: colModCode
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						модуля
				Visible? Class Default
				Editable? No
				Maximum Data Length: 3
				Data Type: Class Default
				Justify: Center
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
		Functions
		Window Parameters
			! 0 - тільки перегляд / 1 - редагування
			Number: nEdit
			String: sModCode
		Window Variables
			: cConn
				Class: cABSConnect
			Sql Handle: hSql
			Number: nRow
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tbl_Shtraf.cTWndTitle'))
				Call SalTblSetColumnTitle(hWndForm.tbl_Shtraf.colId,
						  CurrentLangTable.GetAtomTitle('tbl_Shtraf.colId'))
				Call SalTblSetColumnTitle(hWndForm.tbl_Shtraf.colcmbPeriodType,
						  CurrentLangTable.GetAtomTitle('tbl_Shtraf.colcmbPeriodType'))
				Call SalTblSetColumnTitle(hWndForm.tbl_Shtraf.colcmbOstType,
						  CurrentLangTable.GetAtomTitle('tbl_Shtraf.colcmbOstType'))
				Call PrepareWindowEx(hWndForm)
				Call XConnectGetParams(cConn)
				If NOT cConn.Connect()
					Return FALSE
				Set hSql = cConn.hSql()
				!
				Set tbl_Shtraf.strPrintFileName = 'DPT_STOP'
				Set tbl_Shtraf.strFilterTblName = 'DPT_STOP'
				Set tbl_Shtraf.fFilterAtStart = FALSE
				!
				If nEdit = 0
					Call SalDisableWindow( pbIns )
					Call SalDisableWindow( pbDel )
					Call SalDisableWindow( pbUpdate )
				If ( sModCode = "" OR sModCode = STRING_Null )
					Call SalTblSetColumnFlags ( colModCode, COL_Editable, TRUE )
				!
				Set tbl_Shtraf.strSqlPopulate =
						"SELECT dpt_stop.id, dpt_stop.name, dpt_stop.mod_code, d3.id, d2.id
						        INTO :tbl_Shtraf.colId, :tbl_Shtraf.colName, :tbl_Shtraf.colModCode, 
						                    :tbl_Shtraf.colnPeriodType, :tbl_Shtraf.colnOstType 
						      FROM dpt_stop, dpt_shost d2, dpt_shsrok d3
						  WHERE (dpt_stop.MOD_CODE = NVL(:tbl_Shtraf.sModCode, dpt_stop.MOD_CODE) OR dpt_stop.MOD_CODE IS NULL)
						         AND dpt_stop.sh_ost = d2.id(+) 
						         AND dpt_stop.fl = d3.id(+)
						  ORDER BY dpt_stop.id"
				!
				Set tbl_Shtraf.strSqlDelete = 
						"DELETE FROM dpt_stop WHERE id = :tbl_Shtraf.colId"
				!
				Set tbl_Shtraf.strSqlUpdate =
						"UPDATE dpt_stop
						           SET name = :tbl_Shtraf.colName, 
						                     fl = :tbl_Shtraf.colnPeriodType,
						                     sh_ost = :tbl_Shtraf.colnOstType,
						                     mod_code = :tbl_Shtraf.colModCode
						   WHERE id = :tbl_Shtraf.colId "
				!
				Set tbl_Shtraf.strSqlInsert =
						"INSERT INTO dpt_stop 
						      ( id, name, fl, sh_ost, mod_code )
						  VALUES 
						      ( s_dpt_stop_id.nextval, :tbl_Shtraf.colName, :tbl_Shtraf.colnPeriodType, :tbl_Shtraf.colnOstType, :tbl_Shtraf.sModCode )"
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
				!
				Call colcmbPeriodType.Init(colcmbPeriodType)
				Call colcmbPeriodType.Populate(hSql, "ID", "NAME", "DPT_SHSROK", " ")
				Call colcmbOstType.Init(colcmbOstType)
				Call colcmbOstType.Populate(hSql, "ID", "NAME", "DPT_SHOST", " ")
			On SAM_DoubleClick
				If not IsWindow(hWinShDetails)
					Set hWinShDetails = SalCreateWindow(frm_ShtrafDetails, hWndMDI, 0, tbl_Shtraf.colId, hSql)
			On SAM_FetchRowDone
				Call colcmbOstType.SetSelectById(colnOstType)
				Call colcmbPeriodType.SetSelectById(colnPeriodType)
	! Dialog Box: dlg_CorrectDates
.winattr
		Class:
		Property Template:
		Class DLL Name:
		Title: Коррекция срока вклада
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  5.0"
				Width Editable? Yes
				Height: 3.298"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
.end
		                                                                                                                                      Description: Коррекция срока вклада
		                                                                                                                                      Tool Bar 
			                                                                                                                                      Contents 
		                                                                                                                                      Contents 
			                                                                                                                                      Background Text: Задайте параметры
			                                                                                                                                      Data Field: bgParams
				                                                                                                                                      Message Actions 
			                                                                                                                                      Background Text: № вклада:
			                                                                                                                                      Data Field: bgDPT_ID
				                                                                                                                                      Message Actions 
			                                                                                                                                      Data Field: dfDPT_ID
				                                                                                                                                      Message Actions 
			                                                                                                                                      Background Text: Дата начала:
			                                                                                                                                      Data Field: bgDAT_BEGIN
				                                                                                                                                      Message Actions 
			                                                                                                                                      Data Field: dfDAT_BEGIN
				                                                                                                                                      Message Actions 
			                                                                                                                                      Background Text: Дата окончания:
			                                                                                                                                      Data Field: bgDAT_END
				                                                                                                                                      Message Actions 
			                                                                                                                                      Data Field: dfDAT_END
				                                                                                                                                      Message Actions 
			                                                                                                                                      Background Text: Укажите новый срок вклада
			                                                                                                                                      Data Field: bgDAT
				                                                                                                                                      Message Actions 
			                                                                                                                                      Data Field: dfDAT1
				                                                                                                                                      Message Actions 
			                                                                                                                                      Background Text: -
			                                                                                                                                      Data Field: dfDAT2
				                                                                                                                                      Message Actions 
					                                                                                                                                      On SAM_Validate
						                                                                                                                                      Set dSTOP = dfDAT2-1
			                                                                                                                                      Pushbutton: pbLook
				                                                                                                                                      Message Actions 
					                                                                                                                                      On SAM_Click
						                                                                                                                                      Call F_Check()
			                                                                                                                                      Pushbutton: pbOk
				                                                                                                                                      Message Actions 
					                                                                                                                                      On SAM_Click
						                                                                                                                                      If dfDAT1 = DATETIME_Null 
								OR dfDAT2 = DATETIME_Null 
								OR dfDAT1 >= dfDAT2
							                                                                                                                                      Call SalMessageBox(
									     "Неверно указан новый период вклада!", 
									     "Ошибка!", 
									     MB_IconStop)
						                                                                                                                                      Else 
							                                                                                                                                      Call F_Correct()
			                                                                                                                                      Pushbutton: pbCancel
				                                                                                                                                      Message Actions 
					                                                                                                                                      On SAM_Click
						                                                                                                                                      Call SalEndDialog(dlg_CorrectDates, FALSE)
			                                                                                                                                      Picture: pic1
				                                                                                                                                      Message Actions 
			                                                                                                                                      Picture: pic2
				                                                                                                                                      Message Actions 
		                                                                                                                                      Functions 
			                                                                                                                                      Function: F_Check
				                                                                                                                                      Description: 
				                                                                                                                                      Returns 
				                                                                                                                                      Parameters 
				                                                                                                                                      Static Variables 
				                                                                                                                                      Local variables 
				                                                                                                                                      Actions 
					                                                                                                                                      If dfDPT_ID    != NUMBER_Null   AND 
							   dfDAT_BEGIN != DATETIME_Null AND 
							   dfDAT_END   != DATETIME_Null
						                                                                                                                                      Call SqlPrepareAndExecute(hSql(), 
								    "SELECT d.deposit_id, d.acc, i.acra, 
								            decode(b.nbs,v.deposit_cod,i.acrb,null) 
								       INTO :dfDPT_ID, :nACC, :nACCN, :nACCA
								       FROM dpt_deposit d, accounts a, int_accn i, dpt_vidd v, accounts b
								      WHERE d.deposit_id = :dfDPT_ID   
								        AND d.acc = a.acc     
								        AND i.id = 1
								        AND a.acc = i.acc
								        AND v.vidd = d.vidd 
								        AND i.acrb = b.acc
								        AND d.dat_begin = :dfDAT_BEGIN 
								        AND d.dat_end = :dfDAT_END" )
						                                                                                                                                      If not SqlFetchNext(hSql(), nFetchRes)
							                                                                                                                                      Call SalMessageBox("Вклад не найден!", "Ошибка!", MB_IconStop)
							                                                                                                                                      Set dfDPT_ID = NUMBER_Null
							                                                                                                                                      Set dfDAT_BEGIN = DATETIME_Null
							                                                                                                                                      Set dfDAT_END = DATETIME_Null
							                                                                                                                                      Call SalSetFocus(pbCancel)
						                                                                                                                                      Else 
							                                                                                                                                      Call SalEnableWindow(dfDAT1)
							                                                                                                                                      Call SalEnableWindow(dfDAT2)
							                                                                                                                                      Call SalEnableWindow(pbOk)
							                                                                                                                                      Call SalSetFocus(dfDAT1)
					                                                                                                                                      Else 
						                                                                                                                                      Call SalMessageBox("Не указаны параметры вклада!", "Ошибка!", MB_IconStop)
			                                                                                                                                      Function: F_Correct
				                                                                                                                                      Description: 
				                                                                                                                                      Returns 
				                                                                                                                                      Parameters 
				                                                                                                                                      Static Variables 
				                                                                                                                                      Local variables 
				                                                                                                                                      Actions 
					                                                                                                                                      If dfDAT2 >  dfDAT1        AND 
							   dfDAT1 != DATETIME_Null AND 
							   dfDAT2 != DATETIME_Null AND
							 (SqlPrepareAndExecute(hSql(),
							    "UPDATE dpt_deposit SET dat_begin = :dfDAT1, dat_end = :dfDAT2 WHERE deposit_id = :dfDPT_ID") AND
							  SqlPrepareAndExecute(hSql(),
							    "UPDATE dpt_deposit_clos SET dat_begin = :dfDAT1, dat_end = :dfDAT2 WHERE deposit_id = :dfDPT_ID") AND
							  SqlPrepareAndExecute(hSql(),
							    "UPDATE accounts SET mdate = :dfDAT2 WHERE acc = :nACC") AND
							  SqlPrepareAndExecute(hSql(),
							    "UPDATE accounts SET mdate = :dfDAT2 WHERE acc = :nACCN") AND
							  SqlPrepareAndExecute(hSql(),
							    "UPDATE accounts SET mdate = :dfDAT2 WHERE acc = :nACCA") AND
							  SqlPrepareAndExecute(hSql(),
							    "UPDATE int_accn SET stp_dat = :dSTOP WHERE id = 1 AND acc = :nACC") AND
							  SqlPrepareAndExecute(hSql(),
							    "UPDATE int_ratn SET bdat = :dfDAT1 WHERE id = 1 AND acc = :nACC AND bdat = :dfDAT_BEGIN") AND
							  SqlPrepareAndExecute(hSql(),
							    "UPDATE int_ratn SET bdat = :dfDAT2 WHERE id = 1 AND acc = :nACC AND bdat = :dfDAT_END") AND
							  SqlPrepareAndExecute(hSql(),
							    "UPDATE int_accn SET acr_dat = :dfDAT1, stp_dat = :dfDAT2 WHERE id = 0 AND acc = :nACCA"))      
						                                                                                                                                      Call SalMessageBox("Изменение успешно выполнено!", "Поздравляем!", MB_IconExclamation)
						                                                                                                                                      Call SqlCommitEx(hSql(), 'Изменен срок вклада №'||SalNumberToStrX(dfDPT_ID,0))
					                                                                                                                                      Else 
						                                                                                                                                      Call SalMessageBox("Невозможно сохранить новый период вклада!", "Ошибка!", MB_IconStop)
					                                                                                                                                      Call SalSetFocus(pbCancel)
		                                                                                                                                      Window Parameters 
			                                                                                                                                      Number: nPar
		                                                                                                                                      Window Variables 
			                                                                                                                                      Number: nFetchRes
			                                                                                                                                      Number: nACC
			                                                                                                                                      Number: nACCN
			                                                                                                                                      Number: nACCA
			                                                                                                                                      Date/Time: dSTOP
		                                                                                                                                      Message Actions 
			                                                                                                                                      On SAM_Create
				                                                                                                                                      Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				                                                                                                                                      Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_CorrectDates.cTWndTitle'))
				                                                                                                                                      Call PrepareWindowEx(hWndForm)
				                                                                                                                                      Call SalSetFocus(dfDPT_ID)
				                                                                                                                                      Call SalDisableWindow(dfDAT1)
				                                                                                                                                      Call SalDisableWindow(dfDAT2)
				                                                                                                                                      Call SalDisableWindow(pbOk)
			                                                                                                                                      On SAM_Close
				                                                                                                                                      Call SalEndDialog(dlg_CorrectDates, FALSE)
	Dialog Box: dlg_CorrectDates
		Class:
		Property Template:
		Class DLL Name:
		Title: Коррекция срока вклада
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  5.0"
				Width Editable? Yes
				Height: 3.667"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Коррекция срока вклада
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: Задайте параметры
				Resource Id: 26467
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.4"
					Top:    0.1"
					Width:  3.117"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: bgParams
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Background Text: № вклада:
				Resource Id: 26468
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.4"
					Top:    0.429"
					Width:  2.5"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: bgDPT_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfDPT_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.0"
						Top:    0.405"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: MS Sans Serif
					Font Size: 8
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Дата начала:
				Resource Id: 26469
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.4"
					Top:    0.679"
					Width:  2.5"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: bgDAT_BEGIN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfDAT_BEGIN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.0"
						Top:    0.655"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: MS Sans Serif
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Дата окончания:
				Resource Id: 26470
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.4"
					Top:    0.929"
					Width:  2.5"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: MS Sans Serif
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: bgDAT_END
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfDAT_END
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.0"
						Top:    0.905"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: MS Sans Serif
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Укажите новый срок вклада
				Resource Id: 26471
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.4"
					Top:    1.4"
					Width:  3.783"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: bgDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfDAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.6"
						Top:    1.738"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: MS Sans Serif
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: -
				Resource Id: 26472
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.2"
					Top:    1.762"
					Width:  0.5"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfDAT2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.0"
						Top:    1.738"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: MS Sans Serif
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Кол-во пролонгаций:
				Resource Id: 26473
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    2.262"
					Width:  2.65"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: MS Sans Serif
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: bgCNTDUBL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfCNTDUBL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.0"
						Top:    2.226"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If dfCNTDUBL <= 0 
							Return VALIDATE_Cancel
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledOk
				Property Template:
				Class DLL Name:
				Title: Выполнить
				Window Location and Size
					Left:   0.65"
					Top:    2.721"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call F_CorrectDepositTerm()
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   3.05"
					Top:    2.721"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(dlg_CorrectDates, FALSE)
			Picture: pic1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.15"
					Top:    0.2"
					Width:  4.45"
					Width Editable? Yes
					Height: 1.1"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
				Message Actions
			Picture: pic2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.133"
					Top:    1.476"
					Width:  4.45"
					Width Editable? Yes
					Height: 0.631"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
				Message Actions
			Frame
				Resource Id: 26474
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.133"
					Top:    2.095"
					Width:  4.45"
					Width Editable? Yes
					Height: 0.476"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
		Functions
			Function: F_CorrectDepositTerm
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sMsg
				Actions
					If SqlPLSQLCommand(hSql(), 
							   "dpt.correct_deposit_term (dfDPT_ID, dfDAT_BEGIN, dfDAT_END, dfDAT1, dfDAT2, dfCNTDUBL)")
						Set sMsg = CurrentLangTable.GetAtomTitle('dlg_CorrectDates.cTDone')||" "||SalNumberToStrX(dfDPT_ID, 0)
						Call SqlCommitEx(hSql(), sMsg)
						Call SalMessageBox(sMsg, CurrentLangTable.GetAtomTitle('cTInfo'), MB_IconExclamation)
					Else
						Call SqlRollback(hSql())
					Set dfDPT_ID = NUMBER_Null
					Set dfDAT_BEGIN = DATETIME_Null
					Set dfDAT_END = DATETIME_Null
					Set dfDAT1 = DATETIME_Null
					Set dfDAT2 = DATETIME_Null
					Set dfCNTDUBL = NUMBER_Null
					Call SalSetFocus(pbCancel)
		Window Parameters
			Number: nPar
		Window Variables
			Number: nFetchRes
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_CorrectDates.cTWndTitle'))
				Call PrepareWindowEx(hWndForm)
				Call SalSetFocus(dfDPT_ID)
			On SAM_Close
				Call SalEndDialog(dlg_CorrectDates, FALSE)
	Table Window: FG
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Формирование базы для Фонда гарантирования вкладов
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  19.317"
				Width Editable? Class Default
				Height: 6.821"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalTblReset( hWndForm )
							Set nRecCount = 0
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 49939
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.45"
						Begin Y:  Class Default
						End X:  5.45"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\FILTER.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Pushbutton: pbBank
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbBrowse
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.475"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\TODISK.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Наполнить таблицу данными по Банку
							Set strTip = CurrentLangTable.GetAtomTitle('FG.cBTipBank')
						On SAM_Click
							Call SalTblReset( hWndForm )
							Set nRecCount = 0
							Call SalWaitCursor( TRUE )
							If FongGar (dDat)
								Call SalTblPopulate( hWndForm, hSql(), sSqlB, TBL_FillAll)
							Call SalWaitCursor( FALSE )
				Pushbutton: pbFilial
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\FROMDISK.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Наполнить таблицу данными по Филиалам (VKLAD_FG.DBF)
							Set strTip = CurrentLangTable.GetAtomTitle('FG.cBTipFilial') || " (VKLAD_FG.DBF)"
						On SAM_Click
							Call SalDlgOpenFile ( hWndForm, 'Выбрать файл...', strFilters, 2, nIndex, strFileIn, strPathIn )
							If SalStrUpperX(strFileIn) != 'VKLAD_FG.DBF'
								! Неверное имя файла
								Call SalMessageBox(CurrentLangTable.GetAtomTitle('FG.cTErrFileName'), 
										     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop )
							Else
								Set SqlDatabase = 'dBase_Files'
								If SqlConnect(hSqlA)
									Call SalWaitCursor( TRUE )
									If SqlPrepareAndExecute( hSql(), "DELETE FROM vklad_fg" )
										If SqlPrepareAndExecute( hSqlA,
												  "SELECT dat, mfo, fio, okpo, obl, dst, town, adr,
												                  pasp_sn, organ, pdate, datz, nd, ost, ostn, nls, kv, gar  
												        INTO :Dat, :Mfo, :Fio, :Okpo, :Obl, :Dst, :Town, :Adr,
												                 :Pasp_sn, :Organ, :Pdate, :Datz, :Nd, :Ost, :Ostn, :Nls, :Kv, :Gar
												     FROM " || Left(strFileIn, Len(strFileIn)-4))
										While SqlFetchNext( hSqlA, nFetchRes )
											If SqlPrepareAndExecute( hSql(), 
													   "INSERT INTO vklad_fg 
													      (dat, mfo, fio, okpo, obl, dst, town, adr,    
													       pasp_sn, organ, pdate, datz, nd, ost, ostn, nls, kv, gar)
													    VALUES 
													      (:Dat, :Mfo, :Fio, :Okpo, :Obl, :Dst, :Town, :Adr,
													       :Pasp_sn,  :Datz, :Nd, :Ost, :Ostn, :Nls, :Kv, :Gar)")
										Call SqlCommit( hSql() )
									Call SqlDisconnect(hSqlA)
									!
									Call SalTblPopulate( hWndForm, hSql(), 
											     sSqlF ||
											    " INTO :FG.MFO,:FG.FIO,:FG.OKPO, :FG.OBL,:FG.DST,:FG.TOWN,:FG.ADR,
											                :FG.PASP_SN, :FG.ORGAN, :FG_PDATE, :FG.DATZ, :FG.ND,
											                :FG.OST,:FG.OSTN, :FG.NLS,:FG.GAR ", TBL_FillAll )
									Call SalWaitCursor( FALSE )
								Else
									! Ошибка подсоединения к Базе данных
									Call MessageAttention(CurrentLangTable.GetAtomTitle('FG.cTErrConnect') || ' ' ||SqlDatabase)
				Pushbutton: pbAll
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.355"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\ATTACH.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Просмотр Консолидированного отчета"
							Set strTip = CurrentLangTable.GetAtomTitle('FG.cBTipAll')
						On SAM_Click
							! Возможно, не был принят файл VKLAD_FG.DBF. Продолжить?
							If SalMessageBox(CurrentLangTable.GetAtomTitle('FG.cTConsolidDone'), 
									                 CurrentLangTable.GetAtomTitle('FG.cTAttention'), 
									                 MB_IconQuestion|MB_YesNo) = IDYES
								Call SalTblReset( hWndForm )
								Set nRecCount = 0
								Call SalWaitCursor( TRUE )
								If FongGar (dDat)
									Call SalTblPopulate( hWndForm, hSql(), sSqlB|| " UNION ALL "||sSqlF||" ORDER BY 3, 9", TBL_FillAll)
								Call SalWaitCursor( FALSE )
				Pushbutton: pbReport
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSort
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.775"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\REP_JOIN.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Печать Консолидированного отчета
							Set strTip = CurrentLangTable.GetAtomTitle('FG.cBTipReport')
						On SAM_Click
							Set sFileName = GetPrnDir() || '\\' || FG.MFO || Subs(cmbDAT,1,2) || Subs(cmbDAT,4,2) || Subs(cmbDAT,7,2) || '.D'
							Call ExportCatQuery( nPar, sFileName, 3, ":sFdat1='" || SalFmtFormatDateTime( dDat, 'dd/MM/yyyy')|| "'", TRUE )
							If sFileName != STRING_Null
								Call DosDirectPrint( sFileName )
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.22"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set FG.strPrintFileName = 'FG'||Subs(cmbDAT,1,2)||Subs(cmbDAT,4,2)
							Call SalSendClassMessage( SAM_Click, 0, 0 )
				Line
					Resource Id: 49940
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.783"
						Begin Y:  Class Default
						End X:  4.783"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.917"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 49941
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Background Text: Дата формирования:
					Resource Id: 46423
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   6.0"
						Top:    0.095"
						Width:  2.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: MS Sans Serif
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: Default
				Data Field: bgDAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cLabelControl
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Class Default
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   Default
							Top:    Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Border? Class Default
						Justify: Class Default
						Format: Class Default
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
				Combo Box: cmbDAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   8.7"
						Top:    0.071"
						Width:  1.7"
						Width Editable? Yes
						Height: 1.345"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: Default
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Create
							If SqlPrepareAndExecute( hSql(),
									  "SELECT to_char(fdat,'dd-mm-yyyy') INTO :sTmp FROM fdat ORDER BY fdat DESC")
								While SqlFetchNext( hSql(), nFetchRes )
									Call SalListAdd( cmbDAT, sTmp )
								Call SalListSetSelect( hWndItem, 0 )
							Set dDat = SalStrToDate( FG.cmbDAT )
						On SAM_Click
							Set dDat = SalStrToDate( FG.cmbDAT )
							Call SalTblReset( hWndForm )
							Set nRecCount = 0
		Contents
			Column: NPP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: №
						п/п
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата
						формиров.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.05"
				Width Editable? Yes
				Format: dd/MM/yyyy
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MFO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: МФО
						банка
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  0.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FIO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: ФИО вкладчика
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OKPO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Идентиф.код
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  1.267"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OBL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Область
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DST
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Район
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TOWN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Населенный
						пункт
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ADR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Адрес
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PASP_SN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Серія і номер 
						документу
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  1.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ORGAN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ким виданий
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  1.55"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: PDATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата
						видачі
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.267"
				Width Editable? Class Default
				Format: dd/MM/yyyy
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: DATZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата
						договора
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.183"
				Width Editable? Yes
				Format: dd/MM/yyyy
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: №
						договора
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						вал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Остаток
						(коп)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.5"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Остаток
						начисл.%%
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.5"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Лицевой счет
				Visible? Yes
				Editable? No
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  1.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: GAR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Гарант.
						вкл.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: FongGar
				Description: Наполнение временной таблицы
				Returns
					Boolean:
				Parameters
					Date/Time: dDAT
				Static Variables
				Local variables
				Actions
					If not SqlPLSQLCommand(hSql(), "P_FOND_GAR(dDAT)")
						Return FALSE
					Return TRUE
		Window Parameters
			Number: nPar
			String: sPar01
			String: sPar02
		Window Variables
			Number: nFetchRes
			String: sTmp
			Date/Time: dDat
			Number: nRecCount
			!
			Sql Handle: hSqlA
			String: strFilters[*]
			Number: nIndex
			String: strFileIn
			String: strPathIn
			String: sFileName
			!
			String: sSqlB
			String: sSqlF
			!
			Date/Time: Dat
			String: Mfo
			String: Fio
			String: Okpo
			String: Obl
			String: Dst
			String: Town
			String: Adr
			String: Pasp_sn
			String: Organ
			Date/Time: Pdate
			Date/Time: Datz
			String: Nd
			Number: Ost
			Number: Ostn
			String: Nls
			Number: Kv
			Number: Gar
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('FG.cTWndTitle'))
				Call PrepareWindow(hWndForm)
				Set FG.nTabInstance = 1
				Set nRecCount = 0
				! Список файлов от филиалов
				Set strFilters[0]=CurrentLangTable.GetAtomTitle('FG.cTFiles')
				Set strFilters[1]='VKLAD_FG.DBF'
				Set FG.strPrintFileName = 'FG'||Subs(cmbDAT,1,2)||Subs(cmbDAT,4,2)
				!
				Call SalDisableWindow( pbIns )
				Call SalDisableWindow( pbDel )
				Call SalDisableWindow( pbUpdate )
				Call SalDisableWindow( pbFilter )
				!
				Call SalEnableWindow( pbBank )
				Call SalEnableWindow( pbFilial )
				Call SalEnableWindow( pbAll )
				Call SalEnableWindow( pbReport )
				!
				Set sSqlF =
						   "SELECT mfo, fio, okpo, obl, dst, town, adr,    
						                   pasp_sn, organ, pdate, datz, nd,
						                   gl.p_icurval(kv,ost,dat), gl.p_icurval(kv,ostn,dat), nls, gar  
						       FROM vklad_fg 
						    WHERE dat =:dDat"
				Set sSqlB =  
						   "SELECT substr(f_ourmfo,1,6), fio, okpo, obl, dst, town, adr,
						                   pasp_sn, organ, pdate, datz, nd,
						                   ost, ostn, nls, gar
						        INTO  :FG.MFO, :FG.FIO, :FG.OKPO, :FG.OBL,:FG.DST,:FG.TOWN,:FG.ADR,
						                   :FG.PASP_SN, :FG.ORGAN, :FG.PDATE, :FG.DATZ, :FG.ND,
						                   :FG.OST, :FG.OSTN, :FG.NLS, :FG.GAR
						        FROM tmp_fond_gar
						     WHERE dat =:dDat"
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				If SalIsNull( FG.DAT )
					Set FG.DAT = dDat
				Set nRecCount = nRecCount + 1
				Set NPP = nRecCount
	Dialog Box: dlg_Reason
		Class:
		Property Template:
		Class DLL Name:
		Title: Причина відхилення запиту
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  7.817"
				Width Editable? Yes
				Height: 1.595"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: Вкажіть причину відхилення запиту:
				Resource Id: 13389
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.15"
					Top:    0.143"
					Width:  5.967"
					Width Editable? Yes
					Height: 0.226"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: MS Sans Serif
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Teal
				Background Color: Default
			Data Field: bgREASON
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Multiline Field: mlREASON
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 100
					String Type: String
					Editable? Yes
				Display Settings
					Border? Yes
					Word Wrap? Yes
					Vertical Scroll? No
					Window Location and Size
						Left:   0.15"
						Top:    0.393"
						Width:  5.967"
						Width Editable? Yes
						Height: 0.655"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Teal
					Background Color: Default
				Message Actions
			Pushbutton: pbExit
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledCancel
				Property Template:
				Class DLL Name:
				Title: Вийти
				Window Location and Size
					Left:   6.3"
					Top:    0.464"
					Width:  1.2"
					Width Editable? Class Default
					Height: 0.5"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set sREASON = mlREASON
						Call SalEndDialog(hWndForm, TRUE)
		Functions
		Window Parameters
			Receive String: sREASON
		Window Variables
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_Reason.cTWndTitle'))
				Call PrepareWindowEx(hWndForm)
				Call SalSetFocus(mlREASON)
	Form Window: frm_ViddBonuses
		Class:
		Property Template:
		Class DLL Name:
		Title: Управление привязкой льгот к видам вкладов
		Icon File:
		Accesories Enabled? Yes
		Visible? No
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  11.75"
				Width Editable? Yes
				Height: 5.202"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.45"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Pushbutton: pbRefresh
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRefresh
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.1"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Перечитать данные
							Set strTip = CurrentLangTable.GetAtomTitle('frm_ViddBonuses.cBTipRefresh')
						On SAM_Click
							Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Pushbutton: pbFilter
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.55"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Установить фильтр
							Set strTip = CurrentLangTable.GetAtomTitle('frm_ViddBonuses.cBTipFilter')
						On SAM_Click
							Set bFilter = TRUE
							Call SalSendMsg(hCurrTable, UM_Populate, 0, 0)
				Pushbutton: pbEdit
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbEdit
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.0"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Параметры привязки
							Set strTip = CurrentLangTable.GetAtomTitle('frm_ViddBonuses.cBTipEdit')
						On SAM_Click
							If SalWindowHandleToNumber(hCurrTable) = SalWindowHandleToNumber(tblViddSel)
								If tblViddSel.colVId
									If setParams(nParEdit, tblViddSel.colVName, FALSE, nFl, 
											   tblViddSel.colActivity, tblViddSel.colFinally, tblViddSel.colRang, tblViddSel.colCondition)
										If setViddBonus(nBonusId, tblViddSel.colVId, tblViddSel.colRang, tblViddSel.colActivity, tblViddSel.colCondition, tblViddSel.colFinally)
											! DPT_BONUS. Установлены параметры привязки льготы nBonusId к виду договора colVId
											Call SqlCommitEx(hSql(), "DPT_BONUS. " || CurrentLangTable.GetAtomTitle('frm_ViddBonuses.cTSetParamsOk') || " " || Str(nBonusId) || " " ||
													     CurrentLangTable.GetAtomTitle('frm_ViddBonuses.cTSetParams') || " " || Str(tblViddSel.colVId))
										Else
											! DPT_BONUS. Неуспешная попытка установить параметры привязки льготы nBonusId к виду договора tblViddSel.colVId
											Call SqlRollbackEx(hSql(), "DPT_BONUS. " || CurrentLangTable.GetAtomTitle('frm_ViddBonuses.cTSetParamsNo') || " " || Str(nBonusId) || " " ||
													     CurrentLangTable.GetAtomTitle('frm_ViddBonuses.cTSetParams') || " " || Str(tblViddSel.colVId))
				Pushbutton: pbAdd
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.467"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Arr2tol.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Привязать
							Set strTip = CurrentLangTable.GetAtomTitle('frm_ViddBonuses.cBTipAdd')
						On SAM_Click
							If SalWindowHandleToNumber(hCurrTable) = SalWindowHandleToNumber(tblViddAll)
								Call SalSendMsg(tblViddAll, SAM_DoubleClick, 0, 0)
				Line
					Resource Id: 31344
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  2.017"
						Begin Y:  0.0"
						End X:  2.017"
						End Y:  0.5"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: Default
				Pushbutton: pbCancel
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbCancel
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.15"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Выйти
							Set strTip = CurrentLangTable.GetAtomTitle('frm_ViddBonuses.cBTipCancel')
						On SAM_Click
							Call SalDestroyWindow(hWndForm)
		Contents
			Data Field: dfBonus
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.4"
						Top:    0.2"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.202"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Default
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
			Combo Box: cmbBonuses
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   3.0"
					Top:    0.15"
					Width:  5.0"
					Width Editable? Class Default
					Height: 1.655"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						If Init(hWndItem)
							Call Populate(hSql(), "bonus_id", "bonus_name", "dpt_bonuses", "order by bonus_id")
							Call SalListSetSelect(hWndItem, 0)
					On UM_ObjActivate
						Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
					On SAM_Click
						Call SalSendClassMessage(SAM_Click, 0, 0)
						Set nBonusId = nCurrentId
						Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
			Child Table: tblViddSel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    0.6"
						Width:  4.683"
						Width Editable? Yes
						Height: 3.083"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 64000
					Discardable? Yes
				Contents
					Column: colVId		! №
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: №
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  0.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colVCode	! Симв.код
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Симв.
								код
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colVName	! Наименование вида договора
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Наименование
								вида договора
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  4.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colVActivity	! Активность вида договора
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Активность
								вида договора
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Center
						Width:  1.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Check Box
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colRang		! Ранг привязки
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Ранг
								привязки
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colFinally	! Признак окончания просмотра
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Признак
								окончания
								просмотра
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Center
						Width:  1.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Check Box
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colCondition	! Условие привязки
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Условие привязки
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Long String
						Justify: Class Default
						Width:  2.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colActivity	! Активность привязки
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Активность
								привязки
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Center
						Width:  1.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Check Box
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
					String: strSqlPopulate
					String: strDSql
					: cF
						Class: cGenFilter
					: cQ
						Class: cGenQuery
					Number: nRow
					Boolean: bApply
					Long String: lsTmp
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
						Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
						! Инициализация фильтра
						Call cF.Init('v_dpt_vidd_bonuses', 'v_dpt_vidd_bonuses')
						Set strSqlPopulate = 
								"select type_id, type_code, type_name, decode(type_activity,'Y',1,0),
								        rec_rang, decode(rec_finally,'Y',1,0), rec_condition, decode(rec_activity,'Y',1,2)
								  into :colVId, :colVCode, :colVName, :colVActivity,
								       :colRang, :colFinally, :colCondition, :colActivity
								  from v_dpt_vidd_bonuses
								 where bonus_id=:nBonusId and rec_rang is not null
								 order by type_id, bonus_id"
						Call cQ.Init(strSqlPopulate)
					On UM_Populate
						If bFilter
							Set bFilter = FALSE
							Call SetQueryFilter(cF)
							If cF.GetFilterWhereClause(TRUE)
								! 'Привязанные виды договоров (фильтр)' || ';'
								Call SalSetWindowText(cHLSpl, 
										     CurrentLangTable.GetAtomTitle('frm_ViddBonuses.cTViddSel') || " (" ||
										     CurrentLangTable.GetAtomTitle('frm_ViddBonuses.cTViddFolter') || ");")
							Else
								! 'Привязанные виды договоров' || ';'
								Call SalSetWindowText(cHLSpl, CurrentLangTable.GetAtomTitle('frm_ViddBonuses.cTViddSel') || ";")
						Set strDSql = cQ.GetFullSQLString(cF)
						Call SalTblPopulate(hWndForm, hSql(), strDSql, TBL_FillAll)
						Call VisTblAutoSizeColumn(hWndForm, colVCode)
						Call VisTblAutoSizeColumn(hWndForm, colVActivity)
						Call VisTblAutoSizeColumn(hWndForm, colRang)
						Call VisTblAutoSizeColumn(hWndForm, colFinally)
						Call VisTblAutoSizeColumn(hWndForm, colActivity)
					On SAM_FetchRowDone
						If not colActivity
							Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_LightGray)
					On SAM_SetFocus
						Set hCurrTable = hWndForm
			Child Table: tblViddAll
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   6.0"
						Top:    0.6"
						Width:  4.617"
						Width Editable? Yes
						Height: 2.917"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 64000
					Discardable? Yes
				Contents
					Column: colVId		! №
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: №
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  0.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colVCode	! Симв.код
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Симв.
								код
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colVName	! Наименование вида договора
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Наименование
								вида договора
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  4.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colVActivity	! Активность вида договора
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Признак
								активности
								вида договора
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  1.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Check Box
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
					String: strSqlPopulate
					String: strDSql
					: cF
						Class: cGenFilter
					: cQ
						Class: cGenQuery
					Number: nRow
					Boolean: bApply
					Number: nFlag
					Number: nCount
					Number: nActivity
					Number: nFinally
					Number: nRang
					Long String: lsCondition
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
						! Инициализация фильтра
						Call cF.Init('v_dpt_vidd_bonuses', 'v_dpt_vidd_bonuses')
						Set strSqlPopulate = 
								"select type_id, type_code, type_name, decode(type_activity,'Y',1,0)
								   into :colVId, :colVCode, :colVName, :colVActivity
								   from v_dpt_vidd_bonuses
								  where bonus_id=:nBonusId and rec_rang is null
								  order by type_id"
						Call cQ.Init(strSqlPopulate)
					On UM_Populate
						If bFilter
							Set bFilter = FALSE
							Call SetQueryFilter(cF)
							If cF.GetFilterWhereClause(TRUE)
								! 'Непривязанные виды договоров (фильтр)' || ';'
								Call SalSetWindowText(cHRSpl, 
										     CurrentLangTable.GetAtomTitle('frm_ViddBonuses.cTViddAll') || " (" ||
										     CurrentLangTable.GetAtomTitle('frm_ViddBonuses.cTViddFolter') || ");")
							Else
								! 'Непривязанные виды договоров' || ';'
								Call SalSetWindowText(cHRSpl, CurrentLangTable.GetAtomTitle('frm_ViddBonuses.cTViddAll') || ";")
						Set strDSql = cQ.GetFullSQLString(cF)
						Call SalTblPopulate(hWndForm, hSql(), strDSql, TBL_FillAll)
						Call VisTblAutoSizeColumn(hWndForm, colVCode)
						Call VisTblAutoSizeColumn(hWndForm, colVActivity)
					On SAM_DoubleClick
						Set nCount = 0
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
							Set nCount = nCount + 1
						Set bApply = FALSE
						Set nFlag  = 1
						Set nRang  = 0
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
							Call SalTblSetContext(hWndForm, nRow)
							If not nFlag
								Set bApply = FALSE
								Break
							Else If nFlag = 1
								Call SqlPrepareAndExecute(hSql(),
										"select max(nvl(rec_rang,0)) into :nRang from v_dpt_vidd_bonuses where type_id=:colVId")
								Call SqlFetchNext(hSql(), nFetchRes)
								Set nRang = nRang + 1
								If setParams(nParEdit, colVName, IifN(nCount>1, TRUE, FALSE), nFlag, nActivity, nFinally, nRang, lsCondition)
									If setViddBonus(nBonusId, colVId, nRang, nActivity, lsCondition, nFinally)
										Set bApply = TRUE
									Else
										Set bApply = FALSE
										Break
								Else
									Set bApply = FALSE
									Break
							Else If nFlag = 2
								If setViddBonus(nBonusId, colVId, nRang, nActivity, lsCondition, nFinally)
									Set bApply = TRUE
								Else
									Set bApply = FALSE
									Break
						If bApply
							! DPT_BONUS. Установлены параметры привязки льготы nBonusId к виду договора colVId
							Call SqlCommitEx(hSql(), "DPT_BONUS. " || CurrentLangTable.GetAtomTitle('frm_ViddBonuses.cTSetParamsOk') || " " || Str(nBonusId) || " " ||
									     CurrentLangTable.GetAtomTitle('frm_ViddBonuses.cTSetParams') || " " || Str(colVId))
						Else
							! DPT_BONUS. Неуспешная попытка установить параметры привязки льготы nBonusId к виду договора colVId
							Call SqlRollbackEx(hSql(), "DPT_BONUS. " || CurrentLangTable.GetAtomTitle('frm_ViddBonuses.cTSetParamsNo') || " " || Str(nBonusId) || " " ||
									     CurrentLangTable.GetAtomTitle('frm_ViddBonuses.cTSetParams') || " " || Str(colVId))
						Call SalSendMsg(tblViddSel, UM_Populate, 0, 0)
						Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
					On SAM_SetFocus
						Set hCurrTable = hWndForm
			Custom Control: cVSpl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitter
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    0.55"
						Width:  10.7"
						Width Editable? Class Default
						Height: 3.107"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cHLSpl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalHSplitter
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cHRSpl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalHSplitter
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
		Functions
			Function: setViddBonus
				Description:
				Returns
					Boolean:
				Parameters
					Number: p_bonusid
					Number: p_typeid
					Number: p_rang
					Number: p_activity
					Long String: p_condition
					Number: p_finally
				Static Variables
				Local variables
					Boolean: bReturn
					String: l_activity
					String: l_finally
				Actions
					Set bReturn = TRUE
					Set l_activity = IifS(p_activity=1, 'Y', 'N')
					Set l_finally  = IifS(p_finally=1, 'Y', 'N')
					If not SqlPLSQLCommand(hSql(), "dpt_bonus.manage_dptviddbonus(p_bonusid, p_typeid, p_rang, l_activity, p_condition, l_finally)")
						Set bReturn = FALSE
					Return bReturn
			Function: setParams
				Description:
				Returns
					Boolean:
				Parameters
					Number: nPar
					String: sVName
					Boolean: bPb
					Receive Number: p_flag
					Receive Number: p_activity
					Receive Number: p_finally
					Receive Number: p_rang
					Receive Long String: p_condition
				Static Variables
				Local variables
					Boolean: bReturn
					Number: nFlag
					Number: nActivity
					Number: nFinally
					Number: nRang
					Long String: lsCondition
				Actions
					Set bReturn = FALSE
					Set nFlag       = p_flag
					Set nActivity   = p_activity
					Set nFinally    = p_finally
					Set nRang       = p_rang
					Set lsCondition = p_condition
					If SalModalDialog(dlg_ViddBonus, hWndForm, nPar, sVName, bPb, nFlag, nActivity, nFinally, nRang, lsCondition)
						Set p_flag      = nFlag
						Set p_activity  = nActivity
						Set p_finally   = nFinally
						Set p_rang      = nRang
						Set p_condition = lsCondition
						Set bReturn = TRUE
					Return bReturn
		Window Parameters
			Number: nParEdit	! 1-Edit, 0-ReadOnly
			String: sPar1
			String: sPar2
		Window Variables
			Boolean: bFilter
			Number: nBonusId
			Number: nFl
			Window Handle: hCurrTable
			!
			Number: nWinX0
			Number: nWinY0
			Number: nWinWidth
			Number: nWinHeight
			Number: nX0
			Number: nY0
		Message Actions
			On SAM_Create
				! Управление привязкой льгот к видам вкладов
				! Просмотр привязок льгот к видам вкладов
				Call SalSetWindowText(hWndForm, IifS(nParEdit=1,
						     CurrentLangTable.GetAtomTitle('frm_ViddBonuses.cTWndTitle'),
						     CurrentLangTable.GetAtomTitle('frm_ViddBonuses.cTWndTitle0')))
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call PrepareWindowEx(hWndForm)
				Call SetWindowFullSize(hWndForm)
				! Set dfBonus = "Льгота"
				Set dfBonus = CurrentLangTable.GetAtomTitle('frm_ViddBonuses.bgBonus')
				Set bFilter = FALSE
				If not nParEdit
					Call SalDisableWindow(pbAdd)
				Call SalSetFocus(pbCancel)
				!
				Call cVSpl.setBarSize(5)
				Call cVSpl.setBarPosition(620)
				Call cVSpl.setLeftFrame(cHLSpl)
				Call cVSpl.setRightFrame(cHRSpl)
				! Call SalSetWindowText(cHLSpl, 'Привязанные виды договоров'||';')
				Call SalSetWindowText(cHLSpl, CurrentLangTable.GetAtomTitle('frm_ViddBonuses.cTViddSel') || ';')
				Call cHLSpl.setStyle(XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE)
				Call cHLSpl.setBarPosition(20)
				Call cHLSpl.setBottomFrame(tblViddSel)
				! Call SalSetWindowText(cHRSpl, 'Непривязанные виды договоров'||';')
				Call SalSetWindowText(cHRSpl, CurrentLangTable.GetAtomTitle('frm_ViddBonuses.cTViddAll') || ';')
				Call cHRSpl.setStyle(XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE)
				Call cHRSpl.setBarPosition(20)
				Call cHRSpl.setBottomFrame(tblViddAll)
			On SAM_CreateComplete
				Call SalSendMsg(cmbBonuses, UM_ObjActivate, 0, 0)
			On UM_Populate
				Call SalSendMsg(tblViddSel, UM_Populate, 0, 0)
				Call SalSendMsg(tblViddAll, UM_Populate, 0, 0)
			On WM_Size
				Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeight)
				Call SalSetWindowSize(hWndForm.frm_ViddBonuses.cVSpl,
						     SalPixelsToFormUnits(hWndForm.frm_ViddBonuses.cVSpl, nWinWidth, FALSE),
						     SalPixelsToFormUnits(hWndForm.frm_ViddBonuses.cVSpl, nWinHeight, TRUE)-0.55)
				Call SalGetWindowLoc(hWndForm.frm_ViddBonuses.cmbBonuses, nX0, nY0)
				Call SalSetWindowLoc(hWndForm.frm_ViddBonuses.cmbBonuses, 
						     SalPixelsToFormUnits(hWndForm.frm_ViddBonuses.cmbBonuses, nWinWidth, FALSE)/2 - 2.5, nY0)
				Call SalGetWindowLoc(hWndForm.frm_ViddBonuses.cmbBonuses, nX0, nY0)
				Call SalSetWindowLoc(hWndForm.frm_ViddBonuses.dfBonus, 
						     SalPixelsToFormUnits(hWndForm.frm_ViddBonuses.dfBonus, nWinWidth, FALSE)/2 - 2.5 - 0.2 -1.4, nY0)
				Call SalInvalidateWindow(hWndForm)
	Dialog Box: dlg_ViddBonus
		Class:
		Property Template:
		Class DLL Name:
		Title: Установка параметров привязки
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  6.9"
				Width Editable? Yes
				Height: 4.3"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Picture: pic3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.2"
					Top:    0.1"
					Width:  6.35"
					Width Editable? Yes
					Height: 0.6"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
				Message Actions
			Background Text: Наименование вида вклада
				Resource Id: 34157
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.4"
					Top:    0.3"
					Width:  5.9"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Blue
				Background Color: Default
			Data Field: bgVName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Picture: pic1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.2"
					Top:    0.8"
					Width:  6.4"
					Width Editable? Yes
					Height: 2.3"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
				Message Actions
			Background Text: Параметры привязки
				Resource Id: 31339
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    0.72"
					Width:  3.15"
					Width Editable? Yes
					Height: 0.2"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: bgParams
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Check Box: cbActivity
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCheckBoxLabeled
				Property Template:
				Class DLL Name:
				Title: Признак активности привязки
				Window Location and Size
					Left:   0.4"
					Top:    1.0"
					Width:  4.0"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
			Check Box: cbFinally
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cCheckBoxLabeled
				Property Template:
				Class DLL Name:
				Title: Признак окончания просмотра
				Window Location and Size
					Left:   0.4"
					Top:    1.3"
					Width:  4.0"
					Width Editable? Class Default
					Height: 0.25"
					Height Editable? Class Default
				Visible? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
			Background Text: Ранг привязки льготы к виду договора (№ пп)
				Resource Id: 31341
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.4"
					Top:    1.6"
					Width:  4.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: bgRang
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfRang
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 38
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.5"
						Top:    1.55"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Условие привязки льготы к виду договора
				Resource Id: 31343
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.4"
					Top:    1.9"
					Width:  4.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: bgCondition
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Multiline Field: mlCondition
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 4000
					String Type: Long String
					Editable? Yes
				Display Settings
					Border? Yes
					Word Wrap? Yes
					Vertical Scroll? Yes
					Window Location and Size
						Left:   0.4"
						Top:    2.15"
						Width:  6.0"
						Width Editable? Yes
						Height: 0.8"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Message Actions
					On SAM_SetFocus
						If not bEditCondition
							Set mlCondition = STRING_Null
							Call SalColorSet(mlCondition, COLOR_IndexWindowText, COLOR_Black)
					On SAM_KillFocus
						If not bEditCondition or mlCondition = STRING_Null
							Set mlCondition = PutCrLf() || sTextCondition
							Call SalColorSet(mlCondition, COLOR_IndexWindowText, COLOR_DarkGray)
							Set bEditCondition = FALSE
					On SAM_AnyEdit
						Set bEditCondition = TRUE
			Picture: pic2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.2"
					Top:    3.2"
					Width:  6.4"
					Width Editable? Yes
					Height: 0.7"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
				Message Actions
			Pushbutton: pbApplyForAll
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledOk
				Property Template:
				Class DLL Name:
				Title: Применить для всех
				Window Location and Size
					Left:   0.4"
					Top:    3.3"
					Width:  1.8"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If setValue(2)
							Call SalEndDialog(hWndForm, TRUE)
			Pushbutton: pbApply
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledOk
				Property Template:
				Class DLL Name:
				Title: Применить
				Window Location and Size
					Left:   2.5"
					Top:    3.298"
					Width:  1.8"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If setValue(1)
							Call SalEndDialog(hWndForm, TRUE)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   4.6"
					Top:    3.298"
					Width:  1.8"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set nFlag = 0
						Call SalEndDialog(hWndForm, FALSE)
		Functions
			Function: setValue
				Description:
				Returns
					Boolean:
				Parameters
					Number: nPb
				Static Variables
				Local variables
					Boolean: bReturn
				Actions
					Set bReturn = TRUE
					Set nFlag = nPb
					Set nActivity   = cbActivity
					Set nFinally    = cbFinally
					Set nRang       = dfRang
					Set lsCondition = IifS(bEditCondition=TRUE, mlCondition, STRING_Null)
					If not nRang
						! Не заполнен Ранг привязки льготы к виду договора!
						Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_ViddBonus.cTErrRang'), 
								     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconAsterisk | MB_Ok)
						Call SalSetFocus(dfRang)
						Set bReturn = FALSE
					Return bReturn
		Window Parameters
			Number: nParEdit
			String: sTitle
			Boolean: bParAll
			Receive Number: nFlag
			Receive Number: nActivity
			Receive Number: nFinally
			Receive Number: nRang
			Receive Long String: lsCondition
		Window Variables
			Boolean: bEditCondition
			String: sTextCondition
		Message Actions
			On SAM_Create
				! Установка параметров привязки
				! Просмотр параметров привязки
				Call SalSetWindowText(hWndForm, IifS(nParEdit=1,
						     CurrentLangTable.GetAtomTitle('dlg_ViddBonus.cTWndTitle'),
						     CurrentLangTable.GetAtomTitle('dlg_ViddBonus.cTWndTitle0')))
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call PrepareWindowEx(hWndForm)
				If sTitle != STRING_Null
					Call SalSetWindowLabelText(bgVName, sTitle)
				Set cbActivity  = nActivity
				Set cbFinally   = nFinally
				Set dfRang      = nRang
				Set mlCondition = lsCondition
				Set bEditCondition = TRUE
				! Поле должно содержать SQL-запрос, который возвращает значение Y/N
				Set sTextCondition = CurrentLangTable.GetAtomTitle('dlg_ViddBonus.cTTextCondition')
				If nParEdit and mlCondition = STRING_Null
					Set mlCondition = PutCrLf() || sTextCondition
					Call SalColorSet(mlCondition, COLOR_IndexWindowText, COLOR_DarkGray)
					Set bEditCondition = FALSE
				!
				If not nParEdit
					Call SalDisableWindow(cbActivity)
					Call SalDisableWindow(cbFinally)
					Call SalDisableWindow(dfRang)
					Call SalDisableWindow(mlCondition)
					Call SalDisableWindow(pbApplyForAll)
					Call SalDisableWindow(pbApply)
				Else If not bParAll
					Call SalDisableWindow(pbApplyForAll)
				Call SalSetFocus(pbCancel)
	Form Window: frm_DptBonusRequest
		Class: cGenericTableFrm
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  13.2"
				Width Editable? Class Default
				Height: 6.821"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Pushbutton: pbUpdate
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(hWndForm, UM_Update, 0, 0)
				Line
					Resource Id: 16173
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(hCurrTable, UM_Search, 0, 0)
				Pushbutton: pbFilter
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(hCurrTable, SAM_DoubleClick, 0, 0)
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg(hCurrTable, UM_Print, 0, 0)
				Line
					Resource Id: 16174
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbVisa
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.05"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Визировать
							Set strTip = CurrentLangTable.GetAtomTitle('frm_DptBonusRequest.pbVisa')
						On SAM_Click
							Call SalSendMsg(tblBonuses, SAM_User, 1, 0)
				Pushbutton: pbStorno
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.5"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\APP1.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Сторнировать
							Set strTip = CurrentLangTable.GetAtomTitle('frm_DptBonusRequest.pbStorno')
						On SAM_Click
							Call SalSendMsg(tblBonuses, SAM_User, 2, 0)
				Pushbutton: pbAccept
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.95"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Принять
							Set strTip = CurrentLangTable.GetAtomTitle('frm_DptBonusRequest.pbAccept')
						On SAM_Click
							Call SalSendMsg(tblDpt, UM_Update, 0, 0)
				Line
					Resource Id: 16175
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  5.483"
						Begin Y:  0.429"
						End X:  5.483"
						End Y:  0.012"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 24
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.617"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 16176
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  6.15"
						Begin Y:  0.429"
						End X:  6.15"
						End Y:  0.012"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
		Contents
			Child Table: tblDpt
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableFrm
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  12.45"
						Width Editable? Class Default
						Height: 2.393"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 1000000
					Discardable? Class Default
				Contents
					Column: colDptId	! Идентификатор договора
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Ид.
								договора
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colDptNum	! Номер договора
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Номер
								договора
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colDptDat	! Дата договора
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								договора
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Center
						Width:  Class Default
						Width Editable? Class Default
						Format: Date
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colDptRate	! Текущая процентная ставка
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Тек.%%
								ставка
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colCustId	! Рег.№ клиента
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Рег.№
								клиента
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colCustName	! ФИО клиента
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ФИО
								клиента
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colCustCode	! Идентиф.код клиента
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Идентиф.код
								клиента
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colViddId	! Идентификатор вида вклада
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Идентификатор
								вида вклада
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colViddName	! Наименование вида вклада
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Наименование
								вида вклада
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colViddCode	! Симв.код вида вклада
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Симв.код
								вида вклада
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colBranchId	! Код подразделения
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
								подразделения
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colBranchName	! Наименование подразделения
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Наименование
								подразделения
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colProcessingDone	! colProcessingDone
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: colProcessingDone
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
					Function: SetBonusRate
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
							Number: nBonusVal
						Actions
							If not SqlPLSQLCommand(hSql(), "dpt_bonus.set_bonus_rate(nDptId, dBankDate, nBonusVal)")
								! DPT_BONUS. Неуспешное выполнение процедуры расчета и установки бонусной %-ной ставки по договору nDptId
								Call SqlRollbackEx(hSql(), "DPT_BONUS. " || CurrentLangTable.GetAtomTitle('frm_DptBonusRequest.cTSetBonusRateRollback') || " " || Str(nDptId))
								Return FALSE
							! DPT_BONUS. Успешно выполнена процедура расчета и установки бонусной %-ной ставки по договору nDptId
							Call SqlCommitEx(hSql(), "DPT_BONUS. " || CurrentLangTable.GetAtomTitle('frm_DptBonusRequest.cTSetBonusRateCommit') || " " || Str(nDptId))
							Return TRUE
				Window Variables
				Message Actions
					On UM_Populate
						Set nDptId = NUMBER_Null
						Call SalTblReset(tblBonuses)
						Call SalSendClassMessage(UM_Populate, 0, 0)
						Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
						Call SalTblSetContext(hWndForm, 0)
						Call SalPostMsg(hWndForm, SAM_RowSetContext, 0, 0)
					On SAM_RowSetContext
						Set hCurrTable = hWndForm
						Set nDptId     = colDptId
						! If colProcessingDone = 'Y'
							                                                                                                                                                                                     Call SalEnableWindow(pbAccept)
						! Else
							                                                                                                                                                                                     Call SalDisableWindow(pbAccept)
						Call SalSendMsg(tblBonuses, UM_Populate, 0, 0)
					On UM_Update
						Call SetBonusRate()
						Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
			Child Table: tblBonuses
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.067"
						Top:    3.048"
						Width:  12.45"
						Width Editable? Yes
						Height: 2.44"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: colDptId	! - N Идентификатор договора
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Идентификатор договора
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colBonusId	! + N Идентификатор льготы
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Ид.
								льготы
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  0.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colBonusName	! + S Наименование льготы
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Наименование
								льготы
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  4.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colBonusValPlan	! + N Размер расчетной льготной ставки
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Расчетная
								льготная ставка
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colBonusValFact	! + N Размер установленной льготной ставки
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Установленная
								льготная ставка
						Visible? Class Default
						Editable? Yes
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_SetFocus
								Set nTmp = colBonusValFact
							On SAM_AnyEdit
								If colReqStateId != 'NULL' or not colReqConfirm
									Set colBonusValFact = nTmp
									Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, FALSE)
							On SAM_Validate
								If colBonusValFact = NUMBER_Null
										or colBonusValFact = 0
									Set colBonusValFact = NUMBER_Null
								Call setValFact()
								If SalTblQueryRowFlags(hWndForm, lParam, ROW_New)
									Call SalTblSetRowFlags(hWndForm, lParam, ROW_Edited, FALSE)
									Call SalTblSetRowFlags(hWndForm, lParam, ROW_New, TRUE)
								Return VALIDATE_Ok
					Column: colReqStateId	! - N Код статуса запроса
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код статуса
								запроса
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colReqStateName	! + S Статус запроса
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Статус
								запроса
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colReqAuto	! + B Признак автомат.формирования
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Автомат.
								формирование
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Center
						Width:  1.4"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Check Box
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colReqConfirm	! + B Признак необходимости подтверждения
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Необходимость
								подтверждения
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Center
						Width:  1.4"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Check Box
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colReqRecalc	! + B Признак необходимости перерасчета
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Необходимость
								перерасчета
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Center
						Width:  1.4"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Check Box
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colReqDate	! + D Дата и время формирования запроса
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата форм.
								запроса
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.8"
						Width Editable? Class Default
						Format: DateTime
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colReqUserId	! - N Код пользователя-инициатора запроса
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код пользователя-инициатора запроса
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colReqUserName	! + S ФИО пользователя-инициатора запроса
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ФИО пользователя-
								инициатора запроса
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  4.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
					Function: DptRequestConfirmation
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
							String: sConfirm
							Number: nBonusVal
						Actions
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(hWndForm, nRow, ROW_New | ROW_MarkDeleted, 0)
								Call SalTblSetContext(hWndForm, nRow)
								If colReqStateId = 'NULL' and colReqConfirm
									Set nBonusId = colBonusId
									If SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
										Set sConfirm  = 'Y'
										Set nBonusVal = colBonusValFact
									Else If SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted)
										Set sConfirm  = 'N'
										Set nBonusVal = NUMBER_Null
									If not SqlPLSQLCommand(hSql(), "dpt_bonus.request_confirmation(nDptId, nBonusId, sConfirm, nBonusVal)")
										! Call SqlRollbackEx(hSql(), IifS(sConfirm='Y',
												     "DPT_BONUS. Неуспешное выполнение процедуры подтверждения запроса на получение льготы " || Str(nBonusId) || " по договору " || Str(nDptId),
												     "DPT_BONUS. Неуспешное выполнение процедуры удаления запроса на получение льготы " || Str(nBonusId) || " по договору " || Str(nDptId)))
										Call SqlRollbackEx(hSql(), "DPT_BONUS. " || IifS(sConfirm='Y',
												     CurrentLangTable.GetAtomTitle('frm_DptBonusRequest.cTDptRequestConfirmationRollbackAdd') || " " || Str(nBonusId) || " " || 
												     CurrentLangTable.GetAtomTitle('frm_DptBonusRequest.cTDptRequestConfirmationDpt') || " " || Str(nDptId),
												     CurrentLangTable.GetAtomTitle('frm_DptBonusRequest.cTDptRequestConfirmationRollbackDel') || " " || Str(nBonusId) || " " ||
												     CurrentLangTable.GetAtomTitle('frm_DptBonusRequest.cTDptRequestConfirmationDpt') || " " || Str(nDptId)))
									Else
										! Call SqlCommitEx(hSql(), IifS(sConfirm='Y',
												     "DPT_BONUS. Успешно выполнена процедура подтверждения запроса на получение льготы " || Str(nBonusId) || " по договору " || Str(nDptId),
												     "DPT_BONUS. Успешно выполнена процедура удаления запроса на получение льготы " || Str(nBonusId) || " по договору " || Str(nDptId) ))
										Call SqlCommitEx(hSql(), "DPT_BONUS. " || IifS(sConfirm='Y',
												     CurrentLangTable.GetAtomTitle('frm_DptBonusRequest.cTDptRequestConfirmationCommitAdd') || " " || Str(nBonusId) || " " || 
												     CurrentLangTable.GetAtomTitle('frm_DptBonusRequest.cTDptRequestConfirmationDpt') || " " || Str(nDptId),
												     CurrentLangTable.GetAtomTitle('frm_DptBonusRequest.cTDptRequestConfirmationCommitDel') || " " || Str(nBonusId) || " " || 
												     CurrentLangTable.GetAtomTitle('frm_DptBonusRequest.cTDptRequestConfirmationDpt') || " " || Str(nDptId) ))
							Return TRUE
					Function: setValFact
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Set nValPlan = 0 
							Set nValFact = 0 
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(hWndForm, nRow, 0, 0)
								Call SalTblSetContext(hWndForm, nRow)
								If colBonusId != NUMBER_Null and 
										  (colReqStateId = 'ALLOW' or colReqStateId = 'NULL' and SalTblQueryRowFlags(hWndForm, nRow, ROW_New))
									Set nValPlan = nValPlan + colBonusValPlan
									Set nValFact = nValFact + colBonusValFact
							Call SalTblSetContext(hWndForm, nItogRow)
							Set colBonusValPlan = nValPlan
							Set colBonusValFact = nValFact
				Window Variables
					String: sSqlPopulate
					String: sSqlTableName
					Boolean: bSortOrd
					Number: nValPlan
					Number: nValFact
					Number: nItogRow
					Number: nTmp
					Number: nRow
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
						Set sSqlTableName = "v_dpt_in_bonus_queue_details"
						Set sSqlPopulate = 
								"select dpt_id, bonus_id, bonus_name, bonusval_plan, bonusval_fact, 
								        req_stateid, req_statename, decode(req_auto,'Y',1,0),
								        decode(req_confirm,'Y',1,0), decode(req_recalc,'Y',1,0), 
								        req_date, req_userid, req_username
								   into :hWndForm.tblBonuses.colDptId, :hWndForm.tblBonuses.colBonusId, :hWndForm.tblBonuses.colBonusName,
								        :hWndForm.tblBonuses.colBonusValPlan, :hWndForm.tblBonuses.colBonusValFact,
								        :hWndForm.tblBonuses.colReqStateId, :hWndForm.tblBonuses.colReqStateName,
								        :hWndForm.tblBonuses.colReqAuto, :hWndForm.tblBonuses.colReqConfirm, :hWndForm.tblBonuses.colReqRecalc,
								        :hWndForm.tblBonuses.colReqDate, :hWndForm.tblBonuses.colReqUserId, :hWndForm.tblBonuses.colReqUserName
								   from " || sSqlTableName || "
								  where dpt_id = :nDptId
								  order by bonus_id"
					On UM_Populate
						If nDptId
							If SqlPLSQLCommand(hSql(), "dpt_bonus.request_recalculation(nDptId)")
								! Перерасчет значения льготы по договору nDptId
								Call SqlCommitEx(hSql(), "DPT_BONUS. " || CurrentLangTable.GetAtomTitle('frm_DptBonusRequest.cTRequestRecalculationCommit') || " " || Str(nDptId))
								Set nValPlan = 0
								Set nValFact = 0
								Call SalTblPopulate(hWndForm, hSql(), sSqlPopulate, TBL_FillAll)
								Call SalTblDefineSplitWindow(hWndForm, 3, TRUE)
								Set nItogRow = SalTblInsertRow(hWndForm, TBL_MinRow)
								Call SalTblSetRowFlags(hWndForm, nItogRow, ROW_New, FALSE)
								Call SalTblSetContext(hWndForm, nItogRow)
								! Set colBonusName = 'Итого'
								Set colBonusName = CurrentLangTable.GetAtomTitle('frm_DptBonusRequest.cTItogo')
								Set colBonusValPlan = nValPlan
								Set colBonusValFact = nValFact
								Call VisTblAutoSizeColumn(hWndForm, colReqAuto)
								Call VisTblAutoSizeColumn(hWndForm, colReqConfirm)
								Call VisTblAutoSizeColumn(hWndForm, colReqRecalc)
								Call SalTblSetContext(hWndForm, 0)
								Call SalSendMsg(hWndForm, SAM_RowSetContext, 0, 0)
							Else
								! Неуспешное выполнение процедуры перерасчета значения льготы по договору nDptId
								Call SqlRollbackEx(hSql(), "DPT_BONUS. " || CurrentLangTable.GetAtomTitle('frm_DptBonusRequest.cTRequestRecalculationRollback') || " " || Str(nDptId))
					On SAM_FetchRowDone
						If colReqStateId = 'REGRT' or colReqStateId = 'DELET'
							Call VisTblSetRowColor(hWndForm, lParam, COLOR_Red)
						Else If colReqStateId = 'NULL'
							Call VisTblSetRowColor(hWndForm, lParam, COLOR_DarkGreen)
						Else If colReqStateId = 'ALLOW'
							Set nValPlan = nValPlan + colBonusValPlan
							Set nValFact = nValFact + colBonusValFact
					On SAM_RowSetContext
						Set hCurrTable = hWndForm
						Set nBonusId   = colBonusId
						If colReqStateId = 'NULL' and
								   colReqConfirm
							Call SalEnableWindow(pbVisa)
							Call SalEnableWindow(pbStorno)
						Else
							Call SalDisableWindow(pbVisa)
							Call SalDisableWindow(pbStorno)
					On SAM_ColumnSelectClick
						Call SalTblSetColumnFlags(SalNumberToWindowHandle(wParam), COL_Selected, FALSE)
						Set bSortOrd = not bSortOrd
						Call SalTblSortRows(hWndForm, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
					On SAM_RowValidate
						Call setValFact()
						If SalTblQueryRowFlags(hWndForm, lParam, ROW_New)
							Call SalTblSetRowFlags(hWndForm, lParam, ROW_Edited, FALSE)
							Call SalTblSetRowFlags(hWndForm, lParam, ROW_New, TRUE)
					On SAM_User
						Select Case wParam
							Case 1	! Visa
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
									Call SalTblSetContext(hWndForm, nRow)
									If colReqStateId = 'NULL' and colReqConfirm
										Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted, FALSE)
										Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, TRUE)
								Break
							Case 2	! Stornr
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
									Call SalTblSetContext(hWndForm, nRow)
									If colReqStateId = 'NULL' and colReqConfirm
										Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
										Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted, TRUE)
								Break
							Default
								Break
						Call setValFact()
					On UM_Update
						Call DptRequestConfirmation()
						Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
					On UM_Search
						Call TblFindString(hWndForm, DFIND_First)
					On UM_Print
						Call TablePrint(hWndForm, '', GetPrnDir() || '\\' || 'BONUSES', '')
			Custom Control: cHSpl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalHSplitter
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  12.683"
						Width Editable? Class Default
						Height: 5.452"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Yes
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
		Functions
		Window Parameters
			Number: nParEdit
			String: sPar1
			String: sPar2
		Window Variables
			Date/Time: dBankDate
			Window Handle: hCurrTable
			Number: nDptId
			Number: nBonusId
		Message Actions
			On SAM_Create
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_DptBonusRequest.cTWndTitle'))
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call PrepareWindowEx(hWndForm)
				Call SetWindowFullSize(hWndForm)
				!
				If nParEdit
					Set hWndForm.frm_DptBonusRequest.nFlags = GT_NoIns | GT_NoDel
				Else
					Set hWndForm.frm_DptBonusRequest.nFlags = GT_ReadOnly
				Set hWndForm.frm_DptBonusRequest.strSqlPopulate = 
						"select dpt_id, dpt_num, dpt_dat, dpt_rate, cust_id, cust_name, cust_code,
						        type_id, type_name, type_code, branch_id, branch_name,
						        substr(dpt_bonus.request_processing_done(dpt_id),1,1)
						   into :hWndForm.tblDpt.colDptId, :hWndForm.tblDpt.colDptNum,
						        :hWndForm.tblDpt.colDptDat,, :hWndForm.tblDpt.colDptRate,
						        :hWndForm.tblDpt.colCustId, :hWndForm.tblDpt.colCustName, :hWndForm.tblDpt.colCustCode,
						        :hWndForm.tblDpt.colViddId, :hWndForm.tblDpt.colViddName, :hWndForm.tblDpt.colViddCode,
						        :hWndForm.tblDpt.colBranchId, :hWndForm.tblDpt.colBranchName, :hWndForm.tblDpt.colProcessingDone
						   from v_dpt_in_bonus_queue
						  order by dpt_id"
				Set hWndForm.frm_DptBonusRequest.strFilterTblName = 'v_dpt_in_bonus_queue'
				Set hWndForm.frm_DptBonusRequest.strPrintFileName = 'dpt_in_bonus'
				Set hWndForm.frm_DptBonusRequest.nTabInstance = 1
				Call SalDisableWindow(pbDetails)
				Call SalDisableWindow(pbVisa)
				Call SalDisableWindow(pbStorno)
				Call SalDisableWindow(pbAccept)
				!
				Set dBankDate = GetBankDate()
				Call cHSpl.setBarSize(5)
				Call cHSpl.setBarPosition(500)
				Call cHSpl.setTopFrame(tblDpt)
				Call cHSpl.setBottomFrame(tblBonuses)
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalSendMsg(tblDpt, UM_Populate, 0, 0)
			On UM_Update
				Call SalSendMsg(tblBonuses, UM_Update, 0, 0)
	Table Window: tbl_DptCommisReq
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Подтверждение запросов на отмену комиссии
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 64000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 23328
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.4"
						Begin Y:  0.0"
						End X:  5.4"
						End Y:  0.464"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If not pbArc
								If SetQueryFilter(hWndForm.tbl_DptCommisReq.cF)
									Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
							Else
								If SetQueryFilter(cFArc)
									Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 23329
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbVisa
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.0"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Подтвердить запрос
							Set strTip = CurrentLangTable.GetAtomTitle('tbl_DptCommisReq.pbVisa')
						On SAM_Click
							Call ReqCheck(1)
				Pushbutton: pbStorno
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.433"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\APP1.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Отклонить запрос
							Set strTip = CurrentLangTable.GetAtomTitle('tbl_DptCommisReq.pbStorno')
						On SAM_Click
							Call ReqCheck(-1)
				Option Button: pbArc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.867"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\TUDASUDA.BMP
					Picture Transparent Color: White
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							If pbArc
								! Необработанные запросы
								Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('tbl_DptCommisReq.pbArc_'))
							Else
								! Архив запросов
								Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('tbl_DptCommisReq.pbArc'))
						On SAM_Click
							If pbArc
								! Архів запитів за відміну комісій за оформлення додаткових угод до депозитних договорів ФО
								Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tbl_DptCommisReq.cTWndTitleArc'))
							Else
								Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tbl_DptCommisReq.cTWndTitle'))
							Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Line
					Resource Id: 23330
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.517"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 23331
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  6.05"
						Begin Y:  0.024"
						End X:  6.05"
						End Y:  0.488"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
		Contents
			Column: colReqId		! Идентификатор запроса
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ид.
						запроса
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  1.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqCrDate		! Дата создания запроса
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата создания
						запроса
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.8"
				Width Editable? Class Default
				Format: DateTime
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqCrUser		! Пользователь, создавший запрос
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Пользователь,
						созд. запрос
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  3.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqPrcDate		! Дата подтверждения запроса
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата подтв.
						запроса
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.8"
				Width Editable? Class Default
				Format: DateTime
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqPrcUser		! Пользователь, подтвердивший запрос
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Пользователь,
						подтв. запрос
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  3.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colDptId		! Идентификатор деп. договора
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ид.
						договора
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colDptNd		! Номер деп. договора
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Номер
						договора
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  1.2"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colDptDate		! Дата заключения договора
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата закл.
						договора
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.2"
				Width Editable? Class Default
				Format: Date
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colAgrmntType		! Код типа доп. соглашения
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код типа
						доп.соглашения
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colAgrmntTypeName	! Тип доп. соглашения
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Тип доп.
						соглашения
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  4.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colBranch		! Код подразделения
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						подразделения
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  2.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colBranchName		! Наименование подразделения
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Наименование
						подразделения
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  3.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqState		! Код состояния запроса
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						состояния запроса
				Visible? No
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Class Default
				Width:  2.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqStateName		! Состояние запроса
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Состояние запроса
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  3.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
		Functions
			Function: ReqCheck
				Description:
				Returns
				Parameters
					Number: nReqCheck
				Static Variables
				Local variables
					Number: nRow
					Number: nReqId
				Actions
					Set nRow = TBL_MinRow
					While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
						Call SalTblSetContext(hWndForm, nRow)
						Set nReqId = colReqId
						If SqlPLSQLCommand(hSql(), "dpt_web.put_commis_check(nReqId, nReqCheck)")
							! Успешно выполнена процедура подтверждения запроса на отмену комиссии по договору №...
									  Успешно выполнена процедура отклонения запроса на отмену комиссии по договору №...
							Call SqlCommitEx(hSql(), "DPT_COMMIS. " || IifS(nReqCheck=1,
									     CurrentLangTable.GetAtomTitle('tbl_DptCommisReq.cTReqCheckCommitVisa') || " " || Str(colDptId),
									     CurrentLangTable.GetAtomTitle('tbl_DptCommisReq.cTReqCheckCommitStorno') || " " || Str(colDptId)))
						Else
							! Неуспешное выполнение процедуры подтверждения запроса на отмену комиссии по договору №...
									  Неуспешное выполнение процедуры отклонения запроса на отмену комиссии по договору №...
							Call SqlRollbackEx(hSql(), "DPT_COMMIS. " || IifS(nReqCheck=1,
									     CurrentLangTable.GetAtomTitle('tbl_DptCommisReq.cTReqCheckRollbackVisa') || " " || Str(colDptId),
									     CurrentLangTable.GetAtomTitle('tbl_DptCommisReq.cTReqCheckRollbackStorno') || " " || Str(colDptId)))
					Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
		Window Parameters
			Number: nParEdit
			String: sPar1
			String: sPar2
		Window Variables
			String: strFilterTblNameArc
			String: strSqlPopulateArc
			String: strDSqlArc
			: cFArc
				Class: cGenFilter
			: cQArc
				Class: cGenQuery
		Message Actions
			On SAM_Create
				! Обробка запитів за відміну комісій за оформлення додаткових угод до депозитних договорів ФО
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tbl_DptCommisReq.cTWndTitle'))
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call PrepareWindowEx(hWndForm)
				Call SetWindowFullSize(hWndForm)
				!
				Set hWndForm.tbl_DptCommisReq.nFlags = GT_ReadOnly
				Set hWndForm.tbl_DptCommisReq.nTabInstance = 1
				Set hWndForm.tbl_DptCommisReq.strFilterTblName = 'v_dpt_commisreq_active'
				Set hWndForm.tbl_DptCommisReq.strPrintFileName = 'dpt_cmrq'
				Set hWndForm.tbl_DptCommisReq.strSqlPopulate = 
						"select req_id, req_crdate, req_cruser,
						        dpt_id, dpt_nd, dpt_date,
						        agrmnt_type, agrmnt_typename, branch, branch_name
						   into :hWndForm.tbl_DptCommisReq.colReqId, :hWndForm.tbl_DptCommisReq.colReqCrDate, :hWndForm.tbl_DptCommisReq.colReqCrUser,
						        :hWndForm.tbl_DptCommisReq.colDptId, :hWndForm.tbl_DptCommisReq.colDptNd, :hWndForm.tbl_DptCommisReq.colDptDate,
						        :hWndForm.tbl_DptCommisReq.colAgrmntType, :hWndForm.tbl_DptCommisReq.colAgrmntTypeName,
						        :hWndForm.tbl_DptCommisReq.colBranch, :hWndForm.tbl_DptCommisReq.colBranchName
						   from v_dpt_commisreq_active
						  order by req_id"
				!
				Set pbArc = FALSE
				Set strFilterTblNameArc = 'v_dpt_commisreqs'
				Set strSqlPopulateArc = 
						"select req_id, req_crdate, req_cruser, req_prcdate, req_prcuser,
						        dpt_id, dpt_nd, dpt_date,
						        agrmnt_type, agrmnt_typename, branch, branch_name,
						        req_state, req_statename
						   into :hWndForm.tbl_DptCommisReq.colReqId, :hWndForm.tbl_DptCommisReq.colReqCrDate, :hWndForm.tbl_DptCommisReq.colReqCrUser,
						        :hWndForm.tbl_DptCommisReq.colReqPrcDate,  :hWndForm.tbl_DptCommisReq.colReqPrcUser,
						        :hWndForm.tbl_DptCommisReq.colDptId, :hWndForm.tbl_DptCommisReq.colDptNd, :hWndForm.tbl_DptCommisReq.colDptDate,
						        :hWndForm.tbl_DptCommisReq.colAgrmntType, :hWndForm.tbl_DptCommisReq.colAgrmntTypeName,
						        :hWndForm.tbl_DptCommisReq.colBranch, :hWndForm.tbl_DptCommisReq.colBranchName,
						        :hWndForm.tbl_DptCommisReq.colReqState, :hWndForm.tbl_DptCommisReq.colReqStateName
						   from v_dpt_commisreqs
						  order by req_id"
				Call cFArc.Init(strFilterTblNameArc, strFilterTblNameArc)
				Call cQArc.Init(strSqlPopulateArc)
				!
				Call SalDisableWindow(pbDetails)
				Call SalHideWindow(colReqPrcDate)
				Call SalHideWindow(colReqPrcUser)
				Call SalHideWindow(colReqStateName)
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				If not pbArc
					Call SalEnableWindow(pbVisa)
					Call SalEnableWindow(pbStorno)
					Call SalHideWindow(colReqPrcDate)
					Call SalHideWindow(colReqPrcUser)
					Call SalHideWindow(colReqStateName)
					Call SalSendClassMessage(UM_Populate, 0, 0)
				Else
					Call SalDisableWindow(pbVisa)
					Call SalDisableWindow(pbStorno)
					Call SalShowWindow(colReqPrcDate)
					Call SalShowWindow(colReqPrcUser)
					Call SalShowWindow(colReqStateName)
					Set strDSqlArc = cQArc.GetFullSQLString(cFArc)
					Call SalTblPopulate(hWndForm, hSql(), T(strDSqlArc), TBL_FillAll)
			On SAM_FetchRowDone
				If colReqState = 1
					Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(230, 255, 230)) ! светло-зеленый
				Else If colReqState = -1
					Call VisTblSetRowColor(hWndForm, lParam, COLOR_DarkRed)
					Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(255, 230, 230))
	Table Window: tbl_DptCreateChgIntDpt
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Создание запросов на изменение %-й ставки по договору
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  17.417"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 64000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 15366
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.55"
						Begin Y:  0.012"
						End X:  4.55"
						End Y:  0.476"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 15367
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 15368
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: colDptId	! Идентификатор вклада
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ид.
						вклада
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  1.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colDptNd	! Номер вклада
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Номер
						вклада
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  1.2"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colDptDat	! Дата заключения вклада
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата заключения
						вклада
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.2"
				Width Editable? Class Default
				Format: Date
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colCustName	! ФИО клиента
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: ФИО клиента
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  4.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colCustIdCode	! Идентиф.код клиента
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ид.код
						клиента
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  1.6"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colViddCode	! Код вида вклада
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код вида
						вклада
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  1.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colViddName	! Наименование вида вклада
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Наименование
						вида вклада
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  4.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colDatBegin	! Дата начала
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата
						начала
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.2"
				Width Editable? Class Default
				Format: Date
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colDatEnd	! Дата окончания
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата
						окончания
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.2"
				Width Editable? Class Default
				Format: Date
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colRate		! %-ная ставка
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: %-ная
						ставка
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colFlag		! Формувати
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Форму-
						вати
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Center
				Width:  1.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Check Box
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Class Default
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nMode
			String: sPar1
			String: sPar2
		Window Variables
			Number: nNewRate
			Date/Time: dExpDate
			Number: nCount
			Number: nRow
			Number: nDptId
		Message Actions
			On SAM_Create
				! Создание запросов на изменение %-й ставки по договору
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tbl_DptCreateChgIntDpt.cTWndTitle'))
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call PrepareWindowEx(hWndForm)
				Call SetWindowFullSize(hWndForm)
				Call SalDisableWindow(pbDetails)
				!
				Set hWndForm.tbl_DptCreateChgIntDpt.nFlags = GT_NoIns | GT_NoDel
				Set hWndForm.tbl_DptCreateChgIntDpt.fFilterAtStart = TRUE
				Set hWndForm.tbl_DptCreateChgIntDpt.strFilterTblName = 'v_dpt_chgint4individual'
				Set hWndForm.tbl_DptCreateChgIntDpt.strPrintFileName = 'dpt_chg'
				Set hWndForm.tbl_DptCreateChgIntDpt.strSqlPopulate = 
						"select dpt_id, dpt_num, dpt_dat, cust_name, cust_idcode,
						        vidd_code, vidd_name, dat_begin, dat_end, rate
						   into :hWndForm.tbl_DptCreateChgIntDpt.colDptId, :hWndForm.tbl_DptCreateChgIntDpt.colDptNd, :hWndForm.tbl_DptCreateChgIntDpt.colDptDat,
						        :hWndForm.tbl_DptCreateChgIntDpt.colCustName, :hWndForm.tbl_DptCreateChgIntDpt.colCustIdCode,
						        :hWndForm.tbl_DptCreateChgIntDpt.colViddCode, :hWndForm.tbl_DptCreateChgIntDpt.colViddName,
						        :hWndForm.tbl_DptCreateChgIntDpt.colDatBegin, :hWndForm.tbl_DptCreateChgIntDpt.colDatEnd,
						        :hWndForm.tbl_DptCreateChgIntDpt.colRate
						   from v_dpt_chgint4individual
						  order by dpt_id"
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Update
				Set nCount = 0
				Set nRow = TBL_MinRow 
				While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
					If colFlag
						Set nCount = nCount + 1
				If nCount
					If SalModalDialog(dlg_DptSetIntDpt, hWndForm, nNewRate, dExpDate)
						Set nRow = TBL_MinRow 
						While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
							Call SalTblSetContext(hWndForm, nRow)
							If colFlag
								! Сформировать запрос на изменение %-ной ставки по договору
								If SalMessageBox(CurrentLangTable.GetAtomTitle('tbl_DptCreateChgIntDpt.cTMsgQuestionFormReq') || " " || Str(colDptId) || "?",
										   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconQuestion | MB_YesNo) = IDYES
									Set nDptId = colDptId
									If SqlPrepareAndExecute(hSql(),
											"declare "   || 
											"  l_reqid number; " ||
											"begin "     ||
											"  l_reqid:=dpt_web.create_chgintdpt_request(" ||
											     Str(nDptId) || ", " ||
											     Str(nNewRate) || ", to_date('" ||
											     SalFmtFormatDateTime(dExpDate, 'dd/MM/yyyy') || "', 'dd/MM/yyyy')); " ||
											"end;")
										! Успешно выполнена процедура формирования запроса на изменение %% ставкии по договору №...
										Call SqlCommitEx(hSql(), "DPT_CHGINTREQ. " || 
												     CurrentLangTable.GetAtomTitle('tbl_DptCreateChgIntDpt.cTChgIntDptCommit') || " " || Str(colDptId))
									Else
										! Неуспешное выполнение процедуры формирования запроса на изменение %% ставкии по договору №...
										Call SqlRollbackEx(hSql(), "DPT_CHGINTREQ. " || 
												     CurrentLangTable.GetAtomTitle('tbl_DptCreateChgIntDpt.cTChgIntDptRollback') || " " || Str(colDptId))
						Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Else
					! Не отмечены договора для формирования запроса!
					Call SalMessageBox(CurrentLangTable.GetAtomTitle('tbl_DptCreateChgIntDpt.cTMsgDptNotSelected'),
							     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconAsterisk)
	Dialog Box: dlg_DptSetIntDpt
		Class:
		Property Template:
		Class DLL Name:
		Title: Подтверждение запроса
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  8.0"
				Width Editable? Yes
				Height: 2.4"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Picture: pic1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.2"
					Top:    0.15"
					Width:  7.5"
					Width Editable? Yes
					Height: 1.0"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
				Message Actions
			Background Text: Укажите новые реквизиты %-й ставки
				Resource Id: 15374
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    0.05"
					Width:  6.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: bgNewParams
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Background Text: Значение ставки
				Resource Id: 15376
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.4"
					Top:    0.4"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgNewRate
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNewRate
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 16
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   5.5"
						Top:    0.35"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Граничная дата заключения доп. соглашения
				Resource Id: 15375
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.4"
					Top:    0.75"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgExpDate
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfExpDate
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 10
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   5.5"
						Top:    0.7"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: 99.99.9999
				Message Actions
			Picture: pic2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.2"
					Top:    1.25"
					Width:  7.5"
					Width Editable? Yes
					Height: 0.75"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
				Message Actions
			Pushbutton: pbApply
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledOk
				Property Template:
				Class DLL Name:
				Title: Создать запрос
				Window Location and Size
					Left:   0.4"
					Top:    1.4"
					Width:  1.6"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Enter
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If CheckData()
							Set nNewRate = dfNewRate
							Set dExpDate = dfExpDate
							Call SalEndDialog(hWndForm, 1)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.85"
					Top:    1.4"
					Width:  1.6"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Esc
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, 0)
		Functions
			Function: CheckData
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					If SalIsNull(dfNewRate)
						! Не заполнено значение %-ной ставки!
						Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_DptSetIntDpt.cTCheckBrates'),
								    CurrentLangTable.GetAtomTitle('cTAt'), MB_IconAsterisk)
						Call SalSetFocus(dfNewRate)
						Return FALSE
					If SalIsNull(dfExpDate)
						! Не заполнено значение даты!
						Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_DptSetIntDpt.cTCheckExpDate'),
								     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconAsterisk)
						Call SalSetFocus(dfExpDate)
						Return FALSE
					Return TRUE
		Window Parameters
			Receive Number: nNewRate
			Receive Date/Time: dExpDate
		Window Variables
		Message Actions
			On SAM_Create
				! Подтверждение запроса
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_DptSetIntDpt.cTWndTitle'))
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call PrepareWindowEx(hWndForm)
				Call SalSetFocus(pbCancel)
	Form Window: frm_DptCreateChgIntVid
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  9.15"
				Width Editable? Yes
				Height: 5.0"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Picture: pic1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.2"
					Top:    0.15"
					Width:  8.6"
					Width Editable? Yes
					Height: 0.65"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
				Message Actions
			Background Text: Вид договора
				Resource Id: 19722
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.4"
					Top:    0.4"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgVidd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfVidd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.5"
						Top:    0.35"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If not SalIsNull(dfVidd)
							If cmbVidd.GetNameById(dfVidd) = ''
								! Неизвестный код вида договора!
								Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_DptCreateChgIntVid.cTErrVidd'),
										     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
								Set cmbVidd = ''
								Return VALIDATE_Cancel
							Else
								Call cmbVidd.SetSelectById(dfVidd)
						Else
							Set cmbVidd = ''
						Return VALIDATE_Ok
			Combo Box: cmbVidd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   3.4"
					Top:    0.35"
					Width:  5.1"
					Width Editable? Class Default
					Height: 5.833"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						If cmbVidd.Init(hWndItem)
							Call cmbVidd.Populate(hSql(), "dpttype_id", "dpttype_id || ' ' || dpttype_name", "v_dpt_chgint4vidd", "order by dpttype_id")
					On SAM_Click
						Call SalSendClassMessage(SAM_Click, 0, 0)
						Set dfVidd = cmbVidd.nCurrentId
			Picture: pic2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.183"
					Top:    1.0"
					Width:  8.6"
					Width Editable? Yes
					Height: 1.0"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
				Message Actions
			Background Text: Укажите условия для отбора договоров
				Resource Id: 19728
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    0.9"
					Width:  5.6"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: bgCondition
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Background Text: Подразделение
				Resource Id: 19723
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.4"
					Top:    1.25"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgBranch
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Combo Box: cmbBranch
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_StrId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   2.5"
					Top:    1.2"
					Width:  6.0"
					Width Editable? Class Default
					Height: 4.286"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						If cmbBranch.Init(hWndItem)
							Call cmbBranch.Populate(hSql(), "branch", "branch || ' ' || name", "branch", "order by branch")
							! Все подразделения
							Call cmbBranch.Add('-', CurrentLangTable.GetAtomTitle('frm_DptCreateChgIntVid.cTAllBranches'))
							Call cmbBranch.SetSelectById('-')
							Set sBranch = '-'
					On SAM_Click
						Call SalSendClassMessage(SAM_Click, 0, 0)
						Set sBranch = cmbBranch.strCurrentId
			Background Text: Диапазон открытия договоров
				Resource Id: 19730
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.4"
					Top:    1.6"
					Width:  3.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgDates
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Background Text: С
				Resource Id: 19725
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.0"
					Top:    1.595"
					Width:  0.5"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgDatBegin
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfDatBegin
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.65"
						Top:    1.55"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: 99.99.9999
				Message Actions
			Background Text: По
				Resource Id: 19726
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.25"
					Top:    1.595"
					Width:  0.5"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgDatEnd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfDatEnd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.9"
						Top:    1.55"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: 99.99.9999
				Message Actions
			Picture: pic3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.2"
					Top:    2.2"
					Width:  8.6"
					Width Editable? Yes
					Height: 1.3"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
				Message Actions
			Background Text: Укажите новые реквизиты базовой ставки
				Resource Id: 19729
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    2.1"
					Width:  6.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: 3D Shadow Color
				Background Color: Default
			Data Field: bgNewParams
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Background Text: Базовая ставка
				Resource Id: 19724
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.4"
					Top:    2.45"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgBrates
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfBrates
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.5"
						Top:    2.4"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If not SalIsNull(dfBrates)
							If cmbBrates.GetNameById(dfBrates) = ''
								! Неизвестный код базовой ставки!
								Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_DptCreateChgIntVid.cTErrBrates'),
										     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation | MB_Ok)
								Set cmbBrates = ''
								Return VALIDATE_Cancel
							Else
								Call cmbBrates.SetSelectById(dfBrates)
						Else
							Set cmbBrates = ''
						Return VALIDATE_Ok
			Combo Box: cmbBrates
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   3.4"
					Top:    2.4"
					Width:  5.1"
					Width Editable? Class Default
					Height: 2.738"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						If cmbBrates.Init(hWndItem)
							Call cmbBrates.Populate(hSql(), "br_id", "br_id || ' ' || name", "brates", "order by br_id")
					On SAM_Click
						Call SalSendClassMessage(SAM_Click, 0, 0)
						Set dfBrates = cmbBrates.nCurrentId
			Background Text: Дата начала действия базовой %-ной ставки
				Resource Id: 45740
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.4"
					Top:    2.8"
					Width:  5.583"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgBratesDate
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfBratesDate
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.9"
						Top:    2.75"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: 99.99.9999
				Message Actions
			Background Text: Граничная дата заключения доп. соглашения
				Resource Id: 19727
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.4"
					Top:    3.1"
					Width:  5.583"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgExpDate
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfExpDate
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.9"
						Top:    3.05"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: 99.99.9999
				Message Actions
			Picture: pic4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.2"
					Top:    3.7"
					Width:  8.6"
					Width Editable? Yes
					Height: 0.75"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name:
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Tile To Parent? No
				Border Color: 3D Shadow Color
				Background Color: 3D Face Color
				Message Actions
			Pushbutton: pbApply
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledOk
				Property Template:
				Class DLL Name:
				Title: Создать запрос
				Window Location and Size
					Left:   0.5"
					Top:    3.85"
					Width:  1.6"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If not dfVidd
							! Не выбран вид договора!
							Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_DptCreateChgIntVid.cTCheckVidd'),
									     CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok)
							Call SalSetFocus(cmbVidd)
						Else If not cmbBrates
							! Не установлена базовая ставка!
							Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_DptCreateChgIntVid.cTCheckBrates'),
									     CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok)
							Call SalSetFocus(cmbBrates)
						Else If not dfBratesDate
							! Не установлена дата начала действия базовой %-ной ставки!
							Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_DptCreateChgIntVid.cTCheckBratesDate'),
									     CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok)
							Call SalSetFocus(dfBratesDate)
						Else If not dfExpDate
							! Не установлена Граничная дата заключения доп. соглашения!
							Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_DptCreateChgIntVid.cTCheckExpDate'),
									     CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok)
							Call SalSetFocus(dfExpDate)
						Else If SalModalDialog(dlg_DptSetIntVid, hWndForm, dfVidd, dfBrates, dfBratesDate, dfExpDate, sBranch, dfDatBegin, dfDatEnd)
							Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_DptCreateChgIntVid.cTChgIntVidCommit') || " " || Str(dfVidd),
									     CurrentLangTable.GetAtomTitle('cTInfo'), MB_IconAsterisk | MB_Ok)
							Call SalSendMsg(hWndForm, SAM_User, 0, 0)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.9"
					Top:    3.85"
					Width:  1.6"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalDestroyWindow(hWndForm)
		Functions
		Window Parameters
			Number: nPar
			String: sPar1
			String: sPar2
		Window Variables
			String: sBranch
		Message Actions
			On SAM_Create
				! Создание запросов на изменение %% ставки по виду договора
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_DptCreateChgIntVid.cTWndTitle'))
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call PrepareWindowEx(hWndForm)
				Call SalSetFocus(pbCancel)
			On SAM_User
				Set dfVidd = NUMBER_Null
				Call cmbVidd.SetSelectById(dfVidd)
				Set sBranch = '-'
				Call cmbBranch.SetSelectById(sBranch)
				Set dfDatBegin = DATETIME_Null
				Set dfDatEnd   = DATETIME_Null
				Set dfBrates = NUMBER_Null
				Call cmbBrates.SetSelectById(dfBrates)
				Set dfBratesDate = DATETIME_Null
				Set dfExpDate    = DATETIME_Null
	Dialog Box: dlg_DptSetIntVid
		Class:
		Property Template:
		Class DLL Name:
		Title: Прогноз выполнения
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  9.0"
				Width Editable? Yes
				Height: 3.226"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Child Table: tblInfo
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  8.9"
						Width Editable? Yes
						Height: 2.1"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 64000
					Discardable? Yes
				Contents
					Column: colBranch
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Подразделение
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colBranchName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Название подразделения
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  5.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colCountVidd
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Количество
								договоров
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.2"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
					Number: nCount
					Number: nRow
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
						Set nCount = 0
						Call SalTblPopulate(hWndForm, hSql(),
								"select branch_id, branch_name, count(branch_id)
								   into :hWndForm.tblInfo.colBranch, :hWndForm.tblInfo.colBranchName,
								        :hWndForm.tblInfo.colCountVidd
								   from v_dpt_portfolio_active
								  where dpt_id not in (select dpt_id from v_dpt_chgintreq_active)
								    and vidd_code = :nVidd " ||
								        IifS(sBranch='-', "",             " and branch_id = :sBranch ")  || 
								        IifS(dDatBegin=DATETIME_Null, "", " and dat_begin >= :dDatBegin ")  ||
								        IifS(dDatEnd=DATETIME_Null,   "", " and dat_begin <= :dDatEnd ")  || "
								  group by branch_id, branch_name
								  order by branch_id", TBL_FillAll)
						Set nRow = SalTblInsertRow(hWndForm, 0)
						Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
						Call SalTblSetContext(hWndForm, nRow)
						Call VisTblSetRowColor(hWndForm, nRow, COLOR_Blue)
						! Всего договоров
						Set colBranchName = CurrentLangTable.GetAtomTitle('dlg_DptSetIntVid.cTItogo')
						Set colCountVidd  = nCount
						If nCount = 0
							Call SalDisableWindow(pbApply)
					On SAM_FetchRowDone
						Set nCount = nCount + colCountVidd
					On UM_Update
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(hWndForm, nRow, 0, 0)
							Call SalTblSetContext(hWndForm, nRow)
							If colBranch
								If SqlPrepareAndExecute(hSql(),
										"declare "   || 
										"  l_reqid number; " ||
										"begin "     ||
										"  l_reqid:=dpt_web.create_chgintvid_request(" ||
										     Str(nVidd)   || ", " ||
										     Str(nBrates) || ", to_date('" ||
										     SalFmtFormatDateTime(dBratesDate, 'dd/MM/yyyy') || "', 'dd/MM/yyyy'), to_date('" ||
										     SalFmtFormatDateTime(dExpDate,    'dd/MM/yyyy') || "', 'dd/MM/yyyy'), '" ||
										     colBranch || "', " || IifS(dDatBegin=DATETIME_Null,"null","to_date('" ||
										     SalFmtFormatDateTime(dDatBegin, 'dd/MM/yyyy') || "', 'dd/MM/yyyy')") || "," || IifS(dDatEnd=DATETIME_Null,"null","to_date('" ||
										     SalFmtFormatDateTime(dDatEnd,   'dd/MM/yyyy') || "', 'dd/MM/yyyy')") || "); " ||
										"end;")
									! Успешно выполнена процедура формирования запроса на изменение %% ставкии по виду договора nVidd для отделения colBranch
									Call SqlCommitEx(hSql(), "DPT_CHGINTREQ. " ||
											     CurrentLangTable.GetAtomTitle('frm_DptCreateChgIntVid.cTChgIntVidCommit') || " " || Str(nVidd) || " "  ||
											     CurrentLangTable.GetAtomTitle('frm_DptCreateChgIntVid.cTChgIntVidBranch') || " " || colBranch)
									Call SalSendMsg(hWndForm, SAM_User, 0, 0)
								Else
									! Неуспешное выполнение процедуры формирования запроса на изменение %% ставкии по виду договора nVidd для отделения colBranch
									Call SqlRollbackEx(hSql(), "DPT_CHGINTREQ. " ||
											     CurrentLangTable.GetAtomTitle('frm_DptCreateChgIntVid.cTChgIntVidRollback') || " " || Str(nVidd) || " "  ||
											     CurrentLangTable.GetAtomTitle('frm_DptCreateChgIntVid.cTChgIntVidBranch')   || " " || colBranch)
			Pushbutton: pbApply
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledOk
				Property Template:
				Class DLL Name:
				Title: Создать запрос
				Window Location and Size
					Left:   0.3"
					Top:    2.3"
					Width:  1.6"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalSendMsg(tblInfo, UM_Update, 0, 0)
						Call SalEndDialog(hWndForm, 1)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   7.0"
					Top:    2.3"
					Width:  1.6"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, 0)
		Functions
		Window Parameters
			Number: nVidd
			Number: nBrates
			Date/Time: dBratesDate
			Date/Time: dExpDate
			String: sBranch
			Date/Time: dDatBegin
			Date/Time: dDatEnd
		Window Variables
		Message Actions
			On SAM_Create
				! Прогноз выполнения
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_DptSetIntVid.cTWndTitle'))
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call PrepareWindowEx(hWndForm)
				Call SalSetFocus(pbCancel)
	Table Window: tbl_DptChgIntReq
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Обробка запитів на зміну %-х ставок
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 64000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 15370
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.667"
						Begin Y:  0.0"
						End X:  5.667"
						End Y:  0.464"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If not pbArc
								Set hWndForm.tbl_DptChgIntReq.fFilterAtStart = TRUE
							Else
								Set fFilterAtStartArc = TRUE
							Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 15371
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbStorno
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.017"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\APP1.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							! Удалить запрос
							Set strTip = CurrentLangTable.GetAtomTitle('tbl_DptChgIntReq.pbStorno')
						On SAM_Click
							Call DeleteReq()
				Option Button: pbArc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.467"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\TUDASUDA.BMP
					Picture Transparent Color: White
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							If pbArc
								! Необработанные запросы
								Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('tbl_DptChgIntReq.pbArc_'))
							Else
								! Архив запросов
								Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('tbl_DptChgIntReq.pbArc'))
						On SAM_Click
							Set bArc = TRUE
							If pbArc
								! Архів запитів
								Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tbl_DptChgIntReq.cTWndTitleArc'))
							Else
								Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tbl_DptChgIntReq.cTWndTitle'))
							Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Line
					Resource Id: 15373
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  5.017"
						Begin Y:  0.012"
						End X:  5.017"
						End Y:  0.476"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.133"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 15372
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: colReqId	! Идентификатор запроса
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ид.
						запроса
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  1.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqCrDate	! Дата создания запроса
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата создания
						запроса
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.8"
				Width Editable? Class Default
				Format: DateTime
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqCrUser	! Пользователь, создавший запрос
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Пользователь,
						создавший запрос
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  3.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqPrcDate	! Дата подтверждения запроса
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата подтв.
						запроса
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.8"
				Width Editable? Class Default
				Format: DateTime
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqPrcUser	! Пользователь, подтв. запрос
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Пользователь,
						подтв. запрос
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  3.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colDptId	! Идентификатор деп. договора
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Ид.
						договора
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colDptNd	! Номер деп. договора
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Номер
						договора
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  1.2"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colDptDate	! Дата заключения договора
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата закл.
						договора
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.2"
				Width Editable? Class Default
				Format: Date
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqcType	! Код типа изменения проц. ставки
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код типа
						изменения
						проц. ставки
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqcTypeName	! Тип изменения проц. ставки
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Тип изменения
						проц. ставки
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  2.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqcExpDate	! Конечная дата закл. сглашения
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Конечная дата
						закл. сглашения
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.2"
				Width Editable? Class Default
				Format: Date
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqcOldInt	! Текущее значение проц. ставки
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Текущее
						значение
						проц. ставки
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  1.6"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqcNewInt	! Новое значение проц. ставки
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Новое
						значение
						проц. ставки
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  1.6"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqcNewBr	! Новая базовая проц. ставка
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Новая
						базовая
						проц. ставка
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  1.6"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colBranch	! Код подразделения
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						подразделения
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  2.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colBranchName	! Наименование подразделения
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Наименование
						подразделения
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  3.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqState	! Код состояния запроса
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код состояния
						запроса
				Visible? No
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Number
				Justify: Right
				Width:  2.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: colReqStateName	! Состояние запроса
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Состояние
						запроса
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  3.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
		Functions
			Function: DeleteReq
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nRow
					Number: nReqId
				Actions
					Set nRow = TBL_MinRow
					While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
						Call SalTblSetContext(hWndForm, nRow)
						Set nReqId = colReqId
						If SqlPLSQLCommand(hSql(), "dpt_web.delete_chgint_request(nReqId)")
							! Успешно выполнена процедура удаления запроса на изменение %% ставкии по договору №...
							Call SqlCommitEx(hSql(), "DPT_CHGINTREQ. " || 
									     CurrentLangTable.GetAtomTitle('tbl_DptChgIntReq.cTDeleteReqCommitStorno') || " " || Str(colDptId))
						Else
							! Неуспешное выполнение процедуры удаления запроса на на изменение %% ставкии по договору №...
							Call SqlRollbackEx(hSql(), "DPT_CHGINTREQ. " || 
									     CurrentLangTable.GetAtomTitle('tbl_DptChgIntReq.cTDeleteReqRollbackStorno') || " " || Str(colDptId))
					Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
		Window Parameters
			Number: nParEdit
			String: sPar1
			String: sPar2
		Window Variables
			String: strFilterTblNameArc
			String: strSqlPopulateArc
			String: strDSqlArc
			Boolean: fFilterAtStartArc
			: cFArc
				Class: cGenFilter
			: cQArc
				Class: cGenQuery
			Boolean: bArc
		Message Actions
			On SAM_Create
				! Обробка запитів на зміну %-х ставок
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('tbl_DptChgIntReq.cTWndTitle'))
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call PrepareWindowEx(hWndForm)
				Call SetWindowFullSize(hWndForm)
				!
				Set hWndForm.tbl_DptChgIntReq.nFlags = GT_ReadOnly
				Set hWndForm.tbl_DptChgIntReq.nTabInstance = 1
				Set hWndForm.tbl_DptChgIntReq.fFilterAtStart = TRUE
				Set hWndForm.tbl_DptChgIntReq.strFilterTblName = 'v_dpt_chgintreq_active'
				Set hWndForm.tbl_DptChgIntReq.strPrintFileName = 'dpt_ccng'
				Set hWndForm.tbl_DptChgIntReq.strSqlPopulate = 
						"select req_id, req_crdate, req_cruser,
						        dpt_id, dpt_nd, dpt_date,
						        reqc_type, reqc_typename, reqc_expdate, reqc_oldint, 
						        reqc_newint, reqc_newbr, branch, branch_name
						   into :hWndForm.tbl_DptChgIntReq.colReqId, :hWndForm.tbl_DptChgIntReq.colReqCrDate, :hWndForm.tbl_DptChgIntReq.colReqCrUser,
						        :hWndForm.tbl_DptChgIntReq.colDptId, :hWndForm.tbl_DptChgIntReq.colDptNd, :hWndForm.tbl_DptChgIntReq.colDptDate,
						        :hWndForm.tbl_DptChgIntReq.colReqcType, :hWndForm.tbl_DptChgIntReq.colReqcTypeName, 
						        :hWndForm.tbl_DptChgIntReq.colReqcExpDate, :hWndForm.tbl_DptChgIntReq.colReqcOldInt,
						        :hWndForm.tbl_DptChgIntReq.colReqcNewInt, :hWndForm.tbl_DptChgIntReq.colReqcNewBr, 
						        :hWndForm.tbl_DptChgIntReq.colBranch, :hWndForm.tbl_DptChgIntReq.colBranchName
						   from v_dpt_chgintreq_active
						  order by req_id"
				!
				Set pbArc = FALSE
				Set fFilterAtStartArc = TRUE
				Set strFilterTblNameArc = 'v_dpt_chgintreqs'
				Set strSqlPopulateArc = 
						"select req_id, req_crdate, req_cruser, req_prcdate, req_prcuser,
						        dpt_id, dpt_nd, dpt_date,
						        reqc_type, reqc_typename, reqc_expdate, reqc_oldint, 
						        reqc_newint, reqc_newbr, branch, branch_name,
						        req_state, req_statename
						   into :hWndForm.tbl_DptChgIntReq.colReqId, :hWndForm.tbl_DptChgIntReq.colReqCrDate, :hWndForm.tbl_DptChgIntReq.colReqCrUser,
						        :hWndForm.tbl_DptChgIntReq.colReqPrcDate, :hWndForm.tbl_DptChgIntReq.colReqPrcUser,
						        :hWndForm.tbl_DptChgIntReq.colDptId, :hWndForm.tbl_DptChgIntReq.colDptNd, :hWndForm.tbl_DptChgIntReq.colDptDate,
						        :hWndForm.tbl_DptChgIntReq.colReqcType, :hWndForm.tbl_DptChgIntReq.colReqcTypeName, 
						        :hWndForm.tbl_DptChgIntReq.colReqcExpDate, :hWndForm.tbl_DptChgIntReq.colReqcOldInt,
						        :hWndForm.tbl_DptChgIntReq.colReqcNewInt, :hWndForm.tbl_DptChgIntReq.colReqcNewBr, 
						        :hWndForm.tbl_DptChgIntReq.colBranch, :hWndForm.tbl_DptChgIntReq.colBranchName,
						        :hWndForm.tbl_DptChgIntReq.colReqState, :hWndForm.tbl_DptChgIntReq.colReqStateName
						   from v_dpt_chgintreqs
						  order by req_id"
				Call cFArc.Init(strFilterTblNameArc, strFilterTblNameArc)
				Call cQArc.Init(strSqlPopulateArc)
				!
				Call SalDisableWindow(pbDetails)
				Call SalHideWindow(colReqPrcDate)
				Call SalHideWindow(colReqPrcUser)
				Call SalHideWindow(colReqStateName)
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				If bArc
					Set bArc = not bArc
					Call SalTblReset(hWndForm)
				If not pbArc
					Call SalEnableWindow(pbStorno)
					Call SalHideWindow(colReqPrcDate)
					Call SalHideWindow(colReqPrcUser)
					Call SalHideWindow(colReqStateName)
					If fFilterAtStart
						Call SetQueryFilter(cF)
						If cF.GetFilterWhereClause(TRUE)
							Set fFilterAtStart = NOT fFilterAtStart
						Else
							Call SalMessageBox(CurrentLangTable.GetAtomTitle('tbl_DptChgIntReq.cTMsgSetFilter'),
									     CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok)
					If not fFilterAtStart
						Call SalSendClassMessage(UM_Populate, 0, 0)
				Else
					Call SalDisableWindow(pbStorno)
					Call SalShowWindow(colReqPrcDate)
					Call SalShowWindow(colReqPrcUser)
					Call SalShowWindow(colReqStateName)
					If fFilterAtStartArc
						Call SetQueryFilter(cFArc)
						If cFArc.GetFilterWhereClause(TRUE)
							Set fFilterAtStartArc = NOT fFilterAtStartArc
						Else
							Call SalMessageBox(CurrentLangTable.GetAtomTitle('tbl_DptChgIntReq.cTMsgSetFilter'),
									     CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok)
					If not fFilterAtStartArc
						Set strDSqlArc = cQArc.GetFullSQLString(cFArc)
						Call SalTblPopulate(hWndForm, hSql(), T(strDSqlArc), TBL_FillAll)
			On SAM_FetchRowDone
				If colReqState = 1
					Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(230, 255, 230)) ! светло-зеленый
				Else If colReqState = -1
					Call VisTblSetRowColor(hWndForm, lParam, COLOR_DarkRed)
					Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(255, 230, 230))
	Form Window: frm_ViddParams
		Class: cGenericTableFrm
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  10.817"
				Width Editable? Class Default
				Height: 4.881"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.533"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(tbl, nRow, ROW_Edited, 0)
								Call SalTblSetContext(tbl, nRow)
								If SqlPLSQLCommand(hSql(), "dpt.set_viddparam_value(nTYPEID, tbl.colTag, tbl.colValue, nEDITABLE)")
									Call SqlCommit(hSql())
								Else
									Call SqlRollback(hSql())
							Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
				Line
					Resource Id: 37614
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  1.033"
						Begin Y:  Class Default
						End X:  1.033"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.133"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.033"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 37615
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  2.55"
						Begin Y:  0.393"
						End X:  2.55"
						End Y:  -0.024"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 24
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.65"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 37616
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  3.167"
						Begin Y:  0.393"
						End X:  3.167"
						End Y:  -0.024"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Data Field: dfTitle
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.783"
						Top:    0.202"
						Width:  9.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: MS Sans Serif
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Default
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableFrm
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    0.881"
						Width:  10.5"
						Width Editable? Class Default
						Height: 3.083"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: colTag
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? No
						Maximum Data Length: 16
						Data Type: Class Default
						Justify: Class Default
						Width:  2.333"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colValue
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: 3000
						Data Type: Class Default
						Justify: Class Default
						Width:  3.167"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colDescr
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  4.183"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colEditable
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  4.183"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_FetchRowDone
						If tbl.colEditable = 'N'
							Call SetTblRowColor(frm_ViddParams.tbl, COLOR_DarkRed)
			Data Field: dfTypeName
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.783"
						Top:    0.488"
						Width:  9.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: MS Sans Serif
					Font Size: 10
					Font Enhancement: Bold-Underline
					Text Color: Default
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
		Functions
		Window Parameters
			Number: nTYPEID
			String: sTYPENAME
			Number: nEDITABLE
		Window Variables
			Number: nRow
		Message Actions
			On SAM_Create
				Call PrepareWindowEx(hWndForm)
				! Дополнительные параметры вида вклада
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_ViddParams.cTWndTitle'))
				! Перечень дополнительных параметров для вида вклада
				Set dfTitle = CurrentLangTable.GetAtomTitle('frm_ViddParams.dfTitle')||' № '||Str(nTYPEID)
				Set dfTypeName = sTYPENAME
				Set frm_ViddParams.strFilterTblName = 'v_dptviddparams'
				Set frm_ViddParams.strPrintFileName = 'viddparams'
				Set frm_ViddParams.strSqlPopulate = 
						    "SELECT tag, paramval, tagname, editable
						       INTO :frm_ViddParams.tbl.colTag, 
						            :frm_ViddParams.tbl.colValue,
						            :frm_ViddParams.tbl.colDescr,
						            :frm_ViddParams.tbl.colEditable
						       FROM v_dptviddparams 
						      WHERE vidd = :frm_ViddParams.nTYPEID
						      ORDER BY tag"
				Call SalSendClassMessage(SAM_Create, 0, 0)
	Table Window: tbl_HistChgViddBRID
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Історія змін кодів базових ставок по видам банківських продуктів
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  13.7"
				Width Editable? Class Default
				Height: 7.179"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description: Історія змін базових ставок по видам банківських продуктів
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.452"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 31513
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.15"
						Begin Y:  Class Default
						End X:  5.15"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 31514
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  4.517"
						Begin Y:  0.01"
						End X:  4.517"
						End Y:  0.47"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 31515
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.617"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 31516
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExport
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSynchro
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.0"
						Top:    0.075"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\saved.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_TooltipSetText
							! экспорт в SQL-сценарий
							Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle( 'tbl_HistChgViddBRID.pbExport' ))
						On SAM_Click
							Call GenScript ( tbl_HistChgViddBRID.sModCode )
							! Set nRow = TBL_MinRow
							! While SalTblFindNextRow(tbl_HistChgViddBRID, nRow, ROW_Selected, 0)
								                                                        Call SalTblSetContext(tbl_HistChgViddBRID, nRow)
								                                                        If tbl_HistChgViddBRID.VIDD != NUMBER_Null
									                                                        Call GenScript ( tbl_HistChgViddBRID.VIDD )
							! Call SalTblClearSelection( tbl_HistChgViddBRID )
				Data Field: dfMODCODE
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 3
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.5"
							Top:    0.08"
							Width:  0.8"
							Width Editable? Yes
							Height: 0.3"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: 10
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
		Contents
			Column: MOD_CODE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						Модуля
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: 3
				Data Type: Class Default
				Justify: Center
				Width:  0.8"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: VIDD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						Виду
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: 10
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: VIDD_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Назва
						Виду
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  3.5"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: DATE_ENTRY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата
						Вступу в дію
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.4"
				Width Editable? Class Default
				Format: dd/MM/yyyy
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: BR_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Базова
						Ставка
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: 7
				Data Type: Number
				Justify: Right
				Width:  1.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: BR_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Назва
						Базової Ставки
				Visible? Class Default
				Editable? No
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  3.3"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
			Column: BASEY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						BASEY 
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: 1
				Data Type: Number
				Justify: Center
				Width:  1.0"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
		Functions
			Function: GenScript
				Description: вигрузка історії змін кодів ставок 
				Returns
				Parameters
					String: sModCode	!! Код модуля
				Static Variables
				Local variables
					File Handle: hFile
					String: sFileName
					Long String: sText
				Actions
					! ======================
					If SalMessageBox(CurrentLangTable.GetAtomTitle( 'tbl_HistChgViddBRID.ExportQuestion' ),
							                 CurrentLangTable.GetAtomTitle('cTAt'),
							                 MB_IconQuestion|MB_YesNo) = IDYES
						Call SalWaitCursor(TRUE)
						! Створення файлу
						Set sFileName = GetPrnDir(  ) || '\\dptbrates.sql'
						If not SalFileOpen(hFile, sFileName, OF_Create | OF_ReadWrite)
							Call SalWaitCursor(FALSE)
							Call SalMessageBox(CurrentLangTable.GetAtomTitle( 'tbl_HistChgViddBRID.OpenFileFailed' )||sFileName||"!",
									                   CurrentLangTable.GetAtomTitle('cTErr'),
									                   MB_IconStop)
							Return FALSE
						Else
							If SqlPrepareAndExecute( hSql(), " SELECT  column_value  INTO  :sText  FROM  table ( dpt_utils.gen_script4dptbrates ( :sModCode ) )" )
								While SqlFetchNext( hSql(), nFetchRes )
									Call SalFileWrite(hFile, sText, Len(sText))
								Call SalFileClose(hFile)
								! Call SqlCommit(hSql())
								Call SalWaitCursor(FALSE)
								! Сценарий сохранен в sFileName
								Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'tbl_HistChgViddBRID.ExportDone' )||" "||sFileName,
										                                            CurrentLangTable.GetAtomTitle('cTAt'),
										                                            MB_IconInformation )
								Return TRUE
							Else
								! Помилка експорту даних у сценарій
								Call SalWaitCursor(FALSE)
								! Call SqlRollback(hSql())
								Call SalMessageBox( CurrentLangTable.GetAtomTitle( 'tbl_HistChgViddBRID.CreateFileFailed' ),
										                                            CurrentLangTable.GetAtomTitle( 'cTErr' ),
										                                            MB_IconStop )
								Return FALSE
		Window Parameters
			String: sModCode	!! Код модуля
		Window Variables
			! Number: nRow
		Message Actions
			On SAM_Create
				Call SalWaitCursor(TRUE)
				Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle( 'tbl_HistChgViddBRID.WindowTitle' ) )
				Call PrepareWindow( hWndForm )
				Call SalMapEnterToTab( TRUE )
				Call SetWindowFullSize( tbl_HistChgViddBRID )
				Set tbl_HistChgViddBRID.strFilterTblName = 'DPT_BRATES'
				Set tbl_HistChgViddBRID.strPrintFileName = 'DPT_BRATES'
				If SalStrTrimX( sModCode ) = ''
					Set sModCode = STRING_Null
				If sModCode != STRING_Null
					Call SalHideWindow( tbl_HistChgViddBRID.MOD_CODE )
					Set dfMODCODE = sModCode
				! SELECT
				Set tbl_HistChgViddBRID.strSqlPopulate =
						" SELECT MOD_CODE,  db.VIDD,  v.TYPE_NAME,  db.BR_ID,  br.NAME,  DATE_ENTRY,  db.BASEY
						         INTO :tbl_HistChgViddBRID.MOD_CODE,  :tbl_HistChgViddBRID.VIDD,             :tbl_HistChgViddBRID.VIDD_NAME
						                     :tbl_HistChgViddBRID.BR_ID,              :tbl_HistChgViddBRID.BR_NAME,  :tbl_HistChgViddBRID.DATE_ENTRY,
						                     :tbl_HistChgViddBRID.BASEY
						       FROM DPT_BRATES db, BRATES br, DPT_VIDD v
						   WHERE db.BR_ID = br.BR_ID
						            And db.VIDD  =  v.VIDD " || 
						            IifS( sModCode = STRING_Null,  " ",  " And MOD_CODE = " || QuotedStr( sModCode ) ) ||
						"  ORDER BY MOD_CODE,  DATE_ENTRY,  VIDD desc "
				! INSERT
				Set tbl_HistChgViddBRID.strSqlInsert = 
						" Insert into DPT_BRATES  ( MOD_CODE,  VIDD,  BR_ID,  DATE_ENTRY,  BASEY ) 
						   Values  ( " || IifS( sModCode = STRING_Null, ":tbl_HistChgViddBRID.MOD_CODE ", QuotedStr( sModCode ) ) ||
						                     ", :tbl_HistChgViddBRID.VIDD,                  :tbl_HistChgViddBRID.BR_ID,
						                     :tbl_HistChgViddBRID.DATE_ENTRY,  :tbl_HistChgViddBRID.BASEY ) "
				! DELETE
				Set tbl_HistChgViddBRID.strSqlDelete = 
						" Delete from DPT_BRATES  
						   Where MOD_CODE      = :tbl_HistChgViddBRID.MOD_CODE
						        And VIDD                     = :tbl_HistChgViddBRID.VIDD
						        And DATE_ENTRY = :tbl_HistChgViddBRID.DATE_ENTRY "
				! UPDATE
				Set tbl_HistChgViddBRID.strSqlUpdate = 
						" Update DPT_BRATES 
						           Set BR_ID   = :tbl_HistChgViddBRID.BR_ID,
						                   BASEY = :tbl_HistChgViddBRID.BASEY
						    Where MOD_CODE      = :tbl_HistChgViddBRID.MOD_CODE
						         And VIDD                     = :tbl_HistChgViddBRID.VIDD
						         And DATE_ENTRY = :tbl_HistChgViddBRID.DATE_ENTRY "
				! Finish
				Call SalSendClassMessage(SAM_Create, 0, 0)
