<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReportInfo.Created="11/30/2015 15:00:50" ReportInfo.Modified="12/01/2015 10:22:31" ReportInfo.CreatorVersion="2014.1.2.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;

namespace FastReport
{
  public class ReportScript
  {
     string p_begin_date =&quot;&quot;;
     string p_end_date   =&quot;&quot;;
    
                                                                                                                  

    private void ReportTitle1_BeforePrint(object sender, EventArgs e)
    {
      p_begin_date=FormatDateTime(((DateTime)Report.GetParameterValue(&quot;sFdat1&quot;)),&quot;Short Date&quot;);
      p_end_date  =FormatDateTime(((DateTime)Report.GetParameterValue(&quot;sFdat2&quot;)),&quot;Short Date&quot;);
    }
  }
}
</ScriptText>
  <Dictionary>
    <OracleDataConnection Name="sberdev" ConnectionString="rijcmlqHytUMhhPg9gG4fal5Q6rRB0BvRbh0nDbCWvtDA1bLoVns6ffiXRmCcS4bnzDLLiAiAAxCaSanugR0gw6m2XoTQ==">
      <TableDataSource Name="Table" Alias="QMain" DataType="System.Int32" Enabled="true" SelectCommand="                       SELECT acc,&#13;&#10;                    case &#13;&#10;                       when (select 1&#13;&#10;                               from holiday h&#13;&#10;                              where h.holiday=fdat&#13;&#10;                                and h.kv='980')=1 then 'Вихідний'&#13;&#10;                        else 'Робочий'&#13;&#10;                    end type_date,     &#13;&#10;                    fdat, &#13;&#10;                    kv,&#13;&#10;                    sum(dos)/100 dos,&#13;&#10;                    sum(dosq)/100 dosq,&#13;&#10;                    sum(kos)/100 kos,&#13;&#10;                    sum(kosq)/100 kosq,&#13;&#10;                    sum(dos_01)/100 dos_01,&#13;&#10;                    sum(dosq_01)/100 dosq_01,&#13;&#10;                    sum(kos_01)/100 kos_01,&#13;&#10;                    sum(kosq_01)/100 kosq_01,&#13;&#10;                    sum(dos_guard)/100 dos_guard&#13;&#10;              FROM ( SELECT a.acc, &#13;&#10;                            o.fdat, &#13;&#10;                            a.kv,&#13;&#10;                            nvl(sum(decode(o.tt,'D01',0,o.S )), 0)dos, &#13;&#10;                            nvl(sum(decode(o.tt,'D01',0,o.SQ)), 0)dosq, &#13;&#10;                            nvl(sum(case &#13;&#10;                                      when o.tt='D01' and upper(t.nazn) like '%СТП%' and t.nazn like '%'||to_char(o.fdat,'ddmmyy')||'%'&#13;&#10;                                         then o.S&#13;&#10;                                      else 0&#13;&#10;                                    end   &#13;&#10;                                    )&#13;&#10;                            , 0)dos_01, &#13;&#10;                            nvl(sum(case &#13;&#10;                                      when o.tt='D01' and upper(t.nazn) like '%СТП%' and t.nazn like '%'||to_char(o.fdat,'ddmmyy')||'%'&#13;&#10;                                         then o.Sq&#13;&#10;                                      else 0&#13;&#10;                                    end   &#13;&#10;                                    )&#13;&#10;                            , 0)dosq_01,                             &#13;&#10;                            0 kos, &#13;&#10;                            0 kosq,&#13;&#10;                            0 kos_01, &#13;&#10;                            0 kosq_01,&#13;&#10;                            nvl(sum(case &#13;&#10;                                      when o.tt='D01' and upper(t.nazn) like '%ГВАРДІЯ%' and (t.nazn like '%'||to_char(o.fdat,'dd/mm/yyyy')||'%' or t.nazn like '%'||to_char(o.fdat,'ddmmyy')||'%')&#13;&#10;                                         then o.Sq&#13;&#10;                                      else 0&#13;&#10;                                    end   &#13;&#10;                                    )&#13;&#10;                            , 0)dos_guard&#13;&#10;                       FROM opldok o, &#13;&#10;                            accounts a,&#13;&#10;                            oper t &#13;&#10;                      WHERE o.dk = 0&#13;&#10;                        and o.sos = 5&#13;&#10;                        and o.s &gt; 0&#13;&#10;                        and o.acc = a.acc&#13;&#10;                        and o.ref=t.ref&#13;&#10;                        and to_char(a.nls) like  :p_acc||'%'   &#13;&#10;                        and o.fdat &gt;= :sFdat1&#13;&#10;                        and o.fdat &lt;  :sFdat2+1&#13;&#10;                        group by a.acc,o.fdat, a.kv                                           &#13;&#10;                     UNION ALL&#13;&#10;                     SELECT a.acc,&#13;&#10;                            o.fdat, &#13;&#10;                            a.kv,&#13;&#10;                            0 dos, &#13;&#10;                            0 dosq, &#13;&#10;                            0 dos_01,&#13;&#10;                            0 dosq_01,&#13;&#10;                            nvl(sum(decode(o.tt,'R01',0,o.S )), 0)kos, &#13;&#10;                            nvl(sum(decode(o.tt,'R01',0,o.SQ)), 0)kosq, &#13;&#10;                            nvl(sum(case &#13;&#10;                                      when o.tt='R01' and t.nazn like '%СТП%' and t.nazn like '%'||to_char(o.fdat,'ddmmyy')||'%'&#13;&#10;                                         then o.S&#13;&#10;                                      else 0&#13;&#10;                                    end   &#13;&#10;                                    )&#13;&#10;                            , 0)kos_01, &#13;&#10;                            nvl(sum(case &#13;&#10;                                      when o.tt='R01' and t.nazn like '%СТП%' and t.nazn like '%'||to_char(o.fdat,'ddmmyy')||'%'&#13;&#10;                                         then o.Sq&#13;&#10;                                      else 0&#13;&#10;                                    end   &#13;&#10;                                    )&#13;&#10;                            , 0)kosq_01,&#13;&#10;                            0 dos_guard&#13;&#10;                       FROM opldok o, &#13;&#10;                            accounts a,&#13;&#10;                            oper t &#13;&#10;                      WHERE o.dk = 1&#13;&#10;                        and o.sos = 5&#13;&#10;                        and o.s &gt; 0&#13;&#10;                        and o.acc = a.acc&#13;&#10;                        and o.ref=t.ref&#13;&#10;                        and to_char(a.nls) like  :p_acc||'%'   &#13;&#10;                        and o.tt&lt;&gt;'R01' &#13;&#10;                        and o.fdat &gt;= :sFdat1&#13;&#10;                        and o.fdat &lt;  :sFdat2 +1&#13;&#10;                        group by a.acc,o.fdat, a.kv)&#13;&#10;             GROUP BY acc, fdat, kv&#13;&#10;             order by fdat,acc,kv&#13;&#10;">
        <Column Name="ACC" DataType="System.Decimal"/>
        <Column Name="FDAT" DataType="System.DateTime"/>
        <Column Name="KV" DataType="System.Int16"/>
        <Column Name="DOS" DataType="System.Decimal"/>
        <Column Name="DOSQ" DataType="System.Decimal"/>
        <Column Name="KOS" DataType="System.Decimal"/>
        <Column Name="KOSQ" DataType="System.Decimal"/>
        <Column Name="DOS_01" DataType="System.Decimal"/>
        <Column Name="DOSQ_01" DataType="System.Decimal"/>
        <Column Name="KOS_01" DataType="System.Decimal"/>
        <Column Name="KOSQ_01" DataType="System.Decimal"/>
        <Column Name="DOS_GUARD" DataType="System.Decimal"/>
        <Column Name="TYPE_DATE" DataType="System.String"/>
        <CommandParameter Name="sFdat1" DataType="106" Expression="[sFdat1]" DefaultValue="01/10/2015"/>
        <CommandParameter Name="sFdat2" DataType="106" Expression="[sFdat2]" DefaultValue="31/10/2015"/>
        <CommandParameter Name="p_acc" DataType="126" Expression="[p_acc]" DefaultValue="373910300465"/>
      </TableDataSource>
    </OracleDataConnection>
    <Parameter Name="sFdat1" DataType="System.DateTime"/>
    <Parameter Name="sFdat2" DataType="System.DateTime"/>
    <Parameter Name="p_acc" DataType="System.String"/>
  </Dictionary>
  <ReportPage Name="Page1">
    <ReportTitleBand Name="ReportTitle1" Width="718.2" Height="37.8" BeforePrintEvent="ReportTitle1_BeforePrint">
      <TextObject Name="Text28" Width="708.75" Height="37.8" Text="Розрахунки  по СТП &quot;Швидка копiйка&quot; &#13;&#10;за період з [p_begin_date] по [p_end_date]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
    </ReportTitleBand>
    <PageHeaderBand Name="PageHeader1" Top="40.66" Width="718.2" Height="47.25">
      <TextObject Name="Text1" Width="66.15" Height="28.35" Border.Lines="All" Text="День тиждня" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt, style=Bold"/>
      <TextObject Name="Text3" Left="66.15" Width="66.15" Height="28.35" Border.Lines="All" Text="Дата" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt, style=Bold"/>
      <TextObject Name="Text5" Left="189" Width="75.6" Height="28.35" Border.Lines="All" Text="Сума Дт&#13;&#10;" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt, style=Bold"/>
      <TextObject Name="Text7" Left="264.6" Width="75.6" Height="28.35" Border.Lines="All" Text="Сума Кт" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt, style=Bold"/>
      <TextObject Name="Text9" Left="340.2" Width="75.6" Height="28.35" Border.Lines="All" Text="Різниця &#13;&#10;Дт-Кт" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt, style=Bold"/>
      <TextObject Name="Text11" Left="415.8" Width="75.6" Height="28.35" Border.Lines="All" Text="Кліринг&#13;&#10;D01 Дт" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt, style=Bold"/>
      <TextObject Name="Text13" Left="491.4" Width="75.6" Height="28.35" Border.Lines="All" Text="Кліринг&#13;&#10;R01 Кт" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt, style=Bold"/>
      <TextObject Name="Text15" Left="567" Width="75.6" Height="28.35" Border.Lines="All" Text="Аналіз" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt, style=Bold"/>
      <TextObject Name="Text17" Left="642.6" Width="75.6" Height="28.35" Border.Lines="All" Text="у т.р. Нац.гвард." HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt, style=Bold"/>
      <TextObject Name="Text29" Left="132.3" Width="56.7" Height="28.35" Border.Lines="All" Text="Код &#13;&#10;валюти" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt, style=Bold"/>
      <TextObject Name="Text2" Top="28.35" Width="66.15" Height="18.9" Border.Lines="All" Text="1" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt"/>
      <TextObject Name="Text4" Left="66.15" Top="28.35" Width="66.15" Height="18.9" Border.Lines="All" Text="2" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt"/>
      <TextObject Name="Text6" Left="189" Top="28.35" Width="75.6" Height="18.9" Border.Lines="All" Text="4" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt"/>
      <TextObject Name="Text8" Left="264.6" Top="28.35" Width="75.6" Height="18.9" Border.Lines="All" Text="5" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt"/>
      <TextObject Name="Text10" Left="340.2" Top="28.35" Width="75.6" Height="18.9" Border.Lines="All" Text="6" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt"/>
      <TextObject Name="Text12" Left="415.8" Top="28.35" Width="75.6" Height="18.9" Border.Lines="All" Text="7" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt"/>
      <TextObject Name="Text14" Left="491.4" Top="28.35" Width="75.6" Height="18.9" Border.Lines="All" Text="8" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt"/>
      <TextObject Name="Text18" Left="642.6" Top="28.35" Width="75.6" Height="18.9" Border.Lines="All" Text="10" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt"/>
      <TextObject Name="Text30" Left="132.3" Top="28.35" Width="56.7" Height="18.9" Border.Lines="All" Text="3" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt"/>
      <TextObject Name="Text16" Left="567" Top="28.35" Width="75.6" Height="18.9" Border.Lines="All" Text="9" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt"/>
    </PageHeaderBand>
    <DataBand Name="Data1" Top="90.76" Width="718.2" Height="18.9" DataSource="Table">
      <TextObject Name="Text19" Width="66.15" Height="18.9" Border.Lines="All" Text="[QMain.TYPE_DATE]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt"/>
      <TextObject Name="Text20" Left="66.15" Width="66.15" Height="18.9" Border.Lines="All" Text="[QMain.FDAT]" Format="Date" Format.Format="d" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt"/>
      <TextObject Name="Text21" Left="189" Width="75.6" Height="18.9" Border.Lines="All" Text="[QMain.DOS]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator=" " Format.NegativePattern="1" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt"/>
      <TextObject Name="Text22" Left="264.6" Width="75.6" Height="18.9" Border.Lines="All" Text="[QMain.KOS]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator=" " Format.NegativePattern="1" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt"/>
      <TextObject Name="Text23" Left="340.2" Width="75.6" Height="18.9" Border.Lines="All" Text="[[QMain.DOS]-[QMain.KOS]]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator=" " Format.NegativePattern="1" HorzAlign="Center" VertAlign="Center" WordWrap="false" Font="Times New Roman, 8pt"/>
      <TextObject Name="Text24" Left="415.8" Width="75.6" Height="18.9" Border.Lines="All" Text="[QMain.DOS_01]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator=" " Format.NegativePattern="1" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt"/>
      <TextObject Name="Text25" Left="491.4" Width="75.6" Height="18.9" Border.Lines="All" Text="[QMain.KOS_01]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator=" " Format.NegativePattern="1" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt"/>
      <TextObject Name="Text26" Left="567" Width="75.6" Height="18.9" Border.Lines="All" Text="[[QMain.DOS_01]-[QMain.KOS_01]]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator=" " Format.NegativePattern="1" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt"/>
      <TextObject Name="Text27" Left="642.6" Width="75.6" Height="18.9" Border.Lines="All" Text="[QMain.DOS_GUARD]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator=" " Format.NegativePattern="1" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt"/>
      <TextObject Name="Text31" Left="132.3" Width="56.7" Height="18.9" Border.Lines="All" Text="[QMain.KV]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt"/>
    </DataBand>
    <PageFooterBand Name="PageFooter1" Top="112.52" Width="718.2"/>
  </ReportPage>
</Report>
