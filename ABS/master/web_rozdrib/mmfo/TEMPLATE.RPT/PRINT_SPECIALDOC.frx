<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReferencedAssemblies="System.dll&#13;&#10;System.Drawing.dll&#13;&#10;System.Windows.Forms.dll&#13;&#10;System.Data.dll&#13;&#10;System.Xml.dll&#13;&#10;Oracle.DataAccess&#13;&#10;FastReport.Oracle" DoublePass="true" FinishReportEvent="_FinishReport" ReportInfo.Created="05/17/2013 18:06:00" ReportInfo.Modified="01/10/2014 14:18:41" ReportInfo.CreatorVersion="2013.2.2.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;
using Oracle.DataAccess.Client;

namespace FastReport
{
  public class ReportScript
  {
    private void _FinishReport(object sender, EventArgs e)
    {
      OracleDataConnection frxconn = (OracleDataConnection)Report.Dictionary.Connections[0];
      OracleConnection connection = (OracleConnection)frxconn.GetConnection();
      
      OracleCommand command = connection.CreateCommand();
      command.CommandType = CommandType.StoredProcedure;
      command.CommandText = &quot;ead_pack.doc_page_count&quot;;
      
      Parameter DocID = Report.GetParameter(&quot;p_doc_id&quot;);
      command.Parameters.Add(&quot;p_doc_id&quot;, DocID.Value);
      command.Parameters.Add(&quot;p_page_count&quot;, Report.Engine.TotalPages);
      
      connection.Open();
      try
      {
        command.ExecuteNonQuery();
      }
      finally
      {
        connection.Close();
      }
    }
  }
}
</ScriptText>
  <Dictionary>
    <OracleDataConnection Name="sberdev" ConnectionString="rijcmlqD6nWZEExUJ9MEhdFZpB1A0bL037Fvz/QbZUxS3qcQIebo6V1crnlxBAM//w4xnYm/o/gqSPoowd3OfIq8vThww==">
      <TableDataSource Name="Table3" Alias="TICKET_DATA" DataType="System.Int32" Enabled="true" SelectCommand="select ed.doc_id,&#13;&#10;       ed.crt_date,&#13;&#10;       ed.ea_struct_id,&#13;&#10;       ed.ea_struct_name,&#13;&#10;       ed.rnk,&#13;&#10;       ed.cl_fio,&#13;&#10;       ed.agr_id,&#13;&#10;       ed.agr_num,&#13;&#10;       ed.crt_staff_logname,&#13;&#10;       ed.crt_staff_fio,&#13;&#10;       ed.crt_branch&#13;&#10;  from v_ead_docs ed&#13;&#10; where ed.doc_id = :p_doc_id">
        <Column Name="RNK" DataType="System.Decimal"/>
        <Column Name="DOC_ID" DataType="System.Decimal"/>
        <Column Name="CRT_DATE" DataType="System.DateTime"/>
        <Column Name="CL_FIO" DataType="System.String"/>
        <Column Name="AGR_ID" DataType="System.Decimal"/>
        <Column Name="AGR_NUM" DataType="System.String"/>
        <Column Name="CRT_BRANCH" DataType="System.String"/>
        <Column Name="CRT_STAFF_LOGNAME" DataType="System.String"/>
        <Column Name="CRT_STAFF_FIO" DataType="System.String"/>
        <Column Name="EA_STRUCT_ID" DataType="System.String"/>
        <Column Name="EA_STRUCT_NAME" DataType="System.String"/>
        <CommandParameter Name="p_doc_id" DataType="113" Expression="[p_doc_id]" DefaultValue="-1"/>
      </TableDataSource>
      <TableDataSource Name="Table6" Alias="SCANS" DataType="System.Int32" Enabled="true" SelectCommand="select * from wcs_print_scans ps where ps.print_session_id = :p_ps_id order by ord">
        <Column Name="PRINT_SESSION_ID" DataType="System.String"/>
        <Column Name="ORD" DataType="System.Decimal"/>
        <Column Name="SCAN_DATA" DataType="System.Byte[]" BindableControl="Picture"/>
        <CommandParameter Name="p_ps_id" DataType="126" Expression="&quot;PS_SPDOC_&quot; + ToString([p_rnk])"/>
      </TableDataSource>
      <TableDataSource Name="Table" Alias="CLIENT_DATA" DataType="System.Int32" Enabled="true" SelectCommand="select c.nmk as fio,&#13;&#10;       c.okpo as okpo,&#13;&#10;       decode(c.codcagent,&#13;&#10;              5,&#13;&#10;              'резидент',&#13;&#10;              6,&#13;&#10;              'нерезидент',&#13;&#10;              '--') as codcagent,&#13;&#10;       p.ser || ' ' || p.numdoc as pasp_no,&#13;&#10;       f_dat_lit(p.pdate) as pasp_date,&#13;&#10;       p.organ as pasp_atrt,&#13;&#10;       c.adr as address,&#13;&#10;       nvl(p.teld, nvl(p.telw, '________')) as phone&#13;&#10;  from customer c, person p&#13;&#10; where c.rnk = p.rnk(+)&#13;&#10;   and c.rnk = :p_rnk">
        <Column Name="FIO" DataType="System.String"/>
        <Column Name="OKPO" DataType="System.String"/>
        <Column Name="CODCAGENT" DataType="System.String"/>
        <Column Name="PASP_NO" DataType="System.String"/>
        <Column Name="PASP_DATE" DataType="System.String"/>
        <Column Name="PASP_ATRT" DataType="System.String"/>
        <Column Name="ADDRESS" DataType="System.String"/>
        <Column Name="PHONE" DataType="System.String"/>
        <CommandParameter Name="p_rnk" DataType="113" Expression="[p_rnk]" DefaultValue="-1"/>
      </TableDataSource>
    </OracleDataConnection>
    <Parameter Name="p_doc_id" DataType="System.Int32" Expression="10141"/>
    <Parameter Name="p_rnk" DataType="System.Int32" Expression="42335"/>
    <Parameter Name="p_agr_id" DataType="System.Int64"/>
  </Dictionary>
  <ReportPage Name="Page1" RawPaperSize="9" LeftMargin="5" TopMargin="2" RightMargin="2" BottomMargin="2" FirstPageSource="15" OtherPagesSource="15">
    <ReportTitleBand Name="ReportTitle1" Width="767.34" Height="153.8">
      <BarcodeObject Name="Barcode2" Width="153.8" Height="153.8" AutoSize="false" Expression="[TICKET_DATA.DOC_ID]+&quot;;&quot;+FormatDateTime([TICKET_DATA.CRT_DATE])+&quot;;&quot;+[TICKET_DATA.EA_STRUCT_ID]+&quot;;&quot;+[TotalPages]+&quot;;&quot;+[TICKET_DATA.RNK]+&quot;;&quot;+[TICKET_DATA.CL_FIO]+&quot;;&quot;+ToString([TICKET_DATA.AGR_ID])+&quot;;&quot;+ToString([TICKET_DATA.AGR_NUM])+&quot;;&quot;+[TICKET_DATA.CRT_STAFF_LOGNAME]+&quot;;&quot;+[TICKET_DATA.CRT_STAFF_FIO]+&quot;;&quot;+[TICKET_DATA.CRT_BRANCH]" ShowText="false" Barcode="QR Code" Barcode.ErrorCorrection="L" Barcode.Encoding="UTF8" Barcode.QuietZone="true"/>
      <TextObject Name="Text1" Left="179.55" Top="9.45" Width="519.75" Height="141.75" Text="Документ: [TICKET_DATA.EA_STRUCT_NAME]&#13;&#10;&#13;&#10;[CLIENT_DATA.FIO]&#13;&#10;[CLIENT_DATA.OKPO]&#13;&#10;[CLIENT_DATA.PASP_NO] [CLIENT_DATA.PASP_ATRT] [CLIENT_DATA.PASP_DATE]" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
    </ReportTitleBand>
    <DataBand Name="Data1" Top="157.8" Width="767.34" Height="576.45" CanGrow="true" CanShrink="true" CanBreak="true" DataSource="Table6">
      <PictureObject Name="Picture1" Width="756" Height="532.98" SizeMode="StretchImage" MaxWidth="756" MaxHeight="532.98" DataColumn="SCANS.SCAN_DATA"/>
      <TextObject Name="Text3" Top="538.65" Width="756" Height="37.8" Text="Копія вірна [FormatDateTime([Date], &quot;Short Date&quot;)] _____________________" HorzAlign="Right" VertAlign="Center"/>
    </DataBand>
    <PageFooterBand Name="PageFooter1" Top="738.25" Width="767.34" Height="18.9">
      <BarcodeObject Name="Barcode1" Left="145.66" Width="126.25" Height="18.9" Anchor="Top, Right" Expression="[TICKET_DATA.DOC_ID]+&quot;:&quot;+[TotalPages]+&quot;:&quot;+[Page]" ShowText="false" Barcode="Codabar"/>
      <TextObject Name="Text2" Left="283.5" Width="472.5" Height="18.9" Text="№ друку [TICKET_DATA.DOC_ID] сторінка [Page] з [TotalPages]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt"/>
    </PageFooterBand>
  </ReportPage>
</Report>
