<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReferencedAssemblies="System.dll&#13;&#10;System.Drawing.dll&#13;&#10;System.Windows.Forms.dll&#13;&#10;System.Data.dll&#13;&#10;System.Xml.dll&#13;&#10;&#13;&#10;Oracle.DataAccess&#13;&#10;FastReport.Oracle" StartReportEvent="_StartReport" ReportInfo.Created="06/24/2014 16:54:08" ReportInfo.Modified="09/16/2015 16:14:02" ReportInfo.CreatorVersion="2013.2.2.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;
using System.Data.Sql;
using Oracle.DataAccess.Client;
using Oracle.DataAccess.Types;


namespace FastReport
{
  public class ReportScript
  {
    
    public string TicDoc_attr(string Var)
    {
      // Обработка параметрів
      Parameter p_nd = Report.GetParameter(&quot;p_nd&quot;);
      String p_value1 = &quot;&quot;;
      String p_value2 = &quot;&quot;;
      String p_value3 = &quot;&quot;;

      OracleDataConnection frxcon = (OracleDataConnection)Report.Dictionary.Connections[0];
      OracleConnection con = (OracleConnection)frxcon.GetConnection();
      OracleCommand cmd = con.CreateCommand();
      
      cmd.CommandType = CommandType.StoredProcedure;
      cmd.CommandText = &quot;cc_doc_get_var_value2&quot;;
         
      cmd.Parameters.Add(&quot;p_tag&quot;,     OracleDbType.Varchar2, Var,           ParameterDirection.Input);       //0
      cmd.Parameters.Add(&quot;p_dealnum&quot;, OracleDbType.Decimal, p_nd.Value,     ParameterDirection.Input);       //1
      cmd.Parameters.Add(&quot;p_agrmnum&quot;, OracleDbType.Decimal, 0,             ParameterDirection.Input);        //2
      cmd.Parameters.Add(&quot;p_value1&quot;, OracleDbType.Varchar2, 2000, p_value1, ParameterDirection.InputOutput); //3
      cmd.Parameters.Add(&quot;p_value2&quot;, OracleDbType.Varchar2, 2000, p_value2, ParameterDirection.InputOutput); //4
      cmd.Parameters.Add(&quot;p_value3&quot;, OracleDbType.Varchar2, 2000, p_value3, ParameterDirection.InputOutput); //5
      
      con.Open();
      try
      {
        cmd.ExecuteNonQuery();
        
        p_value1 = cmd.Parameters[&quot;p_value1&quot;].Value.ToString();
        p_value2 = cmd.Parameters[&quot;p_value2&quot;].Value.ToString();
        p_value2 = cmd.Parameters[&quot;p_value3&quot;].Value.ToString();

      }
      finally
      {
        con.Close();
      }
      
      return   p_value1;
      
    }
    
    
    // Получение значения параметра тикета
    public string GetVal(string Var)
    {
      try
      {
        string p_val = TicDoc_attr(Var);
        
        if (!String.IsNullOrEmpty(p_val) &amp;&amp; p_val != &quot;null&quot;)
          return p_val;
        else 
          return &quot;&quot;;
      }
      catch (Exception) {  return &quot;&quot;; }
    }
    
    private void _StartReport(object sender, EventArgs e)
    {
      // Відображення шапки в залежності від договору
       
      switch (GetVal(&quot;SKRN_TYPE_DOG&quot;))
      {
        case &quot;2&quot;: Row2.Visible  = false;
          Row3.Visible  = false;
          Row16.Visible = true;
          break;
        case &quot;3&quot;: Row2.Visible  = true;
          Row3.Visible  = false;
          Row16.Visible = false;
          break;
        case &quot;4&quot;: Row2.Visible  = true;
          Row3.Visible  = true;
          Row16.Visible = false;
          break;
        default: Row2.Visible  = true;
          Row3.Visible  = true;
          Row16.Visible = true;
          break;
      }
      
      
      
    }    
  }
}
</ScriptText>
  <Dictionary>
    <OracleDataConnection Name="Connection" ConnectionString="rijcmlq9SEZoacNJntaKIKp6mVF15TE2eO7inhdLIlr+Rbwy/H6LEj7kAn54PUVn+jTwAVmRkkIrXRpq0t8+liWzP4OozQ05UMbU3UiCJNL3AzWru0=">
      <TableDataSource Name="Table" DataType="System.Int32" Enabled="true" SelectCommand="select '[GetVal(&quot;'||id||'&quot;)]' as form, id, name , ssql  from DOC_ATTR where id like 'SKR%'">
        <Column Name="ID" DataType="System.String"/>
        <Column Name="NAME" DataType="System.String"/>
        <Column Name="SSQL" DataType="System.String"/>
        <Column Name="FORM" DataType="System.String"/>
      </TableDataSource>
    </OracleDataConnection>
    <Parameter Name="p_nd" DataType="System.Int32" Expression="10730201"/>
  </Dictionary>
  <ReportPage Name="Page1" RawPaperSize="9" LeftMargin="20" FirstPageSource="15" OtherPagesSource="15" Guides="0,680.4,340.2">
    <ReportTitleBand Name="ReportTitle1" Width="680.4" Height="9.45"/>
    <PageHeaderBand Name="PageHeader1" Top="11.74" Width="680.4" Height="9.45"/>
    <DataBand Name="Data1" Top="23.47" Width="680.4" Height="859.95" Guides="0,822.15,18.9,207.9,274.05,292.95,311.85,378,491.4,113.4,567,585.9,604.8,614.25,633.15,784.35,803.25">
      <TableObject Name="Table1" Width="680.4" Height="859.95">
        <TableColumn Name="Column1" Width="340.2"/>
        <TableColumn Name="Column2" Width="340.2"/>
        <TableRow Name="Row1" Height="66.15" AutoSize="true">
          <TableCell Name="Cell1"/>
          <TableCell Name="Cell2" Text="Керівнику &lt;b&gt;_____________________________________[GetVal(&quot;SKRN_STAF_STAFF-&quot;)]&lt;/b&gt;&#13;&#10;Назва установи банку   &lt;b&gt;[GetVal(&quot;DPT_NAME_BRANCH&quot;)]&lt;/b&gt;" Font="Times New Roman, 10pt" HtmlTags="true"/>
        </TableRow>
        <TableRow Name="Row2" Height="113.4" AutoSize="true">
          <TableCell Name="Cell6" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell7" Text="&#13;&#10;Клієнт Банку - фізична особа &#13;&#10;&lt;b&gt;[GetVal(&quot;SKRN_FIO&quot;)]&lt;/b&gt;&#13;&#10;Паспортні дані: серія &lt;b&gt;[GetVal(&quot;SKRN_PASP&quot;)]&lt;/b&gt;, &#13;&#10;дата  видачі &lt;b&gt;[GetVal(&quot;SKRN_ATRT&quot;)]&lt;/b&gt;&#13;&#10;Адреса: &lt;b&gt;[GetVal(&quot;SKRN_ADRES&quot;)]&lt;/b&gt;&#13;&#10;Номер телефону: &lt;b&gt;[GetVal(&quot;SKRN_TEL&quot;)]&lt;/b&gt;&#13;&#10;&#13;&#10;" Font="Times New Roman, 10pt" HtmlTags="true"/>
        </TableRow>
        <TableRow Name="Row3" Height="66.15" AutoSize="true">
          <TableCell Name="Cell11" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell12" Text="&#13;&#10;Клієнт Банку - фізична особа &#13;&#10;&lt;b&gt;[GetVal(&quot;SKRN_FIO_CL2&quot;)]&lt;/b&gt;&#13;&#10;Паспортні дані: серія &lt;b&gt;[GetVal(&quot;SKRN_PASP_CL2&quot;)]&lt;/b&gt;, &#13;&#10;дата  видачі &lt;b&gt;[GetVal(&quot;SKRN_ATTR_CL2&quot;)]&lt;/b&gt;&#13;&#10;Адреса: &lt;b&gt;[GetVal(&quot;SKRN_ADRES_CL2&quot;)]&lt;/b&gt;" Font="Times New Roman, 10pt" HtmlTags="true"/>
        </TableRow>
        <TableRow Name="Row16" Height="47.25" AutoSize="true">
          <TableCell Name="Cell43"/>
          <TableCell Name="Cell44" Text="Клієнт Банку - юридична особа &#13;&#10;&lt;b&gt;[GetVal(&quot;SKRN_FIO&quot;)]&lt;/b&gt;&#13;&#10;в особі [GetVal(&quot;SKRN_FIO_PREDST&quot;)]&#13;&#10;Паспортні дані: серія &lt;b&gt;[GetVal(&quot;SKRN_PASP_PREDST&quot;)]&lt;/b&gt;, &#13;&#10;[GetVal(&quot;SKRN_DOVER_PREDST&quot;)]&#13;&#10;" Font="Times New Roman, 10pt" HtmlTags="true"/>
        </TableRow>
        <TableRow Name="Row17">
          <TableCell Name="Cell45"/>
          <TableCell Name="Cell46"/>
        </TableRow>
        <TableRow Name="Row4">
          <TableCell Name="Cell16" Text="&lt;b&gt;З А Я В А  &lt;/b&gt;" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt" HtmlTags="true" ColSpan="2"/>
          <TableCell Name="Cell17" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row5">
          <TableCell Name="Cell21" Text="про втрату (пошкодження) ключа" HorzAlign="Center" Font="Times New Roman, 10pt, style=Bold" ColSpan="2"/>
          <TableCell Name="Cell22" HorzAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
        </TableRow>
        <TableRow Name="Row6" Height="66.15">
          <TableCell Name="Cell23" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell24" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row7" Height="113.4">
          <TableCell Name="Cell25" Text="                Повідомляю, що мною був втрачений (пошкоджений) ключ від індивідуального сейфа, який мені був наданий у тимчасове користування для зберігання цінностей і документів згідно договору  № &lt;b&gt;[GetVal(&quot;SKRN_ND&quot;)]&lt;/b&gt; від &lt;b&gt;[GetVal(&quot;SKRN_DATZ&quot;)]&lt;/b&gt;.&#13;&#10;        а) Прошу забезпечити відкриття індивідуального сейфа в моїй присутності.&#13;&#10;        б) Прошу забезпечити заміну замка від індивідуального сейфа, гарантую відшкодувати понесені установою банку витрати.&#13;&#10;        в) Прошу надати для зберігання цінностей інший індивідуальний сейф. &#13;&#10;" Font="Times New Roman, 10pt" HtmlTags="true" ColSpan="2"/>
          <TableCell Name="Cell26" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row8" Height="75.6">
          <TableCell Name="Cell27" Text="“__”_______________20__р." VertAlign="Bottom" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell28" Border.Lines="Bottom" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row9">
          <TableCell Name="Cell29" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell30" Text=" (підпис(и) клієнта(ів)&#13;&#10;" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row10">
          <TableCell Name="Cell31" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell32" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row11" Height="9.45">
          <TableCell Name="Cell33" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell34" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row12">
          <TableCell Name="Cell35" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell36" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row13" Height="151.2">
          <TableCell Name="Cell37" Text="Користування сейфом № &lt;b&gt;[GetVal(&quot;SKRN_NO&quot;)]&lt;/b&gt; закінчив,       &#13;&#10;ключ №  &lt;b&gt;[GetVal(&quot;SKRN_KEY&quot;)]&lt;/b&gt; здав.                           &#13;&#10;&#13;&#10;Претензій до Банку не маю.                           &#13;&#10;“__”_______________20__р.&#13;&#10;&#13;&#10;                                  __________________________                                                      (підпис клієнта)                                         &#13;&#10;" Font="Times New Roman, 10pt" HtmlTags="true"/>
          <TableCell Name="Cell38" Text="  Ключ № &lt;b&gt;[GetVal(&quot;SKRN_KEY&quot;)]&lt;/b&gt; &#13;&#10; від сейфа №&lt;b&gt;[GetVal(&quot;SKRN_NO&quot;)]&lt;/b&gt; одержав&#13;&#10;&#13;&#10; “___” ______________20__р.&#13;&#10;&#13;&#10;     _________________________________&#13;&#10;     (підпис відповідального працівника)&#13;&#10;" Font="Times New Roman, 10pt" HtmlTags="true"/>
        </TableRow>
        <TableRow Name="Row14">
          <TableCell Name="Cell39" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell40" Font="Times New Roman, 10pt" RowSpan="2"/>
        </TableRow>
        <TableRow Name="Row15">
          <TableCell Name="Cell41" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell42" Font="Times New Roman, 10pt"/>
        </TableRow>
      </TableObject>
    </DataBand>
    <PageFooterBand Name="PageFooter1" Top="885.71" Width="680.4" Height="18.9"/>
  </ReportPage>
</Report>
