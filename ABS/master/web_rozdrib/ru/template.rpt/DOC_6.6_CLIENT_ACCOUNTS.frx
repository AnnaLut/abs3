<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReferencedAssemblies="System.dll&#13;&#10;System.Drawing.dll&#13;&#10;System.Windows.Forms.dll&#13;&#10;System.Data.dll&#13;&#10;System.Xml.dll&#13;&#10;FastReport.Oracle.dll&#13;&#10;Oracle.DataAccess" ReportInfo.Created="05/20/2013 13:10:20" ReportInfo.Modified="10/03/2014 16:20:02" ReportInfo.CreatorVersion="2013.3.2.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;
using Oracle.DataAccess;

namespace FastReport
{
  public class ReportScript
  {
         /*
    private void Table4_ManualBuild(object sender, EventArgs e)
    {
      DataSourceBase rowData = Report.GetDataSource(&quot;acc_kl&quot;);
      rowData.Init();
      
      Table4.PrintRow(0);
      Table4.PrintColumns();
      
      int i = 0;
      
      while (rowData.HasMoreRows)
      {
        Table4.PrintRow(1);
        i++;
        Cell471.Text = Convert.ToString(i);
        if (Cell475.Text == &quot;980&quot;)
          Cell475.Text = Cell475.Text+&quot; (грн.)&quot;;
        /*switch (Cell475.Text)
        {
          case &quot;980&quot;:
            Cell475.Text = Cell475.Text+&quot; (грн.)&quot;;
            break;
          case &quot;840&quot;:
            Cell475.Text = Cell475.Text+&quot; (США)&quot;;
            break;
        }
        Table4.PrintColumns();
        
        rowData.Next();
      }
    }  */
  }
}
</ScriptText>
  <Dictionary>
    <OracleDataConnection Name="khrsn72" ConnectionString="rijcmlq9SEZoacNJntaKIKp6mVF12Jc6VA4pf/8RrGHV3rJ5fRI/+1i800gk2EU5LvmIVqP4R0Cw2jEV17btBGSD0tx9A==">
      <TableDataSource Name="Table" Alias="acc_kl" DataType="System.Int32" Enabled="true" SelectCommand="SELECT ROWNUM AS rwn, t.*&#13;&#10;  FROM (SELECT   f_ourmfo as mfo, brh.NAME AS name_branch, a.nls, t.NAME AS kv_name, t.kv&#13;&#10;            FROM wcs_bids b, accounts a, branch brh, tabval t&#13;&#10;           WHERE b.ID = :p_bid_id&#13;&#10;             AND a.rnk = b.rnk&#13;&#10;             AND a.branch = brh.branch&#13;&#10;             AND a.kv = t.kv&#13;&#10;             AND a.nbs in (2620, 2625, 2630, 2635)&#13;&#10;             AND a.dazs is null&#13;&#10;        ORDER BY a.branch, a.nls) t">
        <Column Name="NAME_BRANCH" DataType="System.String"/>
        <Column Name="NLS" DataType="System.String"/>
        <Column Name="KV" DataType="System.Int16"/>
        <Column Name="RWN" DataType="System.Decimal"/>
        <Column Name="MFO" DataType="System.String"/>
        <Column Name="KV_NAME" DataType="System.String"/>
        <CommandParameter Name="p_bid_id" DataType="113" Expression="[p_bid_id]" DefaultValue="-1"/>
      </TableDataSource>
      <TableDataSource Name="Table1" Alias="DataSubProdukt" DataType="System.Int32" Enabled="true" SelectCommand="select b.*,&#13;&#10;       wcs_utl.get_answ_formated(b.bid_id, 'CL_13') || ' ' ||&#13;&#10;       wcs_utl.get_answ_formated(b.bid_id, 'CL_14') || ' ' ||&#13;&#10;       wcs_utl.get_answ_formated(b.bid_id, 'CL_15') || ' ' ||&#13;&#10;       wcs_utl.get_answ_formated(b.bid_id, 'CL_16') as adr,&#13;&#10;       wcs_utl.get_answ_formated(b.bid_id, 'REPAYMENT_METHOD') as REPAYMENT_METHOD_P,&#13;&#10;       wcs_utl.get_answ_formated(b.bid_id, 'CREDIT_CURRENCY') as CREDIT_CURRENCY_P,&#13;&#10;       f_sumpr(b.summ * 100, t.kv, T.GENDER) as ssum_pr,&#13;&#10;       B.OWN_FUNDS + b.summ as all_sum_t,&#13;&#10;       f_sumpr((B.OWN_FUNDS + b.summ) * 100, t.kv, T.GENDER) as ALL_ssum_pr,&#13;&#10;       f_sumpr(B.OWN_FUNDS * 100, t.kv, T.GENDER) as OWN_FUNDS_pr,&#13;&#10;       d.sdate,&#13;&#10;       substr(f_dat_lit(d.sdate), 1, 25) as dat_dog_pr,&#13;&#10;       d.wdate,&#13;&#10;       substr(f_dat_lit(d.wdate), 1, 25) dat_dog_ret_pr,&#13;&#10;       substr(f_sumpr(interest_rate, '', 'M'), 1, 100) interest_rate_pr,&#13;&#10;       substr(f_sumpr(term, '', 'M'), 1, 100) term_pr,&#13;&#10;       substr(f_sumpr(SINGLE_FEE, '', 'M'), 1, 100) SINGLE_FEE_PR,&#13;&#10;       substr(f_sumpr(MONTHLY_FEE, '', 'M'), 1, 100) MONTHLY_FEE_PR,&#13;&#10;       wcs_utl.get_creditdata(b.bid_id, 'DEAL_NUMBER') as deal_number,&#13;&#10;       (decode((select s.PRODUCT_ID from WCS_SUBPRODUCTS s where s.ID=b.SUBPRODUCT_ID),&#13;&#10;       'PRD_BPK','кредит БПК',&#13;&#10;       'PRD_HULL_INSURANCE','договору відновлювальної кредитної лінії',&#13;&#10;       case when b.SUBPRODUCT_ID in('SBP_CONSUMER_0_5_2_EP','SBP_CONSUMER_5_10_2_EP') then 'договору відновлювальної        кредитної лінії' else 'кредитного договору'&#13;&#10;        end)) as vyd_cred&#13;&#10;  from v_wcs_bids b, tabval t, cc_deal d&#13;&#10; where b.bid_id = :p_bid_id   and b.bid_id = d.nd(+)&#13;&#10;   and B.CREDIT_CURRENCY = T.lcv">
        <Column Name="BID_ID" DataType="System.Decimal"/>
        <Column Name="SUBPRODUCT_ID" DataType="System.String"/>
        <Column Name="SUBPRODUCT_NAME" DataType="System.String"/>
        <Column Name="SUBPRODUCT_DESC" DataType="System.String"/>
        <Column Name="CRT_DATE" DataType="System.DateTime"/>
        <Column Name="F" DataType="System.String"/>
        <Column Name="I" DataType="System.String"/>
        <Column Name="O" DataType="System.String"/>
        <Column Name="FIO" DataType="System.String"/>
        <Column Name="BDATE" DataType="System.DateTime"/>
        <Column Name="INN" DataType="System.String"/>
        <Column Name="SUMM" DataType="System.Decimal"/>
        <Column Name="OWN_FUNDS" DataType="System.Decimal"/>
        <Column Name="TERM" DataType="System.String"/>
        <Column Name="CREDIT_CURRENCY" DataType="System.String"/>
        <Column Name="SINGLE_FEE" DataType="System.Decimal"/>
        <Column Name="MONTHLY_FEE" DataType="System.Decimal"/>
        <Column Name="INTEREST_RATE" DataType="System.Decimal"/>
        <Column Name="REPAYMENT_METHOD" DataType="System.String"/>
        <Column Name="REPAYMENT_METHOD_TEXT" DataType="System.String"/>
        <Column Name="REPAYMENT_DAY" DataType="System.Decimal"/>
        <Column Name="GARANTEES" DataType="System.String"/>
        <Column Name="MGR_ID" DataType="System.Decimal"/>
        <Column Name="MGR_FIO" DataType="System.String"/>
        <Column Name="BRANCH" DataType="System.String"/>
        <Column Name="BRANCH_NAME" DataType="System.String"/>
        <Column Name="BRANCH_HIERARCHY" DataType="System.String"/>
        <Column Name="STATES" DataType="System.String"/>
        <Column Name="INIT_PAYMENT_MTD" DataType="System.String"/>
        <Column Name="ADR" DataType="System.String"/>
        <Column Name="REPAYMENT_METHOD_P" DataType="System.String"/>
        <Column Name="CREDIT_CURRENCY_P" DataType="System.String"/>
        <Column Name="SSUM_PR" DataType="System.String"/>
        <Column Name="ALL_SUM_T" DataType="System.Decimal"/>
        <Column Name="ALL_SSUM_PR" DataType="System.String"/>
        <Column Name="OWN_FUNDS_PR" DataType="System.String"/>
        <Column Name="SDATE" DataType="System.DateTime"/>
        <Column Name="DAT_DOG_PR" DataType="System.String"/>
        <Column Name="WDATE" DataType="System.DateTime"/>
        <Column Name="DAT_DOG_RET_PR" DataType="System.String"/>
        <Column Name="INTEREST_RATE_PR" DataType="System.String"/>
        <Column Name="TERM_PR" DataType="System.String"/>
        <Column Name="SINGLE_FEE_PR" DataType="System.String"/>
        <Column Name="MONTHLY_FEE_PR" DataType="System.String"/>
        <Column Name="DEAL_NUMBER" DataType="System.String"/>
        <Column Name="RNK" DataType="System.Decimal"/>
        <Column Name="VYD_CRED" DataType="System.String"/>
        <CommandParameter Name="p_bid_id" DataType="126" Expression="[p_bid_id]"/>
      </TableDataSource>
      <TableDataSource Name="Table2" Alias="klient_info" DataType="System.Int32" Enabled="true" SelectCommand="select b.fio as fio,&#13;&#10;       wcs_utl.get_answ(b.bid_id, 'CL_123_O') as fio_o,&#13;&#10;       substr(b.i, 1, 1) || '. ' || substr(b.o, 1, 1) || '. ' || b.f as fio_short,&#13;&#10;       case&#13;&#10;           when wcs_utl.get_answ(b.bid_id, 'CL_13') in (26, 27) then&#13;&#10;           wcs_utl.get_answ_refer_text(b.bid_id, 'CL_13') || ', ' ||&#13;&#10;           wcs_utl.get_answ(b.bid_id, 'CL_16')&#13;&#10;           else&#13;&#10;              'обл. ' || wcs_utl.get_answ_refer_text(b.bid_id, 'CL_13') || ', ' ||&#13;&#10;              decode(wcs_utl.has_answ(b.bid_id, 'CL_14'),&#13;&#10;                          1,&#13;&#10;                          'р. ' || wcs_utl.get_answ(b.bid_id, 'CL_14') || ', ',&#13;&#10;                          null) || decode(wcs_utl.has_answ(b.bid_id, 'CL_15'),&#13;&#10;                                                 1,&#13;&#10;                                                 wcs_utl.get_answ(b.bid_id, 'CL_15') || ', ',&#13;&#10;                                                 null) ||&#13;&#10;                          wcs_utl.get_answ(b.bid_id, 'CL_16')&#13;&#10;            end as adress,&#13;&#10;       wcs_utl.get_answ(b.bid_id, 'CODE_002') idcode,&#13;&#10;       wcs_utl.get_answ(b.bid_id, 'CL_7') ||&#13;&#10;       wcs_utl.get_answ(b.bid_id, 'CL_8') || ' виданий ' ||&#13;&#10;       wcs_utl.get_answ(b.bid_id, 'CL_9') || ' ' ||&#13;&#10;       wcs_utl.get_answ(b.bid_id, 'CL_11') pasport&#13;&#10;  from v_wcs_bids b &#13;&#10; where b.bid_id = :p_bid_id">
        <Column Name="FIO" DataType="System.String"/>
        <Column Name="FIO_O" DataType="System.String"/>
        <Column Name="FIO_SHORT" DataType="System.String"/>
        <Column Name="ADRESS" DataType="System.String"/>
        <Column Name="IDCODE" DataType="System.String"/>
        <Column Name="PASPORT" DataType="System.String"/>
        <CommandParameter Name="p_bid_id" DataType="126" Expression="[p_bid_id]"/>
      </TableDataSource>
      <TableDataSource Name="Table3" Alias="Branch_Info" DataType="System.Int32" Enabled="true" SelectCommand="SELECT *&#13;&#10;  FROM (  SELECT poa.fio AS br_boss,&#13;&#10;                 poa.fio_r AS br_boss_r,&#13;&#10;                 poa.post_r AS post_r,&#13;&#10;                 poa.branch_adr AS adr_branch,&#13;&#10;                 poa.poa_doc AS br_boss_doc_r,&#13;&#10;                 poa.poa_notary_num AS br_boss_doc,&#13;&#10;                 poa_notary AS br_boss_doc_n,&#13;&#10;                 poa_notary_num AS br_boss_doc_n_r,&#13;&#10;                 poa_date AS br_boss_doc_d,&#13;&#10;                 branch_loc AS br_location,&#13;&#10;                 branch_name AS name_branch,&#13;&#10;                 f_ourmfo_g AS mfo,&#13;&#10;                 f_ourokpo AS okpo&#13;&#10;            FROM wcs_bids b, wcs_power_of_attorneys poa&#13;&#10;           WHERE b.id = :p_bid_id AND b.branch = poa.branch AND poa.active = 1&#13;&#10;        ORDER BY poa.ord)&#13;&#10;WHERE ROWNUM = 1">
        <Column Name="BR_BOSS" DataType="System.String"/>
        <Column Name="BR_BOSS_R" DataType="System.String"/>
        <Column Name="POST_R" DataType="System.String"/>
        <Column Name="ADR_BRANCH" DataType="System.String"/>
        <Column Name="BR_BOSS_DOC_R" DataType="System.String"/>
        <Column Name="BR_BOSS_DOC" DataType="System.String"/>
        <Column Name="BR_BOSS_DOC_N" DataType="System.String"/>
        <Column Name="BR_BOSS_DOC_N_R" DataType="System.String"/>
        <Column Name="BR_BOSS_DOC_D" DataType="System.DateTime"/>
        <Column Name="BR_LOCATION" DataType="System.String"/>
        <Column Name="NAME_BRANCH" DataType="System.String"/>
        <Column Name="MFO" DataType="System.String"/>
        <Column Name="OKPO" DataType="System.String"/>
        <CommandParameter Name="p_bid_id" DataType="126" Expression="[p_bid_id]"/>
      </TableDataSource>
    </OracleDataConnection>
    <Parameter Name="p_bid_id" DataType="System.Int32" Expression="3548521"/>
    <Parameter Name="p_ws_id" DataType="System.String" Expression="&quot;MAIN&quot;"/>
    <Parameter Name="p_ws_number" DataType="System.Int32" Expression="0"/>
  </Dictionary>
  <ReportPage Name="Page1">
    <ReportTitleBand Name="ReportTitle1" Width="718.2" Height="94.5" Guides="47.25">
      <TextObject Name="Text4" Left="9.45" Top="9.45" Width="699.3" Height="56.7" Text="Додаток № 4 &#13;&#10;до [DataSubProdukt.VYD_CRED] №[DataSubProdukt.DEAL_NUMBER] від [DataSubProdukt.DAT_DOG_PR]" HorzAlign="Right" Font="Times New Roman, 10pt, style=Bold"/>
      <TextObject Name="Text5" Left="9.45" Top="66.15" Width="699.3" Height="18.9" Fill.Color="Gainsboro" Text="Перелік рахунків Позичальника" HorzAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
    </ReportTitleBand>
    <DataBand Name="Data1" Top="148.71" Width="718.2" Height="37.8" CanGrow="true" CanShrink="true" DataSource="Table">
      <TableObject Name="Table4" Left="9.45" Width="699.3" Height="37.8">
        <TableColumn Name="Column3" Width="35.91"/>
        <TableColumn Name="Column4" Width="262.71"/>
        <TableColumn Name="Column5" Width="149.31"/>
        <TableColumn Name="Column6" Width="130.41"/>
        <TableColumn Name="Column7" Width="120.96"/>
        <TableRow Name="Row227" Height="37.8">
          <TableCell Name="Cell471" Border.Lines="All" Text="[acc_kl.RWN]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell472" Border.Lines="All" Text="[Branch_Info.NAME_BRANCH]" VertAlign="Center" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell473" Border.Lines="All" Text="[acc_kl.MFO]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell474" Border.Lines="All" Text="[acc_kl.NLS]" VertAlign="Center" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell475" Border.Lines="All" Text="[acc_kl.KV_NAME] ([acc_kl.KV])" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt"/>
        </TableRow>
      </TableObject>
      <DataHeaderBand Name="DataHeader1" Top="97.98" Width="718.2" Height="47.25">
        <TableObject Name="Table4" Left="9.45" Width="699.3" Height="47.25">
          <TableColumn Name="Column13" Width="35.91"/>
          <TableColumn Name="Column14" Width="262.71"/>
          <TableColumn Name="Column15" Width="149.31"/>
          <TableColumn Name="Column16" Width="130.41"/>
          <TableColumn Name="Column17" Width="120.96"/>
          <TableRow Name="Row229" Height="47.25">
            <TableCell Name="Cell481" Border.Lines="All" Fill.Color="Gainsboro" Text="№&#13;&#10;п/п" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
            <TableCell Name="Cell482" Border.Lines="All" Fill.Color="Gainsboro" Text="Найменування банку" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
            <TableCell Name="Cell483" Border.Lines="All" Fill.Color="Gainsboro" Text="Код банку" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
            <TableCell Name="Cell484" Border.Lines="All" Fill.Color="Gainsboro" Text="№ рахунку" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
            <TableCell Name="Cell485" Border.Lines="All" Fill.Color="Gainsboro" Text="Назва валюти, в якій відкритий рахунок" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
          </TableRow>
        </TableObject>
      </DataHeaderBand>
      <DataFooterBand Name="DataFooter1" Top="189.98" Width="718.2" Height="284.5">
        <TableObject Name="Table10" Left="28.35" Top="9.45" Width="661.54" Height="265.6" RepeatHeaders="false">
          <TableColumn Name="Column1" Width="330.77"/>
          <TableColumn Name="Column2" Width="330.77"/>
          <TableRow Name="Row225">
            <TableCell Name="Cell464" HorzAlign="Center" Font="Times New Roman, 12pt" HtmlTags="true" ColSpan="2"/>
            <TableCell Name="Cell465"/>
          </TableRow>
          <TableRow Name="Row1" Height="37.8">
            <TableCell Name="Cell1" Border.Lines="All" Fill.Color="Gainsboro" Text="Банк" HorzAlign="Center" Font="Times New Roman, 14pt"/>
            <TableCell Name="Cell2" Border.Lines="All" Fill.Color="Gainsboro" Text="Позичальник" HorzAlign="Center" Font="Times New Roman, 14pt"/>
          </TableRow>
          <TableRow Name="Row8" Height="67.15" AutoSize="true">
            <TableCell Name="Cell18" Border.Lines="Left, Right, Top" Text="публічне акціонерне товариство &quot;Державний ощадний банк України&quot;&#13;&#10; [Branch_Info.NAME_BRANCH]&#10;" HorzAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
            <TableCell Name="Cell19" Border.Lines="Left, Right, Top" Text="&#13;&#10;[klient_info.FIO]" HorzAlign="Center" Font="Times New Roman, 12pt, style=Bold"/>
          </TableRow>
          <TableRow Name="Row230" Height="85.05">
            <TableCell Name="Cell486" Border.Lines="Left, Right" Text="&#13;&#10;&#13;&#10;_____________________________&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;" HorzAlign="Center"/>
            <TableCell Name="Cell487" Border.Lines="Left, Right" Text="&#13;&#10;&#13;&#10;_____________________________&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;" HorzAlign="Center"/>
          </TableRow>
          <TableRow Name="Row231" Height="56.7">
            <TableCell Name="Cell488" Border.Lines="Left, Right, Bottom" Text="	М.П."/>
            <TableCell Name="Cell489" Border.Lines="Left, Right, Bottom"/>
          </TableRow>
        </TableObject>
      </DataFooterBand>
    </DataBand>
    <PageFooterBand Name="PageFooter1" Top="477.96" Width="718.2" Height="37.8">
      <TextObject Name="Text1" Left="9.45" Width="179.55" Height="28.35" Text="Банк________________  		                  " HorzAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
      <TextObject Name="Text2" Left="415.8" Width="207.9" Height="28.35" Text="Позичальник ________________" HorzAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
      <TextObject Name="Text3" Left="633.15" Width="56.7" Height="28.35" Text="[Page#]" HorzAlign="Center" Font="Times New Roman, 10pt"/>
    </PageFooterBand>
  </ReportPage>
</Report>
