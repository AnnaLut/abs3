<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReportInfo.Created="04/05/2016 16:30:44" ReportInfo.Modified="05/05/2017 13:31:07" ReportInfo.CreatorVersion="2014.3.2.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;

namespace FastReport
{
  public class ReportScript
  {
    public String PERIOD
    {
      get 
      {
        DateTime DateFrom = ((DateTime)Report.GetParameterValue(&quot;sFdat1&quot;));
        DateTime DateTo = ((DateTime)Report.GetParameterValue(&quot;sFdat2&quot;));
      
        TimeSpan ts = DateTo - DateFrom; // Difference in days, hours, and minutes.
        int differenceInDays = ts.Days; // Difference in days.
        if (differenceInDays == 0)
        {
          return (&quot;за &quot; + ((DateTime)Report.GetParameterValue(&quot;sFdat1&quot;)).ToString(&quot;dd.MM.yyyy&quot;));
        }
        else
        {
          return (&quot;за період з &quot; + ((DateTime)Report.GetParameterValue(&quot;sFdat1&quot;)).ToString(&quot;dd.MM.yyyy&quot;) + &quot; по &quot; + ((DateTime)Report.GetParameterValue(&quot;sFdat2&quot;)).ToString(&quot;dd.MM.yyyy&quot;));
        }
      }
    }
  }
}
</ScriptText>
  <Dictionary>
    <OracleDataConnection Name="SBERDEV" ConnectionString="rijcmlqHytUMhhPg9gG4fal5Q6rRB0BvRbh0nDbCWvtDA1bLoXawgQMNksAJZokM+/w71MdFsM+YEJ6NgGKWNhwTjoC2g==">
      <TableDataSource Name="Table" DataType="System.Int32" Enabled="true" SelectCommand="select rownum as npp,&#13;&#10;       c.corporation_name,&#13;&#10;       case when b.mfou = 300465 then b.mfo else null end as mfo_obu,&#13;&#10;       case when b.mfou != 300465 then b.mfo else null end as mfo_other,&#13;&#10;       case when b.mfou != 300465 then b.nb else null end as nb_other,&#13;&#10;       cd.okpoa,&#13;&#10;       cd.nama,&#13;&#10;       nvl(cd.sq / 100,0) as sq&#13;&#10;  from banks$base b, V_ORG_corporationS c, ob_corporation_data cd&#13;&#10; where cd.mfoa = b.mfo&#13;&#10;   and c.external_id = cd.kod_ustan and c.base_extid=cd.corporation_id&#13;&#10;   and cd.rowtype = 1&#13;&#10;   and cd.DOCTYPE = 1&#13;&#10;   and',' || decode(replace(:mfo, ' ', ''), '%', cd.kf, replace(:mfo, ' ', '')) || ',' like '%,' || cd.kf || ',%'&#13;&#10;   and cd.corporation_id = :corp_id&#13;&#10;   and kfile_pack.get_correct_session_id(corporation_id,kf,session_id)=1&#13;&#10;   and kfile_pack.get_correct_nbs(corporation_id,substr(nls,1,4))=1&#13;&#10;   and cd.file_date BETWEEN TRUNC(:date_start, 'DDD') AND TRUNC(:date_end, 'DDD')&#13;&#10;   and cd.nls = cd.nlsb&#13;&#10;   and substr(cd.nlsb, 1, 4) = '2603'&#13;&#10;   and substr(cd.nlsa, 1, 4) in ('2600', '2602', '2604', '2063', '2610', '2520', '2541', '2542', '2650')&#13;&#10;   and ',' || decode(replace(:a_code, ' ', ''), '%', cd.kod_analyt, replace(:a_code, ' ', '')) || ',' like '%,' || cd.kod_analyt || ',%'">
        <Column Name="NPP" DataType="System.Decimal"/>
        <Column Name="CORPORATION_NAME" DataType="System.String"/>
        <Column Name="MFO_OBU" DataType="System.String"/>
        <Column Name="MFO_OTHER" DataType="System.String"/>
        <Column Name="NB_OTHER" DataType="System.String"/>
        <Column Name="OKPOA" DataType="System.String"/>
        <Column Name="NAMA" DataType="System.String"/>
        <Column Name="SQ" DataType="System.Decimal"/>
        <CommandParameter Name="mfo" DataType="126" Expression="[KF]" DefaultValue="000000"/>
        <CommandParameter Name="date_start" DataType="106" Expression="[sFdat1]" DefaultValue="01.01.1900"/>
        <CommandParameter Name="date_end" DataType="106" Expression="[sFdat2]" DefaultValue="01.01.1900"/>
        <CommandParameter Name="a_code" DataType="126" Expression="[kod_analyt]"/>
        <CommandParameter Name="corp_id" DataType="113" Expression="[Param0]" DefaultValue="0"/>
      </TableDataSource>
      <TableDataSource Name="Table3" DataType="System.Int32" Enabled="true" SelectCommand="select c.corporation_name from ob_corporation c where c.id = :corp_id">
        <Column Name="CORPORATION_NAME" DataType="System.String"/>
        <CommandParameter Name="corp_id" DataType="113" Expression="[Param0]" DefaultValue="0"/>
      </TableDataSource>
      <TableDataSource Name="Table4" DataType="System.Int32" Enabled="true" SelectCommand="select b.name from clim_mfo b where b.mfo = :mfo">
        <Column Name="NAME" DataType="System.String"/>
        <CommandParameter Name="mfo" DataType="126" Expression="[KF]" DefaultValue="000000"/>
      </TableDataSource>
    </OracleDataConnection>
    <Parameter Name="Param0" DataType="System.Int64"/>
    <Parameter Name="KF" DataType="System.String"/>
    <Parameter Name="kod_analyt" DataType="System.String"/>
    <Parameter Name="sFdat1" DataType="System.DateTime"/>
    <Parameter Name="sFdat2" DataType="System.DateTime"/>
  </Dictionary>
  <ReportPage Name="Page1" Landscape="true" PaperWidth="297" PaperHeight="210" RawPaperSize="9" FirstPageSource="15" OtherPagesSource="15">
    <ReportTitleBand Name="ReportTitle1" Width="1047.06" Height="103.95">
      <TableObject Name="Table1" Top="56.7" Width="1048.95" Height="47.25">
        <TableColumn Name="Column1" Width="37.8"/>
        <TableColumn Name="Column2" Width="226.8"/>
        <TableColumn Name="Column3" Width="75.6"/>
        <TableColumn Name="Column4" Width="75.6"/>
        <TableColumn Name="Column5" Width="226.8"/>
        <TableColumn Name="Column6" Width="103.95"/>
        <TableColumn Name="Column7" Width="189"/>
        <TableColumn Name="Column8" Width="113.4"/>
        <TableRow Name="Row1" Height="28.35">
          <TableCell Name="Cell1" Border.Lines="All" Fill.Color="DarkGray" Text="№ з/п" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell2" Border.Lines="All" Fill.Color="DarkGray" Text="Назва клієнта - отримувача" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell3" Border.Lines="All" Fill.Color="DarkGray" Text="МФО Ощадбанку" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell4" Border.Lines="All" Fill.Color="DarkGray" Text="МФО інші банки" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell5" Border.Lines="All" Fill.Color="DarkGray" Text="Назва іншого банку платника" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell26" Border.Lines="All" Fill.Color="DarkGray" Text="ЄДРПОУ клієнта-платника" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell27" Border.Lines="All" Fill.Color="DarkGray" Text="Назва клієнта-платника" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell28" Border.Lines="All" Fill.Color="DarkGray" Text="Кредитовий оборот" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
        </TableRow>
        <TableRow Name="Row2">
          <TableCell Name="Cell6" Border.Lines="All" Fill.Color="DarkGray" Text="1" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell7" Border.Lines="All" Fill.Color="DarkGray" Text="2" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell8" Border.Lines="All" Fill.Color="DarkGray" Text="3" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell9" Border.Lines="All" Fill.Color="DarkGray" Text="4" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell10" Border.Lines="All" Fill.Color="DarkGray" Text="5" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell29" Border.Lines="All" Fill.Color="DarkGray" Text="6" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell30" Border.Lines="All" Fill.Color="DarkGray" Text="7" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell31" Border.Lines="All" Fill.Color="DarkGray" Text="8" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
        </TableRow>
      </TableObject>
      <TextObject Name="Text1" Width="1048.95" Height="18.9" Text="Інформація" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text2" Top="18.9" Width="1048.95" Height="18.9" Text="щодо бази клієнтів-платників ПЕК ([Table3.CORPORATION_NAME])" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text3" Top="37.8" Width="1048.95" Height="18.9" Text="[PERIOD] по [Table4.NAME] регіональному управлінню" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
    </ReportTitleBand>
    <DataBand Name="Data1" Top="107.95" Width="1047.06" Height="18.9" CanGrow="true" DataSource="Table" KeepTogether="true">
      <TableObject Name="Table2" Width="1048.95" Height="18.9" Border.Lines="All" CanBreak="false">
        <TableColumn Name="Column9" Width="37.8"/>
        <TableColumn Name="Column10" Width="226.8"/>
        <TableColumn Name="Column11" Width="75.6"/>
        <TableColumn Name="Column12" Width="75.6"/>
        <TableColumn Name="Column13" Width="226.8"/>
        <TableColumn Name="Column14" Width="103.95"/>
        <TableColumn Name="Column15" Width="189"/>
        <TableColumn Name="Column16" Width="113.4"/>
        <TableRow Name="Row3" AutoSize="true">
          <TableCell Name="Cell32" Border.Lines="All" Text="[Table.NPP]" VertAlign="Center" Font="Arial, 8pt"/>
          <TableCell Name="Cell33" Border.Lines="All" Text="[Table.CORPORATION_NAME]" VertAlign="Center" Font="Arial, 8pt"/>
          <TableCell Name="Cell34" Border.Lines="All" Text="[Table.MFO_OBU]" VertAlign="Center" Font="Arial, 8pt"/>
          <TableCell Name="Cell35" Border.Lines="All" Text="[Table.MFO_OTHER]" VertAlign="Center" Font="Arial, 8pt"/>
          <TableCell Name="Cell36" Border.Lines="All" Text="[Table.NB_OTHER]" VertAlign="Center" Font="Arial, 8pt"/>
          <TableCell Name="Cell57" Border.Lines="All" Text="[Table.OKPOA]" VertAlign="Center" Font="Arial, 8pt"/>
          <TableCell Name="Cell58" Border.Lines="All" Text="[Table.NAMA]" VertAlign="Center" Font="Arial, 8pt"/>
          <TableCell Name="Cell59" Border.Lines="All" Text="[Table.SQ]" VertAlign="Center" Font="Arial, 8pt"/>
        </TableRow>
      </TableObject>
      <Sort>
        <Sort Expression="[Table.NPP]"/>
      </Sort>
    </DataBand>
  </ReportPage>
</Report>
