

PROMPT ===================================================================================== 
PROMPT *** Run *** ========== Scripts /Sql/BARS/Procedure/BL_RRP_11.sql =========*** Run ***
PROMPT ===================================================================================== 


PROMPT *** Create  procedure BL_RRP_11 ***

  CREATE OR REPLACE PROCEDURE BARS.BL_RRP_11 ( rc IN OUT NUMBER, kv IN NUMBER, 
mfoa_p IN VARCHAR2, mfoa IN VARCHAR2, nlsa IN VARCHAR2, 
mfob_p IN VARCHAR2, mfob IN VARCHAR2, nlsb IN VARCHAR2, 
dk IN NUMBER,  s IN NUMBER, 
id_a IN VARCHAR2 DEFAULT NULL, 
id_b IN VARCHAR2 DEFAULT NULL, 
 ref  IN NUMBER   DEFAULT NULL ) IS 
classa NUMBER := 0; 
classb NUMBER := 0; 
nbsa   VARCHAR2(4); 
nbsb   VARCHAR2(4); 
erm    VARCHAR2 (80); 
ern    CONSTANT POSITIVE := 715; 
err    EXCEPTION; 
BEGIN 
IF NOT C_OKPO(ID_B,NLSB)  AND MFOA<> GL.KF   AND  MFOB=GL.KF AND  SUBSTR( NLSB,1,4) NOT IN ('3570','2909','3578')  AND  DK  <> 2 THEN 
rc:=1; 
RETURN; 
END IF; 
IF (NLSB LIKE '2630%' OR NLSB LIKE '2635%') AND S < 20000 THEN 
rc:=12; 
RETURN; 
END IF; 
IF  NLSB  LIKE '0%' THEN 
rc:=20; 
RETURN; 
END IF; 
IF MFOB<>GL.KF    AND KV<> 980 AND DK=1  AND MFOB NOT IN (300465) THEN 
rc:=22; 
RETURN; 
END IF; 
IF NLSB LIKE '2603%'  AND ID_B IN ('00131305','23243188','40150221','32402870') AND F_BIZNESPR_NAZN(NAZN)>0 THEN 
rc:=25; 
RETURN; 
END IF; 
IF MFOB ='304706'  OR  MFOB ='304988'  THEN 
rc:=29; 
RETURN; 
END IF; 
IF NLSB IN ('256013141031','256013031031','256033011031','256023131031','256033121031') THEN 
rc:=32; 
RETURN; 
END IF; 
IF NLSB IN ('256053141017','256053031017','256073011017','256063131017','256073121017') THEN 
rc:=33; 
RETURN; 
END IF; 
IF NLSB IN ('256013141028','256013031028','256033011028','256023131028','256033121028') THEN 
rc:=34; 
RETURN; 
END IF; 
IF NLSB IN ('256093141006','256093031006','256013011006','256003131006','256013121006') THEN 
rc:=35; 
RETURN; 
END IF; 
IF NLSB IN ('256043141027','256043031027','256063011027','256053131027','256063121027') THEN 
rc:=36; 
RETURN; 
END IF; 
IF NLSB IN ('256053141004','256053031004','256073011004','256063131004','256073121004') THEN 
rc:=37; 
RETURN; 
END IF; 
IF NLSB IN ('256083121007','256073131007','256083011007','256063031007','256063141007') THEN 
rc:=39; 
RETURN; 
END IF; 
IF NLSB IN ('256003121029','256093131029','256003011029','256083031029','256083141029') THEN 
rc:=40; 
RETURN; 
END IF; 
IF NLSB IN ('256083121023','256073131023','256083011023','256063031023','256063141023') THEN 
rc:=41; 
RETURN; 
END IF; 
IF NLSB IN ('256073121033','256063131033','256073011033','256053031033','256053141033') THEN 
rc:=42; 
RETURN; 
END IF; 
IF (NLSA  LIKE '3510%' OR NLSA  LIKE '3519%' OR NLSA  LIKE '3400%'  OR NLSA  LIKE '3511%' OR NLSA  LIKE '44%' OR NLSA  LIKE '43%' OR NLSA  LIKE '45%')  AND (MFOA  IN ('320047','320069','320100','320122','320133','230166','320218','320229' )) AND S  >= 100 THEN 
rc:=44; 
RETURN; 
END IF; 
IF (NLSA  LIKE '3510%' OR NLSA  LIKE '3519%' OR NLSA  LIKE '3400%'  OR NLSA  LIKE '3511%' OR NLSA  LIKE '44%' OR NLSA  LIKE '43%' OR NLSA  LIKE '45%')  AND (MFOA  IN ('320230','320241','320326','320337','320382','320445','320553')) AND S  >= 10000 THEN 
rc:=45; 
RETURN; 
END IF; 
IF MFOB='384577'  AND NLSB IN ('25418000535051','254150006355051','25412000735051')  AND ID_B ='37978503' THEN 
rc:=47; 
RETURN; 
END IF; 
IF NLSB = 26032307201 THEN 
rc:=53; 
RETURN; 
END IF; 
IF NLSA LIKE '2602%' AND NLSB LIKE '2600%' AND KV<>980 THEN 
rc:=54; 
RETURN; 
END IF; 
IF MFOA = '322669'  AND MFOB = '322669'  AND ( DK  = 1 OR  DK = 0) THEN 
rc:=56; 
RETURN; 
END IF; 
IF MFOB IN ('324979','824509','324786','384986','384674','324021','324742','324935','384436','384577','324805','824026','399142','384919','384492','384760','384522','384652') AND S >= 50000000 THEN 
rc:=57; 
RETURN; 
END IF; 
IF MFOA IN ('324979','824509','324786','384986','384674','324021','324742','324935','384436','384577','324805','824026','399142','384919','384492','384760','384522','384652') AND S >= 50000000 THEN 
rc:=58; 
RETURN; 
END IF; 
IF  NLSB = 26004500766564 THEN 
rc:=59; 
RETURN; 
END IF; 
IF  NLSA = 26002301768912 THEN 
rc:=60; 
RETURN; 
END IF; 
IF  NLSB   LIKE  '3125%'   AND  MFOB <>820172 THEN 
rc:=61; 
RETURN; 
END IF; 
IF  NLSB = 260393010807 AND  NAZN  LIKE '%601%' THEN 
rc:=78; 
RETURN; 
END IF; 
IF F_BLK_CODCAGENT(NLSB,KV,99)=1 THEN 
rc:=777; 
RETURN; 
END IF; 
IF NLSA LIKE '1600%'  AND KV=980  AND MFOA<>GL.KF AND NLSB LIKE '2600%' THEN 
rc:=778; 
RETURN; 
END IF; 
IF F_BLK_VAL_CORP(NLSA,NLSB,KV,ID_A,ID_B)=1 AND MFOA<>GL.KF THEN 
rc:=779; 
RETURN; 
END IF; 
IF MFOB=GL.KF AND KV<>980 AND (NLSB LIKE '2600%' OR NLSB LIKE '2603%' OR NLSB LIKE '2650%') THEN 
rc:=799; 
RETURN; 
END IF; 
rc:=0; 
END bl_rrp_11;
/
show err;



PROMPT ===================================================================================== 
PROMPT *** End *** ========== Scripts /Sql/BARS/Procedure/BL_RRP_11.sql =========*** End ***
PROMPT ===================================================================================== 
