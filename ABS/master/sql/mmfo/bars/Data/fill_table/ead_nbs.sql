delete from EAD_NBS;
commit;
 
insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2512', 2, null, 'pr_uo', null, null, 1);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2520', 2, null, 'pr_uo', null, null, 2);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2523', 2, null, 'pr_uo', null, null, 3);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2526', 2, null, 'pr_uo', null, null, 5);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2530', 2, null, 'pr_uo', null, null, 6);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2531', 2, null, 'pr_uo', null, null, 7);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2541', 2, null, 'pr_uo', null, null, 8);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2542', 2, null, 'pr_uo', null, null, 9);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2544', 2, null, 'pr_uo', null, null, 10);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2545', 2, null, 'pr_uo', null, null, 11);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2550', 2, null, 'pr_uo', null, null, 13);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2551', 2, null, 'pr_uo', null, null, 14);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2552', 2, null, 'pr_uo', null, null, 15);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2553', 2, null, 'pr_uo', null, null, 16);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2554', 2, null, 'pr_uo', null, null, 17);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2555', 2, null, 'pr_uo', null, null, 18);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2556', 2, null, 'pr_uo', null, null, 19);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2560', 2, null, 'pr_uo', null, null, 20);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2561', 2, null, 'pr_uo', null, null, 21);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2562', 2, null, 'pr_uo', null, null, 22);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2570', 2, null, 'pr_uo', null, null, 23);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2571', 2, null, 'pr_uo', null, null, 24);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2572', 2, null, 'pr_uo', null, null, 25);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2600', 2, null, 'pr_uo', null, null, 27);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2601', 2, null, 'pr_uo', null, null, 28);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2602', 2, null, 'pr_uo', null, null, 29);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2603', 2, null, 'pr_uo', null, null, 30);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2604', 2, null, 'pr_uo', null, null, 31);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2605', 2, null, 'kpk_uo', null, null, 32);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2640', 2, null, 'pr_uo', null, null, 38);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2641', 2, null, 'pr_uo', null, null, 39);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2642', 2, null, 'pr_uo', null, null, 40);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2643', 2, null, 'pr_uo', null, null, 41);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2650', 2, null, 'pr_uo', null, null, 42);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2655', 2, null, 'kpk_uo', null, null, 45);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2525', 2, 'dep_uo', 'dep_uo', null, null, 4);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2546', 2, 'dep_uo', 'dep_uo', null, null, 12);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2610', 2, 'dep_uo', 'dep_uo', null, null, 33);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2611', 2, null, 'pr_uo', null, null, 34);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2651', 2, 'dep_uo', 'dep_uo', null, null, 44);
/*
--Лишнее
insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2909', 2, null, 'transit_uo', null, null, 48);
*/
insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2924', 2, null, 'transit_uo', null, null, 50);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2630', 3, null, null, null, null, 37);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2625', 3, null, 'bpk_fo', null, null, 36);
/*
--Лишнее
insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2620', 3, null, null, null, null, 35);
*/
insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2620', 3, null, 'bpk_fo', 'W4', null, 51);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2600', 2, null, 'kpk_uo', 'W4', null, 26);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2650', 2, null, 'kpk_uo', 'W4', null, 43);

/*
--COBUSUPABS-5266 Відключити формування повдомлень інтеграції за рахунками 2909 (ОБ22 = 43;67)
insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2909', 2, 'encashment_uo', 'transit_uo', null, '43', 47);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2909', 2, 'encashment_uo', 'transit_uo', null, '67', 46);
*/
insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2924', 2, 'acquiring_uo', 'transit_uo', null, '16', 49);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('2909', 2, 'salary_uo', 'transit_uo', null, '11', 52);

--COBUMMFO-8098 Передавати в ЕА повідомлення інтеграції за угодами та рахунками інкасації
insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('3578', 2, 'encashment_uo', 'encashment_uo', null, '09', 55);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('3578', 2, 'encashment_uo', 'encashment_uo', null, '17', 53);

insert into EAD_NBS (NBS, CUSTTYPE, AGR_TYPE, ACC_TYPE, TIP, OB22, ID)
values ('3578', 3, 'encashment_fo', 'encashment_fo', null, '15', 54);

commit;

-- COBUDPUMMSB-122

declare
    -- изменились ob22 для ММСБ
    -- на разных средах тип поля ID  разный (???)
    l_start_id  number := 666; -- генерим id от ... (чтобы не заморачиваться с предыдущими)
begin
    -- 6    terminable_dep_uo    Рахунок Строкового депозиту    Корпоративні клієнти
    -- 7    request_dep_uo       Рахунок Вкладу на вимогу       Корпоративні клієнти
    -- сделал через execute immediate не понятно когда уйдет в ПРОД (а объектов не будет)
    execute immediate q'[ 
    insert into ead_nbs (nbs, custtype, agr_type, acc_type, tip, ob22, id)
    select s.balance_account nbs
          ,2                 custtype
          ,'dbo_uo'          agr_type   
          ,case when ot.type_code = 'SMB_DEPOSIT_TRANCHE' then 'terminable_dep_uo' 
                when ot.type_code = 'SMB_DEPOSIT_ON_DEMAND'  then 'request_dep_uo' 
           end               acc_type
          ,null              tip
          ,ob22_code         ob22
          ,:p_start_id + rownum    id
      from deal_balance_account_settings s
          ,attribute_kind k
          ,deal_product p
          ,object_type ot
     where s.account_type_id = k.id
       and k.attribute_code = 'DEPOSIT_PRIMARY_ACCOUNT'
       and s.product_id = p.id
       and p.deal_type_id = ot.id
       and ot.type_code in ('SMB_DEPOSIT_TRANCHE', 'SMB_DEPOSIT_ON_DEMAND')]' using l_start_id;
       
    commit;
    exception 
         when others then if sqlcode = -942 then null; else raise; end if; 
end;
/