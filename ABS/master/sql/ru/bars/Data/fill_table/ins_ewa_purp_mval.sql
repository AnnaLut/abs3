MERGE INTO INS_EWA_PURP_MVAL A USING
 (SELECT
  1 as ID,
  'Бранч' as PURP_NAME,
  'root/contract/salePoint/code/text()' as PURP_VAL,
  NULL as ALT_PATH,
  NULL as ALT_PATH_COND,
  NULL as DEF_VAL
  FROM DUAL) B
ON (A.ID = B.ID)
WHEN NOT MATCHED THEN 
INSERT (
  ID, PURP_NAME, PURP_VAL, ALT_PATH, ALT_PATH_COND, 
  DEF_VAL)
VALUES (
  B.ID, B.PURP_NAME, B.PURP_VAL, B.ALT_PATH, B.ALT_PATH_COND, 
  B.DEF_VAL)
WHEN MATCHED THEN
UPDATE SET 
  A.PURP_NAME = B.PURP_NAME,
  A.PURP_VAL = B.PURP_VAL,
  A.ALT_PATH = B.ALT_PATH,
  A.ALT_PATH_COND = B.ALT_PATH_COND,
  A.DEF_VAL = B.DEF_VAL;
/
MERGE INTO INS_EWA_PURP_MVAL A USING
 (SELECT
  2 as ID,
  'ІД користувача' as PURP_NAME,
  'root/contract/customFields/item[code="m1"]/value/text()' as PURP_VAL,
  NULL as ALT_PATH,
  NULL as ALT_PATH_COND,
  NULL as DEF_VAL
  FROM DUAL) B
ON (A.ID = B.ID)
WHEN NOT MATCHED THEN 
INSERT (
  ID, PURP_NAME, PURP_VAL, ALT_PATH, ALT_PATH_COND, 
  DEF_VAL)
VALUES (
  B.ID, B.PURP_NAME, B.PURP_VAL, B.ALT_PATH, B.ALT_PATH_COND, 
  B.DEF_VAL)
WHEN MATCHED THEN
UPDATE SET 
  A.PURP_NAME = B.PURP_NAME,
  A.PURP_VAL = B.PURP_VAL,
  A.ALT_PATH = B.ALT_PATH,
  A.ALT_PATH_COND = B.ALT_PATH_COND,
  A.DEF_VAL = B.DEF_VAL;
/
MERGE INTO INS_EWA_PURP_MVAL A USING
 (SELECT
  3 as ID,
  'Розмір платежу' as PURP_NAME,
  'root/payment/payment/text()' as PURP_VAL,
  NULL as ALT_PATH,
  NULL as ALT_PATH_COND,
  NULL as DEF_VAL
  FROM DUAL) B
ON (A.ID = B.ID)
WHEN NOT MATCHED THEN 
INSERT (
  ID, PURP_NAME, PURP_VAL, ALT_PATH, ALT_PATH_COND, 
  DEF_VAL)
VALUES (
  B.ID, B.PURP_NAME, B.PURP_VAL, B.ALT_PATH, B.ALT_PATH_COND, 
  B.DEF_VAL)
WHEN MATCHED THEN
UPDATE SET 
  A.PURP_NAME = B.PURP_NAME,
  A.PURP_VAL = B.PURP_VAL,
  A.ALT_PATH = B.ALT_PATH,
  A.ALT_PATH_COND = B.ALT_PATH_COND,
  A.DEF_VAL = B.DEF_VAL;
/
MERGE INTO INS_EWA_PURP_MVAL A USING
 (SELECT
  4 as ID,
  'Комісія' as PURP_NAME,
  'root/payment/commission/text()' as PURP_VAL,
  NULL as ALT_PATH,
  NULL as ALT_PATH_COND,
  NULL as DEF_VAL
  FROM DUAL) B
ON (A.ID = B.ID)
WHEN NOT MATCHED THEN 
INSERT (
  ID, PURP_NAME, PURP_VAL, ALT_PATH, ALT_PATH_COND, 
  DEF_VAL)
VALUES (
  B.ID, B.PURP_NAME, B.PURP_VAL, B.ALT_PATH, B.ALT_PATH_COND, 
  B.DEF_VAL)
WHEN MATCHED THEN
UPDATE SET 
  A.PURP_NAME = B.PURP_NAME,
  A.PURP_VAL = B.PURP_VAL,
  A.ALT_PATH = B.ALT_PATH,
  A.ALT_PATH_COND = B.ALT_PATH_COND,
  A.DEF_VAL = B.DEF_VAL;
/
MERGE INTO INS_EWA_PURP_MVAL A USING
 (SELECT
  5 as ID,
  'Номер договору' as PURP_NAME,
  'root/contract/number/text()' as PURP_VAL,
  'root/contract/code/text()' as ALT_PATH,
  'root/contract/number/text()|null' as ALT_PATH_COND,
  NULL as DEF_VAL
  FROM DUAL) B
ON (A.ID = B.ID)
WHEN NOT MATCHED THEN 
INSERT (
  ID, PURP_NAME, PURP_VAL, ALT_PATH, ALT_PATH_COND, 
  DEF_VAL)
VALUES (
  B.ID, B.PURP_NAME, B.PURP_VAL, B.ALT_PATH, B.ALT_PATH_COND, 
  B.DEF_VAL)
WHEN MATCHED THEN
UPDATE SET 
  A.PURP_NAME = B.PURP_NAME,
  A.PURP_VAL = B.PURP_VAL,
  A.ALT_PATH = B.ALT_PATH,
  A.ALT_PATH_COND = B.ALT_PATH_COND,
  A.DEF_VAL = B.DEF_VAL;
/
MERGE INTO INS_EWA_PURP_MVAL A USING
 (SELECT
  6 as ID,
  'Дата початку договору' as PURP_NAME,
  'root/contract/dateFrom/text()' as PURP_VAL,
  NULL as ALT_PATH,
  NULL as ALT_PATH_COND,
  NULL as DEF_VAL
  FROM DUAL) B
ON (A.ID = B.ID)
WHEN NOT MATCHED THEN 
INSERT (
  ID, PURP_NAME, PURP_VAL, ALT_PATH, ALT_PATH_COND, 
  DEF_VAL)
VALUES (
  B.ID, B.PURP_NAME, B.PURP_VAL, B.ALT_PATH, B.ALT_PATH_COND, 
  B.DEF_VAL)
WHEN MATCHED THEN
UPDATE SET 
  A.PURP_NAME = B.PURP_NAME,
  A.PURP_VAL = B.PURP_VAL,
  A.ALT_PATH = B.ALT_PATH,
  A.ALT_PATH_COND = B.ALT_PATH_COND,
  A.DEF_VAL = B.DEF_VAL;
/
MERGE INTO INS_EWA_PURP_MVAL A USING
 (SELECT
  7 as ID,
  'Дата закінчення договору' as PURP_NAME,
  'root/contract/dateTo/text()' as PURP_VAL,
  NULL as ALT_PATH,
  NULL as ALT_PATH_COND,
  NULL as DEF_VAL
  FROM DUAL) B
ON (A.ID = B.ID)
WHEN NOT MATCHED THEN 
INSERT (
  ID, PURP_NAME, PURP_VAL, ALT_PATH, ALT_PATH_COND, 
  DEF_VAL)
VALUES (
  B.ID, B.PURP_NAME, B.PURP_VAL, B.ALT_PATH, B.ALT_PATH_COND, 
  B.DEF_VAL)
WHEN MATCHED THEN
UPDATE SET 
  A.PURP_NAME = B.PURP_NAME,
  A.PURP_VAL = B.PURP_VAL,
  A.ALT_PATH = B.ALT_PATH,
  A.ALT_PATH_COND = B.ALT_PATH_COND,
  A.DEF_VAL = B.DEF_VAL;
/
MERGE INTO INS_EWA_PURP_MVAL A USING
 (SELECT
  8 as ID,
  'Дата договору' as PURP_NAME,
  'root/payment/date/text()' as PURP_VAL,
  NULL as ALT_PATH,
  NULL as ALT_PATH_COND,
  NULL as DEF_VAL
  FROM DUAL) B
ON (A.ID = B.ID)
WHEN NOT MATCHED THEN 
INSERT (
  ID, PURP_NAME, PURP_VAL, ALT_PATH, ALT_PATH_COND, 
  DEF_VAL)
VALUES (
  B.ID, B.PURP_NAME, B.PURP_VAL, B.ALT_PATH, B.ALT_PATH_COND, 
  B.DEF_VAL)
WHEN MATCHED THEN
UPDATE SET 
  A.PURP_NAME = B.PURP_NAME,
  A.PURP_VAL = B.PURP_VAL,
  A.ALT_PATH = B.ALT_PATH,
  A.ALT_PATH_COND = B.ALT_PATH_COND,
  A.DEF_VAL = B.DEF_VAL;
/
MERGE INTO INS_EWA_PURP_MVAL A USING
 (SELECT
  9 as ID,
  'Прізвище' as PURP_NAME,
  'root/contract/customer/nameLast/text()' as PURP_VAL,
  'root/contract/insuranceObject/nameLast/text()' as ALT_PATH,
  'root/contract/tariff/externalId/text()|ОБ' as ALT_PATH_COND,
  NULL as DEF_VAL
  FROM DUAL) B
ON (A.ID = B.ID)
WHEN NOT MATCHED THEN 
INSERT (
  ID, PURP_NAME, PURP_VAL, ALT_PATH, ALT_PATH_COND, 
  DEF_VAL)
VALUES (
  B.ID, B.PURP_NAME, B.PURP_VAL, B.ALT_PATH, B.ALT_PATH_COND, 
  B.DEF_VAL)
WHEN MATCHED THEN
UPDATE SET 
  A.PURP_NAME = B.PURP_NAME,
  A.PURP_VAL = B.PURP_VAL,
  A.ALT_PATH = B.ALT_PATH,
  A.ALT_PATH_COND = B.ALT_PATH_COND,
  A.DEF_VAL = B.DEF_VAL;
/
MERGE INTO INS_EWA_PURP_MVAL A USING
 (SELECT
  10 as ID,
  'Ім''я' as PURP_NAME,
  'root/contract/customer/nameFirst/text()' as PURP_VAL,
  'root/contract/insuranceObject/nameFirst/text()' as ALT_PATH,
  'root/contract/tariff/externalId/text()|ОБ' as ALT_PATH_COND,
  NULL as DEF_VAL
  FROM DUAL) B
ON (A.ID = B.ID)
WHEN NOT MATCHED THEN 
INSERT (
  ID, PURP_NAME, PURP_VAL, ALT_PATH, ALT_PATH_COND, 
  DEF_VAL)
VALUES (
  B.ID, B.PURP_NAME, B.PURP_VAL, B.ALT_PATH, B.ALT_PATH_COND, 
  B.DEF_VAL)
WHEN MATCHED THEN
UPDATE SET 
  A.PURP_NAME = B.PURP_NAME,
  A.PURP_VAL = B.PURP_VAL,
  A.ALT_PATH = B.ALT_PATH,
  A.ALT_PATH_COND = B.ALT_PATH_COND,
  A.DEF_VAL = B.DEF_VAL;
/
MERGE INTO INS_EWA_PURP_MVAL A USING
 (SELECT
  11 as ID,
  'По-батькові' as PURP_NAME,
  'root/contract/customer/nameMiddle/text()' as PURP_VAL,
  'root/contract/insuranceObject/nameMiddle/text()' as ALT_PATH,
  'root/contract/tariff/externalId/text()|ОБ' as ALT_PATH_COND,
  NULL as DEF_VAL
  FROM DUAL) B
ON (A.ID = B.ID)
WHEN NOT MATCHED THEN 
INSERT (
  ID, PURP_NAME, PURP_VAL, ALT_PATH, ALT_PATH_COND, 
  DEF_VAL)
VALUES (
  B.ID, B.PURP_NAME, B.PURP_VAL, B.ALT_PATH, B.ALT_PATH_COND, 
  B.DEF_VAL)
WHEN MATCHED THEN
UPDATE SET 
  A.PURP_NAME = B.PURP_NAME,
  A.PURP_VAL = B.PURP_VAL,
  A.ALT_PATH = B.ALT_PATH,
  A.ALT_PATH_COND = B.ALT_PATH_COND,
  A.DEF_VAL = B.DEF_VAL;
/
MERGE INTO INS_EWA_PURP_MVAL A USING
 (SELECT
  12 as ID,
  'ОКПО клієнта' as PURP_NAME,
  'root/contract/customer/code/text()' as PURP_VAL,
  NULL as ALT_PATH,
  NULL as ALT_PATH_COND,
  '0000000000' as DEF_VAL
  FROM DUAL) B
ON (A.ID = B.ID)
WHEN NOT MATCHED THEN 
INSERT (
  ID, PURP_NAME, PURP_VAL, ALT_PATH, ALT_PATH_COND, 
  DEF_VAL)
VALUES (
  B.ID, B.PURP_NAME, B.PURP_VAL, B.ALT_PATH, B.ALT_PATH_COND, 
  B.DEF_VAL)
WHEN MATCHED THEN
UPDATE SET 
  A.PURP_NAME = B.PURP_NAME,
  A.PURP_VAL = B.PURP_VAL,
  A.ALT_PATH = B.ALT_PATH,
  A.ALT_PATH_COND = B.ALT_PATH_COND,
  A.DEF_VAL = B.DEF_VAL;
/
MERGE INTO INS_EWA_PURP_MVAL A USING
 (SELECT
  13 as ID,
  'Серія паспорта' as PURP_NAME,
  'root/contract/customer/document/series/text()' as PURP_VAL,
  NULL as ALT_PATH,
  NULL as ALT_PATH_COND,
  NULL as DEF_VAL
  FROM DUAL) B
ON (A.ID = B.ID)
WHEN NOT MATCHED THEN 
INSERT (
  ID, PURP_NAME, PURP_VAL, ALT_PATH, ALT_PATH_COND, 
  DEF_VAL)
VALUES (
  B.ID, B.PURP_NAME, B.PURP_VAL, B.ALT_PATH, B.ALT_PATH_COND, 
  B.DEF_VAL)
WHEN MATCHED THEN
UPDATE SET 
  A.PURP_NAME = B.PURP_NAME,
  A.PURP_VAL = B.PURP_VAL,
  A.ALT_PATH = B.ALT_PATH,
  A.ALT_PATH_COND = B.ALT_PATH_COND,
  A.DEF_VAL = B.DEF_VAL;
/
MERGE INTO INS_EWA_PURP_MVAL A USING
 (SELECT
  14 as ID,
  'Номер паспорта' as PURP_NAME,
  'root/contract/customer/document/number/text()' as PURP_VAL,
  NULL as ALT_PATH,
  NULL as ALT_PATH_COND,
  NULL as DEF_VAL
  FROM DUAL) B
ON (A.ID = B.ID)
WHEN NOT MATCHED THEN 
INSERT (
  ID, PURP_NAME, PURP_VAL, ALT_PATH, ALT_PATH_COND, 
  DEF_VAL)
VALUES (
  B.ID, B.PURP_NAME, B.PURP_VAL, B.ALT_PATH, B.ALT_PATH_COND, 
  B.DEF_VAL)
WHEN MATCHED THEN
UPDATE SET 
  A.PURP_NAME = B.PURP_NAME,
  A.PURP_VAL = B.PURP_VAL,
  A.ALT_PATH = B.ALT_PATH,
  A.ALT_PATH_COND = B.ALT_PATH_COND,
  A.DEF_VAL = B.DEF_VAL;
/
MERGE INTO INS_EWA_PURP_MVAL A USING
 (SELECT
  15 as ID,
  'Дата народження' as PURP_NAME,
  'root/contract/customer/birthDate/text()' as PURP_VAL,
  'root/contract/insuranceObject/birthDate/text()' as ALT_PATH,
  'root/contract/tariff/externalId/text()|ОБ' as ALT_PATH_COND,
  NULL as DEF_VAL
  FROM DUAL) B
ON (A.ID = B.ID)
WHEN NOT MATCHED THEN 
INSERT (
  ID, PURP_NAME, PURP_VAL, ALT_PATH, ALT_PATH_COND, 
  DEF_VAL)
VALUES (
  B.ID, B.PURP_NAME, B.PURP_VAL, B.ALT_PATH, B.ALT_PATH_COND, 
  B.DEF_VAL)
WHEN MATCHED THEN
UPDATE SET 
  A.PURP_NAME = B.PURP_NAME,
  A.PURP_VAL = B.PURP_VAL,
  A.ALT_PATH = B.ALT_PATH,
  A.ALT_PATH_COND = B.ALT_PATH_COND,
  A.DEF_VAL = B.DEF_VAL;
/
MERGE INTO INS_EWA_PURP_MVAL A USING
 (SELECT
  16 as ID,
  'Номер телефону' as PURP_NAME,
  'root/contract/customer/phone/text()' as PURP_VAL,
  NULL as ALT_PATH,
  NULL as ALT_PATH_COND,
  NULL as DEF_VAL
  FROM DUAL) B
ON (A.ID = B.ID)
WHEN NOT MATCHED THEN 
INSERT (
  ID, PURP_NAME, PURP_VAL, ALT_PATH, ALT_PATH_COND, 
  DEF_VAL)
VALUES (
  B.ID, B.PURP_NAME, B.PURP_VAL, B.ALT_PATH, B.ALT_PATH_COND, 
  B.DEF_VAL)
WHEN MATCHED THEN
UPDATE SET 
  A.PURP_NAME = B.PURP_NAME,
  A.PURP_VAL = B.PURP_VAL,
  A.ALT_PATH = B.ALT_PATH,
  A.ALT_PATH_COND = B.ALT_PATH_COND,
  A.DEF_VAL = B.DEF_VAL;
/
MERGE INTO INS_EWA_PURP_MVAL A USING
 (SELECT
  17 as ID,
  'Адреса клієнта' as PURP_NAME,
  'root/contract/customer/address/text()' as PURP_VAL,
  'root/contract/insuranceObject/address/text()' as ALT_PATH,
  'root/contract/tariff/externalId/text()|ОБ' as ALT_PATH_COND,
  NULL as DEF_VAL
  FROM DUAL) B
ON (A.ID = B.ID)
WHEN NOT MATCHED THEN 
INSERT (
  ID, PURP_NAME, PURP_VAL, ALT_PATH, ALT_PATH_COND, 
  DEF_VAL)
VALUES (
  B.ID, B.PURP_NAME, B.PURP_VAL, B.ALT_PATH, B.ALT_PATH_COND, 
  B.DEF_VAL)
WHEN MATCHED THEN
UPDATE SET 
  A.PURP_NAME = B.PURP_NAME,
  A.PURP_VAL = B.PURP_VAL,
  A.ALT_PATH = B.ALT_PATH,
  A.ALT_PATH_COND = B.ALT_PATH_COND,
  A.DEF_VAL = B.DEF_VAL;
/
MERGE INTO INS_EWA_PURP_MVAL A USING
 (SELECT
  18 as ID,
  'Тип страхування EWA' as PURP_NAME,
  'root/contract/tariff/externalId/text()' as PURP_VAL,
  NULL as ALT_PATH,
  NULL as ALT_PATH_COND,
  NULL as DEF_VAL
  FROM DUAL) B
ON (A.ID = B.ID)
WHEN NOT MATCHED THEN 
INSERT (
  ID, PURP_NAME, PURP_VAL, ALT_PATH, ALT_PATH_COND, 
  DEF_VAL)
VALUES (
  B.ID, B.PURP_NAME, B.PURP_VAL, B.ALT_PATH, B.ALT_PATH_COND, 
  B.DEF_VAL)
WHEN MATCHED THEN
UPDATE SET 
  A.PURP_NAME = B.PURP_NAME,
  A.PURP_VAL = B.PURP_VAL,
  A.ALT_PATH = B.ALT_PATH,
  A.ALT_PATH_COND = B.ALT_PATH_COND,
  A.DEF_VAL = B.DEF_VAL;
/
COMMIT;
/