<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReferencedAssemblies="System.dll&#13;&#10;System.Drawing.dll&#13;&#10;System.Windows.Forms.dll&#13;&#10;System.Data.dll&#13;&#10;System.Xml.dll&#13;&#10;&#13;&#10;Oracle.DataAccess&#13;&#10;FastReport.Oracle" StartReportEvent="_StartReport" ReportInfo.Created="06/24/2014 16:54:08" ReportInfo.Modified="09/16/2015 15:03:19" ReportInfo.CreatorVersion="2013.2.2.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;
using System.Data.Sql;
using Oracle.DataAccess.Client;
using Oracle.DataAccess.Types;


namespace FastReport
{
  public class ReportScript
  {
    
    public string TicDoc_attr(string Var)
    {
      // Обработка параметрів
      Parameter p_nd = Report.GetParameter(&quot;p_nd&quot;);
      String p_value1 = &quot;&quot;;
      String p_value2 = &quot;&quot;;
      String p_value3 = &quot;&quot;;

      OracleDataConnection frxcon = (OracleDataConnection)Report.Dictionary.Connections[0];
      OracleConnection con = (OracleConnection)frxcon.GetConnection();
      OracleCommand cmd = con.CreateCommand();
      
      cmd.CommandType = CommandType.StoredProcedure;
      cmd.CommandText = &quot;cc_doc_get_var_value2&quot;;
         
      cmd.Parameters.Add(&quot;p_tag&quot;,     OracleDbType.Varchar2, Var,           ParameterDirection.Input);       //0
      cmd.Parameters.Add(&quot;p_dealnum&quot;, OracleDbType.Decimal, p_nd.Value,     ParameterDirection.Input);       //1
      cmd.Parameters.Add(&quot;p_agrmnum&quot;, OracleDbType.Decimal, 0,             ParameterDirection.Input);        //2
      cmd.Parameters.Add(&quot;p_value1&quot;, OracleDbType.Varchar2, 2000, p_value1, ParameterDirection.InputOutput); //3
      cmd.Parameters.Add(&quot;p_value2&quot;, OracleDbType.Varchar2, 2000, p_value2, ParameterDirection.InputOutput); //4
      cmd.Parameters.Add(&quot;p_value3&quot;, OracleDbType.Varchar2, 2000, p_value3, ParameterDirection.InputOutput); //5
      
      con.Open();
      try
      {
        cmd.ExecuteNonQuery();
        
        p_value1 = cmd.Parameters[&quot;p_value1&quot;].Value.ToString();
        p_value2 = cmd.Parameters[&quot;p_value2&quot;].Value.ToString();
        p_value2 = cmd.Parameters[&quot;p_value3&quot;].Value.ToString();

      }
      finally
      {
        con.Close();
      }
      
      return   p_value1;
      
    }
    
    
    // Получение значения параметра тикета
    public string GetVal(string Var)
    {
      try
      {
        string p_val = TicDoc_attr(Var);
        
        if (!String.IsNullOrEmpty(p_val) &amp;&amp; p_val != &quot;null&quot;)
          return p_val;
        else 
          return &quot;&quot;;
      }
      catch (Exception) {  return &quot;&quot;; }
    }

    private void _StartReport(object sender, EventArgs e)
    {
      // Відображення шапки в залежності від договору
       
      switch (GetVal(&quot;SKRN_TYPE_DOG&quot;))
      {
        case &quot;2&quot;: Row2.Visible  = false;
                  Row3.Visible  = false;
                  Row16.Visible = true;
                  break;
        case &quot;3&quot;: Row2.Visible  = true;
                  Row3.Visible  = false;
                  Row16.Visible = false;
                  break;
        case &quot;4&quot;: Row2.Visible  = true;
                  Row3.Visible  = true;
                  Row16.Visible = false;
                  break;
        default: Row2.Visible  = true;
                 Row3.Visible  = true;
                 Row16.Visible = true;
                 break;
      }
      
      
      
    }
  }
}
</ScriptText>
  <Dictionary>
    <OracleDataConnection Name="Connection" ConnectionString="rijcmlq9SEZoacNJntaKIKp6mVF15TE2eO7inhdLIlr+Rbwy/H6LEj7kAn54PUVn+jTwAVmRkkIrXRpq0t8+liWzP4OozugjPUULi60/Z04Kx8o8YQ=">
      <TableDataSource Name="Table" DataType="System.Int32" Enabled="true" SelectCommand="select '[GetVal(&quot;'||id||'&quot;)]' as form, id, name , ssql  from DOC_ATTR where id like 'SKR%'">
        <Column Name="ID" DataType="System.String"/>
        <Column Name="NAME" DataType="System.String"/>
        <Column Name="SSQL" DataType="System.String"/>
        <Column Name="FORM" DataType="System.String"/>
      </TableDataSource>
    </OracleDataConnection>
    <Parameter Name="p_nd" DataType="System.Int32" Expression="10473101"/>
  </Dictionary>
  <ReportPage Name="Page1" RawPaperSize="9" LeftMargin="20" FirstPageSource="15" OtherPagesSource="15" Guides="0,680.4,340.2">
    <ReportTitleBand Name="ReportTitle1" Width="680.4" Height="9.45"/>
    <PageHeaderBand Name="PageHeader1" Top="11.74" Width="680.4" Height="9.45"/>
    <DataBand Name="Data1" Top="23.47" Width="680.4" Height="878.85" Guides="0,642.6,18.9,207.9,226.8,245.7,264.6,283.5,359.1,75.6,378,396.9,415.8,434.7,453.6,604.8,151.2,623.7">
      <TableObject Name="Table1" Width="680.4" Height="831.6">
        <TableColumn Name="Column1" Width="340.2"/>
        <TableColumn Name="Column2" Width="340.2"/>
        <TableRow Name="Row1" Height="66.15">
          <TableCell Name="Cell1"/>
          <TableCell Name="Cell2" Text="Керівнику &lt;b&gt;______________________________________[GetVal(&quot;SKRN_STAF_STAFF-&quot;)]&lt;/b&gt;&#13;&#10;Назва установи банку   &lt;b&gt;[GetVal(&quot;DPT_NAME_BRANCH&quot;)]&lt;/b&gt;" Font="Times New Roman, 10pt" HtmlTags="true"/>
        </TableRow>
        <TableRow Name="Row2" Height="122.85" AutoSize="true">
          <TableCell Name="Cell6" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell7" Text="&#13;&#10;Клієнт Банку - фізична особа &#13;&#10;&lt;b&gt;[GetVal(&quot;SKRN_FIO&quot;)]&lt;/b&gt;&#13;&#10;Паспортні дані: серія &lt;b&gt;[GetVal(&quot;SKRN_PASP&quot;)]&lt;/b&gt;, &#13;&#10;дата  видачі &lt;b&gt;[GetVal(&quot;SKRN_ATRT&quot;)]&lt;/b&gt;&#13;&#10;Адреса: &lt;b&gt;[GetVal(&quot;SKRN_ADRES&quot;)]&lt;/b&gt;&#13;&#10;Номер телефону: &lt;b&gt;[GetVal(&quot;SKRN_TEL&quot;)]&lt;/b&gt;&#13;&#10;&#13;&#10;" Font="Times New Roman, 10pt" HtmlTags="true"/>
        </TableRow>
        <TableRow Name="Row3" Height="94.5" AutoSize="true">
          <TableCell Name="Cell11" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell12" Text="&#13;&#10;Клієнт Банку - фізична особа &#13;&#10;&lt;b&gt;[GetVal(&quot;SKRN_FIO_CL2&quot;)]&lt;/b&gt;&#13;&#10;Паспортні дані: серія &lt;b&gt;[GetVal(&quot;SKRN_PASP_CL2&quot;)]&lt;/b&gt;, &#13;&#10;дата  видачі &lt;b&gt;[GetVal(&quot;SKRN_ATTR_CL2&quot;)]&lt;/b&gt;&#13;&#10;Адреса: &lt;b&gt;[GetVal(&quot;SKRN_ADRES_CL2&quot;)]&lt;/b&gt;" Font="Times New Roman, 10pt" HtmlTags="true"/>
        </TableRow>
        <TableRow Name="Row16" Height="113.4" AutoSize="true">
          <TableCell Name="Cell43"/>
          <TableCell Name="Cell44" Text="Клієнт Банку - юридична особа &#13;&#10;&lt;b&gt;[GetVal(&quot;SKRN_FIO&quot;)]&lt;/b&gt;&#13;&#10;в особі [GetVal(&quot;SKRN_FIO_PREDST&quot;)]&#13;&#10;Паспортні дані: серія &lt;b&gt;[GetVal(&quot;SKRN_PASP_PREDST&quot;)]&lt;/b&gt;, &#13;&#10;[GetVal(&quot;SKRN_DOVER_PREDST&quot;)]&#13;&#10;" Font="Times New Roman, 10pt" HtmlTags="true"/>
        </TableRow>
        <TableRow Name="Row17">
          <TableCell Name="Cell45"/>
          <TableCell Name="Cell46"/>
        </TableRow>
        <TableRow Name="Row4">
          <TableCell Name="Cell16" Text="&lt;b&gt;З А Я В А  &lt;/b&gt;" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt" HtmlTags="true" ColSpan="2"/>
          <TableCell Name="Cell17" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row5">
          <TableCell Name="Cell21" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell22" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row6">
          <TableCell Name="Cell23" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell24" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row7" Height="75.6">
          <TableCell Name="Cell25" Text="              Прошу надати в оренду індивідуальний сейф &lt;b&gt;[GetVal(&quot;SKRN_NAME_SKRN&quot;)]&lt;/b&gt;  для зберігання цінностей на строк з &lt;b&gt;[GetVal(&quot;SKRN_DAT_BEGIN&quot;)]&lt;/b&gt;  по  &lt;b&gt;[GetVal(&quot;SKRN_DAT_END&quot;)]&lt;/b&gt;  включно.  " Font="Times New Roman, 10pt" HtmlTags="true" ColSpan="2"/>
          <TableCell Name="Cell26" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row8">
          <TableCell Name="Cell27" Text="“_____”__________________200__ року" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell28" Border.Lines="Bottom" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row9">
          <TableCell Name="Cell29" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell30" Text=" (підпис(и) клієнта(ів)&#13;&#10;" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row10">
          <TableCell Name="Cell31" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell32" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row11">
          <TableCell Name="Cell33" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell34" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row12">
          <TableCell Name="Cell35" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell36" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row13" Height="151.2">
          <TableCell Name="Cell37" Text="З клієнтом(ами)  &lt;b&gt;[GetVal(&quot;SKRN_FIO&quot;)]&lt;/b&gt; &lt;b&gt;[GetVal(&quot;SKRN_FIO_CL2&quot;)]&lt;/b&gt;  укладений договір №  &lt;b&gt;[GetVal(&quot;SKRN_ND&quot;)]&lt;/b&gt;  від  &lt;b&gt;[GetVal(&quot;SKRN_DATZ&quot;)]&lt;/b&gt;&#13;&#10;Надано у користування : сейф № &lt;b&gt;[GetVal(&quot;SKRN_NO&quot;)]&lt;/b&gt;  ключ № &lt;b&gt;[GetVal(&quot;SKRN_KEY&quot;)]&lt;/b&gt;&#13;&#10;Оплачено за строк до &lt;b&gt;[GetVal(&quot;SKRN_DAT_END&quot;)]&lt;/b&gt;&#13;&#10;Заставну плату за замок та ключі від сейфу вніс  &lt;b&gt;[GetVal(&quot;SKRN_ZALOG_DAT&quot;)]&lt;/b&gt;  &lt;b&gt;[GetVal(&quot;SKRN_ZALOG_PR&quot;)]&lt;/b&gt;(сума, дата )&#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;                                 " Font="Times New Roman, 10pt" HtmlTags="true" ColSpan="2"/>
          <TableCell Name="Cell38" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row14">
          <TableCell Name="Cell39" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell40" Text=" ____________________________________ &#13;&#10; (підпис відповідального виконавця)&#13;&#10;" Font="Times New Roman, 10pt" RowSpan="2"/>
        </TableRow>
        <TableRow Name="Row15">
          <TableCell Name="Cell41" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell42" Font="Times New Roman, 10pt"/>
        </TableRow>
      </TableObject>
    </DataBand>
    <PageFooterBand Name="PageFooter1" Top="904.61" Width="680.4" Height="18.9"/>
  </ReportPage>
</Report>
