<?xml version="1.0" encoding="utf-8" ?>
<xmlform caption="Довідник бенефіціарів" captiontype="OnlyTitle">
  <grids>
    <grid id="gv" pagesize="10" showpagesizebox="true" table="v_cim_beneficiaries" title="Довідник бенефіціарів">
      <buttons defaulttype="Button">
        <button caption="Відновити видалений запис" id="btnBack">
          <command type="PlSql">
            <sql>
              update cim_beneficiaries set delete_date=null where benef_id=:benef_id
            </sql>
            <parameters>
              <parameter type="DataField" name="benef_id"/>
            </parameters>
          </command>
        </button>
      </buttons>
      <editform style="Dialog" title="Редагування бенефіціара"  width="400" height="340" >
        <buttons defaulttype="Link">
          <button id="cmdInsert" caption="Додати рядок|Зберегти|Вiдмiнити" hint="Додати рядок|Зберегти рядок|Вiдмiнити додавання">
            <command type="Insert" successmessage="Дані збережено">
              <sql>
                begin
                cim_mgr.create_beneficiary(
                p_benef_name => :benef_name,
                p_country_id => :country_id,
                p_adr => :benef_adr,
                p_comments => :comments
                );
                end;
              </sql>
              <parameters>
                <parameter type="DataField" name="benef_name"/>
                <parameter type="DataField" name="country_id"/>
                <parameter type="DataField" name="benef_adr"/>
                <parameter type="DataField" name="comments"/>
              </parameters>
            </command>
          </button>
          <button id="cmdEdit" caption="Редагувати|Зберегти|Вiдмiнити" hint="Редагувати|Зберегти|Вiдмiнити">
            <command type="Edit" successmessage="Дані збережено">
              <sql>
                begin
                cim_mgr.update_beneficiary(
                p_benef_id => :benef_id,
                p_benef_name => :benef_name,
                p_country_id => :country_id,
                p_adr => :benef_adr,
                p_comments => :comments
                );
                end;
              </sql>
              <parameters>
                <parameter type="DataField" name="benef_id"/>
                <parameter type="DataField" name="benef_name"/>
                <parameter type="DataField" name="country_id"/>
                <parameter type="DataField" name="benef_adr"/>
                <parameter type="DataField" name="comments"/>
              </parameters>
            </command>
          </button>
          <button id="cmdDel" caption="Видалити" hint="Видалити" confirmmessage="Необхiдно пiдтвердити операцiю видалення">
            <command type="Delete">
              <sql>
                begin
                cim_mgr.delete_beneficiary(p_benef_id => :benef_id);
                end;
              </sql>
              <parameters>
                <parameter type="DataField" name="benef_id"/>
              </parameters>
            </command>
          </button>
          <button id="cmdClose" caption="Закрити" hint="Закрити форму">
            <command type="Close"/>
          </button>
        </buttons>
      </editform>
      <fields>
        <field datatype="Int64" name="benef_id" key="true" sort="default" >
          <column show="true" caption="Ід. бенефіціра" />
          <form rwmode="RO" show="false">
            <uicontrol></uicontrol>
          </form>
        </field>
        <field datatype="String" size="256" name="benef_name" sort="default">
          <column show="true" align="Left" caption="Найменування" />
          <form rwmode="RW" show="true" required="true">
            <uicontrol controlwidth="250"></uicontrol>
          </form>
        </field>
        <field datatype="Int64" name="country_id" sort="default">
          <column show="false" align="Left" caption="Країна" />
          <form rwmode="RW" show="true">
            <uicontrol type="DropDownList" table="(select country, name from country order by 2)" addemptyitem="true" keyfield="country" valuefield="name" controlwidth="250"></uicontrol>
          </form>
        </field>
        <field datatype="String"  name="country_name" sort="default">
          <column show="true" align="Left" caption="Країна" />
          <form rwmode="RO" show="false">
          </form>
        </field>
        <field datatype="String" size="128" name="benef_adr" sort="default">
          <column show="true" align="Left" caption="Адреса" />
          <form rwmode="RW" show="true" required="true">
            <uicontrol controlwidth="250" linescount="2"></uicontrol>
          </form>
        </field>
        <field datatype="String" size="256" name="comments" sort="default">
          <column show="true" align="Left" caption="Коментар" />
          <form rwmode="RW" show="true">
            <uicontrol controlwidth="250" linescount="3"></uicontrol>
          </form>
        </field>
        <field datatype="DateTime" name="delete_date" sort="default">
          <column show="true" align="Center" caption="Дата видалення" formatstring="{0:dd.MM.yyyy}" />
          <form rwmode="RO" show="false">
            <uicontrol></uicontrol>
          </form>
        </field>
      </fields>
      <rowselection method="SingleRow" />
    </grid>
  </grids>
</xmlform>