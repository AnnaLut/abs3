<?xml version="1.0" encoding="utf-8"?>
<xmlform caption="Контрольні точки форми"  captiontype="OnlyTitle" version="1.0.0">
  <grids>
    <grid id="id1" title="Контроль форми" pagesize="15" showpagesizebox="true">
      <datasource>
        <!-- Запрос на відображення відхилень. Через URL передаємо :OKPO, :DAT, :nForm -->
        <sql>
          select n, txt, rr, s, rr2, s2, riz, :OKPO as okpo, fin_nbu.F_FM(:OKPO, :DAT) as idf, :nform as nform, :dat as dat, decode(riz, 0, 1, 0) col from (
          select n, txt, rr, s, rr2, s2, nvl(s,0)-nvl(s2,0) riz from (
          select '1' as n,'Немат. активи: залиш. варт.'as txt,    '010' rr,  SUM(decode(KOD,'010',S,0)) s,   '011-012' rr2,   SUM(decode(KOD,'010',0, decode(KOD,'011',1,-1)*S) ) s2
          from fin_rnk
          where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and  kod in ('010','011','012')
          union all
          select '2' as n,'Основні засоби: залишк. варт.'as txt,    '030' rr,  SUM(decode(KOD,'030',S,0)) s,   '031-032' rr2,   SUM(decode(KOD,'030',0, decode(KOD,'031',1,-1)*S) ) s2
          from fin_rnk
          where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and  kod in ('030','031','032')
          union all
          select '3' as n,'Біол. активи:залиш. варт.'as txt,    '035' rr,  SUM(decode(KOD,'035',S,0)) s,   '036-037' rr2,   SUM(decode(KOD,'035',0, decode(KOD,'036',1,-1)*S) ) s2
          from fin_rnk
          where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and  kod in ('035','036','037')
          union all
          select  '4' as n, 'Активи. Всього по розділу 1' txt, '080' rr,  SUM(decode(KOD,'080',S,0)) s,  '010+020+030+035+040+045+050+055+060+065+070+075' rr2, SUM(decode(KOD,'080',0,S)) s2
          from fin_rnk
          where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
          kod in ('080','010','020','030','035','040','045','050','055','060','065','070','075')
          union all
          select '5' as n,'Дебіт.заб. за тов.,роб.,посл.'as txt,    '160' rr,  SUM(decode(KOD,'160',S,0)) s,   '161-162' rr2,   SUM(decode(KOD,'160',0, decode(KOD,'161',1,-1)*S) ) s2
          from fin_rnk
          where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and  kod in ('160','161','162')
          union all
          select '6' as n, 'Активи. Всього по розділу 2' txt, '260' rr, SUM(decode(KOD,'260',S,0)) s, '100+110+120+130+140+150+160+170+180+190+200+210+220+230+240+250' rr2,  SUM(decode(KOD,'260',0,S)) s2
          from fin_rnk
          where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
          kod in ('260','100','110','120','130','140','150','160','170',
          '180','190','200','210','220','230','240','250')
          union all
          select  '7' as n, 'Баланс' txt, '280' rr, SUM(decode(KOD,'280',S,0)) s, '080+260+270+275' rr2, SUM(decode(KOD,'280',0,S)) s2
          from fin_rnk
          where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
          kod in ('280', '080','260','270','275')
          union all
          select  '8' as n, 'Пасиви. Всього по розділу 1' txt, '380' rr, SUM(decode(KOD,'380',S,0)) s, '300+310+320+330+340+350+(-360)+(-370)+375' rr2, SUM(decode(KOD,'380',0,decode(KOD,'360',-S,'370',-S,S))) s2
          from fin_rnk
          where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
          kod in ('380','300','310','320','330','340','350','360','370','375')
          union all
          select * from
          (select  '9' as n, 'Пасиви. Всього по розділу 2' txt, '430' rr, SUM(decode(KOD,'430',S,0)) s, '400+410+420+415-416+417+418' rr2, SUM(decode(KOD,'430',0,decode(KOD,'416',-S,S))) s2
          from fin_rnk
          where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
          kod in ('430','400','410','420','415', '416', '417', '418'))
          where 'N' != fin_nbu.F_FM(:OKPO, :DAT)
          --where 'M' != fin_nbu.F_FM(:OKPO, :DAT)

          union all
          Select * from
          (select '10' as n, 'Пасиви. Всього по розділу 3' txt, '480' rr, SUM(decode(KOD,'480',S,0)) s, '440+450+460+470' rr2, SUM(decode(KOD,'480',0,S)) s2
          from fin_rnk
          where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
          kod in ('480','440','450','460','470'))
          where 'M' != fin_nbu.F_FM(:OKPO, :DAT)
          union all
          select  '11' as n, 'Пасиви. Всього по розділу 4' txt, '620' rr, SUM(decode(KOD,'620',S,0)), '500+510+520+530+540+550+560+570+580+590+600+610+605' rr2, SUM(decode(KOD,'620',0,S))
          from fin_rnk
          where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
          kod in ('620','500','510','520','530','540','550',
          '560','570','580','590','600','610', '605')
          union all
          select  '12' as n, 'Баланс' txt,'640' rr,  SUM(decode(KOD,'640',S,0)), '380+430+480+620+630' rr2, SUM(decode(KOD,'640',0,S))
          from fin_rnk
          where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
          kod in ('640','380','430','480','620','630')
          union all
          select  '12' as n, '***   Баланс   ***' txt,'640' rr,  SUM(decode(KOD,'640',S,0)), '280' rr2, SUM(decode(KOD,'640',0,S))
          from fin_rnk
          where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
          kod in ('640','280')
          )
          where  1 = :nForm and  (' ' = fin_nbu.F_FM(:OKPO, :DAT) or 'M' = fin_nbu.F_FM(:OKPO, :DAT))

          union all
          select n, txt, rr, sl, rr2, sr, nvl(sl,0)-nvl(sr,0) riz from
          (
          select * from (
          select '1' as n, 'I. Необоротні активи Нематеріальні активи' as txt, '1000' as rr, NVL(SUM(decode(KOD,'1000',S,0)),0) SL, '1001-1002' as rr2,   NVL(SUM(decode(KOD,'1000',0,decode(kod,'1001',1,-1)*S)),0) SR
          from fin_rnk where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and      kod in ('1000','1001','1002')
          ) where 'N' = fin_nbu.F_FM(:OKPO, :DAT) 
          UNION ALL
          select '2' as n, 'Основні засоби' as txt, '1010' as rr, NVL(SUM(decode(KOD,'1010',S,0)),0) SL, '1011-1012' as rr2,  NVL(SUM(decode(KOD,'1010',0,decode(kod,'1011',1,-1)*S)),0) SR
          from fin_rnk where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and   kod in ('1010','1011','1012')
          /*  UNION ALL
          select '3' as n, 'Інвестиційна нерухомість' as txt, '1015' as rr, NVL(SUM(decode(KOD,'1015',S,0)),0) SL, '1016-1017' as rr2, NVL(SUM(decode(KOD,'1015',0,decode(kod,'1016',1,-1)*S)),0) SR
          from fin_rnk where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and  kod in ('1015','1016','1017')
          */
          /*   UNION ALL
          select '4' as n, 'Довгострокові біологічні активи' as txt, '1020' as rr, NVL(SUM(decode(KOD,'1020',S,0)),0) SL, '1021-1022' as rr2, NVL(SUM(decode(KOD,'1020',0,decode(kod,'1021',1,-1)*S)),0) SR
          from fin_rnk where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and  kod in ('1020','1021','1022')
          */
          UNION ALL
          select '5' as n, 'Усього за розділом I' as txt, '1095' as rr,  NVL(SUM(decode(KOD,'1095',S,0)),0) SL, '1000+1005+1010+1015+1020+1030+1035+1040+1045+1050+1060+1065+1090' as rr2, NVL(SUM(decode(KOD,'1095',0,S)),0) SR
          from fin_rnk where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and  kod in ('1095','1000','1005','1010','1015','1020','1030','1035','1040','1045','1050','1060','1005','1065','1090')
          /*   UNION ALL
          select '6' as n, 'II. Оборотні активи Запаси ' as txt, '1100' as rr,  NVL(SUM(decode(KOD,'1100',S,0)),0) SL, '1101+1102+1103+1104' as  rr2,  NVL(SUM(decode(KOD,'1100',0,S)),0) SR
          from fin_rnk where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and  kod in ('1100','1101','1102','1103','1104')
          */
          /*   UNION ALL
          select '7' as n, 'Гроші та їх еквіваленти' as txt, '1165' as rr, NVL(SUM(decode(KOD,'1165',S,0)),0) SL, '1166+1167' as rr2, NVL(SUM(decode(KOD,'1165',0,S)),0) SR
          from fin_rnk where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and   kod in ('1165','1166','1167')
          */
          UNION ALL
          select '8' as n, 'Усього за розділом II' as txt, '1195' as rr, NVL(SUM(decode(KOD,'1195',S,0)),0) SL, '1100+1110+1115+1120+1125+1130+1135+1140+1145+1155+1160+1165+1170+1180+1190' as rr2, NVL(SUM(decode(KOD,'1195',0,S)),0) SR
          from fin_rnk where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and  kod in ('1195','1100','1110','1115','1120','1125','1130','1135','1140','1145','1155','1160','1165','1170','1180','1190')
          UNION ALL
          select '9' as n, 'Баланс(актив)' as txt, '1300' as rr, NVL(SUM(decode(KOD,'1300',S,0)),0) SL, '1095+1195+1200' as rr2, NVL(SUM(decode(KOD,'1300',0,S)),0) SR
          from fin_rnk where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and kod in ('1300','1095','1195','1200')
          UNION ALL
          select '10' as n, 'Усього за розділом I' as txt, '1495' as rr, NVL(SUM(decode(KOD,'1495',S,0)),0) SL, '1400+1405+1410+1415+1420+1425+1430+1435' as rr2,  NVL(SUM(decode(KOD,'1495',0,S)),0) SR
          from fin_rnk where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and kod in ('1495','1400','1405','1410','1415','1420','1425','1430','1435')
          UNION ALL
          select '11' as n, 'Усього за розділом II' as txt, '1595' as rr, NVL(SUM(decode(KOD,'1595',S,0)),0) SL, '1500+1505+1510+1515+1520+1525+1530+1535+1540+1545' as rr2, NVL(SUM(decode(KOD,'1595',0,S)),0) SR
          from fin_rnk where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and kod in ('1595','1500','1505','1510','1515','1520','1525','1530','1535','1540','1545')
          UNION ALL
          select '12' as n, 'Усього за розділом IІІ' as txt, '1695' as rr, NVL(SUM(decode(KOD,'1695',S,0)),0) SL, '1600+1605+1610+1615+1620+1625+1630+1635+1640+1645+1650+1660+1665+1670+1690' as rr2, NVL(SUM(decode(KOD,'1695',0,S)),0) SR
          from fin_rnk where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and kod in ('1695','1600','1605','1610','1615','1620','1625','1630','1635','1640','1645','1650','1660','1665','1670','1690')
          UNION ALL
          select '13' as n, 'Баланс (пасив)' as txt, '1900' as rr,  NVL(SUM(decode(KOD,'1900',S,0)),0) SL, '1495+1595+1695+1700+1800' as rr2, NVL(SUM(decode(KOD,'1900',0,S)),0) SR
          from fin_rnk where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and  kod in ('1900','1495','1595','1695','1700','1800')
          UNION ALL
          select '14' as n , 'Баланс (актив - пасив)' as txt, '1300' as rr, NVL(SUM(decode(KOD,'1300',S,0)),0), '1900' as rr2,  NVL(SUM(decode(KOD,'1300',0,S)),0)
          from fin_rnk where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and  kod in ('1300','1900')
          )
          where  1 = :nForm and  ('N' = fin_nbu.F_FM(:OKPO, :DAT) or 'R' = fin_nbu.F_FM(:OKPO, :DAT))
          union all

          select n, txt, rr, sl, rr2, sr, nvl(sl,0)-nvl(sr,0) riz from
          (
          select '1' as n, 'Валовий (прибуток\збиток)' as txt, '2090' as rr,  NVL(SUM(decode(KOD,'2090',S,0)),0) SL, '2000+2010-2050-2070+2095' as rr2,  NVL(SUM(decode(KOD,'2090',0,decode(KOD,'2050',-1,'2070',-1,1)*S)),0) SR
          from fin_rnk    where OKPO=:OKPO and FDAT=:DAT and idf=:nForm   and  kod in ('2090','2095','2000','2010','2050','2070')
          UNION ALL
          select '2' as n, 'Фінансовий результат від операційної діяльності (прибуток\збиток)' as txt, '2190' as rr,  NVL(SUM(decode(KOD,'2190',S,0)),0) SL, '2090-2095+2105+2110+2120-2130-2150-2180+2195' as rr2,  NVL(SUM(decode(KOD,'2190',0,decode(KOD,'2095',-1,'2130',-1,'2150',-1,'2180',-1,'2195',1,1)*S)),0) SR
          from fin_rnk   where OKPO=:OKPO and FDAT=:DAT and idf=:nForm  and  kod in ('2190','2090','2095','2105','2110','2120','2130','2150','2180','2195')
          UNION ALL
          select '3' as n, 'Фінансовий результат до оподаткування (прибуток\збиток)' as txt, '2290' as rr,  NVL(SUM(decode(KOD,'2290',S,0)),0) SL, '2190-2195+2200+2220+2240-2250-2255-2270+2295' as rr2,  NVL(SUM(decode(KOD,'2290',0,decode(KOD,'2195',-1,'2250',-1,'2255',-1,'2270',-1,'2295',1,1)*S)),0) SR
          from fin_rnk   where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and  kod in ('2290','2190','2195','2200','2220','2240','2250','2255','2270','2295')
          UNION ALL
          select '4' as n,  'Чистий фынансовий результат (прибуток\збиток)' as txt, '2350' as rr,  NVL(SUM(decode(KOD,'2350',S,0)),0) SL,  '2290-2295-2300+2355+2305' as rr2, NVL(SUM(decode(KOD,'2350',0,decode(KOD,'2305',1,'2290',1,'2355',1,-1)*S)),0) SR
          from fin_rnk   where OKPO=:OKPO and FDAT=:DAT and idf=:nForm  and  kod in ('2350','2290','2295','2300','2355','2305')
          UNION ALL
          select '5' as n,  'Інший сукупній дохід до оподаткування' as txt, '2450' as rr,  NVL(SUM(decode(KOD,'2450',S,0)),0) SL,  '2400+2405+2410+2415+2445' as rr2,  NVL(SUM(decode(KOD,'2450',0,S)),0) SR
          from fin_rnk  where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and  kod in ('2450','2400','2405','2410','2415','2445')
          UNION ALL
          select '6' as n, 'Інший сукупній дохід після оподаткування' as txt, '2460' as rr, NVL(SUM(decode(KOD,'2460',S,0)),0) SL,  '2450-2455' as rr2,  NVL(SUM(decode(KOD,'2460',0,decode(KOD,'2450',1,-1)*S)),0) SR
          from fin_rnk where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and  kod in ('2460','2450','2455')
          UNION ALL
          select '7' as n,  'Сукупний дохід (сума рядків 2350, 2355 та 2460) ' as txt, '2465' as rr, NVL(SUM(decode(KOD,'2465',S,0)),0) SL,  '2350-2355+2460' as rr2,  NVL(SUM(decode(KOD,'2465',0,decode(KOD,'2355',-1,1)*S)),0) SR
          from fin_rnk   where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and  kod in ('2465','2350','2355','2460')
          UNION ALL
          select '8' as n,  'Разом (ІІІ ЕЛЕМЕНТИ ОПЕРАЦІЙНИХ ВИТРАТ)' as txt, '2550' as rr, NVL(SUM(decode(KOD,'2550',S,0)),0) SL,  '2500+2505+2510+2515+2520' as rr2,  NVL(SUM(decode(KOD,'2550',0,S)),0) SR
          from fin_rnk  where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and  kod in ('2550','2500','2505','2510','2515','2520')
          )
          where  2 = :nForm and  'N' = fin_nbu.F_FM(:OKPO, :DAT)


          union all
          select n, txt, rr, s, rr2, s2, s-s2 riz from (



          select '1' n,  'Чистий дохiд (виручка) вiд реалiзацiї продукцiї' txt,  '030' rr,   '010-020' rr2, SUM( decode(KOD,'030',S,0)) s,        SUM( decode(KOD,'030',0, Decode(KOD,'020',-1,1)*S) ) s2
          from fin_rnk
          where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and kod in ('030','010','020')

          union all
          select '2' n, 'Разом чистi доходи ' txt,  '070' rr,  '030+040+050' rr2, SUM(decode(KOD,'070',S,0)) s, SUM(decode(KOD,'070',0,S)) s2
          from fin_rnk  where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
          kod in ('070','030','040','050')

          union all
          select '3' n, 'Разом витрати ' txt,  '120' rr,  '080+090+100' rr2, SUM(decode(KOD,'120',S,0)) s, SUM(decode(KOD,'120',0,S)) s2
          from fin_rnk  where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
          kod in ('120','080','090','100')

          union all
          select '4' n,  'Фінансовий результат до оподаткування' txt,  '130' rr,   '070-120' rr2, SUM( decode(KOD,'130',S,0)) s,        SUM( decode(KOD,'130',0, Decode(KOD,'120',-1,1)*S) ) s2
          from fin_rnk
          where OKPO=:OKPO and FDAT=:DAT and idf=:nForm
          and kod in ('130','070','120')

          union all
          select '5' n,  'Чистий прибуток (збиток)' txt,  '150' rr,   '130-140-/+145' rr2, SUM( decode(KOD,'150',S,0)) s,        SUM( decode(KOD,'150',0, Decode(KOD,'140',-1,1)*S) ) s2
          from fin_rnk
          where OKPO=:OKPO and FDAT=:DAT and idf=:nForm
          and kod in ('150','130','140','145')

          )
          where 2 = :nForm and  'M' = fin_nbu.F_FM(:OKPO, :DAT)

          UNION ALL
          select n, txt, rr, s, rr2, s2, s-s2 riz from (
          select '1' n,  'Чистий дохiд (виручка) вiд реалiзацiї продукцiї' txt, '035' rr, '010–015–020-025–030' rr2,  SUM( decode(KOD,'035',S,0)) s,  SUM( decode(KOD,'035',0, Decode(KOD,'010',1,-1)*S) ) s2
          from fin_rnk
          where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and kod in
          ('035','010','015','020','025','030')
          UNION ALL
          select '2' n, 'Валовий прибуток' txt, '050' rr, '035–040+055' rr2,  SUM(decode(KOD,'050',S,0)) s,    SUM(decode(KOD,'050',0,decode(KOD,'040',-1,1)*S)) s2
          from fin_rnk  where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
          kod in ('050','035','040','055')
          UNION ALL
          select '3' n, 'Вiд операц.дiяльностi прибуток' txt,  '100' rr, '050-055+060–070–080–090+105' rr2, SUM(decode(KOD,'100',S,0)) s, SUM(decode(KOD,'100',0,decode(kod,'050',1,'060',1,'105',1,-1)*S)) s2
          from fin_rnk  where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
          kod in ('100', '050','055','060','070','080','090','105')
          UNION ALL
          select '4' n, 'Від звич.дiяльностi прибуток до оподат.:' txt, '170' rr, '100-105+110+120+130–140–150–160+165+175' rr2, SUM(decode(KOD,'170',S,0)) s,  SUM(decode(KOD,'170',0,decode(kod,'100',1,'110',1,'120',1,'130',1,'165',1,'175',1,-1)*S)) s2
          from fin_rnk  where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
          kod in ('170', '100','105','110','120','130','140','150','160','165','175' )
          UNION ALL
          select '5' n,  'Від звич.дiяльностi прибуток' txt,  '190' rr, '170-175-180+185+195' rr2, SUM(decode(KOD,'190',S,0)) s, SUM(decode(KOD,'190',0,decode(kod,'170',1,'195',1,'185',1,-1)*S)) s2
          from fin_rnk  where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
          kod in ('190', '170','175','185','180','195')
          UNION ALL
          select '6' n,  'Чистий прибуток' txt,  '220' rr,  '190-195+200–205-210+225-215' rr2,  SUM(decode(KOD,'220',S,0)) s,  SUM(decode(KOD,'220',0,decode(kod,'190',1,'200',1,'225',1,-1)*S)) s2
          from fin_rnk  where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
          kod in ('220', '190','195','200','205','210','225','215')
          UNION ALL
          select '7' n,  'II. ЕЛЕМЕНТИ ОПЕРАЦІЙНИХ ВИТРАТ' txt,  '280' rr,  '230+240+250+260+270+280' rr2,  SUM(decode(KOD,'280',S,0)) s,  SUM(decode(KOD,'280',0,S)) s2
          from fin_rnk  where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
          kod in ('280','230','240','250','260','270','280')
          )
          where 2 = :nForm and  ' ' = fin_nbu.F_FM(:OKPO, :DAT)

          union all

          /* Лог_чний контроль форми 2-R */
          select n, txt, rr, s, rr2, s2, s-s2 riz from (
          select '1' n,  'Разом доходи (2000 + 2120 + 2240)' txt,  '2280' rr,   '2000 + 2120 + 2240' rr2, SUM( decode(KOD,'2280',S,0)) s,        SUM( decode(KOD,'2280',0,S)) s2
          from fin_rnk
          where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and kod in ('2280','2000','2120','2240')

          union all
          select '2' n, 'Разом витрати (2050 + 2180 + 2270) ' txt,  '2285' rr,  '2050 + 2180 + 2270' rr2, SUM(decode(KOD,'2285',S,0)) s, SUM(decode(KOD,'2288',0,S)) s2
          from fin_rnk  where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
          kod in ('2285','2050','2180','2270')


          union all
          select '3' n, 'Фінансовий результат до оподаткування (2280 - 2285) ' txt,  '2290' rr,  '2280 - 2285' rr2, SUM(decode(KOD,'2290',S,0)) s, SUM(decode(KOD,'2290',0,decode(KOD,'2285',-1,1)*S)) s2
          from fin_rnk  where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
          kod in ('2290','2280','2285')

          union all
          select '4' n, 'Чистий прибуток (збиток) (2290 - 2300) ' txt,  '2350' rr,  '2290 - 2300' rr2, SUM(decode(KOD,'2350',S,0)) s, SUM(decode(KOD,'2350',0,decode(KOD,'2300',-1,1)*S)) s2
          from fin_rnk  where OKPO=:OKPO and FDAT=:DAT and idf=:nForm and
          kod in ('2350','2290','2300')
          )
          where 2 = :nForm and  'R' = fin_nbu.F_FM(:OKPO, :DAT)



          )
        </sql>
        <parameters>
          <parameter name="OKPO"  type="QueryString" datatype="Int64" >
        </parameter>
          <parameter name="DAT"  type="QueryString" datatype="DateTime">
        </parameter>
          <parameter name="nForm" type="QueryString" datatype="Int64">
        </parameter>
        </parameters>
      </datasource>

     <!--Опис колонок-->
      
      <fields>
        <field name="TXT" datatype="String" key="false" >
          <column caption="Стаття"  show="true" width="170" />
        </field>

        <field name="RR" datatype="String" key="false" >
          <column caption="Код рядка, що порівнюэться"  show="true" width="80" />
        </field>

          <field name="S" datatype="Decimal"  key="false" >
            <column caption="та його значення"  show="true" width="80" />
          </field>

            <field name="RR2" datatype="String"  key="false" >
              <column caption="Коди рядків, з якими порівнюються"  show="true" />
            </field>

              <field name="S2" datatype="Decimal"  key="false" >
                <column caption="та їх сумарне значення"  show="true" width="80" />
              </field>
        

          <field name="RIZ" datatype="Decimal"  key="false" >
            <column caption="Відхилення"  show="true" width="80" />
            <!--<layout>
              <colors scope="Column">
                <color color="clRed" operation="Equal" value="0.00"/>
                <color color="clBlue" operation="Great" value="0.00"/>
              </colors>
            </layout>-->
          </field>

        <field name="COL" datatype="Int64" key="false" >
          <column caption="COL"  show="false" />
          <layout>
            <colors scope="Column">
              <color color="clYellow" operation="Equal" value="0"/>
            </colors>
          </layout>
        </field>

      </fields>
      
      
    </grid>
    
  </grids>
</xmlform>
