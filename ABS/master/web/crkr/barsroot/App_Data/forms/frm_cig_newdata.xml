<xmlform captiontype="OnlyTitle">
  <grids>
    <grid id="gv" pagesize="10" showpagesizebox="true" title="Перегляд даних для передачі" >
      <datasource>
        <sql>
          select t.*, decode(t.cust_type2, 1, 'БН', 2, 'ЮО', 3, 'ФО', 4, 'ФОП') as cust_type_name,
          nvl(credit_sync_date, inst_sync_date) as fin_sync_date,
          nvl(credit_upd_date, inst_upd_date) as fin_upd_date,
          branch || dog_id as cig_contr_id ,
          decode(t.cust_type2, 2, 'frm_cig_compview', 1, 'frm_cig_compview', 'frm_cig_indview') as frm_name,
          decode(CONTRACT_TYPE,7,6,CONTRACT_TYPE) as CONTRACT_TYPE_FILTER,
          decode(CONTRACT_TYPE,7,RES_SUM,6,RES_SUM,null) as RESM_SUM,
          decode(CONTRACT_TYPE,7,null,6,null,RES_SUM) as RESO_SUM,
          decode(CONTRACT_TYPE,7,LIMIT_SUM,6,LIMIT_SUM,null) as LIMITM_SUM,
          decode(CONTRACT_TYPE,7,null,6,null,LIMIT_SUM) as LIMITO_SUM,
          decode(decode(contract_type,7,6,contract_type),
          1,
          'Стандартний кредит',
          2,
          'Кредитна лінія',
          3,
          'БПК',
          4,
          'Овердрафт',
          5,
          'Гарантія/акредитив',
          6,
          'МБК') as contract_type_txt
          from V_CIG_NEWDATA t order by upd_date
        </sql>
      </datasource>
      <rowselection method="SingleRow" />
      <filters buttontext="Пошук" caption="Фільтри" columnscount="2" width="100%">
        <filter caption="Тип клієнта" condition="Equal" columnindex="1" allowemptyvalue="true" field="CUST_TYPE2" id="f1" groupname="Клієнт">
          <uicontrol type="DropDownList" addemptyitem="true" table="(select '1' as val, 'БН' as txt from dual union all select '2' as val, 'ЮО' as txt from dual union all select '3' as val, 'ФО' as txt from dual union all select '4' as val, 'ФОП' as txt from dual)" keyfield="val" valuefield="txt" />
        </filter>
        <filter id="f2" caption="Код клієнта" condition="Equal" columnindex="1" field="CUST_ID" groupname="Клієнт">
          <uicontrol type="IntegerInput"></uicontrol>
        </filter>
        <filter id="f3" caption="Код клієнта (BARS)" condition="Equal" columnindex="1" field="RNK" groupname="Клієнт">
          <uicontrol type="IntegerInput"></uicontrol>
        </filter>
        <filter id="f4" caption="Назва клієнта" condition="LikeRight" columnindex="1" field="CUST_NAME" groupname="Клієнт">
          <uicontrol type="TextBox" controlwidth="200"></uicontrol>
        </filter>
        <filter id="f5" caption="Тип договора" condition="Equal" columnindex="2" allowemptyvalue="true" field="CONTRACT_TYPE_FILTER"  groupname="Договір">
          <uicontrol type="DropDownList" addemptyitem="true" table="(select '1' as val, 'Стандартний кредит' as txt from dual union all select '2' as val, 'Кредитна лінія' as txt from dual union all select '3' as val, 'БПК' as txt from dual union all select '4' as val, 'Овердрафт' as txt from dual union all select '5' as val, 'Гарантія/акредитив' as txt from dual union all select '6' as val, 'МБК' as txt from dual)" keyfield="val" valuefield="txt" />
        </filter>
        <filter id="f6" caption="Код договора" condition="Equal" columnindex="2" field="DOG_ID" groupname="Договір">
          <uicontrol type="IntegerInput"></uicontrol>
        </filter>
        <filter id="f7" caption="Код договора (BARS)" condition="Equal" columnindex="2" field="ND" groupname="Договір">
          <uicontrol type="IntegerInput"></uicontrol>
        </filter>
        <filter field="CUST_CODE" caption="Ідентифікаційний номер" allowemptyvalue="true" columnindex="1" condition="LikeRight" id="f8" groupname="Клієнт">
          <uicontrol controlwidth="200"></uicontrol>
        </filter>
        <filter columnindex="1" id="fbranch" groupname="Клієнт" field="BRANCH" condition="Equal" caption="Код відділення" allowemptyvalue="true">
          <uicontrol type="EditableReference" formname="frm_cig_branches" formfieldname="branch" formheight="450" formwidth="500"></uicontrol>
        </filter>
      </filters>
      <fields>
        <field name="BRANCH" key="true" datatype="String" sort="Default">
          <column show="true" caption="Код відділення" align="Left" />
        </field>
        <field name="UPD_DATE" key="false" datatype="DateTime" sort="Default">
          <column show="true" caption="Дата оновлення (клієнт)" align="Center" formatstring="{0:dd.MM.yyyy HH:mm:ss}" />
        </field>
        <field name="SYNC_DATE" key="false" datatype="DateTime" sort="Default">
          <column show="true" caption="Дата сихронізації (клієнт)" align="Center" formatstring="{0:dd.MM.yyyy HH:mm:ss}" />
        </field>
        <field name="DOG_UPD_DATE" key="false" datatype="DateTime" sort="Default">
          <column show="true" caption="Дата оновлення (договір)" align="Center" formatstring="{0:dd.MM.yyyy HH:mm:ss}" />
        </field>
        <field name="DOG_SYNC_DATE" key="false" datatype="DateTime" sort="Default">
          <column show="true" caption="Дата сихронізації(договір)" align="Center" formatstring="{0:dd.MM.yyyy HH:mm:ss}" />
        </field>
        <field name="FIN_UPD_DATE" key="false" datatype="DateTime" sort="Default">
          <column show="true" caption="Дата оновлення (фінансова інформація)" align="Center" formatstring="{0:dd.MM.yyyy HH:mm:ss}" />
        </field>
        <field name="FIN_SYNC_DATE" key="false" datatype="DateTime" sort="Default">
          <column show="true" caption="Дата сихронізації(фінансова інформація)" align="Center" formatstring="{0:dd.MM.yyyy HH:mm:ss}" />
        </field>
        <field name="CUST_NAME" key="false" datatype="String" sort="Default">
          <column show="true" caption="Назва клієнта" align="Left">
            <link url="/barsroot/barsweb/dynform.aspx" target="Blank">
              <parameters>
                <parameter type="DataField" name="FRM_NAME" altname="form" datatype="Int64" ></parameter>
                <parameter type="DataField" name="CUST_ID" altname="cust_id" datatype="Int64" ></parameter>
                <parameter type="DataField" name="BRANCH" altname="branch" datatype="String" ></parameter>
              </parameters>
            </link>
          </column>
        </field>
        <field name="CUST_CODE" key="false" datatype="String" sort="Default">
          <column show="true" caption="Ідентифікаційний номер" align="Left" width="300" />
        </field>
        <field name="CUST_TYPE" key="false" datatype="Int64" sort="Default">
          <column show="false" caption="Код клієнта" align="Right" />
        </field>
        <field name="CUST_TYPE_NAME" key="false" datatype="Int64" sort="Default">
          <column show="true" caption="Тип клієнта" align="Center" />
        </field>
        <field name="CUST_ID" key="false" datatype="Int64" sort="Default">
          <column show="true" caption="Код клієнта" align="Right" />
        </field>
        <field name="RNK" key="false" datatype="Int64" sort="Default">
          <column show="true" caption="Код клієнта(BARS)" align="Right" />
        </field>
        <field name="DOG_ID" key="false" datatype="Int64" sort="Default">
          <column show="true" caption="Код договора" align="Right" />
        </field>
        <field name="ND" key="false" datatype="Int64" sort="Default">
          <column show="true" caption="Код договора (BARS)" align="Right" />
        </field>
        <field name="PHASE_ID" key="false" datatype="Int64" sort="Default">
          <column show="true" caption="Фаза договору" align="Right" />
        </field>
        <field name="PAY_METHOD_ID" key="false" datatype="Int64" sort="Default">
          <column show="true" caption="Метод оплати" align="Right" />
        </field>
        <field name="PAY_PERIOD_ID" key="false" datatype="Int64" sort="Default">
          <column show="true" caption="Періодичність платежів" align="Right" />
        </field>
        <field name="CONTRACT_TYPE" key="false" datatype="Int64" sort="Default">
          <column show="true" caption="Код типу договору" align="Right" />
        </field>
        <field name="contract_type_txt" key="false" datatype="Int64" sort="Default">
          <column show="true" caption="Тип договору" align="Right" />
        </field>
        <field name="CONTRACT_TYPE_FILTER" datatype="Int64" sort="Default">
          <column show="false" caption="">
          </column>
          <form show="false"></form>
        </field>
        <field name="CIG_CONTR_ID" key="false" datatype="String" sort="Default">
          <column show="true" caption="Код договору (центр)" align="Left" />
        </field>
        <field name="CONTRACT_DATE" key="false" datatype="DateTime" sort="Default">
          <column show="true" caption="Дата договору" align="Center" />
        </field>
        <field name="CONTRACT_START_DATE" key="false" datatype="DateTime" sort="Default">
          <column show="true" caption="Дата початку дії" align="Center" />
        </field>
        <field name="CUR_NAME" key="false" datatype="String" sort="Default">
          <column show="true" caption="Валюта договору" align="Left" />
        </field>
        <field name="CREDIT_PURPOSE" key="false" datatype="Int64" sort="Default">
          <column show="true" caption="Мета фінансування" align="Right" />
        </field>
        <field name="NEGATIVE_STATUS" key="false" datatype="Int64" sort="Default">
          <column show="true" caption="Негативний статус" align="Right" />
        </field>
        <field name="APPLICATION_DATE" key="false" datatype="DateTime" sort="Default">
          <column show="true" caption="Дата заявки на кредит" align="Center" />
        </field>
        <field name="EXP_END_DATE" key="false" datatype="DateTime" sort="Default">
          <column show="true" caption="Очікувана дата завершення" align="Center" />
        </field>
        <field name="FACT_END_DATE" key="false" datatype="DateTime" sort="Default">
          <column show="true" caption="Фактична дата завершення" align="Center" />
        </field>
        <field name="CREDIT_ID" key="false" datatype="Int64" sort="Default">
          <column show="true" caption="Код даних (кред. лінія)" align="Right" />
        </field>
        <field name="LIMIT_SUM" key="false" datatype="Decimal" sort="Default">
          <column show="false" caption="Сума ліміту (кред. лінія)" align="Right" />
        </field>
        <field name="LIMITO_SUM" key="false" datatype="Decimal" sort="Default">
          <column show="true" caption="Сума ліміту (кред. лінія)" align="Right" />
        </field>
        <field name="CREDIT_UPD_DATE" key="false" datatype="DateTime" sort="Default">
          <column show="true" caption="Дата оновлення даних (кред. лінія)" align="Center" />
        </field>
        <field name="CREDIT_USAGE" key="false" datatype="Decimal" sort="Default">
          <column show="true" caption="Влаг використання ліміту(кред. лінія)" align="Right" />
        </field>
        <field name="RES_SUM" key="false" datatype="Decimal" sort="Default">
          <column show="false" caption="Сума залишку(кред. лінія)" align="Right" />
        </field>
        <field name="RESO_SUM" key="false" datatype="Decimal" sort="Default">
          <column show="true" caption="Сума залишку(кред. лінія)" align="Right" />
        </field>
        <field name="C_OVERDUE_SUM" key="false" datatype="Decimal" sort="Default">
          <column show="true" caption="Сума прострокованої заборгованості (кред. лінія)" align="Right" />
        </field>
        <field name="INSTALMENT_ID" key="false" datatype="Int64" sort="Default">
          <column show="true" caption="Код даних (станд. кредит)" align="Right" />
        </field>
        <field name="BODY_SUM" key="false" datatype="Decimal" sort="Default">
          <column show="true" caption="Загальна сума (станд. кредит)" align="Right" />
        </field>
        <field name="BODY_TOTAL_CNT" key="false" datatype="Int64" sort="Default">
          <column show="true" caption="Загальна кількість платежів (станд. кредит)" align="Right" />
        </field>
        <field name="INSTALMENT_SUM" key="false" datatype="Decimal" sort="Default">
          <column show="true" caption="Сума платежу кожного місяця (станд. кредит)" align="Right" />
        </field>
        <field name="OUTSTAND_CNT" key="false" datatype="Int64" sort="Default">
          <column show="true" caption="Кількість платежів, що підлягають сплаті в майбутньому  (станд. кредит)" align="Right" />
        </field>
        <field name="OUTSTAND_SUM" key="false" datatype="Decimal" sort="Default">
          <column show="true" caption="Сума, яка підлягає сплаті в майбутньому  (станд. кредит)" align="Right" />
        </field>
        <field name="OVERDUE_CNT" key="false" datatype="Int64" sort="Default">
          <column show="true" caption="Прострокована кількість платежів (станд. кредит)" align="Right" />
        </field>
        <field name="I_OVERDUE_SUM" key="false" datatype="Decimal" sort="Default">
          <column show="true" caption="Прострокована сума платежів (станд. кредит)" align="Right" />
        </field>
        <field name="RESM_SUM" key="false" datatype="Decimal" sort="Default">
          <column show="true" caption="Сума залишку(МБК)" align="Right" />
        </field>
        <field name="LIMITM_SUM" key="false" datatype="Decimal" sort="Default">
          <column show="true" caption="Сума ліміту (МБК)" align="Right" />
        </field>
      </fields>
    </grid>
  </grids>
</xmlform>