<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReportInfo.Created="09/21/2015 18:32:28" ReportInfo.Modified="10/07/2016 09:16:50" ReportInfo.CreatorVersion="2014.1.2.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;

namespace FastReport
{
  public class ReportScript
  {

   

   

    
  }
}
</ScriptText>
  <Dictionary>
    <OracleDataConnection Name="sberdev" ConnectionString="rijcmlqHytUMhhPg9gG4fal5Q6rRB0BvRbh0nDbCWvtDA1bLoVns6ffiXRmCcS4bnzDLLiAWofGqBOizC60bjaXAoTQJA==">
      <TableDataSource Name="Table" Alias="mbk" DataType="System.Int32" Enabled="true" SelectCommand="with &#13;&#10;qMain(kv,&#13;&#10;      row_num,&#13;&#10;      str_date,&#13;&#10;      avq_sum,&#13;&#10;      avg_coeff,&#13;&#10;      rest,&#13;&#10;      coeff) as&#13;&#10;         (select qq.kv,&#13;&#10;                 row_number() over (partition by qq.kv, qq.str_date order by qq.kv,qq.str_date) row_num,&#13;&#10;                 qq.str_date,                 &#13;&#10;                 sum(qq.rest) over(partition by qq.kv, qq.str_date order by qq.str_date, qq.kv) avq_sum,                &#13;&#10;                 round(sum(qq.rest_int) over(partition by qq.kv,&#13;&#10;                            qq.str_date order by qq.str_date,&#13;&#10;                            qq.kv) / sum(qq.rest)&#13;&#10;                       over(partition by qq.kv,&#13;&#10;                            qq.str_date order by qq.str_date,&#13;&#10;                            qq.kv),&#13;&#10;                       2) avg_coeff,&#13;&#10;                 qq.rest,&#13;&#10;                 qq.coeff&#13;&#10;            from (select q.kv,&#13;&#10;                         to_char(q.p_date, 'dd.mm.yyyy') str_date,&#13;&#10;                         sum(q.rest) / 100 rest,&#13;&#10;                         sum(q.rest_int) / 100 rest_int,&#13;&#10;                         q.coeff&#13;&#10;                    from (select a.acc,&#13;&#10;                                 a.kv,&#13;&#10;                                 dat.p_date,&#13;&#10;                                 substr(nls, 1, 4) balance_account,&#13;&#10;                                 fost(acc, dat.p_date) rest,&#13;&#10;                                 get_int_rate(acc, dat.p_date) coeff,&#13;&#10;                                 fost(acc, dat.p_date) * get_int_rate(acc, dat.p_date) rest_int&#13;&#10;                            from accounts a,&#13;&#10;                                 (select :p_end_date + 1 - level p_date&#13;&#10;                                    from dual&#13;&#10;                                  connect by level &lt;= (:p_end_date - :p_begin_date + 1)) dat&#13;&#10;                           where a.nls not in&#13;&#10;                                 (select nlsa from cp_accc where nlsa is not null)&#13;&#10;                             and substr(a.nls, 1, 4) in ('1430', '1440')&#13;&#10;                             and (a.dazs is null or a.dazs &gt;= :p_begin_date)&#13;&#10;                             and :p_kv in (0, a.kv)) q&#13;&#10;                   group by to_char(q.p_date, 'dd.mm.yyyy'), q.coeff, q.kv&#13;&#10;                  having sum(q.rest) &lt;&gt; 0) qq)&#13;&#10;select kv,row_num, str_date, avq_sum, avg_coeff, rest, coeff&#13;&#10;  from qMain&#13;&#10;union all&#13;&#10;   select qMain.kv,&#13;&#10;          0 row_num,&#13;&#10;          ' Средне зваж' as str_date,&#13;&#10;          s.avq_sum,           &#13;&#10;          s.avg_coeff,           &#13;&#10;          round(sum(rest) / (:p_end_date - :p_begin_date + 1), 2)rest,&#13;&#10;          coeff  &#13;&#10;     from qMain,&#13;&#10;          (select kv,&#13;&#10;                  round(sum(avg_coeff) / (:p_end_date - :p_begin_date + 1), 2)avg_coeff, &#13;&#10;                  round(sum(avq_sum) / (:p_end_date - :p_begin_date + 1), 2)avq_sum                 &#13;&#10;            from qMain      &#13;&#10;            where row_num=1 &#13;&#10;            group by kv)s&#13;&#10;     where qMain.kv=s.kv  &#13;&#10;     group by qMain.kv,qMain.coeff,s.avq_sum,s.avg_coeff          &#13;&#10; order by 1,3,7">
        <Column Name="KV" DataType="System.Decimal"/>
        <Column Name="STR_DATE" DataType="System.String"/>
        <Column Name="REST" DataType="System.Decimal"/>
        <Column Name="COEFF" DataType="System.Decimal"/>
        <Column Name="AVQ_SUM" DataType="System.Decimal"/>
        <Column Name="AVG_COEFF" DataType="System.Decimal"/>
        <Column Name="ROW_NUM" DataType="System.Decimal"/>
        <CommandParameter Name="p_begin_date" DataType="106" Expression="[sFdat1]" DefaultValue="01/07/2015"/>
        <CommandParameter Name="p_end_date" DataType="106" Expression="[sFdat2]" DefaultValue="31/07/2015"/>
        <CommandParameter Name="p_kv" DataType="111" Expression="[p_kv]" DefaultValue="0"/>
      </TableDataSource>
      <TableDataSource Name="Table1" Alias="QStrDate" DataType="System.Int32" Enabled="true" SelectCommand="select f_dat_lit(:p_begin_date) p_from_date,&#13;&#10;          f_dat_lit(:p_end_date) p_to_date&#13;&#10;  from dual ">
        <Column Name="P_FROM_DATE" DataType="System.String"/>
        <Column Name="P_TO_DATE" DataType="System.String"/>
        <CommandParameter Name="p_begin_date" DataType="106" Expression="[sFdat1]" DefaultValue="01/07/2015"/>
        <CommandParameter Name="p_end_date" DataType="106" Expression="[sFdat2]" DefaultValue="31/07/2015"/>
      </TableDataSource>
    </OracleDataConnection>
    <Parameter Name="sFdat1" DataType="System.DateTime"/>
    <Parameter Name="sFdat2" DataType="System.DateTime"/>
    <Parameter Name="p_kv" DataType="System.Int16"/>
  </Dictionary>
  <ReportPage Name="Page1" Landscape="true" PaperWidth="297" PaperHeight="210" RawPaperSize="9" FirstPageSource="15" OtherPagesSource="15">
    <ReportTitleBand Name="ReportTitle1" Width="1047.06" Height="28.35">
      <TextObject Name="Text1" Left="47.25" Width="727.65" Height="28.35" Text="Розшифровка Д. С. за період з [QStrDate.P_FROM_DATE] по [QStrDate.P_TO_DATE]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold">
        <Formats>
          <DateFormat/>
          <DateFormat/>
        </Formats>
      </TextObject>
    </ReportTitleBand>
    <GroupHeaderBand Name="GroupHeader1" Top="29.83" Width="1047.06" Height="51.85" Condition="[mbk.KV]">
      <MatrixObject Name="Matrix1" Left="-0.37" Top="0.37" Width="504.32" Height="51.48" Border.Lines="All" FixedRows="1" FixedColumns="4" AutoSize="false" CellsSideBySide="true" DataSource="Table">
        <MatrixColumns>
          <Header Expression="[mbk.COEFF]" Sort="None" Totals="false"/>
        </MatrixColumns>
        <MatrixRows>
          <Header Expression="[mbk.STR_DATE]" Totals="false"/>
          <Header Expression="[mbk.KV]" Totals="false"/>
          <Header Expression="[mbk.AVQ_SUM]" Totals="false"/>
          <Header Expression="[mbk.AVG_COEFF]" Totals="false"/>
        </MatrixRows>
        <MatrixCells>
          <Cell Expression="[mbk.REST]"/>
        </MatrixCells>
        <TableColumn Name="Column29" Width="70.81"/>
        <TableColumn Name="Column30" Width="36.61"/>
        <TableColumn Name="Column31" Width="189"/>
        <TableColumn Name="Column32" Width="94.5"/>
        <TableColumn Name="Column33" Width="113.4"/>
        <TableRow Name="Row3" Height="35.33">
          <TableCell Name="Cell29" Border.Lines="All" Text="Дата" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
          <TableCell Name="Cell30" Border.Lines="All" Text="Вал." HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
          <TableCell Name="Cell35" Border.Lines="All" Text="Розмiщено НБУ ДЕП.C &#13;&#10;сума 13-А" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
          <TableCell Name="Cell37" Border.Lines="All" Text="ср.% &#13;&#10;13-Б" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
          <TableCell Name="Cell39" Border.Lines="All" Text="[COEFF]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
        </TableRow>
        <TableRow Name="Row4" Height="16.15">
          <TableCell Name="Cell31" Border.Lines="All" Text="[STR_DATE]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt"/>
          <TableCell Name="Cell32" Border.Lines="All" Text="[KV]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt"/>
          <TableCell Name="Cell36" Border.Lines="All" Text="[AVQ_SUM]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt"/>
          <TableCell Name="Cell38" Border.Lines="All" Text="[AVG_COEFF]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt"/>
          <TableCell Name="Cell40" Border.Lines="All" Text="[REST]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="2" Format.DecimalSeparator="." Format.GroupSeparator=" " Format.NegativePattern="1" HorzAlign="Right" VertAlign="Center" Font="Times New Roman, 8pt"/>
        </TableRow>
      </MatrixObject>
      <DataBand Name="Data1" Top="83.16" Width="1047.06" CanGrow="true" DataSource="Table" PrintIfDatasourceEmpty="true"/>
      <GroupFooterBand Name="GroupFooter1" Top="84.64" Width="1047.06"/>
    </GroupHeaderBand>
  </ReportPage>
</Report>
