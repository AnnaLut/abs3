<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReportInfo.Created="04/23/2014 14:35:45" ReportInfo.Modified="01/12/2018 15:12:34" ReportInfo.CreatorVersion="2014.1.2.0">
  <Dictionary>
    <OracleDataConnection Name="sberdev" ConnectionString="rijcmlqD6nWZEExUJ9MEhdFZpB1A6ZfSeiTM+6WLeB8pW5aURqkGwhV134I2SUIQGUGXcXiIK88K3oydtamgd3HfDT1yQ==" CommandTimeout="500">
      <TableDataSource Name="Table" Alias="LST_DPT" DataType="System.Int32" Enabled="true" SelectCommand="select distinct  &#13;&#10;        t.type_name,&#13;&#10;        to_char(dd.datz,'dd.mm.yyyy') as DATZ,&#13;&#10;        dd.nd, &#13;&#10;        dd.rnk,&#13;&#10;        c.nmk,&#13;&#10;        c.okpo,&#13;&#10;        S.FIO,&#13;&#10;        T0.NAME,&#13;&#10;        dd.branch,        &#13;&#10;        S.LOGNAME,&#13;&#10;        to_char(dd.datz,'YYYYMMDD')&#13;&#10;from dpt_deposit_clos dd,&#13;&#10;        dpt_vidd v, &#13;&#10;        dpt_types t, &#13;&#10;        customer c, &#13;&#10;        staff$base s,&#13;&#10;        tobo t0&#13;&#10;where  DD.VIDD= V.VIDD   &#13;&#10;and T.TYPE_ID = V.TYPE_ID&#13;&#10;and c.rnk = dd.rnk&#13;&#10;and S.ID = Dd.USERID&#13;&#10;and t0.TOBO =DD.BRANCH &#13;&#10;and dd.action_id = 0&#13;&#10;and dd.datz  between :sFdat1 and :sFdat2&#13;&#10;and dd.branch like decode(:BRANCH, 'Поточне',  sys_context ('bars_context', 'user_branch'),:BRANCH)||'%'&#13;&#10;and exists (select 1 from ead_docs where agr_id = dd.deposit_id and sign_date is not null and page_count &gt;0)&#13;&#10;order by to_char(dd.datz,'YYYYMMDD')">
        <Column Name="TYPE_NAME" DataType="System.String"/>
        <Column Name="DATZ" DataType="System.String"/>
        <Column Name="ND" DataType="System.String"/>
        <Column Name="RNK" DataType="System.Decimal"/>
        <Column Name="NMK" DataType="System.String"/>
        <Column Name="OKPO" DataType="System.String"/>
        <Column Name="FIO" DataType="System.String"/>
        <Column Name="NAME" DataType="System.String"/>
        <Column Name="BRANCH" DataType="System.String"/>
        <Column Name="LOGNAME" DataType="System.String"/>
        <CommandParameter Name="sFdat1" DataType="106" Expression="[sFdat1]"/>
        <CommandParameter Name="sFdat2" DataType="106" Expression="[sFdat2]"/>
        <CommandParameter Name="BRANCH" DataType="126" Expression="[BRANCH]"/>
      </TableDataSource>
      <TableDataSource Name="Table3" Alias="Totals" DataType="System.Int32" Enabled="true" SelectCommand="select basic.lvl0, basic.lvl1,basic.lvl2, &#13;&#10;         case when basic.numrow in (2,5) then ''&#13;&#10;                else nvl(to_char(fill.count_),'-')&#13;&#10;         end as count_ &#13;&#10;from &#13;&#10;(select 0 numrow, 'Всього відкритих  депозитів (договорів), шт.:' lvl0,'' lvl1,'' lvl2, '!' code from dual union all&#13;&#10;select 1,'', 'Відкрито на ім''я, всього, шт.:', '', 'A' from dual union all&#13;&#10;select 2,'', 'в тому числі: ', '', 'A-1' from dual union all&#13;&#10;select 3,'','', replace(replace(mark_name,'ий', 'их'),'ій', 'іх'),'A'||to_char(mark_code)||to_char(nvl(open_self,1))&#13;&#10;from   cust_mark_types&#13;&#10;where open_self = 1&#13;&#10;union all&#13;&#10;select 4,'','Відкрито на користь, всього, шт.:','','B' from dual union all&#13;&#10;select 5,'', 'в тому числі: ', '', 'B-1' from dual union all&#13;&#10;select 6,'','', replace(replace(mark_name,'ий', 'их'),'ій', 'іх'),'B'||to_char(mark_code)||to_char(nvl(open_self,1))&#13;&#10;from   cust_mark_types) basic&#13;&#10;left  join &#13;&#10; (select a.title, a.count_ count_ from&#13;&#10; (select   distinct nvl((nvl(decode(b.typ_tr,'A','A','B','B','C','B'),'A')||to_char(nvl(to_char(decode(b.typ_tr,'C','0',cmt.mark_code)), '-'))||to_char(nvl(decode(b.typ_tr,'C','0',cmt.open_self),1))),'!') as title,                            &#13;&#10;               nvl(count(p.deposit_id),0) count_                                                 &#13;&#10; from dpt_deposit_clos p&#13;&#10; left join customerw cw on cw.rnk in p.rnk and cw.tag = 'SPMRK'&#13;&#10; left join cust_mark_types cmt on cmt.mark_code = cw.value                                &#13;&#10; left join (select distinct dpt_id, typ_tr, rnk_tr from dpt_trustee b1 where b1.typ_tr in ('B','C') and fl_act = 1) b  on b.dpt_id = p.deposit_id &#13;&#10; where p.action_id =0&#13;&#10;  and p.dat_begin  between :sfdat1 and :sfdat2&#13;&#10;  and p.branch like decode(:branch, 'Поточне',  sys_context ('bars_context', 'user_branch'),:branch)||'%'&#13;&#10;  and exists (select 1 from ead_docs where agr_id = p.deposit_id and sign_date is not null and page_count &gt;0)&#13;&#10;  group by grouping sets(&#13;&#10;                                    (),&#13;&#10;                                    (nvl(decode(b.typ_tr,'A','A','B','B','C','B'),'A')),&#13;&#10;                                    (nvl(decode(b.typ_tr,'A','A','B','B','C','B'),'A'),nvl(to_char(decode(b.typ_tr,'C','0',cmt.mark_code)), '-'),nvl(decode(b.typ_tr,'C','0',cmt.open_self),1))&#13;&#10;                                    )&#13;&#10;  order by nvl((nvl(b.typ_tr,'A')||to_char(nvl(cmt.mark_code, null))||to_char(nvl(cmt.open_self,1))),'!')&#13;&#10;  ) a&#13;&#10;  where a.title is not null) fill on fill.title = basic.code&#13;&#10;  order by basic.numrow ">
        <Column Name="COUNT_" DataType="System.Decimal"/>
        <Column Name="LVL0" DataType="System.String"/>
        <Column Name="LVL1" DataType="System.String"/>
        <Column Name="LVL2" DataType="System.String"/>
        <CommandParameter Name="sFdat1" DataType="106" Expression="[sFdat1]" DefaultValue="01/08/2014"/>
        <CommandParameter Name="sFdat2" DataType="106" Expression="[sFdat2]" DefaultValue="31/08/2014"/>
        <CommandParameter Name="BRANCH" DataType="126" Expression="[BRANCH]" DefaultValue="%"/>
      </TableDataSource>
    </OracleDataConnection>
    <Parameter Name="sFdat1" DataType="System.DateTime"/>
    <Parameter Name="sFdat2" DataType="System.DateTime"/>
    <Parameter Name="BRANCH" DataType="System.String"/>
  </Dictionary>
  <ReportPage Name="Page1" Landscape="true" PaperWidth="297" PaperHeight="210" RawPaperSize="9" FirstPageSource="15" OtherPagesSource="15">
    <ReportTitleBand Name="ReportTitle1" Width="1047.06" Height="60.48">
      <TextObject Name="Text2" Left="11.34" Top="9.45" Width="824.04" Height="18.9" Text="Звіт по вкладах фізичних осіб, відкритих за період" HorzAlign="Center" VertAlign="Center" Font="Arial, 12pt"/>
      <TextObject Name="Text3" Left="11.34" Top="34.02" Width="824.04" Height="18.9" Text="з [FormatDateTime([sFdat1])] по [FormatDateTime([sFdat2])] " HorzAlign="Center" VertAlign="Center"/>
    </ReportTitleBand>
    <GroupHeaderBand Name="GroupHeader1" Top="63.68" Width="1047.06" Height="75.6" Condition="[LST_DPT.NAME]">
      <TableObject Name="Table2" Left="7.56" Top="28.35" Width="939.33" Height="45.36">
        <TableColumn Name="Column11" Width="32.13"/>
        <TableColumn Name="Column12" Width="209.79"/>
        <TableColumn Name="Column13"/>
        <TableColumn Name="Column14"/>
        <TableColumn Name="Column15"/>
        <TableColumn Name="Column16" Width="232.47"/>
        <TableColumn Name="Column17" Width="119.07"/>
        <TableColumn Name="Column18" Width="147.42"/>
        <TableRow Name="Row2" Height="45.36">
          <TableCell Name="Cell32" Border.Lines="All" Border.Width="0.25" Fill.Color="WhiteSmoke" Text="№ п/п" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt"/>
          <TableCell Name="Cell33" Border.Lines="All" Border.Width="0.25" Fill.Color="WhiteSmoke" Text="Тип депозитного договору" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt"/>
          <TableCell Name="Cell34" Border.Lines="All" Border.Width="0.25" Fill.Color="WhiteSmoke" Text="Дата відкриття" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt"/>
          <TableCell Name="Cell35" Border.Lines="All" Border.Width="0.25" Fill.Color="WhiteSmoke" Text="№ договору" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt"/>
          <TableCell Name="Cell36" Border.Lines="All" Border.Width="0.25" Fill.Color="WhiteSmoke" Text="PHK" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt"/>
          <TableCell Name="Cell37" Border.Lines="All" Border.Width="0.25" Fill.Color="WhiteSmoke" Text="ПІБ" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt"/>
          <TableCell Name="Cell38" Border.Lines="All" Border.Width="0.25" Fill.Color="WhiteSmoke" Text="ІПН" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt"/>
          <TableCell Name="Cell39" Border.Lines="All" Border.Width="0.25" Fill.Color="WhiteSmoke" Text="Виконавець" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt"/>
        </TableRow>
      </TableObject>
      <TextObject Name="Text1" Left="7.56" Top="7.56" Width="476.28" Height="18.9" Text="[LST_DPT.NAME]"/>
      <DataBand Name="Data1" Top="142.48" Width="1047.06" Height="18.9" DataSource="Table">
        <TableObject Name="Table1" Left="7.56" Width="939.65" Height="18.9">
          <TableColumn Name="Column1" Width="32.17"/>
          <TableColumn Name="Column2" Width="209.83"/>
          <TableColumn Name="Column3" Width="66.19"/>
          <TableColumn Name="Column4" Width="66.19"/>
          <TableColumn Name="Column5" Width="66.19"/>
          <TableColumn Name="Column6" Width="232.51"/>
          <TableColumn Name="Column7" Width="119.11"/>
          <TableColumn Name="Column8" Width="147.46"/>
          <TableRow Name="Row1">
            <TableCell Name="Cell1" Border.Lines="All" Border.Width="0.25" Text="[Row#]" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt"/>
            <TableCell Name="Cell2" Border.Lines="All" Border.Width="0.25" Text="[LST_DPT.TYPE_NAME]" VertAlign="Center" Font="Arial, 8pt"/>
            <TableCell Name="Cell3" Border.Lines="All" Border.Width="0.25" Text="[LST_DPT.DATZ]" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt"/>
            <TableCell Name="Cell4" Border.Lines="All" Border.Width="0.25" Text="[LST_DPT.ND]" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt"/>
            <TableCell Name="Cell5" Border.Lines="All" Border.Width="0.25" Text="[LST_DPT.RNK]" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt"/>
            <TableCell Name="Cell27" Border.Lines="All" Border.Width="0.25" Text="[LST_DPT.NMK]" VertAlign="Center" Font="Arial, 8pt"/>
            <TableCell Name="Cell28" Border.Lines="All" Border.Width="0.25" Text="[LST_DPT.OKPO]" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt"/>
            <TableCell Name="Cell29" Border.Lines="All" Border.Width="0.25" Text="[LST_DPT.FIO]" VertAlign="Center" Font="Arial, 8pt"/>
          </TableRow>
        </TableObject>
      </DataBand>
      <GroupFooterBand Name="GroupFooter1" Top="164.58" Width="1047.06" Height="15.12"/>
    </GroupHeaderBand>
    <DataBand Name="Data2" Top="182.9" Width="1047.06" Height="18.9" DataSource="Table3">
      <TableObject Name="Table4" Left="7.56" Width="737.1" Height="18.9" Border.Lines="All" Border.Width="0.25">
        <TableColumn Name="Column19" Width="266.49"/>
        <TableColumn Name="Column20" Width="192.78"/>
        <TableColumn Name="Column21" Width="158.76"/>
        <TableColumn Name="Column22" Width="119.07"/>
        <TableRow Name="Row3">
          <TableCell Name="Cell40" Border.Lines="All" Border.Width="0.25" Text="[Totals.LVL0]" Font="Arial, 8pt"/>
          <TableCell Name="Cell61" Border.Lines="All" Border.Width="0.25" Text="[Totals.LVL1]" Font="Arial, 8pt"/>
          <TableCell Name="Cell62" Border.Lines="All" Border.Width="0.25" Text="[Totals.LVL2]" HorzAlign="Right" Font="Arial, 8pt"/>
          <TableCell Name="Cell63" Border.Lines="All" Border.Width="0.25" Text="[Totals.COUNT_]" HideZeros="true" HorzAlign="Center" Font="Arial, 8pt"/>
        </TableRow>
      </TableObject>
    </DataBand>
    <PageFooterBand Name="PageFooter1" Top="205" Width="1047.06" Height="94.5"/>
  </ReportPage>
</Report>
