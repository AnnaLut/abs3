<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReportInfo.Created="04/05/2016 16:30:44" ReportInfo.Modified="10/22/2018 12:58:43" ReportInfo.CreatorVersion="2014.3.2.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;

namespace FastReport
{
  public class ReportScript
  {
    public String PERIOD
    {
      get 
      {
        try{
          DateTime DateFrom = ((DateTime)Report.GetParameterValue(&quot;sFdat1&quot;));
          DateTime DateTo = ((DateTime)Report.GetParameterValue(&quot;sFdat2&quot;));
      
          TimeSpan ts = DateTo - DateFrom; // Difference in days, hours, and minutes.
          int differenceInDays = ts.Days; // Difference in days.
          if (differenceInDays == 0)
          {
            return (&quot;за &quot; + ((DateTime)Report.GetParameterValue(&quot;sFdat1&quot;)).ToString(&quot;dd.MM.yyyy&quot;));
          }
          else
          {
            return (&quot;за період з &quot; + ((DateTime)Report.GetParameterValue(&quot;sFdat1&quot;)).ToString(&quot;dd.MM.yyyy&quot;) + &quot; по &quot; + ((DateTime)Report.GetParameterValue(&quot;sFdat2&quot;)).ToString(&quot;dd.MM.yyyy&quot;));
          }
        }
        catch
        {
          return &quot;&quot;;
        }
      }
    }
  }
}
</ScriptText>
  <Dictionary>
    <OracleDataConnection Name="SBERDEV" ConnectionString="rijcmlqHytUMhhPg9gG4fal5Q6rRB0BvRbh0nDbCWvtDA1bLoXA5F1HMEY1qSyYCzmMlYGK5S75auXYOG6vOu2k3E2pQLrHJjoCfc5hZ7AIFg5nGe8=">
      <TableDataSource Name="Table" DataType="System.Int32" Enabled="true" SelectCommand="select rownum as npp,&#13;&#10;       c.corporation_name,&#13;&#10;       case when b.mfou = 300465 then b.mfo else null end as mfo_obu,&#13;&#10;       case when b.mfou != 300465 then b.mfo else null end as mfo_other,&#13;&#10;       case when b.mfou != 300465 then b.nb else null end as nb_other,&#13;&#10;       d.okpoa,&#13;&#10;       d.nama,&#13;&#10;       nvl(d.sq / 100,0) as sq,&#13;&#10;       to_number(:Param0) as korp_id,&#13;&#10;       to_number(a.kf) as mfo&#13;&#10;  from ob_corp_data_acc a&#13;&#10;  join v_ob_corp_rep_nbs q on q.rep_id = 5033 and q.nbs = substr(a.nls,1,4) and Q.CORP_ID = a.corp_id&#13;&#10;  join ob_corp_data_doc d on A.ACC = d.acc and A.SESS_ID = d.sess_id and a.kf = d.kf&#13;&#10;  left join banks$base b on d.mfoa = b.mfo&#13;&#10;  left join v_org_corporations c on c.external_id = a.kod_ustan and c.base_extid=to_char(a.corp_id)&#13;&#10;  where d.dk = 1&#13;&#10;    and a.is_last = 1&#13;&#10;    and case when replace(:KF, ' ', '') = '%' then nvl(a.kf,' ') else replace(:KF, ' ', '') end like '%'||nvl(a.kf,' ')||'%'&#13;&#10;    and a.corp_id = :Param0&#13;&#10;    and a.fdat BETWEEN :sFdat1 AND :sFdat2&#13;&#10;    and substr(d.nlsb, 1, 4) = '2603'&#13;&#10;    and substr(d.nlsa, 1, 4) in ('2600', '2602', '2604', '2062', '2063', '2610', '2520', '2541', '2542', '2650')&#13;&#10;    and case when replace(:kod_analyt, ' ', '') = '%' then nvl(a.kod_analyt,' ') else replace(:kod_analyt, ' ', '') end like '%'||nvl(a.kod_analyt,' ')||'%'">
        <Column Name="NPP" DataType="System.Decimal"/>
        <Column Name="CORPORATION_NAME" DataType="System.String"/>
        <Column Name="MFO_OBU" DataType="System.String"/>
        <Column Name="MFO_OTHER" DataType="System.String"/>
        <Column Name="NB_OTHER" DataType="System.String"/>
        <Column Name="OKPOA" DataType="System.String"/>
        <Column Name="NAMA" DataType="System.String"/>
        <Column Name="SQ" DataType="System.Decimal"/>
        <Column Name="KORP_ID" DataType="System.Decimal"/>
        <Column Name="MFO" DataType="System.Decimal"/>
        <CommandParameter Name="kf" DataType="126" Expression="[KF]" DefaultValue="000000"/>
        <CommandParameter Name="sFdat1" DataType="106" Expression="[sFdat1]" DefaultValue="01.01.1900"/>
        <CommandParameter Name="sFdat2" DataType="106" Expression="[sFdat2]" DefaultValue="01.01.1900"/>
        <CommandParameter Name="kod_analyt" DataType="126" Expression="[kod_analyt]"/>
        <CommandParameter Name="Param0" DataType="113" Expression="[Param0]" DefaultValue="0"/>
      </TableDataSource>
      <TableDataSource Name="Table3" DataType="System.Int32" Enabled="true" SelectCommand="select c.corporation_name from ob_corporation c where c.id = :corp_id">
        <Column Name="CORPORATION_NAME" DataType="System.String"/>
        <CommandParameter Name="corp_id" DataType="113" Expression="[Param0]" DefaultValue="0"/>
      </TableDataSource>
      <TableDataSource Name="Table4" DataType="System.Int32" Enabled="true" SelectCommand="select b.name from clim_mfo b where b.mfo = :mfo">
        <Column Name="NAME" DataType="System.String"/>
        <CommandParameter Name="mfo" DataType="126" Expression="[KF]" DefaultValue="000000"/>
      </TableDataSource>
    </OracleDataConnection>
    <Parameter Name="Param0" DataType="System.Int64"/>
    <Parameter Name="KF" DataType="System.String"/>
    <Parameter Name="kod_analyt" DataType="System.String"/>
    <Parameter Name="sFdat1" DataType="System.DateTime"/>
    <Parameter Name="sFdat2" DataType="System.DateTime"/>
  </Dictionary>
  <ReportPage Name="Page1" Landscape="true" PaperWidth="297" PaperHeight="210" RawPaperSize="9" FirstPageSource="15" OtherPagesSource="15">
    <ReportTitleBand Name="ReportTitle1" Width="1047.06" Height="103.95">
      <TableObject Name="Table1" Top="56.7" Width="1048.95" Height="47.25">
        <TableColumn Name="Column1" Width="37.8"/>
        <TableColumn Name="Column2" Width="226.8"/>
        <TableColumn Name="Column3" Width="75.6"/>
        <TableColumn Name="Column4" Width="75.6"/>
        <TableColumn Name="Column5" Width="226.8"/>
        <TableColumn Name="Column6" Width="103.95"/>
        <TableColumn Name="Column7" Width="189"/>
        <TableColumn Name="Column8" Width="113.4"/>
        <TableRow Name="Row1" Height="28.35">
          <TableCell Name="Cell1" Border.Lines="All" Fill.Color="DarkGray" Text="№ з/п" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell2" Border.Lines="All" Fill.Color="DarkGray" Text="Назва клієнта - отримувача" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell3" Border.Lines="All" Fill.Color="DarkGray" Text="МФО Ощадбанку" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell4" Border.Lines="All" Fill.Color="DarkGray" Text="МФО інші банки" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell5" Border.Lines="All" Fill.Color="DarkGray" Text="Назва іншого банку платника" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell26" Border.Lines="All" Fill.Color="DarkGray" Text="ЄДРПОУ клієнта-платника" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell27" Border.Lines="All" Fill.Color="DarkGray" Text="Назва клієнта-платника" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell28" Border.Lines="All" Fill.Color="DarkGray" Text="Кредитовий оборот" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
        </TableRow>
        <TableRow Name="Row2">
          <TableCell Name="Cell6" Border.Lines="All" Fill.Color="DarkGray" Text="1" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell7" Border.Lines="All" Fill.Color="DarkGray" Text="2" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell8" Border.Lines="All" Fill.Color="DarkGray" Text="3" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell9" Border.Lines="All" Fill.Color="DarkGray" Text="4" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell10" Border.Lines="All" Fill.Color="DarkGray" Text="5" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell29" Border.Lines="All" Fill.Color="DarkGray" Text="6" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell30" Border.Lines="All" Fill.Color="DarkGray" Text="7" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
          <TableCell Name="Cell31" Border.Lines="All" Fill.Color="DarkGray" Text="8" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
        </TableRow>
      </TableObject>
      <TextObject Name="Text1" Width="1048.95" Height="18.9" Text="Інформація" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text2" Top="18.9" Width="1048.95" Height="18.9" Text="щодо бази клієнтів-платників ПЕК ([Table3.CORPORATION_NAME])" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
      <TextObject Name="Text3" Top="37.8" Width="1048.95" Height="18.9" Text="[PERIOD] по [Table4.NAME] регіональному управлінню" HorzAlign="Center" VertAlign="Center" Font="Arial, 8pt, style=Bold"/>
    </ReportTitleBand>
    <DataBand Name="Data1" Top="107.95" Width="1047.06" Height="18.9" CanGrow="true" DataSource="Table" KeepTogether="true">
      <TableObject Name="Table2" Width="1048.95" Height="18.9" Border.Lines="All" CanBreak="false">
        <TableColumn Name="Column9" Width="37.8"/>
        <TableColumn Name="Column10" Width="226.8"/>
        <TableColumn Name="Column11" Width="75.6"/>
        <TableColumn Name="Column12" Width="75.6"/>
        <TableColumn Name="Column13" Width="226.8"/>
        <TableColumn Name="Column14" Width="103.95"/>
        <TableColumn Name="Column15" Width="189"/>
        <TableColumn Name="Column16" Width="113.4"/>
        <TableRow Name="Row3" AutoSize="true">
          <TableCell Name="Cell32" Border.Lines="All" Text="[Table.NPP]" VertAlign="Center" Font="Arial, 8pt"/>
          <TableCell Name="Cell33" Border.Lines="All" Text="[Table.CORPORATION_NAME]" VertAlign="Center" Font="Arial, 8pt"/>
          <TableCell Name="Cell34" Border.Lines="All" Text="[Table.MFO_OBU]" VertAlign="Center" Font="Arial, 8pt"/>
          <TableCell Name="Cell35" Border.Lines="All" Text="[Table.MFO_OTHER]" VertAlign="Center" Font="Arial, 8pt"/>
          <TableCell Name="Cell36" Border.Lines="All" Text="[Table.NB_OTHER]" VertAlign="Center" Font="Arial, 8pt"/>
          <TableCell Name="Cell57" Border.Lines="All" Text="[Table.OKPOA]" VertAlign="Center" Font="Arial, 8pt"/>
          <TableCell Name="Cell58" Border.Lines="All" Text="[Table.NAMA]" VertAlign="Center" Font="Arial, 8pt"/>
          <TableCell Name="Cell59" Border.Lines="All" Text="[Table.SQ]" VertAlign="Center" Font="Arial, 8pt"/>
        </TableRow>
      </TableObject>
      <Sort>
        <Sort Expression="[Table.NPP]"/>
      </Sort>
    </DataBand>
  </ReportPage>
</Report>
