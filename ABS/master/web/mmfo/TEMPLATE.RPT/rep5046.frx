<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReportInfo.Created="02/14/2017 12:43:32" ReportInfo.Modified="04/23/2019 15:47:42" ReportInfo.CreatorVersion="2014.1.2.0">
  <Dictionary>
    <OracleDataConnection Name="Connection" ConnectionString="rijcmlqHytUMhhPg9gG4fal5Q6rRB0BvRbh0nDbCWvtDA1bLoXA5F1HMEY1qSyYCzmMlYGK5S75auXYOG6vOu2k3E2pQIMv7wQ7bf8iFVxOCDcAJeQ=">
      <TableDataSource Name="Table" DataType="System.Int32" Enabled="true" SelectCommand="select corporation_name, &#13;&#10;       case when corporation_name is null then null else ustan end as ustan,&#13;&#10;       nbs,&#13;&#10;       kod_analyt,&#13;&#10;       cnt,&#13;&#10;       in_ost,&#13;&#10;       obdbq,&#13;&#10;       obkrq,&#13;&#10;       out_ost,&#13;&#10;       cnt_doc,&#13;&#10;       cnt_doc_db,&#13;&#10;       cnt_doc_cr, &#13;&#10;       sFdat1,&#13;&#10;       sFdat2,&#13;&#10;&#13;&#10;       case when corporation_name is null then null else kod_ustan end as kod_ustan &#13;&#10;     from (select r.corporation_name, &#13;&#10;                  max(ro.corporation_name) as ustan,&#13;&#10;                  a.nbs,&#13;&#10;                  a.kod_analyt,&#13;&#10;                  count(a.acc) as cnt,&#13;&#10;                  sum(case when a.fdat=:sFdat1 then nvl(a.ostq,0)- nvl(a.obkrq,0)+nvl(a.obdbq,0) else 0 end)/100 as in_ost,&#13;&#10;                  sum(a.obdbq)/100 obdbq,&#13;&#10;                  sum(a.obkrq)/100 obkrq,&#13;&#10;                  sum(case when a.fdat=:sFdat2 then a.ostq else 0 end)/100 as out_ost,&#13;&#10;                  sum((select count(d.ref) from ob_corp_data_doc d where a.acc = d.acc and a.sess_id = d.sess_id))  as cnt_doc,&#13;&#10;                  sum((select count(d.ref) from ob_corp_data_doc d where a.acc = d.acc and a.sess_id = d.sess_id and d.dk = 0)) as cnt_doc_db,&#13;&#10;                  sum((select count(d.ref) from ob_corp_data_doc d where a.acc = d.acc and a.sess_id = d.sess_id and d.dk = 1)) as cnt_doc_cr, &#13;&#10;                  to_char(:sFdat1, 'dd.mm.yyyy') as sFdat1,&#13;&#10;                  to_char(:sFdat2, 'dd.mm.yyyy') as sFdat2,&#13;&#10;                 z.parent_id_corp||': '||z.parent_corporation_name as kod_ustan&#13;&#10;               from ob_corp_data_acc a&#13;&#10;               join v_ob_corp_rep_nbs q on q.rep_id = 5046 and q.nbs = a.nbs and q.corp_id = a.corp_id&#13;&#10;               left join v_root_corporation r on to_char(a.corp_id)=r.external_id&#13;&#10;               left join ob_corporation ro on ro.base_corp=a.corp_id and ro.external_id = a.kod_ustan&#13;&#10;               left join&#13;&#10;               (&#13;&#10;               select nvl (c.parent_id, 0) parent_id_corp, &#13;&#10;                      c.external_id as external_id_corp, &#13;&#10;                      prior c.corporation_name as parent_corporation_name&#13;&#10;               from ob_corporation c&#13;&#10;               connect by prior c.id = c.parent_id&#13;&#10;               start with c.external_id = :corporation_id&#13;&#10;               )  z on a.kod_ustan =  z.external_id_corp            &#13;&#10;               where a.corp_id=:corporation_id&#13;&#10;               and a.is_last = 1&#13;&#10;               and a.fdat between :sFdat1 and :sFdat2               &#13;&#10;               and instr(decode(:name,'%',a.kf,:name),a.kf)&gt;0&#13;&#10;               and instr(decode(:nbs,'%',a.nbs,:nbs),a.nbs)&gt;0&#13;&#10;               and instr(decode(:kod_analyt,'%',nvl(a.kod_analyt,' '),:kod_analyt),nvl(a.kod_analyt,' '))&gt;0&#13;&#10;               and instr(decode(:kod_ustan,'%',nvl(a.kod_ustan, -1),:kod_ustan),nvl(a.kod_ustan, -1))&gt;0&#13;&#10;               group by grouping sets((r.corporation_name, z.parent_id_corp, z.parent_corporation_name, a.nbs, a.kod_analyt),(a.nbs,a.kod_analyt)))&#13;&#10;               order by corporation_name nulls last, ustan, nbs, kod_analyt nulls last">
        <Column Name="NBS" DataType="System.String"/>
        <Column Name="KOD_ANALYT" DataType="System.String"/>
        <Column Name="CORPORATION_NAME" DataType="System.String"/>
        <Column Name="USTAN" DataType="System.String"/>
        <Column Name="CNT" DataType="System.Decimal"/>
        <Column Name="IN_OST" DataType="System.Decimal"/>
        <Column Name="OBDBQ" DataType="System.Decimal"/>
        <Column Name="OBKRQ" DataType="System.Decimal"/>
        <Column Name="OUT_OST" DataType="System.Decimal"/>
        <Column Name="CNT_DOC" DataType="System.Decimal"/>
        <Column Name="CNT_DOC_DB" DataType="System.Decimal"/>
        <Column Name="CNT_DOC_CR" DataType="System.Decimal"/>
        <Column Name="SFDAT1" DataType="System.String"/>
        <Column Name="SFDAT2" DataType="System.String"/>
        <Column Name="KOD_USTAN" DataType="System.String"/>
        <CommandParameter Name="corporation_id" DataType="126" Expression="[corporation_id]" DefaultValue="-1"/>
        <CommandParameter Name="sFdat1" DataType="106" Expression="[sFdat1]" DefaultValue="01.01.1900"/>
        <CommandParameter Name="sFdat2" DataType="106" Expression="[sFdat2]" DefaultValue="01.01.1900"/>
        <CommandParameter Name="name" DataType="126" Expression="[name]" DefaultValue="%"/>
        <CommandParameter Name="nbs" DataType="126" Expression="[nbs]" DefaultValue="%"/>
        <CommandParameter Name="kod_analyt" DataType="126" Expression="[kod_analyt]" DefaultValue="%"/>
        <CommandParameter Name="kod_ustan" DataType="126" Expression="[kod_ustan]" DefaultValue="%"/>
      </TableDataSource>
    </OracleDataConnection>
    <Parameter Name="sFdat1" DataType="System.DateTime"/>
    <Parameter Name="sFdat2" DataType="System.DateTime"/>
    <Parameter Name="name" DataType="System.String"/>
    <Parameter Name="nbs" DataType="System.String"/>
    <Parameter Name="kod_analyt" DataType="System.String"/>
    <Parameter Name="kod_ustan" DataType="System.String"/>
    <Parameter Name="corporation_id" DataType="System.String"/>
    <Total Name="inn" Expression="[Table.IN_OST]" Evaluator="Data1" PrintOn="GroupFooter1"/>
    <Total Name="db" Expression="[Table.OBDBQ]" Evaluator="Data1" PrintOn="GroupFooter1"/>
    <Total Name="cr" Expression="[Table.OBKRQ]" Evaluator="Data1" PrintOn="GroupFooter1"/>
    <Total Name="outt" Expression="[Table.OUT_OST]" Evaluator="Data1" PrintOn="GroupFooter1"/>
    <Total Name="acc" Expression="[Table.CNT]" Evaluator="Data1" PrintOn="GroupFooter1"/>
    <Total Name="doc" Expression="[Table.CNT_DOC]" Evaluator="Data1" PrintOn="GroupFooter1"/>
    <Total Name="docdb" Expression="[Table.CNT_DOC_DB]" Evaluator="Data1" PrintOn="GroupFooter1"/>
    <Total Name="doccr" Expression="[Table.CNT_DOC_CR]" Evaluator="Data1" PrintOn="GroupFooter1"/>
  </Dictionary>
  <ReportPage Name="Page1" PaperWidth="280">
    <ReportTitleBand Name="ReportTitle1" Width="982.8" Height="66.15">
      <TextObject Name="Text1" Width="982.8" Height="18.9" Text="Звіт про рух коштів в розрізі підрозділів" HorzAlign="Center" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text2" Top="18.9" Width="982.8" Height="18.9" Text="корпоративного клієнта [Table.CORPORATION_NAME]" HorzAlign="Center" Font="Arial, 10pt, style=Bold"/>
      <TextObject Name="Text3" Top="37.8" Width="982.8" Height="18.9" Text="з [Table.SFDAT1] по [Table.SFDAT2]" HorzAlign="Center" Font="Arial, 10pt, style=Bold"/>
    </ReportTitleBand>
    <ColumnHeaderBand Name="ColumnHeader1" Top="70.15" Width="982.8" Height="66.15" PrintOn="FirstPage">
      <TableObject Name="Table1" Width="989.4" Height="66.15" Border.Lines="All">
        <TableColumn Name="Column1" Width="98.94"/>
        <TableColumn Name="Column2" Width="98.94"/>
        <TableColumn Name="Column3" Width="98.94"/>
        <TableColumn Name="Column4" Width="98.94"/>
        <TableColumn Name="Column5" Width="98.94"/>
        <TableColumn Name="Column6" Width="98.94"/>
        <TableColumn Name="Column7" Width="98.94"/>
        <TableColumn Name="Column8" Width="98.94"/>
        <TableColumn Name="Column9" Width="98.94"/>
        <TableColumn Name="Column10" Width="98.94"/>
        <TableRow Name="Row1" Height="47.25">
          <TableCell Name="Cell1" Border.Lines="All" Fill.Color="Gray" Text="Рахунок" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
          <TableCell Name="Cell2" Border.Lines="All" Fill.Color="Gray" Text="Код аналітичного обліку" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
          <TableCell Name="Cell3" Border.Lines="All" Fill.Color="Gray" Text="Кількість рахунків" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
          <TableCell Name="Cell4" Border.Lines="All" Fill.Color="Gray" Text="Залишок коштів на початок дня" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
          <TableCell Name="Cell5" Border.Lines="All" Fill.Color="Gray" Text="Обороти коштів по дебету" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
          <TableCell Name="Cell26" Border.Lines="All" Fill.Color="Gray" Text="Обороти коштів по кредиту" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
          <TableCell Name="Cell27" Border.Lines="All" Fill.Color="Gray" Text="Залишок коштів на кінець дня" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
          <TableCell Name="Cell28" Border.Lines="All" Fill.Color="Gray" Text="Кількість документів" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
          <TableCell Name="Cell29" Border.Lines="All" Fill.Color="Gray" Text="Кількість документів по дебету" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
          <TableCell Name="Cell30" Border.Lines="All" Fill.Color="Gray" Text="Кількість документів по кредиту" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
        </TableRow>
        <TableRow Name="Row2">
          <TableCell Name="Cell6" Border.Lines="All" Fill.Color="Gray" Text="1" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
          <TableCell Name="Cell7" Border.Lines="All" Fill.Color="Gray" Text="2" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
          <TableCell Name="Cell8" Border.Lines="All" Fill.Color="Gray" Text="3" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
          <TableCell Name="Cell9" Border.Lines="All" Fill.Color="Gray" Text="4" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
          <TableCell Name="Cell10" Border.Lines="All" Fill.Color="Gray" Text="5" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
          <TableCell Name="Cell33" Border.Lines="All" Fill.Color="Gray" Text="6" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
          <TableCell Name="Cell34" Border.Lines="All" Fill.Color="Gray" Text="7" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
          <TableCell Name="Cell35" Border.Lines="All" Fill.Color="Gray" Text="8" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
          <TableCell Name="Cell36" Border.Lines="All" Fill.Color="Gray" Text="9" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
          <TableCell Name="Cell37" Border.Lines="All" Fill.Color="Gray" Text="10" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
        </TableRow>
      </TableObject>
    </ColumnHeaderBand>
    <GroupHeaderBand Name="GroupHeader1" Top="140.3" Width="982.8" Height="18.9" Condition="[Table.USTAN]" SortOrder="Descending">
      <TableObject Name="Table2" Width="989.22" Height="18.9">
        <TableColumn Name="Column21" Width="494.61"/>
        <TableColumn Name="Column22" Width="494.61"/>
        <TableRow Name="Row4">
          <TableCell Name="Cell48" Border.Lines="All" Fill.Color="Gray" Text="[Table.KOD_USTAN] [Table.USTAN] Всього:" Font="Arial, 10pt, style=Bold" ColSpan="2"/>
          <TableCell Name="Cell49" Border.Lines="All"/>
        </TableRow>
      </TableObject>
      <DataBand Name="Data1" Top="163.2" Width="982.8" Height="18.9" DataSource="Table">
        <TableObject Name="Table1" Width="989.4" Height="18.9" Border.Lines="All">
          <TableColumn Name="Column11" Width="98.94"/>
          <TableColumn Name="Column12" Width="98.94"/>
          <TableColumn Name="Column13" Width="98.94"/>
          <TableColumn Name="Column14" Width="98.94"/>
          <TableColumn Name="Column15" Width="98.94"/>
          <TableColumn Name="Column16" Width="98.94"/>
          <TableColumn Name="Column17" Width="98.94"/>
          <TableColumn Name="Column18" Width="98.94"/>
          <TableColumn Name="Column19" Width="98.94"/>
          <TableColumn Name="Column20" Width="98.94"/>
          <TableRow Name="Row3">
            <TableCell Name="Cell38" Border.Lines="All" Fill.Color="White" Text="[Table.NBS]" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
            <TableCell Name="Cell39" Border.Lines="All" Fill.Color="White" Text="[Table.KOD_ANALYT]" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
            <TableCell Name="Cell40" Border.Lines="All" Fill.Color="White" Text="[Table.CNT]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="0" Format.DecimalSeparator="," Format.GroupSeparator=" " Format.NegativePattern="1" HorzAlign="Right" VertAlign="Center" Font="Arial, 9pt"/>
            <TableCell Name="Cell41" Border.Lines="All" Fill.Color="White" Text="[Table.IN_OST]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" Font="Arial, 9pt"/>
            <TableCell Name="Cell42" Border.Lines="All" Fill.Color="White" Text="[Table.OBDBQ]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" Font="Arial, 9pt"/>
            <TableCell Name="Cell43" Border.Lines="All" Fill.Color="White" Text="[Table.OBKRQ]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" Font="Arial, 9pt"/>
            <TableCell Name="Cell44" Border.Lines="All" Fill.Color="White" Text="[Table.OUT_OST]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" Font="Arial, 9pt"/>
            <TableCell Name="Cell45" Border.Lines="All" Fill.Color="White" Text="[Table.CNT_DOC]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="0" Format.DecimalSeparator="," Format.GroupSeparator=" " Format.NegativePattern="1" HorzAlign="Right" VertAlign="Center" Font="Arial, 9pt"/>
            <TableCell Name="Cell46" Border.Lines="All" Fill.Color="White" Text="[Table.CNT_DOC_DB]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="0" Format.DecimalSeparator="," Format.GroupSeparator=" " Format.NegativePattern="1" HorzAlign="Right" VertAlign="Center" Font="Arial, 9pt"/>
            <TableCell Name="Cell47" Border.Lines="All" Fill.Color="White" Text="[Table.CNT_DOC_CR]" Format="Number" Format.UseLocale="false" Format.DecimalDigits="0" Format.DecimalSeparator="," Format.GroupSeparator=" " Format.NegativePattern="1" HorzAlign="Right" VertAlign="Center" Font="Arial, 9pt"/>
          </TableRow>
        </TableObject>
        <Sort>
          <Sort Expression="[Table.KOD_USTAN]"/>
        </Sort>
      </DataBand>
      <GroupFooterBand Name="GroupFooter1" Top="186.1" Width="982.8" Height="18.9">
        <TableObject Name="Table1" Width="989.4" Height="18.9" Border.Lines="All">
          <TableColumn Name="Column23" Width="98.94"/>
          <TableColumn Name="Column24" Width="98.94"/>
          <TableColumn Name="Column25" Width="98.94"/>
          <TableColumn Name="Column26" Width="98.94"/>
          <TableColumn Name="Column27" Width="98.94"/>
          <TableColumn Name="Column28" Width="98.94"/>
          <TableColumn Name="Column29" Width="98.94"/>
          <TableColumn Name="Column30" Width="98.94"/>
          <TableColumn Name="Column31" Width="98.94"/>
          <TableColumn Name="Column32" Width="98.94"/>
          <TableRow Name="Row5">
            <TableCell Name="Cell50" Border.Lines="All" Fill.Color="Aquamarine" Text="Всього:" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt" ColSpan="2"/>
            <TableCell Name="Cell51" Border.Lines="All" Fill.Color="Aquamarine" HorzAlign="Center" VertAlign="Center" Font="Arial, 9pt"/>
            <TableCell Name="Cell52" Border.Lines="All" Fill.Color="Aquamarine" Text="[acc]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" Font="Arial, 9pt"/>
            <TableCell Name="Cell53" Border.Lines="All" Fill.Color="Aquamarine" Text="[inn]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" Font="Arial, 9pt"/>
            <TableCell Name="Cell54" Border.Lines="All" Fill.Color="Aquamarine" Text="[db]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" Font="Arial, 9pt"/>
            <TableCell Name="Cell55" Border.Lines="All" Fill.Color="Aquamarine" Text="[cr]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" Font="Arial, 9pt"/>
            <TableCell Name="Cell56" Border.Lines="All" Fill.Color="Aquamarine" Text="[outt]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" Font="Arial, 9pt"/>
            <TableCell Name="Cell57" Border.Lines="All" Fill.Color="Aquamarine" Text="[doc]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" Font="Arial, 9pt"/>
            <TableCell Name="Cell58" Border.Lines="All" Fill.Color="Aquamarine" Text="[docdb]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" Font="Arial, 9pt"/>
            <TableCell Name="Cell59" Border.Lines="All" Fill.Color="Aquamarine" Text="[doccr]" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" Font="Arial, 9pt"/>
          </TableRow>
        </TableObject>
      </GroupFooterBand>
    </GroupHeaderBand>
    <PageFooterBand Name="PageFooter1" Top="209" Width="982.8" Height="18.9"/>
  </ReportPage>
</Report>
