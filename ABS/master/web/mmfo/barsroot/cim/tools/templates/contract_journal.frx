<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" StartReportEvent="_StartReport" ReportInfo.Created="11/20/2012 15:46:20" ReportInfo.Modified="01/25/2019 14:16:39" ReportInfo.CreatorVersion="2014.3.2.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;

namespace FastReport
{
  public class ReportScript
  {
    private void _StartReport(object sender, EventArgs e)
    {
      if( (Decimal)Report.GetColumnValue(&quot;с.CONTR_TYPE&quot;) == 0 )
      {
        Text82.Visible = false;
        Text83.Visible = false;
        Text52.Width = Text52.Width -  Text82.Width;
        
        Text51.Left = Text51.Left -  Text82.Width;
        Text47.Left = Text47.Left -  Text82.Width;
        Text31.Left = Text31.Left -  Text82.Width;
        Text46.Left = Text46.Left -  Text82.Width;
        Text30.Left = Text30.Left -  Text82.Width;
        Text48.Left = Text48.Left -  Text82.Width;
        Text35.Left = Text35.Left -  Text82.Width;
        Text49.Left = Text49.Left -  Text82.Width;
        Text32.Left = Text32.Left -  Text82.Width;
        Text50.Left = Text50.Left -  Text82.Width;
        Text34.Left = Text34.Left -  Text82.Width;
        Text84.Left = Text84.Left -  Text82.Width;
        Text85.Left = Text85.Left -  Text82.Width;
        
      }
      else
      {
        Text84.Visible = false;
        Text85.Visible = false;
        Text51.Width = Text51.Width -  Text84.Width;
                                                  
        Text50.Left = Text50.Left -  Text84.Width;
        Text34.Left = Text34.Left -  Text84.Width;
      }     
    }
  }
}
</ScriptText>
  <Dictionary>
    <OracleDataConnection Name="barsdev" ConnectionString="rijcmlqIEnsMSbpo3gQbTFwv+dS5dkgTIzpx5iIqSm9faUQu2CPhiZBPjJyyMRTFtBdyiM+tyyxIn6cYhN1TP9EffjIKNgMK1e44as/4n7XcsvUSHw=">
      <TableDataSource Name="Table" Alias="p" DataType="System.Int32" Enabled="true" ForceLoadData="true" SelectCommand="select * from &#13;&#10;(SELECT branch, /*decode(str_level, -1, num_txt||', ', num_txt)*/nvl2(num_txt,num_txt||', ',null)||TO_CHAR (create_date,'dd.mm.yy') as num_txt,&#13;&#10;        TO_CHAR (val_date, 'dd.mm.yy') AS val_date,&#13;&#10;        kv_p,&#13;&#10;        s_p_dig,&#13;&#10;        conclusion,&#13;&#10;        comments,&#13;&#10;        TO_CHAR (allow_date, 'dd.mm.yy') AS allow_date,&#13;&#10;        kv_v,&#13;&#10;        s_v_dig,&#13;&#10;        vmd_num,&#13;&#10;        control_date,&#13;&#10;        bound_id, num,  decode(comiss, null, null, 'в т.ч. комісія '||comiss) as comiss, journal_num, str_level,&#13;&#10;        okpo,&#13;&#10;        zsq_vp, zq_vt&#13;&#10;    FROM v_cim_journal&#13;&#10;   WHERE journal_num is not null and contr_id = :p_contr_id&#13;&#10;union all &#13;&#10;  select '/11', null, null, null, null, &#13;&#10;          decode((select contr_type from cim_contracts where contr_id=:p_contr_id), 0, 'Еекспортний журнал', 1, 'Імпортний журнал'), &#13;&#10;                                                           null, null, null, null, null, null, null, null, null, &#13;&#10;                                                           (select contr_type from cim_contracts where contr_id=:p_contr_id)+1, null, null, null, null from dual &#13;&#10;union all &#13;&#10;  select '/11', null, null, null, null, 'Незакриті МД', null, null, null, null, null, null, null, null, null, 5, null, null, null, null&#13;&#10;    from dual where (select contr_type from cim_contracts where contr_id=:p_contr_id)=1&#13;&#10;union all &#13;&#10;  select '/1', null, null, null, null,                null, null, null, null, null, null, null, null, null, null, 5, null, null, null, null from dual&#13;&#10;union all &#13;&#10;  select null, null, null, null, null, null, comments, TO_CHAR (allow_date, 'dd.mm.yy') AS allow_date, to_char(vt,'009'), z_vt, num, null, &#13;&#10;         bound_id, null, null, 5, null, null, null, zq_vt &#13;&#10;    from v_cim_bound_vmd where z_vt&gt;0 and contr_id = :p_contr_id and (select contr_type from cim_contracts where contr_id=:p_contr_id)=1&#13;&#10;) order by journal_num, branch, num, bound_id, okpo, val_date, allow_date">
        <Column Name="VAL_DATE" DataType="System.String"/>
        <Column Name="COMMENTS" DataType="System.String"/>
        <Column Name="ALLOW_DATE" DataType="System.String"/>
        <Column Name="KV_P" DataType="System.String"/>
        <Column Name="KV_V" DataType="System.String"/>
        <Column Name="VMD_NUM" DataType="System.String"/>
        <Column Name="NUM_TXT" DataType="System.String"/>
        <Column Name="CONCLUSION" DataType="System.String"/>
        <Column Name="CONTROL_DATE" DataType="System.String"/>
        <Column Name="BRANCH" DataType="System.String"/>
        <Column Name="JOURNAL_NUM" DataType="System.Char"/>
        <Column Name="BOUND_ID" DataType="System.Decimal"/>
        <Column Name="NUM" DataType="System.Decimal"/>
        <Column Name="COMISS" DataType="System.String"/>
        <Column Name="STR_LEVEL" DataType="System.Decimal"/>
        <Column Name="S_P_DIG" DataType="System.Decimal"/>
        <Column Name="S_V_DIG" DataType="System.Decimal"/>
        <Column Name="OKPO" DataType="System.String"/>
        <Column Name="ZSQ_VP" DataType="System.Decimal"/>
        <Column Name="ZQ_VT" DataType="System.Decimal"/>
        <CommandParameter Name="p_contr_id" DataType="126" Expression="[p_contr_id]"/>
      </TableDataSource>
      <TableDataSource Name="Table1" Alias="с" DataType="System.Int32" Enabled="true" SelectCommand="select k.contr_type, decode(k.contr_type, 0, 'екс', 1, 'ім') as type_txt, k.num, to_char(k.open_date,'dd.mm.yyyy') as open_date, &#13;&#10;       k.rnk, c.okpo, c.nmk, b.BENEF_NAME, u.name  &#13;&#10;  from cim_contracts k&#13;&#10;       join customer c on c.rnk=k.rnk&#13;&#10;       join cim_beneficiaries b on b.benef_id=k.benef_id&#13;&#10;       join country u on u.country=b.country_id &#13;&#10; where k.contr_id=:p_contr_id">
        <Column Name="CONTR_TYPE" DataType="System.Decimal"/>
        <Column Name="NUM" DataType="System.String"/>
        <Column Name="OPEN_DATE" DataType="System.Char"/>
        <Column Name="TYPE_TXT" DataType="System.String"/>
        <Column Name="RNK" DataType="System.Decimal"/>
        <Column Name="OKPO" DataType="System.String"/>
        <Column Name="NMK" DataType="System.String"/>
        <Column Name="BENEF_NAME" DataType="System.String"/>
        <Column Name="NAME" DataType="System.String"/>
        <CommandParameter Name="p_contr_id" DataType="126" Expression="[p_contr_id]"/>
      </TableDataSource>
    </OracleDataConnection>
    <Relation Name="Table_Table1" ParentDataSource="Table" ChildDataSource="null" ParentColumns="BOUND_ID&#13;&#10;PTYPE_ID" ChildColumns="BOUND_ID&#13;&#10;PAYMENT_TYPE" Enabled="true"/>
    <Parameter Name="p_contr_id" DataType="System.Int32"/>
  </Dictionary>
  <ReportPage Name="Page1" Landscape="true" PaperWidth="297" PaperHeight="210" RawPaperSize="9" TopMargin="5" RightMargin="7.5" BottomMargin="5" FirstPageSource="15" OtherPagesSource="15" Guides="0">
    <ReportTitleBand Name="ReportTitle1" Width="1056.51" Height="66.15">
      <TextObject Name="Text1" Width="756" Height="28.35" Text="Витяг з журналів реєстрації [с.TYPE_TXT]портних операцій по контракту №[с.NUM] від [с.OPEN_DATE]р. (#[p_contr_id])&#13;&#10;" Format="Date" Format.Format="d" HorzAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
      <TextObject Name="Text9" Top="28.35" Width="756" Height="37.8" Text="Резидент:      [с.OKPO], [с.NMK] (RNK [с.RNK])&#13;&#10;Нерезидент:  [с.BENEF_NAME], країна: [с.NAME]" Font="Times New Roman, 10pt, style=Bold"/>
    </ReportTitleBand>
    <PageHeaderBand Name="PageHeader1" Top="69.35" Width="1056.51" Height="85.05" Guides="0">
      <TextObject Name="Text2" Width="66.15" Height="85.05" Border.Lines="All" Text="№ з/п, дата реєстрації" HorzAlign="Center" VertAlign="Center" Angle="270" Font="Times New Roman, 8pt, style=Bold"/>
      <TextObject Name="Text50" Left="812.15" Width="103.95" Height="85.05" Border.Lines="All" Text="Примітка" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt, style=Bold"/>
      <TextObject Name="Text44" Left="66.15" Width="66.15" Height="85.05" Border.Lines="All" Text="Дата закінчен-ня аконодавчо встановлених строків розрахунків" HorzAlign="Center" VertAlign="Center" Angle="270" Font="Times New Roman, 8pt, style=Bold"/>
      <TextObject Name="Text52" Left="216.8" Width="255.15" Height="28.35" Border.Lines="All" Text="Перерахування/отримання коштів за договором" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt, style=Bold"/>
      <TextObject Name="Text53" Left="216.8" Top="28.35" Width="66.15" Height="56.7" Border.Lines="All" Text="Дата опера-ції" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt, style=Bold"/>
      <TextObject Name="Text54" Left="282.95" Top="28.35" Width="37.8" Height="56.7" Border.Lines="All" Text="Валюта" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt, style=Bold"/>
      <TextObject Name="Text55" Left="320.75" Top="28.35" Width="75.6" Height="56.7" Border.Lines="All" Text="Сума коштів" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt, style=Bold"/>
      <TextObject Name="Text81" Left="131.75" Width="85.05" Height="85.05" Border.Lines="All" Text="Інформація про одержані за цим договором резидента висновки" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt, style=Bold"/>
      <TextObject Name="Text51" Left="471.95" Width="340.2" Height="28.35" Border.Lines="All" Text="МД, акт або інший документ, що засвідчує виконання робіт (надання послуг, тощо)" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt, style=Bold"/>
      <TextObject Name="Text49" Left="642.05" Top="28.35" Width="85.05" Height="56.7" Border.Lines="All" Text="Сума коштів, зазначених в акті" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt, style=Bold"/>
      <TextObject Name="Text48" Left="604.25" Top="28.35" Width="37.8" Height="56.7" Border.Lines="All" Text="Код валюти" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt, style=Bold"/>
      <TextObject Name="Text47" Left="471.95" Top="28.35" Width="66.15" Height="56.7" Border.Lines="All" Text="Дата" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt, style=Bold"/>
      <TextObject Name="Text46" Left="538.1" Top="28.35" Width="66.15" Height="56.7" Border.Lines="All" Text="Номер" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt, style=Bold"/>
      <TextObject Name="Text82" Left="395.9" Top="28.35" Width="75.98" Height="56.7" Border.Lines="All" Text="Грн.екв.останьої події незавершеного розрахунку" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 7pt, style=Bold"/>
      <TextObject Name="Text84" Left="727.27" Top="28.35" Width="85.05" Height="56.7" Border.Lines="All" Text="Грн.екв.останьої події незавершеного розрахунку" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt, style=Bold"/>
    </PageHeaderBand>
    <DataBand Name="Data1" Top="157.6" Width="1056.51" Height="28.35" CanGrow="true" Guides="9.45,0" DataSource="Table" KeepTogether="true" KeepDetail="true">
      <TextObject Name="Text3" Width="66.15" Height="28.35" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[p.NUM_TXT]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt">
        <Highlight>
          <Condition Expression="[p.STR_LEVEL] == -1" TextFill.Color="ControlText" Font="Times New Roman, 8.25pt, style=Bold" ApplyTextFill="false" ApplyFont="true"/>
        </Highlight>
      </TextObject>
      <TextObject Name="Text34" Left="812.15" Width="103.95" Height="28.35" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[p.COMMENTS]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt">
        <Highlight>
          <Condition Expression="[p.STR_LEVEL] == -1" TextFill.Color="ControlText" Font="Times New Roman, 8.25pt, style=Bold" ApplyTextFill="false" ApplyFont="true"/>
        </Highlight>
      </TextObject>
      <TextObject Name="Text68" Left="66.15" Width="66.15" Height="28.35" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[p.CONTROL_DATE]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt">
        <Highlight>
          <Condition Expression="[p.STR_LEVEL] == -1" TextFill.Color="ControlText" Font="Times New Roman, 8.25pt, style=Bold" ApplyTextFill="false" ApplyFont="true"/>
        </Highlight>
      </TextObject>
      <TextObject Name="Text56" Left="216.8" Width="66.15" Height="28.35" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[p.VAL_DATE]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt">
        <Highlight>
          <Condition Expression="[p.STR_LEVEL] == -1" TextFill.Color="ControlText" Font="Times New Roman, 8.25pt, style=Bold" ApplyTextFill="false" ApplyFont="true"/>
        </Highlight>
      </TextObject>
      <TextObject Name="Text58" Left="320.75" Width="75.6" Height="28.35" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[p.S_P_DIG]&#13;&#10;[p.COMISS]" HideZeros="true" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" Font="Times New Roman, 8pt">
        <Highlight>
          <Condition Expression="[p.STR_LEVEL] == -1" TextFill.Color="ControlText" Font="Times New Roman, 8.25pt, style=Bold" ApplyTextFill="false" ApplyFont="true"/>
        </Highlight>
      </TextObject>
      <TextObject Name="Text57" Left="282.95" Width="37.8" Height="28.35" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[p.KV_P]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt">
        <Highlight>
          <Condition Expression="[p.STR_LEVEL] == -1" TextFill.Color="ControlText" Font="Times New Roman, 8.25pt, style=Bold" ApplyTextFill="false" ApplyFont="true"/>
        </Highlight>
      </TextObject>
      <TextObject Name="Text12" Left="131.75" Width="85.05" Height="28.35" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[p.CONCLUSION]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt">
        <Highlight>
          <Condition Expression="[p.STR_LEVEL] == -1" TextFill.Color="ControlText" Font="Times New Roman, 8.25pt, style=Bold" ApplyTextFill="false" ApplyFont="true"/>
        </Highlight>
      </TextObject>
      <TextObject Name="Text31" Left="471.95" Width="66.15" Height="28.35" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[p.ALLOW_DATE]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt">
        <Highlight>
          <Condition Expression="[p.STR_LEVEL] == -1" TextFill.Color="ControlText" Font="Times New Roman, 8.25pt, style=Bold" ApplyTextFill="false" ApplyFont="true"/>
        </Highlight>
      </TextObject>
      <TextObject Name="Text35" Left="604.25" Width="37.8" Height="28.35" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[p.KV_V]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt">
        <Highlight>
          <Condition Expression="[p.STR_LEVEL] == -1" TextFill.Color="ControlText" Font="Times New Roman, 8.25pt, style=Bold" ApplyTextFill="false" ApplyFont="true"/>
        </Highlight>
      </TextObject>
      <TextObject Name="Text32" Left="642.05" Width="85.05" Height="28.35" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[p.S_V_DIG]" HideZeros="true" HorzAlign="Right" VertAlign="Center" Font="Times New Roman, 8pt">
        <Formats>
          <NumberFormat/>
          <GeneralFormat/>
        </Formats>
        <Highlight>
          <Condition Expression="[p.STR_LEVEL] == -1" TextFill.Color="ControlText" Font="Times New Roman, 8.25pt, style=Bold" ApplyTextFill="false" ApplyFont="true"/>
        </Highlight>
      </TextObject>
      <TextObject Name="Text30" Left="538.1" Width="66.15" Height="28.35" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="&#13;&#10;[p.VMD_NUM]&#13;&#10;" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 8pt">
        <Highlight>
          <Condition Expression="[p.STR_LEVEL] == -1" TextFill.Color="ControlText" Font="Times New Roman, 8.25pt, style=Bold" ApplyTextFill="false" ApplyFont="true"/>
        </Highlight>
      </TextObject>
      <TextObject Name="Text83" Left="395.9" Width="75.98" Height="28.35" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[p.ZSQ_VP]" HideZeros="true" Format="Number" Format.UseLocale="true" HorzAlign="Right" VertAlign="Center" Font="Times New Roman, 8pt"/>
      <TextObject Name="Text85" Left="727.27" Width="85.05" Height="28.35" Border.Lines="All" CanGrow="true" GrowToBottom="true" Text="[p.ZQ_VT]" HideZeros="true" HorzAlign="Right" VertAlign="Center" Font="Times New Roman, 8pt">
        <Formats>
          <NumberFormat/>
          <GeneralFormat/>
        </Formats>
        <Highlight>
          <Condition Expression="[p.STR_LEVEL] == -1" TextFill.Color="ControlText" Font="Times New Roman, 8.25pt, style=Bold" ApplyTextFill="false" ApplyFont="true"/>
        </Highlight>
      </TextObject>
    </DataBand>
    <PageFooterBand Name="PageFooter1" Top="189.15" Width="1056.51" Height="18.9" Guides="9.45">
      <TextObject Name="Text11" Width="756" Height="18.9" Text="[Page]" HorzAlign="Center" VertAlign="Bottom" Font="Arial, 8pt"/>
    </PageFooterBand>
  </ReportPage>
</Report>
