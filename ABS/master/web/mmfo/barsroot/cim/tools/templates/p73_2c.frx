<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReportInfo.Created="11/20/2012 15:46:20" ReportInfo.Modified="11/30/2016 12:23:29" ReportInfo.CreatorVersion="2013.2.2.0">
  <Dictionary>
    <OracleDataConnection Name="barsdev" ConnectionString="rijcmlq9SEZoacNJntaKIKp6mVF188ZqzOTHRUYVI97pWTpI9Puv/DEzj295hQn7aj/qJUhtqAqy7QmXaNF0ylgAxIck3U5QXze+dGi/SPv2wt+uK0=">
      <TableDataSource Name="Table" Alias="p" DataType="System.Int32" Enabled="true" ForceLoadData="true" SelectCommand="select q.*, t.type_name, ' '||to_char(q.open_date, 'dd.mm.yyyy') as open_date_t,&#13;&#10;       case when q.p_kv=840 then q.z else p_ncurval( 840, p_icurval( q.p_kv, q.z, q.open_date ), q.open_date ) end as zd &#13;&#10;  from         &#13;&#10;    ( select max(y.s) - sum( case when y.vdat &lt;= nvl(vv.allow_dat, a.allow_date) or vv.allow_dat is null and a.allow_date is null then 0 else round(y.s*l.s/y.s_cv, 0) end ) as z,             &#13;&#10;             max(y.contr_id) as contr_id, max(y.num) as c_num , max(y.open_date) as open_date, max(y.t) as t, max(y.ref) as ref, &#13;&#10;             max(y.vdat) as vdat, to_char(max(y.vdat), 'dd.mm.yyyy') as vdat_t, max(y.kv) as p_kv, max(y.s) as p_s&#13;&#10;        from     &#13;&#10;        ( select x.*&#13;&#10;            from   &#13;&#10;            ( with c as ( select k.contr_id, trunc( k.open_date ) as open_date, k.num &#13;&#10;                            from ( select rnk, benef_id from cim_contracts where contr_id=:p_contr_id ) kk &#13;&#10;                                 join cim_contracts k on k.contr_type=1 and k.benef_id=kk.benef_id and k.rnk=kk.rnk )&#13;&#10;              select /*+ ORDERED c, p, o) */ &#13;&#10;                     c.contr_id, c.num, c.open_date, 0 as t, p.bound_id, p.ref, trunc( NVL( (SELECT MAX (fdat) FROM opldok WHERE REF = o.REF), o.vdat ) ) as vdat, o.kv, p.s, p.s_cv&#13;&#10;                from c &#13;&#10;                     join cim_payments_bound p on p.delete_date is null and p.pay_flag=0 and p.contr_id=c.contr_id &#13;&#10;                     join oper o on o.ref=p.ref&#13;&#10;                union all       &#13;&#10;               select /*+ ORDERED c, fb, f) */&#13;&#10;                      c.contr_id, c.num, c.open_date, f.payment_type as t, fb.bound_id, fb.fantom_id as ref, f.val_date as vdat, f.kv, fb.s, fb.s_cv&#13;&#10;                 from c &#13;&#10;                      join cim_fantoms_bound fb on fb.delete_date is null and fb.pay_flag=0 and fb.contr_id=c.contr_id &#13;&#10;                      join cim_fantom_payments f on f.fantom_id=fb.fantom_id ) x&#13;&#10;                 where x.vdat between to_date('01/'||to_char(to_date(:p_dat1, 'dd/mm/yyyy'), 'mm/yyyy'), 'dd/mm/yyyy') &#13;&#10;                                      and add_months(to_date('01/'||to_char(to_date(:p_dat2, 'dd/mm/yyyy'), 'mm/yyyy'), 'dd/mm/yyyy'), 1)&#13;&#10;        ) y&#13;&#10;        left outer join cim_link l on l.delete_date is null and decode(y.t, 0, l.payment_id, l.fantom_id)=y.bound_id    &#13;&#10;        left outer join cim_vmd_bound vb on vb.bound_id=l.vmd_id&#13;&#10;        left outer join v_cim_customs_decl vv on vv.cim_id=vb.vmd_id &#13;&#10;        left outer join cim_act_bound ab on ab.bound_id=l.act_id&#13;&#10;        left outer join cim_acts a on a.act_id=ab.act_id &#13;&#10;     group by y.t, y.bound_id&#13;&#10;   ) q&#13;&#10;   left outer join cim_payment_types t on t.type_id=q.t&#13;&#10;order by contr_id, vdat">
        <Column Name="OPEN_DATE" DataType="System.String"/>
        <Column Name="Z" DataType="System.Decimal"/>
        <Column Name="CONTR_ID" DataType="System.Decimal"/>
        <Column Name="C_NUM" DataType="System.String"/>
        <Column Name="T" DataType="System.Decimal"/>
        <Column Name="REF" DataType="System.Decimal"/>
        <Column Name="VDAT" DataType="System.String"/>
        <Column Name="P_KV" DataType="System.Decimal"/>
        <Column Name="P_S" DataType="System.Decimal"/>
        <Column Name="ZD" DataType="System.Decimal"/>
        <Column Name="VDAT_T" DataType="System.String"/>
        <Column Name="TYPE_NAME" DataType="System.String"/>
        <Column Name="OPEN_DATE_T" DataType="System.String"/>
        <CommandParameter Name="P_contr_id" DataType="126" Expression="[p_contr_id]"/>
        <CommandParameter Name="P_dat1" DataType="126" Expression="[p_dat]"/>
        <CommandParameter Name="P_dat2" DataType="126" Expression="[p_dat]"/>
      </TableDataSource>
      <TableDataSource Name="Table1" Alias="с" DataType="System.Int32" Enabled="true" SelectCommand="select to_char(to_date(:p_dat1, 'dd/mm/yyyy'), 'mm.yyyy')  as period, k.rnk, c.okpo, c.nmk, b.benef_id, b.benef_name, f_cim_2c_p73(to_date(:p_dat2, 'dd/mm/yyyy'), k.rnk, b.benef_id) as p73&#13;&#10;  from cim_contracts k&#13;&#10;       join customer c on c.rnk=k.rnk&#13;&#10;       join cim_beneficiaries b on b.benef_id=k.benef_id&#13;&#10; where k.contr_id=:p_contr_id">
        <Column Name="OKPO" DataType="System.String"/>
        <Column Name="BENEF_NAME" DataType="System.String"/>
        <Column Name="PERIOD" DataType="System.String"/>
        <Column Name="RNK" DataType="System.Decimal"/>
        <Column Name="NMK" DataType="System.String"/>
        <Column Name="BENEF_ID" DataType="System.Decimal"/>
        <Column Name="P73" DataType="System.Decimal"/>
        <CommandParameter Name="P_dat1" DataType="126" Expression="[p_dat]"/>
        <CommandParameter Name="P_dat2" DataType="126" Expression="[p_dat]"/>
        <CommandParameter Name="P_contr_id" DataType="126" Expression="[p_contr_id]"/>
      </TableDataSource>
    </OracleDataConnection>
    <Relation Name="Table_Table1" ParentDataSource="Table" ChildDataSource="null" ParentColumns="BOUND_ID&#13;&#10;PTYPE_ID" ChildColumns="BOUND_ID&#13;&#10;PAYMENT_TYPE" Enabled="true"/>
    <Parameter Name="p_contr_id" DataType="System.String"/>
    <Parameter Name="p_dat" DataType="System.String"/>
  </Dictionary>
  <ReportPage Name="Page1" Landscape="true" PaperWidth="297" PaperHeight="210" RawPaperSize="9" TopMargin="5" RightMargin="7.5" BottomMargin="5" FirstPageSource="15" OtherPagesSource="15" Guides="0">
    <DataBand Name="Data1" Width="1056.51" Height="264.6" CanGrow="true" CanBreak="true" Guides="0,0,9.45,9.45,9.45" DataSource="Table1" KeepTogether="true" KeepDetail="true">
      <TableObject Name="Table2" Top="226.8" Width="1055.7" Height="37.8" Border.Lines="All">
        <TableColumn Name="Column8" Width="78.3"/>
        <TableColumn Name="Column9" Width="210.6"/>
        <TableColumn Name="Column10" Width="87.75"/>
        <TableColumn Name="Column11" Width="97.2"/>
        <TableColumn Name="Column12" Width="97.2"/>
        <TableColumn Name="Column13" Width="87.75"/>
        <TableColumn Name="Column14" MaxWidth="529.2" Width="47.25"/>
        <TableColumn Name="Column15" Width="170.1"/>
        <TableColumn Name="Column18" Width="179.55"/>
        <TableRow Name="Row2" Height="37.8">
          <TableCell Name="Cell8" Text="id &#13;&#10;контракту" HorzAlign="Center"/>
          <TableCell Name="Cell9" Border.Lines="All" Text="№ контракту" HorzAlign="Center"/>
          <TableCell Name="Cell10" Border.Lines="All" Text="Дата контракту" HorzAlign="Center"/>
          <TableCell Name="Cell11" Border.Lines="All" Text="Тип документу" HorzAlign="Center"/>
          <TableCell Name="Cell12" Border.Lines="All" Text="REF документу" HorzAlign="Center"/>
          <TableCell Name="Cell13" Border.Lines="All" Text="Дата валютування" HorzAlign="Center"/>
          <TableCell Name="Cell14" Text="Код вал." HorzAlign="Center"/>
          <TableCell Name="Cell15" Border.Lines="All" Text="Аванс. частина платежу&#13;&#10;(центів у вал. платежу)" HorzAlign="Center"/>
          <TableCell Name="Cell18" Text="Аванс. частина платежу &#13;&#10;(USD центів)" HorzAlign="Center"/>
        </TableRow>
      </TableObject>
      <TextObject Name="Text9" Top="37.8" Width="1048.95" Height="189" Text="Клієнт:&#13;&#10;RNK: [с.RNK],   OKPO: [с.OKPO],&#13;&#10;Назва: [с.NMK]&#13;&#10;&#13;&#10;Нерезидент:&#13;&#10;id: [с.BENEF_ID],   Назва: [с.BENEF_NAME]&#13;&#10;&#13;&#10;p73 = [с.P73] центів.&#13;&#10;&#13;&#10;Авансові платежі:" Font="Times New Roman, 12pt, style=Bold"/>
      <TextObject Name="Text1" Top="9.45" Width="1048.95" Height="28.35" Text="Перелік  авансових платежів за період: [с.PERIOD]&#13;&#10;&#13;&#10;" Format="Date" Format.Format="d" HorzAlign="Center" Font="Times New Roman, 12pt, style=Bold"/>
      <DataBand Name="Data2" Top="268.6" Width="1056.51" Height="37.8" DataSource="Table">
        <TableObject Name="Table2" Width="1055.7" Height="37.8" GrowToBottom="true">
          <TableColumn Name="Column1" Width="78.3"/>
          <TableColumn Name="Column2" Width="210.6"/>
          <TableColumn Name="Column3" Width="87.75"/>
          <TableColumn Name="Column4" Width="97.2"/>
          <TableColumn Name="Column5" Width="97.2"/>
          <TableColumn Name="Column6" Width="87.75"/>
          <TableColumn Name="Column7" MaxWidth="529.2" Width="47.25"/>
          <TableColumn Name="Column16" Width="170.1"/>
          <TableColumn Name="Column17" Width="179.55"/>
          <TableRow Name="Row1" Height="37.8">
            <TableCell Name="Cell1" Border.Lines="All" Text="[p.CONTR_ID]" HorzAlign="Center"/>
            <TableCell Name="Cell2" Border.Lines="All" Text="[p.C_NUM]"/>
            <TableCell Name="Cell3" Border.Lines="All" Text="[p.OPEN_DATE_T]" HorzAlign="Center"/>
            <TableCell Name="Cell4" Border.Lines="All" Text="[p.TYPE_NAME]" HorzAlign="Center"/>
            <TableCell Name="Cell5" Border.Lines="All" Text="[p.REF]" HorzAlign="Center"/>
            <TableCell Name="Cell6" Border.Lines="All" Text="[p.VDAT_T]" HorzAlign="Center"/>
            <TableCell Name="Cell7" Border.Lines="All" Text="[p.P_KV]" HorzAlign="Right"/>
            <TableCell Name="Cell16" Border.Lines="All" Text="[p.Z]" HorzAlign="Right"/>
            <TableCell Name="Cell17" Border.Lines="All" Text="[p.ZD]" HorzAlign="Right"/>
          </TableRow>
        </TableObject>
      </DataBand>
    </DataBand>
    <PageFooterBand Name="PageFooter1" Top="310.4" Width="1056.51" Height="18.9" Guides="9.45">
      <TextObject Name="Text11" Width="1067.85" Height="18.9" Text="[Page]" HorzAlign="Center" VertAlign="Bottom" Font="Arial, 8pt"/>
    </PageFooterBand>
  </ReportPage>
</Report>
