/*
    AUTOGENERATED! Do not modify this code.
*/

using System;
using System.Collections.Generic;
using System.Linq;
using ibank.core;

namespace Bars.ObjLayer.CbiRep
{
    public partial class VCbirepReplist
    {
        public Boolean CheckAccess(Decimal? REP_ID)
        {
            Filter.REP_ID.Equal(REP_ID);
            return Select().Count > 0;
        }
        public VCbirepReplistRecord SelectCbirepRep(Decimal? REP_ID)
        {
            Filter.REP_ID.Equal(REP_ID);
            return Select()[0];
        }
        public List<VCbirepReplistRecord> SelectCbirepReplist(String CODEAPP, String FOLDER_ID, Decimal? REP_ID, String REP_DESC, String SortExpression, int maximumRows, int startRowIndex)
        {
            if (!string.IsNullOrWhiteSpace(CODEAPP))
                Filter.CODEAPP.Equal(CODEAPP); 
            if (!String.IsNullOrEmpty(FOLDER_ID))
                Filter.FOLDER_ID.Equal(Convert.ToDecimal(FOLDER_ID));
            if (REP_ID.HasValue)
                Filter.REP_ID.Equal(REP_ID);
            if (!String.IsNullOrEmpty(REP_DESC))
                Filter.REP_DESC.LikeBoth(REP_DESC.Trim().ToUpper(), CaseFlags.UpperCase);
            // первоначальная сортировка по REP_ID
            return Select(String.IsNullOrEmpty(SortExpression) ? "REP_ID" : SortExpression, (maximumRows == 0 ? -1 : maximumRows), startRowIndex).GroupBy(i=>i.REP_ID).Select(g=>g.First()).ToList();
        }
    }
}