<?xml version="1.0" encoding="utf-8"?>
<xmlform captiontype="OnlyTitle" caption="Реєстрація нової картки">
  <grids>
    <grid table="OBPC_DEAL_WEB" id="gv" pagesize="10" showpagesizebox="true" title="Портфель БПК" showfilter="true">
      <filters caption="Пошук угоди" buttontext="Знайти" columnscount="3" width ="100%">
        <filter field="nd" caption="Номер угоди" columnindex="1" condition="Equal" id="fltrnd" >
          <uicontrol></uicontrol>
        </filter>
        <filter field="acc_nls" caption="Картковий рахунок" columnindex="2" condition="Equal" id="fltrnls" >
          <uicontrol></uicontrol>
        </filter>
        <filter field="cust_name" caption="ПІБ (назва) клієнта" columnindex="3" condition="LikeBoth" id="fltrnmk">
          <uicontrol controlwidth="300"></uicontrol>
        </filter>
      </filters>
      <buttons defaulttype="Button">
        <button id="btnBpkCard" caption="Реєстрація нової картки" hint="Реєстрація нової картки">
          <command type="Redirect" url="/barsroot/barsweb/dynform.aspx?form=bpk.frm.newdeal" checkselectedrow="false">
          </command>
        </button>
        <button id="btnOpenKl" caption="Відкрити кредитну лінію" hint="Відкрити кредитну лінію">
          <command type="PlSqlBlock" successmessage="Кредитну лінію відкрито">
            <sql>
              declare
              l_acc number;
              begin
              bars_bpk.open_kl(:ND,l_acc);
              end;
            </sql>
            <parameters>
              <parameter type="DataField" name="ND"></parameter>
            </parameters>
          </command>
        </button>
        <button id="btnCustomer" caption="Картка клієнта" hint="Перегляд картки клієнта" >
          <command type="Redirect" url="/barsroot/clientregister/registration.aspx?readonly=0">
            <parameters>
              <parameter type="DataField" name="CUST_RNK" altname="rnk"></parameter>
            </parameters>
          </command>
        </button>
        <button id="btnAccount" caption="Картка рахунку" hint="Перегляд картки рахунку"  >
          <command type="Redirect" url="/barsroot/viewaccounts/accountform.aspx?type=0" >
            <parameters>
              <parameter type="DataField" name="ACC_ACC" altname="acc"></parameter>
              <parameter type="DataField" name="CUST_RNK" altname="rnk"></parameter>
              <parameter type="Constant" name="accessmode">
                <defaultvalue type="Constant" value="1"></defaultvalue>
              </parameter>
            </parameters>
          </command>
        </button>
        <button id="btnPrint" caption="Друк договорів" hint="Друк договорів">
          <command type="Redirect" url="/barsroot/printcontract/index?multiSelection=true">
            <sessionVariables>
              <variable name="multiprint_id" field="ACC_ACC"></variable>
              <variable name="multiprint_filter" field="DOC_ID"></variable>
            </sessionVariables>
          </command>
        </button>
      </buttons>
      <rowselection method="SingleRow" />
      <fields>
        <field name="DOC_ID" key="true" datatype="String">
          <column show="false" caption="DOC_ID" align="Left" />
        </field>
        <field name="ND" key="true" datatype="Int64" sort="Desc">
          <column show="true" caption="Номер договору" align="right" />
        </field>
        <field name="BRANCH" key="false" datatype="String" sort="default">
          <column show="true" caption="Відділення" align="left" />
        </field>
        <field name="ACC_ACC" key="true" datatype="Decimal" sort="default">
          <column show="false" caption="ACC" align="right" />
        </field>
        <field name="ACC_NLS" key="false" datatype="String" sort="default">
          <column show="true" caption="Картковий рахунок" align="left" />
        </field>
        <field name="ACC_KV" key="false" datatype="Int64" sort="default">
          <column show="false" caption="KV" align="right" />
        </field>
        <field name="ACC_LCV" key="false" datatype="String" sort="default">
          <column show="true" caption="Вал." align="left" />
        </field>
        <field name="CARD_ACCT" key="false" datatype="String" sort="default">
          <column show="true" caption="Технічний рахунок" align="left" />
        </field>
        <field name="ACC_TIP" key="false" datatype="String" sort="default">
          <column show="false" caption="Tip" align="left" />
        </field>
        <field name="ACC_TIPNAME" key="false" datatype="String" sort="default">
          <column show="true" caption="Тип рахунку" align="left" />
        </field>
        <field name="ACC_OST" key="false" datatype="Decimal" sort="default">
          <column show="true" caption="Залишок" align="right" />
        </field>
        <field name="CUST_RNK" key="true" datatype="Int64" sort="default">
          <column show="true" caption="РНК" align="right" />
        </field>
        <field name="CUST_OKPO" key="false" datatype="String" sort="default">
          <column show="true" caption="ЗКПО" align="left" />
        </field>
        <field name="CUST_NAME" key="false" datatype="String" sort="default">
          <column show="true" caption="ПІБ (назва) клієнта" align="left" />
        </field>
        <field name="CUST_TYPE" key="false" datatype="Decimal" sort="default">
          <column show="false" caption="Custtype" align="right" />
        </field>
        <field name="ACC_DAOS" key="false" datatype="DateTime" sort="default">
          <column show="true" caption="Дата відкриття" align="center" />
        </field>
        <field name="ACC_DAZS" key="false" datatype="DateTime" sort="default">
          <column show="true" caption="Дата закриття" align="center" />
        </field>
      </fields>
    </grid>
  </grids>
</xmlform>