<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReferencedAssemblies="System.dll&#13;&#10;System.Drawing.dll&#13;&#10;System.Windows.Forms.dll&#13;&#10;System.Data.dll&#13;&#10;System.Xml.dll&#13;&#10;Oracle.DataAccess&#13;&#10;FastReport.Oracle" StartReportEvent="_StartReport" ReportInfo.Created="04/15/2011 18:11:20" ReportInfo.Modified="12/10/2014 10:46:55" ReportInfo.CreatorVersion="2013.3.2.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;
using Oracle.DataAccess.Client;

namespace FastReport
{
  public class ReportScript
  {

    private void _StartReport(object sender, EventArgs e)
    {
      OracleDataConnection frxconn = (OracleDataConnection)Report.Dictionary.Connections[0];
      OracleConnection connection = (OracleConnection)frxconn.GetConnection();
      OracleCommand command = connection.CreateCommand();
      command.CommandText = &quot;begin bars.wcs_utl.store_gpk(:p_bid_id); end;&quot;;
      
      Parameter par = Report.GetParameter(&quot;p_bid_id&quot;);
      command.Parameters.Add(&quot;p_bid_id&quot;, par.Value);
      
      connection.Open();
      try
      {
        command.ExecuteNonQuery();
      }
      finally
      {
        connection.Close();
      }
    }
  }
}
</ScriptText>
  <Dictionary>
    <OracleDataConnection Name="sberdev" ConnectionString="rijcmlqD6nWZEExUJ9MEhdFZpB1A6ZfSeiTM+6WLeB8pW5aURqkGwhV134I2SUIQGUGXcXiSwvBzDdO+4VKa8+eJsGjGQ==">
      <TableDataSource Name="Table" Alias="WCS_BIDS" DataType="System.Int32" Enabled="true" SelectCommand="select b.*,&#13;&#10;       nvl(to_number(wcs_utl.get_answ(b.bid_id, 'SINGLE_FEE_SUM')), 0) as SINGLE_FEE_SUM,&#13;&#10;       to_date(wcs_utl.get_creditdata(b.bid_id, 'DEAL_DATE')) as DEAL_DATE       &#13;&#10;  from v_wcs_bids b&#13;&#10; where b.bid_id = :p2">
        <Column Name="BID_ID" DataType="System.Decimal"/>
        <Column Name="SUBPRODUCT_ID" DataType="System.String"/>
        <Column Name="SUBPRODUCT_NAME" DataType="System.String"/>
        <Column Name="CRT_DATE" DataType="System.DateTime"/>
        <Column Name="F" DataType="System.String"/>
        <Column Name="I" DataType="System.String"/>
        <Column Name="O" DataType="System.String"/>
        <Column Name="BDATE" DataType="System.DateTime"/>
        <Column Name="INN" DataType="System.String"/>
        <Column Name="SUMM" DataType="System.Decimal"/>
        <Column Name="OWN_FUNDS" DataType="System.Decimal"/>
        <Column Name="TERM" DataType="System.String"/>
        <Column Name="CREDIT_CURRENCY" DataType="System.String"/>
        <Column Name="SINGLE_FEE" DataType="System.Decimal"/>
        <Column Name="MONTHLY_FEE" DataType="System.Decimal"/>
        <Column Name="INTEREST_RATE" DataType="System.Decimal"/>
        <Column Name="REPAYMENT_METHOD" DataType="System.String"/>
        <Column Name="REPAYMENT_DAY" DataType="System.Decimal"/>
        <Column Name="GARANTEES" DataType="System.String"/>
        <Column Name="MGR_ID" DataType="System.Decimal"/>
        <Column Name="MGR_FIO" DataType="System.String"/>
        <Column Name="BRANCH" DataType="System.String"/>
        <Column Name="BRANCH_NAME" DataType="System.String"/>
        <Column Name="STATES" DataType="System.String"/>
        <Column Name="PROPERTY_COST" DataType="System.Decimal" PropName="Column" Calculated="true" Expression="[WCS_BIDS.SUMM]+[WCS_BIDS.OWN_FUNDS]"/>
        <Column Name="OWN_FOUNDS_PERC" DataType="System.Decimal" PropName="Column" Calculated="true" Expression="[WCS_BIDS.OWN_FUNDS]/[WCS_BIDS.PROPERTY_COST]"/>
        <Column Name="REPAYMENT_METHOD_TEXT" DataType="System.String"/>
        <Column Name="SINGLE_FEE_SUM" DataType="System.Decimal"/>
        <Column Name="SUBPRODUCT_DESC" DataType="System.String"/>
        <Column Name="FIO" DataType="System.String"/>
        <Column Name="BRANCH_HIERARCHY" DataType="System.String"/>
        <Column Name="DEAL_DATE" DataType="System.DateTime"/>
        <CommandParameter Name="p2" DataType="126" Expression="[p_bid_id]"/>
      </TableDataSource>
      <TableDataSource Name="Table4" Alias="WCS_BID_GPK" DataType="System.Int32" Enabled="true" SelectCommand="select t.pmt_id, t.pmt_date, t.pmt_in_bal as pmt_in_bal, t.pmt_body as pmt_body, t.pmt_interest as pmt_interest, t.pmt_total as pmt_total, t.pmt_out_bal as pmt_out_bal from table(wcs_utl.get_gpk(:p1)) t">
        <Column Name="PMT_ID" DataType="System.Decimal"/>
        <Column Name="PMT_DATE" DataType="System.DateTime"/>
        <Column Name="PMT_IN_BAL" DataType="System.Decimal"/>
        <Column Name="PMT_BODY" DataType="System.Decimal"/>
        <Column Name="PMT_INTEREST" DataType="System.Decimal"/>
        <Column Name="PMT_TOTAL" DataType="System.Decimal"/>
        <Column Name="PMT_OUT_BAL" DataType="System.Decimal"/>
        <CommandParameter Name="p1" DataType="126" Expression="[p_bid_id]"/>
      </TableDataSource>
    </OracleDataConnection>
    <Parameter Name="p_bid_id" DataType="System.Decimal" Expression="1255102"/>
    <Total Name="AvgPayment" TotalType="Avg" Expression="[WCS_BID_GPK.PMT_TOTAL]" Evaluator="Data1"/>
    <Total Name="TotalInterests" Expression="[WCS_BID_GPK.PMT_INTEREST]" Evaluator="bnd_d_gpk"/>
    <Total Name="TotalBody" Expression="[WCS_BID_GPK.PMT_BODY]" Evaluator="bnd_d_gpk"/>
  </Dictionary>
  <ReportPage Name="Page1" Landscape="true" PaperWidth="297" PaperHeight="210" RawPaperSize="9" FirstPageSource="15" OtherPagesSource="15">
    <DataBand Name="Data1" Width="1047.06" DataSource="Table">
      <DataBand Name="bnd_d_gpk" Top="261.21" Width="1047.06" Height="18.9" DataSource="Table4">
        <TableObject Name="Table5" Left="9.45" Width="1030.05" Height="18.9" Border.Lines="All">
          <TableColumn Name="Column21" Width="73.71"/>
          <TableColumn Name="Column22" Width="111.51"/>
          <TableColumn Name="Column23" Width="177.66"/>
          <TableColumn Name="Column24" Width="168.21"/>
          <TableColumn Name="Column25" Width="158.76"/>
          <TableColumn Name="Column26" Width="170.1"/>
          <TableColumn Name="Column27" Width="170.1"/>
          <TableRow Name="Row15">
            <TableCell Name="Cell82" Border.Lines="All" Text="[WCS_BID_GPK.PMT_ID]" VertAlign="Center"/>
            <TableCell Name="Cell83" Border.Lines="All" Text="[FormatDateTime([WCS_BID_GPK.PMT_DATE],&quot;Short Date&quot;)]" HorzAlign="Center" VertAlign="Center"/>
            <TableCell Name="Cell84" Border.Lines="All" Text="[FormatNumber([WCS_BID_GPK.PMT_IN_BAL],2)]" HorzAlign="Right" VertAlign="Center"/>
            <TableCell Name="Cell85" Border.Lines="All" Text="[FormatNumber([WCS_BID_GPK.PMT_TOTAL],2)]" HorzAlign="Right" VertAlign="Center"/>
            <TableCell Name="Cell86" Border.Lines="All" Text="[FormatNumber([WCS_BID_GPK.PMT_BODY],2)]" HorzAlign="Right" VertAlign="Center"/>
            <TableCell Name="Cell87" Border.Lines="All" Text="[FormatNumber([WCS_BID_GPK.PMT_INTEREST],2)]" HorzAlign="Right" VertAlign="Center"/>
            <TableCell Name="Cell88" Border.Lines="All" Text="[FormatNumber([WCS_BID_GPK.PMT_OUT_BAL],2)]" HorzAlign="Right" VertAlign="Center"/>
          </TableRow>
        </TableObject>
        <DataHeaderBand Name="bnd_h_gpk" Top="3.03" Width="1047.06" Height="255.15">
          <TableObject Name="Table5" Left="9.45" Top="217.35" Width="1030.05" Height="37.8" Border.Lines="All">
            <TableColumn Name="Column14" Width="73.71"/>
            <TableColumn Name="Column15" Width="111.51"/>
            <TableColumn Name="Column16" Width="177.66"/>
            <TableColumn Name="Column17" Width="168.21"/>
            <TableColumn Name="Column18" Width="158.76"/>
            <TableColumn Name="Column19" Width="170.1"/>
            <TableColumn Name="Column20" Width="170.1"/>
            <TableRow Name="Row14" Height="37.8">
              <TableCell Name="Cell75" Border.Lines="All" Text="Номер платежу" HorzAlign="Center" VertAlign="Center"/>
              <TableCell Name="Cell76" Border.Lines="All" Text="Дата платежу" HorzAlign="Center" VertAlign="Center"/>
              <TableCell Name="Cell77" Border.Lines="All" Text="Залишок кредиту на початок періоду" HorzAlign="Center" VertAlign="Center"/>
              <TableCell Name="Cell78" Border.Lines="All" Text="Сума платежу за місяць" HorzAlign="Center" VertAlign="Center"/>
              <TableCell Name="Cell79" Border.Lines="All" Text="Тіло кредиту до погашення" HorzAlign="Center" VertAlign="Center"/>
              <TableCell Name="Cell80" Border.Lines="All" Text="Проценти до погашення" HorzAlign="Center" VertAlign="Center"/>
              <TableCell Name="Cell81" Border.Lines="All" Text="Залишок кредиту на кінець періоду" HorzAlign="Center" VertAlign="Center"/>
            </TableRow>
          </TableObject>
          <TextObject Name="Text3" Left="9.45" Top="9.45" Width="1030.05" Height="28.35" Text="Параметри кредиту ([WCS_BIDS.SUBPRODUCT_NAME])" HorzAlign="Center" Font="Arial, 10pt, style=Bold"/>
          <TableObject Name="Table3" Left="9.45" Top="37.8" Width="482.05" Height="132.3" Border.Lines="All">
            <TableColumn Name="Column10" Width="226.85"/>
            <TableColumn Name="Column11" Width="255.2"/>
            <TableRow Name="Row5">
              <TableCell Name="Cell45" Text="Загальна вартість товару" HorzAlign="Right" Font="Arial, 10pt, style=Bold"/>
              <TableCell Name="Cell46" Text="[FormatNumber([WCS_BIDS.PROPERTY_COST],2)] ([WCS_BIDS.CREDIT_CURRENCY])"/>
            </TableRow>
            <TableRow Name="Row6">
              <TableCell Name="Cell50" Text="Процент власних коштів" HorzAlign="Right" Font="Arial, 10pt, style=Bold"/>
              <TableCell Name="Cell51" Text="[FormatPercent([WCS_BIDS.OWN_FOUNDS_PERC])]"/>
            </TableRow>
            <TableRow Name="Row7">
              <TableCell Name="Cell55" Text="Сума кредиту" HorzAlign="Right" Font="Arial, 10pt, style=Bold"/>
              <TableCell Name="Cell56" Text="[FormatNumber([WCS_BIDS.SUMM],2)] ([WCS_BIDS.CREDIT_CURRENCY])"/>
            </TableRow>
            <TableRow Name="Row8">
              <TableCell Name="Cell60" Text="Процентная ставка річна" HorzAlign="Right" Font="Arial, 10pt, style=Bold"/>
              <TableCell Name="Cell61" Text="[FormatPercent([WCS_BIDS.INTEREST_RATE]/100,2)]"/>
            </TableRow>
            <TableRow Name="Row9">
              <TableCell Name="Cell65" Text="Кількість місяців" HorzAlign="Right" Font="Arial, 10pt, style=Bold"/>
              <TableCell Name="Cell66" Text="[WCS_BIDS.TERM] (міс)"/>
            </TableRow>
            <TableRow Name="Row10">
              <TableCell Name="Cell67" Text="Дата видачі кредиту" HorzAlign="Right" Font="Arial, 10pt, style=Bold"/>
              <TableCell Name="Cell68" Text="[FormatDateTime([WCS_BIDS.DEAL_DATE],&quot;Short Date&quot;)]"/>
            </TableRow>
            <TableRow Name="Row17">
              <TableCell Name="Cell96" Text="Комісійна винагорода банку" HorzAlign="Right" Font="Arial, 10pt, style=Bold"/>
              <TableCell Name="Cell97" Text="[FormatNumber([WCS_BIDS.SINGLE_FEE_SUM],2)] (UAH)"/>
            </TableRow>
          </TableObject>
          <TableObject Name="Table1" Left="557.55" Top="37.8" Width="482.07" Height="37.8" Border.Lines="All">
            <TableColumn Name="Column12" Width="222.14"/>
            <TableColumn Name="Column13" Width="259.93"/>
            <TableRow Name="Row11">
              <TableCell Name="Cell69" Text="Сума щомісячного платежу" HorzAlign="Right" Font="Arial, 10pt, style=Bold"/>
              <TableCell Name="Cell70" Text="[IIf([WCS_BIDS.REPAYMENT_METHOD] == &quot;4&quot;,FormatNumber([AvgPayment],2),&quot;-&quot;)]"/>
            </TableRow>
            <TableRow Name="Row12">
              <TableCell Name="Cell71" Text="Кількість платежів" HorzAlign="Right" Font="Arial, 10pt, style=Bold"/>
              <TableCell Name="Cell72" Text="[WCS_BIDS.TERM]"/>
            </TableRow>
          </TableObject>
          <TextObject Name="Text4" Left="9.45" Top="189" Width="1030.05" Height="28.35" Text="Попередній розрахунок графіку погашення кредиту" HorzAlign="Center" Font="Arial, 10pt, style=Bold"/>
        </DataHeaderBand>
        <DataFooterBand Name="bnd_f_gpk" Top="283.14" Width="1047.06" Height="37.8">
          <TableObject Name="Table5" Left="9.45" Width="1030.05" Height="37.8" Border.Lines="All">
            <TableColumn Name="Column28" Width="73.71"/>
            <TableColumn Name="Column29" Width="111.51"/>
            <TableColumn Name="Column30" Width="177.66"/>
            <TableColumn Name="Column31" Width="168.21"/>
            <TableColumn Name="Column32" Width="158.76"/>
            <TableColumn Name="Column33" Width="170.1"/>
            <TableColumn Name="Column34" Width="170.1"/>
            <TableRow Name="Row16" Height="37.8">
              <TableCell Name="Cell89" Border.Lines="All" Text="Загалом:" HorzAlign="Right" VertAlign="Center" Font="Arial, 10pt, style=Bold" ColSpan="4"/>
              <TableCell Name="Cell90" Border.Lines="All" HorzAlign="Right" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
              <TableCell Name="Cell91" Border.Lines="All" HorzAlign="Right" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
              <TableCell Name="Cell92" Border.Lines="All" HorzAlign="Right" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
              <TableCell Name="Cell93" Border.Lines="All" Text="[FormatNumber([TotalBody],2)]" HorzAlign="Right" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
              <TableCell Name="Cell94" Border.Lines="All" Text="[FormatNumber([TotalInterests],2)]" HorzAlign="Right" VertAlign="Center" Font="Arial, 10pt, style=Bold"/>
              <TableCell Name="Cell95" Border.Lines="All" HorzAlign="Right" VertAlign="Center"/>
            </TableRow>
          </TableObject>
        </DataFooterBand>
      </DataBand>
    </DataBand>
  </ReportPage>
</Report>
