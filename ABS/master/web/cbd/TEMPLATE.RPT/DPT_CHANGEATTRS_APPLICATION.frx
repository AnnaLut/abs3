<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReferencedAssemblies="System.dll&#13;&#10;System.Drawing.dll&#13;&#10;System.Windows.Forms.dll&#13;&#10;System.Data.dll&#13;&#10;System.Xml.dll&#13;&#10;Oracle.DataAccess&#13;&#10;FastReport.Oracle" DoublePass="true" FinishReportEvent="_FinishReport" ReportInfo.Created="05/17/2013 18:06:00" ReportInfo.Modified="10/28/2014 18:54:04" ReportInfo.CreatorVersion="2013.3.2.0">
  <ScriptText>using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows.Forms;
using System.Drawing;
using System.Data;
using FastReport;
using FastReport.Data;
using FastReport.Dialog;
using FastReport.Barcode;
using FastReport.Table;
using FastReport.Utils;
using Oracle.DataAccess.Client;

namespace FastReport
{
  public class ReportScript
  {
    private void _FinishReport(object sender, EventArgs e)
    {
      OracleDataConnection frxconn = (OracleDataConnection)Report.Dictionary.Connections[0];
      OracleConnection connection = (OracleConnection)frxconn.GetConnection();
      
      OracleCommand command = connection.CreateCommand();
      command.CommandType = CommandType.StoredProcedure;
      command.CommandText = &quot;ead_pack.doc_page_count&quot;;
      
      Parameter DocID = Report.GetParameter(&quot;p_doc_id&quot;);
      command.Parameters.Add(&quot;p_doc_id&quot;, DocID.Value);
      command.Parameters.Add(&quot;p_page_count&quot;, Report.Engine.TotalPages);
      
      connection.Open();
      try
      {
        command.ExecuteNonQuery();
      }
      finally
      {
        connection.Close();
      }
    }
  }
}
</ScriptText>
  <Dictionary>
    <OracleDataConnection Name="sberdev" ConnectionString="rijcmlqZLE460ApuhBq9nxfsVEDUjsnvJzXtSTPbWY4MKJi2yK6Cw7h6oGX20YJkb5YAkRnZEe6yNDTlXZrP3J9lILp+w==">
      <TableDataSource Name="Table" Alias="DPT_DATA" DataType="System.Int32" Enabled="true" SelectCommand="select nvl(d.nd, to_char(d.deposit_id)) as id,&#13;&#10;       f_dat_lit(d.datz) as dealdate,&#13;&#10;       f_dat_lit(d.dat_end) as end_date,&#13;&#10;       a.nls as nlsd,&#13;&#10;       d.limit / 100 as summ,&#13;&#10;       f_sumpr(d.limit, d.kv, 'F') as sum_w,&#13;&#10;       decode(d.kv, 980, 'грн.', t.lcv) as kv,&#13;&#10;       f_doc_dpt(d.deposit_id, 3, 1) as term_calc,&#13;&#10;       f_doc_dpt(d.deposit_id, 3, 2) as term_calc_w,&#13;&#10;       dpt.fproc(d.acc, bankdate) as rate,&#13;&#10;       f_sumpr(dpt.fproc(d.acc, bankdate), '', 'M', 3) as rate_w,&#13;&#10;       nvl(trim(d.mfo_p), '_________________') as paym_mfo,&#13;&#10;       nvl(trim(b.nb), '____') as paym_nb,&#13;&#10;       nvl(trim(d.nls_p), '_________________') as paym_nls&#13;&#10;  from dpt_deposit d, tabval t, accounts a, banks b&#13;&#10; where d.acc = a.acc&#13;&#10;   and d.kv = t.kv&#13;&#10;   and d.mfo_p = b.mfo(+)&#13;&#10;   and d.deposit_id = :p_agr_id">
        <Column Name="ID" DataType="System.String"/>
        <Column Name="DEALDATE" DataType="System.String"/>
        <Column Name="END_DATE" DataType="System.String"/>
        <Column Name="NLSD" DataType="System.String"/>
        <Column Name="SUMM" DataType="System.Decimal"/>
        <Column Name="SUM_W" DataType="System.String"/>
        <Column Name="KV" DataType="System.String"/>
        <Column Name="TERM_CALC" DataType="System.String"/>
        <Column Name="TERM_CALC_W" DataType="System.String"/>
        <Column Name="RATE" DataType="System.Decimal"/>
        <Column Name="RATE_W" DataType="System.String"/>
        <Column Name="PAYM_MFO" DataType="System.String"/>
        <Column Name="PAYM_NB" DataType="System.String"/>
        <Column Name="PAYM_NLS" DataType="System.String"/>
        <CommandParameter Name="p_agr_id" DataType="113" Expression="[p_agr_id]" DefaultValue="-1"/>
      </TableDataSource>
      <TableDataSource Name="Table2" Alias="COMMON_DATA" DataType="System.Int32" Enabled="true" SelectCommand="select nvl(branch_edit.get_branch_parameter(b.branch, 'NAME_BRANCH'),&#13;&#10;           b.name) as name_branch,&#13;&#10;       nvl(branch_edit.get_branch_parameter(b.branch, 'ADR_BRANCH'), '___') as adres_branch,&#13;&#10;       branch_edit.get_branch_parameter(b.branch, 'DPT_PHON') as phones_branch,&#13;&#10;       decode(poa_doc,&#13;&#10;              null,&#13;&#10;              '________',&#13;&#10;              poa_doc || ' від ' || to_char(poa_date, 'dd/mm/yyyy')) as staff_dover,&#13;&#10;       nvl(fio_r, '________') as staff_fio_r,&#13;&#10;       nvl(post_r, '________') as staff_status_r,&#13;&#10;       branch_edit.get_branch_parameter(b.branch, 'TOWN') as staff_town,&#13;&#10;       f_dat_lit(trunc(sysdate)) as today_w&#13;&#10;  from branch b,&#13;&#10;       (select *&#13;&#10;          from (select *&#13;&#10;                  from dpt_poa_branches pb, dpt_poas p&#13;&#10;                 where pb.branch = branch_usr.get_branch()&#13;&#10;                   and pb.active = 1&#13;&#10;                   and pb.poa_id = p.id&#13;&#10;                 order by decode(p.staff_id, user_id, 0, pb.ord))&#13;&#10;         where rownum = 1) t&#13;&#10; where b.branch = t.branch(+)&#13;&#10;   and b.branch = branch_usr.get_branch()">
        <Column Name="NAME_BRANCH" DataType="System.String"/>
        <Column Name="ADRES_BRANCH" DataType="System.String"/>
        <Column Name="PHONES_BRANCH" DataType="System.String"/>
        <Column Name="STAFF_DOVER" DataType="System.String"/>
        <Column Name="STAFF_FIO_R" DataType="System.String"/>
        <Column Name="STAFF_STATUS_R" DataType="System.String"/>
        <Column Name="STAFF_TOWN" DataType="System.String"/>
        <Column Name="TODAY_W" DataType="System.String"/>
      </TableDataSource>
      <TableDataSource Name="Table3" Alias="TICKET_DATA" DataType="System.Int32" Enabled="true" SelectCommand="select ed.doc_id,&#13;&#10;       ed.crt_date,&#13;&#10;       ed.ea_struct_id,&#13;&#10;       ed.rnk,&#13;&#10;       ed.cl_fio,&#13;&#10;       ed.agr_id,&#13;&#10;       ed.agr_num,&#13;&#10;       ed.crt_staff_logname,&#13;&#10;       ed.crt_staff_fio,&#13;&#10;       ed.crt_branch&#13;&#10;  from v_ead_docs ed&#13;&#10; where ed.doc_id = :p_doc_id">
        <Column Name="RNK" DataType="System.Decimal"/>
        <Column Name="DOC_ID" DataType="System.Decimal"/>
        <Column Name="CRT_DATE" DataType="System.DateTime"/>
        <Column Name="CL_FIO" DataType="System.String"/>
        <Column Name="AGR_ID" DataType="System.Decimal"/>
        <Column Name="AGR_NUM" DataType="System.String"/>
        <Column Name="CRT_BRANCH" DataType="System.String"/>
        <Column Name="CRT_STAFF_LOGNAME" DataType="System.String"/>
        <Column Name="CRT_STAFF_FIO" DataType="System.String"/>
        <Column Name="EA_STRUCT_ID" DataType="System.Decimal"/>
        <CommandParameter Name="p_doc_id" DataType="113" Expression="[p_doc_id]" DefaultValue="-1"/>
      </TableDataSource>
      <TableDataSource Name="Table4" Alias="CLIENT_DATA" DataType="System.Int32" Enabled="true" SelectCommand="select t.rnk,&#13;&#10;       f_get_custw_h(c.rnk, 'SN_GC', sysdate) as fio_r,&#13;&#10;       nvl(name_full, c.nmk) as name_full,&#13;&#10;       nvl(doc_type, ps.name) as doc_type,&#13;&#10;       nvl(doc_serial, p.ser) as doc_serial,&#13;&#10;       nvl(doc_number, p.numdoc) as doc_number,&#13;&#10;       nvl(doc_organ, p.organ) as doc_organ,&#13;&#10;       nvl(doc_date, p.pdate) as doc_date&#13;&#10;  from (select cc.rnk,&#13;&#10;               max(decode(cc.tag, 'NAME_FULL', cc.val, null)) as name_full,&#13;&#10;               max(decode(cc.tag, 'DOC_TYPE', cc.val, null)) as doc_type,&#13;&#10;               max(decode(cc.tag, 'DOC_SERIAL', cc.val, null)) as doc_serial,&#13;&#10;               max(decode(cc.tag, 'DOC_NUMBER', cc.val, null)) as doc_number,&#13;&#10;               max(decode(cc.tag, 'DOC_ORGAN', cc.val, null)) as doc_organ,&#13;&#10;               to_date(max(decode(cc.tag, 'DOC_DATE', cc.val, null)),&#13;&#10;                       'dd.mm.yyyy') as doc_date&#13;&#10;          from dpt_customer_changes cc&#13;&#10;         where cc.rnk = :p_rnk&#13;&#10;         group by cc.rnk) t,&#13;&#10;       customer c,&#13;&#10;       person p,&#13;&#10;       passp ps&#13;&#10; where t.rnk = c.rnk&#13;&#10;   and c.rnk = p.rnk(+)&#13;&#10;   and p.passp = ps.passp">
        <Column Name="RNK" DataType="System.Decimal"/>
        <Column Name="NAME_FULL" DataType="System.String"/>
        <Column Name="DOC_TYPE" DataType="System.String"/>
        <Column Name="DOC_SERIAL" DataType="System.String"/>
        <Column Name="DOC_NUMBER" DataType="System.String"/>
        <Column Name="DOC_ORGAN" DataType="System.String"/>
        <Column Name="DOC_DATE" DataType="System.DateTime"/>
        <Column Name="FIO_R" DataType="System.String"/>
        <CommandParameter Name="p_rnk" DataType="113" Expression="[p_rnk]" DefaultValue="-1"/>
      </TableDataSource>
      <TableDataSource Name="Table5" Alias="ClientChanges" DataType="System.Int32" Enabled="true" SelectCommand="select t2.tag_name, T1.VAL_OLD, T1.VAL &#13;&#10;from DPT_CUSTOMER_CHANGES t1,&#13;&#10;DPT_CUSTOMER_TAGS t2&#13;&#10;where t1.tag = t2.tag_code&#13;&#10;and t1.rnk = :p_rnk&#13;&#10;order by 1 desc&#13;&#10;">
        <Column Name="VAL_OLD" DataType="System.String"/>
        <Column Name="VAL" DataType="System.String"/>
        <Column Name="TAG_NAME" DataType="System.String"/>
        <CommandParameter Name="p_rnk" DataType="107" Expression="[p_rnk]" DefaultValue="1137956"/>
      </TableDataSource>
    </OracleDataConnection>
    <Parameter Name="p_doc_id" DataType="System.Int32" Expression="1025"/>
    <Parameter Name="p_rnk" DataType="System.Int32" Expression="1662453"/>
    <Parameter Name="p_agr_id" DataType="System.Int64" Expression="7335001"/>
  </Dictionary>
  <ReportPage Name="Page1">
    <DataBand Name="Data1" Width="718.2" Height="415.8" CanGrow="true" CanShrink="true" CanBreak="true" DataSource="Table2">
      <TableObject Name="Table1" Left="9.45" Top="9.45" Width="680.34" Height="377.15" GrowToBottom="true">
        <TableColumn Name="Column1" Width="330.72"/>
        <TableColumn Name="Column2" Width="349.62"/>
        <TableRow Name="Row111" Height="160.65">
          <TableCell Name="Cell233" Font="Times New Roman, 10pt">
            <BarcodeObject Name="Barcode2" Width="153.8" Height="153.8" AutoSize="false" Expression="[TICKET_DATA.DOC_ID]+&quot;;&quot;+FormatDateTime([TICKET_DATA.CRT_DATE])+&quot;;&quot;+[TICKET_DATA.EA_STRUCT_ID]+&quot;;&quot;+[TotalPages]+&quot;;&quot;+[TICKET_DATA.RNK]+&quot;;&quot;+[TICKET_DATA.CL_FIO]+&quot;;&quot;+[TICKET_DATA.AGR_ID]+&quot;;&quot;+[TICKET_DATA.AGR_NUM]+&quot;;&quot;+[TICKET_DATA.CRT_STAFF_LOGNAME]+&quot;;&quot;+[TICKET_DATA.CRT_STAFF_FIO]+&quot;;&quot;+[TICKET_DATA.CRT_BRANCH]" ShowText="false" Barcode="QR Code" Barcode.ErrorCorrection="L" Barcode.Encoding="UTF8" Barcode.QuietZone="true"/>
          </TableCell>
          <TableCell Name="Cell234" HorzAlign="Right" VertAlign="Bottom" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row112" Height="37.8">
          <TableCell Name="Cell235" Text="Установа банку № [COMMON_DATA.NAME_BRANCH]&#13;&#10;" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell236" Text="від [CLIENT_DATA.FIO_R]" HorzAlign="Right" Font="Times New Roman, 10pt"/>
        </TableRow>
        <TableRow Name="Row1" Height="103.1">
          <TableCell Name="Cell1" Text="ЗАЯВА  &#13;&#10;ПРО ЗМІНУ ДАНИХ" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt, style=Bold" ColSpan="2"/>
          <TableCell Name="Cell2" HorzAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
        </TableRow>
        <TableRow Name="Row3" Height="75.6" AutoSize="true">
          <TableCell Name="Cell11" Text="	Повідомляю, що мої особисті дані змінилися, та в підтвердження цього надаю наступні документи:&#13;&#10;1) &lt;b&gt;[CLIENT_DATA.DOC_TYPE]&lt;/b&gt; &lt;b&gt;[CLIENT_DATA.DOC_SERIAL][CLIENT_DATA.DOC_NUMBER]&lt;/b&gt; виданий &lt;b&gt;[CLIENT_DATA.DOC_ORGAN] [FormatDateTime([CLIENT_DATA.DOC_DATE], &quot;Short date&quot;)]&lt;/b&gt;&#13;&#10;" Font="Times New Roman, 10pt" HtmlTags="true" ColSpan="2"/>
          <TableCell Name="Cell12" Font="Times New Roman, 10pt"/>
        </TableRow>
      </TableObject>
      <TableObject Name="Table6" Left="9.45" Top="396.9" Width="680.4" Height="18.9" GrowToBottom="true">
        <TableColumn Name="Column7" Width="226.8"/>
        <TableColumn Name="Column8" Width="226.8"/>
        <TableColumn Name="Column10" Width="226.8"/>
        <TableRow Name="Row122">
          <TableCell Name="Cell255" Border.Lines="All" Text="Назва атрибуту" HorzAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
          <TableCell Name="Cell256" Border.Lines="All" Text="Попереднє значення" HorzAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
          <TableCell Name="Cell258" Border.Lines="All" Text="Нове значення" HorzAlign="Center" Font="Times New Roman, 10pt, style=Bold"/>
        </TableRow>
      </TableObject>
      <DataBand Name="Data2" Top="419.8" Width="718.2" Height="18.9" CanGrow="true" CanBreak="true" DataSource="Table5">
        <TableObject Name="Table6" Left="9.45" Width="680.4" Height="18.9" GrowToBottom="true">
          <TableColumn Name="Column5" Width="226.8"/>
          <TableColumn Name="Column6" Width="226.8"/>
          <TableColumn Name="Column9" Width="226.8"/>
          <TableRow Name="Row121" AutoSize="true">
            <TableCell Name="Cell253" Border.Lines="All" Text="[ClientChanges.TAG_NAME]" Font="Times New Roman, 10pt"/>
            <TableCell Name="Cell254" Border.Lines="All" Text="[ClientChanges.VAL_OLD] " Font="Times New Roman, 10pt"/>
            <TableCell Name="Cell257" Border.Lines="All" Text=" [ClientChanges.VAL]"/>
          </TableRow>
        </TableObject>
      </DataBand>
    </DataBand>
    <ColumnFooterBand Name="ColumnFooter1" Top="442.7" Width="718.2" Height="122">
      <TableObject Name="Table6" Left="9.45" Width="680.34" Height="103.95" GrowToBottom="true">
        <TableColumn Name="Column3" Width="330.72"/>
        <TableColumn Name="Column4" Width="349.62"/>
        <TableRow Name="Row120" Height="103.95">
          <TableCell Name="Cell251" Text="[COMMON_DATA.TODAY_W]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt"/>
          <TableCell Name="Cell252" Text="_____________________&#13;&#10;(підпис клієнта)" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt"/>
        </TableRow>
      </TableObject>
    </ColumnFooterBand>
    <PageFooterBand Name="PageFooter1" Top="568.7" Width="718.2" Height="37.8">
      <BarcodeObject Name="Barcode1" Left="96.52" Width="126.25" Height="18.9" Anchor="Top, Right" Expression="[TICKET_DATA.DOC_ID]+&quot;:&quot;+[TotalPages]+&quot;:&quot;+[Page]" ShowText="false" Barcode="Codabar"/>
      <TextObject Name="Text2" Left="264.6" Width="444.15" Height="18.9" Text="№ друку [TICKET_DATA.DOC_ID] сторінка [Page] з [TotalPages]" HorzAlign="Center" VertAlign="Center" Font="Times New Roman, 10pt"/>
    </PageFooterBand>
  </ReportPage>
</Report>
