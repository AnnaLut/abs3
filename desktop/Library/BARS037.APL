Application Description: Конструктор анкет для Web (Правэкс)
	Outline Version - 4.0.26
	Design-time Settings
.data VIEWINFO
0000: 6F00000003000000 FFFF01000D004347 5458566965775374 6174650400800000
0020: 0000000000CC0000 002C000000020000 0003000000000000 00BB010000FCFFFF
0040: FFE2FFFFFFFFFFFF FF000000003E0300 004D020000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F7773044341
0080: 5244000001800200 0200000000000000 000000002C000000 0000000001000000
00A0: FFFFFFFFFFFFFFFF FCFFFFFFE2FFFFFF 160000001D000000 92030000B4010000
00C0: 0000000000000000 050000000F417070 6C69636174696F6E 4974656D0757696E
00E0: 646F777304434152 4408546F6F6C2042 6172097062446574 61696C7300000000
.enddata
.data DT_MAKERUNDLG
0000: 0200000000001D51 3A5C424152533938 5C4C494252415259 5C42415253303135
0020: 2E646C6C1D513A5C 4241525339385C4C 4942524152595C42 4152533031352E61
0040: 706300000101011D 513A5C4241525339 385C4C4942524152 595C424152533031
0060: 352E72756E1D513A 5C4241525339385C 4C4942524152595C 424152533031352E
0080: 646C6C1D513A5C42 41525339385C4C49 42524152595C4241 52533031352E6170
00A0: 630000010101175C 4241525339385C42 494E5C4241525330 33372E6170640C5C
00C0: 4241525339385C42 494E5C0C5C424152 5339385C42494E5C 0000010101001D51
00E0: 3A5C424152533938 5C4C494252415259 5C42415253303135 2E646C6C1D513A5C
0100: 4241525339385C4C 4942524152595C42 4152533031352E61 70630000010101
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left:   -0.013"
			Top:    0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: 1018B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left:   4.15"
			Top:    1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left:   0.575"
			Top:    0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left:   6.388"
			Top:    0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		Dynalib: Global.apd
		Dynalib: Absapi.apd
		Dynalib: Nsiapi.apd
		Dynalib: Otcn.apd
		Dynalib: Custacnt.apd
		Dynalib: Docview.apd
		Dynalib: Message.apd
		Dynalib: Dfltrapi.apd
		Dynalib: dsig.apd
		Dynalib: PRINTAPI.apd
		File Include: msoffice.apl
		Dynalib: Cc_doc.apd
		File Include: XSALSPL.APL
		File Include: VTTBLWIN.APL
		File Include: GENLIST.APL
		File Include: GENBUTN.APL
		File Include: GENTBL.APL
		File Include: GENTBLF.APL
		File Include: GENTBLS.APL
		File Include: VTDOS.APL
		File Include: VTFILE.APL
		File Include: QCKTABS.APL
		File Include: XSALCPT.APL
		File Include: GENLBUTN.APL
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
				String: ApdNum   =  '37'
				String: ApdVer   =  '00'
				! История изменений: -----------------------------------------------------|
		Resources
		Variables
.data RESOURCE 0 0 1 3321314127
0000: 1E00000011000000 0000000000000000 02000001000000BD 000000E002040000
0020: 00FF3F
.enddata
			Window Handle: hWin0
			Window Handle: hWin1
			Window Handle: hWin2
			Window Handle: hWin3
			Window Handle: hWin4
			Window Handle: hWin12
			Window Handle: hWin30
			Window Handle: hWin31
			Window Handle: hWin33
			Window Handle: hWin40
			Window Handle: hWin41
			Window Handle: hWinBlFiles
			Number: nHaveTOBO 
			String: aTOBO
			String: ASG_SN
			String: CC_GPK
			Number: nFetchRes
			Number: nTicks
			! Переменные исользуются для передачи данных в окно ГПК и обратно (нет нельзя)
		Internal Functions
			Function: Sel037	! __exported
				Description: Bars037_Selector
				Returns
				Parameters
					Window Handle: hWndParent
					Number: nMode
					Number: nPar
					String: sPar1
					String: sPar2
				Static Variables
				Local variables
					String: sSqlB
				Actions
					! Вызов формы - конструктора анкет (Маша)
					Set nHaveTOBO = GetGlobalOptionEx('HAVETOBO')
					If nMode != 2 and nMode != 3 and nMode != 4
						If nHaveTOBO = 2
							Set sSqlB = "Substr(SYS_CONTEXT('bars_context','user_branch'),1,30) "
						Else
							Set sSqlB = "Substr(pul.Get_Mas_Ini_Val('KOD_TOBO'),1,12) "
						If SqlPrepareAndExecute( hSql(), "select " || sSqlB || " INTO :aTOBO from dual" )
								and SqlFetchNext( hSql(), nFetchRes )
					!
					Select Case nMode
						Case 0
							If not IsWindow(hWin0)
								Set hWin0 = SalCreateWindow(Survey, hWndParent)
							Else
								Call SalBringWindowToTop ( hWin0 )
							Break
						Case 2  !! FSC: Импорт xml-файла клиент+кредит
							If not IsWindow(hWin2)
								Set hWin2 = SalCreateWindow(frmImportXML, hWndParent, nPar, sPar1, sPar2)
							Else
								Call SalBringWindowToTop(hWin2)
							Break
						Case 3  !! FSC: Экспорт xml-файла клиент+кредит
							If not IsWindow(hWin3)
								Set hWin3 = SalCreateWindow(tbl_UbkiCr, hWndParent, nPar, sPar1, sPar2)
							Else
								Call SalBringWindowToTop(hWin3)
							Break
						Case 4  !! FSC: Справочник параметров STBCH
							If not IsWindow(hWin4)
								Set hWin4 = SalCreateWindow(tbl_UbkiStbch, hWndParent, nPar, sPar1, sPar2)
							Else
								Call SalBringWindowToTop(hWin4)
							Break
						Case 30 !! Контроль анкет потенциальных заемщиков
							If not IsWindow(hWin30)
								Set hWin30 = SalCreateWindow( SEB1, hWndParent,nMode,nPar, sPar1,sPar2 )
							Else
								Call SalBringWindowToTop ( hWin30 )
							Break
						Case 31 !! Ввод анкет потенциальных заемщиков
							If not IsWindow(hWin31)
								Set hWin31 = SalCreateWindow( NAT, hWndParent,nMode,nPar, sPar1,sPar2 )
							Else
								Call SalBringWindowToTop ( hWin31 )
							Break
						Case 33 !! Спецификация залога
							If not IsWindow(hWin33)
								Set hWin33 = SalCreateWindow( SEB3,hWndMDI, nMode,nPar, sPar1,sPar2 )
							Else
								Call SalBringWindowToTop ( hWin33 )
							Break
						Case 40 !! Управление черным списком
							If not IsWindow(hWin40)
								Set hWin40 = SalCreateWindow( BL, hWndParent,nMode,nPar, sPar1,sPar2 )
							Else
								Call SalBringWindowToTop ( hWin40 )
							Break
						Case 41 !! Система управления карточками 
							If not IsWindow(hWin41)
								Set hWin41 = SalCreateWindow( CARD, hWndParent,nMode,nPar, sPar1,sPar2 )
							Else
								Call SalBringWindowToTop ( hWin41 )
							Break
			Function: ShowApdVersion
				Description: Показать версию APD
				Returns
				Parameters
					String: sWin
				Static Variables
				Local variables
					String: strText
					Number: nLength
				Actions
					Call SalStrSetBufferLength( strText, 160 )
					Set nLength = SalGetWindowText ( hWndForm, strText, 160 )
					Call SalSetWindowText ( hWndForm, ApdNum||sWin||ApdVer||' '||SalStrTrimX(strText) )
			Function: CC_LIM_NULL
				Description:
				Returns
					Boolean:
				Parameters
					Number: ND_
				Static Variables
				Local variables
				Actions
					If SqlPLSQLCommand(hSql(), "CCK.CC_LIM_NULL( ND_) " )
						Call SqlCommit( hSql() )
						Return TRUE
					Else
						Call SqlRollback(hSql())
						Call MessageNoWait('Неуспешное наполнение ГЛК 1 зап. ', 'Ошибка', 0, 1)
						Return FALSE
		Named Menus
			Menu: popupEditF
				Resource Id: 61241
				Title: NoMoreTitle
				Description:
				Enabled when:
				Status Text:
				Menu Item Name:
				Menu Item: Добавить
					Resource Id: 61242
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_Insert, 0, 0 )
					Menu Item Name:
				Menu Item: Удалить
					Resource Id: 61256
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_Delete, 0, 0 )
					Menu Item Name:
				Menu Separator
				Menu Item: Обновить
					Resource Id: 61243
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_Populate, 0, 0 )
					Menu Item Name:
				Menu Item: Сохранить
					Resource Id: 61244
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_Update, 0, 0 )
					Menu Item Name:
				Menu Separator
				Menu Item: Поиск
					Resource Id: 61257
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_Search, 0, 0 )
					Menu Item Name:
				Menu Item: Печать
					Resource Id: 20711
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_Print, 0, 0 )
					Menu Item Name:
				Menu Separator
				Menu Item: Выход
					Resource Id: 61245
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_DoubleClick, 0, 0 )
					Menu Item Name:
			Menu: popupEditP
				Resource Id: 61259
				Title: NoMoreTitle
				Description:
				Enabled when:
				Status Text:
				Menu Item Name:
				Menu Item: Обновить
					Resource Id: 61269
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_Populate, 0, 0 )
					Menu Item Name:
				Menu Separator
				Menu Item: Поиск
					Resource Id: 61246
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_Search, 0, 0 )
					Menu Item Name:
				Menu Item: Печать
					Resource Id: 61247
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_Print, 0, 0 )
					Menu Item Name:
				Menu Separator
				Menu Item: Выбрать
					Resource Id: 61248
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_DoubleClick, 0, 0 )
					Menu Item Name:
				Menu Item: Выход
					Resource Id: 61249
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_DoubleClick, 0, 0 )
					Menu Item Name:
			Menu: menuEdit
				Resource Id: 14319
				Title: &Edit
				Description: Simple Edit menu with Undo, Cut, Copy, Paste, Clear.
				Enabled when:
				Status Text: Undo, Cut, Copy, Paste, Clear 
				Menu Item Name:
				Menu Item: &Undo
					Resource Id: 14320
					Menu Item Name:
					Status Text: Reverses the last action
					Keyboard Accelerator: Ctrl+Z
					Menu Settings
						Enabled when: SalEditCanUndo()
						Checked when:
					Menu Actions
						Call SalEditUndo()
				Menu Separator
				Menu Item: Cu&t
					Resource Id: 14321
					Menu Item Name:
					Status Text: Cuts the selection and puts it on the clipboard
					Keyboard Accelerator: Ctrl+X
					Menu Settings
						Enabled when: SalEditCanCut()
						Checked when:
					Menu Actions
						Call SalEditCut()
				Menu Item: &Copy
					Resource Id: 14322
					Menu Item Name:
					Status Text: Copies the selection and puts it on the clipboard
					Keyboard Accelerator: Ctrl+C
					Menu Settings
						Enabled when: SalEditCanCut()
						Checked when:
					Menu Actions
						Call SalEditCopy()
				Menu Item: &Paste
					Resource Id: 52455
					Menu Item Name:
					Status Text: Inserts the Clipboard contents at the insertion point
					Keyboard Accelerator: Ctrl+V
					Menu Settings
						Enabled when: SalEditCanPaste()
						Checked when:
					Menu Actions
						Call SalEditPaste()
				Menu Item: C&lear
					Resource Id: 14324
					Menu Item Name:
					Status Text: Clears the selection
					Keyboard Accelerator: Del
					Menu Settings
						Enabled when: SalEditCanCut()
						Checked when:
					Menu Actions
						Call SalEditClear()
			Windows Menu: menuMDIWindows
				Resource Id: 14325
				Menu Item Name:
				Title: &Window
				Description: Menu to manage MDI child windows.
				Enabled when:
				Status Text: Manage MDI child windows
				Menu Item: &Tile Vertical
					Resource Id: 52469
					Menu Item Name:
					Status Text: Arrange MDI child windows in a vertical tiled format
					Keyboard Accelerator: (none)
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalMDITile( hWndMDI, TRUE )
				Menu Item: &Tile Horizontal
					Resource Id: 52470
					Menu Item Name:
					Status Text: Arrange MDI child windows in a horizontal tiled format
					Keyboard Accelerator: (none)
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalMDITile( hWndMDI, FALSE )
				Menu Item: &Cascade
					Resource Id: 14328
					Menu Item Name:
					Status Text: Arrange MDI child windows in a cascaded format
					Keyboard Accelerator: (none)
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalMDICascade( hWndMDI )
				Menu Item: &Arrange Icons
					Resource Id: 52472
					Menu Item Name:
					Status Text: Arrange minimized MDI child windows
					Keyboard Accelerator: (none)
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalMDIArrangeIcons( hWndMDI )
			Menu: popupEditF
				Resource Id: 20895
				Title: NoMoreTitle
				Description:
				Enabled when:
				Status Text:
				Menu Item Name:
				Menu Item: Добавить
					Resource Id: 23872
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_Insert, 0, 0 )
					Menu Item Name:
				Menu Item: Удалить
					Resource Id: 61254
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_Delete, 0, 0 )
					Menu Item Name:
				Menu Separator
				Menu Item: Обновить
					Resource Id: 23874
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_Populate, 0, 0 )
					Menu Item Name:
				Menu Item: Сохранить
					Resource Id: 23875
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_Update, 0, 0 )
					Menu Item Name:
				Menu Separator
				Menu Item: Поиск
					Resource Id: 60492
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_Search, 0, 0 )
					Menu Item Name:
				Menu Item: Печать
					Resource Id: 61251
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_Print, 0, 0 )
					Menu Item Name:
				Menu Separator
				Menu Item: Выход
					Resource Id: 20716
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_DoubleClick, 0, 0 )
					Menu Item Name:
			Menu: popupEditP
				Resource Id: 61252
				Title: NoMoreTitle
				Description:
				Enabled when:
				Status Text:
				Menu Item Name:
				Menu Item: Обновить
					Resource Id: 61253
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_Populate, 0, 0 )
					Menu Item Name:
				Menu Separator
				Menu Item: Поиск
					Resource Id: 20717
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_Search, 0, 0 )
					Menu Item Name:
				Menu Item: Печать
					Resource Id: 20718
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_Print, 0, 0 )
					Menu Item Name:
				Menu Separator
				Menu Item: Выбрать
					Resource Id: 20719
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_DoubleClick, 0, 0 )
					Menu Item Name:
				Menu Item: Выход
					Resource Id: 23884
					Keyboard Accelerator: (none)
					Status Text:
					Menu Settings
						Enabled when:
						Checked when:
					Menu Actions
						Call SalSendMsg( SalParentWindow(hWndForm), UM_DoubleClick, 0, 0 )
					Menu Item Name:
		Class Definitions
.data RESOURCE 0 0 1 3543233371
0000: A90000006A000000 0000000000000000 0200000100FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F22003C00 000A630047656E46
0040: 696C746500727400 00000400001E0002 0400C9000100003F 8001F80000003704
0060: 0001F00D000000FF 1F110000DC000200 FF7F157000000001 00FFFF01
.enddata
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton: cTBarButton
			Radio Button:
			Option Button:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box: cGenComboBox_DatId
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control: cQuickGraph
		Application Actions
			On SAM_AppStartup
	Form Window: Survey
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name:
		Title: Конструктор анкет
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  13.8"
				Width Editable? Class Default
				Height: 6.548"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbAddGroup
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip="Додати групу"
						On SAM_Click
							If cursurv=NUMBER_Null
								Call SalMessageBox("Не вибрано анкету для додання групи","Помилка",MB_IconExclamation | MB_Ok)
								Return FALSE
							Set nNewRow=SalTblInsertRow(Groups, TBL_MaxRow)
				Pushbutton: pbDelGroup
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.533"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip="Видалити групу (тільки для порожніх груп)"
						On SAM_Click
							! проверим, есть ли в этой группе вопросы; удалять только пустые
							If curgrp=NUMBER_Null
								Call SalMessageBox("Не вибрано групу для видалення","Помилка",MB_IconExclamation | MB_Ok)
								Return FALSE
							Call SqlPrepareAndExecute(cMain.hSql(),"SELECT count(*) FROM survey_quest INTO :temp WHERE qgrp_id="||NumberToStr(curgrp)||" AND survey_id="||NumberToStr(cursurv))
							Call SqlFetchNext(cMain.hSql(),nFetchRes)
							If temp!=0
								Call SalMessageBox("Ця група містить питання і не може бути видалена","Помилка",MB_IconExclamation | MB_Ok)
							Else
								Set nNewRow=SalTblQueryContext(Groups)
								Call SalTblSetRowFlags(Groups, nNewRow, ROW_MarkDeleted, TRUE)
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.933"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( Groups, UM_Populate, 0, 0 )
						On SAM_Create
							Set strTip = "Перечитати відомості для обраної анкети"
				Pushbutton: pbSaveGroup
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.983"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip="Зберігти зміни у групах"
						On SAM_Click
							Call SqlPrepareAndExecute(hSql(),"ROLLBACK")
							! сохранение групп текущей анкеты
							! проверка на NULL номера анкеты
							If cursurv=NUMBER_Null
								Call SalMessageBox("Не вибрано анкету","Помилка",MB_IconExclamation | MB_Ok)
								Return FALSE
							! проверим на непротиворечивость ord групп
							! посчитаем их количество
							Set nNewRow=TBL_MinRow
							Set nRows=0
							While SalTblFindNextRow( Groups, nNewRow, 0, ROW_MarkDeleted)
								Set nRows=nRows+1
							! создадим массив количества вопросов с таким ord
							Call SalArraySetUpperBound(ords,1,nRows)
							! пройдемся по всем элементам 
							Set i=1
							Loop
								If i>nRows
									Break
								Set ords[i]=1
								Set i=i+1
							! пройдемся по всем строкам таблицы и посчитаем собственно массив
							Set nNewRow=TBL_MinRow
							While SalTblFindNextRow( Groups, nNewRow, 0, ROW_MarkDeleted)
								Call SalTblSetContext( Groups, nNewRow )
								If Groups.grp_ord=NUMBER_Null
									Call SalMessageBox("Не введено порядок групи","Помилка",MB_IconExclamation | MB_Ok)
									Return FALSE
								If Groups.grp_ord>nRows
									Call SalMessageBox("Номер групи перевищує кількість питань у групі","Помилка",MB_IconExclamation | MB_Ok)
									Return FALSE
								Set ords[Groups.grp_ord]=ords[Groups.grp_ord]-1
							Set i=1
							Loop
								If i>nRows
									Break
								Set ords[i]=SalNumberAbs(ords[i])
								Set i=i+1
							Set temp=SalArraySum(ords)
							If temp>0
								Call SalMessageBox("Один з порядкових номерів пропущено або подвоєно","Помилка",MB_IconExclamation | MB_Ok)
								Return FALSE
							! самое простое - удалим удаленные и проапдейтим измененные
							Set nNewRow=TBL_MinRow
							While SalTblFindNextRow( Groups, nNewRow, ROW_MarkDeleted, 0)
								Call SalTblSetContext( Groups, nNewRow )
								If Groups.grp_id!=NUMBER_Null
									! значит, он раньше был в базе
									Call SqlPrepareAndExecute(hSql(),"DELETE FROM survey_qgrp WHERE grp_id=:Groups.grp_id")
							Call SqlPrepareAndExecute(hSql(), "ALTER TABLE SURVEY_QGRP DISABLE NOVALIDATE CONSTRAINT UK_SURVEYQGRP")
							Set nNewRow=TBL_MinRow
							While SalTblFindNextRow( Groups, nNewRow, ROW_Edited, 0)
								Call SalTblSetContext( Groups, nNewRow )
								! какие-то осмысленные проверки
								If Groups.grp_number=NUMBER_Null or Groups.grp_name=STRING_Null
									Call SalMessageBox("Не введено номер групи або її назву","Помилка",MB_IconExclamation | MB_Ok)
									Return FALSE
							Set nNewRow=TBL_MinRow
							While SalTblFindNextRow( Groups, nNewRow, ROW_Edited, 0)
								Call SalTblSetContext( Groups, nNewRow )
								If Groups.grp_id!=NUMBER_Null
									! значит, он раньше был в базе - обновляем
									Call SqlPrepareAndExecute(hSql(),"UPDATE survey_qgrp SET grp_ord=:Groups.grp_ord, grp_number=:Groups.grp_number, grp_name=:Groups.grp_name WHERE grp_id=:Groups.grp_id")
								Else
									! не было - добавляем
									Call SqlPrepareAndExecute(hSql(),"INSERT INTO survey_qgrp(grp_number, grp_name, grp_ord, survey_id) VALUES(:Groups.grp_number,:Groups.grp_name,:Groups.grp_ord,:cursurv)")
							Call SqlPrepareAndExecute(hSql(), "ALTER TABLE SURVEY_QGRP ENABLE VALIDATE CONSTRAINT UK_SURVEYQGRP")
							Call SqlPrepareAndExecute(hSql(),"COMMIT")
							Call SalSendMsg( Groups, UM_Populate, 0,0 )
				Line
					Resource Id: 50784
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  1.483"
						Begin Y:  0.417"
						End X:  1.483"
						End Y:  0.0"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbMoveQuest
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.383"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Click
							! смена цвета символизирует то, что теперь нажатие на группу перенесет туда выделенные вопросы
							! если уже передумал, нажать кнопку еще раз
							If NOT isMove
								Call SalColorSet(pbMoveQuest, COLOR_IndexWindow, SalColorFromRGB(0,128,255))
							Else
								Call SalColorSet(pbMoveQuest, COLOR_IndexWindow, lightblue)
							Set isMove=(NOT isMove)
						On SAM_Create
							Set lightblue=SalColorGet(pbMoveQuest, COLOR_IndexWindow)
							Set strTip="Перенести виділені питання до іншої групи"
				Pushbutton: pbDep
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.933"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip="Редагування підпорядкованих питань"
						On SAM_Click
							If curgrp=NUMBER_Null OR curquest=NUMBER_Null OR cursurv=NUMBER_Null
								Call SalMessageBox("Не вибрано питання","Помилка",MB_IconExclamation | MB_Ok)
								Return FALSE
							If Quest.qfmt_id != 1
								Call SalMessageBox("Це питання не може мати пов`язаних","Помилка",MB_IconExclamation | MB_Ok)
								Return FALSE
							If not IsWindow(hWin1)
								Set hWin1 = SalCreateWindow(QuestDep, Survey, cursurv, curgrp, curquest)
							Else
								Call SalBringWindowToTop ( hWin1 )
				Pushbutton: pbSort
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip="Відсортувати групи і питання анкети"
						On SAM_Click
							Call SqlPrepareAndExecute(hSql(),"ROLLBACK")
							! Call SqlPrepareAndExecute(hSql(),"begin Survey_rearrange("||NumberToStr(cursurv)||");  end;")
							Call SalSendMsg( Groups, UM_Populate, 0, 0 )
				Line
					Resource Id: 50785
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  3.433"
						Begin Y:  0.417"
						End X:  3.433"
						End Y:  0.0"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.383"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( Survey, SAM_Close, 0, 0 )
						On SAM_Create
							Set strTip = "Вихід"
				Line
					Resource Id: 50786
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  3.867"
						Begin Y:  0.44"
						End X:  3.867"
						End Y:  0.024"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Background Text: Анкета
					Resource Id: 38426
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.233"
						Top:    0.119"
						Width:  0.85"
						Width Editable? Yes
						Height: 0.179"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Combo Box: cmbSurvey
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_NumId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   6.0"
						Top:    0.071"
						Width:  7.583"
						Width Editable? Class Default
						Height: 1.81"
						Height Editable? Class Default
					Visible? Class Default
					Editable? No
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_Create
							If cmbSurvey.Init( hWndItem )
								Call cmbSurvey.Populate( hSql(), 'survey_id', 'survey_name', 'survey', 'WHERE activity=0 ORDER BY survey_id' )
						On SAM_Click
							Call SalSendMsg( Groups, UM_Populate, 0, 0 )
				Pushbutton: pbAddQuest
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbInsert
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.583"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip="Додати питання"
						On SAM_Click
							If cursurv=NUMBER_Null or curgrp=NUMBER_Null
								Call SalMessageBox("Не вибрано анкету чи групу для додавання питання","Помилка",MB_IconExclamation | MB_Ok)
								Return FALSE
							Set nNewRow=SalTblInsertRow(Quest, TBL_MaxRow)
							Set Quest.multi=0
				Pushbutton: pbDelQuest
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDelete
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.033"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip="Видалити питання"
						On SAM_Click
							! проверим, есть ли у этого вопроса связанные с ним; удалять только отдельные
							! переделано на удаление всех выделенных вопросов
							! If curquest=NUMBER_Null
								                                             Call SalMessageBox("Не вибрано питання для видалення ","Помилка",MB_IconExclamation | MB_Ok)
								                                             Return FALSE
							! Call SqlPrepareAndExecute(cMain.hSql(),"SELECT count(*) FROM survey_quest_dep INTO :temp WHERE "||NumberToStr(curquest)||" in (quest_id, child_id) AND survey_id="||NumberToStr(cursurv))
							! Call SqlFetchNext(cMain.hSql(),nFetchRes)
							! If temp!=0
								                                             Call SalMessageBox("Це питання має пов`язане з ним і не може бути видалено","Помилка",MB_IconExclamation | MB_Ok)
							! Else
								                                             Set nNewRow=SalTblQueryContext(Quest)
								                                             Call SalTblSetRowFlags(Quest, nNewRow, ROW_MarkDeleted, TRUE)
							Set nNewRow=TBL_MinRow
							While SalTblFindNextRow( Quest, nNewRow, ROW_Selected, 0)
								Call SalTblSetContext( Quest, nNewRow )
								Call SqlPrepareAndExecute(cMain1.hSql(),"SELECT count(*) FROM survey_quest_dep INTO :temp WHERE "||NumberToStr(Quest.id)||" in (quest_id, child_id) AND survey_id="||NumberToStr(cursurv))
								Call SqlFetchNext(cMain1.hSql(),nFetchRes)
								If temp!=0
									Call SalMessageBox("Одне з виділених питань має пов`язане з ним і не може бути видалено","Помилка",MB_IconExclamation | MB_Ok)
									Return FALSE
								If Quest.num_ans>0
									Call SalMessageBox("Одне з виділених питань має відповіді і не може бути видалено","Помилка",MB_IconExclamation | MB_Ok)
									Return FALSE
							Set nNewRow=TBL_MinRow
							While SalTblFindNextRow( Quest, nNewRow, ROW_Selected, 0)
								Call SalTblSetRowFlags(Quest, nNewRow, ROW_MarkDeleted, TRUE)
				Pushbutton: pbSaveQuest
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbUpdate
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip="Зберігти зміни у питаннях"
						On SAM_Click
							Call SqlPrepareAndExecute(hSql(),"ROLLBACK")
							! сохранение вопросов внутри текущей группы
							If cursurv=NUMBER_Null or curgrp=NUMBER_Null
								Call SalMessageBox("Не вибрано анкету чи групу","Помилка",MB_IconExclamation | MB_Ok)
								Return FALSE
							! проверим на непротиворечивость ord вопросов
							! посчитаем их количество
							Set nNewRow=TBL_MinRow
							Set nRows=0
							While SalTblFindNextRow( Quest, nNewRow, 0, ROW_MarkDeleted)
								Set nRows=nRows+1
							! создадим массив количества вопросов с таким ord
							Call SalArraySetUpperBound(ords,1,nRows)
							! пройдемся по всем элементам 
							Set i=1
							Loop
								If i>nRows
									Break
								Set ords[i]=1
								Set i=i+1
							! пройдемся по всем строкам таблицы и посчитаем собственно массив
							Set nNewRow=TBL_MinRow
							While SalTblFindNextRow( Quest, nNewRow, 0, ROW_MarkDeleted)
								Call SalTblSetContext( Quest, nNewRow )
								If Quest.ord=NUMBER_Null
									Call SalMessageBox("Не введено порядок питання","Помилка",MB_IconExclamation | MB_Ok)
									Return FALSE
								If Quest.ord>nRows
									Call SalMessageBox("Номер питання перевищує кількість питань у групі","Помилка",MB_IconExclamation | MB_Ok)
									Return FALSE
								Set ords[Quest.ord]=ords[Quest.ord]-1
							Set i=1
							Loop
								If i>nRows
									Break
								Set ords[i]=SalNumberAbs(ords[i])
								Set i=i+1
							Set temp=SalArraySum(ords)
							If temp>0
								Call SalMessageBox("Один з порядкових номерів пропущено або подвоєно","Помилка",MB_IconExclamation | MB_Ok)
							! самое простое - удалим удаленные и проапдейтим измененные
							Set nNewRow=TBL_MinRow
							While SalTblFindNextRow( Quest, nNewRow, ROW_MarkDeleted, 0)
								Call SalTblSetContext( Quest, nNewRow )
								If Quest.id!=NUMBER_Null
									! значит, он раньше был в базе
									Call SqlPrepareAndExecute(hSql(),"DELETE FROM survey_quest WHERE quest_id=:Quest.id AND survey_id="||NumberToStr(cursurv))
							! цикл для проверки построчной корректности данных
							Set nNewRow=TBL_MinRow
							While SalTblFindNextRow( Quest, nNewRow, ROW_Edited, 0)
								Call SalTblSetContext( Quest, nNewRow )
								! какие-то осмысленные проверки
								If Quest.qfmt_id=NUMBER_Null or Quest.text=STRING_Null
									Call SalMessageBox("Не введено текст питання або формат відповіді","Помилка",MB_IconExclamation | MB_Ok)
									Return FALSE
								If Quest.qfmt_id=1 and Quest.list_id=NUMBER_Null
									Call SalMessageBox("Для формату відповіді 'Вибір зі списку' потрібне поле 'Назва списку'","Помилка",MB_IconExclamation | MB_Ok)
									Return FALSE
								If Quest.qfmt_id=2 and (Quest.ex_name=STRING_Null or Quest.ex_key=STRING_Null or Quest.ex_val=STRING_Null)
									Call SalMessageBox("Для формату відповіді 'Вибір з довідника' потрібні поля 'Назва таблиці', 'Поле-ключ' і 'Поле-значення'","Помилка",MB_IconExclamation | MB_Ok)
									Return FALSE
								If Quest.qfmt_id=2
									! проверка, существуют ли введенные пользователем таблица и поле
									Call SqlPrepareAndExecute(cMain.hSql(), "SELECT bars.Check_col_exists(:Quest.ex_name, :Quest.ex_key) INTO :temp FROM dual")
									If not SqlFetchNext(cMain.hSql(), nFetchRes)
										Call SalMessageBox("Таблиця "||Quest.ex_name||" не містить поля "||Quest.ex_key,"Помилка",MB_IconExclamation | MB_Ok)
										Return FALSE
									Call SqlPrepareAndExecute(cMain.hSql(), "SELECT bars.Check_col_exists(:Quest.ex_name, :Quest.ex_val) INTO :temp FROM dual")
									If not SqlFetchNext(cMain.hSql(), nFetchRes)
										Call SalMessageBox("Таблиця "||Quest.ex_name||" не містить поля "||Quest.ex_val,"Помилка",MB_IconExclamation | MB_Ok)
										Return FALSE
							! если все строки прошли все проверки, таки да сохраняем
							Call SqlPrepareAndExecute(hSql(), "ALTER TABLE SURVEY_QUEST DISABLE NOVALIDATE CONSTRAINT UK_SURVEYQUEST")
							Set nNewRow=TBL_MinRow
							While SalTblFindNextRow( Quest, nNewRow, ROW_Edited, 0)
								Call SalTblSetContext( Quest, nNewRow )
								If Quest.id!=NUMBER_Null
									! значит, он раньше был в базе - обновляем
									Call SqlPrepareAndExecute(hSql(),"UPDATE survey_quest SET quest_ord=:ord, qfmt_id=:qfmt_id, quest_name=:text, quest_multi=:multi, extrn_tabname=:ex_name, extrn_tabkey=:ex_key, extrn_tabvalue=:ex_val, list_id=:list_id WHERE quest_id=:Quest.id AND 
											survey_id="||NumberToStr(cursurv))
								Else
									! не было - добавляем
									Call SqlPrepareAndExecute(hSql(),"INSERT INTO survey_quest(quest_ord, qfmt_id, quest_name, quest_multi, extrn_tabname, extrn_tabkey, extrn_tabvalue, list_id, survey_id, qgrp_id) VALUES(:ord, :qfmt_id, :text, :multi, :ex_name, 
											:ex_key, :ex_val, :list_id, :cursurv, :curgrp)")
							! вернуть констрейнт обратно
							Call SqlPrepareAndExecute(hSql(), "ALTER TABLE SURVEY_QUEST ENABLE VALIDATE CONSTRAINT UK_SURVEYQUEST")
							Call SqlPrepareAndExecute(hSql(),"COMMIT")
							Call SalSendMsg( Quest, UM_Populate, 0,0 )
		Contents
			Custom Control: ccSplitter
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   2.0"
						Top:    2.0"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: Groups
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   -0.05"
						Top:    -0.036"
						Width:  13.383"
						Width Editable? Class Default
						Height: 2.0"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: grp_id
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Ідент.
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.933"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: grp_ord
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Порядк. номер
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.833"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: grp_number
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Показ. номер
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  2.15"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: grp_name
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Назва групи
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  7.25"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On UM_Populate
						If cmbSurvey.GetKey(SalListQuerySelection(cmbSurvey)) != NUMBER_Null
							Call SalWaitCursor(TRUE)
							Set cursurv=cmbSurvey.GetKey(SalListQuerySelection(cmbSurvey))
							Call SalTblPopulate(Groups, hSql(), "SELECT grp_id, grp_ord, grp_number, grp_name INTO :grp_id, :grp_ord, :grp_number, :grp_name FROM survey_qgrp WHERE survey_id="|| NumberToStr( cursurv ) ||" ORDER BY grp_ord", TBL_FillAll)
							Call SalTblSetFocusRow(Groups,0)
							Call SalSendMsg( Groups, SAM_RowSetContext, 0,0 )
							Call SalWaitCursor(FALSE)
					On SAM_RowSetContext
						If (isMove)
							! переносим в эту группу выделенные вопросы из (бывшей) текущей
							! проверим, что у выделенных вопросов нет связанных
							Call SqlClose(cMain1.hSql())
							While SalTblFindNextRow( Quest, nNewRow, ROW_Selected, 0)
								Call SalTblSetContext( Quest, nNewRow )
								Call SqlPrepareAndExecute(cMain1.hSql(),"SELECT count(*) FROM survey_quest_dep INTO :temp WHERE "||NumberToStr(curquest)||" in (quest_id, child_id) AND survey_id="||NumberToStr(cursurv))
								Call SqlFetchNext(cMain1.hSql(),nFetchRes)
								If temp!=0
									Call SalMessageBox("Одне з виділених питань має пов`язане з ним і не може бути перенесено до іношї групи","Помилка",MB_IconExclamation | MB_Ok)
									Return FALSE
							! отключаем констрейнт на ord
							Call SqlPrepareAndExecute(hSql(), "ALTER TABLE SURVEY_QUEST DISABLE NOVALIDATE CONSTRAINT UK_SURVEYQUEST")
							Set newgrp=grp_id
							Call SqlPrepareAndExecute(cMain1.hSql(), "SELECT max(quest_ord) FROM survey_quest INTO :neword WHERE qgrp_id=:newgrp")
							Call SqlFetchNext(cMain1.hSql(),nFetchRes)
							! дописать вопросы в конец новой группы
							Set nNewRow=TBL_MinRow
							While SalTblFindNextRow( Quest, nNewRow, ROW_Selected, 0)
								Call SalTblSetContext( Quest, nNewRow )
								Set neword=neword+1
								Call SqlPrepareAndExecute(hSql(),"UPDATE survey_quest SET qgrp_id=:newgrp, quest_ord=:neword WHERE quest_id=:Quest.id AND survey_id=:cursurv")
							! перенумеровать оставшиеся вопросы в старой группе
							Set nNewRow=TBL_MinRow
							Set neword=0
							While SalTblFindNextRow( Quest, nNewRow, 0, ROW_Selected)
								Call SalTblSetContext( Quest, nNewRow )
								Set neword=neword+1
								Call SqlPrepareAndExecute(hSql(),"UPDATE survey_quest SET quest_ord=:neword WHERE quest_id=:Quest.id AND survey_id=:cursurv")
							! вернуть констрейнт обратно
							Call SqlPrepareAndExecute(hSql(), "ALTER TABLE SURVEY_QUEST ENABLE VALIDATE CONSTRAINT UK_SURVEYQUEST")
							Call SqlPrepareAndExecute(hSql(),"COMMIT")
							Call SalColorSet(pbMoveQuest, COLOR_IndexWindow, lightblue)
							Set isMove=FALSE
						Set curgrp=grp_id
						Call SalSendMsg( Quest, UM_Populate, 0,0 )
			Child Table: Quest
				Class Child Ref Key: 27
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    2.071"
						Width:  13.333"
						Width Editable? Class Default
						Height: 2.798"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Sky
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: id
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Ідент.
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.783"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ord
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Порядк. N
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: text
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Текст питання
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 250
						Data Type: String
						Justify: Left
						Width:  3.883"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: qfmt_id
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Текст вопроса
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  3.883"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: qfmt
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Формат відповіді
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  3.2"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								If qfmt.Init( hWndItem )
									Call qfmt.Populate( hSql(), 'fmt_id', 'fmt_name', 'survey_qfmt', "ORDER BY fmt_id" )
							On SAM_AnyEdit
								Set Quest.qfmt_id=qfmt.GetKey(SalListQuerySelection(qfmt))
								If qfmt_id=1
									Set ex_name=STRING_Null
									Set ex_key=STRING_Null
									Set ex_val=STRING_Null
								Else If qfmt_id=2
									Set list=STRING_Null
									Set list_id=NUMBER_Null
									Set multi=0
								Else
									Set ex_name=STRING_Null
									Set ex_key=STRING_Null
									Set ex_val=STRING_Null
									Set list=STRING_Null
									Set list_id=NUMBER_Null
									Set multi=0
					Column: multi
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Неоднозначна відп.
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
					Column: list_id
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: list
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Назва списку
						Visible? Class Default
						Editable? Yes
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.45"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								If list.Init( hWndItem )
									Call list.Populate( hSql(), 'list_id', 'list_name', 'survey_opt_list', "ORDER BY list_id" )
							On SAM_AnyEdit
								Set Quest.list_id=list.GetKey(SalListQuerySelection(list))
					Column: ex_name
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Назва таблиці
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.367"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ex_key
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Поле-ключ
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.5"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ex_val
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Поле-значення
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.45"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: num_ans
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Кол-во ответов
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.383"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On UM_Populate
						If cursurv != NUMBER_Null and curgrp!=NUMBER_Null
							Call SalWaitCursor(TRUE)
							Call SalTblPopulate(Quest, hSql(), "SELECT q.quest_id, q.quest_ord ord1, q.quest_name, q.qfmt_id,  f.fmt_name, q.quest_multi, q.extrn_tabname, q.extrn_tabkey, q.extrn_tabvalue, q.list_id, l.list_name, tmp.num 
									INTO :id, :ord, :text, :qfmt_id, :qfmt, :multi, :ex_name, :ex_key, :ex_val, :list_id, :list, :num_ans 
									FROM survey_quest q, survey_qfmt f, 
									(SELECT count(sa.session_id) num, sa.quest_id FROM survey_answer sa, survey_session ss 
									WHERE ss.survey_id="||NumberToStr(cursurv)||" AND ss.session_id=sa.session_id GROUP BY sa.quest_id
									UNION
									SELECT 0 num, sq1.quest_id quest_id FROM survey_quest sq1 
									WHERE sq1.survey_id="|| NumberToStr( cursurv ) ||" AND sq1.quest_id not in (select sa.quest_id from survey_answer sa, survey_session ss where ss.survey_id=sq1.survey_id AND ss.session_id=sa.session_id)
									) tmp, 
									(select * from survey_opt_list union select 0 list_id, '' list_name from dual) l 
									WHERE tmp.quest_id=q.quest_id AND q.survey_id="|| NumberToStr( cursurv ) ||" AND q.qgrp_id="|| NumberToStr(curgrp) || 
									" AND f.fmt_id=q.qfmt_id AND l.list_id=nvl(q.list_id,0) ORDER BY ord1", TBL_FillAll)
							Call SalWaitCursor(FALSE)
							Call SalSendMsg( Quest, SAM_RowSetContext, 0, 0 )
					On SAM_RowSetContext
						Set curquest=id
						! если в кол-ве ответов не 0, ставим все колонки, кроме ord и text, в нередактируемые
						If num_ans>0
							Call SalTblSetColumnFlags(qfmt, COL_Editable, FALSE)
							Call SalTblSetColumnFlags(list, COL_Editable, FALSE)
							Call SalTblSetColumnFlags(ex_name, COL_Editable, FALSE)
							Call SalTblSetColumnFlags(ex_key, COL_Editable, FALSE)
							Call SalTblSetColumnFlags(ex_val, COL_Editable, FALSE)
						Else
							Call SalTblSetColumnFlags(qfmt, COL_Editable, TRUE)
							Call SalTblSetColumnFlags(list, COL_Editable, TRUE)
							Call SalTblSetColumnFlags(ex_name, COL_Editable, TRUE)
							Call SalTblSetColumnFlags(ex_key, COL_Editable, TRUE)
							Call SalTblSetColumnFlags(ex_val, COL_Editable, TRUE)
					On SAM_KillFocus
						Call SalSendMsg( Quest.qfmt, SAM_AnyEdit, 0, 0 )
		Functions
		Window Parameters
		Window Variables
			Window Handle: hWin30
			Window Handle: hWin31
			!
			: cMain
				Class: cABSConnect
			: cMain1
				Class: cABSConnect
			Number: curgrp
			Number: cursurv
			Number: curquest
			Number: nNewRow
			Number: nRows
			Number: temp
			Number: nFetchRes
			Number: ords[1:*]
			Number: i
			String: tmp
			Boolean: isMove
			Number: lightblue
			Number: neword
			Number: newgrp
		Message Actions
			On SAM_Create
				Call XConnectGetParams( cMain )
				Call XConnectGetParams( cMain1 )
				If NOT cMain.Connect()
					Call Debug('Невозможно установить коннект')
				If NOT cMain1.Connect()
					Call Debug('Невозможно установить коннект')
				Set cursurv=NUMBER_Null
				Set curgrp=NUMBER_Null
				Set curquest=NUMBER_Null
				Set isMove=FALSE
	Table Window: QuestDep
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  11.6"
				Width Editable? Class Default
				Height: 2.583"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.429"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbAddDep
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip="Додати підрядне питання"
						On SAM_Click
							Set nNewRow=SalTblInsertRow(QuestDep, TBL_MaxRow)
							Return TRUE
				Pushbutton: pbDelDep
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip="Видалити підрядне питання"
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbSaveDep
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.933"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip="Зберігти зміни"
						On SAM_Click
							Call SqlPrepareAndExecute(hSql(),"ROLLBACK")
							Call SqlPrepareAndExecute(hSql(),"DELETE FROM survey_quest_dep WHERE quest_id=:ParId AND survey_id=:SurvId")
							Set nNewRow=TBL_MinRow
							While SalTblFindNextRow( QuestDep, nNewRow, 0, ROW_MarkDeleted)
								Call SalTblSetContext( QuestDep, nNewRow )
								Call SqlPrepareAndExecute(hSql(), "INSERT INTO survey_quest_dep(quest_id, opt_id, child_id, child_state, survey_id) VALUES(:ParId, :OptId, :ChildId, NVL(:ChildState,0), :SurvId)")
							Call SqlPrepareAndExecute(hSql(),"COMMIT")
							Call SalSendMsg(QuestDep, UM_Populate, 0, 0)
				Line
					Resource Id: 53166
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.1"
						Begin Y:  Class Default
						End X:  2.1"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 53167
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.567"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( QuestDep, SAM_Close, 0, 0 )
						On SAM_Create
							Set strTip = "Вихід"
				Line
					Resource Id: 53168
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  1.45"
						Begin Y:  Class Default
						End X:  1.45"
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Background Text: Головне питання
					Resource Id: 53169
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   2.233"
						Top:    0.119"
						Width:  1.65"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: Parent
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   3.883"
							Top:    0.095"
							Width:  7.25"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Create
							Call SqlPrepareAndExecute(hSql(),"SELECT quest_name, list_id INTO :Parent, :listik FROM survey_quest WHERE quest_id=:ParId AND survey_id=:SurvId")
							Call SqlFetchNext(hSql(), nFetchRes)
		Contents
			Column: OptId
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OptText
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_NumId
				Property Template:
				Class DLL Name:
				Title: Ответ, вызывающий связанный вопрос
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  3.883"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? No
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_AnyEdit
						Set QuestDep.OptId=OptText.GetKey(SalListQuerySelection(OptText))
					On SAM_SetFocus
						If OptText.Init( hWndItem )
							Call OptText.Populate( hSql(), "opt_id", "opt_val", "survey_answer_opt", "WHERE list_id="||NumberToStr(listik)||" ORDER BY opt_id" )
			Column: ChildId
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ChildText
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_NumId
				Property Template:
				Class DLL Name:
				Title: Связанный вопрос
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  5.417"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_AnyEdit
						Set QuestDep.ChildId=ChildText.GetKey(SalListQuerySelection(ChildText))
					On SAM_SetFocus
						If ChildText.Init( hWndItem )
							Call ChildText.Populate( hSql(), "quest_id", "substr(quest_ord||'. '||quest_name, 1, 250)", "survey_quest", "WHERE qgrp_id="||NumberToStr(GrpId)||" ORDER BY quest_id" )
			Column: ChildState
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Статус
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: SurvId
			Number: GrpId
			Number: ParId
		Window Variables
			Number: nFetchRes
			Number: listik
			Number: nNewRow
		Message Actions
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Call SalTblPopulate(QuestDep, hSql(), "SELECT qd.opt_id, ao.opt_val, qd.child_id, q.quest_name, qd.child_state INTO :OptId, :OptText, :ChildId, :ChildText, :ChildState FROM survey_quest_dep qd, survey_quest q, survey_answer_opt ao
						WHERE qd.quest_id=:ParId AND qd.opt_id=ao.opt_id AND qd.child_id=q.quest_id AND qd.survey_id=:SurvId AND q.survey_id=:SurvId ORDER BY opt_ord", 
						TBL_FillAll)
				Call SalWaitCursor(FALSE)
			On SAM_Create
				Call SalSendMsg( QuestDep, UM_Populate, 0, 0 )
	Form Window: NAT
		Class: cQuickTabsForm
		Property Template:
		Class DLL Name:
		Title: Кредитня угода з фізичною особою
		Icon File:
		Accesories Enabled? Yes
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.375"
				Top:    1.719"
				Width:  13.35"
				Width Editable? Class Default
				Height: 7.179"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pb_F6
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRefresh
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F6
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Оновити '
						On SAM_Click
							Call All_Null()
							Call F_LOAD(0)
				Pushbutton: pb_New
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbHelp
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F1
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: C:\bars98\RESOURCE\BMP\NEWREC.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'F1. Види банкiвських продуктiв'
						On SAM_Click
							Set sTmp =''
							Set SurveySessionID=-GetUserId()
							Set SurveySessionID_Null=TRUE
							Call FunNSIGetFiltered
									("CC_POTR", "NAME",
									 "CC_POTR.FLAG=1 and CC_POTR.ID in (select ID from CC_TOBO_POTR)",
									sTmp, T150 )
							If sTmp !=''
								Call F_POPULATE(sTmp)
								Call F_DISA('BUTTON',1)
								Set KRDN = NUMBER_Null
								Set TK150=SalStrToNumber(sTmp)
								! Call SalColorSet( KRDS_, COLOR_IndexWindow, nColR )
								Call SalMapEnterToTab( TRUE )
				Pushbutton: pb_Edit
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbInsert
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: C:\bars98\RESOURCE\BMP\DETAILS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = "Редактирование анкет, еще НЕ переданных на визирование"
						On SAM_Click
							Call F_LOAD (1)
							Set SurveySessionID_Null=FALSE
				Pushbutton: pb_Exit
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbCancel
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Esc
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'ESC. Завершити  '
						On SAM_Click
							Call SalDestroyWindow(hWndForm)
				Data Field: TK150
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.783"
							Top:    0.071"
							Width:  0.467"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код банкiвського продукту')
				Data Field: T150
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.283"
							Top:    0.071"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(150))
				Data Field: SurveySessionID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.383"
							Top:    0.071"
							Width:  0.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, '№ Анкеты' )
				Data Field: BASEY
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.45"
							Top:    0.262"
							Width:  0.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код базового року для %%' )
				Data Field: SBASEY
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.85"
							Top:    0.429"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва базового року для %%' )
				Data Field: MES
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.783"
							Top:    0.071"
							Width:  0.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Макс.довжина дiї (мiс)' )
				Data Field: YAR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.483"
							Top:    0.071"
							Width:  0.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Макс.довжина дiї (років)' )
				Data Field: SMAX
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.083"
							Top:    0.071"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Макс.сума кредиту' )
				Data Field: PRK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.383"
							Top:    0.321"
							Width:  0.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, '% вiд суми для ЩОМIС.комiсiї')
				Data Field: METR90
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.75"
							Top:    0.512"
							Width:  0.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код методики ЩОМIСЯЧНОЇ комiсiї')
				Data Field: NAME90
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.183"
							Top:    0.321"
							Width:  3.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва методики ЩОМIСЯЧНОЇ комiсiї')
				Data Field: MODE_GPK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.25"
							Top:    0.762"
							Width:  0.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код моделі погашення кредиту')
				Data Field: NAME_GPK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.283"
							Top:    0.321"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва моделі погашення кредиту')
				Data Field: SURVEY
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.75"
							Top:    0.762"
							Width:  0.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код мотодики (анкети)')
				Data Field: Smin
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.783"
							Top:    0.321"
							Width:  1.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Минимальная сумма кредита')
				Data Field: nPAWN
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.75"
							Top:    1.012"
							Width:  0.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код виду забезпечення')
				Data Field: sPAWN
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.95"
							Top:    0.429"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва виду забезпечення')
				Pushbutton: pbSave
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbUpdate
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.883"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Сохранить Анкету (как промежуточные данные)'
						On SAM_Click
							Call SalWaitCursor ( TRUE )
							If F_RUN()
								! Call SalEnableWindow( pb_PR_1 )
								! Call SalEnableWindow( pb_PR_2 )
								Call MessageNoWait('Сохранена анкета, реф='|| Str(SurveySessionID),'Сообщение',3,0)
								Call SqlCommit(hSql())
								Set SurveySessionID_Null=FALSE
								Call SalWaitCursor ( FALSE )
							Else
								! Call SalDisableWindow( pb_PR_1 )
								! Call SalDisableWindow( pb_PR_2 )
								Call SqlRollback(hSql())
								Call SalWaitCursor ( FALSE )
								Call MessageNoWait('Неуспешное сохранение анкеты', 'Ошибка', 0, 1)
							If SqlPrepareAndExecute( hSql(),
									  "SELECT nvl(session_id,0) INTO :SurveySessionID
									   FROM survey_session
									   WHERE session_id=:SurveySessionID")
									and SqlFetchNext(hSql(), nFetchRes) 
							If SurveySessionID=0 or SurveySessionID_Null=TRUE
								Set SurveySessionID=- GetUserId()
				Pushbutton: pb_End
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbUpdate
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.883"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\EXECUTE.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Передать анкету другим специалистам на визирование'
						On SAM_Click
							If SurveySessionID>0
								If SqlPrepareAndExecute(  hSql(), "SELECT substr(seb_sur.reguired_fields (:SurveySessionID,1),1,4000) into :ml_error from dual" ) 
										   and SqlFetchNext(hSql(), nFetchRes)
									If ml_error=STRING_Null
										If SqlPrepareAndExecute( hSql(),
												"update SURVEY_SESSION
												    set COMPLETED = 2 where SESSION_ID =:SurveySessionID " )
											If SqlCommit( hSql() )
												Call MessageNoWait( "№ "||Str(SurveySessionID)||':'|| strTip, 'Сообщение',2,0)
									Else
										Call MessageNoWait('Не заповнені усі обовьязкові поля для збереження','Повідомлення',3,0)
				Pushbutton: pb_Viza
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbUpdate
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOCVIEW.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Maize
					Message Actions
						On SAM_Create
							Set strTip = 'Просмотр виз и листинга анкеты'
						On SAM_Click
							Call SalCreateWindow( SEB2, hWndMDI,
									SurveySessionID,9, '', "Менеджер", '','','','','','' )
				Pushbutton: pb_Zalog
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Pach.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Спецификация залога'
						On SAM_Click
							If nPar=0
								Call Sel037(hWndMDI,33, SurveySessionID, '-1',  T1 )
				Data Field: Session_Date
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.883"
							Top:    0.071"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
		Contents
			Picture: picTabs
.data CLASSPROPS
0000: 546162546F704D61 7267696E00020030 0000546162466F72 6D50616765730008
0020: 0009090909090909 0000546162447261 775374796C65000B 0057696E39355374
0040: 796C650000546162 52696768744D6172 67696E0002003000 005461624E616D65
0060: 730030004E616D65 30094E616D653109 4E616D6538094E61 6D6536094E616D65
0080: 32094E616D653709 4E616D6535094E61 6D65340000546162 4C6162656C73005C
00A0: 0009C7E0E5ECF8E8 EA09CAF0E5E4E8F2 09C7E0EDFFF2EEF1 F2FC09C4EEF5EEE4
00C0: FB2FD0E0F1F5EEE4 FB09C0EAF2E8E2FB 09CAF0E5E4E8F2ED E0FF20E8F1F2EEF0
00E0: E8FF09C4EEE4E0F2 EAEEE2E020B3EDF4 2EEFEE20EAF0E5E4 E8F2F32000005461
0100: 6250616765436F75 6E74000200310000 546162426F74746F 6D4D617267696E00
0120: 0200300000546162 43757272656E7400 06004E616D653100 005461624C656674
0140: 4D617267696E0002 003000005461624F 7269656E74617469 6F6E000100000000
0160: 0000000000000000 0000000000000000 0000000000
.enddata
.data CLASSPROPSSIZE
0000: 7501
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cQuickTabsForm
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.083"
					Top:    0.0"
					Width:  12.0"
					Width Editable? Class Default
					Height: 4.0"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				File Name:
				Storage: Class Default
				Picture Transparent Color: Class Default
				Fit: Class Default
				Scaling
					Width:  Class Default
					Height:  Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Tile To Parent? Yes
				Border Color: Default
				Background Color: 3D Face Color
				Message Actions
			Pushbutton: pb_History_Del
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbSynchro
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   12.217"
					Top:    1.024"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\DELETE.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set nNewRow=SalTblQueryContext(tbl_History)
						Call SalTblSetRowFlags(tbl_History, nNewRow, ROW_MarkDeleted, TRUE)
						Call SalTblDeleteRow ( tbl_History, nNewRow, TBL_Adjust)
			Pushbutton: pb_Capital_Del
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbSynchro
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   12.15"
					Top:    1.0"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\DELETE.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set nNewRow=SalTblQueryContext(tbl_Capital)
						Call SalTblSetRowFlags(tbl_Capital, nNewRow, ROW_MarkDeleted, TRUE)
						Call SalTblDeleteRow ( tbl_Capital, nNewRow, TBL_Adjust)
			Pushbutton: pb_Emp_Del
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbSynchro
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   12.183"
					Top:    0.976"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\DELETE.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set nNewRow=SalTblQueryContext(tbl_Emp)
						Call SalTblSetRowFlags(tbl_Emp, nNewRow, ROW_MarkDeleted, TRUE)
						Call SalTblDeleteRow ( tbl_Emp, nNewRow, TBL_Adjust)
			Pushbutton: pb2_Del
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbSynchro
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   12.217"
					Top:    2.869"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\DELETE.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set nNewRow=SalTblQueryContext(tbl2)
						Call SalTblSetRowFlags(tbl2, nNewRow, ROW_MarkDeleted, TRUE)
						Call SalTblDeleteRow ( tbl2, nNewRow, TBL_Adjust)
			Pushbutton: pb_Exp_Del
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbSynchro
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   12.25"
					Top:    3.595"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\DELETE.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set nNewRow=SalTblQueryContext(tbl_Exp)
						Call SalTblSetRowFlags(tbl_Exp, nNewRow, ROW_MarkDeleted, TRUE)
						Call SalTblDeleteRow ( tbl_Exp, nNewRow, TBL_Adjust)
			Pushbutton: pb_Emp
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6536000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbInsert
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   12.15"
					Top:    0.595"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip="Додати від зайнятості"
					On SAM_Click
						Set nNewRow=SalTblInsertRow(tbl_Emp, TBL_MaxRow)
						Set V401=STRING_Null
						Set VK401=NUMBER_Null
						Set V402=STRING_Null
						Set V403=STRING_Null
						Set V404=NUMBER_Null
						Set V405=STRING_Null
						Set VK405=NUMBER_Null
						Set V406=STRING_Null
						Set V407=NUMBER_Null
						Set V408=NUMBER_Null
						Set V409=NUMBER_Null
						Set V410=STRING_Null
						Set VK410=NUMBER_Null
						! Set tbl2.multi=0
			Child Table: tbl_Emp
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6536000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.217"
						Top:    0.595"
						Width:  11.867"
						Width Editable? Yes
						Height: 2.0"
						Height Editable? Yes
					Visible? No
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: TK601
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код получателя
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.867"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: TK610
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код стаьи доходов
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.867"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: col11
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код статьи
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: T400
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Характер 
								занятости
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.167"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								If T400.Init( hWndItem )
									Call T400.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=13 ORDER BY opt_ord" )
							On SAM_AnyEdit
								Set TK400= T400.GetKey( SalListQuerySelection(hWndItem))
							On SAM_SetFocus
								Call SalMapEnterToTab( TRUE )
					Column: T401
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Место 
								работы
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.1"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								If T401.Init( hWndItem )
									Call T401.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=6 ORDER BY opt_ord" )
							On SAM_AnyEdit
								Set TK401= T401.GetKey( SalListQuerySelection(hWndItem))
								Set V401=T401
							On SAM_SetFocus
								Call SalMapEnterToTab( TRUE )
					Column: T402
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Название
								предприятия
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.917"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								Set V402=T402
					Column: T403
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: телефон
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  0.867"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								Set V403=T403
					Column: T404
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код ЕДРПОУ
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.35"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								Set V404=T404
					Column: T405
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Сфера 
								деятельности
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								If T405.Init( hWndItem )
									! Call T405.Populate( hSql(), "to_number(K110) K110", "substr(TXT,1,100) TXT", "KL_K110", " WHERE D_CLOSE is null ORDER BY K110" )
									Call T405.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=35 ORDER BY opt_ord" )
							On SAM_AnyEdit
								Set TK405= T405.GetKey( SalListQuerySelection(hWndItem))
								Set V405=T405
							On SAM_SetFocus
								Call SalMapEnterToTab( TRUE )
					Column: T406
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Должность
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  1.383"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								Set V406=T406
					Column: T407
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Уровень
								заработной
								платы
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.8"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								Set V407=T407
					Column: T408
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Стаж работы 
								в организации
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.217"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								Set V408=T408
					Column: T409
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Стаж работы 
								в виде 
								деятельности
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.133"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								Set V409=T409
					Column: T410
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Вид контракта
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								If T410.Init( hWndItem )
									Call T410.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=10 ORDER BY opt_ord" )
							On SAM_AnyEdit
								Set TK410= T410.GetKey( SalListQuerySelection(hWndItem))
								Set V410=T410
							On SAM_SetFocus
								Call SalMapEnterToTab( TRUE )
					Column: TK401
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: TK405
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: TK410
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: TK400
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					! On SAM_Create
						                                            Call SalTblPopulate( tbl_Dox, hSql(),
								"select QUEST_ID_P,QUEST_NAME
								 into :Kod_D, :Nam_D
								 from SURVEY_QUEST
								 where SURVEY_ID =1 and  QUEST_ID_P in (83,84,85,86,87,88,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111)
								 order by QGRP_ID, QUEST_ORD",
								TBL_FillAll )
					On SAM_CountRows
						Call MessageNoWait('CountRow', 'CountRow', 0, 1)
					On SAM_TblDoDetails
						Set V401=T401
						Set VK401=TK401
						Set V402=T402
						Set V403=T403
						Set V404=T404
						Set V405=T405
						Set VK405=TK405
						Set V406=T406
						Set V407=T407
						Set V408=T408
						Set V409=T409
						Set V410=T410
						Set VK410=TK410
			Pushbutton: pb_Capital
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6537000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbInsert
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   12.15"
					Top:    0.595"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip="Додати актив"
					On SAM_Click
						Set nNewRow=SalTblInsertRow(tbl_Capital, TBL_MaxRow)
						Set tbl_Capital.T202=0
			Pushbutton: pb_History
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6535000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbInsert
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   12.25"
					Top:    0.595"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip="Додати кредитну історію"
					On SAM_Click
						Set nNewRow=SalTblInsertRow(tbl_History, TBL_MaxRow)
						Set tbl_History.T501=0
						Set tbl_History.T502=0
						Set tbl_History.T503=0
						Set tbl_History.T508=0
						! Set tbl2.multi=0
			Pushbutton: KRDN_EXEL
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbHelp
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   9.583"
					Top:    2.905"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: F10
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\EXCEL.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'Друкувати Скорінг'
					On SAM_Click
						Call F_SCOR_EXEL()
			Pushbutton: KRDN_PTI_EXEL
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbHelp
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   9.583"
					Top:    3.238"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: F10
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\EXCEL.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'Друкувати PTI'
					On SAM_Click
						Call F_SCOR_PTI_EXEL()
			Child Table: tbl_Exp
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.217"
						Top:    3.238"
						Width:  11.967"
						Width Editable? Yes
						Height: 2.167"
						Height Editable? Yes
					Visible? No
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: TK701
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код получателя
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.867"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: TK710
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код стаьи доходов
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.867"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: col750
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код статьи
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: T700
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Вид
								расхода
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.833"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
					Column: T701
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Получатель
								расхода
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.483"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								If T701.Init( hWndItem )
									Call T701.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=12 ORDER BY opt_ord" )
							On SAM_AnyEdit
								Set TK701= T701.GetKey( SalListQuerySelection(hWndItem))
							On SAM_SetFocus
								Call SalMapEnterToTab( TRUE )
					Column: T710
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Статья
								расхода
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.6"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								If T710.Init( hWndItem )
									Call T710.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=17 ORDER BY opt_ord" )
							On SAM_AnyEdit
								Set TK710= T710.GetKey( SalListQuerySelection(hWndItem))
							On SAM_SetFocus
								Call SalMapEnterToTab( TRUE )
					Column: T750
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Коментарий
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.267"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: T711
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 1 мес
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.933"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								If T711!=NUMBER_Null and T712!=NUMBER_Null and
										T713!=NUMBER_Null and T714!=NUMBER_Null and
										T715!=NUMBER_Null and T716!=NUMBER_Null
									Set T748=(T711+T712+T713+T714+T715+T716)/6
							On SAM_Validate
								If T711 <0
									Call SalMessageBox(" Сума <=0",
											"Помилка ! ", MB_IconStop)
									Set T711 = 0
									Return VALIDATE_Cancel	
								Return VALIDATE_Ok
					Column: T712
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 2 мес
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.817"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								If T711!=NUMBER_Null and T712!=NUMBER_Null and
										T713!=NUMBER_Null and T714!=NUMBER_Null and
										T715!=NUMBER_Null and T716!=NUMBER_Null
									Set T748=(T711+T712+T713+T714+T715+T716)/6
							On SAM_Validate
								If T712 <0
									Call SalMessageBox(" Сума <= 0",
											"Помилка ! ", MB_IconStop)
									Set T712 = 0
									Return VALIDATE_Cancel	
								Return VALIDATE_Ok
					Column: T713
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 3 мес
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.8"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								If T711!=NUMBER_Null and T712!=NUMBER_Null and
										T713!=NUMBER_Null and T714!=NUMBER_Null and
										T715!=NUMBER_Null and T716!=NUMBER_Null
									Set T748=(T711+T712+T713+T714+T715+T716)/6
							On SAM_Validate
								If T713 <0
									Call SalMessageBox(" Сума <= 0",
											"Помилка ! ", MB_IconStop)
									Set T713 = 0
									Return VALIDATE_Cancel	
								Return VALIDATE_Ok
					Column: T714
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 4 мес
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.8"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								If T711!=NUMBER_Null and T712!=NUMBER_Null and
										T713!=NUMBER_Null and T714!=NUMBER_Null and
										T715!=NUMBER_Null and T716!=NUMBER_Null
									Set T748=(T711+T712+T713+T714+T715+T716)/6
							On SAM_Validate
								If T714 <0
									Call SalMessageBox(" Сума <= 0",
											"Помилка ! ", MB_IconStop)
									Set T714 = 0
									Return VALIDATE_Cancel	
								Return VALIDATE_Ok
					Column: T715
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 5 мес
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.833"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								If T711!=NUMBER_Null and T712!=NUMBER_Null and
										T713!=NUMBER_Null and T714!=NUMBER_Null and
										T715!=NUMBER_Null and T716!=NUMBER_Null
									Set T748=(T711+T712+T713+T714+T715+T716)/6
							On SAM_Validate
								If T715 <0
									Call SalMessageBox(" Сума <= 0",
											"Помилка ! ", MB_IconStop)
									Set T715 = 0
									Return VALIDATE_Cancel	
								Return VALIDATE_Ok
					Column: T716
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 6 мес
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.8"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								If T711!=NUMBER_Null and T712!=NUMBER_Null and
										T713!=NUMBER_Null and T714!=NUMBER_Null and
										T715!=NUMBER_Null and T716!=NUMBER_Null
									Set T748=(T711+T712+T713+T714+T715+T716)/6
							On SAM_Validate
								If T716 <0
									Call SalMessageBox(" Сума <= 0",
											"Помилка ! ", MB_IconStop)
									Set T716 = 0
									Return VALIDATE_Cancel	
								Return VALIDATE_Ok
					Column: T748
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Среднее
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Validate
								If T748 <0
									Call SalMessageBox(" Сума <= 0",
											"Помилка ! ", MB_IconStop)
									Set T748 = 0
									Return VALIDATE_Cancel	
								Return VALIDATE_Ok
					Column: T749
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Прогноз
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Validate
								If T749 <0
									Call SalMessageBox(" Сума <= 0",
											"Помилка ! ", MB_IconStop)
									Set T749 =0
									Return VALIDATE_Cancel	
								Return VALIDATE_Ok
				Functions
				Window Variables
				Message Actions
					! On SAM_Create
						                                            Call SalTblPopulate( tbl_Dox, hSql(),
								"select QUEST_ID_P,QUEST_NAME
								 into :Kod_D, :Nam_D
								 from SURVEY_QUEST
								 where SURVEY_ID =1 and  QUEST_ID_P in (83,84,85,86,87,88,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111)
								 order by QGRP_ID, QUEST_ORD",
								TBL_FillAll )
					On SAM_RowValidate
						Call SalTblSetRowFlags( tbl_Dox, SalTblQueryContext(tbl_Dox), ROW_New,  TRUE )
					On SAM_RowSetContext
						Call SalTblSetRowFlags( tbl_Dox, SalTblQueryContext(tbl_Dox), ROW_New,  TRUE )
			Pushbutton: pb_Exp
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbInsert
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   12.25"
					Top:    3.262"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip="Додати доход"
					On SAM_Click
						Set nNewRow=SalTblInsertRow(tbl_Exp, TBL_MaxRow)
						Set tbl_Exp.T711=0
						Set tbl_Exp.T712=0
						Set tbl_Exp.T713=0
						Set tbl_Exp.T714=0
						Set tbl_Exp.T715=0
						Set tbl_Exp.T716=0
						! Set tbl2.multi=0
			! 1  Тест-Скоринг, дані
			Background Text: Дата народження
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Resource Id: 7345
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.083"
					Top:    0.679"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Midnight Blue
				Background Color: Default
			Background Text: Вік(років)
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7346
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.583"
					Top:    0.679"
					Width:  1.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Midnight Blue
				Background Color: Default
			Data Field: YAR_
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.883"
						Top:    0.655"
						Width:  1.633"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Вік позич.(років)')
			! 2 Тест-Скоринг, дані, розрахунок
			Child Table: tbl_Dox
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    0.821"
						Width:  11.933"
						Width Editable? Yes
						Height: 2.167"
						Height Editable? Yes
					Visible? No
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: TK601
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код получателя
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.867"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: TK610
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код стаьи доходов
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.867"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: T600
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Вид
								дохода
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Center
						Width:  0.883"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
					Column: T601
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Получатель
								дохода
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.167"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								If T601.Init( hWndItem )
									Call T601.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=12 ORDER BY opt_ord" )
							On SAM_AnyEdit
								Set TK601= T601.GetKey( SalListQuerySelection(hWndItem))
							On SAM_SetFocus
								Call SalMapEnterToTab( TRUE )
					Column: T610
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Статья
								дохода
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.033"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								If T610.Init( hWndItem )
									Call T610.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=16 ORDER BY opt_ord" )
							On SAM_AnyEdit
								Set TK610= T610.GetKey( SalListQuerySelection(hWndItem))
							On SAM_SetFocus
								Call SalMapEnterToTab( TRUE )
					Column: T650
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Коментарий
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.317"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: T611
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 1 мес
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.867"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								If T611!=NUMBER_Null and T612!=NUMBER_Null and
										T613!=NUMBER_Null and T614!=NUMBER_Null and
										T615!=NUMBER_Null and T616!=NUMBER_Null
									Set T648=(T611+T612+T613+T614+T615+T616)/6
							On SAM_Validate
								If T611 <0
									Call SalMessageBox(" Сума <= 0",
											"Помилка ! ", MB_IconStop)
									Set T611 = 0
									Return VALIDATE_Cancel	
								Return VALIDATE_Ok
					Column: T612
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 2 мес
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.85"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								If T611!=NUMBER_Null and T612!=NUMBER_Null and
										T613!=NUMBER_Null and T614!=NUMBER_Null and
										T615!=NUMBER_Null and T616!=NUMBER_Null
									Set T648=(T611+T612+T613+T614+T615+T616)/6
							On SAM_Validate
								If T612 <0
									Call SalMessageBox(" Сума <= 0",
											"Помилка ! ", MB_IconStop)
									Set T612 = 0
									Return VALIDATE_Cancel	
								Return VALIDATE_Ok
					Column: T613
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 3 мес
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.767"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								If T611!=NUMBER_Null and T612!=NUMBER_Null and
										T613!=NUMBER_Null and T614!=NUMBER_Null and
										T615!=NUMBER_Null and T616!=NUMBER_Null
									Set T648=(T611+T612+T613+T614+T615+T616)/6
							On SAM_Validate
								If T613 <0
									Call SalMessageBox(" Сума <= 0",
											"Помилка ! ", MB_IconStop)
									Set T613 = 0
									Return VALIDATE_Cancel	
								Return VALIDATE_Ok
					Column: T614
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 4 мес
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.8"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								If T611!=NUMBER_Null and T612!=NUMBER_Null and
										T613!=NUMBER_Null and T614!=NUMBER_Null and
										T615!=NUMBER_Null and T616!=NUMBER_Null
									Set T648=(T611+T612+T613+T614+T615+T616)/6
							On SAM_Validate
								If T614 <0
									Call SalMessageBox(" Сума <= 0",
											"Помилка ! ", MB_IconStop)
									Set T614 = 0
									Return VALIDATE_Cancel	
								Return VALIDATE_Ok
					Column: T615
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 5 мес
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.8"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								If T611!=NUMBER_Null and T612!=NUMBER_Null and
										T613!=NUMBER_Null and T614!=NUMBER_Null and
										T615!=NUMBER_Null and T616!=NUMBER_Null
									Set T648=(T611+T612+T613+T614+T615+T616)/6
							On SAM_Validate
								If T615 <=0
									Call SalMessageBox(" Сума < 0",
											"Помилка ! ", MB_IconStop)
									Set T615 = 0
									Return VALIDATE_Cancel	
								Return VALIDATE_Ok
					Column: T616
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: 6 мес
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.733"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								If T611!=NUMBER_Null and T612!=NUMBER_Null and
										T613!=NUMBER_Null and T614!=NUMBER_Null and
										T615!=NUMBER_Null and T616!=NUMBER_Null
									Set T648=(T611+T612+T613+T614+T615+T616)/6
							On SAM_Validate
								If T616 <0
									Call SalMessageBox(" Сума <= 0",
											"Помилка ! ", MB_IconStop)
									Set T616 = 0
									Return VALIDATE_Cancel	
								Return VALIDATE_Ok
					Column: T648
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Среднее
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.817"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Validate
								If T648 <0
									Call SalMessageBox(" Сума <= 0",
											"Помилка ! ", MB_IconStop)
									Set T648 = 0
									Return VALIDATE_Cancel	
								Return VALIDATE_Ok
					Column: T649
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Прогноз
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.833"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Validate
								If T649 <0
									Call SalMessageBox(" Сума <= 0",
											"Помилка ! ", MB_IconStop)
									Set T649 = 0
									Return VALIDATE_Cancel	
								Return VALIDATE_Ok
				Functions
				Window Variables
				Message Actions
					! On SAM_Create
						                                            Call SalTblPopulate( tbl_Dox, hSql(),
								"select QUEST_ID_P,QUEST_NAME
								 into :Kod_D, :Nam_D
								 from SURVEY_QUEST
								 where SURVEY_ID =1 and  QUEST_ID_P in (83,84,85,86,87,88,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111)
								 order by QGRP_ID, QUEST_ORD",
								TBL_FillAll )
					On SAM_RowValidate
						Call SalTblSetRowFlags( tbl_Dox, SalTblQueryContext(tbl_Dox), ROW_New,  TRUE )
					On SAM_RowSetContext
						Call SalTblSetRowFlags( tbl_Dox, SalTblQueryContext(tbl_Dox), ROW_New,  TRUE )
			Background Text: Розрахунок скорінга:
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7347
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.483"
					Top:    2.929"
					Width:  1.9"
					Width Editable? Yes
					Height: 0.226"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Red
				Background Color: Default
			Data Field: PTI_MAX
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.683"
						Top:    3.238"
						Width:  1.633"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Center
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Максимально допустимое число PTI')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					! On SAM_Validate
						                                                                                                           If DOX_ <=0
							                                                                                                           Call SalMessageBox(" Чистий дохід <= 0",
									"Помилка ! ", MB_IconStop)
							                                                                                                           Set DOX_ = NUMBER_Null
						                                                                                                           Return VALIDATE_Ok
			Data Field: PTI
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.383"
						Top:    3.238"
						Width:  1.633"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Center
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Sky
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'PTI')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					! On SAM_Validate
						                                                                                                           If DOX_ <=0
							                                                                                                           Call SalMessageBox(" Чистий дохід <= 0",
									"Помилка ! ", MB_IconStop)
							                                                                                                           Set DOX_ = NUMBER_Null
						                                                                                                           Return VALIDATE_Ok
			Data Field: KRDN
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.383"
						Top:    2.905"
						Width:  1.633"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Center
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Sky
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Порогова Кредитоспроможність')
			Pushbutton: pb_F10
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbHelp
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   9.083"
					Top:    2.905"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: F10
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\EXECUTE.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'F10. Виконати розрахунок Кредитоспроможності'
					On SAM_Click
						If SurveySessionID>0
							Call SalWaitCursor ( TRUE )
							If SqlPrepareAndExecute(  hSql(), "SELECT substr(seb_sur.reguired_fields (:SurveySessionID,1),1,4000) into :ml_error from dual" ) 
									   and SqlFetchNext(hSql(), nFetchRes)
								If ml_error=STRING_Null
									If F_SCOR(SurveySessionID)=TRUE
										! Call MessageNoWait('Сохранена анкета, реф='|| Str(SurveySessionID),'Сообщение',3,0)
								Else
									Call MessageNoWait('Не заповнені усі обовьязкові поля для збереження','Повідомлення',3,0)
							Else
								Call MessageNoWait('Перевірка заповнення даних не вдалася для анкети №'|| Str(SurveySessionID),'Повідомлення',3,0)
							Call SalWaitCursor ( FALSE )
			! 3 Додаткова ідент.позичальника
			! 4 Додаткова інф.по кредиту
			Pushbutton: pb_KD
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbHelp
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   10.317"
					Top:    0.536"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: F10
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\SAVE_M.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'Ввести КД'
					On SAM_Click
						If F_SAVE_KD()
							Call SalEnableWindow( pb_PR_1 )
							Call SalEnableWindow( pb_PR_2 )
						Else
							Call SalDisableWindow( pb_PR_1 )
							Call SalDisableWindow( pb_PR_2 )
			Pushbutton: pb_PR_1
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbHelp
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   10.817"
					Top:    0.536"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: F10
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\WORD.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'Друкувати КД'
					On SAM_Click
						! Call F_RUN()
			Pushbutton: pb_PR_2
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbHelp
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   11.317"
					Top:    0.536"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: F10
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\BACK.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'Друкувати ГПК'
					On SAM_Click
						! Call F_RUN()
			! 5 Додаткова анкета
			Pushbutton: pb_Ank
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbInsert
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   11.35"
					Top:    1.012"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\CUSTCLSD.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call F_WEB ()
					On SAM_Create
						Set strTip = 'Додаткові дані анкети (WEB)'
			!
			Background Text: Место рождения
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7348
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.283"
					Top:    0.929"
					Width:  1.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Паспортные данные
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7349
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.283"
					Top:    1.179"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Адресс Регистрации
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7350
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    1.429"
					Width:  2.7"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Background Text: Факт. место прожививания
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7351
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.083"
					Top:    1.429"
					Width:  4.9"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Background Text: Жилье
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7352
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.483"
					Top:    2.095"
					Width:  0.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Образование
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7353
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.383"
					Top:    2.095"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: T15
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.383"
						Top:    0.405"
						Width:  2.533"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(15))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_Validate
						Return F_BDAT()
			Data Field: T1
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.883"
						Top:    0.405"
						Width:  6.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(1))
			Data Field: T4
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.383"
						Top:    0.655"
						Width:  2.533"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(4))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_Validate
						Return F_BDAT()
			Data Field: T5
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.983"
						Top:    0.905"
						Width:  6.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(5))
			Line
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7354
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Coordinates
					Begin X:  0.383"
					Begin Y:  3.405"
					End X:  12.383"
					End Y:  3.405"
				Visible? Yes
				Line Style: Etched
				Line Thickness: 3
				Line Color: Default
			Data Field: T10
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 2
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.083"
						Top:    1.155"
						Width:  0.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(10))
			Data Field: T11
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 6
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.783"
						Top:    1.155"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(11))
			Data Field: T12
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.483"
						Top:    1.155"
						Width:  5.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(12))
			Data Field: T13
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   10.283"
						Top:    1.155"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(13))
			Data Field: T20
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    1.571"
						Width:  3.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(20))
			Data Field: T21
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.283"
						Top:    1.821"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(21))
			Combo Box: T22
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   3.983"
					Top:    1.571"
					Width:  1.9"
					Width Editable? Class Default
					Height: 0.726"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call T22.Init(hWndItem)
						Call T22.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=9 ORDER BY opt_ord" )
						! Set TK22 = 199
						! Call cmb_IST.SetSelectById (nIST)
					On SAM_AnyEdit
						If T22=STRING_Null
							Set TK22=NUMBER_Null
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(22))
					On SAM_Click
						Set TK22= T22.GetKey( SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: T23
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   5.983"
						Top:    1.571"
						Width:  6.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(23))
			Data Field: T24
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.983"
						Top:    1.821"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(24))
			Data Field: T25
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   5.983"
						Top:    1.821"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(25))
			Data Field: T26
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.983"
						Top:    1.821"
						Width:  3.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(26))
			Combo Box: T27
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.183"
					Top:    2.238"
					Width:  3.6"
					Width Editable? Class Default
					Height: 1.19"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call T27.Init(hWndItem)
						Call T27.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=1 ORDER BY opt_ord" )
						! Set TK27 = 199
						! Call cmb_IST.SetSelectById (nIST)
					On SAM_AnyEdit
						If T27=STRING_Null
							Set TK27=NUMBER_Null
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(27))
					On SAM_Click
						Set TK27= T27.GetKey( SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Combo Box: T28
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   3.983"
					Top:    2.238"
					Width:  3.8"
					Width Editable? Class Default
					Height: 1.19"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call T28.Init(hWndItem)
						Call T28.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=2 ORDER BY opt_ord" )
						! Set TK27 = 199
						! Call cmb_IST.SetSelectById (nIST)
					On SAM_AnyEdit
						If T28=STRING_Null
							Set TK28=NUMBER_Null
					On SAM_Click
						Set TK28= T28.GetKey( SalListQuerySelection(hWndItem))
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(28))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Combo Box: T29
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   7.983"
					Top:    2.238"
					Width:  4.0"
					Width Editable? Class Default
					Height: 1.345"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call T29.Init(hWndItem)
						Call T29.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=3 ORDER BY opt_ord" )
						! Set TK27 = 199
						! Call cmb_IST.SetSelectById (nIST)
					On SAM_AnyEdit
						If T29=STRING_Null
							Set TK29=NUMBER_Null
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(29))
					On SAM_Click
						Set TK29= T29.GetKey( SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Child Table: tbl2
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.383"
						Top:    2.488"
						Width:  11.7"
						Width Editable? Yes
						Height: 0.833"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: TK30
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: T30
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Лицо на иждевении
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.85"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								If T30.Init( hWndItem )
									Call T30.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=8 ORDER BY opt_ord" )
									! Call T30.SetSelectById(TK30)
							On SAM_AnyEdit
								Set TK30= T30.GetKey( SalListQuerySelection(hWndItem))
							! On SAM_Click
								! Call SalSendClassMessage(SAM_Click, 0, 0)
								                                             Set TK30=T30.nCurrentId
								! Call MessageNoWait(Str(T30.nCurrentId), 'Open Session', 0, 1)
								! Call MessageNoWait(Str(TK30), 'Open Session', 0, 1)
							On SAM_SetFocus
								Call SalMapEnterToTab( TRUE )
							! On SAM_KillFocus
								! Set TK30= T30.GetKey( SalListQuerySelection(hWndItem))
								                                             Set TK30=T30.nCurrentId
					Column: T31
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: ФИО
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  7.5"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: T32
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата рождения
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  1.433"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
			Background Text: Семейное состояние
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7355
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   7.983"
					Top:    2.095"
					Width:  3.3"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Дата народження
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Resource Id: 7356
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.05"
					Top:    3.702"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Midnight Blue
				Background Color: Default
			Background Text: Вік(років)
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7357
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.55"
					Top:    3.702"
					Width:  1.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Midnight Blue
				Background Color: Default
			Background Text: Место рождения
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7358
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    3.952"
					Width:  1.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Паспортные данные
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7359
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    4.202"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Адресс Регистрации
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7360
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   1.15"
					Top:    4.452"
					Width:  1.9"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Фактич. место прожив.
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7361
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.75"
					Top:    4.452"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Жилье
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7362
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.75"
					Top:    5.119"
					Width:  0.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Образование
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7363
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.55"
					Top:    5.119"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Семейное состояние
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7364
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.45"
					Top:    5.119"
					Width:  3.3"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Место работы
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7365
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.383"
					Top:    3.179"
					Width:  1.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Название предприятия
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7366
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.383"
					Top:    3.179"
					Width:  4.9"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: телефон
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7367
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.583"
					Top:    3.179"
					Width:  0.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: T65
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.35"
						Top:    3.429"
						Width:  2.533"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(65))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_Validate
						Return F_BDAT_POR()
			Data Field: T54
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.35"
						Top:    3.679"
						Width:  2.533"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(54))
					On SAM_Validate
						Return F_BDAT()
			Data Field: T51
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.85"
						Top:    3.429"
						Width:  6.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(51))
			Data Field: YAR1_
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.85"
						Top:    3.679"
						Width:  1.633"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Вік позич.(років)')
			Data Field: T55
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.95"
						Top:    3.929"
						Width:  6.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(55))
			Data Field: T60
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 2
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.05"
						Top:    4.179"
						Width:  0.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(60))
			Data Field: T61
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 6
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.75"
						Top:    4.179"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(61))
			Data Field: T62
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.45"
						Top:    4.179"
						Width:  5.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(62))
			Data Field: T63
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   10.25"
						Top:    4.179"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(63))
			Data Field: T70
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.25"
						Top:    4.595"
						Width:  3.933"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(70))
			Data Field: T71
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.25"
						Top:    4.845"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(71))
			Data Field: T73
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.45"
						Top:    4.595"
						Width:  5.433"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(73))
			Data Field: T74
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.45"
						Top:    4.845"
						Width:  1.833"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(74))
			Data Field: df54
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   0.683"
						Top:    1.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: df55
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   0.783"
						Top:    1.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: df69
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   9.383"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Combo Box: T72
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   4.45"
					Top:    4.595"
					Width:  1.833"
					Width Editable? Class Default
					Height: 1.345"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call T72.Init(hWndItem)
						Call T72.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=9 ORDER BY opt_ord" )
						! Set TK72 = 199
						! Call cmb_IST.SetSelectById (nIST)
					On SAM_AnyEdit
						If T72=STRING_Null
							Set TK72=NUMBER_Null
					On SAM_Click
						Set TK72= T72.GetKey( SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(72))
			Combo Box: T77
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.4"
					Top:    5.25"
					Width:  3.583"
					Width Editable? Class Default
					Height: 1.19"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call T77.Init(hWndItem)
						Call T77.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=1 ORDER BY opt_ord" )
						! Set TK27 = 199
						! Call cmb_IST.SetSelectById (nIST)
					On SAM_AnyEdit
						If T77=STRING_Null
							Set TK77=NUMBER_Null
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(77))
					On SAM_Click
						Set TK77= T77.GetKey( SalListQuerySelection(hWndItem))
						If T77 =STRING_Null
							Set TK77=NUMBER_Null
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Combo Box: T78
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   4.25"
					Top:    5.262"
					Width:  4.033"
					Width Editable? Class Default
					Height: 1.345"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call T78.Init(hWndItem)
						Call T78.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=2 ORDER BY opt_ord" )
						! Set TK27 = 199
						! Call cmb_IST.SetSelectById (nIST)
					On SAM_AnyEdit
						If T78=STRING_Null
							Set TK78=NUMBER_Null
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(78))
					On SAM_Click
						Set TK78= T78.GetKey( SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Combo Box: T79
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   8.483"
					Top:    5.262"
					Width:  3.6"
					Width Editable? Class Default
					Height: 1.345"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call T79.Init(hWndItem)
						Call T79.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=3 ORDER BY opt_ord" )
						! Set TK27 = 199
						! Call cmb_IST.SetSelectById (nIST)
					On SAM_AnyEdit
						If T79=STRING_Null
							Set TK79=NUMBER_Null
					On SAM_Click
						Set TK79= T79.GetKey( SalListQuerySelection(hWndItem))
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(79))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: RNK_KL
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.783"
						Top:    0.405"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Код ЕДРПОУ
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7368
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   10.383"
					Top:    3.179"
					Width:  1.4"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Сфера деятельности
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7369
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.383"
					Top:    3.595"
					Width:  2.1"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Должность
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7370
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.583"
					Top:    3.679"
					Width:  1.1"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Телефоны
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7371
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.683"
					Top:    1.845"
					Width:  1.1"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Pushbutton: pb12
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbInsert
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   12.183"
					Top:    2.488"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip="Додати питання"
					On SAM_Click
						Set nNewRow=SalTblInsertRow(tbl2, TBL_MaxRow)
						! Set tbl2.multi=0
			Combo Box: V401
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.383"
					Top:    3.321"
					Width:  1.8"
					Width Editable? Class Default
					Height: 0.571"
					Height Editable? Class Default
				Visible? No
				Editable? No
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: 3D Face Color
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call V401.Init(hWndItem)
						Call V401.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=6 ORDER BY opt_ord" )
						! Set TK72 = 199
						! Call cmb_IST.SetSelectById (nIST)
					On SAM_AnyEdit
						Set VK401= V401.GetKey( SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(401))
			Data Field: V402
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.283"
						Top:    3.321"
						Width:  5.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(402))
			Data Field: V403
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.283"
						Top:    3.321"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(403))
			Data Field: V404
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.383"
						Top:    3.321"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(404))
			Data Field: V406
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.883"
						Top:    3.655"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(406))
			Line
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7372
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Coordinates
					Begin X:  3.883"
					Begin Y:  1.405"
					End X:  3.883"
					End Y:  2.071"
				Visible? Yes
				Line Style: Solid
				Line Thickness: 1
				Line Color: Default
			Line
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7373
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Coordinates
					Begin X:  4.35"
					Begin Y:  4.512"
					End X:  4.35"
					End Y:  5.179"
				Visible? Yes
				Line Style: Solid
				Line Thickness: 1
				Line Color: Default
			Data Field: T75
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.483"
						Top:    4.821"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(75))
			Data Field: T76
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65310000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   8.883"
						Top:    4.821"
						Width:  3.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(76))
			Combo Box: V405
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.383"
					Top:    3.738"
					Width:  4.1"
					Width Editable? Class Default
					Height: 0.726"
					Height Editable? Class Default
				Visible? No
				Editable? No
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: 3D Face Color
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call V405.Init(hWndItem)
						! Call V405.Populate( hSql(), "K110", "TXT", "KL_K110", " ORDER BY K110" )
						Call V405.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=35 ORDER BY opt_ord" )
						! Set TK405 = 199
						! Call cmb_IST.SetSelectById (nIST)
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(405))
					On SAM_AnyEdit
						Set VK405= V405.GetKey( SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: V407
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.883"
						Top:    3.988"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(407))
			Background Text: Уровень зар. платы
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7374
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.883"
					Top:    4.012"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: V408
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.983"
						Top:    3.738"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(408))
			Data Field: V409
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.983"
						Top:    3.988"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(409))
			Background Text: в организации
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7375
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   9.483"
					Top:    3.762"
					Width:  1.4"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: в виде деятельн.
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7376
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   9.283"
					Top:    4.012"
					Width:  1.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Group Box: Стаж работы (мес)
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7377
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   9.083"
					Top:    3.571"
					Width:  3.1"
					Width Editable? Yes
					Height: 0.667"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Group Box: Работа
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7378
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.283"
					Top:    2.988"
					Width:  12.2"
					Width Editable? Yes
					Height: 1.333"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: V410
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   2.083"
					Top:    3.988"
					Width:  2.4"
					Width Editable? Class Default
					Height: 0.881"
					Height Editable? Class Default
				Visible? No
				Editable? No
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: 3D Face Color
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call V410.Init(hWndItem)
						Call V410.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=10 ORDER BY opt_ord" )
						! Set TK72 = 199
						! Call cmb_IST.SetSelectById (nIST)
					On SAM_AnyEdit
						Set VK410= V410.GetKey( SalListQuerySelection(hWndItem))
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(410))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Вид контракта
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7379
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.383"
					Top:    4.012"
					Width:  1.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Pushbutton: pb_Dox
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbInsert
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   12.283"
					Top:    0.821"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip="Додати доход"
					On SAM_Click
						Set nNewRow=SalTblInsertRow(tbl_Dox, TBL_MaxRow)
						Set tbl_Dox.T611=0
						Set tbl_Dox.T612=0
						Set tbl_Dox.T613=0
						Set tbl_Dox.T614=0
						Set tbl_Dox.T615=0
						Set tbl_Dox.T616=0
						! Set tbl2.multi=0
			Background Text: Сумма кредита
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7380
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   1.117"
					Top:    0.976"
					Width:  2.167"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Инициатива
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7381
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.583"
					Top:    2.643"
					Width:  1.433"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: INIC
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   2.117"
					Top:    2.619"
					Width:  2.767"
					Width Editable? Yes
					Height: 3.821"
					Height Editable? Yes
				Visible? No
				Editable? Yes
				String Type: String
				Maximum Data Length: Default
				Sorted? Yes
				Always Show List? No
				Vertical Scroll? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Input Mask: Unformatted
				List Initialization
				Message Actions
					On SAM_Create
						If SqlPrepareAndExecute(  hSqlAux(),
								"SELECT name from CC_INIC union all SELECT tobo||' '||name from V_TOBO_OPEN
								 ORDER BY 1 INTO :sTmpM " )
							While SqlFetchNext(  hSqlAux(), nFetchRes )
								Call SalListAdd( INIC, sTmpM )
			Background Text: № Анкеты
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7382
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   1.517"
					Top:    0.56"
					Width:  1.5"
					Width Editable? Yes
					Height: 0.177"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: CC_ID
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.583"
						Top:    0.738"
						Width:  1.517"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '№ договора' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Валюта
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7383
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.333"
					Top:    0.56"
					Width:  1.014"
					Width Editable? Yes
					Height: 0.177"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: cmbKV
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   3.283"
					Top:    0.738"
					Width:  2.583"
					Width Editable? Class Default
					Height: 2.738"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbKV.Init(hWndItem)
						Call cmbKV.Populate(hSql(), "KV", "LCV || ' ' || NAME", "TABVAL", " ORDER BY skv")
					On SAM_AnyEdit
						If cmbKV=STRING_Null
							Set nKV=NUMBER_Null
					On SAM_Click
						Set nKV = cmbKV.GetKey( SalListQuerySelection(hWndItem))
						If SqlPrepareAndExecute( hSql(),
								  "SELECT y.Basey, y.name
								   INTO :nBasey,:cmbBasey
								   FROM tabval t, Basey y
								   WHERE t.Basey=y.Basey and t.kv=:nKV  " )
								and SqlFetchNext(hSql(), nFetchRes)
						! Set nBasey = cmbBasey.GetKey( SalListQuerySelection(hWndItem))
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Валюта договора' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: nS
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.283"
						Top:    0.988"
						Width:  2.583"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сумма договора' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: T130
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65380000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.283"
						Top:    1.238"
						Width:  2.583"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Даты:
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7384
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.317"
					Top:    1.643"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Background Text: Заключения
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7385
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.217"
					Top:    1.976"
					Width:  1.517"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: DAT1
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.817"
						Top:    1.869"
						Width:  1.517"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						Set DAT1 = CorrectDate(GetBaseVal(), DAT1, DAT1 +1)
						Return VALIDATE_Ok
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата Заключения' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Начала
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7386
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.417"
					Top:    1.976"
					Width:  1.017"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: DAT2
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.417"
						Top:    1.869"
						Width:  1.517"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						Set DAT2 = CorrectDate(GetBaseVal(), DAT2, DAT2 +1)
						Return VALIDATE_Ok
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата Начала' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Выдачи
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7387
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.217"
					Top:    2.226"
					Width:  1.5"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Blue
				Background Color: Default
			Data Field: DAT3
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.817"
						Top:    2.119"
						Width:  1.517"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If DAT3 < DAT2 or (DAT3 > DAT4 and DAT4 != DATETIME_Null)
							Return VALIDATE_Cancel
						Set DAT3 = CorrectDate(GetBaseVal(), DAT3, DAT3 +1)
						Return VALIDATE_Ok
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата Выдачи' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Заверш
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7388
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.417"
					Top:    2.226"
					Width:  1.017"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Red
				Background Color: Default
			Data Field: DAT4
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.417"
						Top:    2.119"
						Width:  1.517"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If DAT4 <= DAT2
							Return VALIDATE_Cancel
						Set DAT4 = CorrectDate(GetBaseVal(), DAT4, DAT4 +1)
						Return VALIDATE_Ok
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата Завершения' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Погашение
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7389
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.317"
					Top:    3.976"
					Width:  1.717"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: cmbFREQ
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   2.117"
					Top:    3.952"
					Width:  2.767"
					Width Editable? Class Default
					Height: 1.5"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbFREQ.Init(hWndItem)
						Call cmbFREQ.Populate(hSql(), "FREQ", "NAME",
								     "FREQ", " ORDER BY FREQ desc ")
					On SAM_AnyEdit
						If cmbFREQ=STRING_Null
							Set nFREQ=NUMBER_Null
					On SAM_Click
						Set nFREQ = cmbFREQ.GetKey(SalListQuerySelection(hWndItem))
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Погашение' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Вид
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7390
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.317"
					Top:    2.976"
					Width:  1.717"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: cmbVID
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   2.117"
					Top:    2.952"
					Width:  2.767"
					Width Editable? Class Default
					Height: 2.429"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbVID.Init(hWndItem)
						Call cmbVID.Populate(hSql(), "VIDD", "NAME",     "CC_VIDD",
								 " WHERE vidd in (1,2,3,11,12,13 ) and tipd=1 and
								     custtype =3
								     ORDER BY vidd")
					On SAM_AnyEdit
						If cmbVID=STRING_Null
							Set nVID=NUMBER_Null
					On SAM_Click
						Set nVID = cmbVID.GetKey(
								    SalListQuerySelection(hWndItem))
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Вид договора' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Источник
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7391
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.317"
					Top:    3.226"
					Width:  1.717"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: cmbSOUR
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   2.117"
					Top:    3.202"
					Width:  2.767"
					Width Editable? Class Default
					Height: 2.274"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbSOUR.Init(hWndItem)
						Call cmbSOUR.Populate(hSql(), "SOUR", "NAME",
								     "CC_SOURCE", "ORDER BY name desc")
					On SAM_AnyEdit
						If cmbSOUR=STRING_Null
							Set nISTO =NUMBER_Null
					On SAM_Click
						Set nISTO = cmbSOUR.GetKey(
								    SalListQuerySelection(hWndItem))
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Источник' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Цель
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7392
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.317"
					Top:    3.476"
					Width:  1.717"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: cmbAIM
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   2.117"
					Top:    3.452"
					Width:  2.767"
					Width Editable? Class Default
					Height: 1.964"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbAIM.Init(hWndItem)
						Call cmbAIM.Populate(hSql(), "AIM", "NAME", "CC_AIM", "ORDER BY aim")
					On SAM_AnyEdit
						If cmbAIM=STRING_Null
							Set nCEL =NUMBER_Null
					On SAM_Click
						Set nCEL = cmbAIM.GetKey( SalListQuerySelection(hWndItem))
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Цель' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Отрасль
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7393
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.317"
					Top:    3.726"
					Width:  1.717"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: MS_NX
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   2.117"
					Top:    3.702"
					Width:  2.767"
					Width Editable? Yes
					Height: 1.655"
					Height Editable? Yes
				Visible? No
				Editable? Yes
				String Type: String
				Maximum Data Length: Default
				Sorted? Yes
				Always Show List? No
				Vertical Scroll? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Input Mask: Unformatted
				List Initialization
				Message Actions
					On SAM_Create
						If SqlPrepareAndExecute(  hSqlAux(), "SELECT name from MS_NX_K ORDER BY id INTO :sTmpM " )
							While SqlFetchNext(  hSqlAux(), nFetchRes )
								Call SalListAdd( MS_NX, sTmpM )
			Background Text: МФО и Счет для перечисления
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7394
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.483"
					Top:    4.667"
					Width:  5.117"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: nBANK
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.367"
						Top:    4.893"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						Set dNB = GetValueStr("
								    SELECT nb
								    FROM banks
								    WHERE mfo=" || Str(nBANK))
						Set NLS=''
						Return VALIDATE_Ok
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'МФО' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: dNB
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.167"
						Top:    4.893"
						Width:  3.067"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: NLS
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.767"
						Top:    4.893"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If NLS != STRING_Null
							If Vkrz2(Str(nBANK),NLS) != NLS
								Return VALIDATE_Cancel
							If nBANK = Val(GetBankMfo())
								If SqlPrepareAndExecute( hSql(),
										  "SELECT nms INTO :NMS FROM accounts
										   WHERE kv=:nKV and nls=:NLS and dazs is null " )
										and not SqlFetchNext( hSql(), nFetchRes)
									Set NMS='Не открыт !'
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Счет для перечисления' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: NMS
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.233"
						Top:    4.893"
						Width:  4.817"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Group Box: Проценты и комиссия
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7395
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.317"
					Top:    0.536"
					Width:  6.15"
					Width Editable? Yes
					Height: 2.119"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfPROC
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.317"
						Top:    0.702"
						Width:  1.15"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: База
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7396
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.517"
					Top:    0.726"
					Width:  0.8"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Combo Box: cmbBasey
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   9.417"
					Top:    0.702"
					Width:  2.767"
					Width Editable? Class Default
					Height: 1.036"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbBasey.Init(hWndItem)
						Call cmbBasey.Populate(hSql(), "BASEY", "NAME", "BASEY", " ORDER BY BASEY ")
					On SAM_AnyEdit
						If cmbBasey=STRING_Null
							Set nBasey =NUMBER_Null
					On SAM_Click
						Set nBasey = cmbBasey.GetKey( SalListQuerySelection(hWndItem))
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Процентная база' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: dfKV1
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 3
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.517"
						Top:    0.952"
						Width:  0.717"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Валюта КД' )
			Data Field: dfPROC1
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.317"
						Top:    0.952"
						Width:  1.15"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% ст' )
			Data Field: dfKV2
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 3
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.517"
						Top:    1.202"
						Width:  0.717"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Валюта КД' )
			Data Field: dfPROC2
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.317"
						Top:    1.202"
						Width:  1.15"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% ст' )
			Data Field: dfKV3
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 3
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.517"
						Top:    1.452"
						Width:  0.717"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Валюта КД' )
			Data Field: dfPROC3
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.317"
						Top:    1.452"
						Width:  1.15"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% ст' )
			Data Field: dfKV4
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 3
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.517"
						Top:    1.702"
						Width:  0.717"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Валюта КД' )
			Data Field: dfPROC4
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.317"
						Top:    1.702"
						Width:  1.15"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% ст' )
			Frame
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7397
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.617"
					Top:    1.036"
					Width:  3.7"
					Width Editable? Yes
					Height: 0.952"
					Height Editable? Yes
				Visible? No
				Corners: Square
				Border Style: Raised-Shadow
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Background Text: Погашение
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7398
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.717"
					Top:    1.226"
					Width:  1.333"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: День
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7399
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   10.217"
					Top:    1.226"
					Width:  0.7"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfDen
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 2
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   10.217"
						Top:    1.452"
						Width:  0.533"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If dfDen <1 or dfDen>31
							Set dfDen = 20
							Return VALIDATE_Cancel
			Background Text: Начало
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7400
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   10.917"
					Top:    1.226"
					Width:  1.217"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: DATNP
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   10.817"
						Top:    1.452"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If DATNP < DAT3
							Call Debug ('Ош.дата')
						Set DATNP = CorrectDate(GetBaseVal(), DATNP, DATNP +1)
						Return VALIDATE_Ok
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата Начала погашения %%' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Combo Box: cmbFREQP
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   9.417"
					Top:    1.702"
					Width:  2.767"
					Width Editable? Class Default
					Height: 1.81"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbFREQP.Init(hWndItem)
						Call cmbFREQP.Populate(hSql(), "FREQ", "NAME",  "FREQ", " ORDER BY FREQ desc ")
					On SAM_AnyEdit
						If cmbFREQP=STRING_Null
							Set nFREQP =NUMBER_Null
					On SAM_Click
						Set nFREQP = cmbFREQP.GetKey(SalListQuerySelection(hWndItem))
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Периодичность Погашения %%' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: % комиссии
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 7401
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.417"
					Top:    2.06"
					Width:  1.3"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: None
				Text Color: Default
				Background Color: Default
			Data Field: dfKOM
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.717"
						Top:    2.036"
						Width:  0.75"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Месячная % ст комиссии по договору' )
			Combo Box: cmbKom
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6538000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   8.717"
					Top:    2.036"
					Width:  3.6"
					Width Editable? Class Default
					Height: 0.726"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Метод начисления комиссии' )
					On SAM_Create
						Call cmbKom.Init(hWndItem)
						Call cmbKom.Populate(hSql(), "METR", "NAME", "INT_METR", " WHERE METR >=90 ORDER BY METR ")
					On SAM_AnyEdit
						If cmbKom=STRING_Null
							Set nKOM =NUMBER_Null
					On SAM_Click
						Set nKOM = cmbKom.GetKey( SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Child Table: tbl_History
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6535000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.25"
						Top:    0.595"
						Width:  11.933"
						Width Editable? Yes
						Height: 2.81"
						Height Editable? Yes
					Visible? No
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: TK510
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Type kred
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: T510
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Тип
								Кредитора
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.1"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								If T510.Init( hWndItem )
									Call T510.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=15 ORDER BY opt_ord" )
							On SAM_AnyEdit
								Set TK510= T510.GetKey( SalListQuerySelection(hWndItem))
							On SAM_SetFocus
								Call SalMapEnterToTab( TRUE )
					Column: T500
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Кредитор
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: T501
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма
								по договору
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: T502
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Ежемесячный
								платеж
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: T503
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Остаток 
								долга
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.067"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: T504
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата 
								выдачи 
								кредита
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: T505
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата гаш. 
								кредита за 
								договором
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: T506
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Факт. дата 
								гаш. кредита 
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: T509
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата гаш.
								просрочки
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: TK507
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: T507
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Вид
								Просрочки
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.05"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								If T507.Init( hWndItem )
									Call T507.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=25 ORDER BY opt_ord" )
									! Call T30.SetSelectById(TK30)
							On SAM_AnyEdit
								Set TK507= T507.GetKey( SalListQuerySelection(hWndItem))
							! On SAM_Click
								! Call SalSendClassMessage(SAM_Click, 0, 0)
								                                             Set TK30=T30.nCurrentId
								! Call MessageNoWait(Str(T30.nCurrentId), 'Open Session', 0, 1)
								! Call MessageNoWait(Str(TK30), 'Open Session', 0, 1)
							On SAM_SetFocus
								Call SalMapEnterToTab( TRUE )
							! On SAM_KillFocus
								! Set TK30= T30.GetKey( SalListQuerySelection(hWndItem))
								                                             Set TK30=T30.nCurrentId
					Column: T508
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Кол-во
								дней
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
			Child Table: tbl_Capital
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6537000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.317"
						Top:    0.512"
						Width:  11.767"
						Width Editable? Yes
						Height: 2.56"
						Height Editable? Yes
					Visible? No
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? Yes
					Lines Per Row: 2
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: TK201
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код получателя
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.867"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: T200
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Группа
								SEB
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Center
						Width:  0.883"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
					Column: T201
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Статья
								активов
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.933"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								If T201.Init( hWndItem )
									Call T201.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=14 ORDER BY opt_ord" )
							On SAM_AnyEdit
								Set TK201= T201.GetKey( SalListQuerySelection(hWndItem))
							On SAM_SetFocus
								Call SalMapEnterToTab( TRUE )
					Column: T202
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.567"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: T210
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Коментарий *
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Long String
						Justify: Left
						Width:  5.283"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? Yes
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					! On SAM_Create
						                                            Call SalTblPopulate( tbl_Dox, hSql(),
								"select QUEST_ID_P,QUEST_NAME
								 into :Kod_D, :Nam_D
								 from SURVEY_QUEST
								 where SURVEY_ID =1 and  QUEST_ID_P in (83,84,85,86,87,88,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111)
								 order by QGRP_ID, QUEST_ORD",
								TBL_FillAll )
			Child Table: tbl_Mismatch
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.417"
						Top:    0.595"
						Width:  9.567"
						Width Editable? Yes
						Height: 2.0"
						Height Editable? Yes
					Visible? No
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: 3D Face Color
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: T808
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Текст несоответствия
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  6.55"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: T809
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  2.167"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: TK601
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код получателя
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.867"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: TK610
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код стаьи доходов
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.867"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: col11
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код статьи
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					! On SAM_Create
						                                            Call SalTblPopulate( tbl_Dox, hSql(),
								"select QUEST_ID_P,QUEST_NAME
								 into :Kod_D, :Nam_D
								 from SURVEY_QUEST
								 where SURVEY_ID =1 and  QUEST_ID_P in (83,84,85,86,87,88,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111)
								 order by QGRP_ID, QUEST_ORD",
								TBL_FillAll )
			Data Field: T891
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.383"
						Top:    2.571"
						Width:  6.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(891))
			Data Field: T892
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.283"
						Top:    2.571"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(892))
			Multiline Field: T132
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65380000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					String Type: Long String
					Editable? Yes
				Display Settings
					Border? Yes
					Word Wrap? Yes
					Vertical Scroll? Yes
					Window Location and Size
						Left:   5.283"
						Top:    3.321"
						Width:  7.1"
						Width Editable? Yes
						Height: 0.917"
						Height Editable? Yes
					Visible? No
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Message Actions
			Group Box: Собственный взнос (грн)
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65380000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 54866
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.183"
					Top:    2.821"
					Width:  7.4"
					Width Editable? Yes
					Height: 1.5"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: T131
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65380000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   5.383"
						Top:    2.988"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Стоиость продукта (грн)
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65380000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 54867
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.983"
					Top:    1.262"
					Width:  2.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Line
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 36844
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Coordinates
					Begin X:  0.383"
					Begin Y:  2.905"
					End X:  12.283"
					End Y:  2.905"
				Visible? No
				Line Style: Etched
				Line Thickness: 4
				Line Color: Black
			Background Text: PTI
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 36845
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.083"
					Top:    3.345"
					Width:  0.4"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Red
				Background Color: Default
			Multiline Field: ml_error
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 4000
					String Type: Long String
					Editable? Yes
				Display Settings
					Border? Yes
					Word Wrap? No
					Vertical Scroll? Yes
					Window Location and Size
						Left:   0.383"
						Top:    4.238"
						Width:  12.1"
						Width Editable? Yes
						Height: 1.167"
						Height Editable? Yes
					Visible? No
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: 3D Face Color
				Message Actions
			Background Text: Доходи позичальника
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 48155
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    0.429"
					Width:  3.2"
					Width Editable? Yes
					Height: 0.226"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Arial
				Font Size: 12
				Font Enhancement: Bold-Italic-Underline
				Text Color: Chartreuse
				Background Color: Default
			Background Text: Витрати позичальника
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 48156
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.25"
					Top:    2.952"
					Width:  4.033"
					Width Editable? Yes
					Height: 0.286"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Arial
				Font Size: 12
				Font Enhancement: Bold-Italic-Underline
				Text Color: Chartreuse
				Background Color: Default
			Pushbutton: pb22
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65380000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbSynchro
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.283"
					Top:    0.488"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Browse.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Click
						If not IsWindow (hWin12)
							Set hWin12 = SalCreateWindow( Tbl_GPK, hWndForm, nPar,  0,DAT2,nS,DATNP,DAT4,dfPROC,nFREQ,cmbFREQ,nBasey,cmbBasey,TK133)
						Else
							Call SalBringWindowToTop ( Tbl_GPK )
			Background Text: * - Переход на другую строку CTRL + ENTER
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6537000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 22620
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.35"
					Top:    3.119"
					Width:  4.5"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: T133
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65380000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.583"
						Top:    2.321"
						Width:  5.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pb_Dox_Del
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65320000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbSynchro
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   12.283"
					Top:    1.155"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\DELETE.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set nNewRow=SalTblQueryContext(tbl_Dox)
						Call SalTblSetRowFlags(tbl_Dox, nNewRow, ROW_MarkDeleted, TRUE)
						Call SalTblDeleteRow ( tbl_Dox, nNewRow, TBL_Adjust)
		Functions
			Function: F_SAVE_KD
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: RNK_
					Number: PND_
					Number: SUM_CASH_
					Number: PREF_
				Actions
					! If FIO_ = STRING_Null OR SalStrLength( FIO_ ) < 3
							OR cmb_DOK = STRING_Null OR KEM_ = STRING_Null OR DATV_ = DATETIME_Null
							OR SER_ = STRING_Null OR NUM_ = STRING_Null
							OR IDX_ = STRING_Null OR REG_ = STRING_Null OR DST_ = STRING_Null
							OR TWN_ = STRING_Null OR STR_ = STRING_Null
							OR (nPAWN != NUMBER_Null AND SUMZ = NUMBER_Null)
						                                                                     Call SalMessageBox(
								"Не введено ВСІ необхідні дані для реєстрації
								 Клієнта-Позичальника та КД ",
								"Помилка ! ", MB_IconStop)
						                                                                     Return FALSE
					!
					! If SqlPrepareAndExecute(hSql(),
							"SELECT substr(pul.Get_Mas_Ini_Val('KOD_TOBO'),1,12) INTO :TOBO from dual ")
							and SqlFetchNext(hSql(), nFetchRes)
					! If SqlPLSQLCommand( hSql(),
							"CCWebPK.REGISTER_CREDIT
							( RNK_, PND_, PREF_, FIO_, BDAT_, OKPO_, SER_, NUM_, KEM_, DATV_,
							  IDX_, REG_, DST_, TWN_ , STR_ ,TEL1_,TEL2_,
							  nKV , nTORG, ID,cmb_TORG,MFO_P,NLS_P,OKPO_P,SUMZ, SUM_CASH_,
							  BankDate, PAWN )" )
							and SqlCommitEx( hSql(),'Открыт КД, реф='|| Str(PND_) )
						                                                                     Call MessageNoWait('Открыт КД, реф='|| Str(PND_),'Сообщение',3,0)
						                                                                     Return TRUE
					!
					Call SqlRollback(hSql())
					Call MessageNoWait('Неуспешное сохранение КД', 'Ошибка', 0, 1)
					Return FALSE
			Function: E_Ins
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					If TRUE
						! Call SalEnableWindow( FIO_ )
						! Call SalEnableWindow( OKPO_ )
						! Call SalDisableWindow( OKPO_ )
						! Call SalDisableWindow( BDAT_ )
						! Call SalEnableWindow( cmb_DOK )
						! Call SalEnableWindow( KEM_ )
					!
			!
			Function: F_DISA
				Description:
				Returns
					Boolean:
				Parameters
					String: Type_
					Number: In_
				Static Variables
				Local variables
				Actions
					! Set ID = NUMBER_Null
					If Type_='POR'
						If In_=0
							Call SalDisableWindow( T51)
							Call SalDisableWindow( T54)
							Call SalDisableWindow( T55)
							Call SalDisableWindow( T60)
							Call SalDisableWindow( T61)
							Call SalDisableWindow( T62)
							Call SalDisableWindow( T63)
							Call SalDisableWindow( T70)
							Call SalDisableWindow( T71)
							Call SalDisableWindow( T72)
							Call SalDisableWindow( T73)
							Call SalDisableWindow( T74)
							Call SalDisableWindow( T75)
							Call SalDisableWindow( T76)
							Call SalDisableWindow( T77)
							Call SalDisableWindow( T78)
							Call SalDisableWindow( T79)
							!
							Call SalDisableWindow(V401)
							Call SalDisableWindow(V405)
							Call SalDisableWindow(V410)
						Else
							Call SalEnableWindow( T60)
							Call SalEnableWindow( T61)
							Call SalEnableWindow( T62)
							Call SalEnableWindow( T63)
							Call SalEnableWindow( T65)
							Call SalEnableWindow( T70)
							Call SalEnableWindow( T71)
							Call SalEnableWindow( T72)
							Call SalEnableWindow( T73)
							Call SalEnableWindow( T74)
							Call SalEnableWindow( T75)
							Call SalEnableWindow( T76)
							Call SalEnableWindow( T77)
							Call SalEnableWindow( T78)
							Call SalEnableWindow( T79)
					If Type_='CREATE'
						If In_=0
							Call SalHideWindow(picTabs)
							Call SalDisableWindow( pbSave )
							Call SalDisableWindow( pb_End )
							Call SalDisableWindow( pb_F6)
							Call SalDisableWindow( pb_Zalog)
							Call SalDisableWindow( pb_Viza)
							If nPar=0 
								Call SalEnableWindow( pb_Edit )
								Call SalEnableWindow( pb_New )
							Else
								Call SalDisableWindow( pb_Edit )
								Call SalDisableWindow( pb_New )
						Else
							Call SalShowWindow(picTabs)
							If FirstOpen=TRUE
								Call picTabs.Delete(0, TRUE)
								Set FirstOpen=FALSE
							Call picTabs.__TabActivateStartThunk(2)
							!
							!
							Call SalEnableWindow( pbSave )
							Call SalEnableWindow( pb_End )
							If nPar=0
								Call SalEnableWindow( pb_Edit )
							! Call SalEnableWindow( pb_New )  !  нету механизма для очистки всех данных
							Call SalEnableWindow( pb_F6)
							Call SalEnableWindow( pb_Zalog)
							Call SalEnableWindow( pb_Viza)
							Call SalDisableWindow( pb_New )
							!
							!
							!
							Call SalDisableWindow( T51)
							Call SalDisableWindow( T54)
							Call SalDisableWindow( T60)
							Call SalDisableWindow( T61)
							Call SalDisableWindow( T62)
							Call SalDisableWindow( T63)
							Call SalDisableWindow( T70)
							Call SalDisableWindow( T71)
							Call SalDisableWindow( T73)
							Call SalDisableWindow( T74)
							Call SalDisableWindow( T75)
							Call SalDisableWindow( T76)
							Call SalDisableWindow( T77)
							Call SalDisableWindow( T78)
						! Call SalHideWindow(tbl2)
					! Call SalColorSet( KRDS_, COLOR_IndexWindow, nColR )
					! Set NAME = STRING_Null
					! Set IR = NUMBER_Null
					! Set MES = NUMBER_Null
					! Set SMAX = NUMBER_Null
					! Set PRK = NUMBER_Null
					! Set METR90 = NUMBER_Null
					! Set NAME90 = STRING_Null
					! Set MODE_GPK = NUMBER_Null
					! Set NAME_GPK = STRING_Null
					!
					! Call SalSendMsg( tbl_Dox, SAM_Create, 0, 0 )
					! Set nRAB = NUMBER_Null
					! Set cmb_RAB = STRING_Null
					! Call D_Ins ()
					!
			Function: F_Main
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					! Set BDAT_ = SalDateConstruct( 1953, 1, 25, 0, 0, 0 )
					! Set OKPO_ ='1938307209'
					! Set YAR_ = 54
					! Set cb_FAM = TRUE
					! Set KINDER_ = 0
					! Set STAG_ = 16
					! Set TERM_ = 35
					! Set PV_ = 10000
					! Set MES_ = 12
					! ! Set DOX_ = 3000
					! Set nKV = 980
					! Call cmb_KV.SetSelectById( nKV )
					! Set KURS = 1
					! Set PG_ = 10000
					! Set FIO_ = 'Сухова Т.О.'
					! Set nDOK = 1
					! Call cmb_DOK.SetSelectById( nDOK )
					! Set DATV_ = SalDateConstruct( 1996, 11, 12, 0, 0, 0 )
					! Set SER_='CH'
					! Set NUM_='36123'
					! Set REG_ = "Київ"
					! Set DST_ = "Дарницький"
					! Set IDX_ = "252068"
					! Set TWN_ = "Київ"
					! Set STR_ = "Коциця 10 кв 55"
					! Set TEL1_ = "(044)5651851"
					! Set KEM_ = "РУГУ"
					! Set TEL2_ = "(044)5533948"
					! Set KONT = "з 09:00 до 18:00"
					! Set OKPO_P ='12345678'
					! Set MFO_P ='300012'
					! Set NLS_P ='26003'
					! Set SUMZ = 12000
					! Set PAWN ='Товар, що купується'
					!
					! Set nRAB = NUMBER_Null
					! Set cmb_RAB = STRING_Null
					! Set nRANG = NUMBER_Null
					! Set cmb_RANG = STRING_Null
					! Set nOSVITA = NUMBER_Null
					! Set cmb_OSVITA = STRING_Null
			Function: f_Tochka
				Description:
				Returns
					Boolean:
				Parameters
					Window Handle: hWnd
				Static Variables
					String: sTmp
				Local variables
				Actions
					Set sTmp=SalStrRepeatX( ' ', 20 )
					Call SalGetWindowText ( hWnd, sTmp, 20 )
					While SalStrScan(sTmp, sDecimal2) > 0
						Set sTmp = SalStrReplaceX(sTmp,SalStrScan(sTmp,sDecimal2),1,sDecimal)
					Call SalFmtStrToField ( hWnd, sTmp, TRUE)
			Function: F_RUN
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: n37
					Number: FIN_
					String: Str_temp
					Number: Count_
				Actions
					! If (YAR_=NUMBER_Null OR PV_ = NUMBER_Null OR nKV = NUMBER_Null OR
							    MES_=NUMBER_Null OR nIST= NUMBER_Null )
							OR SURVEY  = 1
							  OR SURVEY  = 2 AND ( nDEP = NUMBER_Null )
						                                                                       Call SalMessageBox("Не введено ВСІ необхідні дані ",
								"Помилка ! ", MB_IconStop)
						                                                                       Return FALSE
					! Set n37 = 169 - cb_FAM
					! If SqlPrepareAndExecute( hSql(), "delete from CCK_AN_TMP " )
							and SqlPrepare( hSql(),
							   "insert into CCK_AN_TMP(PR,N4 ,N1,N2,N3) values
							       (:tbl_Dox.Kod_D, :tbl_Dox.Poz, :tbl_Dox.Por_1, :tbl_Dox.Por_2, :tbl_Dox.Por_3 )")
							and SalTblDoInserts( tbl_Dox, hSql(), FALSE )
						                                                                       Call SqlPLSQLCommand( hSql(),  "CCWebPK.SURVEY0 (OKPO_, SURVEY,BDAT_,
								                       TERM_,n37,KINDER_,nRAB,nRANG,STAG_,nOSVITA,PV_,MES_,0,nKV,nIST,nDEP )")
						                                                                       Call SqlPrepareAndExecute( hSql(), "delete from CCK_AN_TMP " )
						! Call SqlPLSQLCommand(hSql(),"CCWebPK.SUR_DOX(NUMBER_Null,ID,DOX_)")
						                                                                       If SqlPrepareAndExecute( hSql(), "select CCWebPK.SUR_INB(null,to_number("||Str(ID)||") )  into :KRDS_ from dual " )
								  and SqlFetchNext( hSql(), nFetchRes )
							                                                                       If KRDS_>= KRDN
								                                                                       Call SqlCommit( hSql() )
								                                                                       Call SalColorSet( KRDS_, COLOR_IndexWindow, nColG )
								                                                                       Call E_Ins ()
							                                                                       Else
								                                                                       Call SqlRollback( hSql() )
								                                                                       Call SalColorSet( KRDS_, COLOR_IndexWindow, nColR )
								                                                                       Call D_Ins ()
					!
					If SurveySessionID>0
						If NOT SqlPrepareAndExecute( hSql(), "delete from survey_answer 
								              where session_id=:SurveySessionID and ((quest_id_p>0 and quest_id_p<300) or (quest_id_p>=400 and quest_id_p<900) )" )
							Call SqlRollback( hSql() )
							Return FALSE
							If SqlPrepareAndExecute( hSql(), "select COMPLETED into :Count_  from survey_session where session_id=:SurveySessionID" )
									and SqlFetchNext( hSql(), nFetchRes )
								If Count_>0 
									Call MessageNoWait('Анкета вже передана на розгляд до Кредитного комітету','Повідомлення',3,0)
									Return FALSE
					Else
						! Открываем сессию анкеты
						! Call MessageNoWait('1', 'Open Session', 0, 1)
						If not SqlPLSQLCommand( hSql(),
								"Seb_sur.start_session (RNK_KL, SurveyID,0,SurveySessionID)" )
							Call SqlRollback( hSql() )
							Return FALSE
					! Заполняем ответами
					If not F_FIX_ANSWER( 1, T1)
						Return FALSE
					If RNK_KL>0 and RNK_KL !=NUMBER_Null
						If not F_FIX_ANSWER( 2,SalFmtFormatNumber (RNK_KL, '0' ))
							Return FALSE
					If not F_FIX_ANSWER( 4, SalFmtFormatDateTime(T4,'dd/MM/yyyy'))
						Return FALSE
					If not F_FIX_ANSWER( 5, T5)
						Return FALSE
					If not F_FIX_ANSWER( 10, T10)
						Return FALSE
					If not F_FIX_ANSWER( 11,T11)
						Return FALSE
					If not F_FIX_ANSWER( 12, T12)
						Return FALSE
					If not F_FIX_ANSWER( 13, SalFmtFormatDateTime(T13,'dd/MM/yyyy'))
						Return FALSE
					If not F_FIX_ANSWER( 15, T15)
						Return FALSE
					If not F_FIX_ANSWER( 20, T20)
						Return FALSE
					If not F_FIX_ANSWER( 21, T21)
						Return FALSE
					If not F_FIX_ANSWER( 22, SalFmtFormatNumber (TK22, '0' ))
						Return FALSE
					If not F_FIX_ANSWER( 23, T23)
						Return FALSE
					If not F_FIX_ANSWER( 24, T24)
						Return FALSE
					If not F_FIX_ANSWER( 25, T25)
						Return FALSE
					If not F_FIX_ANSWER( 26, T26)
						Return FALSE
					If not F_FIX_ANSWER( 27, SalFmtFormatNumber (TK27, '0' ))
						Return FALSE
					If not F_FIX_ANSWER( 28, SalFmtFormatNumber (TK28, '0' ))
						Return FALSE
					If not F_FIX_ANSWER( 29, SalFmtFormatNumber (TK29, '0' ))
						Return FALSE
					! Сохраняем лиц находящихся на иждевении
					Set nNewRow=TBL_MinRow
					Call SalTblSetFlagsAnyRows ( tbl2, ROW_Edited, TRUE, 0,0 )
					While SalTblFindNextRow( tbl2, nNewRow, ROW_Edited, 0)
						Call SalTblSetContext( tbl2, nNewRow )
						If not F_FIX_ANSWER( 30,SalFmtFormatNumber (tbl2.TK30, '0' ))
							Return FALSE
						If not F_FIX_ANSWER( 31, tbl2.T31)
							Return FALSE
						If not F_FIX_ANSWER( 32,SalFmtFormatDateTime(tbl2.T32,'dd/MM/yyyy'))
							Return FALSE
						! Call SqlPrepareAndExecute(hSql(),"INSERT INTO survey_qgrp(grp_number, grp_name, grp_ord, survey_id) VALUES(:Groups.grp_number,:Groups.grp_name,:Groups.grp_ord,:cursurv)")
					!
					If T65!= STRING_Null
						If not F_FIX_ANSWER( 51, T51)
							Return FALSE
						If not F_FIX_ANSWER( 54, SalFmtFormatDateTime(T54,'dd/MM/yyyy'))
							Return FALSE
						If not F_FIX_ANSWER( 55, T55)
							Return FALSE
						If not F_FIX_ANSWER( 60, T60)
							Return FALSE
						If not F_FIX_ANSWER( 61,T61)
							Return FALSE
						If not F_FIX_ANSWER( 62, T62)
							Return FALSE
						If not F_FIX_ANSWER( 63, SalFmtFormatDateTime(T63,'dd/MM/yyyy'))
							Return FALSE
						If not F_FIX_ANSWER( 65, T65)
							Return FALSE
						If not F_FIX_ANSWER( 70, T70)
							Return FALSE
						If not F_FIX_ANSWER( 71, T71)
							Return FALSE
						If not F_FIX_ANSWER( 72, SalFmtFormatNumber (TK72, '0' ))
							Return FALSE
						If not F_FIX_ANSWER( 73, T73)
							Return FALSE
						If not F_FIX_ANSWER( 74, T74)
							Return FALSE
						If not F_FIX_ANSWER( 75, T75)
							Return FALSE
						If not F_FIX_ANSWER( 76, T76)
							Return FALSE
						If not F_FIX_ANSWER( 77, SalFmtFormatNumber (TK77, '0' ))
							Return FALSE
						If not F_FIX_ANSWER( 78, SalFmtFormatNumber (TK78, '0' ))
							Return FALSE
						If not F_FIX_ANSWER( 79, SalFmtFormatNumber (TK79, '0' ))
							Return FALSE
					!
					If not F_FIX_ANSWER( 100, SalStrTrimX(CC_ID))
						Return FALSE
					If not F_FIX_ANSWER( 101, SalFmtFormatNumber (nKV, '0' ))
						Return FALSE
					If not F_FIX_ANSWER( 102, SalFmtFormatNumber (nS*100, '0' ))
						Return FALSE
					If not F_FIX_ANSWER( 105, SalFmtFormatDateTime(DAT1,'dd/MM/yyyy'))
						Return FALSE
					If not F_FIX_ANSWER( 106, SalFmtFormatDateTime(DAT2,'dd/MM/yyyy'))
						Return FALSE
					If not F_FIX_ANSWER( 107, SalFmtFormatDateTime(DAT3,'dd/MM/yyyy'))
						Return FALSE
					If not F_FIX_ANSWER( 108, SalFmtFormatDateTime(DAT4,'dd/MM/yyyy'))
						Return FALSE
					If not F_FIX_ANSWER( 110, SalFmtFormatNumber (nVID, '0' ))
						Return FALSE
					If not F_FIX_ANSWER( 111, SalFmtFormatNumber (nISTO, '0' ))
						Return FALSE
					If not F_FIX_ANSWER( 112, SalFmtFormatNumber (nCEL, '0' ))
						Return FALSE
					If not F_FIX_ANSWER( 113, MS_NX)
						Return FALSE
					If not F_FIX_ANSWER( 114, INIC)
						Return FALSE
					If not F_FIX_ANSWER( 115, SalFmtFormatNumber (nKOM, '0' ))
						Return FALSE
					If not F_FIX_ANSWER( 116, SalFmtFormatNumber (dfKOM, '0' ))
						Return FALSE
					If not F_FIX_ANSWER( 120, NLS)
						Return FALSE
					If not F_FIX_ANSWER( 121, SalFmtFormatNumber (nBANK, '0' ))
						Return FALSE
					If not F_FIX_ANSWER( 122, SalFmtFormatNumber (nFREQ, '0' ))
						Return FALSE
					If not F_FIX_ANSWER( 123, SalFmtFormatNumber (dfPROC, '0' ))
						Return FALSE
					If not F_FIX_ANSWER( 124, SalFmtFormatNumber (nBasey, '0' ))
						Return FALSE
					If not F_FIX_ANSWER( 125, SalFmtFormatNumber (dfDen, '0' ))
						Return FALSE
					If not F_FIX_ANSWER( 126, SalFmtFormatDateTime(DATNP,'dd/MM/yyyy'))
						Return FALSE
					If not F_FIX_ANSWER( 127, SalFmtFormatNumber (nFREQP, '0' ))
						Return FALSE
					If not F_FIX_ANSWER( 150, SalFmtFormatNumber (TK150, '0' ))
						Return FALSE
					If not F_FIX_ANSWER( 130, SalFmtFormatNumber (T130*100, '0' ))
						Return FALSE
					If not F_FIX_ANSWER( 131, SalFmtFormatNumber (T131*100, '0' ))
						Return FALSE
					If not F_FIX_ANSWER( 132, T132)
						Return FALSE
					If not F_FIX_ANSWER( 133, SalFmtFormatNumber (TK133, '0' ))
						Return FALSE
					!
					!
					!
					!
					! ---------------------------------- Активы
					Set nNewRow=TBL_MinRow
					Call SalTblSetFlagsAnyRows ( tbl_Capital, ROW_Edited, TRUE, 0,0 )
					While SalTblFindNextRow( tbl_Capital, nNewRow, ROW_Edited, 0)
						Call SalTblSetContext( tbl_Capital, nNewRow )
						If tbl_Capital.T202>0
							If tbl_Capital.T200=1
								If not   F_FIX_ANSWER( 200, '1')
									Return FALSE
							Else
								If not   F_FIX_ANSWER( 200, '0')
									Return FALSE
							If not F_FIX_ANSWER( 201, SalFmtFormatNumber (tbl_Capital.TK201, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 202, SalFmtFormatNumber (tbl_Capital.T202*100, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 210, tbl_Capital.T210)
								Return FALSE
						! Call SqlPrepareAndExecute(hSql(),"INSERT INTO survey_qgrp(grp_number, grp_name, grp_ord, survey_id) VALUES(:Groups.grp_number,:Groups.grp_name,:Groups.grp_ord,:cursurv)")
					!
					! ----------------------------------- Занятость клиента
					Set nNewRow=TBL_MinRow
					Call SalTblSetFlagsAnyRows ( tbl_Emp, ROW_Edited, TRUE, 0,0 )
					While SalTblFindNextRow( tbl_Emp, nNewRow, ROW_Edited, 0)
						Call SalTblSetContext( tbl_Emp, nNewRow )
						If tbl_Emp.T400!=STRING_Null
							If not F_FIX_ANSWER( 400, SalFmtFormatNumber (tbl_Emp.TK400, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 401, SalFmtFormatNumber (tbl_Emp.TK401, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 402, tbl_Emp.T402)
								Return FALSE
							If not F_FIX_ANSWER( 403, tbl_Emp.T403)
								Return FALSE
							If not F_FIX_ANSWER( 404, SalFmtFormatNumber (tbl_Emp.T404, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 405, SalFmtFormatNumber (tbl_Emp.TK405, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 406, tbl_Emp.T406)
								Return FALSE
							If not F_FIX_ANSWER( 407, SalFmtFormatNumber (tbl_Emp.T407*100, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 408, SalFmtFormatNumber (tbl_Emp.T408, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 409, SalFmtFormatNumber (tbl_Emp.T409, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 410, SalFmtFormatNumber (tbl_Emp.TK410, '0' ))
								Return FALSE
						! Call SqlPrepareAndExecute(hSql(),"INSERT INTO survey_qgrp(grp_number, grp_name, grp_ord, survey_id) VALUES(:Groups.grp_number,:Groups.grp_name,:Groups.grp_ord,:cursurv)")
					!
					!
					! ---------------------------------- Кредитная история
					Set nNewRow=TBL_MinRow
					Call SalTblSetFlagsAnyRows ( tbl_History, ROW_Edited, TRUE, 0,0 )
					While SalTblFindNextRow( tbl_History, nNewRow, ROW_Edited, 0)
						Call SalTblSetContext( tbl_History, nNewRow )
						If tbl_History.T500!=STRING_Null
							If not F_FIX_ANSWER( 500, tbl_History.T500)
								Return FALSE
							If not F_FIX_ANSWER( 501, SalFmtFormatNumber (tbl_History.T501*100, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 502, SalFmtFormatNumber (tbl_History.T502*100, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 503, SalFmtFormatNumber (tbl_History.T503*100, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 504, SalFmtFormatDateTime(tbl_History.T504,'dd/MM/yyyy'))
								Return FALSE
							If not F_FIX_ANSWER( 505, SalFmtFormatDateTime(tbl_History.T505,'dd/MM/yyyy'))
								Return FALSE
							If not F_FIX_ANSWER( 506, SalFmtFormatDateTime(tbl_History.T506,'dd/MM/yyyy'))
								Return FALSE
							If not F_FIX_ANSWER( 507,SalFmtFormatNumber (tbl_History.TK507, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 508, SalFmtFormatNumber (tbl_History.T508, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 509, SalFmtFormatDateTime(tbl_History.T509,'dd/MM/yyyy'))
								Return FALSE
							If not F_FIX_ANSWER( 510,SalFmtFormatNumber (tbl_History.TK510, '0' ))
						! Call SqlPrepareAndExecute(hSql(),"INSERT INTO survey_qgrp(grp_number, grp_name, grp_ord, survey_id) VALUES(:Groups.grp_number,:Groups.grp_name,:Groups.grp_ord,:cursurv)")
					!
					!
					! ---------------------------------- Доходы
					Set nNewRow=TBL_MinRow
					Call SalTblSetFlagsAnyRows ( tbl_Dox, ROW_Edited, TRUE, 0,0 )
					While SalTblFindNextRow( tbl_Dox, nNewRow, ROW_Edited, 0)
						Call SalTblSetContext( tbl_Dox, nNewRow )
						If tbl_Dox.T648>0 or tbl_Dox.T649>0
							If tbl_Dox.T600=1
								If not   F_FIX_ANSWER( 600, '1')
									Return FALSE
							Else
								If not   F_FIX_ANSWER( 600, '0')
									Return FALSE
							If not F_FIX_ANSWER( 601, SalFmtFormatNumber (tbl_Dox.TK601, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 610, SalFmtFormatNumber (tbl_Dox.TK610, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 611, SalFmtFormatNumber (tbl_Dox.T611*100, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 612, SalFmtFormatNumber (tbl_Dox.T612*100, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 613, SalFmtFormatNumber (tbl_Dox.T613*100, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 614, SalFmtFormatNumber (tbl_Dox.T614*100, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 615, SalFmtFormatNumber (tbl_Dox.T615*100, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 616, SalFmtFormatNumber (tbl_Dox.T616*100, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 648, SalFmtFormatNumber (tbl_Dox.T648*100, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 649, SalFmtFormatNumber (tbl_Dox.T649*100, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 650, tbl_Dox.T650)
								Return FALSE
						! Call SqlPrepareAndExecute(hSql(),"INSERT INTO survey_qgrp(grp_number, grp_name, grp_ord, survey_id) VALUES(:Groups.grp_number,:Groups.grp_name,:Groups.grp_ord,:cursurv)")
					! ---------------------------------- Расходы
					Set nNewRow=TBL_MinRow
					Call SalTblSetFlagsAnyRows ( tbl_Exp, ROW_Edited, TRUE, 0,0 )
					While SalTblFindNextRow( tbl_Exp, nNewRow, ROW_Edited, 0)
						Call SalTblSetContext( tbl_Exp, nNewRow )
						If tbl_Exp.T748>0 or tbl_Exp.T749>0
							If tbl_Exp.T700=1
								If not   F_FIX_ANSWER( 700, '1')
									Return FALSE
							Else
								If not   F_FIX_ANSWER( 700, '0')
									Return FALSE
							! If not F_FIX_ANSWER( 701, SalFmtFormatNumber (tbl_Dox.TK701, '0' ))
								                                                            Return FALSE
							If not F_FIX_ANSWER( 710, SalFmtFormatNumber (tbl_Exp.TK710, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 711, SalFmtFormatNumber (tbl_Exp.T711*100, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 712, SalFmtFormatNumber (tbl_Exp.T712*100, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 713, SalFmtFormatNumber (tbl_Exp.T713*100, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 714, SalFmtFormatNumber (tbl_Exp.T714*100, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 715, SalFmtFormatNumber (tbl_Exp.T715*100, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 716, SalFmtFormatNumber (tbl_Exp.T716*100, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 748, SalFmtFormatNumber (tbl_Exp.T748*100, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 749, SalFmtFormatNumber (tbl_Exp.T749*100, '0' ))
								Return FALSE
							If not F_FIX_ANSWER( 750, tbl_Exp.T750)
								Return FALSE
						! Call SqlPrepareAndExecute(hSql(),"INSERT INTO survey_qgrp(grp_number, grp_name, grp_ord, survey_id) VALUES(:Groups.grp_number,:Groups.grp_name,:Groups.grp_ord,:cursurv)")
					!
					!
					If not F_FIX_ANSWER( 891, T891)
						Return FALSE
					If not F_FIX_ANSWER( 892, SalFmtFormatNumber (T892*100, '0' ))
						Return FALSE
					! Анкета сохранена и теперь она действительно имеет свой номер
					Set SurveySessionID_Null=FALSE
					If SqlPrepareAndExecute( hSql(),
							  "SELECT session_date INTO :Session_Date
							   FROM survey_session
							   WHERE session_id=:SurveySessionID")
							and SqlFetchNext(hSql(), nFetchRes) 
					Return TRUE
			Function: F_LOAD
				Description:
				Returns
					Boolean:
				Parameters
					Number: nVxod
				Static Variables
				Local variables
					Number: n37
					Number: FIN_
					Number: Count_row
					Number: ni
					String: si
					Number: Row_
					!
					String: sTmp
					String: sTmp1
				Actions
					!
					If nPar >0 and nVxod =0
						Set SurveySessionID=nPar
					Else If nPar =0 and nVxod = 1
						Set sTmp = STRING_Null
						Call FunNSIGetFiltered
								("V_ZAG_SUR","FIO", " ( COMPLETED in (0,1,5) )",sTmp,sTmp1 )
						If sTmp != STRING_Null
							Set SurveySessionID=Val(sTmp)
							Call F_DISA('CREATE',1)
							Call F_LOAD_ANSWER_FULL(150,1,TK150,T150)
							! Call F_POPULATE(SalFmtFormatNumber (Opt_to_Ord(TK150), '0' ))
							Call F_POPULATE(SalFmtFormatNumber (TK150, '0' ))
						Else
							Return TRUE
					! 111
					! Открываем сессию анкеты
					! Set SurveySessionID = 129
					! Call MessageNoWait(Str(SurveySessionID), 'Open Session', 0, 1)
					! If not SqlPLSQLCommand( hSql(),
							"Seb_sur.start_session (RNK_KL, SurveyID,0,SurveySessionID)" )
						                                                Return FALSE
					! Заполняем ответами
					! If SqlPLSQLCommand( hSql(), "Seb_Sur.fix_answer_p2 (SurveySessionID,QuestID_,0,Str_)" )
					! SalFmtFormatDateTime
					! Call MessageNoWait(F_LOAD_ANSWER(1), 'Open Session', 0, 1)
					! Дата заполнения анкеты
					Call All_Null()
					Set T1=F_LOAD_ANSWER(1)
					If SurveySessionID>0
						If SqlPrepareAndExecute( hSql(),
								  "SELECT session_date INTO :Session_Date
								   FROM survey_session
								   WHERE session_id=:SurveySessionID")
								and SqlFetchNext(hSql(), nFetchRes) 
					Set RNK_KL=SalStrToNumber(F_LOAD_ANSWER(2))
					If RNK_KL=NUMBER_Null
						Set RNK_KL = - GetUserId()
					Set T4=SalStrToDate(F_LOAD_ANSWER(4))
					Set T5=F_LOAD_ANSWER(5)
					Set T10=F_LOAD_ANSWER(10)
					Set T11=F_LOAD_ANSWER(11)
					Set T12=F_LOAD_ANSWER(12)
					Set T13=SalStrToDate(F_LOAD_ANSWER(13))
					Set T15=F_LOAD_ANSWER(15)
					Set T20=F_LOAD_ANSWER(20)
					Set T21=F_LOAD_ANSWER(21)
					Call F_LOAD_ANSWER_KOD(22,TK22,T22)
					Set T23=F_LOAD_ANSWER(23)
					Set T24=F_LOAD_ANSWER(24)
					Set T25=F_LOAD_ANSWER(25)
					Set T26=F_LOAD_ANSWER(26)
					Call F_LOAD_ANSWER_KOD(27,TK27,T27)
					Call F_LOAD_ANSWER_KOD(28,TK28,T28)
					Call F_LOAD_ANSWER_KOD(29,TK29,T29)
					! Call MessageNoWait(Str(TK29), T29, 0, 1)
					! Call SalTblPopulate(Groups, hSql(), "SELECT grp_id, grp_ord, grp_number, grp_name INTO :grp_id, :grp_ord, :grp_number, :grp_name FROM survey_qgrp WHERE survey_id="|| NumberToStr( cursurv ) ||" ORDER BY grp_ord", TBL_FillAll)
					Set Row_=1
					Set nNewRow=TBL_MinRow
					If SqlPrepareAndExecute( hSql(),
							"SELECT substr(seb_sur.get_kol_pos(:SurveySessionID,30) ,1,200)  into :Count_row from dual ")
							and SqlFetchNext( hSql(), nFetchRes )
					! Call F_LOAD_ANSWER_FULL(30,Count_row, ni ,si)
					While Row_<=Count_row
						Set nNewRow=SalTblInsertRow(tbl2, TBL_MaxRow)
						Call F_LOAD_ANSWER_FULL(30,Row_, tbl2.TK30 ,tbl2.T30)
						Call F_LOAD_ANSWER_FULL(31,Row_, ni ,tbl2.T31)
						Call F_LOAD_ANSWER_FULL(32,Row_, ni ,si)
						Set tbl2.T32=SalStrToDate(si)
						Set Row_=Row_+1
					Set T65=F_LOAD_ANSWER(65)
					!
					If T65!= STRING_Null
						Call F_DISA('POR',1)
						Set T51=F_LOAD_ANSWER(51)
						Set T54=SalStrToDate(F_LOAD_ANSWER(54))
						Set T55=F_LOAD_ANSWER(55)
						Set T60=F_LOAD_ANSWER(60)
						Set T61=F_LOAD_ANSWER(61)
						Set T62=F_LOAD_ANSWER(62)
						Set T63=SalStrToDate(F_LOAD_ANSWER(63))
						Set T65=F_LOAD_ANSWER(65)
						Set T70=F_LOAD_ANSWER(70)
						Set T71=F_LOAD_ANSWER(71)
						Call F_LOAD_ANSWER_KOD(72,TK72,T72)
						Set T73=F_LOAD_ANSWER(73)
						Set T74=F_LOAD_ANSWER(74)
						Set T75=F_LOAD_ANSWER(75)
						Set T76=F_LOAD_ANSWER(76)
						Call F_LOAD_ANSWER_KOD(77,TK77,T77)
						Call F_LOAD_ANSWER_KOD(78,TK78,T78)
						Call F_LOAD_ANSWER_KOD(79,TK79,T79)
					!
					Set CC_ID=F_LOAD_ANSWER(100)
					Call F_LOAD_ANSWER_KOD(101,nKV,cmbKV)
					Set nS=SalStrToNumber(F_LOAD_ANSWER(102))/100
					Set DAT1=SalStrToDate(F_LOAD_ANSWER(105))
					Set DAT2=SalStrToDate(F_LOAD_ANSWER(106))
					Set DAT3=SalStrToDate(F_LOAD_ANSWER(107))
					Set DAT4=SalStrToDate(F_LOAD_ANSWER(108))
					Call F_LOAD_ANSWER_KOD(110,nVID,cmbVID)
					Call F_LOAD_ANSWER_KOD(111,nISTO,cmbSOUR)
					Call F_LOAD_ANSWER_KOD(112,nCEL,cmbAIM)
					Call F_LOAD_ANSWER_KOD(113,ni,MS_NX)
					Set INIC=F_LOAD_ANSWER(114)
					Call F_LOAD_ANSWER_KOD(115,nKOM,cmbKom)
					Set dfKOM=SalStrToNumber(F_LOAD_ANSWER(116))
					Set NLS=F_LOAD_ANSWER(120)
					Set nBANK=SalStrToNumber(F_LOAD_ANSWER(121))
					Call F_LOAD_ANSWER_KOD(122,nFREQ,cmbFREQ)
					Set dfPROC=SalStrToNumber(F_LOAD_ANSWER(123))
					Call F_LOAD_ANSWER_KOD(124,nBasey,cmbBasey)
					Set dfDen=SalStrToNumber(F_LOAD_ANSWER(125))
					Set DATNP=SalStrToDate(F_LOAD_ANSWER(126))
					Call F_LOAD_ANSWER_KOD(127,nFREQP,cmbFREQP)
					Set T130=SalStrToNumber(F_LOAD_ANSWER(130))/100
					Set T131=SalStrToNumber(F_LOAD_ANSWER(131))/100
					Set T132=F_LOAD_ANSWER(132)
					Set T133=F_LOAD_ANSWER(133)
					!
					!
					! Capital
					Set Row_=1
					Set nNewRow=TBL_MinRow
					If SqlPrepareAndExecute( hSql(),
							"SELECT substr(seb_sur.get_kol_pos(:SurveySessionID,201) ,1,200)  into :Count_row from dual ")
							and SqlFetchNext( hSql(), nFetchRes )
					! Call F_LOAD_ANSWER_FULL(30,Count_row, ni ,si)
					While Row_<=Count_row
						Set nNewRow=SalTblInsertRow(tbl_Capital, TBL_MaxRow)
						Call F_LOAD_ANSWER_FULL(200,Row_, ni ,si)
						Set tbl_Capital.T200=SalStrToNumber(si)
						Call F_LOAD_ANSWER_FULL(201,Row_, tbl_Capital.TK201 ,tbl_Capital.T201)
						Call F_LOAD_ANSWER_FULL(202,Row_, ni ,si)
						Set tbl_Capital.T202=SalStrToNumber(si)/100
						Call F_LOAD_ANSWER_FULL(210,Row_, ni ,tbl_Capital.T210)
						! Set tbl2.T32=SalStrToDate(si)
						Set Row_=Row_+1
					!
					!
					! Занятость
					!
					Set Row_=1
					Set nNewRow=TBL_MinRow
					If SqlPrepareAndExecute( hSql(),
							"SELECT substr(seb_sur.get_kol_pos(:SurveySessionID,400) ,1,200)  into :Count_row from dual ")
							and SqlFetchNext( hSql(), nFetchRes )
					While Row_<=Count_row
						Set nNewRow=SalTblInsertRow(tbl_Emp, TBL_MaxRow)
						Call F_LOAD_ANSWER_FULL(400,Row_, tbl_Emp.TK400 ,tbl_Emp.T400)
						Call F_LOAD_ANSWER_FULL(401,Row_, tbl_Emp.TK401 ,tbl_Emp.T401)
						Call F_LOAD_ANSWER_FULL(402,Row_, ni ,tbl_Emp.T402)
						Call F_LOAD_ANSWER_FULL(403,Row_, ni ,tbl_Emp.T403)
						Call F_LOAD_ANSWER_FULL(404,Row_, ni ,si)
						Set tbl_Emp.T404=SalStrToNumber(si)
						Call F_LOAD_ANSWER_FULL(405,Row_, tbl_Emp.TK405 ,tbl_Emp.T405)
						Call F_LOAD_ANSWER_FULL(406,Row_, ni ,tbl_Emp.T406)
						Call F_LOAD_ANSWER_FULL(407,Row_, ni ,si)
						Set tbl_Emp.T407=SalStrToNumber(si)/100
						Call F_LOAD_ANSWER_FULL(408,Row_, ni ,si)
						Set tbl_Emp.T408=SalStrToNumber(si)
						Call F_LOAD_ANSWER_FULL(409,Row_, ni ,si)
						Set tbl_Emp.T409=SalStrToNumber(si)
						Call F_LOAD_ANSWER_FULL(410,Row_, tbl_Emp.TK410 ,tbl_Emp.T410)
						! Set tbl2.T32=SalStrToDate(si)
						Set Row_=Row_+1
					! Кредитная история
					!
					Set Row_=1
					Set nNewRow=TBL_MinRow
					If SqlPrepareAndExecute( hSql(),
							"SELECT substr(seb_sur.get_kol_pos(:SurveySessionID,500) ,1,200)  into :Count_row from dual ")
							and SqlFetchNext( hSql(), nFetchRes )
					While Row_<=Count_row
						Set nNewRow=SalTblInsertRow(tbl_History, TBL_MaxRow)
						Call F_LOAD_ANSWER_FULL(500,Row_, ni ,tbl_History.T500)
						Call F_LOAD_ANSWER_FULL(501,Row_, ni ,si)
						Set tbl_History.T501=SalStrToNumber(si)/100
						Call F_LOAD_ANSWER_FULL(502,Row_, ni ,si)
						Set tbl_History.T502=SalStrToNumber(si)/100
						Call F_LOAD_ANSWER_FULL(503,Row_, ni ,si)
						Set tbl_History.T503=SalStrToNumber(si)/100
						Call F_LOAD_ANSWER_FULL(504,Row_, ni ,si)
						Set tbl_History.T504=SalStrToDate(si)
						Call F_LOAD_ANSWER_FULL(505,Row_, ni ,si)
						Set tbl_History.T505=SalStrToDate(si)
						Call F_LOAD_ANSWER_FULL(506,Row_, ni ,si)
						Set tbl_History.T506=SalStrToDate(si)
						Call F_LOAD_ANSWER_FULL(507,Row_, tbl_History.TK507 ,tbl_History.T507)
						Call F_LOAD_ANSWER_FULL(508,Row_, ni ,si)
						Set tbl_History.T508=SalStrToNumber(si)
						Call F_LOAD_ANSWER_FULL(509,Row_, ni ,si)
						Set tbl_History.T509=SalStrToDate(si)
						Call F_LOAD_ANSWER_FULL(510,Row_, tbl_History.TK510 ,tbl_History.T510)
						! Set tbl2.T32=SalStrToDate(si)
						Set Row_=Row_+1
					! DOXOD
					Set Row_=1
					Set nNewRow=TBL_MinRow
					If SqlPrepareAndExecute( hSql(),
							"SELECT substr(seb_sur.get_kol_pos(:SurveySessionID,600) ,1,200)  into :Count_row from dual ")
							and SqlFetchNext( hSql(), nFetchRes )
					! Call F_LOAD_ANSWER_FULL(30,Count_row, ni ,si)
					While Row_<=Count_row
						Set nNewRow=SalTblInsertRow(tbl_Dox, TBL_MaxRow)
						Call F_LOAD_ANSWER_FULL(600,Row_, ni ,si)
						Set tbl_Dox.T600=SalStrToNumber(si)
						Call F_LOAD_ANSWER_FULL(601,Row_, tbl_Dox.TK601 ,tbl_Dox.T601)
						Call F_LOAD_ANSWER_FULL(610,Row_, tbl_Dox.TK610 ,tbl_Dox.T610)
						Call F_LOAD_ANSWER_FULL(611,Row_, ni ,si)
						Set tbl_Dox.T611=SalStrToNumber(si)/100
						Call F_LOAD_ANSWER_FULL(612,Row_, ni ,si)
						Set tbl_Dox.T612=SalStrToNumber(si)/100
						Call F_LOAD_ANSWER_FULL(613,Row_, ni ,si)
						Set tbl_Dox.T613=SalStrToNumber(si)/100
						Call F_LOAD_ANSWER_FULL(614,Row_, ni ,si)
						Set tbl_Dox.T614=SalStrToNumber(si)/100
						Call F_LOAD_ANSWER_FULL(615,Row_, ni ,si)
						Set tbl_Dox.T615=SalStrToNumber(si)/100
						Call F_LOAD_ANSWER_FULL(616,Row_, ni ,si)
						Set tbl_Dox.T616=SalStrToNumber(si)/100
						Call F_LOAD_ANSWER_FULL(648,Row_, ni ,si)
						Set tbl_Dox.T648=SalStrToNumber(si)/100
						Call F_LOAD_ANSWER_FULL(649,Row_, ni ,si)
						Set tbl_Dox.T649=SalStrToNumber(si)/100
						Call F_LOAD_ANSWER_FULL(650,Row_, ni ,tbl_Dox.T650)
						! Set tbl2.T32=SalStrToDate(si)
						Set Row_=Row_+1
					! RASHOD
					Set Row_=1
					Set nNewRow=TBL_MinRow
					If SqlPrepareAndExecute( hSql(),
							"SELECT substr(seb_sur.get_kol_pos(:SurveySessionID,700) ,1,200)  into :Count_row from dual ")
							and SqlFetchNext( hSql(), nFetchRes )
					! Call F_LOAD_ANSWER_FULL(30,Count_row, ni ,si)
					While Row_<=Count_row
						Set nNewRow=SalTblInsertRow(tbl_Exp, TBL_MaxRow)
						Call F_LOAD_ANSWER_FULL(700,Row_, ni ,si)
						Set tbl_Exp.T700=SalStrToNumber(si)
						Call F_LOAD_ANSWER_FULL(701,Row_, tbl_Exp.TK701 ,tbl_Exp.T701)
						Call F_LOAD_ANSWER_FULL(710,Row_, tbl_Exp.TK710 ,tbl_Exp.T710)
						Call F_LOAD_ANSWER_FULL(711,Row_, ni ,si)
						Set tbl_Exp.T711=SalStrToNumber(si)/100
						Call F_LOAD_ANSWER_FULL(712,Row_, ni ,si)
						Set tbl_Exp.T712=SalStrToNumber(si)/100
						Call F_LOAD_ANSWER_FULL(713,Row_, ni ,si)
						Set tbl_Exp.T713=SalStrToNumber(si)/100
						Call F_LOAD_ANSWER_FULL(714,Row_, ni ,si)
						Set tbl_Exp.T714=SalStrToNumber(si)/100
						Call F_LOAD_ANSWER_FULL(715,Row_, ni ,si)
						Set tbl_Exp.T715=SalStrToNumber(si)/100
						Call F_LOAD_ANSWER_FULL(716,Row_, ni ,si)
						Set tbl_Exp.T716=SalStrToNumber(si)/100
						Call F_LOAD_ANSWER_FULL(748,Row_, ni ,si)
						Set tbl_Exp.T748=SalStrToNumber(si)/100
						Call F_LOAD_ANSWER_FULL(749,Row_, ni ,si)
						Set tbl_Exp.T749=SalStrToNumber(si)/100
						Call F_LOAD_ANSWER_FULL(750,Row_, ni ,tbl_Exp.T750)
						! Set tbl2.T32=SalStrToDate(si)
						Set Row_=Row_+1
					!
					! ----------8 -----------------------------
					Set KRDN=SalStrToNumber(F_LOAD_ANSWER(805))
					Set PTI=SalStrToNumber(F_LOAD_ANSWER(821))
					!
						!
						!
						                                                If not F_FIX_ANSWER( 401, SalFmtFormatNumber (TK401, '0' ))
							                                                Return FALSE
						                                                If not F_FIX_ANSWER( 402, T402)
							                                                Return FALSE
						                                                If not F_FIX_ANSWER( 403, T403)
							                                                Return FALSE
						                                                If not F_FIX_ANSWER( 404, T404)
							                                                Return FALSE
						                                                If not F_FIX_ANSWER( 405, SalFmtFormatNumber (TK405, '0' ))
							                                                Return FALSE
						                                                If not F_FIX_ANSWER( 406, T406)
							                                                Return FALSE
						                                                If not F_FIX_ANSWER( 407, SalFmtFormatNumber (T407, '0' ))
							                                                Return FALSE
						                                                If not F_FIX_ANSWER( 408, SalFmtFormatNumber (T408, '0' ))
							                                                Return FALSE
						                                                If not F_FIX_ANSWER( 409, SalFmtFormatNumber (T409, '0' ))
							                                                Return FALSE
						                                                If not F_FIX_ANSWER( 410, SalFmtFormatNumber (TK410, '0' ))
							                                                Return FALSE
						!
						!
						! ---------------------------------- Доходы
						                                                Set nNewRow=TBL_MinRow
						                                                While SalTblFindNextRow( tbl_Dox, nNewRow, ROW_Edited, 0)
							                                                Call SalTblSetContext( tbl_Dox, nNewRow )
							                                                If not F_FIX_ANSWER( 600, tbl_Dox.T600)
								                                                Return FALSE
							                                                If not F_FIX_ANSWER( 601, SalFmtFormatNumber (tbl_Dox.TK601, '0' ))
								                                                Return FALSE
							                                                If not F_FIX_ANSWER( 610, SalFmtFormatNumber (tbl_Dox.TK610, '0' ))
								                                                Return FALSE
							                                                If not F_FIX_ANSWER( 611, SalFmtFormatNumber (tbl_Dox.T611, '0' ))
								                                                Return FALSE
							                                                If not F_FIX_ANSWER( 612, SalFmtFormatNumber (tbl_Dox.T612, '0' ))
								                                                Return FALSE
							                                                If not F_FIX_ANSWER( 613, SalFmtFormatNumber (tbl_Dox.T613, '0' ))
								                                                Return FALSE
							                                                If not F_FIX_ANSWER( 614, SalFmtFormatNumber (tbl_Dox.T614, '0' ))
								                                                Return FALSE
							                                                If not F_FIX_ANSWER( 615, SalFmtFormatNumber (tbl_Dox.T615, '0' ))
								                                                Return FALSE
							                                                If not F_FIX_ANSWER( 616, SalFmtFormatNumber (tbl_Dox.T616, '0' ))
								                                                Return FALSE
							                                                If not F_FIX_ANSWER( 616, SalFmtFormatNumber (tbl_Dox.T648, '0' ))
								                                                Return FALSE
							                                                If not F_FIX_ANSWER( 616, SalFmtFormatNumber (tbl_Dox.T649, '0' ))
								                                                Return FALSE
							                                                If not F_FIX_ANSWER( 650, tbl_Dox.T650)
								                                                Return FALSE
							! Call SqlPrepareAndExecute(hSql(),"INSERT INTO survey_qgrp(grp_number, grp_name, grp_ord, survey_id) VALUES(:Groups.grp_number,:Groups.grp_name,:Groups.grp_ord,:cursurv)")
						! ---------------------------------- Расходы
						                                                Set nNewRow=TBL_MinRow
						                                                While SalTblFindNextRow( tbl_Exp, nNewRow, ROW_Edited, 0)
							                                                Call SalTblSetContext( tbl_Exp, nNewRow )
							                                                If not F_FIX_ANSWER( 700, tbl_Exp.T700)
								                                                Return FALSE
							! If not F_FIX_ANSWER( 701, SalFmtFormatNumber (tbl_Dox.TK701, '0' ))
								                                                            Return FALSE
							                                                If not F_FIX_ANSWER( 710, SalFmtFormatNumber (tbl_Exp.TK710, '0' ))
								                                                Return FALSE
							                                                If not F_FIX_ANSWER( 711, SalFmtFormatNumber (tbl_Exp.T711, '0' ))
								                                                Return FALSE
							                                                If not F_FIX_ANSWER( 712, SalFmtFormatNumber (tbl_Exp.T712, '0' ))
								                                                Return FALSE
							                                                If not F_FIX_ANSWER( 713, SalFmtFormatNumber (tbl_Exp.T713, '0' ))
								                                                Return FALSE
							                                                If not F_FIX_ANSWER( 714, SalFmtFormatNumber (tbl_Exp.T714, '0' ))
								                                                Return FALSE
							                                                If not F_FIX_ANSWER( 715, SalFmtFormatNumber (tbl_Exp.T715, '0' ))
								                                                Return FALSE
							                                                If not F_FIX_ANSWER( 716, SalFmtFormatNumber (tbl_Exp.T716, '0' ))
								                                                Return FALSE
							                                                If not F_FIX_ANSWER( 715, SalFmtFormatNumber (tbl_Exp.T748, '0' ))
								                                                Return FALSE
							                                                If not F_FIX_ANSWER( 716, SalFmtFormatNumber (tbl_Exp.T749, '0' ))
								                                                Return FALSE
							                                                If not F_FIX_ANSWER( 750, tbl_Exp.T750)
								                                                Return FALSE
							! Call SqlPrepareAndExecute(hSql(),"INSERT INTO survey_qgrp(grp_number, grp_name, grp_ord, survey_id) VALUES(:Groups.grp_number,:Groups.grp_name,:Groups.grp_ord,:cursurv)")
					Set Row_=1
					Set nNewRow=TBL_MinRow
					If SqlPrepareAndExecute( hSql(),
							"SELECT substr(seb_sur.get_kol_pos(:SurveySessionID,808) ,1,200)  into :Count_row from dual ")
							and SqlFetchNext( hSql(), nFetchRes )
					! Call F_LOAD_ANSWER_FULL(30,Count_row, ni ,si)
					While Row_<=Count_row
						Set nNewRow=SalTblInsertRow(tbl_Mismatch, TBL_MaxRow)
						Call F_LOAD_ANSWER_FULL(808,Row_, ni ,tbl_Mismatch.T808)
						Call F_LOAD_ANSWER_FULL(809,Row_, ni ,si)
						Set tbl_Mismatch.T809=SalStrToNumber(si)/100
						! Set tbl2.T32=SalStrToDate(si)
						Set Row_=Row_+1
						Set T891=F_LOAD_ANSWER(891)
						Set T892=SalStrToNumber(F_LOAD_ANSWER(892))/100
					!
					Set T891=F_LOAD_ANSWER(891)
					Set T892=SalStrToNumber(F_LOAD_ANSWER(892))/100
					Call F_DISA('BUTTON',1)
					Return TRUE
			Function: F_POPULATE
				Description:
				Returns
				Parameters
					String: sTmp
				Static Variables
				Local variables
				Actions
					If SqlPrepareAndExecute( hSql(),
							"SELECT p.IR,p.MES,p.SMAX/100,p.PRK,p.METR90,p.MODE_GPK,
							     p.SURVEY,m.metr, m.name, p.BASEY, b.NAME, 
							     p.pawn, w.name, p.pti,smin/100,opt.opt_ord,opt.opt_val
							 INTO :dfPROC,:MES,:SMAX,:PRK,:METR90,:MODE_GPK,
							      :SURVEY,:METR90,:NAME90, :BASEY, :SBASEY,
							      :nPAWN, :sPAWN,:PTI_MAX,:Smin,:TK133,:T133
							 from CC_POTR p, int_metr m, SURVEY s, basey b, cc_pawn w,survey_answer_opt opt
							 WHERE p.basey=b.basey and s.SURVEY_ID=p.SURVEY
							   and p.METR90 = m.metr (+) and p.pawn = w.pawn (+) and p.mode_gpk=opt.opt_ord and opt.list_id=19
							   and  p.ID="||sTmp)
							and SqlFetchNext( hSql(), nFetchRes )
						Set YAR = MES/12
						Set NAME_GPK =
								IifS (MODE_GPK = 1, "Равними долями кредит",
								IifS (MODE_GPK = 2,"В кінці сроку","Рівними долями кредит з процентами"))
						! Заполнение
						Set nBasey=BASEY
						If SqlPrepareAndExecute( hSql(),
								  "SELECT y.Basey, y.name
								   INTO :nBasey,:cmbBasey
								   FROM Basey y
								   WHERE y.basey=:BASEY  " )
								and SqlFetchNext(hSql(), nFetchRes)
						If SqlPrepareAndExecute( hSql(),
								  "SELECT i.metr,i.name
								   INTO :nKOM,:cmbKom
								   FROM int_metr i
								   WHERE i.metr=:METR90 " )
								and SqlFetchNext(hSql(), nFetchRes)
						Set dfKOM=PRK
						! Окончание заполнения
						! Call cmb_TORG.Init(cmb_TORG)
						! Call cmb_TORG.Populate( hSql(),
								 "TORG_ID", "TORG_NAME", "V_CC_TOBO_TORG_POTR_SCHEME",
								" WHERE POTR_ID="||Str(TK150)||" ORDER BY TORG_ID " )
						! Set
						Call F_DISA('CREATE',1)
			Function: F_SUM
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					! If nKV != NUMBER_Null
						                                                                       If nKV = n980
							! Call SalHideWindow( nKV )
							! Call SalHideWindow( KURS )
							! Call SalHideWindow( PG_ )
						                                                                       Else
							                                                                       Call SalShowWindow( nKV )
							                                                                       Call SalShowWindow( KURS )
							                                                                       Call SalShowWindow( PG_ )
						                                                                       If SqlPrepareAndExecute( hSql(),
								"SELECT gl.p_icurval (:nKV, 1000000, :BankDate)/ 1000000 into :KURS from dual" )
								and NOT SqlFetchNext( hSql(), nFetchRes )
							                                                                       Return VALIDATE_Cancel
					!
					! If PV_ != NUMBER_Null
						                                                                       If PV_ <=0
							                                                                       Call SalMessageBox(" Початкова Сума кредиту <= 0",
									"Помилка ! ", MB_IconStop)
							                                                                       Set PV_ = NUMBER_Null
							                                                                       Return VALIDATE_Cancel
					!
					! If KURS != NUMBER_Null and PV_ != NUMBER_Null
						                                                                       Set PG_ = PV_ * KURS
						                                                                       If SMAX != NUMBER_Null and  PG_ > SMAX
							                                                                       Call SalMessageBox("Cума кредиту в грн більше максимально-допустимої "||Str(SMAX),
									"Помилка ! ", MB_IconStop)
							                                                                       Set PV_ = NUMBER_Null
							                                                                       Set PG_ = NUMBER_Null
							                                                                       Return VALIDATE_Cancel
					!
					Return VALIDATE_Ok
			Function: F_BDAT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If T15 != STRING_Null                 ! OKPO
						Set nTmp = 0
						If SqlPrepareAndExecute( hSql(),"
								select c.nmk,p.bday,c.rnk, 
								p.organ, p.pdate, p.ser, p.numdoc, p.teld,p.telw,c.adr
								into :T1,:T4,:RNK_KL,
								         :T12,:T13,:T10, :T11,:T21,:T25,:T20
								from customer c, person p where c.okpo = :T15 and c.rnk = p.rnk (+) " )
								and SqlFetchNext( hSql(), nFetchRes )
							!
							Call SalDisableWindow( T1)
							Call SalDisableWindow( T4)
						Else
							! Set dFIO =FIO_
							Set RNK_KL=-GetUserId()
							Call SalEnableWindow( T1)
							Call SalEnableWindow( T4)
						! If SqlPrepareAndExecute( hSql(),"select 1 into :nTmp from CC_Sec where okpo = :T15 " )
								and SqlFetchNext( hSql(), nFetchRes )
							! If nTmp = 1
								                                                                        Call SalMessageBox("Клієнт є НЕБАЖАНИМ ! ",
										"Служба безпеки ! ", MB_IconStop)
								                                                                        Set BDAT_ = DATETIME_Null
								                                                                        Set OKPO_ = STRING_Null
								                                                                        Set dFIO  = STRING_Null
								!
								! Call SalSendMsg( pb_F6, SAM_Click, 0, 0 )
					If T4 != DATETIME_Null          ! BDAT
						Set YAR_ = SalNumberRound( (SalDateCurrent( ) - T4 ) / 365 )
						If YAR_ < 16 or YAR_ > 90
							Call SalMessageBox("Нереальний вік позичальника - "||Str(YAR_ ),
									"Помилка ! ", MB_IconStop)
							Set YAR_ = NUMBER_Null
							Set T4 = DATETIME_Null
							Return VALIDATE_Cancel
						!
					If T15!= STRING_Null and T4 != DATETIME_Null
						If SqlPrepareAndExecute( hSql(),
								"select Substr(V_OKPO10(:T15,:T4),1,10) into :sTmp from dual" )
								and SqlFetchNext( hSql(), nFetchRes )
								and sTmp != T15
							Call SalMessageBox("Ід.код не відповідає даті народження ! ",
									"Помилка ! ", MB_IconStop)
							Set T15 = STRING_Null
							Return VALIDATE_Cancel
					!
					Return VALIDATE_Ok
			Function: F_WEB
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: strCompanyName
					String: strProductName
					String: strUrlPrefix
					String: strUrlFunction
					String: strIEXPLORE
				Actions
					Set strCompanyName = GetCompanyName( )
					Set strProductName = GetProductName( )
					Call SalUseRegistry( TRUE, strCompanyName )
					!
					! Адрес ВЕВ-сервера - strUrlPrefix = 'http://129.0.0.89'
					! Call SalGetProfileString(
							"Credit&Loans",
							"Web_Url",
							'http://129.0.0.89',
							 strUrlPrefix,
							 strProductName )
					Set strUrlPrefix = GetGlobalOption('UrlPref')
					! Адрес интернет-єксплорера  strIEXPLORE = "D:\\Progra~1\\Intern~1\\IEXPLORE.EXE"
					Call SalGetProfileString(
							"Credit&Loans",
							"IEXPLORE",
							"D:\\Progra~1\\Intern~1\\IEXPLORE.EXE",
							 strIEXPLORE,
							 strProductName )
					! Адрес веб-страницы АНКЕТЫ
					Set strUrlFunction = '/BarsWeb.Credit/New.aspx'
					Call SalLoadApp ( strIEXPLORE,  strUrlPrefix || strUrlFunction )
			Function: F_BDAT_POR
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If T65 != STRING_Null                 ! OKPO
						Set nTmp = 0
						Call F_DISA('POR',1)
						If SqlPrepareAndExecute( hSql(),"
								select c.nmk,p.bday,
								p.organ, p.pdate, p.ser, p.numdoc, p.teld,p.telw,c.adr
								into :T51,:T54,
								         :T62,:T63,:T60, :T61,:T71,:T75,:T70
								from customer c, person p where c.okpo = :T65 and c.rnk = p.rnk (+) " )
								and SqlFetchNext( hSql(), nFetchRes )
							!
							Call SalDisableWindow( T51)
							Call SalDisableWindow( T54)
						Else
							! Set dFIO =FIO_
							Call SalEnableWindow( T51)
							Call SalEnableWindow( T54)
					Else
						Call F_DISA('POR',0)
					If T54 != DATETIME_Null          ! BDAT
						Set YAR_ = SalNumberRound( (SalDateCurrent( ) - T4 ) / 365 )
						If YAR_ < 16 or YAR_ > 90
							Call SalMessageBox("Нереальний вік позичальника - "||Str(YAR_ ),
									"Помилка ! ", MB_IconStop)
							Set YAR_ = NUMBER_Null
							Set T4 = DATETIME_Null
							Return VALIDATE_Cancel
						!
					If T65!= STRING_Null and T54 != DATETIME_Null
						If SqlPrepareAndExecute( hSql(),
								"select Substr(V_OKPO10(:T65,:T54),1,10) into :sTmp from dual" )
								and SqlFetchNext( hSql(), nFetchRes )
								and sTmp != T65
							Call SalMessageBox("Ід.код не відповідає даті народження ! ",
									"Помилка ! ", MB_IconStop)
							Set T65 = STRING_Null
							Return VALIDATE_Cancel
					!
					Return VALIDATE_Ok
			!
			Function: F_FIX_ANSWER
				Description:
				Returns
					Boolean:
				Parameters
					Number: QuestID_
					String: Str_
				Static Variables
				Local variables
					String: Quest_name
				Actions
					! все ОК
					If SqlPLSQLCommand( hSql(), "Seb_Sur.fix_answer_p2 (SurveySessionID,QuestID_,0,Str_)" )
						Return TRUE
					Else
						If SqlPrepareAndExecute( hSql(),  "SELECT quest_name into  :Quest_name from survey_quest 
								                                                                         where survey_id=1 and quest_id_p=:QuestID_ and rownum=1" )
								                                                                        and SqlFetchNext(hSql(), nFetchRes)
							Call MessageNoWait('Не удалось сохранить ворос № '||SalFmtFormatNumber (QuestID_, '0' )||'- '||Quest_name||' значение =  ' ||Str_,SalFmtFormatNumber (QuestID_, '0' ), 0, 1)
							Return FALSE
						Else
							Call MessageNoWait('В базе методанных survey_quest не описан вопрос № '||SalFmtFormatNumber (QuestID_, '0' ),SalFmtFormatNumber (QuestID_, '0' ) , 0, 1)
							Return FALSE
			Function: F_LOAD_ANSWER
				Description:
				Returns
					String:
				Parameters
					Number: QuestID_
				Static Variables
				Local variables
					String: Str_
				Actions
					If SqlPrepareAndExecute( hSql(),
							"SELECT substr(seb_sur.get_value(:SurveySessionID,:QuestID_) ,1,200)  into :Str_ from dual ")
							and SqlFetchNext( hSql(), nFetchRes )
					Return Str_
			Function: F_LOAD_ANSWER_KOD
				Description:
				Returns
					Boolean:
				Parameters
					Number: QuestID_
					Receive Number: KOD_
					Receive String: Str_
				Static Variables
				Local variables
				Actions
					If SqlPLSQLCommand( hSql(), "Seb_Sur.get_val (SurveySessionID,QuestID_,1,KOD_,Str_)" )
						! Call MessageNoWait(Str(KOD_), 'In - '||Str_, 0, 1)
						Return TRUE
					Return FALSE
			Function: F_LOAD_ANSWER_FULL
				Description:
				Returns
					Boolean:
				Parameters
					Number: QuestID_
					Number: POS_
					Receive Number: KOD_
					Receive String: Str_
				Static Variables
				Local variables
				Actions
					If SqlPLSQLCommand( hSql(), "Seb_Sur.get_val (SurveySessionID,QuestID_,POS_,KOD_,Str_)" )
						! Call MessageNoWait(Str(KOD_), 'In - '||Str_, 0, 1)
						Return TRUE
					Return FALSE
			Function: F_LOAD_COMMENT
				Description:
				Returns
					String:
				Parameters
					Number: ID_
				Static Variables
				Local variables
					String: Str_
				Actions
					If SqlPrepareAndExecute( hSql(),
							"SELECT quest_name INTO :Str_  from survey_quest WHERE rownum=1 and quest_id_p=:ID_ ")
							and SqlFetchNext( hSql(), nFetchRes )
					Return Str_
			Function: F_SCOR
				Description:
				Returns
					Boolean:
				Parameters
					Number: SurveySessionID
				Static Variables
				Local variables
				Actions
					! If SqlPrepareAndExecute( hSql(),
							"SELECT seb_sur.execute_scoring(:SurveySessionID)  INTO :KRDN from dual")
							and SqlFetchNext( hSql(), nFetchRes )
					Call SalWaitCursor ( TRUE )
					If nPar=0 
						If F_RUN()
							! Call MessageNoWait('Сохранена анкета, реф='|| Str(SurveySessionID),'Сообщение',3,0)
							Call SqlCommit(hSql())
							If SqlPLSQLCommand(hSql(), "seb_sur.execute_scoring(SurveySessionID)" )
								Call SqlCommit ( hSql() )
								Call All_Null()
								Call F_LOAD(0)
								Return TRUE
							Else
								Call SqlRollback( hSql() )
								Return FALSE
						Else
							Call SqlRollback(hSql())
							Call SalWaitCursor ( FALSE )
							Call MessageNoWait('Неуспешное сохранение анкеты', 'Ошибка', 0, 1)
						If SqlPLSQLCommand(hSql(), "seb_sur.execute_scoring(SurveySessionID)" )
							Call SqlCommit ( hSql() )
							Call All_Null()
							Call F_LOAD(0)
							Return TRUE
						Else
							Call SqlRollback( hSql() )
							Return FALSE
					Call SalWaitCursor ( FALSE )
			Function: Opt_to_Ord
				Description:
				Returns
					Number:
				Parameters
					Number: ID_
				Static Variables
				Local variables
					Number: Ord_
				Actions
					If SqlPrepareAndExecute( hSql(),
							"SELECT opt_ord INTO :Ord_  from survey_answer_opt  WHERE opt_id=:ID_ ")
							and SqlFetchNext( hSql(), nFetchRes )
					Return Ord_
			Function: F_SCOR_EXEL
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					: excel
						Class: cReportConstructor
					String: pShablon
					String: strFa
					Number: ni
					String: si
					Number: a303
					Number: a502
					String: S_
				Actions
					Set pShablon = GetTemplateDir() || "\\" || "seb_scoring_auto.xls"
					Set strFa = GetPrnDir() || "\\seb_scoring_auto_" || Str(SurveySessionID)||".XLS"
					Call VisFileSetAttribute( strFa, FA_ReadOnly, FALSE )
					Call VisFileDelete(strFa)
					If VisFileCopy( pShablon, strFa )<0
						Call MessageNoWait( 'Не удалось найти файл - '||pShablon||' или скопировать его в папку - '||strFa,'Ошибка',10,0)
						Return FALSE
					! ! говорим что хотим работать с Excel
					Set excel.nTargetApp = atExcel
					If excel.OpenApplication()
						Call excel.LoadDoc( strFa )
						!
						Call excel.SetTableCell(6,9,F_LOAD_ANSWER(1) ) 
						Call excel.SetTableCell(6,10,F_LOAD_ANSWER(15) ) 
						Call excel.SetTableCell(6,11,Str(RNK_KL) ) 
						!
						Call F_LOAD_ANSWER_FULL(801,1,ni,si)
						Call excel.SetTableCell(3,16,si ) 
						Call F_LOAD_ANSWER_FULL(802,1,ni,si)
						Call excel.SetTableCell(4,16,si ) 
						Call F_LOAD_ANSWER_FULL(803,1,ni,si)
						Call excel.SetTableCell(5,16,si ) 
						Call F_LOAD_ANSWER_FULL(801,2,ni,si)
						Call excel.SetTableCell(3,17,si ) 
						Call F_LOAD_ANSWER_FULL(802,2,ni,si)
						Call excel.SetTableCell(4,17,si ) 
						Call F_LOAD_ANSWER_FULL(803,2,ni,si)
						Call excel.SetTableCell(5,17,si ) 
						Call F_LOAD_ANSWER_FULL(801,3,ni,si)
						Call excel.SetTableCell(3,18,si ) 
						Call F_LOAD_ANSWER_FULL(802,3,ni,si)
						Call excel.SetTableCell(4,18,si ) 
						Call F_LOAD_ANSWER_FULL(803,3,ni,si)
						Call excel.SetTableCell(5,18,si ) 
						Call F_LOAD_ANSWER_FULL(801,4,ni,si)
						Call excel.SetTableCell(3,19,si ) 
						Call F_LOAD_ANSWER_FULL(802,4,ni,si)
						Call excel.SetTableCell(4,19,si ) 
						Call F_LOAD_ANSWER_FULL(803,4,ni,si)
						Call excel.SetTableCell(5,19,si ) 
						!
						Call F_LOAD_ANSWER_FULL(801,5,ni,si)
						Call excel.SetTableCell(3,22,si ) 
						Call F_LOAD_ANSWER_FULL(802,5,ni,si)
						Call excel.SetTableCell(4,22,si ) 
						Call F_LOAD_ANSWER_FULL(803,5,ni,si)
						Call excel.SetTableCell(5,22,si ) 
						Call F_LOAD_ANSWER_FULL(801,6,ni,si)
						Call excel.SetTableCell(3,23,si ) 
						Call F_LOAD_ANSWER_FULL(802,6,ni,si)
						Call excel.SetTableCell(4,23,si ) 
						Call F_LOAD_ANSWER_FULL(803,6,ni,si)
						Call excel.SetTableCell(5,23,si ) 
						Call F_LOAD_ANSWER_FULL(801,7,ni,si)
						Call excel.SetTableCell(3,24,si ) 
						Call F_LOAD_ANSWER_FULL(802,7,ni,si)
						Call excel.SetTableCell(4,24,si ) 
						Call F_LOAD_ANSWER_FULL(803,7,ni,si)
						Call excel.SetTableCell(5,24,si ) 
						!
						Call F_LOAD_ANSWER_FULL(801,8,ni,si)
						Call excel.SetTableCell(3,27,si ) 
						Call F_LOAD_ANSWER_FULL(802,8,ni,si)
						Call excel.SetTableCell(4,27,si ) 
						Call F_LOAD_ANSWER_FULL(803,8,ni,si)
						Call excel.SetTableCell(5,27,si ) 
						Call F_LOAD_ANSWER_FULL(801,9,ni,si)
						Call excel.SetTableCell(3,28,si ) 
						Call F_LOAD_ANSWER_FULL(802,9,ni,si)
						Call excel.SetTableCell(4,28,si ) 
						Call F_LOAD_ANSWER_FULL(803,9,ni,si)
						Call excel.SetTableCell(5,28,si ) 
						!
						!
						Call F_LOAD_ANSWER_FULL(805,1,ni,si)
						Call excel.SetTableCell(6,30,si ) 
						!
						!
						!
						Call F_LOAD_ANSWER_FULL(805,1,ni,si)
						Call excel.SetTableCell(6,30,si ) 
						!
						!
						! обеспечение
						! -1
						If SqlPrepareAndExecute( hSql(),
								  "select 
								nvl((
								     select sum(to_number(a304.answer_char))  
								     from survey_answer a304
								     where  a304.session_id=:SurveySessionID
								     and a304.quest_id_p=304
								    ),
								    nvl(
								    (select sum(to_number(a303.answer_char))  
								     from survey_answer a303
								     where  a303.session_id=:SurveySessionID
								     and a303.quest_id_p=303
								    ),0)
								   ) 
								INTO :a303
								from dual")
								and SqlFetchNext(hSql(), nFetchRes) 
						!
						!
						! стоимость кредита
						! Set S_=SalStrToNumber(F_LOAD_ANSWER(102))
						! Call MessageNoWait(F_LOAD_ANSWER(102), 'Open Session', 0, 1)
						Set S_='='||F_LOAD_ANSWER(102)||'/'||SalFmtFormatNumber(a303,'0')
						Call excel.SetTableCell(6,35,S_ ) 
						!
						! -2 ----------------------------------------------------------------------------------------
						If SqlPrepareAndExecute( hSql(),
								  "select sum(a) into :a502 from
								(
								  select 
								   (select to_number(nvl(seb_sur.get_valueN(sa.session_id,502,answer_pos),'0'))from dual) a, 
								   (select to_number(nvl(seb_sur.get_valueN(sa.session_id,503,answer_pos),'0'))from dual) b
								   from survey_answer sa where sa.session_id=129 and sa.quest_id_p=510 and sa.answer_opt=146
								)
								where b>0   ")
								and SqlFetchNext(hSql(), nFetchRes) 
						Set S_='='||'('||SalFmtFormatNumber (SalStrToNumber(F_LOAD_ANSWER(820)),'0') ||'+'||SalFmtFormatNumber(a502,'0')||')/'||F_LOAD_ANSWER(810)
						Call excel.SetTableCell(6,36,S_ ) 
						! -3 ----------------------------------------------------------------------------------------
						!
						!
						Set S_='='||F_LOAD_ANSWER(815)||'/'||F_LOAD_ANSWER(810)
						Call excel.SetTableCell(6,37,S_ ) 
						!
						!
						Set ni=GetUserId()
						If SqlPrepareAndExecute( hSql(),
								  "select fio into :si from staff where id=:ni ")
								and SqlFetchNext(hSql(), nFetchRes) 
							Call excel.SetTableCell(3,41,si ) 
						!
						Call excel.ShowApplication()
						! If SqlPrepareAndExecute( hSql(),
								"select seb_sur.get_value(: Into :FDAT_,:SUMO_,:SUMG_ from cc_lim where nd=:dfND order by fdat" )
			Function: F_SCOR_PTI_EXEL
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					: excel
						Class: cReportConstructor
					String: pShablon
					String: strFa
					Number: ni
					String: si
					Number: i
					Number: row_n
					String: name
					String: m1
					String: m2
					String: m3
					String: m4
					String: m5
					String: m6
					String: msr
					String: mprg
				Actions
					Set pShablon = GetTemplateDir() || "\\" || "seb_pti.xls"
					Set strFa = GetPrnDir() || "\\seb_pti_" || Str(SurveySessionID)||".XLS"
					Call VisFileSetAttribute( strFa, FA_ReadOnly, FALSE )
					Call VisFileDelete(strFa)
					If VisFileCopy( pShablon, strFa )<0
						Call MessageNoWait( 'Не удалось найти файл - '||pShablon||' или скопировать его в папку - '||strFa,'Ошибка',10,0)
						Return FALSE
					! ! говорим что хотим работать с Excel
					Set excel.nTargetApp = atExcel
					If excel.OpenApplication()
						Call excel.LoadDoc( strFa )
						!
						If SqlPrepareAndExecute( hSql(),
								"select row_n,name, m1,m2,m3,m4,m5,m6,msr,mprg
								       into :row_n,:name, :m1,:m2,:m3,:m4,:m5,:m6,:msr,:mprg
								from
								(
								select -2 row_n, null name,
								(select name_rus from meta_month where n=(to_char(add_months(session_date,-6),'mm')))m1, 
								(select name_rus from meta_month where n=(to_char(add_months(session_date,-5),'mm')))m2,
								(select name_rus from meta_month where n=(to_char(add_months(session_date,-4),'mm')))m3,
								(select name_rus from meta_month where n=(to_char(add_months(session_date,-3),'mm')))m4,
								(select name_rus from meta_month where n=(to_char(add_months(session_date,-2),'mm')))m5,
								(select name_rus from meta_month where n=(to_char(add_months(session_date,-1),'mm')))m6,
								'Среднее' msr,
								'Прогноз' mprg,
								session_id
								from survey_session where session_id=:SurveySessionID     
								union       
								select -1 row_n,'Подтвержденные доходы' name1,
								          to_char(sum(decode(quest_id_p,611,answer_numb,0))/100) m1,
								          to_char(sum(decode(quest_id_p,612,answer_numb,0))/100) m2,
								          to_char(sum(decode(quest_id_p,613,answer_numb,0))/100) m3,
								          to_char(sum(decode(quest_id_p,614,answer_numb,0))/100) m4,
								          to_char(sum(decode(quest_id_p,615,answer_numb,0))/100) m5,
								          to_char(sum(decode(quest_id_p,616,answer_numb,0))/100) m6,
								          to_char(sum(decode(quest_id_p,648,answer_numb,0))/100) msr,
								          to_char(sum(decode(quest_id_p,649,answer_numb,0))/100) mprg,
								          max(session_id)               
								         from survey_answer s
								         where  s.session_id =:SurveySessionID and s.quest_id_p in (611,612,613,614,615,616,648,649) and 
								         s.answer_pos in (select s2.answer_pos 
								                                from survey_answer  s2 
								                                where s2.session_id=s.session_id and s2.quest_id_p=600 and answer_numb=1) 
								  union
								     select 0 row_n,'Неподтвержденный доход' Name1, 
								          to_char(sum(decode(quest_id_p,611,answer_numb,0))/100),
								          to_char(sum(decode(quest_id_p,612,answer_numb,0))/100),
								          to_char(sum(decode(quest_id_p,613,answer_numb,0))/100),
								          to_char(sum(decode(quest_id_p,614,answer_numb,0))/100),
								          to_char(sum(decode(quest_id_p,615,answer_numb,0))/100),
								          to_char(sum(decode(quest_id_p,616,answer_numb,0))/100),
								          to_char(sum(decode(quest_id_p,648,answer_numb,0))/100),
								          to_char(sum(decode(quest_id_p,649,answer_numb,0))/100),
								          max(session_id)
								         from survey_answer s
								         where  s.session_id =:SurveySessionID and s.quest_id_p in (611,612,613,614,615,616,648,649) and 
								         s.answer_pos in (select s2.answer_pos 
								                                from survey_answer  s2 
								                                where s2.session_id=s.session_id and s2.quest_id_p=600 and answer_numb=0) 
								union
								select row_n, nvl(to_char(name2),o.opt_val),to_char(m1),to_char(m2),to_char(m3),
								      to_char(m4),to_char(m5),to_char(m6),
								      to_char(msr),to_char(mprg),session_id
								from
								 (select max(s.answer_pos) row_n, 
								          max(decode(quest_id_p,710,answer_opt,'0')) name1,
								          max(decode(quest_id_p,750,answer_char,null)) name2,
								          sum(decode(quest_id_p,711,answer_numb,0))/100 m1,
								          sum(decode(quest_id_p,712,answer_numb,0))/100 m2,
								          sum(decode(quest_id_p,713,answer_numb,0))/100 m3,
								          sum(decode(quest_id_p,714,answer_numb,0))/100 m4,
								          sum(decode(quest_id_p,715,answer_numb,0))/100 m5,
								          sum(decode(quest_id_p,716,answer_numb,0))/100 m6,
								          sum(decode(quest_id_p,748,answer_numb,0))/100 msr,
								          sum(decode(quest_id_p,749,answer_numb,0))/100 mprg,
								          max(session_id)session_id                
								         from survey_answer s
								         where  s.session_id =:SurveySessionID and s.quest_id_p in (711,712,713,714,715,716,748,749,710,750)
								
								         group by s.answer_pos                        
								 )a,survey_answer_opt o
								 where o.opt_id=a.name1
								) order by row_n" )
							While SqlFetchNext( hSql(), nFetchRes) 
								! into :row_n,:name, :m1,:m2,:m3,:m4,:m5,:m6,:msr,:mprg
								If row_n=-2 
									Call excel.SetTableCell(3,3,m1 ) 
									Call excel.SetTableCell(4,3,m2 ) 
									Call excel.SetTableCell(5,3,m3 ) 
									Call excel.SetTableCell(6,3,m4 ) 
									Call excel.SetTableCell(7,3,m5 ) 
									Call excel.SetTableCell(8,3,m6 ) 
								If row_n=-1 or row_n=0
									Call excel.SetTableCell(3,row_n+7,m1 ) 
									Call excel.SetTableCell(4,row_n+7,m2 ) 
									Call excel.SetTableCell(5,row_n+7,m3 ) 
									Call excel.SetTableCell(6,row_n+7,m4 ) 
									Call excel.SetTableCell(7,row_n+7,m5 ) 
									Call excel.SetTableCell(8,row_n+7,m6 ) 
									Call excel.SetTableCell(9,row_n+7,msr ) 
									Call excel.SetTableCell(10,row_n+7,mprg ) 
								If row_n>0
									Call excel.SetTableCell(2,row_n+11,name ) 
									Call excel.SetTableCell(3,row_n+11,m1 ) 
									Call excel.SetTableCell(4,row_n+11,m2 ) 
									Call excel.SetTableCell(5,row_n+11,m3 ) 
									Call excel.SetTableCell(6,row_n+11,m4 ) 
									Call excel.SetTableCell(7,row_n+11,m5 ) 
									Call excel.SetTableCell(8,row_n+11,m6 ) 
									Call excel.SetTableCell(9,row_n+11,msr ) 
									Call excel.SetTableCell(10,row_n+11,mprg ) 
						!
						Call excel.SetTableCell(3,1,F_LOAD_ANSWER(1) ) 
						Call excel.SetTableCell(3,2,SalFmtFormatDateTime(Session_Date,'dd/MM/yyyy') ) 
						!
						! Call F_LOAD_ANSWER_FULL(801,1,ni,si)
						! Call excel.SetTableCell(3,16,si ) 
						!
						!
						Call excel.SetTableCell(6,35,SalFmtFormatNumber (SalStrToNumber(F_LOAD_ANSWER(123))/100,'0.0000') ) 
						Call excel.SetTableCell(7,35,SalFmtFormatNumber (SalStrToNumber(F_LOAD_ANSWER(819))/100,'0.0000') ) 
						Call excel.SetTableCell(9,35,SalFmtFormatNumber (SalStrToNumber(F_LOAD_ANSWER(820))/100,'0.0000') ) 
						!
						Call excel.SetTableCell(8,39,SalFmtFormatNumber (PTI_MAX/100,'0.00') ) 
						Call excel.SetTableCell(8,40,SalFmtFormatNumber (SalStrToNumber(F_LOAD_ANSWER(823))/100,'0.0000') ) 
						!
						!
						Call excel.ShowApplication()
						! If SqlPrepareAndExecute( hSql(),
								"select seb_sur.get_value(: Into :FDAT_,:SUMO_,:SUMG_ from cc_lim where nd=:dfND order by fdat" )
			Function: All_Null
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalTblReset(tbl_Dox)
					Call SalTblReset(tbl_Exp)
					Call SalTblReset(tbl_Dox)
					Call SalTblReset(tbl_Capital)
					Call SalTblReset(tbl_History)
					Call SalTblReset(tbl_Mismatch)
					Call SalTblReset(tbl2)
					Call SalTblReset(tbl_Emp)
					Set T1=STRING_Null
					Set T4=DATETIME_Null
					Set T5=STRING_Null
					Set T11=STRING_Null
					Set T10=STRING_Null
					Set T12=STRING_Null
					Set T13=DATETIME_Null
					Set T15=STRING_Null
					Set T20=STRING_Null
					Set T21=STRING_Null
					Set T22=STRING_Null
					Set TK22=NUMBER_Null
					Set T23=STRING_Null
					Set T24=STRING_Null
					Set T25=STRING_Null
					Set T26=STRING_Null
					Set T27=STRING_Null
					Set TK27=NUMBER_Null
					Set TK28=NUMBER_Null
					Set TK29=NUMBER_Null
					Set T51=STRING_Null
					Set T54=DATETIME_Null
					Set T55=STRING_Null
					Set T61=STRING_Null
					Set T60=STRING_Null
					Set T62=STRING_Null
					Set T63=DATETIME_Null
					Set T65=STRING_Null
					Set T70=STRING_Null
					Set T71=STRING_Null
					Set T72=STRING_Null
					Set TK72=NUMBER_Null
					Set T73=STRING_Null
					Set T74=STRING_Null
					Set T75=STRING_Null
					Set T76=STRING_Null
					Set T77=STRING_Null
					Set TK77=NUMBER_Null
					Set TK78=NUMBER_Null
					Set TK79=NUMBER_Null
					Set T891=''
					Set T892=NUMBER_Null
					Set KRDN=NUMBER_Null
					!
					!
					!
					Set V401=STRING_Null
					Set VK401=NUMBER_Null
					Set V402=STRING_Null
					Set V403=STRING_Null
					Set V404=NUMBER_Null
					Set V405=STRING_Null
					Set VK405=NUMBER_Null
					Set V406=STRING_Null
					Set V407=NUMBER_Null
					Set V408=NUMBER_Null
					Set V409=NUMBER_Null
					Set V410=STRING_Null
					Set VK410=NUMBER_Null
					!
					!
					Set ml_error=STRING_Null
					! Call VisWinClearAllEditFlags (hWndForm)
		Window Parameters
			Number: nMode ! 297
			Number: nPar  ! = 0 Редакт, >0 без редакт
			String: sPar1 !
			String: sPar2 !
		Window Variables
			String: sDecimal2  ! симв десятичной точки alt
			String: sDecimal   ! симв десятичной точки
			String: sTmp
			String: NLS_1002
			Number: nTmp
			Number: n980
			String: BankMfo
			Date/Time: BankDate
			Number: nSecond
			Number: nCount
			Number: nColR
			Number: nColG
			!
			Number: nRAB
			Number: nRANG
			Number: nOSVITA
			Number: nIST
			Number: nDEP
			Number: nTORG
			Number: nNewRow
			Number: TK22
			Number: TK27
			Number: TK28
			Number: TK29
			Number: TK72
			Number: TK77
			Number: TK78
			Number: TK79
			Number: TK133
			Number: VK401
			Number: VK405
			Number: VK410
			Number: SurveyID
			Boolean: SurveySessionID_Null
			! --------------------------
			String: sNSMEP
			String: sTmpM
			String: CC_INIC
			Number: nKV
			Number: CC_BASEY
			Number: nKOM  ! Выбранный Метод комиссии
			Number: nFREQ
			Number: nBasey
			Number: nFREQP
			Number: nVID
			Number: nISTO
			Number: nCEL
			Boolean: bTmp
			Long String: sAIM
			Boolean: FirstOpen
		Message Actions
			On SAM_Create
				Set n980 = GetBaseVal()
				Set sDecimal =SalStrMidX(SalNumberToStrX(1.1,1),1,1)
				Set sDecimal2 = IifS ( sDecimal = '.', ',', '.' )
				Set BankMfo =  GetBankMfo()
				Set BankDate = GetBankDate()
				Set RNK_KL = - GetUserId()
				Set SurveyID=1
				Set nColG = COLOR_LightGreen
				! Set nColR = SalColorGet ( KRDS_, COLOR_IndexWindow )
				Set FirstOpen=TRUE
				Set SurveySessionID_Null=FALSE
				! Set n16 = GetGlobalOptionEx('CC_YAR1')
				! Set n90 = GetGlobalOptionEx('CC_YAR2')
				If SqlPrepareAndExecute( hSqlAux(),
						"select val into :ASG_SN from params where par='ASG-SN' ")
						 and not SqlFetchNext( hSqlAux(), nFetchRes)
					Set ASG_SN = '*'
				Set CC_GPK = GetGlobalOption('CC_GPK')
				If nHaveTOBO = 2
					Set nSecond= GetGlobalOptionEx('CCK_1S') ! Cек.ожидания проверки отв на запрос-1
					Set nCount = GetGlobalOptionEx('CCK_1C') ! Кол-во итераций проверки отв на запрос-1
					Set sTmp = "tobopack.GetToboCASH"
				Else
					Set sTmp = "pul.Get_Mas_Ini_Val('CASH')"
				If SqlPrepareAndExecute( hSql(),
						"SELECT substr(" || sTmp || ",1,14) INTO :NLS_1002 from dual ")
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Call SalMessageBox('Не определен счет кассы ', "Ошибки в настройках ! ", MB_IconStop)
					Call SalDestroyWindow(hWndForm)
				! Call F_NULL()
				Call SalMapEnterToTab( TRUE )
				Set DAT1 = GetBankDate()
				Set DAT2 = DAT1
				Set DAT3 = DAT1
				Set DAT4 = AddMonths( DAT1, 12 ) - 1
				!
				If nPar >0 
					Call F_DISA('CREATE',1)
					Call F_LOAD(0)
				Else
					Call F_DISA('CREATE',0)
				!
			On UM_Delete
				Set nNewRow = TBL_MinRow
				While SalTblFindNextRow(hWndForm, nNewRow, ROW_Selected, 0)
					If NOT SalTblQueryRowFlags(hWndForm, nNewRow, ROW_New)
						Call SalTblSetRowFlags(hWndForm, nNewRow, ROW_MarkDeleted, not SalTblQueryRowFlags(hWndForm, nNewRow, ROW_MarkDeleted))
					Else
						Call SalTblDeleteRow(hWndForm, nNewRow, TBL_NoAdjust)
	Table Window: SEB1
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Контроль анкет потенциальных заемщиков
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.275"
				Top:    0.344"
				Width:  16.7"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29406
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29407
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 29408
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: SESSION_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № пп
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.883"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: USER_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кто
						ввел
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.633"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Подразде
						ление
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.383"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SESSION_DATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата-время
						ввода
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.967"
				Width Editable? Yes
				Format: DateTime
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FIO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ФИО заемщика
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: OTM_0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отм
						Безопасность
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.317"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OTM_1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отм
						Юрист
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.167"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OTM_2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отм
						Обеспечение
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.283"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OTM_3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отм
						Аналитик
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.217"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OTM_5
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отм
						Бизнес
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.233"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OTM_4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отм
						Кредитчик
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.233"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: DAT_0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отм
						Безопасность
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT_1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отм
						Юрист
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT_2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отм
						Залоговик
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT_3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отм
						Аналитик
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT_5
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отм
						Бизнес
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.817"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT_4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отм
						Кредитчик
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.817"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_Col
				Description:
				Returns
				Parameters
					String: sOtm
					Window Handle: wOtm
				Static Variables
				Local variables
				Actions
					If sOtm = '0'
						Call XSalTblSetCellBackColor( wOtm, SalColorFromRGB( 255,210,210 ) )
						! Set wOtm = '+'
					Else If sOtm = '1'
						Call XSalTblSetCellBackColor( wOtm, COLOR_LightGreen )
						! Set wOtm = '-'
					Else If sOtm = '2'
						Call XSalTblSetCellBackColor( wOtm, COLOR_Sky )
						! Set wOtm = '-'
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			String: sOTM[10]
			! String: sWhere
			Number: nUser
		Message Actions
			On SAM_Create
				Set sOTM[0] = "Безопасность"
				Set sOTM[1] = "Юрист"
				Set sOTM[2] = "Залоговик"
				Set sOTM[3] = "Аналитик"
				Set sOTM[4] = "Кредитчик"
				Set sOTM[9] = "Архив"
				Call SalSetWindowText( hWndForm,sOTM[nPar]||": Контроль анкет потенциальных заемщиков" )
				Set SEB1.nTabInstance = 1
				Set SEB1.strFilterTblName = 'V_ZAG_SUR'
				Set SEB1.strPrintFileName = 'SEB_'||Str(nPar)
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns( hWndForm, 5 )
				Set nUser = GetUserId()
				!
				Set SEB1.strSqlPopulate =
						"select SESSION_ID,USER_ID,BRANCH,SESSION_DATE, FIO,   
						   OTM_0,OTM_1,OTM_2,OTM_3,OTM_4,OTM_5,
						   DAT_0,DAT_1,DAT_2,DAT_3,DAT_4,DAT_5
						 into :SEB1.SESSION_ID,:SEB1.USER_ID,:SEB1.BRANCH,:SEB1.SESSION_DATE,
						      :SEB1.FIO,
						      :SEB1.OTM_0,:SEB1.OTM_1,:SEB1.OTM_2,:SEB1.OTM_3,:SEB1.OTM_4,:SEB1.OTM_5,
						      :SEB1.DAT_0,:SEB1.DAT_1,:SEB1.DAT_2,:SEB1.DAT_3,:SEB1.DAT_4,:SEB1.DAT_5 
						 from V_ZAG_SUR where " ||
						IifS(SEB1.nPar < 4 OR SEB1.nPar =5," COMPLETED = 2 ",
						IifS(SEB1.nPar = 4," COMPLETED in (2,5)
						 and DAT_0 is not null and DAT_1 is not null and DAT_2 is not null 
						 and DAT_3 is not null and DAT_5 is not null
						",
						" COMPLETED >=2 " )) ||
						" order by  SESSION_ID desc "
				Call SalSendClassMessage(SAM_Create, 0, 0)
				! 901 - отметка безопасности
				! 902 - комментарий безопасности
				! 903 - дата безопасности
				! 904 - Юзер безопасности
				!
				! 911 - отметка юриста
				! 912 - комментарий юриста
				! 913 - дата юриста
				! 914 - Юзер юриста
				!
				! 921 - отметка обеспечение
				! 922 - комментарий обеспечение
				! 923 - дата обеспечение
				! 924 - Юзер обеспечение
				!
				! 931 - отметка аналитика
				! 932 - комментарий аналитика
				! 933 - дата аналитика
				! 934 - Юзер аналитика
				!
				! 941 - отметка кредитчика
				! 942 - комментарий кредитчика
				! 943 - дата кредитчика
				! 944 - Юзер кредитчика
				!
			! On SAM_CreateComplete
			On SAM_FetchRowDone
				Call F_Col(OTM_0,DAT_0)
				Call F_Col(OTM_1,DAT_1)
				Call F_Col(OTM_2,DAT_2)
				Call F_Col(OTM_3,DAT_3)
				Call F_Col(OTM_4,DAT_4)
				Call F_Col(OTM_5,DAT_5)
			On SAM_DoubleClick
				Call SalCreateWindow( SEB2, hWndMDI,
						SESSION_ID,nPar, FIO, sOTM[nPar], OTM_0, OTM_1, OTM_2, OTM_3, OTM_4, OTM_5  )
			! On SAM_TblDoDetails
				                                              Call SalCreateWindow( SEB2, hWndParent,SESSION_ID,nPar, FIO, sOTM[nPar] )
	Table Window: SEB2
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Визирование анкеты
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.275"
				Top:    0.344"
				Width:  14.017"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.512"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7739
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Просмотр аккеты в формате первичного ввода'
						On SAM_Click
							Call Sel037(hWndMDI,31,nSID," "," ")
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7740
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7741
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pb_Visa
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\EDIT_X.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: White
					Message Actions
						On SAM_Create
							If nPar = 9
									OR nPar = 0 and OTM_0 != STRING_Null
									OR nPar = 1 and OTM_1 != STRING_Null
									OR nPar = 2 and OTM_2 != STRING_Null
									OR nPar = 3 and OTM_3 != STRING_Null
									OR nPar = 4 and OTM_4 != STRING_Null
								Call SalDisableWindow( pb_Visa )
							Else
								Set strTip = 'Отметка специалиста <'||strPar02||'>'
						On SAM_Click
							If nPar < 9
								Set sNazn = 'Здесь д.б. комментарии специалиста <'||strPar02||'>'
								If SalModalDialog(dlg_SEB, hWndForm,nPar,sNazn, nOtm, OTM_0, OTM_1, OTM_2, OTM_3, OTM_4, OTM_5 )
									! Call Debug('aa')
									If F_Otm()
										If SqlCommit( hSql() )
											Call MessageNoWait(
													'Виза <'||strPar02||'> на анкету № '||Str(nSID), 'Сообщение',2,0)
									Else
										Call SqlRollback( hSql() )
				Pushbutton: pb_Doc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Tomail.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: White
					Message Actions
						On SAM_Create
							Set strTip = 'Печать документов по шаблону'
						On SAM_Click
							Call Print_RTF ()
				Pushbutton: pb_Zalog
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Pach.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Спецификация залога'
						On SAM_Click
							Call Sel037(hWndMDI,33, nSID, Str(nPar),  FIO )
		Contents
			Column: GRP_ORD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № п/п
						группы
						вопросов
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.067"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: GRP_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						группы
						вопроса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.683"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: QUEST_ORD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № п/п
						вопроса
						в группе
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.033"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: QUEST_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Текст
						вопроса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.683"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ANSWER_ORD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № п/п
						ответа
						на вопрос
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.267"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ANSWER_VALUE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Текст
						 ответа
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  5.25"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: QUEST_ID_P
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						вопроса
						в группе
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.033"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_Otm
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: n1
					Number: n2
					Number: n3
					Number: n4
					String: s1
					String: s2
					String: s3
					String: s4
					String: Soob
					Number: nN
					! Number: nComp
				Actions
					Set nN = NUMBER_Null
					! Call DebugN(nPar)
					! 9n1 - отметка
					Set n1 = 900 + nPar*10 + 1
					Set s1 = Str(nOtm)
					! 9n2 - комментарий
					Set n2 = 900 + nPar*10 + 2
					Set s2 = sNazn
					! 9n3 - дата
					Set n3 = 900 + nPar*10 + 3
					! Set s3 = sNazn
					! 9n4 - Юзер
					Set n4 = 900 + nPar*10 + 4
					Set s4 = Str(GetUserId()) || '/' || GetUserRealName()
					!
					If SqlPrepareAndExecute( hSql(), "select to_char(sysdate,'dd/mm/yyyy hh24:mi:ss') into :s3 from dual" )
						If SqlFetchNext( hSql(), nFetchRes)
							If SqlPLSQLCommand( hSql(),"SEB_SUR.fix_answer_p( nSID, n1, nN, s1 )" )
								If SqlPLSQLCommand( hSql(),"SEB_SUR.fix_answer_p( nSID, n2, nN, s2 )" )
									If SqlPLSQLCommand( hSql(),"SEB_SUR.fix_answer_p( nSID, n3, nN, s3 )" )
										If SqlPLSQLCommand( hSql(),"SEB_SUR.fix_answer_p( nSID, n4, nN, s4 )" )
											If nPar = 4
												If SqlPrepareAndExecute( hSql(),
														"update SURVEY_SESSION  set COMPLETED = 
														decode(:nOtm,0,3,1,4,5) where SESSION_ID =:nSID " )
											Else If nPar != 4 and nOtm=2
												If SqlPrepareAndExecute( hSql(),
														"update SURVEY_SESSION set COMPLETED = 1 where SESSION_ID =:nSID " ) 
														and SqlPrepareAndExecute( hSql(),
														"delete from SURVEY_ANSWER 
														 where SESSION_ID =:nSID and QUEST_ID_P in (901,911,921,931,941,951)
														    and QUEST_ID_P <>:n1 " ) 
											Return TRUE
					!
					Return FALSE
			Function: Print_RTF
				Description:
				Returns
					Number:
				Parameters
				Static Variables
				Local variables
					String: sTemplateId
					Long String: sDoc
					: cCnc
						Class: cABSConnect
					: cCnc2
						Class: cABSConnect
				Actions
					If NOT cdoc_SelectDocTemplate( "DOC_SCHEME", "ID", "NAME",
							" ID LIKE 'SUR%' ", sTemplateId )
						Return 0
					If sTemplateId
						Call XConnectGetParams( cCnc )
						If cCnc.Connect() and cCnc2.Clone( cCnc, TRUE )
							Set sDoc=cdoc_CreateDocFromTemplate( cCnc.hSql(), cCnc2.hSql(), sTemplateId,  nSID, 0)
							If sDoc
								Call cdoc_ShowDoc(sDoc,TRUE,FALSE)
							Call cCnc.Disconnect()
							Call cCnc2.Disconnect()
		Window Parameters
			Number: nSID
			Number: nPar
			String: FIO
			String: strPar02
			String: OTM_0
			String: OTM_1
			String: OTM_2
			String: OTM_3
			String: OTM_4
			String: OTM_5
		Window Variables
			Number: nUser
			Number: nGrp
			Number: nColo
			String: sNazn
			Number: nOtm
		Message Actions
			On SAM_Create
				Call SalSetWindowText( hWndForm,strPar02||": Визирование анкеты № "||Str(nSID) || ' '||FIO )
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns( hWndForm, 4 )
				Set nGrp=0
				Set nColo=COLOR_LightGray
				Set nUser = GetUserId()
				Set SEB2.strSqlPopulate =
						"select GRP_ORD, GRP_NAME, QUEST_NAME, QUEST_ORD, ANSWER_ORD, ANSWER_VALUE,
						        QUEST_ID_P
						 into :SEB2.GRP_ORD, :SEB2.GRP_NAME, :SEB2.QUEST_NAME, :SEB2.QUEST_ORD,
						      :SEB2.ANSWER_ORD, :SEB2.ANSWER_VALUE, :SEB2.QUEST_ID_P
						 from V_SURVEY_RESPONSE
						 where SESSION_ID="||Str(SEB2.nSID) || "
						 order by iif_n(QUEST_ID_P,900,2,0,1), 
						GRP_ORD,QUEST_ORD, answer_pos,ANSWER_ORD "
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				If nGrp != GRP_ORD
					If nColo= COLOR_LightGreen
						Set nColo=COLOR_Sky
					Else
						Set nColo=COLOR_LightGreen
					Set nGrp = GRP_ORD
				Call XSalTblSetRowBackColor( hWndForm, lParam, nColo )
				If QUEST_ID_P >=900
					Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,255,180) )
			! On SAM_DoubleClick
				! If ND > 0 and SOS=10
					                                                                Call Sel020( hWndForm, 204, ND, strPar01, Str(ACC8) )
			On SAM_TblDoDetails
	! cGenericTable: SEB3
.winattr class Table Window:
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  10.914"
				Width Editable? Yes
				Height: 5.781"
				Height Editable? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
			View: Table
			Allow Row Sizing? No
			Lines Per Row: Default
		Memory Settings
			Maximum Rows in Memory: Default
			Discardable? No
.end
		                                            Description: 
		                                            Named Menus 
		                                            Menu 
		                                            Tool Bar 
			                                            Contents 
				                                            Pushbutton: pbIns
					                                            Message Actions 
				                                            Pushbutton: pbDel
					                                            Message Actions 
				                                            Pushbutton: pbRefresh
					                                            Message Actions 
				                                            Pushbutton: pbUpdate
					                                            Message Actions 
				                                            Line 
				                                            Pushbutton: pbSearch
					                                            Message Actions 
				                                            Pushbutton: pbFilter
					                                            Message Actions 
				                                            Pushbutton: pbDetails
					                                            Message Actions 
				                                            Pushbutton: pbPrint
					                                            Message Actions 
				                                            Line 
				                                            Pushbutton: pbExit
					                                            Message Actions 
				                                            Line 
		                                            Contents 
			                                            Column: C300
				                                            List Values 
				                                            Message Actions 
			                                            Column: C301
				                                            List Values 
				                                            Message Actions 
			                                            Column: C302
				                                            List Values 
				                                            Message Actions 
			                                            Column: C304
				                                            List Values 
				                                            Message Actions 
			                                            Column: C303
				                                            List Values 
				                                            Message Actions 
			                                            Column: C305
				                                            List Values 
				                                            Message Actions 
			                                            Column: C306
				                                            List Values 
				                                            Message Actions 
			                                            Column: C307
				                                            List Values 
				                                            Message Actions 
			                                            Column: C308
				                                            List Values 
				                                            Message Actions 
			                                            Column: C309
				                                            List Values 
				                                            Message Actions 
		                                            Functions 
		                                            Window Parameters 
			                                            Number: nSID
			                                            Number: nPar
			                                            String: FIO
			                                            String: strPar02
		                                            Window Variables 
		                                            Message Actions 
			                                            On SAM_Create
				                                            Call SalSetWindowText( hWndForm,
						strPar02||": Спецификация залога. № анкеты " ||Str(nSID) || ' '||FIO )
				!
				                                            Call SalDisableWindow( pbIns )
				                                            Call SalDisableWindow( pbUpdate )
				                                            Call SalDisableWindow( pbDel )
				                                            Call SalDisableWindow( C300 )
				                                            Call SalDisableWindow( C301 )
				                                            Call SalDisableWindow( C302 )
				                                            Call SalDisableWindow( C303 )
				                                            Call SalDisableWindow( C304 )
				                                            Call SalDisableWindow( C305 )
				                                            Call SalDisableWindow( C306 )
				                                            Call SalDisableWindow( C307 )
				                                            Call SalDisableWindow( C308 )
				                                            Call SalDisableWindow( C309 )
				                                            If nPar = 0 ! Менеджер
					                                            Call SalEnableWindow( pbIns )
					                                            Call SalEnableWindow( pbUpdate )
					                                            Call SalEnableWindow( pbDel )
					                                            Call SalEnableWindow( C300 )
					                                            Call SalEnableWindow( C301 )
					                                            Call SalEnableWindow( C302 )
					                                            Call SalEnableWindow( C303 )
					! Call SalDisableWindow( tblSP.C304 )
					                                            Call SalEnableWindow( C305 )
					                                            Call SalEnableWindow( C306 )
					                                            Call SalEnableWindow( C307 )
					                                            Call SalEnableWindow( C308 )
					                                            Call SalEnableWindow( C309 )
				                                            Else If nPar=2 ! Залоговик
					                                            Call SalEnableWindow( pbUpdate )
				                                            Set SEB3.strSqlPopulate =
						"SELECT "
	Dialog Box: dlg_SEB
		Class:
		Property Template:
		Class DLL Name:
		Title: Комментарии специалиста
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   0.125"
				Top:    1.594"
				Width:  11.933"
				Width Editable? Yes
				Height: 4.845"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Frame
				Resource Id: 29412
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    2.905"
					Width:  11.0"
					Width Editable? Yes
					Height: 0.917"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			! cFieldLabel: tbgSave	!Сохранить
				                                              Message Actions
			Multiline Field: mlTxt
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					String Type: String
					Editable? Yes
				Display Settings
					Border? Yes
					Word Wrap? Yes
					Vertical Scroll? Yes
					Window Location and Size
						Left:   0.2"
						Top:    1.071"
						Width:  10.883"
						Width Editable? Yes
						Height: 1.667"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Message Actions
			Pushbutton: pbOk	! Сохранить
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Сохранить
				Window Location and Size
					Left:   8.6"
					Top:    3.155"
					Width:  1.2"
					Width Editable? Class Default
					Height: 0.448"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If not rb1 and not rb0 and not rb2
							Call SalMessageBox("Нет отметки Одобрить/Неодобрить/Вернуть !",
									"Сохранение невозможено !", MB_IconStop)
						Else If SalStrLength( SalStrTrimX( mlTxt) ) < 4
							Call SalMessageBox("Нет коментариев специалиста !",
									"Сохранение невозможено !", MB_IconStop)
						Else
							If SalMessageBox("Сохранить отметку и комментарии ?",
									"Дополнительное подтверждение", MB_IconQuestion | MB_YesNo) = IDYES
								Set sNazn = mlTxt
								Set nOtm  = IifN( rb1, 1, IifN(rb2,2,0 ))
								Call SalEndDialog( hWndForm, TRUE )
			Pushbutton: pbClose	! Отменить
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Отменить
				Window Location and Size
					Left:   9.8"
					Top:    3.155"
					Width:  1.2"
					Width Editable? Class Default
					Height: 0.448"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( hWndForm, FALSE )
			Radio Button: rb1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Одобрить
				Window Location and Size
					Left:   0.283"
					Top:    3.155"
					Width:  2.1"
					Width Editable? Yes
					Height: 0.452"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 12
				Font Enhancement: Bold
				Text Color: Dark Green
				Background Color: Default
				Message Actions
			Radio Button: rb0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: НЕ одобрить
				Window Location and Size
					Left:   2.883"
					Top:    3.155"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.452"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 12
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
				Message Actions
			Radio Button: rb2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вернуть
				Window Location and Size
					Left:   5.883"
					Top:    3.155"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.452"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 12
				Font Enhancement: Bold
				Text Color: Midnight Blue
				Background Color: Default
				Message Actions
			Radio Button: rbN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: НЕ одобрить
				Window Location and Size
					Left:   3.283"
					Top:    1.988"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.452"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: 12
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
				Message Actions
			Background Text: Безопасность
				Resource Id: 29413
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    0.095"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: d0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.083"
						Top:    0.071"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Юрист
				Resource Id: 29414
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    0.345"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: d1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.083"
						Top:    0.321"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Залоговик
				Resource Id: 29415
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.183"
					Top:    0.095"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: d2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.983"
						Top:    0.071"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Аналитик
				Resource Id: 29416
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.183"
					Top:    0.345"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: d3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.983"
						Top:    0.321"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Бизнес
				Resource Id: 4187
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.183"
					Top:    0.595"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: d5
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.95"
						Top:    0.595"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
		Functions
			Function: F_Col
				Description:
				Returns
					Boolean:
				Parameters
					! Window Handle: wD
					Receive Window Handle: wD
					String: OTM
				Static Variables
				Local variables
				Actions
					If OTM = '1'
						Call SalColorSet(wD, 8, COLOR_DarkGreen)
					Else If OTM = '0'
						Call SalColorSet(wD, 8, COLOR_DarkRed )
					Else If OTM = '2'
						Call SalColorSet(wD, 8, COLOR_DarkBlue)
		Window Parameters
			Number: nPar
			Receive String: sNazn
			Receive Number: nOtm
			String: OTM_0
			String: OTM_1
			String: OTM_2
			String: OTM_3
			String: OTM_4
			String: OTM_5
		Window Variables
		Message Actions
			On SAM_Create
				Call SalCenterWindow( hWndForm )
				Call SetWindowFont( hWndForm )
				Call F_Col (d0, OTM_0 )
				Call F_Col (d1, OTM_1 )
				Call F_Col (d2, OTM_2 )
				Call F_Col (d3, OTM_3 )
				Call F_Col (d5, OTM_5 )
				Set d0 = IifS(OTM_0='1','Одобрено',
						         IifS(OTM_0='0','HEoдобрено', 
						         IifS(OTM_0='2','Возврат','')))
				Set d1 = IifS(OTM_1='1','Одобрено',
						         IifS(OTM_1='0','HEoдобрено', 
						         IifS(OTM_1='2','Возврат','')))
				Set d2 = IifS(OTM_2='1','Одобрено',
						         IifS(OTM_2='0','HEoдобрено', 
						         IifS(OTM_2='2','Возврат','')))
				Set d3 = IifS(OTM_3='1','Одобрено',
						         IifS(OTM_3='0','HEoдобрено', 
						         IifS(OTM_3='2','Возврат','')))
				Set d5 = IifS(OTM_5='1','Одобрено',
						         IifS(OTM_5='0','HEoдобрено', 
						         IifS(OTM_5='2','Возврат','')))
				If nPar = 4
					If OTM_0='1' and OTM_1='1' and OTM_2='1' and OTM_3='1'
						Set rb1 = TRUE
					Else
						Set rb0 = TRUE
						! Call SalDisableWindow( rb0 )
						Call SalDisableWindow( rb1 )
				Else
					Set rbN = TRUE
				! Присваиваем значения многоязыковым объектам
				Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
				!
				Call SalSetWindowText( hWndForm, sNazn  )
				!
				Set mlTxt = ""
				Call SalSetFocus( pbOk )
	Table Window: SEB3
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.05"
				Top:    0.417"
				Width:  17.05"
				Width Editable? Class Default
				Height: 4.012"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.383"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.883"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.383"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.883"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7736
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.383"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7737
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.883"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7738
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: NPP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						пп
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.467"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmp1 = NPP
					On SAM_AnyEdit
						If nTmp1 != NUMBER_Null
							Set NPP = nTmp1 
			Column: C300
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Описание
						залога
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.683"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Create
						If SqlPrepareAndExecute(hSql(),
								  "SELECT name,pawn INTO :sTmp,:nPawn FROM cc_pawn ORDER by pawn")
							Set nTmp = 0
							Call SalArraySetUpperBound(mPawn, 1, -1)
							Call SalListClear(hWndItem)
							While SqlFetchNext(hSql(), nFetchRes)
								Call SalListAdd(hWndItem, sTmp)
								Set mPawn[nTmp] = nPawn
								Set nTmp = nTmp+1
					On SAM_Validate
						Set nTmp = SalListQuerySelection(hWndItem)
						If nTmp >= 0
							Set PAWN = mPawn[nTmp]
						Else
							Set PAWN = 0
						Call SalSetFocus( C301 )
						Return VALIDATE_Ok
			Column: C301
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Статус:
						1-перв,
						2-втор
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.983"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: C302
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Стоимость,
						описание
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.9"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: C303
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Стоимость,
						UAH
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: C304
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Стоимость,
						UAH
						(залог.)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: C305
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Оценщик
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: C306
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						оценки
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.067"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: C307
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ВОЗМ.
						%
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.733"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: C308
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ФИНАНС.
						UAH
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.133"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: C309
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Обязательство,
						обеспечиваемое
						данным залогом
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.6"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: PAWN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						залога
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_Disa
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalDisableWindow( pbIns )
					Call SalDisableWindow( pbUpdate )
					Call SalDisableWindow( pbDel )
					Call SalDisableWindow( C300 )
					Call SalDisableWindow( C301 )
					Call SalDisableWindow( C302 )
					Call SalDisableWindow( C303 )
					Call SalDisableWindow( C304 )
					Call SalDisableWindow( C305 )
					Call SalDisableWindow( C306 )
					Call SalDisableWindow( C307 )
					Call SalDisableWindow( C308 )
					Call SalDisableWindow( C309 )
					If nPar = -1 ! Менеджер
						Call SalEnableWindow( pbIns )
						Call SalEnableWindow( pbUpdate )
						Call SalEnableWindow( pbDel )
						Call SalEnableWindow( C300 )
						Call SalEnableWindow( C301 )
						Call SalEnableWindow( C302 )
						Call SalEnableWindow( C303 )
						! Call SalDisableWindow( tblSP.C304 )
						Call SalEnableWindow( C305 )
						Call SalEnableWindow( C306 )
						Call SalEnableWindow( C307 )
						Call SalEnableWindow( C308 )
						Call SalEnableWindow( C309 )
						Set sSqlD = 
								"delete from SURVEY_ANSWER where SESSION_ID=:nSID and ANSWER_POS=:NPP 
								 and QUEST_ID_P in (300,301,302,303,305,306,307,308,309)"
					Else If nPar=2 ! Залоговик
						Call SalEnableWindow( pbUpdate )
						Call SalEnableWindow( C304 )
						Set sSqlD = 
								"delete from SURVEY_ANSWER where SESSION_ID=:nSID and ANSWER_POS=:NPP 
								 and QUEST_ID_P in (304)"
					!
					Set sSqlI = 
							"insert into SURVEY_ANSWER (SESSION_ID,ANSWER_POS,ANSWER_CHAR,QUEST_ID_P) 
							 values (:nSID,:NPP,:sTmp,:nTmp)"
			Function: F_Ins
				Description:
				Returns
					Boolean:
				Parameters
					Number: nTmp
					String: sTmp
				Static Variables
				Local variables
				Actions
					If sTmp != STRING_Null
						Return SqlPrepareAndExecute( hSql(), sSqlI )
					Return TRUE
		Window Parameters
			Number: nMode
			Number: nSID
			String: sPar
			String: FIO
		Window Variables
			Number: nPar
			Number: nTmp
			Number: nTmp1
			String: sTmp
			Number: nPawn
			Number: mPawn[*]
			Number: nRow
			String: sSqlD
			String: sSqlI
		Message Actions
			On SAM_Create
				Call SalWaitCursor(TRUE)
				Set nPar = Val(sPar)
				Call SalSetWindowText( hWndForm,
						"Спецификация залога. № анкеты " ||Str(nSID) || ' '||FIO )
				Set SEB3.strPrintFileName = 'SPZ'||Str(nSID) 
				Call SalSendClassMessage(SAM_Create, 0, 0)
				!
			On UM_Populate
				Call F_Disa()
				Call SalWaitCursor(TRUE)
				Set SEB3.strSqlPopulate =
						"SELECT a.NPP, a.PAWN, nvl(p.NAME, 'Не задан'),
						        a.C301,a.C302,a.C303,a.C304,a.C305,a.C306,a.C307,a.C308,a.C309         
						 INTO :SEB3.NPP, :SEB3.PAWN, :SEB3.C300, :SEB3.C301, :SEB3.C302, :SEB3.C303,
						      :SEB3.C304 :SEB3.C305, :SEB3.C306, :SEB3.C307, :SEB3.C308, :SEB3.C309
						 FROM cc_pawn p,
						    ( SELECT c.num NPP,
						        to_number(Seb_Sur.get_valueN(:nSID, 300, c.num))     PAWN,
						        to_number(Seb_Sur.get_valueN(:nSID, 301, c.num))     C301,
						        substr(Seb_Sur.get_valueN(:nSID, 302, c.num),1,100)  C302, 
						        to_number(Seb_Sur.get_valueN(:nSID, 303, c.num))/100 C303,
						        to_number(Seb_Sur.get_valueN(:nSID, 304, c.num))/100 C304,
						        substr(Seb_Sur.get_valueN(:nSID, 305, c.num),1,100)  C305,
						        to_date(Seb_Sur.get_valueN(:nSID, 306, c.num),'dd.mm.yyyy') C306,
						        to_number(Seb_Sur.get_valueN(:nSID, 307, c.num))     C307,
						        to_number(Seb_Sur.get_valueN(:nSID, 308, c.num))/100 C308,
						        to_number(Seb_Sur.get_valueN(:nSID, 309, c.num))     C309 
						      FROM conductor c 
						      where c.num<100
						        and Seb_Sur.get_valueN(:nSID, 300, c.num) is not null) a
						 WHERE a.pawn  = p.pawn (+)
						 ORDER BY a.NPP "
				Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
				Call SalTblPopulate(hWndForm, hSql(), SEB3.strSqlPopulate, TBL_FillAll )
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On UM_Update
				Set nRow = TBL_MinRow
				While SalTblFindNextRow(hWndForm, nRow,
						 ROW_New | ROW_Edited | ROW_MarkDeleted , 0)
					Call SalTblSetContext(hWndForm, nRow)
					If SalTblQueryRowFlags( hWndForm, nRow, ROW_Edited | ROW_MarkDeleted )
						If SqlPrepareAndExecute( hSql(), sSqlD )
					If SalTblQueryRowFlags( hWndForm, nRow, ROW_Edited | ROW_New )
						If nPar=2 ! Залоговик
							Call F_Ins(304,Str(C304*100) )
						Else ! nPar = -1 ! Менеджер
							If PAWN = NUMBER_Null
								Set PAWN =99
							Call F_Ins(300,Str(PAWN) )
							Call F_Ins(301,Str(C301) )
							Call F_Ins(302,    C302 )
							Call F_Ins(303,Str(C303*100) )
							Call F_Ins(305,    C305 )
							Call F_Ins(306, SalFmtFormatDateTime( C306, 'dd.MM.yyyy' )  )
							Call F_Ins(307,Str(C307) )
							Call F_Ins(308,Str(C308*100) )
							Call F_Ins(309,Str(C309) )
				!
				Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
	Dialog Box: dlgQOLogin
		Class:
		Property Template:
		Class DLL Name:
		Title: QuickTable Login
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Type of Dialog: Modal
			Window Location and Size
				Left:   2.22"
				Top:    2.142"
				Width:  4.75"
				Width Editable? Yes
				Height: 2.2"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: MS Sans Serif
			Font Size: 8
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: cQuickTable login dialog. This dialog simply prompts for the login parameters. 
				The data source will actually handle the login to the data source.
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Data Field: dfDatabase
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 255
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.29"
						Top:    0.325"
						Width:  2.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Database:
				Resource Id: 9536
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.29"
					Top:    0.117"
					Width:  2.8"
					Width Editable? Yes
					Height: 0.208"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfUser
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 31
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.29"
						Top:    0.825"
						Width:  2.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: User:
				Resource Id: 9537
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.29"
					Top:    0.617"
					Width:  1.5"
					Width Editable? Yes
					Height: 0.208"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfPassword
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.29"
						Top:    1.325"
						Width:  2.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Invisible
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Password:
				Resource Id: 9538
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.29"
					Top:    1.117"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Pushbutton: pbOK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: OK
				Window Location and Size
					Left:   3.59"
					Top:    0.242"
					Width:  0.9"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Enter
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set pDatabase = dfDatabase
						Set pUser = dfUser
						Set pPassword = dfPassword
						Call SalEndDialog( hWndForm, 0 )
			Line
				Resource Id: 9539
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Coordinates
					Begin X:  3.383"
					Begin Y:  1.917"
					End X:  3.383"
					End Y:  0.0"
				Visible? Yes
				Line Style: Etched
				Line Thickness: 1
				Line Color: 3D Shadow Color
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Cancel
				Window Location and Size
					Left:   3.59"
					Top:    0.575"
					Width:  0.9"
					Width Editable? Yes
					Height: 0.292"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Esc
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( hWndForm, 1 )
		Functions
		Window Parameters
			Receive String: pDatabase
			Receive String: pUser
			Receive String: pPassword
		Window Variables
		Message Actions
			On SAM_Create
				Set dfDatabase = pDatabase
				Set dfUser = pUser
				Set dfPassword = pPassword
			On SAM_CreateComplete
				Call SalBringWindowToTop( hWndForm )
	Table Window: Tbl_GPK
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Построение Графика Погашения Кредита (ГПК)
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -0.038"
				Top:    0.406"
				Width:  17.267"
				Width Editable? Class Default
				Height: 6.071"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.75"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Data Field: nND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.283"
							Top:    0.405"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Реф.КД' )
				Data Field: SUMR_
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.383"
							Top:    0.048"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.31"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Новый лимит по КД'  )
						On SAM_Create
							Set SUMR_ = LIM1
						On SAM_Validate
							If SUMR_ < 1 or SUMR_ = NUMBER_Null
								Call Debug('Ош.сумма')
								Return VALIDATE_Cancel
				Data Field: LIM1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.383"
							Top:    0.405"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Текущий лимит по КД' )
				Data Field: DAT3
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.083"
							Top:    0.405"
							Width:  1.283"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Первая Дата выдачи КД' )
				Data Field: BDAT_1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.1"
							Top:    0.036"
							Width:  1.283"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата Установки новой суммы лимита ' )
				Data Field: FDAT_
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.883"
							Top:    0.048"
							Width:  1.283"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата Первого гашения после установки нового лимита' )
						On SAM_Validate
							! Set FDAT_ =  CorrectDate( GetBaseVal(), FDAT_, DAT4)
							! If FDAT_ <= BDAT_1 or  FDAT_ >= DAT4
								                                            Call Debug('Ош.дата')
								                                            Return VALIDATE_Cancel
				Data Field: DAT4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.167"
							Top:    0.048"
							Width:  1.283"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата завершения КД' )
				!
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Выровнять общ.сумму,
									 пересчитать %,
									 Сохранить в ГПК и в ГЛК'
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 48157
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.35"
						Top:    0.048"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.8"
						Top:    0.048"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.25"
						Top:    0.048"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 48158
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   14.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 48159
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: dCC_ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.883"
							Top:    0.405"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.262"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				! Data Field: dfFREQ
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.167"
							Top:    0.667"
							Width:  2.317"
							Width Editable? Yes
							Height: 0.262"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
.end
					                                                                                                                                                              Message Actions
						                                                                                                                                                              On SAM_TooltipSetText
							                                                                                                                                                              Return XSalTooltipSetText( lParam, 'Периодичность погашения кредита' )
				Data Field: RATE
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.883"
							Top:    0.405"
							Width:  1.283"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Ном.% ставка' )
				!
				Data Field: dSUMO
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   8.55"
							Top:    0.083"
							Width:  1.467"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Общая сумма гашения(Гр.4) для всех дат' )
				Frame
					Resource Id: 48160
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.55"
						Top:    0.048"
						Width:  4.533"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Radio Button: rb2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: по Гр.2
					Window Location and Size
						Left:   5.617"
						Top:    0.083"
						Width:  1.45"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call RB24()
				Radio Button: rb4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: по Гр.4
					Window Location and Size
						Left:   7.083"
						Top:    0.083"
						Width:  1.45"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Call RB24()
				Background Text: ГПК
					Resource Id: 48161
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   10.883"
						Top:    0.429"
						Width:  1.283"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? No
					Justify: Right
					Font Name: Default
					Font Size: 12
					Font Enhancement: Bold-Italic-Underline
					Text Color: Red
					Background Color: Default
				Pushbutton: pbRazbyt
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Recycle.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set Temp_nSel=nSel
							If FDAT_ != DATETIME_Null
								If SalModalDialog(dlg_GPK, hWndForm, Temp_nSel, nDig ) = 1
									Call SalWaitCursor(TRUE)
									If SUMR_ != NUMBER_Null
										If SqlPLSQLCommand(hSql(),
												"CCK.CC_GPK (nSel,nND,nAcc8,BDAT_1,FDAT_,DAT4,SUMR_,nFreq,RATE,nDig ) " )
											If nSel=3
												Set rb4= TRUE
												Set rb2= FALSE
												Set nVid = 4
												Call SalShowWindow( dSUMO )
											Else
												Set rb2= TRUE
												Set rb4= FALSE
												Set nVid = 2
												Call SalHideWindow( dSUMO )
											If nSel != 3 OR ASG_SN = '1'
												Call SqlPLSQLCommand(hSql(),
														"CCK.cc_TMP_GPK( nND, nVid, nAcc8, DAT3, DAT4, ASG_SN, SUMR_, gl_BDATE ) " )
											Call SqlCommit( hSql() )
											Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
										Else
											Call SqlRollback(hSql())
											Call MessageNoWait('Неуспешное построение ГПК', 'Ошибка', 0, 1)
									Call SalWaitCursor(FALSE)
							Set nSel=Temp_nSel
						On SAM_Create
							Set strTip = 'Разбить'
				Pushbutton: pbND0
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.683"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\OK.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Ввести параметры тестового КД '
						On SAM_Click
							Call SalWaitCursor(TRUE)
							If nND <= 0
								If SqlPLSQLCommand(hSql(),
										 "CCK.CC_GPK0 (nSel, Tbl_GPK.nND, Tbl_GPK.nAcc8, BDAT_1, FDAT_, DAT4, SUMR_, nFreq, RATE, nBasey, nDig  ) " )
									Call Par_Dog()
							Call SalWaitCursor(FALSE)
				Data Field: cmbFREQ
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.283"
							Top:    0.405"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: cmbBasey
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.283"
							Top:    0.405"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
		Contents
			Column: GRF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: По
						гр.
				Visible? Yes
				Editable? No
				Maximum Data Length: 1
				Data Type: Number
				Justify: Center
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.067"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If FDAT < bDat
							Call SalMessageBox("Дата платежа должна быть не раньше Текущей даты !",
									     "Ошибка ввода", MB_Ok | MB_IconAsterisk)
							Set FDAT = FDAT_old
						If SalIsNull(hWndItem)
							Call SalMessageBox(
									     "Это поле должно быть заполнено !",
									     "Ошибка ввода", MB_Ok | MB_IconAsterisk)
							Return VALIDATE_Cancel
						If FDAT < DAT3
							Call SalMessageBox("Дата платежа должна быть не раньше даты начала договора!",
									     "Ошибка ввода", MB_Ok | MB_IconAsterisk)
							Set FDAT = DAT3
							Return VALIDATE_Cancel
						If FDAT > DAT4
							Call SalMessageBox("Дата платежа должна быть не позже даты окончания договора!",
									     "Ошибка ввода", MB_Ok | MB_IconAsterisk)
							Set FDAT = DAT4
							Return VALIDATE_Cancel
						Set FDAT = CorrectDate(GetBaseVal(), FDAT, FDAT+1 )  !! не выходной и не праздник
						! Call SalEnableWindow(pbRovno)
						Return VALIDATE_Ok
			Column: VLIM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План-Сумма
						ВХОДЯЩАЯ
						1
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SUMG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План-Сумма
						гашения
						2
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.317"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set SUM_old = SUMG
					On SAM_Validate
						If FDAT < bDat
							Set SUMG = SUM_old
							Return VALIDATE_Ok
						Else If SalIsNull(hWndItem)
							Call SalClearField(hWndItem)
							Return VALIDATE_Ok
						Else If SUMG < 0
							Call SalMessageBox(
									     "Сумма погашения кредита должна быть >= 0",
									     "Ошибка ввода", MB_Ok | MB_IconAsterisk)
							Return VALIDATE_Cancel
						Set SUMG_100 = SUMG *100
						Return VALIDATE_Ok
			Column: PR_L
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Расч.%
						по лим
						3
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.05"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SUMO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План-Сумма
						гаш. общ.
						4 = 2 + 3
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.283"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If FDAT < bDat
							Set SUMO = SUM_old
							Return VALIDATE_Ok
						Else If SUMO = 0 or SalIsNull(hWndItem)
							Call SalClearField(hWndItem)
							Return VALIDATE_Ok
						Else If SUMO < 0
							Call SalMessageBox(
									     "Сумма погашения кредита должна быть >= 0",
									     "Ошибка ввода", MB_Ok | MB_IconAsterisk)
							Return VALIDATE_Cancel
						Set SUMO_100 = SUMO *100
						Return VALIDATE_Ok
			Column: ILIM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План-Сумма
						ИСХОДЯЩАЯ
						5 = 1 - 2
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.433"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OTM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отм.
						о
						Пог
						
				Visible? Yes
				Editable? No
				Maximum Data Length: 1
				Data Type: Number
				Justify: Center
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: VOST
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реальный ост.
						ВХОДЯЩИЙ
						6
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.55"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RDOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реальный
						ДЕБЕТ
						7
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.483"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RKOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реальный
						КРЕДИТ
						8
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.6"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: IOST
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реальный ост.
						ИСХОДЯЩИЙ
						9 = 6 + 7 - 8
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.433"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PR_O
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Расч.%
						по ост
						10
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DELO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Просрочено
						/Невыбрано
						10 = 9 - 5
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.267"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: FDAT_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: FDAT_old
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.183"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SUMG_100
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: SUM2_100
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.983"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SUMO_100
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: SUM4_100
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.783"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			! Column: DELO_SP
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: В т.ч.
						на SP
						11 (пр.)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.183"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                                                                                                                                       List Values
				                                                                                                                                                       Message Actions
		Functions
			Function: COLORA
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					! истекший период
					If nND <=0
						Call COLORA1( SalColorFromRGB( 230,245,240 )  )
					Else
						If FDAT >= bDat and GRF= 1
							Call COLORA1( COLOR_LightGreen )
						Else If FDAT <= bDat
							Call COLORA1( IifN (FDAT = bDat , COLOR_Sky, COLOR_LightGray) )
							! просрочка
							If DELO >0
								! превішен лимит - розовій
								Call XSalTblSetCellBackColor( DELO, SalColorFromRGB( 255,210,250 ) )
							Else If DELO < 0
								! невібран лимит - желтій
								Call XSalTblSetCellBackColor( DELO, SalColorFromRGB( 255,255,180) )
							If PR_O != NUMBER_Null and PR_L != NUMBER_Null
								If PR_O < PR_L
									Call XSalTblSetCellBackColor( PR_O, SalColorFromRGB( 255,210,250 ) )
								Else If PR_O > PR_L
									Call XSalTblSetCellBackColor( PR_O, SalColorFromRGB( 255,255,180) )
			Function: COLORA1
				Description:
				Returns
				Parameters
					Number: nCol
				Static Variables
				Local variables
				Actions
					Call XSalTblSetCellBackColor( FDAT, nCol )
					Call XSalTblSetCellBackColor( VLIM, nCol )
					Call XSalTblSetCellBackColor( ILIM, nCol )
					If SUMG < 0 and SUMG != NUMBER_Null
						Call XSalTblSetCellBackColor( SUMG, SalColorFromRGB( 255,255,180)  )
					Else
						Call XSalTblSetCellBackColor( SUMG, nCol )
					Call XSalTblSetCellBackColor( PR_L, nCol )
					Call XSalTblSetCellBackColor( PR_O, nCol )
					Call XSalTblSetCellBackColor( SUMO, nCol )
					Call XSalTblSetCellBackColor( VOST, nCol )
					Call XSalTblSetCellBackColor( RDOS, nCol )
					Call XSalTblSetCellBackColor( RKOS, nCol )
					Call XSalTblSetCellBackColor( IOST, nCol )
					Call XSalTblSetCellBackColor( DELO, nCol )
			Function: RB24
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If rb4
						Call SalEnableWindow( SUMO )
						Call SalDisableWindow( SUMG )
						Call SalShowWindow( dSUMO )
						Set nVid=4
					Else
						Call SalHideWindow( dSUMO)
						Call SalDisableWindow( SUMO )
						Call SalEnableWindow( SUMG )
						Set dSUMO =0
						Set nVid=2
			Function: ANNUITET
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: nRow
					Number: nS
					Number: nSP
					Number: nS1
					Date/Time: dS1
				Actions
					Set nRow = TBL_MinRow
					While SalTblFindNextRow( hWndForm, nRow, 0, 0 )
						Call SalTblSetContext( hWndForm, nRow )
						If nRow >0 and FDAT  >= BDAT_1 and FDAT > DAT3
							If GRF=1
								Set SUMO = IifN( dSUMO >0, dSUMO, SUMO )
								Set SUMO_100 = SUMO *100
								Call SalTblSetRowFlags( hWndForm, nRow, ROW_Edited, TRUE )
					Return TRUE
			Function: Par_Dog
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nMes
				Actions
					If SqlPrepareAndExecute( hSql(),
							"SELECT a.kv,-a.ostx/100,l.fdat,d.wdate,a.acc,q.freq,q.name,nvl(a.vid,0),i.basey,b.name
							 INTO :nKv,:LIM1,:DAT3,:DAT4,:nAcc8,:nFreq,:cmbFREQ,:nVid,:nBasey,:cmbBasey
							 FROM cc_lim L, accounts A, cc_deal D, cc_add C, freq Q, int_accn I, basey B
							 WHERE b.basey=i.basey AND i.id=0 AND i.acc=a.acc AND
							       c.nd=l.nd AND c.adds=0 AND q.freq=c.freq AND
							       l.nd=d.nd AND l.acc=a.acc AND l.nd=:Tbl_GPK.nND and
							       l.fdat=(select min(fdat) from cc_lim  where nd=:nND) " )
							and SqlFetchNext(hSql(), nFetchRes)
						If SqlPrepareAndExecute( hSql(),
								  "SELECT decode(a.ostc,0,r.IR,acrn.FPROCN(a.acc,0,gl.BD))
								   INTO :Tbl_GPK.RATE
								   FROM int_ratn r, accounts a
								   WHERE a.acc=:Tbl_GPK.nAcc8 AND a.acc=r.acc and r.id=0 " )
								and SqlFetchNext(hSql(), nFetchRes)
						Set sWh = " WHERE nd="|| Str(Tbl_GPK.nND) || " and acc="|| Str(Tbl_GPK.nAcc8)
						Set rb4 = ( nVid = 4 )
						Call RB24()
						!
						Set bDat  = IifD ( GetBankDate() < DAT3 , DAT3, GetBankDate() )
						Set BDAT_1 = bDat
						! Дата применения новой суммы лимита
						If Tbl_GPK.nND > 0
							! ищем будущую дату первого гашения, оговоренную в КД
							Set FDAT_ = DATETIME_Null
							If SqlPrepareAndExecute( hSqlAux(),
									  "select max(APL_DAT) INTO :FDAT_  from int_accn
									   where APL_DAT>=:BDAT_1 and acc=:Tbl_GPK.nAcc8 and id=0 ")
									 and SqlFetchNext( hSqlAux(), nFetchRes)
							! если не нашли (или она уже в прошлом) то берем первую ближайшую из ГПК
							If FDAT_ = DATETIME_Null
								If SqlPrepareAndExecute( hSqlAux(),
										  "SELECT min(fdat) INTO :FDAT_ FROM cc_LIM "|| sWh || " and fdat > :BDAT_1" )
										 and SqlFetchNext( hSqlAux(), nFetchRes)
						If FDAT_ = DATETIME_Null
							If nFreq=7
								Set nMes = 3
							Else If nFreq=180
								Set nMes = 6
							Else If nFreq=360
								Set nMes = 12
							Else
								Set nMes = 1
							Set FDAT_ =  AddMonths( BDAT_1, nMes )
						! надо - число первой даті а месяц - вібранной
						Call SalSendClassMessage(SAM_Create, 0, 0)
			Function: F_PR_O
				Description:
				Returns
					Number:
				Parameters
					Number: nPr1
					Date/Time: DatF
				Static Variables
				Local variables
					Number: nPr2
					Date/Time: Dat1
					Date/Time: Dat2
					Number: nGod
				Actions
					Set Dat1 = DAT3
					If ASG_SN = '1' and DatF < DAT4
						Set Dat2 =
								SalDateConstruct( SalDateYear(DatF), SalDateMonth(DatF), 1, 0, 0, 0 ) - 1
					Else
						Set Dat2 = DatF - 1
					Set nPr2 =  - p_intN (nAcc8, 0,Dat1, Dat2, NUMBER_Null, 0 )/100 - nPr1
					Return nPr2
		Window Parameters
			Number: nTip_Ur
			Number: nPar
			Date/Time: D1_
			Number: S_
			Date/Time: D2_
			Date/Time: D4_
			Number: R_
			Number: nF_
			String: F_
			Number: nB_
			String: B_
			Receive Number: nSel
		Window Variables
			Date/Time: DAT_beg
			Date/Time: gl_BDATE
			Number: nKv
			Date/Time: bDat
			Number: SUM_old
			Number: nDig
			Number: nAcc8
			Number: nFreq
			Number: nBasey
			!
			Number: nSumTek
			Number: nRow
			String: sWh
			!
			Date/Time: Dat_Max
			Date/Time: dTmp
			Number: Su3
			Number: Su31
			Number: nVid
			Number: I_SUMG
			Number: I_PR_L
			Number: I_PR_O
			Number: I_SUMO
			Number: I_RDOS
			Number: I_RKOS
			Number: nLim
			Number: nOst
			Number: nPr
			Number: nUserId
			Number: Temp_nSel
		Message Actions
			On SAM_Create
				Set nUserId = GetUserId()
				If nTip_Ur >0 AND nPar!=0 !! 'Полный просмотр (Без транзакций)'
					Call SalDisableWindow( pbIns )
					Call SalDisableWindow( pbDel )
					Call SalDisableWindow( pbUpdate )
					Call SalDisableWindow( pbRazbyt )
				If nPar = 0  !! Моделирование ГПК
					! Call SalEnableWindow( BDAT_1 )
					! Call SalEnableWindow( DAT4 )
					! Call SalEnableWindow( RATE )
					!
					Call SalHideWindow( VOST )
					Call SalHideWindow( RDOS )
					Call SalHideWindow( RKOS )
					Call SalHideWindow( IOST )
					Call SalHideWindow( DELO )
					Set nDig = 0 
					Set BDAT_1 = D1_
					Set DAT3 = D1_
					Set SUMR_=S_
					Set FDAT_ =D2_
					Set DAT4 =D4_
					Set RATE=R_
					Set nFreq=nF_
					Set cmbFREQ=F_
					Set nBasey=nB_
					Set cmbBasey=B_
					! Set BDAT_1 = GetBankDate()
					! Set DAT3 = GetBankDate()
					! Set FDAT_= CorrectDate( GetBaseVal(), AddMonths( DAT3, 1), DAT4)
					! Set DAT4 = CorrectDate( GetBaseVal(), AddMonths( DAT3,12), DAT4)
					! Call SalHideWindow( nND )
					Set Tbl_GPK.nND  = - nUserId
					Set Tbl_GPK.nAcc8= - nUserId
				!
				Set Tbl_GPK.strPrintFileName = 'СС_KAL'
				Set nDig = 0
				Set Tbl_GPK.nTabInstance = 1
				! Set Tbl_GPK.dCC_ID= Tbl_GPK.strPar01
				! Set Tbl_GPK.dNMK  = Tbl_GPK.strPar02
				!
				Set Tbl_GPK.strSqlDelete =
						 "DELETE FROM cc_LIM WHERE nd="||Str(Tbl_GPK.nND)||" and fdat >=:Tbl_GPK.gl_BDATE and fdat=:Tbl_GPK.FDAT_old "
				!
				Set Tbl_GPK.strSqlInsert =
						"INSERT Into cc_LIM (nd, fdat, sumg,sumo, acc) values
						(:Tbl_GPK.nND, :Tbl_GPK.FDAT, :Tbl_GPK.SUMG_100,:Tbl_GPK.SUMO_100, :Tbl_GPK.nAcc8 )"
				!
				Set Tbl_GPK.strSqlUpdate =
						"UPDATE cc_LIM SET sumg=:Tbl_GPK.SUMG_100, sumO=:Tbl_GPK.SUMO_100, fdat=:Tbl_GPK.FDAT
						 WHERE nd="||Str(Tbl_GPK.nND)||" and fdat >=:Tbl_GPK.gl_BDATE and fdat=:Tbl_GPK.FDAT_old "
				Call SalTblSetLockedColumns( hWndForm, 7 )
				!
				Set gl_BDATE = GetBankDate()
				Call SalTblSetColumnTitle ( PR_L, "%(Лим)
						по пред.
						"||IifS(ASG_SN = '1',"мес","день" ) ||" 3" )
				Call SalTblSetColumnTitle ( PR_O, "%(Ост)
						по пред.
						"||IifS(ASG_SN = '1',"мес","день" ) ||" 10" )
				! наполнение CC_LIM хотя бы одной записью
				Call CC_LIM_NULL( nND)
				! SCORING Сохраняем установочные данные
				If SqlPLSQLCommand(hSql(),
						 "CCK.CC_GPK0 (nSel, Tbl_GPK.nND, Tbl_GPK.nAcc8, BDAT_1, FDAT_, DAT4, SUMR_, nFreq, RATE, nBasey, nDig  ) " )
					Call Par_Dog()
				Call SqlCommit( hSql() )
				! параметры договора
				If nPar > 0
					Call Par_Dog()
			On UM_Populate
				If SUMR_ != NUMBER_Null AND  RATE != NUMBER_Null
					!
					Call SalWaitCursor(TRUE)
					Set I_SUMG = 0
					Set I_PR_L = 0
					Set I_PR_O = 0
					Set I_SUMO = 0
					Set I_RDOS = 0
					Set I_RKOS = 0
					Set nPr = 0
					! Set nLim = 0
					! Set nOst = 0
					If CC_GPK = '0' OR CC_GPK = '1'
						Call SalTblPopulate(hWndForm, hSqlAux2(),
								"SELECT decode(F.fdat,P.fdat,1,0) GRF, F.FDAT, p.OTM,
								        P.lim2/100, P.sumg/100, P.sumo/100,
								        -S.ostf/100, S.dos/100, S.kos/100
								 INTO :GRF, :FDAT, :OTM, :ILIM, :SUMG, :SUMO, :VOST, :RDOS, :RKOS
								 FROM
								(select fdat from cc_LIM where nd=:nND  union
								 select fdat from saldoa where acc=:nAcc8) F,
								(select fdat,lim2,sumg,sumo,otm from cc_lim where nd=:nND ) P,
								(select fdat,ostf,dos,kos from saldoa where acc=:nAcc8) S
								 WHERE F.fdat=P.fdat (+) and F.fdat=s.fdat (+) ORDER BY F.fdat" ,
								TBL_FillAll)
					Else
						Call SalTblPopulate(hWndForm, hSqlAux2(),
								"SELECT decode(F.fdat,P.fdat,1,0) GRF, F.FDAT,
								        P.lim2/100, P.sumg/100, P.sumo/100,
								        -S.ostf/100, S.dos/100, S.kos/100
								 INTO :GRF, :FDAT,  :ILIM, :SUMG, :SUMO, :VOST, :RDOS, :RKOS
								 FROM
								(select fdat from cc_LIM where nd=:nND UNION select fdat from saldoa where acc=:nAcc8) F,
								(select fdat,lim2,sumg,sumo from cc_lim where nd=:nND ) P,
								(select fdat,ostf,dos,kos from saldoa where acc=:nAcc8) S
								 WHERE F.fdat=P.fdat (+) and F.fdat=s.fdat (+) ORDER BY F.fdat" ,
								TBL_FillAll)
						Call SalHideWindow( Tbl_GPK.OTM )
					! Итог
					Call SalTblDefineSplitWindow (hWndForm, 1, TRUE)
					Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
					Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
					Call SalTblSetContext(hWndForm, nRow)
					Set SUMG = I_SUMG
					Set PR_L = I_PR_L
					Set PR_O = I_PR_O
					Set SUMO = I_SUMO
					Set RDOS = I_RDOS
					Set RKOS = I_RKOS
					!
					Call SalTblSetContext(hWndForm, Tbl_GPK.nRow )
					Call SalTblSetRowFlags( hWndForm, Tbl_GPK.nRow, ROW_New, FALSE )
					Call SalTblSetContext(hWndForm, 0)
					Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
					Call SalWaitCursor(FALSE)
					!
			On SAM_FetchRowDone
				Set FDAT_old = FDAT
				If SUMO = NUMBER_Null
					Set ILIM = nLim
					Set VLIM = nLim
				Else
					Set PR_L = SUMO-SUMG
					Set VLIM = ILIM + SUMG
				Set SUMO_100 = SUMO * 100
				Set SUMG_100 = SUMG * 100
				!
				If FDAT <= bDat
					If VOST = NUMBER_Null
						Set VOST = nOst
						Set IOST = nOst
					Else
						Set IOST = VOST + RDOS - RKOS
					Set DELO = IifN(IOST = NUMBER_Null,0, IOST ) - ILIM
					If GRF = 1
						! посчитать % с начала и до ДАТы - пред проц
						Set PR_O = F_PR_O (nPr, FDAT)
						Set nPr = nPr + PR_O
						If FDAT = bDat and SUMO=0 and PR_L=0
							Set SUMO = PR_O
							Set PR_L = PR_O
				Call COLORA()
				Set nLim = ILIM
				Set nOst = IOST
				Set I_SUMG = I_SUMG + SUMG
				Set I_PR_L = I_PR_L + PR_L
				Set I_PR_O = I_PR_O + PR_O
				Set I_SUMO = I_SUMO + SUMO
				Set I_RDOS = I_RDOS + RDOS
				Set I_RKOS = I_RKOS + RKOS
			On UM_Update
				Call SalWaitCursor(TRUE)
				If Tbl_GPK.rb4
					If not ANNUITET()
						Call MessageError( "not ANNUITET ! ")
						Return FALSE
				Call SalWaitCursor(TRUE)
				!
				Call SqlPrepare(hSql(), Tbl_GPK.strSqlDelete )
				Call SalTblDoDeletes( hWndForm, hSql(),  ROW_MarkDeleted)
				!
				Call SqlPrepare( hSql(), Tbl_GPK.strSqlInsert )
				Call SalTblDoInserts( hWndForm, hSql(), TRUE)
				!
				Call SqlPrepare( hSql(), Tbl_GPK.strSqlUpdate )
				Call SalTblDoUpdates( hWndForm, hSql(), TRUE)
				!
				If SqlPLSQLCommand(hSql(), "CCK.CC_GPK_LIM (nND, nAcc8, BDAT_1, FDAT_, SUMR_ ) " )
						and SqlPLSQLCommand(hSql(),"CCK.cc_TMP_GPK( nND, nVid, nAcc8, DAT3, DAT4, ASG_SN, SUMR_ , gl_BDATE ) " )
					Call SqlCommit( hSql() )
					Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Else
					Call SqlRollback(hSql())
					Call MessageNoWait('Неуспешное Сохранение ', 'Ошибка', 0, 1)
				Call SalWaitCursor(FALSE)
	Dialog Box: dlg_GPK
		Class:
		Property Template:
		Class DLL Name:
		Title: Выбор способа погашения:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   0.625"
				Top:    0.625"
				Width:  6.333"
				Width Editable? Yes
				Height: 4.655"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Group Box: Способ разбивки
				Resource Id: 48162
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.167"
					Top:    0.071"
					Width:  5.867"
					Width Editable? Yes
					Height: 1.226"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
			Radio Button: rbReset !! 1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 1.Погашение кредита равными суммами
				Window Location and Size
					Left:   0.383"
					Top:    0.321"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Red
				Background Color: Default
				Message Actions
			Radio Button: rbLast  !! 2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 2.Возврат всей суммы кредита в конце срока
				Window Location and Size
					Left:   0.383"
					Top:    0.631"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Red
				Background Color: Default
				Message Actions
			Radio Button: rbEqual !! 3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 3.Погашение кредита равными долями с %%
				Window Location and Size
					Left:   0.383"
					Top:    0.94"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Red
				Background Color: Default
				Message Actions
			!
			Group Box: Способ округления
				Resource Id: 48163
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.067"
					Top:    1.536"
					Width:  5.867"
					Width Editable? Yes
					Height: 2.083"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Blue
				Background Color: Default
			Radio Button: rb0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 0. Коп  1123.45
				Window Location and Size
					Left:   0.383"
					Top:    1.845"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Blue
				Background Color: Default
				Message Actions
			Radio Button: rb1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 1. 10 "Коп"  1123.50
				Window Location and Size
					Left:   0.383"
					Top:    2.119"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Blue
				Background Color: Default
				Message Actions
			Radio Button: rb2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 2.  100 "коп" 1124.00
				Window Location and Size
					Left:   0.383"
					Top:    2.393"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Blue
				Background Color: Default
				Message Actions
			Radio Button: rb3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 3. 1000 "Коп"   1120.00
				Window Location and Size
					Left:   0.383"
					Top:    2.667"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Blue
				Background Color: Default
				Message Actions
			Radio Button: rb4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 4. 10000 "Коп"   1100.00
				Window Location and Size
					Left:   0.383"
					Top:    2.94"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Blue
				Background Color: Default
				Message Actions
			Radio Button: rb5
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 5. 100000 "Коп"   1000.00
				Window Location and Size
					Left:   0.383"
					Top:    3.214"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Blue
				Background Color: Default
				Message Actions
			!
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Переразбить
				Window Location and Size
					Left:   0.35"
					Top:    3.667"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.5"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Enter
				Font Name: Arial Cyr
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nSelected = 0
						If rbReset
							Set nSelected = 1
						Else If rbLast
							Set nSelected = 2
						Else If rbEqual
							Set nSelected = 3
						!
						If rb0
							Set nDig = 0
						Else If rb1
							Set nDig = 1
						Else If rb2
							Set nDig = 2
						Else If rb3
							Set nDig = 3
						Else If rb4
							Set nDig = 4
						Else If rb5
							Set nDig = 5
						Call SalEndDialog(hWndForm, 1)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сброс
				Window Location and Size
					Left:   1.583"
					Top:    3.655"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.5"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Esc
				Font Name: Arial Cyr
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, 0)
		Functions
		Window Parameters
			Receive Number: nSelected
			Receive Number: nDig
		Window Variables
		Message Actions
			On SAM_Create
				If nSelected = 1
					Set rbReset = TRUE
				Else If nSelected = 2
					Set rbLast = TRUE
				Else If nSelected = 3
					Set rbEqual = TRUE
				!
				If nDig = 0
					Set rb0 = TRUE
				Else If nDig = 1
					Set rb1 = TRUE
				Else If nDig = 2
					Set rb2 = TRUE
				Else If nDig = 3
					Set rb3 = TRUE
				Else If nDig = 4
					Set rb4 = TRUE
				Else If nDig = 5
					Set rb5 = TRUE
				!
				Call SalCenterWindow(hWndForm)
	! cGenericTableFrm: BL !
.winattr class Form Window:
		Class: cGenericTableFrm
		Property Template:
		Class DLL Name:
		Title: Чорний список ФО
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.275"
				Top:    0.344"
				Width:  12.867"
				Width Editable? Yes
				Height: 6.476"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
.end
		                     Description: 
		                     Named Menus 
		                     Menu 
		                     Tool Bar 
			                     Contents 
				                     Pushbutton: pbIns
					                     Message Actions 
						                     On SAM_Create
							                     Set strTip = 'Добавить новую запись'
							                     Call SalDisableWindow( pbIns )
							                     If nPar = 0
								                     Call SalDisableWindow( pbIns )
						                     On SAM_Click
							                     Call SalSendMsg( hWndLost, UM_Insert, 0, 0 )
				                     Pushbutton: pbDel
					                     Message Actions 
						                     On SAM_Create
							                     Set strTip = 'Пометить/Снять пометку на удаление'
							                     If nPar = 0
								                     Call SalDisableWindow( pbDel )
						                     On SAM_Click
							                     Call SalSendMsg( hWndLost, UM_Delete, 0, 0 )
				                     Pushbutton: pbRefresh
					                     Message Actions 
				                     Pushbutton: pbUpdate
					                     Message Actions 
						                     On SAM_Create
							                     Set strTip = 'Внести изменения в Базу Данных'
							                     If nPar = 0
								                     Call SalDisableWindow( pbUpdate )
						                     On SAM_Click
							                     Call SalSendMsg( hWndLost, UM_Update, 0, 0)
				                     Line 
				                     Pushbutton: pbSearch
					                     Message Actions 
				                     Pushbutton: pbFilter
					                     Message Actions 
				                     Pushbutton: pbDetails
					                     Message Actions 
				                     Pushbutton: pbPrint
					                     Message Actions 
				                     Line 
				                     Pushbutton: pbExit
					                     Message Actions 
				                     Line 
				                     Pushbutton: pbLoad
					                     Message Actions 
						                     On SAM_Click
							                     If SalModalDialog(BL_FILES, hWndForm)
							! Call MessageNoWait('1','Сообщение',3,0)
						                     On SAM_Create
							                     Set strTip = 'Завантаження даних для чорного списка'
		                     Contents 
			!
			                     Child Table: tbl
				                     Contents 
					                     Column: PERSON_ID
						                     List Values 
						                     Message Actions 
					                     Column: INN
						                     List Values 
						                     Message Actions 
					                     Column: LNAME
						                     List Values 
						                     Message Actions 
							                     On SAM_Validate
								! If BR_TYPE != 3 and BR_TYPE !=6 OR BR_TYPE=NUMBER_Null
									                                            Set BR_TYPE = nTmp
							                     On SAM_SetFocus
								! If BR_TYPE = NUMBER_Null
									                                            Set BR_TYPE = 3
								! Set nTmp = BR_TYPE
					                     Column: FNAME
						                     List Values 
						                     Message Actions 
					                     Column: MNAME
						                     List Values 
						                     Message Actions 
					                     Column: BDATE
						                     List Values 
						                     Message Actions 
					                     Column: INN_DATE
						                     List Values 
						                     Message Actions 
					                     Column: INS_DATE
						                     List Values 
						                     Message Actions 
				                     Functions 
				                     Window Variables 
				                     Message Actions 
					                     On SAM_Create
						                     Set BL.strSqlDelete = "delete from bl_person where person_id = :BL.tbl.PERSON_ID "
						                     Set BL.strSqlInsert = "insert into bl_person (inn,lname,fname,mname,bdate,inn_date) 
								                                                          values (:BL.tbl.INN,:BL.tbl.LNAME,:BL.tbl.FNAME,:BL.tbl.MNAME,:BL.tbl.BDATE,:BL.tbl.INN_DATE) "
						                     Set BL.strSqlUpdate = "update bl_person 
								                                               set inn=:BL.tbl.INN,lname=:BL.tbl.LNAME,fname=:BL.tbl.FNAME,mname=:BL.tbl.MNAME,bdate=:BL.tbl.BDATE,inn_date=:BL.tbl.INN_DATE
								                                          where person_id = :BL.tbl.PERSON_ID"
						                     Call SalSendClassMessage(SAM_Create, 0, 0)
					                     On SAM_CreateComplete
						                     Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
					                     On UM_Populate
						! Call MessageNoWait(sFilter,'Сообщение',3,0)
						                     Call SalWaitCursor(TRUE)
						                     Set BL.strSqlPopulate =
								"SELECT person_id,inn,lname,fname,mname,bdate,inn_date,ins_date
								 into :PERSON_ID,:tbl.INN,:tbl.LNAME,:tbl.FNAME,:tbl.MNAME,:tbl.BDATE,:tbl.INN_DATE,:tbl.INS_DATE
								 FROM  BL_PERSON  WHERE rownum<1000  "
								 ||  IifS (sFilter = "", "", " and " || sFilter )||
								 "  ORDER BY LNAME "
						                     Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						                     Call SalTblPopulate(hWndForm, hSql(), BL.strSqlPopulate, TBL_FillAll )
						                     Set nRow = VisTblFindString (tbl, 0, tbl.PERSON_ID, Str(nSch))
						                     If nRow=-1
							                     Call SalTblSetContext( hWndForm, 0 )
						                     Else 
							                     Call SalTblSetContext ( hWndForm, nRow )
							                     Call SalTblSetRowFlags( hWndForm, nRow, ROW_Selected, TRUE )
							                     Call SalTblSetFocusRow( hWndForm, nRow )
						                     Call SalSendMsg( hWndForm, SAM_TblDoDetails, 0, 0 )
						                     Call SalWaitCursor(FALSE)
					                     On SAM_TblDoDetails
						                     Set nSch=tbl.PERSON_ID
						                     Call SalSendMsg( tbl2, UM_Populate, 0, 0 )
						                     Call SalSendMsg( tbl3, UM_Populate, 0, 0 )
					                     On SAM_SetFocus
						                     If nPar = 1
							! Call SalEnableWindow( pbIns )
							                     Call SalEnableWindow( pbDel )
					                     On SAM_KillFocus
						                     Set hWndLost = BL.tbl
					                     On UM_Update
						                     Call SalWaitCursor(TRUE)
						!
						                     Call SqlPrepare( hSql(), BL.strSqlDelete)
						                     Call SalTblDoDeletes( BL.tbl, hSql(),ROW_MarkDeleted)
						!
						                     Call SqlPrepare( hSql(), BL.strSqlInsert)
						                     Call SalTblDoInserts( BL.tbl, hSql(), TRUE)
						!
						                     Call SqlPrepare( hSql(), BL.strSqlUpdate)
						                     Call SalTblDoUpdates( BL.tbl, hSql(), TRUE)
						!
						                     Call SqlCommit(hSql())
						! Call SalPostMsg( BL.tbl, UM_Populate, 0, 0)
						                     Call SalSendMsg(BL.tbl, UM_Populate, 0, 0)
						                     Call SalWaitCursor(FALSE)
					                     On UM_Insert
						                     If not SalTblAnyRows( BL.tbl, ROW_New, 0)
							                     Call SalTblDefineSplitWindow( BL.tbl, 1, TBL_Split_Adjustable)
						                     Set nRow = SalTblInsertRow( BL.tbl, TBL_MinRow)
						                     Call SalTblSetContext( BL.tbl, nRow)
						                     If SqlPrepareAndExecute( hSql(),
								"select min(c.num) into :tbl.BR_ID from conductor c where c.num not in (select BR_ID from brates)")
								and SqlFetchNext( hSql(),nFetchRes)
							                     Set nSch = tbl.PERSON_ID
						                     Call SalTblSetFocusCell( BL.tbl, nRow,  BL.tbl.INN, 0, 1)
					                     On UM_Delete
						                     Set nRow = TBL_MinRow
						                     While SalTblFindNextRow( BL.tbl, nRow, ROW_Selected, 0)
							                     If NOT SalTblQueryRowFlags( BL.tbl, nRow, ROW_New)
								                     Call SalTblSetRowFlags(BL.tbl, nRow, ROW_MarkDeleted,
										     not SalTblQueryRowFlags(BL.tbl, nRow, ROW_MarkDeleted))
							                     Else 
								                     Call SalTblDeleteRow( BL.tbl, nRow, TBL_NoAdjust)
			!
			                     Custom Control: cVSpl
				                     Message Actions 
				! Message Actions
			                     Custom Control: cHSpl
				                     Message Actions 
				! Message Actions
			!
			                     Child Table: tbl2
				                     Contents 
					                     Column: PERSON_ID
						                     List Values 
						                     Message Actions 
					                     Column: PASSPORT_ID
						                     List Values 
						                     Message Actions 
					                     Column: PASS_SER
						                     List Values 
						                     Message Actions 
					                     Column: PASS_NUM
						                     List Values 
						                     Message Actions 
					                     Column: PASS_REGION
						                     List Values 
						                     Message Actions 
					                     Column: PASS_OFFICE
						                     List Values 
						                     Message Actions 
					                     Column: PASS_DATE
						                     List Values 
						                     Message Actions 
					                     Column: INS_DATE
						                     List Values 
						                     Message Actions 
				                     Functions 
				                     Window Variables 
					                     String: strSqlPopulate2
					                     String: strSqlDelete2
					                     String: strSqlInsert2
					                     String: strSqlUpdate2
				                     Message Actions 
					                     On SAM_Create
						                     Set strSqlPopulate2=
								"SELECT p.passport_id,p.person_id,p.pass_ser,p.pass_num,p.ins_date,p.pass_date,p.pass_region,substr(p.pass_office,1,245)
								       INTO :tbl2.PASSPORT_ID,:tbl2.PERSON_ID,:tbl2.PASS_SER,:tbl2.PASS_NUM,:tbl2.INS_DATE,:tbl2.PASS_DATE,:tbl2.PASS_REGION,:tbl2.PASS_OFFICE
								 FROM BL_PASSPORT p  WHERE p.person_id=:nSch order by p.pass_date "
						                     Set strSqlDelete2='DELETE FROM BL_PASSPORT WHERE passport_id=:PASSPORT_ID'
						                     Set strSqlInsert2='INSERT INTO BL_PASSPORT  (person_id,pass_ser,pass_num,ins_date,pass_date,pass_region,pass_office) 
								                                                                     values (:nSch,:PASS_SER,:PASS_NUM,:INS_DATE,:PASS_DATE,:PASS_REGION,:PASS_OFFICE)'
						                     Set strSqlUpdate2='UPDATE BL_PASSPORT
								    SET pass_ser=:PASS_SER, pass_num=:PASS_NUM,pass_date=:PASS_DATE,pass_office=:PASS_OFFICE,pass_region=:PASS_REGION
								where passport_id=:PASSPORT_ID '
						!
					                     On SAM_CreateComplete
						                     Call SalSendMsg( BL.tbl2, UM_Populate, 0, 0 )
					                     On UM_Populate
						                     Call SalWaitCursor(TRUE)
						! Call MessageNoWait('2','Сообщение',3,0)
						                     Call SalTblDefineSplitWindow( BL.tbl2, 0, FALSE)
						                     Call SalTblPopulate( BL.tbl2, hSql(), strSqlPopulate2, TBL_FillAll)
						                     Call SalWaitCursor(FALSE)
					                     On SAM_SetFocus
						                     If nPar = 1
							! Call SalEnableWindow( pbIns )
							                     Call SalEnableWindow( pbDel )
					                     On SAM_KillFocus
						                     Set hWndLost = BL.tbl2
					                     On UM_Update
						                     Call SalWaitCursor(TRUE)
						!
						                     Call SqlPrepare( hSql(), strSqlDelete2)
						                     Call SalTblDoDeletes( BL.tbl2, hSql(),ROW_MarkDeleted)
						!
						                     Call SqlPrepare( hSql(), strSqlInsert2)
						                     Call SalTblDoInserts( BL.tbl2, hSql(), TRUE)
						!
						                     Call SqlPrepare( hSql(), strSqlUpdate2)
						                     Call SalTblDoUpdates( BL.tbl2, hSql(), TRUE)
						!
						                     Call SqlCommit(hSql())
						! Call SalPostMsg( BL.tbl2, UM_Populate, 0, 0)
						                     Call SalSendMsg(BL.tbl2, UM_Populate, 0, 0)
						                     Call SalWaitCursor(FALSE)
					                     On UM_Insert
						                     If not SalTblAnyRows( BL.tbl2, ROW_New, 0)
							                     Call SalTblDefineSplitWindow( BL.tbl2, 3, TBL_Split_Adjustable)
						                     Set nRow = SalTblInsertRow( BL.tbl2, TBL_MinRow)
						                     Call SalTblSetContext( BL.tbl2, nRow)
						                     Call SalTblSetFocusCell( BL.tbl2, nRow,  BL.tbl2.PASS_SER, 0, 1)
					                     On UM_Delete
						                     Set nRow = TBL_MinRow
						                     While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
							                     If NOT SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
								                     Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted,
										     not SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted))
							                     Else 
								                     Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
					! On SAM_FetchRowDone
						                                                                        Call tbl2.colFreqn.SetSelectById( tbl2.colFreq )
					! On SAM_DoubleClick
						                                                                        If tbl2.IDD != NUMBER_Null
							                                                                        Call SalModalDialog(dlgCalendar, hWndForm, tbl.NMK, tbl2.colNlsA,
									tbl2.IDD, tbl2.colFreq, tbl2.colDat1, tbl2.colDat2, tbl2.WEND, tbl2.colFreqn )
			!
			                     Child Table: tbl3
				                     Contents 
					                     Column: REASON_GROUP_ID
						                     List Values 
						                     Message Actions 
					                     Column: REASON_GROUP
						                     List Values 
						                     Message Actions 
							                     On SAM_Create
								                     If REASON_GROUP.Init( hWndItem )
									                     Call REASON_GROUP.Populate( hSql(), "REASON_GROUP", "REASON", "BL_REASON_DICT", " WHERE 1=1 ORDER BY REASON_GROUP" )
							                     On SAM_AnyEdit
								                     Set REASON_GROUP_ID= REASON_GROUP.GetKey( SalListQuerySelection(hWndItem))
							                     On SAM_SetFocus
								                     Call SalMapEnterToTab( TRUE )
					                     Column: BASE
						                     List Values 
						                     Message Actions 
					                     Column: INFO_SOURCE
						                     List Values 
						                     Message Actions 
					                     Column: COMMENT_TEXT
						                     List Values 
						                     Message Actions 
					                     Column: INS_DATE
						                     List Values 
						                     Message Actions 
					                     Column: USER_TXT
						                     List Values 
						                     Message Actions 
					                     Column: PERSON_ID
						                     List Values 
						                     Message Actions 
					                     Column: REASON_ID
						                     List Values 
						                     Message Actions 
				                     Functions 
					                     Function: F_UPD
						                     Description: 
						                     Returns 
							                     Boolean: 
						                     Parameters 
						                     Static Variables 
						                     Local variables 
						                     Actions 
							                     Call SalWaitCursor( TRUE )
							                     Set nRow = TBL_MinRow
							                     While SalTblFindNextRow(BL.tbl3, nRow, ROW_Edited, 0)
								                     Call SalTblSetContext(BL.tbl3, nRow)
								                     If NOT SqlPrepareAndExecute( hSql(),"delete from br_branch where branch=:BRANCH and BR=:nSch " )
									                     Return FALSE
								!
								! If BL.tbl3.OTM = 1
									                                            If NOT SqlPrepareAndExecute( hSql(),"insert into br_branch(branch,br) values (:BRANCH,:nSch) " )
										                                            Return FALSE
							!
							                     Return TRUE
				                     Window Variables 
					                     String: strSqlPop
					                     String: strSqlDelete3
					                     String: strSqlInsert3
					                     String: strSqlUpdate3
				                     Message Actions 
					                     On SAM_Create
						                     Set strSqlPop =
								"SELECT r.reason_id,r.person_id,r.reason_group,s.reason,r.base,r.info_source,r.comment_text,r.ins_date,nvl(f.fio, to_char(r.user_id))usr
								 INTO    :REASON_ID,:PERSON_ID,:REASON_GROUP_ID,:REASON_GROUP,:BASE,:INFO_SOURCE,:COMMENT_TEXT,:INS_DATE,:USER_TXT
								 FROM bl_reason r,bl_reason_dict s, bars.staff f
								 WHERE r.reason_group=s.reason_group  and r.person_id=:nSch and r.user_id=f.id(+) 
								 order by r.reason_id"
						                     Set strSqlDelete3='DELETE FROM BL_REASON WHERE reason_id=:REASON_ID'
						                     Set strSqlInsert3='INSERT INTO BL_REASON  (reason_id,person_id,reason_group,base,info_source,comment_text)
								                               values (:REASON_ID,:PERSON_ID,:REASON_GROUP_ID,:BASE,:INFO_SOURCE,:COMMENT_TEXT)'
						                     Set strSqlUpdate3='UPDATE BL_REASON
								    SET reason_group=:REASON_GROUP_ID,base=:BASE,info_source=:INFO_SOURCE,comment_text=:COMMENT_TEXT
								where reason_id=:REASON_ID'
					                     On SAM_CreateComplete
						                     Call SalSendMsg( BL.tbl3, UM_Populate, 0, 0 )
					                     On UM_Populate
						                     Call SalWaitCursor(TRUE)
						! Call MessageNoWait('3','Сообщение',3,0)
						                     Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						! Call SalTblPopulate(hWndForm, hSql(), strSqlPop, TBL_FillAll )
						                     Call SalTblPopulate( BL.tbl3, hSql(), strSqlPop, TBL_FillAll)
						                     Call SalWaitCursor(FALSE)
					                     On SAM_SetFocus
					                     On SAM_KillFocus
						                     Set hWndLost = BL.tbl3
					                     On UM_Update
						! If tbl3.F_UPD()
							                                          Call SqlCommit( hSql())
						! Else 
							                                          Call SqlRollback( hSql())
						                     Call SalWaitCursor(TRUE)
						!
						                     Call SqlPrepare( hSql(), strSqlDelete3)
						                     Call SalTblDoDeletes( BL.tbl3, hSql(),ROW_MarkDeleted)
						!
						                     Call SqlPrepare( hSql(), strSqlInsert3)
						                     Call SalTblDoInserts( BL.tbl3, hSql(), TRUE)
						!
						                     Call SqlPrepare( hSql(), strSqlUpdate3)
						                     Call SalTblDoUpdates( BL.tbl3, hSql(), TRUE)
						!
						                     Call SqlCommit(hSql())
						                     Call SalSendMsg(BL.tbl3, UM_Populate, 0, 0)
						                     Call SalWaitCursor(FALSE)
					                     On UM_Insert
						                     If not SalTblAnyRows( BL.tbl3, ROW_New, 0)
							                     Call SalTblDefineSplitWindow( BL.tbl3, 3, TBL_Split_Adjustable)
						                     Set nRow = SalTblInsertRow( BL.tbl3, TBL_MinRow)
						                     Call SalTblSetContext( BL.tbl3, nRow)
						                     Call SalTblSetFocusCell( BL.tbl3, nRow,  BL.tbl3.REASON_GROUP, 0, 1)
					                     On UM_Delete
						                     Set nRow = TBL_MinRow
						                     While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
							                     If NOT SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
								                     Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted,
										     not SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted))
							                     Else 
								                     Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
			!
		                     Functions 
		                     Window Parameters 
			                     Number: nMode
			                     Number: nPar
			                     String: strPar01
			                     String: strPar02
		                     Window Variables 
			                     Window Handle: hWndLost
			                     Number: nRow
			                     Number: nSch
			                     Number: nTmp
			                     String: sFilter
			                     : cF
			                     String: BadFile
		                     Message Actions 
			                     On SAM_Create
				                     Call PrepareWindowEx(hWndForm)
				                     Call cF.Init( 'BL_PERSON' , 'BL_PERSON' )
				!
				                     Set hWndForm.BL.strFilterTblName = 'BL_PERSON'
				                     Set hWndForm.BL.strPrintFileName = 'bl_person.txt'
				                     Set hWndForm.BL.fFilterAtStart = 1
				                     Set hWndForm.BL.nTabInstance = 1
				! cF.GetFilterWhereClause( FALSE )
				! Call SetWindowFullSize(hWndForm)
				                     Call SalShowWindow(cVSpl)
				                     Call SalShowWindow(cHSpl)
				!
				                     Call cVSpl.setBarPosition(600)
				                     Call cVSpl.setLeftFrame(cHSpl)
				                     Call cVSpl.setRightFrame(tbl3)
				!
				                     Call cHSpl.setBarPosition(500)
				                     Call cHSpl.setTopFrame(tbl)
				                     Call cHSpl.setBottomFrame(tbl2)
				!
				                     Call SalSendClassMessage(SAM_Create, 0, 0)
			                     On SAM_Activate
				                     Call SalWaitCursor(FALSE)
				                     If hWndForm.BL.fFilterAtStart
					                     Set hWndForm.BL.fFilterAtStart = NOT hWndForm.BL.fFilterAtStart
					                     If NOT SetQueryFilter( cF )
						                     Call SalDestroyWindow( hWndForm )
				                     Set sFilter = cF.GetFilterWhereClause(FALSE)
	Form Window: BL !
		Class: cGenericTableFrm
		Property Template:
		Class DLL Name:
		Title: Чорний список ФО
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.275"
				Top:    0.344"
				Width:  16.7"
				Width Editable? Class Default
				Height: 8.5"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Добавить новую запись'
							If nPar = 9
								Call SalDisableWindow( pbIns )
						On SAM_Click
							Call SalSendMsg( hWndLost, UM_Insert, 0, 0 )
				Pushbutton: pbDel
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Пометить/Снять пометку на удаление'
							If nPar = 0
								Call SalDisableWindow( pbDel )
						On SAM_Click
							Call SalSendMsg( hWndLost, UM_Delete, 0, 0 )
				Pushbutton: pbRefresh
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Внести изменения в Базу Данных'
							If nPar = 0
								Call SalDisableWindow( pbUpdate )
						On SAM_Click
							Call SalSendMsg( hWndLost, UM_Update, 0, 0)
				Line
					Resource Id: 9090
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If SetQueryFilter( cF )
								Set sFilter = cF.GetFilterWhereClause(FALSE)
								! Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
								Call SalSendMsg(tbl, UM_Populate, 0, 0)
								! Call SalSendMsg(tbl2, UM_Populate, 0, 0)
								! Call SalSendMsg(tbl3, UM_Populate, 0, 0)
				Pushbutton: pbDetails
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Перегляд історії змін'
						On SAM_Click
							! Call SalSendMsg( hWndLost, UM_Insert, 0, 0 )
							If SalWindowHandleToNumber ( hWndLost) = SalWindowHandleToNumber ( BL.tbl)
								Set sTmp='BL_PERSON_UPDATE.PERSON_ID='||Str(tbl.PERSON_ID)
								Call FunNSIEditFFiltered('BL_PERSON_UPDATE',1,sTmp)
							If SalWindowHandleToNumber ( hWndLost) = SalWindowHandleToNumber ( BL.tbl2)
								Set sTmp='BL_PASSPORT_UPDATE.PERSON_ID='||Str(tbl.PERSON_ID)
								Call FunNSIEditFFiltered('BL_PASSPORT_UPDATE',1,sTmp)
							If SalWindowHandleToNumber ( hWndLost) = SalWindowHandleToNumber ( BL.tbl3)
								Set sTmp='BL_REASON_UPDATE.PERSON_ID='||Str(tbl.PERSON_ID)
								Call FunNSIEditFFiltered('BL_REASON_UPDATE',1,sTmp)
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 9091
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 24
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 9092
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbLoad
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.083"
						Top:    0.071"
						Width:  0.5"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\a_link.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If SalModalDialog(BL_FILES, hWndForm)
							! Call MessageNoWait('1','Сообщение',3,0)
						On SAM_Create
							Set strTip = 'Завантаження даних для чорного списка'
		Contents
			!
			Child Table: tbl
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableFrm
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  9.017"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Maize
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? Class Default
				Contents
					Column: PERSON_ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								баз.ст.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.817"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: INN
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Ідентифікаційний
								код ФО
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.567"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: LNAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Призвище
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  2.167"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Validate
								! If BR_TYPE != 3 and BR_TYPE !=6 OR BR_TYPE=NUMBER_Null
									                                                  Set BR_TYPE = nTmp
							On SAM_SetFocus
								! If BR_TYPE = NUMBER_Null
									                                                  Set BR_TYPE = 3
								! Set nTmp = BR_TYPE
					Column: FNAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Ім'я
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.833"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: MNAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: По батькові
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.467"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: BDATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								 народження
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: INN_DATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата отримання
								ідентифікаційного коду
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  2.083"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: INS_DATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата внесення
								у список
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: BASE_ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Істочник
								отримання інфорації
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  2.133"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								If BASE_ID.Init( hWndItem )
									Call BASE_ID.Populate( hSql(), "BASE_ID", "NAME", "BL_BASE_DICT", " ORDER BY NAME" )
							On SAM_AnyEdit
								Set nBASE_ID= BASE_ID.GetKey( SalListQuerySelection(hWndItem))
							On SAM_SetFocus
								Call SalMapEnterToTab( TRUE )
							! On SAM_AnyEdit
								                       If BASE_ID=STRING_Null
									                       Set nBASE_ID=NUMBER_Null
					Column: nBASE_ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код источника
								получения информации
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.5"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Set BL.strSqlDelete = "delete from v_bl_person where person_id = :BL.tbl.PERSON_ID and base_id=:tbl.nBASE_ID"
						Set BL.strSqlInsert = "insert into v_bl_person (inn,lname,fname,mname,bdate,inn_date,base_id)
								                                                          values (:BL.tbl.INN,:BL.tbl.LNAME,:BL.tbl.FNAME,:BL.tbl.MNAME,:BL.tbl.BDATE,:BL.tbl.INN_DATE,:tbl.nBASE_ID) "
						Set BL.strSqlUpdate = "update v_bl_person
								                                               set inn=:BL.tbl.INN,lname=:BL.tbl.LNAME,fname=:BL.tbl.FNAME,mname=:BL.tbl.MNAME,bdate=:BL.tbl.BDATE,inn_date=:BL.tbl.INN_DATE
								                                          where person_id = :BL.tbl.PERSON_ID and base_id=:tbl.nBASE_ID"
						Call SalSendClassMessage(SAM_Create, 0, 0)
					On SAM_CreateComplete
						Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
					On UM_Populate
						! Call MessageNoWait(sFilter,'Сообщение',3,0)
						Call SalWaitCursor(TRUE)
						Set BL.strSqlPopulate =
								"SELECT BL_PERSON.person_id,BL_PERSON.inn,BL_PERSON.lname,BL_PERSON.fname,BL_PERSON.mname,BL_PERSON.bdate,BL_PERSON.inn_date,BL_PERSON.ins_date,BL_PERSON.base_id,BL_BASE_DICT.name
								 into :PERSON_ID,:tbl.INN,:tbl.LNAME,:tbl.FNAME,:tbl.MNAME,:tbl.BDATE,:tbl.INN_DATE,:tbl.INS_DATE,:nBASE_ID,:BASE_ID
								 FROM  BL_PERSON , BL_BASE_DICT   WHERE BL_PERSON.base_id=BL_BASE_DICT.base_id and rownum<=2000  "
								 ||  IifS (sFilter = "", "", " and " || sFilter )||
								 "  ORDER BY LNAME "
						Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						Call SalTblPopulate(hWndForm, hSql(), BL.strSqlPopulate, TBL_FillAll )
						Set nRow = VisTblFindString (tbl, 0, tbl.PERSON_ID, Str(nSch))
						If nRow=-1
							Call SalTblSetContext( hWndForm, 0 )
						Else
							Call SalTblSetContext ( hWndForm, nRow )
							Call SalTblSetRowFlags( hWndForm, nRow, ROW_Selected, TRUE )
							Call SalTblSetFocusRow( hWndForm, nRow )
						Call SalSendMsg( hWndForm, SAM_TblDoDetails, 0, 0 )
						Call SalWaitCursor(FALSE)
					On SAM_TblDoDetails
						Set nSch=tbl.PERSON_ID
						Call SalSendMsg( tbl2, UM_Populate, 0, 0 )
						Call SalSendMsg( tbl3, UM_Populate, 0, 0 )
					On SAM_SetFocus
						Call SalEnableWindow( pbIns )
						! If BASE_ID > 0
							                       Call SalDisableWindow( pbIns )
					On SAM_KillFocus
						Set hWndLost = BL.tbl
					On UM_Update
						Call SalWaitCursor(TRUE)
						!
						Call SqlPrepare( hSql(), BL.strSqlDelete)
						Call SalTblDoDeletes( BL.tbl, hSql(),ROW_MarkDeleted)
						!
						Call SqlPrepare( hSql(), BL.strSqlInsert)
						Call SalTblDoInserts( BL.tbl, hSql(), TRUE)
						!
						Call SqlPrepare( hSql(), BL.strSqlUpdate)
						Call SalTblDoUpdates( BL.tbl, hSql(), TRUE)
						!
						Call SqlCommit(hSql())
						! Call SalPostMsg( BL.tbl, UM_Populate, 0, 0)
						Call SalSendMsg(BL.tbl, UM_Populate, 0, 0)
						Call SalWaitCursor(FALSE)
					On UM_Insert
						If not SalTblAnyRows( BL.tbl, ROW_New, 0)
							Call SalTblDefineSplitWindow( BL.tbl, 1, TBL_Split_Adjustable)
						Set nRow = SalTblInsertRow( BL.tbl, TBL_MinRow)
						Call SalTblSetContext( BL.tbl, nRow)
						!
						Set tbl.nBASE_ID=NUMBER_Null
						! Set tbl.nBASE_ID=0
						! Set tbl.BASE_ID=BASE_ID.GetName(0)
						! If SqlPrepareAndExecute( hSql(),
								"select min(c.num) into :tbl.BR_ID from conductor c where c.num not in (select BR_ID from brates)")
								and SqlFetchNext( hSql(),nFetchRes)
							                       Set nSch = tbl.PERSON_ID
						Call SalTblSetFocusCell( BL.tbl, nRow,  BL.tbl.INN, 0, 1)
					On UM_Delete
						Set nRow = TBL_MinRow
						While SalTblFindNextRow( BL.tbl, nRow, ROW_Selected, 0)
							If NOT SalTblQueryRowFlags( BL.tbl, nRow, ROW_New)
								Call SalTblSetRowFlags(BL.tbl, nRow, ROW_MarkDeleted,
										     not SalTblQueryRowFlags(BL.tbl, nRow, ROW_MarkDeleted))
							Else
								Call SalTblDeleteRow( BL.tbl, nRow, TBL_NoAdjust)
					On SAM_FetchRowDone
						If tbl.nBASE_ID> 0
							! Call XSalTblSetCellBackColor(hWndForm.Tbl_An.DOS, SalColorFromRGB( 255,210,250 ) )
							! Call XSalTblSetRowBackColor(tbl, lParam, COLOR_Red)434343
							Call VisTblSetRowColor(hWndForm, lParam, 0x505050)
						Call SalTblSetCellTextColor ( tbl.INN, COLOR_Red, TRUE )
			!
			Custom Control: cVSpl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitter
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    0.0"
						Width:  15.283"
						Width Editable? Class Default
						Height: 6.155"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
				! Message Actions
			Custom Control: cHSpl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalHSplitter
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    0.0"
						Width:  9.183"
						Width Editable? Class Default
						Height: 2.155"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
				! Message Actions
			!
			Child Table: tbl2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.133"
						Top:    2.333"
						Width:  9.05"
						Width Editable? Yes
						Height: 2.293"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Light Green
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? Yes
				Contents
					Column: PERSON_ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PASSPORT_ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PASS_SER
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Серія
								паспорта
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PASS_NUM
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Номер
								паспорта
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PASS_REGION
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Регіон видачі
								паспорта
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.9"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PASS_OFFICE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Ким
								виданий
								паспорт
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PASS_DATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата видачі
								паспорта
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: INS_DATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата внесення
								у список
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
					String: strSqlPopulate2
					String: strSqlDelete2
					String: strSqlInsert2
					String: strSqlUpdate2
				Message Actions
					On SAM_Create
						Set strSqlPopulate2=
								"SELECT p.passport_id,p.person_id,p.pass_ser,p.pass_num,p.ins_date,p.pass_date,p.pass_region,substr(p.pass_office,1,245)
								       INTO :tbl2.PASSPORT_ID,:tbl2.PERSON_ID,:tbl2.PASS_SER,:tbl2.PASS_NUM,:tbl2.INS_DATE,:tbl2.PASS_DATE,:tbl2.PASS_REGION,:tbl2.PASS_OFFICE
								 FROM BL_PASSPORT p WHERE p.person_id=:nSch and p.base_id=:tbl.nBASE_ID order by p.pass_date "
						Set strSqlDelete2='DELETE FROM V_BL_PASSPORT WHERE passport_id=:PASSPORT_ID and base_id=:tbl.nBASE_ID'
						Set strSqlInsert2='INSERT INTO V_BL_PASSPORT  (person_id,pass_ser,pass_num,ins_date,pass_date,pass_region,pass_office,base_id)
								                                                                     values (:nSch,:PASS_SER,:PASS_NUM,:INS_DATE,:PASS_DATE,:PASS_REGION,:PASS_OFFICE,:tbl.nBASE_ID)'
						Set strSqlUpdate2='UPDATE V_BL_PASSPORT
								    SET pass_ser=:PASS_SER, pass_num=:PASS_NUM,pass_date=:PASS_DATE,pass_office=:PASS_OFFICE,pass_region=:PASS_REGION
								where passport_id=:PASSPORT_ID and base_id=:tbl.nBASE_ID'
						!
					On SAM_CreateComplete
						Call SalSendMsg( BL.tbl2, UM_Populate, 0, 0 )
					On UM_Populate
						Call SalWaitCursor(TRUE)
						! Call MessageNoWait('2','Сообщение',3,0)
						Call SalTblDefineSplitWindow( BL.tbl2, 0, FALSE)
						Call SalTblPopulate( BL.tbl2, hSql(), strSqlPopulate2, TBL_FillAll)
						Call SalWaitCursor(FALSE)
					On SAM_SetFocus
						If tbl.nBASE_ID = 0
							Call SalEnableWindow( pbIns )
						Else
							Call SalDisableWindow( pbIns )
					On SAM_KillFocus
						Set hWndLost = BL.tbl2
					On UM_Update
						Call SalWaitCursor(TRUE)
						!
						Call SqlPrepare( hSql(), strSqlDelete2)
						Call SalTblDoDeletes( BL.tbl2, hSql(),ROW_MarkDeleted)
						!
						Call SqlPrepare( hSql(), strSqlInsert2)
						Call SalTblDoInserts( BL.tbl2, hSql(), TRUE)
						!
						Call SqlPrepare( hSql(), strSqlUpdate2)
						Call SalTblDoUpdates( BL.tbl2, hSql(), TRUE)
						!
						Call SqlCommit(hSql())
						! Call SalPostMsg( BL.tbl2, UM_Populate, 0, 0)
						Call SalSendMsg(BL.tbl2, UM_Populate, 0, 0)
						Call SalWaitCursor(FALSE)
					On UM_Insert
						If not SalTblAnyRows( BL.tbl2, ROW_New, 0)
							Call SalTblDefineSplitWindow( BL.tbl2, 3, TBL_Split_Adjustable)
						Set nRow = SalTblInsertRow( BL.tbl2, TBL_MinRow)
						Call SalTblSetContext( BL.tbl2, nRow)
						Call SalTblSetFocusCell( BL.tbl2, nRow,  BL.tbl2.PASS_SER, 0, 1)
					On UM_Delete
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
							If NOT SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
								Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted,
										     not SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted))
							Else
								Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
					! On SAM_FetchRowDone
						                                                                              Call tbl2.colFreqn.SetSelectById( tbl2.colFreq )
					! On SAM_DoubleClick
						                                                                              If tbl2.IDD != NUMBER_Null
							                                                                              Call SalModalDialog(dlgCalendar, hWndForm, tbl.NMK, tbl2.colNlsA,
									tbl2.IDD, tbl2.colFreq, tbl2.colDat1, tbl2.colDat2, tbl2.WEND, tbl2.colFreqn )
			!
			Child Table: tbl3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   9.283"
						Top:    0.0"
						Width:  5.4"
						Width Editable? Yes
						Height: 4.7"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Light Periwinkle
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? Yes
				Contents
					Column: REASON_GROUP_ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: REASON_GROUP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cGenColComboBox_NumId
						Property Template:
						Class DLL Name:
						Title: Причина постановки
								в чорний список
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  2.133"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_Create
								If REASON_GROUP.Init( hWndItem )
									Call REASON_GROUP.Populate( hSql(), "REASON_GROUP", "REASON", "BL_REASON_DICT", " WHERE 1=1 ORDER BY REASON_GROUP" )
							On SAM_AnyEdit
								Set REASON_GROUP_ID= REASON_GROUP.GetKey( SalListQuerySelection(hWndItem))
							On SAM_SetFocus
								Call SalMapEnterToTab( TRUE )
					Column: BASE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: База
								даних
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.9"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: INFO_SOURCE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Джерело
								одержання
								інформації
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: COMMENT_TEXT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Коментар
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Long String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_DoubleClick
								Set sTmp=ShowMemoEditor('Коментар',1,2000,COMMENT_TEXT)
								If COMMENT_TEXT != sTmp
									Set COMMENT_TEXT = sTmp
									Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(tbl3), ROW_Edited, TRUE)
					Column: INS_DATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата внесення
								у список
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: USER_TXT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ПІБ
								відповідального
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PERSON_ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: REASON_ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: F_UPD
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
						Actions
							Call SalWaitCursor( TRUE )
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(BL.tbl3, nRow, ROW_Edited, 0)
								Call SalTblSetContext(BL.tbl3, nRow)
								If NOT SqlPrepareAndExecute( hSql(),"delete from br_branch where branch=:BRANCH and BR=:nSch " )
									Return FALSE
								!
								! If BL.tbl3.OTM = 1
									                                                  If NOT SqlPrepareAndExecute( hSql(),"insert into br_branch(branch,br) values (:BRANCH,:nSch) " )
										                                                  Return FALSE
							!
							Return TRUE
				Window Variables
					String: strSqlPop
					String: strSqlDelete3
					String: strSqlInsert3
					String: strSqlUpdate3
				Message Actions
					On SAM_Create
						Set strSqlPop =
								"SELECT r.reason_id,r.person_id,r.reason_group,s.reason,r.base,r.info_source,r.comment_text,r.ins_date,nvl(f.fio, to_char(r.user_id))usr
								 INTO    :REASON_ID,:PERSON_ID,:REASON_GROUP_ID,:REASON_GROUP,:BASE,:INFO_SOURCE,:COMMENT_TEXT,:INS_DATE,:USER_TXT
								 FROM bl_reason r,bl_reason_dict s, bars.staff f
								 WHERE r.reason_group=s.reason_group  and r.person_id=:nSch and r.user_id=f.id(+) and r.base_id=:tbl.nBASE_ID
								 order by r.reason_id"
						Set strSqlDelete3='DELETE FROM V_BL_REASON WHERE reason_id=:REASON_ID and base_id=:tbl.nBASE_ID'
						Set strSqlInsert3='INSERT INTO V_BL_REASON  (reason_id,person_id,reason_group,base,info_source,comment_text,base_id)
								                               values (:REASON_ID,:tbl.PERSON_ID,:REASON_GROUP_ID,:BASE,:INFO_SOURCE,:COMMENT_TEXT,:tbl.nBASE_ID)'
						Set strSqlUpdate3='UPDATE V_BL_REASON
								    SET reason_group=:REASON_GROUP_ID,base=:BASE,info_source=:INFO_SOURCE,comment_text=:COMMENT_TEXT
								where reason_id=:REASON_ID and base_id=:tbl.nBASE_ID'
					On SAM_CreateComplete
						Call SalSendMsg( BL.tbl3, UM_Populate, 0, 0 )
					On UM_Populate
						Call SalWaitCursor(TRUE)
						! Call MessageNoWait('3','Сообщение',3,0)
						Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						! Call SalTblPopulate(hWndForm, hSql(), strSqlPop, TBL_FillAll )
						Call SalTblPopulate( BL.tbl3, hSql(), strSqlPop, TBL_FillAll)
						Call SalWaitCursor(FALSE)
					On SAM_SetFocus
						If tbl.nBASE_ID = 0
							Call SalEnableWindow( pbIns )
						Else
							Call SalDisableWindow( pbIns )
					On SAM_KillFocus
						Set hWndLost = BL.tbl3
					On UM_Update
						! If tbl3.F_UPD()
							                                                Call SqlCommit( hSql())
						! Else
							                                                Call SqlRollback( hSql())
						Call SalWaitCursor(TRUE)
						!
						Call SqlPrepare( hSql(), strSqlDelete3)
						Call SalTblDoDeletes( BL.tbl3, hSql(),ROW_MarkDeleted)
						!
						Call SqlPrepare( hSql(), strSqlInsert3)
						Call SalTblDoInserts( BL.tbl3, hSql(), TRUE)
						!
						Call SqlPrepare( hSql(), strSqlUpdate3)
						Call SalTblDoUpdates( BL.tbl3, hSql(), TRUE)
						!
						Call SqlCommit(hSql())
						Call SalSendMsg(BL.tbl3, UM_Populate, 0, 0)
						Call SalWaitCursor(FALSE)
					On UM_Insert
						If not SalTblAnyRows( BL.tbl3, ROW_New, 0)
							Call SalTblDefineSplitWindow( BL.tbl3, 3, TBL_Split_Adjustable)
						Set nRow = SalTblInsertRow( BL.tbl3, TBL_MinRow)
						Call SalTblSetContext( BL.tbl3, nRow)
						Call SalTblSetFocusCell( BL.tbl3, nRow,  BL.tbl3.REASON_GROUP, 0, 1)
					On UM_Delete
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
							If NOT SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
								Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted,
										     not SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted))
							Else
								Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
			!
		Functions
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Window Handle: hWndLost
			Number: nRow
			Number: nSch
			Number: nTmp
			String: sTmp
			String: sFilter
			: cF
				Class: cGenFilter
			String: BadFile
			!
			! -- for windows
			Number: nX
			Number: nY
			Number: nW
			Number: nH
			Number: nWW
			Number: nWH
			Number: tblW
			Number: tblH
			Number: tbl2W
			Number: tbl2H
			Number: nCH
			Number: nCY
		Message Actions
			On SAM_Create
				Call PrepareWindowEx(hWndForm)
				Call cF.Init( 'BL_PERSON' , 'BL_PERSON' )
				!
				Set hWndForm.BL.strFilterTblName = 'BL_PERSON'
				Set hWndForm.BL.strPrintFileName = 'bl_person.txt'
				Set hWndForm.BL.fFilterAtStart = 1
				Set hWndForm.BL.nTabInstance = 1
				! cF.GetFilterWhereClause( FALSE )
				! Call SetWindowFullSize(hWndForm)
				Call SalShowWindow(cVSpl)
				Call SalShowWindow(cHSpl)
				!
				Call cVSpl.setBarPosition(600)
				Call cVSpl.setLeftFrame(cHSpl)
				Call cVSpl.setRightFrame(tbl3)
				!
				Call cHSpl.setBarPosition(500)
				Call cHSpl.setTopFrame(tbl)
				Call cHSpl.setBottomFrame(tbl2)
				If nPar=9
					Call SalHideWindow(pbLoad)
					Call SalHideWindow(pbIns)
					Call SalHideWindow(pbUpdate)
					Call SalHideWindow(pbDel)
					Call SalHideWindow(pbPrint)
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_Activate
				Call SalWaitCursor(FALSE)
				If hWndForm.BL.fFilterAtStart
					Set hWndForm.BL.fFilterAtStart = NOT hWndForm.BL.fFilterAtStart
					If NOT SetQueryFilter( cF )
						Call SalDestroyWindow( hWndForm )
				Set sFilter = cF.GetFilterWhereClause(FALSE)
			On WM_Size
				Call SalGetWindowSize( hWndForm, nWW, nWH )
				Call SalGetWindowSize( tbl2, tblW, tblH )
				Call SalGetWindowSize( tbl3, tbl2W, tbl2H )
				!
				Call SalSetWindowSize(cVSpl, nWW, nWH-1.5)
				Call SalSetWindowSize(cHSpl, nWW, nWH-1.5)
				Call SalSetWindowSize(tbl2, tblW, tblH-1.5)
				Call SalSetWindowSize(tbl3, tbl2W, tbl2H-1.5)
				!
				! If nWW >= 8
					                         If nWH > 6
						                         Call SalSetWindowSize( tbl3, nWW-tblW,nWH )
						                         Call SalSetWindowSize( tbl2, tbl2W,nWH-4 )
					! Else
						                         Call SalSetWindowSize( hWndForm, nWW,6 )
						                         Call SalSetWindowSize( tbl3, nWW-tblW,6 )
						                         Call SalSetWindowSize( tbl2, tbl2W,2 )
				! Else
					                         If nWH > 6
						                         Call SalSetWindowSize( hWndForm, 8, nWH )
						                         Call SalSetWindowSize( tbl3,  4,nWH)
						                         Call SalSetWindowSize( tbl2, tbl2W,nWH-4 )
					                         Else
						                         Call SalSetWindowSize( hWndForm, 8, 6 )
						! Call SalSetWindowSize( tbl3, 5.4,4.7 )
						! Call SalSetWindowSize( tbl2, tbl2W,2.7 )
				!
				! Call cVSpl.setBarPosition(600)
				Call cVSpl.setLeftFrame(cHSpl)
				Call cVSpl.setRightFrame(tbl3)
				!
				! Call cHSpl.setBarPosition(500)
				Call cHSpl.setTopFrame(tbl)
				Call cHSpl.setBottomFrame(tbl2)
				Call SalInvalidateWindow( hWndForm )
			On SAM_FetchRowDone
				Call Debug('OK')
				If tbl.nBASE_ID> 0
					! Call XSalTblSetCellBackColor(hWndForm.Tbl_An.DOS, SalColorFromRGB( 255,210,250 ) )
					Call SalTblSetCellTextColor ( tbl.PERSON_ID, COLOR_Red, TRUE )
					! Call VisTblSetRowColor (twOrders, 10, COLOR_LightGray)
					! Call XSalTblSetRowBackColor(tbl, lParam, COLOR_Red)
					Call VisTblSetRowColor(hWndForm, lParam, COLOR_DarkGreen)
					Call SalTblSetCellTextColor ( tbl.INN, COLOR_Red, TRUE )
	! Dialog Box: BL_FILES
.winattr
		Class:
		Property Template:
		Class DLL Name:
		Title: Завантаження
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  7.05"
				Width Editable? Yes
				Height: 2.964"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
.end
		                     Description: 
		                     Tool Bar 
			                     Contents 
		                     Contents 
			                     Data Field: dfLostPassport
				                     Message Actions 
					                     On SAM_AnyEdit
						                     If File(dfLostPassport) =TRUE
							                     Call SalPicSetFile ( picLostPassport, GetDir() ||'\\RESOURCE\\BMP\\bmPositive.bmp')
						                     Else 
							                     Call SalPicSetFile ( picLostPassport, GetDir() || '\\RESOURCE\\BMP\\bmNegative.bmp')
			                     Data Field: dfPerson
				                     Message Actions 
					                     On SAM_AnyEdit
						                     If File(dfPerson) =TRUE
							                     Call SalPicSetFile ( picPerson, GetDir() ||'\\RESOURCE\\BMP\\bmPositive.bmp')
						                     Else 
							                     Call SalPicSetFile ( picPerson, GetDir() || '\\RESOURCE\\BMP\\bmNegative.bmp')
			                     Data Field: dfPassport
				                     Message Actions 
					                     On SAM_AnyEdit
						                     If File(dfPassport) =TRUE
							                     Call SalPicSetFile ( picPassport, GetDir() ||'\\RESOURCE\\BMP\\bmPositive.bmp')
						                     Else 
							                     Call SalPicSetFile ( picPassport, GetDir() || '\\RESOURCE\\BMP\\bmNegative.bmp')
			                     Data Field: dfReason
				                     Message Actions 
					                     On SAM_AnyEdit
						                     If File(dfReason) =TRUE
							                     Call SalPicSetFile ( picReason, GetDir() ||'\\RESOURCE\\BMP\\bmPositive.bmp')
						                     Else 
							                     Call SalPicSetFile ( picReason, GetDir() || '\\RESOURCE\\BMP\\bmNegative.bmp')
			                     Pushbutton: pb1
				                     Message Actions 
					                     On SAM_Click
						                     If dfLostPassport!=STRING_Null and File(dfLostPassport) =TRUE
							                     Set ActiveFileName=dfLostPassport
							                     If VisFileOpen (hFile, dfLostPassport, OF_Read) != VTERR_Ok
								                     Call SalMessageBox(' Система не змогла відкрити файл - ' ||dfLostPassport||'!', 'Помилка!', MB_Ok )
								                     Call VisFileClose (hFile)
								                     Return FALSE
							                     If VisFileReadString (hFile, sLine) != VTERR_Ok 
								                     Call SalMessageBox(' Файл порожній', 'Помилка!', MB_Ok )
								                     Call VisFileClose (hFile)
								                     Return FALSE
							                     If Subs(sLine,1,8)!='PASS_SER' 
								                     Call SalMessageBox(' Помилкова структура файлу', 'Помилка!', MB_Ok )
								                     Call VisFileClose (hFile)
								                     Return FALSE
							!
							                     Call Load_Data(hFile,'PASS_SER')
							                     Call VisFileClose (hFile)
							                     Call VisFileClose (hFileBad)
							                     Set hFileBad=hWndNULL
						                     If dfPerson!=STRING_Null           and File(dfPerson) =TRUE
							                     Set ActiveFileName=dfPerson
							                     If VisFileOpen (hFile, dfPerson, OF_Read) != VTERR_Ok
								                     Call SalMessageBox(' Система не змогла відкрити файл - ' ||dfPerson||'!', 'Помилка!', MB_Ok )
								                     Call VisFileClose (hFile)
								                     Return FALSE
							                     If VisFileReadString (hFile, sLine) != VTERR_Ok 
								                     Call SalMessageBox(' Файл порожній', 'Помилка!', MB_Ok )
								                     Call VisFileClose (hFile)
								                     Return FALSE
							                     If Subs(sLine,1,8)!='PERSON_ID' 
								                     Call SalMessageBox(' Помилкова структура файлу', 'Помилка!', MB_Ok )
								                     Call VisFileClose (hFile)
								                     Return FALSE
							!
							                     Call Load_Data(hFile,'PERSON_ID')
							                     Call VisFileClose (hFile)
							                     Call VisFileClose (hFileBad)
							                     Set hFileBad=hWndNULL
						                     If dfPassport!=STRING_Null        and File(dfPassport) =TRUE
							                     Set ActiveFileName=dfPassport
							                     If VisFileOpen (hFile, dfPassport, OF_Read) != VTERR_Ok
								                     Call SalMessageBox(' Система не змогла відкрити файл - ' ||dfPassport||'!', 'Помилка!', MB_Ok )
								                     Call VisFileClose (hFile)
								                     Return FALSE
							                     If VisFileReadString (hFile, sLine) != VTERR_Ok 
								                     Call SalMessageBox(' Файл порожній', 'Помилка!', MB_Ok )
								                     Call VisFileClose (hFile)
								                     Return FALSE
							                     If Subs(sLine,1,8)!='PASSPORT_ID' 
								                     Call SalMessageBox(' Помилкова структура файлу', 'Помилка!', MB_Ok )
								                     Call VisFileClose (hFile)
								                     Return FALSE
							!
							                     Call Load_Data(hFile,'PASSPORT_ID')
							                     Call VisFileClose (hFile)
							                     Call VisFileClose (hFileBad)
							                     Set hFileBad=hWndNULL
						                     If dfReason!=STRING_Null         and File(dfReason) =TRUE
							                     Set ActiveFileName=dfReason
							                     If VisFileOpen (hFile, dfReason, OF_Read) != VTERR_Ok
								                     Call SalMessageBox(' Система не змогла відкрити файл - ' ||dfReason||'!', 'Помилка!', MB_Ok )
								                     Call VisFileClose (hFile)
								                     Return FALSE
							                     If VisFileReadString (hFile, sLine) != VTERR_Ok 
								                     Call SalMessageBox(' Файл порожній', 'Помилка!', MB_Ok )
								                     Call VisFileClose (hFile)
								                     Return FALSE
							                     If Subs(sLine,1,8)!='REASON_ID' 
								                     Call SalMessageBox(' Помилкова структура файлу', 'Помилка!', MB_Ok )
								                     Call VisFileClose (hFile)
								                     Return FALSE
							!
							                     Call Load_Data(hFile,'REASON_ID')
							                     Call VisFileClose (hFile)
							                     Call VisFileClose (hFileBad)
							                     Set hFileBad=hWndNULL
			                     Pushbutton: pbExit
				                     Message Actions 
					                     On SAM_Click
						                     Call SalSendMsg( BL_FILES, SAM_Close, 0, 0 )
					                     On SAM_TooltipSetText
						                     Return XSalTooltipSetText( lParam, "Вихід")
			                     Background Text: Файл втрачених паспортів:
			                     Background Text: Файл Фізичних осіб:
			                     Pushbutton: pbLostPassport
				                     Message Actions 
					                     On SAM_Click
						                     Set BRet=SalDlgOpenFile ( hWndForm, 'Выбрать файл...', strFilters, 4,  nIndex, strFile, dfPath )
						                     If BRet>0 
							                     Set dfLostPassport=dfPath
							                     Set strFile=STRING_Null
							                     If File(dfLostPassport) =TRUE
								                     Call SalPicSetFile ( picLostPassport, GetDir() ||'\\RESOURCE\\BMP\\bmPositive.bmp')
							                     Else 
								                     Call SalPicSetFile ( picLostPassport, GetDir() || '\\RESOURCE\\BMP\\bmNegative.bmp')
						! If strFile != STRING_Null and dfPath != STRING_Null
						! If SalStrUpperX( SalStrLeftX( strFile, 2 )) != '@U'
							                                  Call SalMessageBeep ( MB_IconStop )
							                                  Call SalMessageBox( 'Неверное имя файла!', 'Ошибка!', MB_Ok )
							                                  Set dfPath = ''
			                     Picture: picLostPassport
				                     Message Actions 
			                     Picture: picPerson
				                     Message Actions 
			                     Data Field: dfCount
				                     Message Actions 
			                     Background Text: Файл паспортів ФО:
			                     Background Text: Файл причин постановки ФО:
			                     Picture: picPassport
				                     Message Actions 
			                     Picture: picReason
				                     Message Actions 
			                     Pushbutton: pbPerson
				                     Message Actions 
					                     On SAM_Click
						                     Set BRet=SalDlgOpenFile ( hWndForm, 'Выбрать файл...', strFilters, 4,  nIndex, strFile, dfPath )
						                     If BRet>0 
							                     Set dfPerson=dfPath
							                     Set strFile=STRING_Null
							                     If File(dfPerson) =TRUE
								                     Call SalPicSetFile ( picPerson, GetDir() ||'\\RESOURCE\\BMP\\bmPositive.bmp')
							                     Else 
								                     Call SalPicSetFile ( picPerson, GetDir() || '\\RESOURCE\\BMP\\bmNegative.bmp')
						! If strFile != STRING_Null and dfPath != STRING_Null
						! If SalStrUpperX( SalStrLeftX( strFile, 2 )) != '@U'
							                                  Call SalMessageBeep ( MB_IconStop )
							                                  Call SalMessageBox( 'Неверное имя файла!', 'Ошибка!', MB_Ok )
							                                  Set dfPath = ''
			                     Pushbutton: pbPassport
				                     Message Actions 
					                     On SAM_Click
						                     Set BRet=SalDlgOpenFile ( hWndForm, 'Выбрать файл...', strFilters, 4,  nIndex, strFile, dfPath )
						                     If BRet>0 
							                     Set dfPassport=dfPath
							                     Set strFile=STRING_Null
							                     If File(dfPassport) =TRUE
								                     Call SalPicSetFile ( picPassport, GetDir() ||'\\RESOURCE\\BMP\\bmPositive.bmp')
							                     Else 
								                     Call SalPicSetFile ( picPassport, GetDir() || '\\RESOURCE\\BMP\\bmNegative.bmp')
						! If strFile != STRING_Null and dfPath != STRING_Null
						! If SalStrUpperX( SalStrLeftX( strFile, 2 )) != '@U'
							                                  Call SalMessageBeep ( MB_IconStop )
							                                  Call SalMessageBox( 'Неверное имя файла!', 'Ошибка!', MB_Ok )
							                                  Set dfPath = ''
			                     Pushbutton: pbReason
				                     Message Actions 
					                     On SAM_Click
						                     Set BRet=SalDlgOpenFile ( hWndForm, 'Выбрать файл...', strFilters, 4,  nIndex, strFile, dfPath )
						                     If BRet>0 
							                     Set dfReason=dfPath
							                     Set strFile=STRING_Null
							                     If File(dfReason) =TRUE
								                     Call SalPicSetFile ( picReason, GetDir() ||'\\RESOURCE\\BMP\\bmPositive.bmp')
							                     Else 
								                     Call SalPicSetFile ( picReason, GetDir() || '\\RESOURCE\\BMP\\bmNegative.bmp')
						! If strFile != STRING_Null and dfPath != STRING_Null
						! If SalStrUpperX( SalStrLeftX( strFile, 2 )) != '@U'
							                                  Call SalMessageBeep ( MB_IconStop )
							                                  Call SalMessageBox( 'Неверное имя файла!', 'Ошибка!', MB_Ok )
							                                  Set dfPath = ''
		                     Functions 
			                     Function: Load_Data
				                     Description: 
				                     Returns 
					                     Boolean: 
				                     Parameters 
					                     File Handle: hFile
					                     String: Tbl
				                     Static Variables 
				                     Local variables 
					                     Number: N_Line
					                     Number: N_Line_OK
					                     Number: N_Line_Bad
					                     String: Fields[0:20]
					                     String: strErrorText
				                     Actions 
					                     Set N_Line=0
					                     Set N_Line_Bad=0
					                     Call PrepareSql(Tbl)
					!
					                     While VisFileReadString (hFile, sLine) = VTERR_Ok
						                     Set N_Line=N_Line+1
						                     Set dfCount=SalFmtFormatNumber(N_Line,'0')
						!
						! Call SalMessageBox( Subs(sLine,1,8), 'Subs', MB_Ok )
						! SalStrMidX ( strSource, nStartPos, nLength )
								! Set lng=SalStrLength(Str)
								! Call SalListClear( Fields ) - не удаляет
						                     Set Fields[0]=STRING_Null
						                     Set Fields[1]=STRING_Null
						                     Set Fields[2]=STRING_Null
						                     Set Fields[3]=STRING_Null
						                     Set Fields[4]=STRING_Null
						                     Set Fields[5]=STRING_Null
						                     Set Fields[6]=STRING_Null
						                     Set Fields[7]=STRING_Null
						                     Set Fields[8]=STRING_Null
						                     Set Fields[9]=STRING_Null
						                     Set Fields[10]=STRING_Null
						                     Set Fields[11]=STRING_Null
						                     Set Fields[12]=STRING_Null
						                     Set Fields[13]=STRING_Null
						                     Set Fields[14]=STRING_Null
						                     Set Fields[15]=STRING_Null
						                     Set Fields[16]=STRING_Null
						                     Set Fields[17]=STRING_Null
						                     Set Fields[18]=STRING_Null
						                     Set Fields[19]=STRING_Null
						                     Call SalStrTokenize(sLine,'',';',Fields)
						!
						!
						                     When SqlError
							                     Return FALSE
						                     If NOT SqlExecute(hSql() )
							                     Call SqlGetErrorText ( SqlError ( hSql() ), strErrorText )										
							! Call SalMessageBox( strErrorText, 'Subs', MB_Ok )
							                     Set N_Line_Bad=N_Line_Bad+1
							                     Call FileBad(sLine)
							                     Call FileBad(strErrorText)
							                     Call PrepareSql(Tbl)
						! When SqlError
							                              Call SalMessageBox( '1', 'Subs', MB_Ok )
							! Call SqlExtractArgs(nwParam, nlParam, hSqlEr, nENum, nEPos)
					                     Call SqlCommit(hSql())
					                     Call SalMessageBox( 'Завантаженно:'||Chr(13)||'Усього документів - '||Str(N_Line)||Chr(13)||'    Завантажене документів - '||Str(N_Line-N_Line_Bad)||Chr(13)||'    Помилкових документів - '||Str(N_Line_Bad),'Інформація', MB_Ok )
					! после комита надо тоже делать препеа
			                     Function: PrepareSql
				                     Description: 
				                     Returns 
				                     Parameters 
					                     String: Tbl
				                     Static Variables 
				                     Local variables 
				                     Actions 
					                     If Tbl='PASS_SER'
						                     Call SqlPrepare(hSql(), "Insert into V_BL_LOST_PASS (PASS_SER, PASS_NUM, LNAME, FNAME, MNAME, BDATE, BASE, INFO_SOURCE, PASS_DATE, PASS_OFFICE)
								                                       Values   (:Fields[0],:Fields[1],:Fields[2],:Fields[3],:Fields[4],to_date(:Fields[5],'dd.mm.yyyy'),:Fields[6],:Fields[7],to_date(:Fields[9],'dd.mm.yyyy'),:Fields[10]             )"
								                        )
					                     If Tbl='PASSPORT_ID'
						                     Call SqlPrepare(hSql(), "Insert into V_BL_PASSPORT (PASSPORT_ID,PERSON_ID,PASS_SER,PASS_NUM,PASS_DATE,PASS_OFFICE,PASS_REGION)
								                                       Values   (:Fields[0],:Fields[1],:Fields[2],:Fields[3],to_date(:Fields[5],'dd.mm.yyyy'),:Fields[6],:Fields[7]  )"
								                        )
					                     If Tbl='PERSON_ID'
						                     Call SqlPrepare(hSql(), "Insert into V_BL_PERSON (PERSON_ID,INN,LNAME,FNAME,MNAME,BDATE,INN_DATE)
								                                       Values   (:Fields[0],:Fields[1],:Fields[2],:Fields[3],:Fields[4],:Fields[5],to_date(:Fields[6],'dd.mm.yyyy'),to_date(:Fields[8],'dd.mm.yyyy')       )"
								                        )
					                     If Tbl='REASON_ID'
						                     Call SqlPrepare(hSql(), "Insert into V_BL_REASON (REASON_ID,PERSON_ID,REASON_GROUP,BASE,INFO_SOURCE,COMMENT_TEXT)
								                                       Values   (:Fields[0],:Fields[1],:Fields[2],:Fields[3],:Fields[4],:Fields[5] )"
								                        )
			                     Function: FileBad
				                     Description: 
				                     Returns 
				                     Parameters 
					                     String: S
				                     Static Variables 
				                     Local variables 
					                     Number: N
					                     String: FB
				                     Actions 
					                     If hFileBad=hWndNULL
						                     Set N=1
						                     While File(ActiveFileName||'.bad'|| IifS(N=1, '', Str(N))   )
							                     Set N=N+1
						                     If VisFileOpen (hFileBad, ActiveFileName||'.bad'|| IifS(N=1, '', Str(N))  , OF_Create |OF_Write) != VTERR_Ok
							                     Return FALSE
						                     Else 
					                     Call VisFileWrite (hFileBad, S||Chr(10)||Chr(13), SalStrLength (S)+2)
		                     Window Parameters 
		                     Window Variables 
			                     String: strFilters[0:3]
			                     String: strFile
			                     String: dfPath
			                     Number: nIndex
			                     File Handle: hFile
			                     File Handle: hFileBad
			                     String: ActiveFileName
			                     String: sLine
			!
			                     Number: BRet
			!
			                     String: LOST_PASS_CTL
			!
		                     Message Actions 
			                     On SAM_Create
				                     Set strFilters[0]='Список csv файлов'
				                     Set strFilters[1]='*.csv'
				                     Set strFilters[2]='Усі файли'
				                     Set strFilters[3]='*.*'
				! Set dfPath=GetTemplateDir() 
				! Set dfPath=GetPrnDir() 
				! If not File(GetTemplateDir() || "\\BL_LOST_PASS.CTL") 
					                        Call SalMessageBox( 'Відсутній керуючий файл TEMPLATE.RPT\\BL_LOST_PASS.CTL !', 'Помилка!', MB_Ok )
					                        Call SalSendMsg( BL_FILES, SAM_Close, 0, 0 )
	Dialog Box: BL_FILES
		Class:
		Property Template:
		Class DLL Name:
		Title: Завантаження
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  7.917"
				Width Editable? Yes
				Height: 3.702"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Data Field: dfLostPassport
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.183"
						Top:    0.988"
						Width:  5.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_AnyEdit
						If File(dfLostPassport) =TRUE
							Call SalPicSetFile ( picLostPassport, GetDir() ||'\\RESOURCE\\BMP\\bmPositive.bmp')
						Else
							Call SalPicSetFile ( picLostPassport, GetDir() || '\\RESOURCE\\BMP\\bmNegative.bmp')
			Data Field: dfPerson
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.183"
						Top:    1.405"
						Width:  5.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Maize
					Input Mask: Unformatted
				Message Actions
					On SAM_AnyEdit
						If File(dfPerson) =TRUE
							Call SalPicSetFile ( picPerson, GetDir() ||'\\RESOURCE\\BMP\\bmPositive.bmp')
						Else
							Call SalPicSetFile ( picPerson, GetDir() || '\\RESOURCE\\BMP\\bmNegative.bmp')
			Data Field: dfPassport
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.183"
						Top:    1.821"
						Width:  5.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Light Green
					Input Mask: Unformatted
				Message Actions
					On SAM_AnyEdit
						If File(dfPassport) =TRUE
							Call SalPicSetFile ( picPassport, GetDir() ||'\\RESOURCE\\BMP\\bmPositive.bmp')
						Else
							Call SalPicSetFile ( picPassport, GetDir() || '\\RESOURCE\\BMP\\bmNegative.bmp')
			Data Field: dfReason
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.183"
						Top:    2.238"
						Width:  5.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Light Periwinkle
					Input Mask: Unformatted
				Message Actions
					On SAM_AnyEdit
						If File(dfReason) =TRUE
							Call SalPicSetFile ( picReason, GetDir() ||'\\RESOURCE\\BMP\\bmPositive.bmp')
						Else
							Call SalPicSetFile ( picReason, GetDir() || '\\RESOURCE\\BMP\\bmNegative.bmp')
			Pushbutton: pb1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title: Завантажити
				Window Location and Size
					Left:   2.983"
					Top:    2.738"
					Width:  1.3"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Execute.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If dfLostPassport!=STRING_Null and File(dfLostPassport) =TRUE
							Set ActiveFileName=dfLostPassport
							Set ActiveName='Файл втрачених паспортів'
							If VisFileOpen (hFile, dfLostPassport, OF_Read) != VTERR_Ok
								Call SalMessageBox(' Система не змогла відкрити файл - ' ||dfLostPassport||'!', 'Помилка!', MB_Ok )
								Call VisFileClose (hFile)
								Return FALSE
							If VisFileReadString (hFile, sLine) != VTERR_Ok
								Call SalMessageBox(' Файл порожній', 'Помилка!', MB_Ok )
								Call VisFileClose (hFile)
								Return FALSE
							If Subs(sLine,1,8)!='PASS_SER'
								Call SalMessageBox(' Помилкова структура файлу', 'Помилка!', MB_Ok )
								Call VisFileClose (hFile)
								Return FALSE
							!
							Call Load_Data(hFile,'PASS_SER')
							Call VisFileClose (hFile)
							Call VisFileClose (hFileBad)
							Set hFileBad=hWndNULL
						If dfPerson!=STRING_Null           and File(dfPerson) =TRUE
							Set ActiveFileName=dfPerson
							Set ActiveName='Файл Фізичних осіб'
							If VisFileOpen (hFile, dfPerson, OF_Read) != VTERR_Ok
								Call SalMessageBox(' Система не змогла відкрити файл - ' ||dfPerson||'!', 'Помилка!', MB_Ok )
								Call VisFileClose (hFile)
								Return FALSE
							If VisFileReadString (hFile, sLine) != VTERR_Ok
								Call SalMessageBox(' Файл порожній', 'Помилка!', MB_Ok )
								Call VisFileClose (hFile)
								Return FALSE
							If Subs(sLine,1,9)!='PERSON_ID'
								Call SalMessageBox(' Помилкова структура файлу', 'Помилка!', MB_Ok )
								Call VisFileClose (hFile)
								Return FALSE
							!
							Call Load_Data(hFile,'PERSON_ID')
							Call VisFileClose (hFile)
							Call VisFileClose (hFileBad)
							Set hFileBad=hWndNULL
						If dfPassport!=STRING_Null        and File(dfPassport) =TRUE
							Set ActiveFileName=dfPassport
							Set ActiveName='Файл паспортів ФО'
							If VisFileOpen (hFile, dfPassport, OF_Read) != VTERR_Ok
								Call SalMessageBox(' Система не змогла відкрити файл - ' ||dfPassport||'!', 'Помилка!', MB_Ok )
								Call VisFileClose (hFile)
								Return FALSE
							If VisFileReadString (hFile, sLine) != VTERR_Ok
								Call SalMessageBox(' Файл порожній', 'Помилка!', MB_Ok )
								Call VisFileClose (hFile)
								Return FALSE
							If Subs(sLine,1,11)!='PASSPORT_ID'
								Call SalMessageBox(' Помилкова структура файлу', 'Помилка!', MB_Ok )
								Call VisFileClose (hFile)
								Return FALSE
							!
							Call Load_Data(hFile,'PASSPORT_ID')
							Call VisFileClose (hFile)
							Call VisFileClose (hFileBad)
							Set hFileBad=hWndNULL
						If dfReason!=STRING_Null         and File(dfReason) =TRUE
							Set ActiveFileName=dfReason
							Set ActiveName='Файл причин постановки ФО'
							If VisFileOpen (hFile, dfReason, OF_Read) != VTERR_Ok
								Call SalMessageBox(' Система не змогла відкрити файл - ' ||dfReason||'!', 'Помилка!', MB_Ok )
								Call VisFileClose (hFile)
								Return FALSE
							If VisFileReadString (hFile, sLine) != VTERR_Ok
								Call SalMessageBox(' Файл порожній', 'Помилка!', MB_Ok )
								Call VisFileClose (hFile)
								Return FALSE
							If Subs(sLine,1,9)!='REASON_ID'
								Call SalMessageBox(' Помилкова структура файлу', 'Помилка!', MB_Ok )
								Call VisFileClose (hFile)
								Return FALSE
							!
							Call Load_Data(hFile,'REASON_ID')
							Call VisFileClose (hFile)
							Call VisFileClose (hFileBad)
							Set hFileBad=hWndNULL
			Pushbutton: pbExit
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbOk
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.383"
					Top:    2.738"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalSendMsg( BL_FILES, SAM_Close, 0, 0 )
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, "Вихід")
			Background Text: Файл втрачених паспортів(LOST_PASSPORT):
				Resource Id: 9098
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   1.183"
					Top:    0.845"
					Width:  4.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Файл Фізичних осіб (PERSON):
				Resource Id: 9099
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   1.183"
					Top:    1.262"
					Width:  3.7"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Pushbutton: pbLostPassport
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ...
				Window Location and Size
					Left:   6.883"
					Top:    0.988"
					Width:  0.5"
					Width Editable? Yes
					Height: 0.214"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set BRet=SalDlgOpenFile ( hWndForm, 'Выбрать файл...', strFilters, 4,  nIndex, strFile, dfPath )
						If BRet>0
							Set dfLostPassport=dfPath
							Set strFile=STRING_Null
							If File(dfLostPassport) =TRUE
								Call SalPicSetFile ( picLostPassport, GetDir() ||'\\RESOURCE\\BMP\\bmPositive.bmp')
							Else
								Call SalPicSetFile ( picLostPassport, GetDir() || '\\RESOURCE\\BMP\\bmNegative.bmp')
						! If strFile != STRING_Null and dfPath != STRING_Null
						! If SalStrUpperX( SalStrLeftX( strFile, 2 )) != '@U'
							                                        Call SalMessageBeep ( MB_IconStop )
							                                        Call SalMessageBox( 'Неверное имя файла!', 'Ошибка!', MB_Ok )
							                                        Set dfPath = ''
			Data Field: dfCount
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    2.821"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Gray
					Input Mask: Unformatted
				Message Actions
			Background Text: Файл паспортів ФО (PASSPORT):
				Resource Id: 9100
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   1.183"
					Top:    1.679"
					Width:  3.7"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Файл причин постановки ФО (REASON):
				Resource Id: 9101
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   1.183"
					Top:    2.095"
					Width:  3.7"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Pushbutton: pbPerson
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ...
				Window Location and Size
					Left:   6.883"
					Top:    1.405"
					Width:  0.5"
					Width Editable? Yes
					Height: 0.214"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set BRet=SalDlgOpenFile ( hWndForm, 'Выбрать файл...', strFilters, 4,  nIndex, strFile, dfPath )
						If BRet>0
							Set dfPerson=dfPath
							Set strFile=STRING_Null
							If File(dfPerson) =TRUE
								Call SalPicSetFile ( picPerson, GetDir() ||'\\RESOURCE\\BMP\\bmPositive.bmp')
							Else
								Call SalPicSetFile ( picPerson, GetDir() || '\\RESOURCE\\BMP\\bmNegative.bmp')
						! If strFile != STRING_Null and dfPath != STRING_Null
						! If SalStrUpperX( SalStrLeftX( strFile, 2 )) != '@U'
							                                        Call SalMessageBeep ( MB_IconStop )
							                                        Call SalMessageBox( 'Неверное имя файла!', 'Ошибка!', MB_Ok )
							                                        Set dfPath = ''
			Pushbutton: pbPassport
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ...
				Window Location and Size
					Left:   6.883"
					Top:    1.821"
					Width:  0.5"
					Width Editable? Yes
					Height: 0.214"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set BRet=SalDlgOpenFile ( hWndForm, 'Выбрать файл...', strFilters, 4,  nIndex, strFile, dfPath )
						If BRet>0
							Set dfPassport=dfPath
							Set strFile=STRING_Null
							If File(dfPassport) =TRUE
								Call SalPicSetFile ( picPassport, GetDir() ||'\\RESOURCE\\BMP\\bmPositive.bmp')
							Else
								Call SalPicSetFile ( picPassport, GetDir() || '\\RESOURCE\\BMP\\bmNegative.bmp')
						! If strFile != STRING_Null and dfPath != STRING_Null
						! If SalStrUpperX( SalStrLeftX( strFile, 2 )) != '@U'
							                                        Call SalMessageBeep ( MB_IconStop )
							                                        Call SalMessageBox( 'Неверное имя файла!', 'Ошибка!', MB_Ok )
							                                        Set dfPath = ''
			Pushbutton: pbReason
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ...
				Window Location and Size
					Left:   6.883"
					Top:    2.238"
					Width:  0.5"
					Width Editable? Yes
					Height: 0.214"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set BRet=SalDlgOpenFile ( hWndForm, 'Выбрать файл...', strFilters, 4,  nIndex, strFile, dfPath )
						If BRet>0
							Set dfReason=dfPath
							Set strFile=STRING_Null
							If File(dfReason) =TRUE
								Call SalPicSetFile ( picReason, GetDir() ||'\\RESOURCE\\BMP\\bmPositive.bmp')
							Else
								Call SalPicSetFile ( picReason, GetDir() || '\\RESOURCE\\BMP\\bmNegative.bmp')
						! If strFile != STRING_Null and dfPath != STRING_Null
						! If SalStrUpperX( SalStrLeftX( strFile, 2 )) != '@U'
							                                        Call SalMessageBeep ( MB_IconStop )
							                                        Call SalMessageBox( 'Неверное имя файла!', 'Ошибка!', MB_Ok )
							                                        Set dfPath = ''
			Background Text: Оброблено строк:
				Resource Id: 9102
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    2.655"
					Width:  1.6"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Frame
				Resource Id: 9103
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.483"
					Top:    0.655"
					Width:  7.1"
					Width Editable? Yes
					Height: 1.917"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Solid
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Picture: picLostPassport
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.683"
					Top:    0.988"
					Width:  0.3"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name: \bars98\RESOURCE\BMP\bmNegative.bmp
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Solid
				Border Thickness: 1
				Tile To Parent? No
				Border Color: White
				Background Color: Default
				Message Actions
			Picture: picPerson
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.683"
					Top:    1.405"
					Width:  0.3"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name: \bars98\RESOURCE\BMP\bmNegative.bmp
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  0
				Corners: Round
				Border Style: No Border
				Border Thickness: 1
				Tile To Parent? No
				Border Color: Default
				Background Color: Default
				Message Actions
			Picture: picPassport
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.683"
					Top:    1.821"
					Width:  0.3"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name: \bars98\RESOURCE\BMP\bmNegative.bmp
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Solid
				Border Thickness: 1
				Tile To Parent? No
				Border Color: White
				Background Color: Default
				Message Actions
			Picture: picReason
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.683"
					Top:    2.238"
					Width:  0.3"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Editable? No
				File Name: \bars98\RESOURCE\BMP\bmNegative.bmp
				Storage: External
				Picture Transparent Color: None
				Fit: Scale
				Scaling
					Width:  100
					Height:  100
				Corners: Square
				Border Style: Solid
				Border Thickness: 1
				Tile To Parent? No
				Border Color: White
				Background Color: Default
				Message Actions
			Combo Box: cmbBase
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.483"
					Top:    0.155"
					Width:  5.2"
					Width Editable? Class Default
					Height: 1.036"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbBase.Init(hWndItem)
						Call cmbBase.Populate( hSql(), "BASE_ID", "NAME", "BL_BASE_DICT", " WHERE BASE_ID>0 ORDER BY name" )
					On SAM_AnyEdit
						If cmbBase=STRING_Null
							Set nBase=NUMBER_Null
							Call SalHideWindow(pb1)
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Виберете джерело отриманих даних')
					On SAM_Click
						Set nBase= cmbBase.GetKey( SalListQuerySelection(hWndItem))
						Call SalShowWindow(pb1)
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
		Functions
			Function: Load_Data
				Description:
				Returns
					Boolean:
				Parameters
					File Handle: hFile
					String: Tbl
				Static Variables
				Local variables
					Number: N_Line
					Number: N_Line_OK
					Number: N_Line_Bad
					String: Fields[0:20]
					String: strErrorText
					!
					Number: nSqlError
					Number: nErrorPos
					Sql Handle: hSqlErrorHandle
				Actions
					Set N_Line=0
					Set N_Line_Bad=0
					Call PrepareSql(Tbl)
					!
					While VisFileReadString (hFile, sLine) = VTERR_Ok
						Set N_Line=N_Line+1
						Set dfCount=SalFmtFormatNumber(N_Line,'0')
						!
						! Call SalMessageBox( Subs(sLine,1,8), 'Subs', MB_Ok )
						! SalStrMidX ( strSource, nStartPos, nLength )
								! Set lng=SalStrLength(Str)
								! Call SalListClear( Fields ) - не удаляет
						Set Fields[0]=STRING_Null
						Set Fields[1]=STRING_Null
						Set Fields[2]=STRING_Null
						Set Fields[3]=STRING_Null
						Set Fields[4]=STRING_Null
						Set Fields[5]=STRING_Null
						Set Fields[6]=STRING_Null
						Set Fields[7]=STRING_Null
						Set Fields[8]=STRING_Null
						Set Fields[9]=STRING_Null
						Set Fields[10]=STRING_Null
						Set Fields[11]=STRING_Null
						Set Fields[12]=STRING_Null
						Set Fields[13]=STRING_Null
						Set Fields[14]=STRING_Null
						Set Fields[15]=STRING_Null
						Set Fields[16]=STRING_Null
						Set Fields[17]=STRING_Null
						Set Fields[18]=STRING_Null
						Set Fields[19]=STRING_Null
						Call SalStrTokenize(sLine,'',';',Fields)
						!
						!
						When SqlError
							! Set hSqlErrorHandle=hSql()
							Call SqlExtractArgs(wParam, lParam, hSqlErrorHandle, nSqlError, nErrorPos)
							Set strErrorText = SqlGetErrorTextX (nSqlError)
							! Call Debug(strErrorText)
							Set N_Line_Bad=N_Line_Bad+1
							Call FileBad(sLine)
							Call FileBad(strErrorText)
							Return FALSE
						If NOT SqlExecute(hSql() )
							Call PrepareSql(Tbl)
					! Call SqlCommit(hSql())
					Set sTmp= 'Завантажен '|| ActiveName ||Chr(13)||'Усього документів - '||Str(N_Line)||Chr(13)||'    Завантажено або перевірено документів - '||Str(N_Line-N_Line_Bad)||Chr(13)||'    Помилкових документів - '||Str(N_Line_Bad)
					Call SqlCommitEx(hSql(),  sTmp )
					Call SalMessageBox(  sTmp,'Повідомлення!',MB_Ok )
					! после комита надо тоже делать препеа
			Function: PrepareSql
				Description:
				Returns
				Parameters
					String: Tbl
				Static Variables
				Local variables
				Actions
					If Tbl='PASS_SER'
						Call SqlPrepare(hSql(), "Insert into V_BL_LOST_PASS (PASS_SER, PASS_NUM, LNAME, FNAME, MNAME, BDATE, BASE, INFO_SOURCE, PASS_DATE, PASS_OFFICE,BASE_ID)
								                                       Values   (:Fields[0],:Fields[1],:Fields[2],:Fields[3],:Fields[4],to_date(:Fields[5],'dd.mm.yyyy'),:Fields[6],:Fields[7],to_date(:Fields[9],'dd.mm.yyyy'),:Fields[10] ,:nBase   )"
								                        )
					If Tbl='PASSPORT_ID'
						Call SqlPrepare(hSql(), "Insert into V_BL_PASSPORT (PASSPORT_ID,PERSON_ID,PASS_SER,PASS_NUM,PASS_DATE,PASS_OFFICE,PASS_REGION,BASE_ID)
								                                       Values   (:Fields[0],:Fields[1],:Fields[2],:Fields[3],to_date(:Fields[5],'dd.mm.yyyy'),:Fields[6],:Fields[7] ,:nBase  )"
								                        )
					If Tbl='PERSON_ID'
						Call SqlPrepare(hSql(), "Insert into V_BL_PERSON (PERSON_ID,INN,LNAME,FNAME,MNAME,BDATE,INN_DATE,BASE_ID)
								                                       Values   (:Fields[0],:Fields[1],:Fields[2],:Fields[3],:Fields[4],to_date(:Fields[5],'dd.mm.yyyy'),to_date(:Fields[7],'dd.mm.yyyy')  ,:nBase      )"
								                        )
						! PERSON_ID;INN;LNAME;FNAME;MNAME;BDATE;INS_DATE;INN_DATE
					If Tbl='REASON_ID'
						Call SqlPrepare(hSql(), "Insert into V_BL_REASON (REASON_ID,PERSON_ID,REASON_GROUP,BASE,INFO_SOURCE,COMMENT_TEXT,BASE_ID)
								                                       Values   (:Fields[0],:Fields[1],:Fields[2],:Fields[3],:Fields[4],:Fields[5] ,:nBase )"
								                        )
			Function: FileBad
				Description:
				Returns
				Parameters
					String: S
				Static Variables
				Local variables
					Number: N
					String: FB
				Actions
					If hFileBad=hWndNULL
						Set N=1
						While File(ActiveFileName||'.bad'|| IifS(N=1, '', Str(N))   )
							Set N=N+1
						If VisFileOpen (hFileBad, ActiveFileName||'.bad'|| IifS(N=1, '', Str(N))  , OF_Create |OF_Write) != VTERR_Ok
							Return FALSE
						Else
					Call VisFileWrite (hFileBad, S||Chr(10)||Chr(13), SalStrLength (S)+2)
		Window Parameters
		Window Variables
			String: strFilters[0:3]
			String: strFile
			String: dfPath
			Number: nIndex
			File Handle: hFile
			File Handle: hFileBad
			String: ActiveFileName
			String: ActiveName
			String: sTmp
			String: sLine
			Number: nBase
			!
			Number: BRet
			!
			String: LOST_PASS_CTL
			!
		Message Actions
			On SAM_Create
				Set strFilters[0]='Список csv файлов'
				Set strFilters[1]='*.csv'
				Set strFilters[2]='Усі файли'
				Set strFilters[3]='*.*'
				!
				Call SalHideWindow(pb1)
				!
				! Set dfPath=GetTemplateDir()
				! Set dfPath=GetPrnDir()
				! If not File(GetTemplateDir() || "\\BL_LOST_PASS.CTL")
					                              Call SalMessageBox( 'Відсутній керуючий файл TEMPLATE.RPT\\BL_LOST_PASS.CTL !', 'Помилка!', MB_Ok )
					                              Call SalSendMsg( BL_FILES, SAM_Close, 0, 0 )
	! FSC: Импорт xml-файла клиент+кредит
	Form Window: frmImportXML
		Class:
		Property Template:
		Class DLL Name:
		Title: Импорт файла
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  8.0"
				Width Editable? Yes
				Height: 5.1"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Frame
				Resource Id: 61271
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.1"
					Top:    0.06"
					Width:  7.6"
					Width Editable? Yes
					Height: 1.7"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Background Text: Имя файла для импорта
				Resource Id: 61272
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    0.2"
					Width:  4.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dfPath
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.3"
						Top:    0.5"
						Width:  5.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pbChoose
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Выбрать
				Window Location and Size
					Left:   6.3"
					Top:    0.452"
					Width:  1.2"
					Width Editable? Class Default
					Height: 0.298"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalDlgOpenFile(hWndForm, 'Open File', strFilters, 2, nIndex, strFile, dfPath)
			Background Text: Зарегистрирован клиент
				Resource Id: 61274
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    0.9"
					Width:  7.25"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgCl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Background Text: Зарегистрирован кредит
				Resource Id: 61275
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    1.15"
					Width:  7.25"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgCr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Background Text: Сохранен файл с графич. инф.
				Resource Id: 20722
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.3"
					Top:    1.4"
					Width:  7.25"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgImportXmlFile
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Child Table: tblPic
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.1"
						Top:    1.82"
						Width:  7.6"
						Width Editable? Yes
						Height: 2.0"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: colTypeId
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Тип граф.
								информации
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  1.2"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_SetFocus
								Set bChooseType = TRUE
								Set bChooseFile = FALSE
								Call SalEnableWindow(pbNsi)
							On SAM_Validate
								If SalIsNull(colTypeId)
									Set colTypeName = ''
								Else
									If bImportXml and colTypeId = nTypeIdXml
										Call SalMessageBox('Для этого типа уже выполнен импорт!', 'Информация', MB_IconAsterisk | MB_Ok)
										Set colTypeId = NUMBER_Null
										Set colTypeName = ''
									Else
										Call SqlPrepareAndExecute(hSql(), "select name into :colTypeName from customer_bin_data_type where id=:colTypeId")
										If not SqlFetchNext(hSql(), nFetchRes)
											If SalMessageBox('Неверно задан тип!' || PutCrLf() || 'Выбрать из справочника?', 'Внимание!', MB_IconExclamation | MB_Ok) = IDYES
												Call SalSendMsg(colTypeId, SAM_DoubleClick, 0, 0)
											Else
												Return VALIDATE_Cancel
								Return VALIDATE_Ok
							On SAM_DoubleClick
								If FunNSIGetFiltered('customer_bin_data_type', 'name', '', s1, s2)
									If bImportXml and Val(s1) = nTypeIdXml
										Call SalMessageBox('Для файла <' || s2 || '> уже выполнен импорт!', 'Информация', MB_IconAsterisk | MB_Ok)
									Else
										Set colTypeId   = Val(s1)
										Set colTypeName = s2
							On SAM_KillFocus
								If not wParam = SalWindowHandleToNumber(pbNsi)
									Set bChooseType = FALSE
									Call SalDisableWindow(pbNsi)
					Column: colTypeName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Наименование
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colFileName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Имя файла
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  3.6"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_SetFocus
								Set bChooseFile = TRUE
								Set bChooseType = FALSE
								Call SalEnableWindow(pbNsi)
							On SAM_DoubleClick
								Call SalDlgOpenFile(hWndForm, 'Open File', smFilePic, 10, nIndex, strFile, colFileName)
								Call SalSendMsg(colFileName, SAM_Validate, 0, 0)
							On SAM_Validate
								If not SalIsNull(colFileName)
									If not checkFilePatch(colFileName)
										Call SalMessageBox('Неверно указан путь к файлу (' || colFileName || ')!', 'Внимание!', MB_IconExclamation | MB_Ok)
										Set colFileName = sParPath
								Return VALIDATE_Ok
							On SAM_KillFocus
								If not wParam = SalWindowHandleToNumber(pbNsi)
									Set bChooseFile = FALSE
									Call SalDisableWindow(pbNsi)
				Functions
					Function: CheckPic
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
						Actions
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(hWndForm, nRow, ROW_New, 0)
								Call SalTblSetContext(hWndForm, nRow)
								If SalIsNull(colTypeId)
									Call SalMessageBox('Не указан тип графической информации!', 'Внимание!', MB_IconExclamation | MB_Ok)
									Return FALSE
								If SalIsNull(colFileName)
									Call SalMessageBox('Не указано имя файла для импорта!', 'Внимание!', MB_IconExclamation | MB_Ok)
									Return FALSE
							! нет инф. для импорта
							If nRow = TBL_MinRow
								Return FALSE
							Return TRUE
					Function: ImportPic
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
						Actions
							Call SalWaitCursor(TRUE)
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(hWndForm, nRow, ROW_New, 0)
								Call SalTblSetContext(hWndForm, nRow)
								If not SqlPrepareAndExecute(hSql(),
										"insert into cc_bin_data(nd, type_id, bin_data)
										 values (:nND, :colTypeId, empty_blob())")
									Call SalWaitCursor(FALSE)
									Return FALSE
								If not PutFileToBlob(hSql(), colFileName, 'cc_bin_data', 'nd', 'bin_data', nND, '', 'nd='||Str(nND)||' and type_id='||Str(colTypeId), 0)
									Call SalWaitCursor(FALSE)
									Return FALSE
								Call SaveInfoToLog("IMPORT_CL. Выполнен импорт файла графич. информации '" || colFileName || " для кредита " || Str(nND))
								Call SalTblSetRowFlags(hWndForm, nRow, ROW_New | ROW_Edited, FALSE)
							Call SalWaitCursor(FALSE)
							Return TRUE
				Window Variables
					Number: nRow
					String: s1
					String: s2
				Message Actions
					On UM_Insert
						Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
						Call SalTblSetContext(hWndForm, nRow)
						Set colFileName = sParPath
						Call SalTblSetFocusCell(hWndForm, nRow, colTypeId, 0, 1)
					On UM_Delete
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
							Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
					On UM_Update
			Frame
				Resource Id: 61273
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.1"
					Top:    3.9"
					Width:  7.6"
					Width Editable? Yes
					Height: 0.75"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Pushbutton: pbIns
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledInsert
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.3"
					Top:    4.05"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalSendMsg(tblPic, UM_Insert, 0, 0)
			Pushbutton: pbDel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledDelete
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.6"
					Top:    4.048"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalSendMsg(tblPic, UM_Delete, 0, 0)
			Pushbutton: pbNsi
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledDetail
				Property Template:
				Class DLL Name:
				Title: Выбрать
				Window Location and Size
					Left:   2.9"
					Top:    4.048"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If bChooseType
							Call SalSendMsg(tblPic.colTypeId, SAM_DoubleClick, 0, 0)
						Else If bChooseFile
							Call SalSendMsg(tblPic.colFileName, SAM_DoubleClick, 0, 0)
			Pushbutton: pbImport
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledExecute
				Property Template:
				Class DLL Name:
				Title: Импорт
				Window Location and Size
					Left:   5.0"
					Top:    4.048"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If bImportCl
							Set fOpen = TRUE
							If dfPath = STRING_Null or dfPath = ''
								Set fOpen = SalDlgOpenFile(hWndForm, 'Open File', strFilters, 2, nIndex, strFile, dfPath)
							Else
								Call VisDosSplitPath(dfPath, tmp01, tmp02, tmp03, tmp04)
								Set strFile = tmp03 || tmp04
								If not strFile
									Set fOpen = SalDlgOpenFile(hWndForm, 'Open File', strFilters, 2, nIndex, strFile, dfPath)
							If fOpen
								If checkFilePatch(dfPath)
									If SalFileSetCurrentDirectory(SalStrLeftX(dfPath, SalStrScan(dfPath,strFile)-1))
										Call SalSetWindowText(hWndForm, 'Загрузка файла' || ' ' || dfPath)
										If ImportXML(dfPath, strFile)
											Call SalSetWindowLabelText(bgCl, 'Зарегистрирован клиент РНК ' || Str(nRnk))
											Call SalSetWindowLabelText(bgCr, 'Зарегистрирован кредит НД ' || Str(nND))
											Set bImportCl  = FALSE
											Set bImportPic = TRUE
											Call SalDisableWindow(dfPath)
											Call SalDisableWindow(pbChoose)
											Call SalEnableWindow(pbIns)
											Call SalEnableWindow(pbDel)
											Call MessageNoWait('Выполнен импорт файла ' || strFile, 'Информация', 5, 0)
										Else
											Call MessageNoWait('Ошибка импорта файла ' || strFile, 'Информация', 5, 1)
									Else
										Call SalMessageBox('Не удалось переити в каталог' || PutCrLf() || dfPath, '', MB_OK)
								Else
									Call SalMessageBox('Неверно указан путь к файлу (' || dfPath || ')!', 'Внимание!', MB_IconExclamation | MB_Ok)
						Else If bImportPic
							If tblPic.CheckPic()
								If tblPic.ImportPic()
									Call SalDisableWindow(tblPic.colTypeId)
									Call SalDisableWindow(tblPic.colFileName)
									Call SalDisableWindow(pbIns)
									Call SalDisableWindow(pbDel)
									Call SalDisableWindow(pbNsi)
									Call SalDisableWindow(pbImport)
									Call MessageNoWait('Выполнен импорт графической информации для кредита ' || Str(nND), 'Информация', 5, 0)
								Else
									Call MessageNoWait('Неуспешный импорт графической информации для кредита ' || Str(nND), 'Информация', 5, 1)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbLabeledCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.3"
					Top:    4.048"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalDestroyWindow( hWndForm )
		Functions
			Function: checkFilePatch
				Description:
				Returns
					Boolean:
				Parameters
					String: sPath
				Static Variables
				Local variables
				Actions
					Call VisDosSplitPath(sPath, tmp01, tmp02, tmp03, tmp04)
					If SalStrUpperX(sParPath) = Subs(SalStrUpperX(tmp01 || tmp02), 1, Len(sParPath))
						Return TRUE
					Return FALSE
			Function: ImportXML
				Description:
				Returns
					Boolean:
				Parameters
					String: sFilePath
					String: sFileName
				Static Variables
				Local variables
					Boolean: fRet
				Actions
					Call SalWaitCursor(TRUE)
					Set fRet = FALSE
					! == Сохраняем файл во временную таблицу
					Call SaveInfoToLog("IMPORT_CL. Импорт файла " || sFilePath)
					Call PutFileToTmpLob(hSql(), sFilePath, 'C')
					Call SaveInfoToLog("IMPORT_CL. Файл " || sFileName || " сохранен во временной таблице")
					! == импорт уже из временной таблицы
					If SqlPLSQLCommand(hSql(), "fsc_import_cl(sFileName, nRnk, nND)")
						Call SqlCommitEx(hSql(), "IMPORT_CL. Выполнен импорт файла " || sFileName)
						Set fRet = TRUE
					Else
						Call SqlRollbackEx(hSql(), "IMPORT_CL. Ошибка во время импорта файла " || sFileName)
					! == сохраняем файл
					If fRet
						Call SqlPrepareAndExecute(hSql(), "select id into :nTypeIdXml from customer_bin_data_type where code='XML_CL'")
						If SqlFetchNext(hSql(), nFetchRes)
							If not SqlPrepareAndExecute(hSql(),
									"insert into cc_bin_data(nd, type_id, bin_data)
									 values (:nND, :nTypeIdXml, empty_blob())")
								Call SqlRollback(hSql())
								Set bImportXml = FALSE
								Call SalWaitCursor(FALSE)
								Return TRUE
							If not PutFileToBlob(hSql(), sFilePath, 'cc_bin_data', 'nd', 'bin_data', nND, '', 'nd='||Str(nND)||' and type_id='||Str(nTypeIdXml), 0)
								Set bImportXml = FALSE
								Call SalWaitCursor(FALSE)
								Return TRUE
							Call SalSetWindowLabelText(bgImportXmlFile, 'Сохранен файл графич. информации ' || sFilePath)
							Call SaveInfoToLog("IMPORT_CL. Выполнен импорт файла графич. информации '" || sFilePath || " для кредита " || Str(nND))
						Set bImportXml = TRUE
						! ==
					Call SalWaitCursor(FALSE)
					Return fRet
		Window Parameters
			Number: nPar
			String: sParPath	! Установленный путь для импорта файлов
			String: sPar2
		Window Variables
			Boolean: bImportCl	! Флаг - регистрация клиента и кредита
			Boolean: bImportXml	! Флаг - импорт xml-файла клиент+кредит в таблицу cc_bin_data
			Boolean: bImportPic	! Флаг - импорт графич. информации
			Boolean: bChooseType
			Boolean: bChooseFile
			Number: nRnk
			Number: nND
			String: strFilters[2]
			String: smFilePic[10]
			Number: nIndex
			String: strFile
			Boolean: fOpen
			String: tmp01
			String: tmp02
			String: tmp03
			String: tmp04
			Number: nTypeIdXml
		Message Actions
			On SAM_Create
				Call PrepareWindowEx(hWndForm)
				Call SalDisableWindow(pbIns)
				Call SalDisableWindow(pbDel)
				Call SalDisableWindow(pbNsi)
				Set dfPath = sParPath
				Set bImportCl  = TRUE
				Set bImportXml = FALSE
				Set bImportPic = FALSE
				Call SalSetWindowLabelText(bgCl, '')
				Call SalSetWindowLabelText(bgCr, '')
				Call SalSetWindowLabelText(bgImportXmlFile, '')
				!
				Set strFilters[0] = 'XML Files (*.xml)'
				Set strFilters[1] = '*.xml'
				!
				Set smFilePic[0] = 'ZIP Files (*.ZIP)'
				Set smFilePic[1] = '*.zip'
				Set smFilePic[2] = 'RAR Files (*.rar)'
				Set smFilePic[3] = '*.rar'
				Set smFilePic[4] = 'JPG Files (*.jpg)'
				Set smFilePic[5] = '*.jpg'
				Set smFilePic[6] = 'GIF Files (*.gif)'
				Set smFilePic[7] = '*.gif'
				Set smFilePic[8] = 'PDF Files (*.pdf)'
				Set smFilePic[9] = '*.pdf'
	! FSC: Экспорт xml-файла клиент+кредит
	Table Window: tbl_UbkiCr
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Формирование файла кредитных историй
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 60804
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.183"
						Begin Y:  -0.024"
						End X:  5.183"
						End Y:  0.44"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Справочник доп. реквизита STBCH'
						On SAM_Click
							Call Sel037(hWndMDI, 4, 0, '', '')
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 60805
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbForm
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.983"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\TOMAIL.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Сформировать файл'
						On SAM_Click
							Call formFile()
				Line
					Resource Id: 60808
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  4.517"
						Begin Y:  0.0"
						End X:  4.517"
						End Y:  0.464"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.65"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 60806
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Background Text: Отчетный месяц
					Resource Id: 60807
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   6.0"
						Top:    0.15"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Combo Box: cmbDat
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_DatId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   8.1"
						Top:    0.1"
						Width:  1.6"
						Width Editable? Class Default
						Height: 3.202"
						Height Editable? Class Default
					Visible? Class Default
					Editable? Class Default
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_Create
							Call cmbDat.Init(hWndItem)
							Call cmbDat.Populate(hSql(), "last_day(add_months(bankdate,-num))", 
									     "to_char(last_day(add_months(bankdate,-num)),'MM-yyyy')", 
									     "conductor", "where num<months_between(bankdate, add_months(bankdate,-13))")
							Call cmbDat.SetSelectById(dDat)
						On SAM_Click
							Call SalSendClassMessage(SAM_Click, 0, 0)
							Call SalTblReset(hWndForm)
							Set dDat = cmbDat.GetCurrentKey()
							Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
		Contents
			Column: colCrId
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ид.
						кредитной
						сделки
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colClInn	! Идентификационный код клиента
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОКПО
						клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colClLNameUa	! Фамилия клиента
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Фамилия
						клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colClFNameUa	! Имя клиента
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Имя
						клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colClMNameUa	! Отчество клиента
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отчество
						клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colClSex	! Пол клиента
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Пол
						клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colClBDate	! D Дата рождения
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						рождения
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.2"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colClDType	! Тип документа (P-паспорт)
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тип
						документа
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colClDSer	! Серия паспорта
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Серия
						паспорта
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colClDNom	! Номер паспорта
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Номер
						паспорта
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colClDDate	! D Даты выдачи паспорта
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Даты
						выдачи
						паспорта
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.2"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colClDWho	! Кем выдан паспорт
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кем выдан
						паспорт
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colClAddress	! Адрес регистрации
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Адрес
						регистрации
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colClFAddress	! Адрес проживания
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Адрес
						проживания
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colClFamily	! Семейное положение
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Семейное
						положение
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colClIndx	! Почтовый индекс
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Почтовый
						индекс
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colClWOKPO	! ОКПО места работы
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОКПО
						места
						работы
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colClWDate	! Дата места работы
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						места
						работы
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colClWName	! Наименование места работы
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						места
						работы
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colCrType	! N Тип сделки ("02")
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тип
						сделки
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colCrDateStart	! D Дата старта
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						старта
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.2"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colCrDateFinish	! D Дата конца
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						конца
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.2"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colCrAmount	! N Сумма кредита
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						кредита
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.6"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colCrSetAmount	! N Сумма ежем. обязательного платежа
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма ежем.
						обязательного
						платежа
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.6"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colCrCurrency	! N Валюта кредита
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Валюта
						кредита
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colCrZAmt	! N Текущая задолженность по кредиту
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Текущая
						задолженность
						по кредиту
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.6"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colCrZAmtExp	! N Текущая просроченная задолженность
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Текущая
						просроченная
						задолженность
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.6"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colCrZDayExp	! N Текущее кол. дней просрочки
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Текущее
						кол. дней
						просрочки
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colCrPay	! Признак исполнения платежа
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Признак
						исполнения
						платежа
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colCrState	! Текущее состояние сделки
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Текущее
						состояние
						сделки
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: formFile
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Boolean: bRet
					String: sFileName
					Long String: sXML
					Number: nL
					Number: i
					File Handle: hF
				Actions
					Set bRet = FALSE
					If SalMessageBox("Сформировать файл кредитных историй за " || cmbDat ||
							   IifS(sFilter!="", PutCrLf() || "по отфильтрованным строкам", "") || "?", "Вопрос", MB_IconQuestion | MB_YesNo) = IDYES
						Call SalWaitCursor(TRUE)
						Call SaveInfoToLog("UBCH_CR. Формирование файла кредитных историй.")
						Call SalDisableWindow(pbForm)
						If SqlPLSQLCommand(hSql(), "wcs_exchange.ubch_generate_file(dDat, sFileName)")
							! Создаем файл
							If SqlPrepareAndExecute(hSql(), "SELECT dbms_lob.getlength(dd) INTO :nL FROM tmp_xml_data") AND
									   SqlFetchNext(hSql(),nFetchRes)
								If nL > 0
									Set sFileName = GetPrnDir() || '\\' || sFileName
									!
									If NOT SalFileOpen(hF, sFileName, OF_Create|OF_Write|OF_Text)
										Call SalMessageBox('Невозможно создать файл:' || PutCrLf() || sFileName, 'Ошибка', MB_IconStop | MB_Ok)
										Call SalWaitCursor(FALSE)
										Return FALSE
									Call SqlSetLongBindDatatype(1, 22)
									Set i = 1
									While i <= nL
										Call SqlPrepareAndExecute(hSql(), "SELECT dbms_lob.substr((select dd from tmp_xml_data),2000,:i) INTO :sXML FROM dual")
										Call SqlFetchNext(hSql(), nFetchRes)
										Call SalFileSeek(hF, i-1, FILE_SeekBegin)
										Call SalFileWrite(hF, sXML, Len(sXML))
										Set i = i + 2000
									Call SalFileClose(hF)
								Call SqlCommitEx(hSql(), "UBCH_CR. Файл " || sFileName || " успешно сформирован.")
								Call MessageNoWait("Файл " || sFileName || " успешно сформирован.", "Сообщение", 3, 0)
								Set bRet = TRUE
							Else
								Call SqlRollbackEx(hSql(), "UBCH_CR. Не удалось прочитать данные для создания файла.")
						Else
							Call SqlRollbackEx(hSql(), "UBCH_CR. Ошибка выполнения процедуры для создания файла")
						Call SalWaitCursor(FALSE)
					Return bRet
		Window Parameters
			Number: nPar
			String: sPar1
			String: sPar2
		Window Variables
			Date/Time: dDat
			String: sFilter
			Number: nCount
		Message Actions
			On SAM_Create
				Call PrepareWindowEx(hWndForm)
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns(hWndForm, 2)
				Call SalDisableWindow(pbForm)
				Set dDat = SalDateMonthBegin(GetBankDate())-1
				Set hWndForm.tbl_UbkiCr.nFlags = GT_ReadOnly
				Set hWndForm.tbl_UbkiCr.strFilterTblName = 'v_ubch_cr'
				Set hWndForm.tbl_UbkiCr.strPrintFileName = 'ubch_cr'
				Set hWndForm.tbl_UbkiCr.strSqlPopulate =
						"select v_ubch_cr.cr_id, v_ubch_cr.inn,
						        v_ubch_cr.clLNameUa, v_ubch_cr.clFNameUa, v_ubch_cr.clMNameUa,
						        v_ubch_cr.clSex, v_ubch_cr.clBDate, v_ubch_cr.clDType, v_ubch_cr.clDSer, v_ubch_cr.clDNom,
						        v_ubch_cr.clDDate, v_ubch_cr.clDWho, v_ubch_cr.clAddress, v_ubch_cr.clFAddress,
						        v_ubch_cr.clFamily, v_ubch_cr.clIndx,
						        v_ubch_cr.clWOKPO, v_ubch_cr.clWDate, v_ubch_cr.clWName,
						        v_ubch_cr.crType, v_ubch_cr.crDateStart, v_ubch_cr.crDateFinish,
						        v_ubch_cr.crAmount, v_ubch_cr.crSetAmount, v_ubch_cr.crCurrency,
						        v_ubch_cr.crZAmt, v_ubch_cr.crZAmtExp, v_ubch_cr.crZDayExp,
						        v_ubch_cr.crPay, v_ubch_cr.crState 
						   into :hWndForm.tbl_UbkiCr.colCrId, :hWndForm.tbl_UbkiCr.colClInn, 
						        :hWndForm.tbl_UbkiCr.colClLNameUa, :hWndForm.tbl_UbkiCr.colClFNameUa, :hWndForm.tbl_UbkiCr.colClMNameUa, 
						        :hWndForm.tbl_UbkiCr.colClSex, :hWndForm.tbl_UbkiCr.colClBDate, 
						        :hWndForm.tbl_UbkiCr.colClDType, :hWndForm.tbl_UbkiCr.colClDSer, :hWndForm.tbl_UbkiCr.colClDNom, 
						        :hWndForm.tbl_UbkiCr.colClDDate, :hWndForm.tbl_UbkiCr.colClDWho,
						        :hWndForm.tbl_UbkiCr.colClAddress, :hWndForm.tbl_UbkiCr.colClFAddress, 
						        :hWndForm.tbl_UbkiCr.colClFamily, :hWndForm.tbl_UbkiCr.colClIndx,
						        :hWndForm.tbl_UbkiCr.colClWOKPO, :hWndForm.tbl_UbkiCr.colClWDate, :hWndForm.tbl_UbkiCr.colClWName,
						        :hWndForm.tbl_UbkiCr.colCrType, :hWndForm.tbl_UbkiCr.colCrDateStart, :hWndForm.tbl_UbkiCr.colCrDateFinish,
						        :hWndForm.tbl_UbkiCr.colCrAmount, :hWndForm.tbl_UbkiCr.colCrSetAmount, :hWndForm.tbl_UbkiCr.colCrCurrency,
						        :hWndForm.tbl_UbkiCr.colCrZAmt, :hWndForm.tbl_UbkiCr.colCrZAmtExp, :hWndForm.tbl_UbkiCr.colCrZDayExp, 
						        :hWndForm.tbl_UbkiCr.colCrPay, :hWndForm.tbl_UbkiCr.colCrState 
						   from v_ubch_cr, tmp_ubch_cr t
						  where v_ubch_cr.dat = :dDat and v_ubch_cr.cr_nd = t.nd
						  order by v_ubch_cr.cr_id"
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
			On UM_Populate
				Call SalTblReset(hWndForm)
				Set nCount = 0
				Set sFilter = cF.GetFilterWhereClause(FALSE)
				If SqlPLSQLCommand(hSql(), "wcs_exchange.ubch_generate_data(dDat, sFilter)")
					Call SalEnableWindow(pbForm)
					Call SalSendClassMessage(UM_Populate, 0, 0)
					Call SalTblDefineSplitWindow(hWndForm, 1, TBL_Split_Adjustable)
					Call SalTblInsertRow(hWndForm, TBL_MinSplitRow)
					Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
					Set colCrId  = 'Всего'
					Set colClInn = Str(nCount)
			On SAM_FetchRowDone
				Set nCount = nCount + 1
	! FSC: Справочник параметров STBCH
	Table Window: tbl_UbkiStbch
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Установка доп. реквизита STBCH "Отправка данных в БКИ"
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 60261
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  6.1"
						Begin Y:  -0.012"
						End X:  6.1"
						End Y:  0.452"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 60262
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbStbch0
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title: 0
					Window Location and Size
						Left:   4.017"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: 12
					Font Enhancement: Bold
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = '0 - не отправлять данные'
						On SAM_Click
							Call markData(0)
				Pushbutton: pbStbch1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title: 1
					Window Location and Size
						Left:   4.467"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: 12
					Font Enhancement: Bold
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = '1 - отправлять данные'
						On SAM_Click
							Call markData(1)
				Pushbutton: pbStbch2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title: 2
					Window Location and Size
						Left:   4.917"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: 12
					Font Enhancement: Bold
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = '2 - данные уже отправлялись'
						On SAM_Click
							Call markData(2)
				Line
					Resource Id: 60264
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Coordinates
						Begin X:  5.45"
						Begin Y:  0.0"
						End X:  5.45"
						End Y:  0.464"
					Visible? Yes
					Line Style: Etched
					Line Thickness: 1
					Line Color: 3D Shadow Color
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.567"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 60263
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: colCrNd		! N НД
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: НД
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colCrId		! Ид. кредитной сделки
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ид.
						кредитной
						сделки
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colClLName	! Фамилия клиента
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Фамилия
						клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colClFName	! Имя клиента
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Имя
						клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colClMName	! Отчество клиента
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отчество
						клиента
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colCrStbch	! Признак: Отправка данных в БКИ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Признак:
						Отправка
						данных в БКИ
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 1
				Data Type: Number
				Justify: Center
				Width:  1.4"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: (none)
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If not SalIsNull(colCrStbch)
							If colCrStbch != 0 and colCrStbch != 1 and colCrStbch != 2
								Call SalMessageBox("Допустимые значения:" || PutCrLf() || 
										     "   0 - не отправлять данные" || PutCrLf() || 
										     "   1 - отправлять данные" || PutCrLf() || 
										     "   2 - данные уже отправлялись", "Ошибка заполнения!", MB_IconExclamation | MB_Ok)
								Return VALIDATE_Cancel
						Return VALIDATE_Ok
			Column: colCrState	! Текущее состояние сделки
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Текущее
						состояние
						сделки
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  1.2"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: (none)
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If not SalIsNull(colCrStbch)
							If colCrStbch != 0 and colCrStbch != 1 and colCrStbch != 2
								Call SalMessageBox("Допустимые значения:" || PutCrLf() || 
										     "   0 - не отправлять данные" || PutCrLf() || 
										     "   1 - отправлять данные" || PutCrLf() || 
										     "   2 - данные уже отправлялись", "Ошибка заполнения!", MB_IconExclamation | MB_Ok)
								Return VALIDATE_Cancel
						Return VALIDATE_Ok
		Functions
			Function: markData
				Description:
				Returns
					Boolean:
				Parameters
					Number: nStbch
				Static Variables
				Local variables
				Actions
					Set nRow = TBL_MinRow
					While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
						Call SalTblSetContext(hWndForm, nRow)
						Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, TRUE)
						Set colCrStbch = nStbch
					Return TRUE
			Function: saveData
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Boolean: bRet
				Actions
					Set bRet = TRUE
					Call SalWaitCursor(TRUE)
					Set nRow = TBL_MinRow
					While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
						Call SalTblSetContext(hWndForm, nRow)
						If not SqlPLSQLCommand(hSql(), "wcs_exchange.ubch_set_stbch(colCrNd, colCrStbch)") 
							Call SqlRollbackEx(hSql(), "UBCH_STBCH. Ошибка выполнения процедуры установки параметра STBCH")
							Set bRet = FALSE
							Call SalWaitCursor(FALSE)
							Break
					If bRet
						Call SqlCommitEx(hSql(), "UBCH_STBCH. Выполнена процедуры установки параметра STBCH")
						Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
					Call SalWaitCursor(FALSE)
					Return bRet
		Window Parameters
			Number: nPar
			String: sPar1
			String: sPar2
		Window Variables
		Message Actions
			On SAM_Create
				Call PrepareWindowEx(hWndForm)
				Set hWndForm.tbl_UbkiStbch.nFlags = GT_NoIns | GT_NoDel
				Set hWndForm.tbl_UbkiStbch.strFilterTblName = 'v_ubch_stbch'
				Set hWndForm.tbl_UbkiStbch.strPrintFileName = 'ubch_stbch'
				Set hWndForm.tbl_UbkiStbch.strSqlPopulate = 
						"select cr_nd, cr_id, cl_LName, cl_FName, cl_MName, cr_stbch, cr_State
						   into :hWndForm.tbl_UbkiStbch.colCrNd,    :hWndForm.tbl_UbkiStbch.colCrId, 
						        :hWndForm.tbl_UbkiStbch.colClLName, :hWndForm.tbl_UbkiStbch.colClFName, :hWndForm.tbl_UbkiStbch.colClMName, 
						        :hWndForm.tbl_UbkiStbch.colCrStbch, :hWndForm.tbl_UbkiStbch.colCrState
						   from v_ubch_stbch
						  order by cr_id desc"
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Update
				Call saveData()
	!
	Table Window: CARD ! Система управления карточками
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Реєстрація карток
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.275"
				Top:    0.3"
				Width:  17.267"
				Width Editable? Class Default
				Height: 3.929"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.464"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 40794
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  3.583"
						Begin Y:  0.071"
						End X:  3.583"
						End Y:  0.536"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.783"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\flags.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Групова зміна даних')
						On SAM_Click
							!
							! Set G_SOS_ID=SOS_ID
							! Set G_SOS_NAME=SOS_NAME
							! Set G_BRANCH_ID=BRANCH_ID
							! Set G_BRANCH_NAME=BRANCH_NAME
							! Set G_STAFF_ID=STAFF_ID
							! Set G_STAFF_NAME=STAFF_NAME
							!
							If SalModalDialog (Card_Change_sos, hWndForm,G_SOS_ID,G_SOS_NAME,G_BRANCH_ID,G_BRANCH_NAME,G_STAFF_ID,G_STAFF_NAME)>=0
								If G_SOS_ID !=NUMBER_Null
									Set nNewRow = TBL_MinRow
									While SalTblFindNextRow( CARD, nNewRow, ROW_Selected, 0)
										Call SalTblSetContext( CARD, nNewRow )
										Call SalTblSetRowFlags ( CARD, nNewRow, ROW_Edited, TRUE )
										If G_SOS_NAME!=STRING_Null 
											Set SOS_ID=G_SOS_ID
											Set SOS_NAME=G_SOS_NAME
											Call SalTblSetRowFlags ( CARD, nNewRow, ROW_Edited, TRUE )
										If G_BRANCH_NAME!=STRING_Null 
											Set BRANCH_ID=G_BRANCH_ID
											Set BRANCH_NAME=G_BRANCH_NAME
											Call SalTblSetRowFlags ( CARD, nNewRow, ROW_Edited, TRUE )
										If G_STAFF_NAME!=STRING_Null 
											Set STAFF_ID=G_STAFF_ID
											Set STAFF_NAME=G_STAFF_NAME
											Call SalTblSetRowFlags ( CARD, nNewRow, ROW_Edited, TRUE )
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.483"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 40795
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  2.983"
						Begin Y:  0.071"
						End X:  2.983"
						End Y:  0.536"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.083"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 40796
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  0.583"
						Begin Y:  0.071"
						End X:  0.583"
						End Y:  0.536"
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Data Field: nKol
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.783"
							Top:    0.1"
							Width:  0.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Количество записей в выборке')
				Data Field: TXT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   13.283"
							Top:    0.1"
							Width:  4.3"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Сумма платежей в выборке')
				!
				Radio Button: rbA
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Усі
					Window Location and Size
						Left:   5.583"
						Top:    0.1"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Black
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rbY
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Менеджер
					Window Location and Size
						Left:   7.483"
						Top:    0.1"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Marigold
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rbG
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Кліент
					Window Location and Size
						Left:   8.883"
						Top:    0.1"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Green
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rbGR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Підтверджені
					Window Location and Size
						Left:   9.983"
						Top:    0.1"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Gray
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rbR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Повернуті
					Window Location and Size
						Left:   11.683"
						Top:    0.1"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Red
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Radio Button: rbBL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Вільні
					Window Location and Size
						Left:   6.483"
						Top:    0.1"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Black
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Frame
					Resource Id: 40802
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   6.383"
						Top:    0.071"
						Width:  6.8"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Solid
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Pushbutton: pb10
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\relation.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText(lParam, 'Завантаження XML')
						On SAM_Click
							If SalDlgOpenFile(hWndForm, 'Open File', strFilters, 2, nIndex, strFile, dfPath)
								Call ImportXML(dfPath,strFile)
		Contents
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SOS_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код состояния
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SOS_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_NumId
				Property Template:
				Class DLL Name:
				Title: Стан
						картки
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  1.383"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_Create
						If SOS_NAME.Init( hWndItem )
							Call SOS_NAME.Populate( hSql(), "SOS", "NAME", "WCS_CARDS_SOS", " ORDER BY sos" )
							! Call T30.SetSelectById(TK30)
					On SAM_AnyEdit
						Set SOS_ID= SOS_NAME.GetKey( SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						! Call SalMapEnterToTab( TRUE )
			Column: COLOR_SOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сост для разукр.
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CARD_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ID Карти
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.25"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BANK_MFO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Банк
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.05"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CARD_NO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № карты
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.667"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						валюти
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CARD_NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата пост. 
						в базу
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: USER_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Користувач
						який вніс картку
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  1.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BRANCH_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код 
						отделения
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BRANCH_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_StrId
				Property Template:
				Class DLL Name:
				Title: Отделение
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_Create
						If BRANCH_NAME.Init( hWndItem )
							Call BRANCH_NAME.Populate( hSql(), "BRANCH", "NAME", "BRANCH", " ORDER BY name" )
					On SAM_AnyEdit
						Set BRANCH_ID= BRANCH_NAME.GetKey( SalListQuerySelection(hWndItem))
						Set STAFF_NAME=STRING_Null
						Set STAFF_ID=NUMBER_Null
						! If STAFF_NAME.Init( hWndItem )
						Call STAFF_NAME.Populate( hSql(), "ID", "FIO", "STAFF", "WHERE BRANCH like '"||BRANCH_ID||"' ORDER BY fio" )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Column: STAFF_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код менеджера
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: STAFF_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_NumId
				Property Template:
				Class DLL Name:
				Title: Менеджер
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  Class Default
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_Create
						If STAFF_NAME.Init( hWndItem )
							Call STAFF_NAME.Populate( hSql(), "ID", "FIO", "STAFF", " ORDER BY fio" )
					On SAM_AnyEdit
						Set STAFF_ID= STAFF_NAME.GetKey( SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Column: DATM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата видачи 
						менеджеру
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  2.167"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № договора
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ПІБ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  1.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата отримання
						кліентом картки
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.45"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: AKS_DONE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: N пакету для ПЦ (код)
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: AKS_DONE_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Статус картки 
						в Проц. Центрі
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.167"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
			Column: AKS_PACKID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № пакету 
						для ПЦ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.167"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: AKS_REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № запису в
						пакеті для ПЦ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.333"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SOS_DAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата тек.
						состояния
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
		Functions
			Function: ImportXML
				Description:
				Returns
					Boolean:
				Parameters
					String: sFilePath
					String: sFileName
				Static Variables
				Local variables
					Boolean: fRet
					Number: Card_Count
				Actions
					Call SalWaitCursor(TRUE)
					Call SalShowWindow(TXT)
					Set fRet = FALSE
					! == Сохраняем файл во временную таблицу
					Set TXT="Завантаження файла в БД"
					Call SaveInfoToLog("CARDS IMPORT. Импорт файла " || sFilePath)
					Call PutFileToTmpLob(hSql(), sFilePath, 'C')
					Call SaveInfoToLog("CARDS IMPORT. Файл " || sFileName || " сохранен во временной таблице")
					! == импорт уже из временной таблицы
					If SqlPLSQLCommand(hSql(), "wcs_exchange.Import_cards_xml(Card_Count)")
						Call SqlCommitEx(hSql(), "CARDS IMPORT. Выполнен импорт файла " || sFileName)
						Set TXT="Поставлено на облік " || SalFmtFormatNumber (Card_Count, '0' )  ||" карт."
						Call SalMessageBox( "Поставлено на облік " || SalFmtFormatNumber (Card_Count, '0' )  ||" карт.", 'Повідомлення', MB_Ok | MB_IconAsterisk )
						Set fRet = TRUE
					Else
						Call SqlRollbackEx(hSql(), "CARDS IMPORT. Ошибка во время импорта файла " || sFileName)
						Set TXT="Помилка завантаж. "|| sFileName
						Call SalMessageBox( "Помилка завантаження файла: "|| sFileName, 'Повідомлення', MB_Ok | MB_IconAsterisk )
					! == сохраняем файл
					Call SalWaitCursor(FALSE)
					! Call SalHideWindows(TXT)
					Return fRet
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			String: sFilter
			String: rFilter
			String: sSql
			Number: nColR
			Number: nColY
			Number: nColG
			Number: nColGR
			Number: nColBL
			!
			Number: nNewRow
			! Number: nKol
			! Number: nSum
			! ----- FILES
			String: strFilters[2]
			Number: nIndex
			String: strFile
			Boolean: fOpen
			String: dfPath
			! Для групповой замены
			Number: G_SOS_ID
			String: G_SOS_NAME
			String: G_BRANCH_ID
			String: G_BRANCH_NAME
			Number: G_STAFF_ID
			String: G_STAFF_NAME
		Message Actions
			On SAM_Create
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				! Call SalTblSetLockedColumns(hWndForm, 7)
				Set CARD.nTabInstance = 1
				Set CARD.fFilterAtStart = 1
				Set CARD.strFilterTblName = 'V_WCS_CARDS'
				Set CARD.strPrintFileName = 'WCS_CARDS_'
				Set rbA = TRUE
				! розовый Плохо.
				! Set nColR = SalColorFromRGB( 255,240,255 )
				Set nColR = COLOR_Marigold
				! серый Хорошо.
				Set nColGR = COLOR_LightGray
				! зеленый ждем.
				Set nColG = COLOR_LightGreen
				Set nColY = COLOR_Maize
				Set nColBL = COLOR_White
				!
				Call SalHideWindow(TXT)
				!
				Set hWndForm.CARD.strSqlUpdate = "update V_WCS_CARDS 
						                                                                  set  BRANCH  =:hWndForm.CARD.BRANCH_ID,
						                                                                         STAFF_ID  =:hWndForm.CARD.STAFF_ID, 
						                                                                         SOS  =:hWndForm.CARD.SOS_ID 
						                                                              where ID  =:hWndForm.CARD.ID "
				Set hWndForm.CARD.strSqlDelete = 
						"DELETE FROM V_WCS_CARDS  where ID  =:hWndForm.CARD.ID "
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				If CARD.fFilterAtStart
					Set CARD.fFilterAtStart = NOT CARD.fFilterAtStart
					If NOT SetQueryFilter( cF )
						Call SalDestroyWindow( hWndForm )
				!
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				Call SalWaitCursor(TRUE)
				Set nKol = 0
				If rbBL
					Set rFilter = '(to_number(trunc(SOS/10))=1) '
				Else If rbR
					Set rFilter = '(to_number(trunc(SOS/10))=5) '
				Else If rbGR
					Set rFilter = '(to_number(trunc(SOS/10))=4) '
				Else If rbG
					Set rFilter = '(to_number(trunc(SOS/10))=3) '
				Else If rbY
					Set rFilter = '(to_number(trunc(SOS/10))=2) '
				Else If rbA
					Set rFilter = '(to_number(trunc(SOS/10))>0) '
				! StrIFF
				! Set sSql =
						"SELECT ID,   CARD_ID,  BANK_MFO,  CARD_NO,
						                CARD_NLS,  KV,  DATP,  USER_NAME,  
						                 BRANCH, (select name from branch b where b.branch=V_WCS_CARDS.branch),
						                STAFF_ID, (select fio from staff b where b.id=V_WCS_CARDS.staff_id),
						                 DATM,CC_ID,DATC,
						                SOS,COLOR_SOS  ,(select name from wcs_cards_sos b where b.sos=V_WCS_CARDS.sos),
						                 SOS_DAT,AKS_DONE
						 INTO      :ID,  :CARD_ID,  :BANK_MFO,  :CARD_NO,
						                :CARD_NLS,  :KV,  :DATP,   : USER_NAME,  
						                :BRANCH_ID,  :BRANCH_NAME,
						                :STAFF_ID,  :STAFF_NAME,
						                :DATM,  :CC_ID,  :NMK, :DATC,
						                :SOS_ID,  :COLOR_SOS,  :SOS_NAME,
						                :SOS_DAT,  :AKS_DONE
						 FROM V_WCS_CARDS
						 WHERE " || rFilter ||
						 IifS(sFilter = "", ""," and "|| sFilter) || "
						  ORDER BY ID desc "
				Set sSql =
						"SELECT ID,   CARD_ID,   BANK_MFO,   CARD_NO,
						                CARD_NLS,  KV,  DATP,  USER_NAME,
						                BRANCH, (select name from branch b where b.branch=V_WCS_CARDS.branch),
						                STAFF_ID, (select fio from staff b where b.id=V_WCS_CARDS.staff_id),
						                DATM,CC_ID,NMK,DATC,
						                SOS,to_number(trunc(SOS/10))  ,SOS_NAME,
						                SOS_DAT,AKS_DONE,AKS_DONE_NAME,AKS_PACKID,AKS_REF
						 INTO      :ID,  :CARD_ID,  :BANK_MFO,  :CARD_NO,
						                :CARD_NLS,  :KV,  :DATP,  :USER_NAME,  
						                :BRANCH_ID,  :BRANCH_NAME,
						                :STAFF_ID,  :STAFF_NAME,
						                :DATM,  :CC_ID,  :NMK, :DATC
						                :SOS_ID,  :COLOR_SOS,  :SOS_NAME,
						                :SOS_DAT,  :AKS_DONE,:AKS_DONE_NAME,:AKS_PACKID,:AKS_REF
						  FROM V_WCS_CARDS
						  WHERE " || rFilter ||
						   IifS(sFilter = "", ""," and "|| sFilter) || "
						  ORDER BY ID desc "
				!
				!
				Call SalTblPopulate(hWndForm, hSql(), sSql , TBL_FillAll  )
				! Call SalTblDefineSplitWindow(hWndForm, 1, TBL_Split_Adjustable)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If COLOR_SOS = 1
					! Call XSalTblSetRowBackColor( hWndForm, lParam, nColBL )
				Else If COLOR_SOS = 2
					Call XSalTblSetRowBackColor( hWndForm, lParam, nColY )
				Else If COLOR_SOS =3
					Call XSalTblSetRowBackColor( hWndForm, lParam, nColG )
				Else If COLOR_SOS =4
					Call XSalTblSetRowBackColor( hWndForm, lParam, nColGR )
				Else If COLOR_SOS = 5
					Call XSalTblSetRowBackColor( hWndForm, lParam, nColR )
				Else
					Call XSalTblSetRowBackColor( hWndForm, lParam, nColBL )
				Set nKol = nKol + 1
				!
				If CARD.AKS_DONE =4 or  CARD.AKS_DONE =6
					! Call XSalTblSetCellBackColor(hWndForm.CARD.AKS_DONE_NAME, SalColorFromRGB( 255,210,250 ) )
					Call XSalTblSetCellBackColor(hWndForm.CARD.AKS_DONE_NAME, COLOR_Red )
				!
				!
				! Set nSum = nSum + ISUM
				!
				Set strFilters[0] = 'XML Files (*.xml)'
				Set strFilters[1] = '*.xml'
				!
			! On SAM_DoubleClick
	Dialog Box: Card_Change_sos
		Class:
		Property Template:
		Class DLL Name:
		Title: Форма для групової зміни
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  6.35"
				Width Editable? Yes
				Height: 2.619"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Pushbutton: pb1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   4.783"
					Top:    1.655"
					Width:  1.3"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set SOS_ID=NUMBER_Null
						Call SalSendMsg( Card_Change_sos, SAM_Close, 0, 0 )
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, "Вихід")
			Combo Box: cmb_SOS_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.283"
					Top:    0.321"
					Width:  3.4"
					Width Editable? Class Default
					Height: 1.81"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmb_SOS_NAME.Init(hWndItem)
						Call cmb_SOS_NAME.Populate( hSql(), "SOS", "NAME", "WCS_CARDS_SOS", " ORDER BY sos" )
					On SAM_AnyEdit
						If cmb_SOS_NAME=STRING_Null
							Set SOS_ID=NUMBER_Null
					On SAM_TooltipSetText
						! Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(27))
					On SAM_Click
						Set SOS_ID= cmb_SOS_NAME.GetKey( SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Combo Box: cmb_BRANCH_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_StrId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.283"
					Top:    0.821"
					Width:  5.8"
					Width Editable? Class Default
					Height: 1.655"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmb_BRANCH_NAME.Init(hWndItem)
						Call cmb_BRANCH_NAME.Populate( hSql(), "BRANCH", "NAME", "BRANCH", " ORDER BY name" )
					On SAM_AnyEdit
						! Set BRANCH_ID= cmb_BRANCH_NAME.GetKey( SalListQuerySelection(hWndItem))
						! Call cmb_STAFF_NAME.Populate( hSql(), "ID", "FIO", "STAFF", "WHERE BRANCH like '"||BRANCH_ID||"' ORDER BY fio" )
						! If cmb_BRANCH_NAME=STRING_Null
							          Set BRANCH_ID=STRING_Null
							! Set cmb_STAFF_NAME=STRING_Null
							! Set STAFF_ID=NUMBER_Null
					On SAM_TooltipSetText
						! Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(27))
					On SAM_Click
						Set BRANCH_ID= cmb_BRANCH_NAME.GetKey( SalListQuerySelection(hWndItem))
						Set cmb_STAFF_NAME=STRING_Null
						Set STAFF_ID=NUMBER_Null
						Call cmb_STAFF_NAME.Populate( hSql(), "ID", "FIO", "STAFF", "WHERE BRANCH like '"||BRANCH_ID||"' ORDER BY fio" )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Combo Box: cmb_STAFF_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.283"
					Top:    1.321"
					Width:  5.8"
					Width Editable? Class Default
					Height: 1.81"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmb_STAFF_NAME.Init(hWndItem)
						! Call cmb_STAFF_NAME.Populate( hSql(), "ID", "FIO", "STAFF", " ORDER BY fio" )
					! On SAM_AnyEdit
						          If cmb_STAFF_NAME=STRING_Null
							          Set STAFF_ID=NUMBER_Null
					On SAM_TooltipSetText
						! Return XSalTooltipSetText( lParam, F_LOAD_COMMENT(27))
					On SAM_Click
						Set STAFF_ID= cmb_STAFF_NAME.GetKey( SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Стан
				Resource Id: 54207
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.283"
					Top:    0.095"
					Width:  0.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Відділення
				Resource Id: 54208
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.283"
					Top:    0.595"
					Width:  1.3"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Менеджер
				Resource Id: 54209
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.283"
					Top:    1.095"
					Width:  1.3"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Pushbutton: pb2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbOk
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   3.383"
					Top:    1.655"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set G_SOS_NAME=cmb_SOS_NAME
						Set G_BRANCH_NAME=cmb_BRANCH_NAME
						Set G_STAFF_NAME=cmb_STAFF_NAME
						Call SalSendMsg( Card_Change_sos, SAM_Close, 0, 0 )
		Functions
		Window Parameters
			Receive Number: SOS_ID
			Receive String: G_SOS_NAME
			Receive String: BRANCH_ID
			Receive String: G_BRANCH_NAME
			Receive Number: STAFF_ID
			Receive String: G_STAFF_NAME
		Window Variables
		Message Actions
			On SAM_Create
				! Set cmb_SOS_NAME= G_SOS_NAME
				! Set cmb_BRANCH_NAME=G_BRANCH_NAME
				! Set cmb_STAFF_NAME=G_STAFF_NAME
