Application Description: Statements for customers with EMail
	Outline Version - 4.0.26
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000DE0000 002C000000020000 0003000000FFFFFF FFFFFFFFFFFCFFFF
0040: FFE9FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D01000000075769 6E646F7773
.enddata
.data DT_MAKERUNDLG
0000: 020000000018513A 5C4241525339385C 42494E5C665F7670 736B2E6578651851
0020: 3A5C424152533938 5C42494E5C665F76 70736B2E646C6C18 513A5C4241525339
0040: 385C42494E5C665F 7670736B2E617063 00000101011C513A 5C4241525339385C
0060: 4C4942524152595C 665F7670736B2E72 756E1C513A5C4241 525339385C4C4942
0080: 524152595C665F76 70736B2E646C6C1C 513A5C4241525339 385C4C4942524152
00A0: 595C665F7670736B 2E61706300000101 01165C4241525339 385C42494E5C665F
00C0: 7670736B2E617064 165C424152533938 5C42494E5C665F76 70736B2E646C6C16
00E0: 5C4241525339385C 42494E5C665F7670 736B2E6170630000 0101011C513A5C42
0100: 41525339385C4C49 42524152595C665F 7670736B2E61706C 1C513A5C42415253
0120: 39385C4C49425241 52595C665F767073 6B2E646C6C1C513A 5C4241525339385C
0140: 4C4942524152595C 665F7670736B2E61 70630000010101
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left:   -0.013"
			Top:    0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: 0418B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left:   4.15"
			Top:    1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left:   0.575"
			Top:    0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left:   6.388"
			Top:    0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		Dynalib: Global.apd
		Dynalib: Absapi.apd
		File Include: Genfcls.apl
		File Include: Constant.apl
		File Include: Gentimer.apl
		File Include: GENLIST.APL
		File Include: xsalspl.apl
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
		External Functions
			Library name: User32.Dll
				Function: IsWindow
					Description:
					Export Ordinal: 0
					Returns
						Boolean: BOOL
					Parameters
						Window Handle: HWND
				Function: GetDesktopWindow
					Description: Получить хэндл дэсктопа
					Export Ordinal: 0
					Returns
						Window Handle: HWND
					Parameters
				Function: ShowWindow
					Description: Показать окно в различных модификациях
					Export Ordinal: 0
					Returns
						Boolean: BOOL
					Parameters
						Window Handle: HWND
						Number: INT
				!
				Function: GetClientRect
					Description:
					Export Ordinal: 0
					Returns
						Boolean: BOOL
					Parameters
						Window Handle: HWND
						structPointer
							Receive Number: LONG
							Receive Number: LONG
							Receive Number: LONG
							Receive Number: LONG
				Function: GetWindowRect
					Description:
					Export Ordinal: 0
					Returns
						Boolean: BOOL
					Parameters
						Window Handle: HWND
						structPointer
							Receive Number: LONG
							Receive Number: LONG
							Receive Number: LONG
							Receive Number: LONG
				Function: ValidateRect
					Description:
					Export Ordinal: 0
					Returns
						Boolean: BOOL
					Parameters
						Window Handle: HWND
						structPointer
							Number: LONG
							Number: LONG
							Number: LONG
							Number: LONG
				!
				Function: GetMenu
					Description: Получить хэндл меню
					Export Ordinal: 0
					Returns
						Number: HANDLE
					Parameters
						Window Handle: HWND
				Function: DrawMenuBar
					Description: Перерисовывает полоску меню
					Export Ordinal: 0
					Returns
						Boolean: BOOL
					Parameters
						Window Handle: HWND
				Function: GetMenuItemRect
					Description: Получить координаты рамки пункта меню
					Export Ordinal: 0
					Returns
						Boolean: BOOL
					Parameters
						Window Handle: HWND
						Number: HANDLE
						Number: UINT
						structPointer
							Receive Number: LONG
							Receive Number: LONG
							Receive Number: LONG
							Receive Number: LONG
				Function: GetMenuItemID
					Description: Получить ид пункта меню
					Export Ordinal: 0
					Returns
						Number: UINT
					Parameters
						Number: HANDLE
						Number: INT
				Function: GetMenuItemInfoA
					Description: Получить информацию о пункте меню
					Export Ordinal: 0
					Returns
						Boolean: BOOL
					Parameters
						Number: HANDLE
						Number: UINT
						Boolean: BOOL
						structPointer
							Number: UINT
							Number: UINT
							Receive Number: UINT
							Receive Number: UINT
							Receive Number: UINT
							Receive Number: HANDLE
							Receive Number: HANDLE
							Receive Number: HANDLE
							Receive Number: DWORD
							Receive String: LPSTR
							Receive Number: UINT
				Function: SetMenuItemInfoA
					Description: Назначить параметры пункта меню
					Export Ordinal: 0
					Returns
						Boolean: BOOL
					Parameters
						Number: HANDLE
						Number: UINT
						Boolean: BOOL
						structPointer
							Number: UINT
							Number: UINT
							Number: UINT
							Number: UINT
							Number: UINT
							Number: HANDLE
							Number: HANDLE
							Number: HANDLE
							Number: DWORD
							String: LPSTR
							Number: UINT
				Function: EnableMenuItem
					Description: Enable/Disable пункт меню
					Export Ordinal: 0
					Returns
						Boolean: BOOL
					Parameters
						Number: HANDLE
						Number: UINT
						Number: UINT
			Library name: vti11.dll
				!
				! ***** Visual Toolchest - VTFILE.APL
				!
				! ***** File functions
				Function: VisFileAppend
					Description: nErrCode VisFileAppend( sSourceFile, sTargetFile )
					Export Ordinal: 51
					Returns
						Number: INT
					Parameters
						String: LPSTR
						String: LPSTR
				Function: VisFileClose
					Description: nErrCode VisFileClose( hFile )
					Export Ordinal: 188
					Returns
						Number: INT
					Parameters
						File Handle: HFILE
				Function: VisFileCopy
					Description: nErrCode VisFileCopy( sSourceFile, sTargetFile )
					Export Ordinal: 37
					Returns
						Number: INT
					Parameters
						String: LPSTR
						String: LPSTR
				Function: VisFileCreateTemp
					Description: sTempName VisDosGetTempFileName( sPrefix )
					Export Ordinal: 23
					Returns
						String: HSTRING
					Parameters
						String: LPSTR
				Function: VisFileDelete
					Description: nNumDeleted VisFileDelete( sFileName )
					Export Ordinal: 39
					Returns
						Number: INT
					Parameters
						String: LPSTR
				Function: VisFileExpand
					Description: nErrCode VisFileExpand( sSourceFile, sTargetFile )
					Export Ordinal: 53
					Returns
						Number: INT
					Parameters
						String: LPSTR
						String: LPSTR
				Function: VisFileFind
					Description:
					Export Ordinal: 36
					Returns
						String: HSTRING
					Parameters
						String: LPSTR
				Function: VisFileGetAttribute
					Description: nAttribute VisFileGetAttribute( sFileName )
					Export Ordinal: 48
					Returns
						Number: INT
					Parameters
						String: LPSTR
				Function: VisFileGetSize
					Description: nFileSize VisFileGetSize( sFileName )
					Export Ordinal: 49
					Returns
						Number: LONG
					Parameters
						String: LPSTR
				Function: VisFileGetType
					Description: nFileType VisFileGetType( sFileName )
					Export Ordinal: 189
					Returns
						Number: INT
					Parameters
						String: LPSTR
				Function: VisFileOpen
					Description: nErrCode VisFileOpen( hFile, sFileName, nFlags )
					Export Ordinal: 190
					Returns
						Number: INT
					Parameters
						Receive File Handle: LPHFILE
						String: LPSTR
						Number: WORD
				Function: VisFileRead
					Description: nBytesRead VisFileRead( hFile, sBuffer, nSize )
					Export Ordinal: 191
					Returns
						Number: LONG
					Parameters
						File Handle: HFILE
						Receive String: LPHSTRING
						Number: DWORD
				Function: VisFileReadString
					Description: nErrCode VisFileReadString( hFile, sLine )
					Export Ordinal: 192
					Returns
						Number: INT
					Parameters
						File Handle: HFILE
						Receive String: LPHSTRING
				Function: VisFileRename
					Description: nErrCode VisFileRename( sSourceFile, sTargetFile )
					Export Ordinal: 52
					Returns
						Number: INT
					Parameters
						String: LPSTR
						String: LPSTR
				Function: VisFileSetAttribute
					Description: nErrCode VisFileSetAttribute( sFileName, nAttributes, bState )
					Export Ordinal: 50
					Returns
						Number: INT
					Parameters
						String: LPSTR
						Number: WORD
						Boolean: BOOL
				Function: VisFileSetDateTime
					Description: nErrCode VisFileSetDateTime( sFileName, dtDateTime )
					Export Ordinal: 27
					Returns
						Number: INT
					Parameters
						String: LPSTR
						Date/Time: DATETIME
				Function: VisFileSeek
					Description: nErrCode VisFileSeek( hFile, nOffset, nOrigin )
					Export Ordinal: 193
					Returns
						Number: LONG
					Parameters
						File Handle: HFILE
						Number: LONG
						Number: INT
				Function: VisFileTell
					Description: nOffset VisFileTell( hFile )
					Export Ordinal: 194
					Returns
						Number: LONG
					Parameters
						File Handle: HFILE
				Function: VisFileWrite
					Description: nErrCode VisFileWrite( hFile, sBuffer, sSize )
					Export Ordinal: 195
					Returns
						Number: INT
					Parameters
						File Handle: HFILE
						String: HSTRING
						Number: DWORD
				Function: VisFileWriteString
					Description: nErrCode VisFileWriteString( hFile, sLine )
					Export Ordinal: 196
					Returns
						Number: INT
					Parameters
						File Handle: HFILE
						String: LPSTR
			! Library name: vti11.dll
				!
				! ***** Visual Toolchest - VTSTR.APL
				!
				! ***** String functions
				           Function: VisStrChoose
					           Description: sReturn VisStrChoose( bExpression, sTrue, sFalse )
					           Export Ordinal: 243
					           Returns 
						           String: HSTRING
					           Parameters 
						           Boolean: BOOL
						           String: HSTRING
						           String: HSTRING
				           Function: VisStrExpand
					           Description: sReturn VisStrExpand( sTemplate, hAryStrings )
					           Export Ordinal: 91
					           Returns 
						           String: HSTRING
					           Parameters 
						           String: LPSTR
						           String: HARRAY
				           Function: VisStrFind
					           Description: sString VisStrFind( hStrTable, sContext )
					           Export Ordinal: 218
					           Returns 
						           String: HSTRING
					           Parameters 
						           Number: INT
						           String: LPSTR
				           Function: VisStrFreeTable
					           Description: bOk VisStrFreeTable( hStrTable )
					           Export Ordinal: 219
					           Returns 
						           Boolean: BOOL
					           Parameters 
						           Number: INT
				           Function: VisStrLeftTrim
					           Description: sReturn VisStrLeftTrim( sSource )
					           Export Ordinal: 123
					           Returns 
						           String: HSTRING
					           Parameters 
						           String: LPSTR
				           Function: VisStrLoadTable
					           Description: hStrTable VisStrLoadTable( sFileName )
					           Export Ordinal: 220
					           Returns 
						           Number: INT
					           Parameters 
						           String: LPSTR
				           Function: VisStrPad
					           Description: sReturn VisStrPad( sSource, nSize )
					           Export Ordinal: 8
					           Returns 
						           String: HSTRING
					           Parameters 
						           String: LPSTR
						           Number: INT
				           Function: VisStrProper
					           Description: sReturn VisStrProper( sSource )
					           Export Ordinal: 63
					           Returns 
						           String: HSTRING
					           Parameters 
						           String: LPSTR
				           Function: VisStrRightTrim
					           Description: sReturn VisStrRightTrim( sSource )
					           Export Ordinal: 124
					           Returns 
						           String: HSTRING
					           Parameters 
						           String: LPSTR
				           Function: VisStrScanReverse
					           Description: nPos VisStrScanReverse( sSource, nPos, sSearch )
					           Export Ordinal: 10
					           Returns 
						           Number: INT
					           Parameters 
						           String: LPSTR
						           Number: INT
						           String: LPSTR
				           Function: VisStrSubstitute
					           Description: sReturn VisStrSubstitute( sSource, sSearch, sReplace )
					           Export Ordinal: 62
					           Returns 
						           String: HSTRING
					           Parameters 
						           String: LPSTR
						           String: LPSTR
						           String: LPSTR
				           Function: VisStrTrim
					           Description: sReturn VisStrTrim( sSource )
					           Export Ordinal: 6
					           Returns 
						           String: HSTRING
					           Parameters 
						           String: LPSTR
			Library name: WINBARS2.DLL
				! //  WINBARS2.DLL  ///////////////////////////////////////////////////////////////////////////////////////////
				!
				Function: StrWinToDosX
					Description: Перекодирует строку ANSI -> OEM
					Export Ordinal: 2
					Returns
						String: LPSTR
					Parameters
						String: LPSTR
				Function: StrDosToWinX
					Description: Перекодирует строку OEM -> ANSI
					Export Ordinal: 3
					Returns
						String: LPSTR
					Parameters
						String: LPSTR
				Function: StrWintToVolapjukX
					Description: Перекодирует строку ANSI -> Volapjuk
					Export Ordinal: 8
					Returns
						String: LPSTR
					Parameters
						String: LPSTR
				!
				Function: ItoA
					Description: Превращает беззнаковое целое в строку двоичного числа
					Export Ordinal: 4
					Returns
						String: LPSTR
					Parameters
						Number: UINT
				Function: GetChecksumDigit
					Description: Возвращает цифру-символ контрольного разряда
							для заданного МФО и номера счета
					Export Ordinal: 7
					Returns
						Number: CHAR
					Parameters
						String: LPSTR
						String: LPSTR
						Number: INT
				!
				! MultiLanguage support function
				Function: OpenLangFileRead
					Description: Открывает файл языковых локализаций
							с проверками для чтения
					Export Ordinal: 9
					Returns
						Number: LONG
					Parameters
						String: LPSTR
						Receive String: LPSTR
						Receive Number: LPINT
						Boolean: BOOL
				Function: OpenLangFileWrite
					Description: Открывает файл языковых локализаций
							с проверками для записи
					Export Ordinal: 10
					Returns
						Number: LONG
					Parameters
						String: LPSTR
						String: LPSTR
						Number: INT
				Function: GetLangRecord
					Description: Получить запись локализации по номеру
					Export Ordinal: 11
					Returns
						Boolean: BOOL
					Parameters
						Number: LONG
						Number: INT
						Receive String: LPSTR
						Receive String: LPSTR
						Receive String: LPSTR
				Function: SetLangRecord
					Description: Сохранить запись локализации по номеру
					Export Ordinal: 12
					Returns
						Boolean: BOOL
					Parameters
						Number: LONG
						Number: INT
						String: LPSTR
						String: LPSTR
						String: LPSTR
				Function: CloseLangFile
					Description:
					Export Ordinal: 13
					Returns
						Boolean: BOOL
					Parameters
						Number: LONG
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
		Resources
		Variables
			Window Handle: hWin0
		Internal Functions
			Function: EMailStatements			!__exported
				Description:
				Returns
					Boolean:
				Parameters
					Window Handle: hWin
				Static Variables
				Local variables
				Actions
					If IsWindow( hWin0 )
						Call SalBringWindowToTop( hWin0 )
					Else
						Set hWin0 = SalCreateWindow(frm_CEMS, hWin)
						If hWin0
							Return TRUE
						Else
							Return FALSE
		Named Menus
		Class Definitions
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton:
			Radio Button:
			Option Button:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box:
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control:
		Application Actions
	Form Window: frm_CEMS
		Class:
		Property Template:
		Class DLL Name:
		Title: Формирование выписок
		Icon File:
		Accesories Enabled? Yes
		Visible? No
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   1.28"
				Top:    1.067"
				Width:  10.0"
				Width Editable? Yes
				Height: 5.0"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.65"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Pushbutton: pbExit
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Выход
					Window Location and Size
						Left:   8.1"
						Top:    0.104"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.4"
						Height Editable? Yes
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Picture File Name:
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Red
					Background Color: Default
					Message Actions
						On SAM_Click
							Call SalDestroyWindow( hWndForm )
				Pushbutton: pbOk
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Стандартные
					Window Location and Size
						Left:   0.15"
						Top:    0.107"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.396"
						Height Editable? Yes
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name:
					Picture Transparent Color: None
					Image Style: Single
					Text Color: Blue
					Background Color: Default
					Message Actions
						On SAM_Click
							Set bOk = TRUE
							Call SalSendMsg( hWndForm, SAM_User, 0, 0 )
				Pushbutton: pbZakl
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Заключительные
					Window Location and Size
						Left:   2.343"
						Top:    0.107"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.4"
						Height Editable? Yes
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name:
					Picture Transparent Color: None
					Image Style: Single
					Text Color: Blue
					Background Color: Default
					Message Actions
						On SAM_Click
							Set bZakl = TRUE
							Call SalSendMsg( hWndForm, SAM_User, 0, 0 )
				Pushbutton: pbTimer
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTimer
					Property Template:
					Class DLL Name:
					Title: таймер
					Window Location and Size
						Left:   6.714"
						Top:    0.198"
						Width:  1.2"
						Width Editable? Yes
						Height: 0.292"
						Height Editable? Yes
					Visible? No
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name:
					Picture Transparent Color: None
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Call pbTimer.Init( nInterval, 0, TRUE )
						On UM_TimerFired
							Call SalSendMsg( hWndForm, SAM_User, 0, 0 )
				Check Box: cbBD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Банк.Дата
					Window Location and Size
						Left:   4.5"
						Top:    0.042"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							If not cbBD
								Call SalEnableWindow( dfDat )
							Else
								Call SalDisableWindow( dfDat )
								Call SalListSetSelect( dfDat, SalListSelectString( dfDat, -1, SalFmtFormatDateTime( dBankDate, 'dd/MM/yyyy' ) ) )
				Combo Box: dfDat
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_DatId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   4.5"
						Top:    0.31"
						Width:  2.0"
						Width Editable? Class Default
						Height: 3.667"
						Height Editable? Class Default
					Visible? Class Default
					Editable? Class Default
					String Type: Class Default
					Maximum Data Length: Class Default
					Sorted? Class Default
					Always Show List? Class Default
					Vertical Scroll? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
					List Initialization
					Message Actions
						On SAM_Create
							Call SalListClear( dfDat )
							Call SqlPrepareAndExecute( hSql(), "
									  SELECT to_char(fdat,'dd/MM/yyyy') INTO :sTmp
									  FROM fdat ORDER BY fdat desc" )
							While SqlFetchNext( hSql(), nFetchRes )
								Call SalListAdd( dfDat, sTmp )
							Call SalListSetSelect( hWndItem, SalListSelectString( hWndItem, -1, SalFmtFormatDateTime( dBankDate, 'dd/MM/yyyy' ) ) )
							Call SalSendMsg( dfDat, SAM_Click, 0, 0 )
						On SAM_Click
							Set dBD = SalStrToDate( dfDat )
		Contents
			Custom Control: cVS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitter
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  9.757"
						Width Editable? Class Default
						Height: 4.167"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Yes
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tblClient
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.171"
						Top:    0.073"
						Width:  4.729"
						Width Editable? Yes
						Height: 3.854"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 3000
					Discardable? Yes
				Contents
					Column: colRNK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Рег.
								№
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.7"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNMK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование клиента
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  4.5"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colPeriod
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Период
								(сек)
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.9"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colN
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: n
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colDate
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.8"
						Width Editable? Yes
						Format: DateTime
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colFinal
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: fin
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On UM_Populate
						! Выбираем тех клиентов, у кот. active=1 и есть счета 
								  для выписок (в табл. customer_email_acc)
						Call SalTblPopulate( tblClient, cSql.hSql() , "
								  SELECT distinct e.rnk, e.period, e.stmt_n, e.stmt_date,
								         e.stmt_final, c.nmk
								  INTO :tblClient.colRNK, :tblClient.colPeriod,
								       :tblClient.colN,   :tblClient.colDate,
								       :tblClient.colFinal, :tblClient.colNMK  
								  FROM CUSTOMER_EMAIL_STATEMENT e, customer c, customer_email_acc a
								  WHERE e.active=1 and e.rnk=c.rnk and e.rnk=a.rnk
								  ORDER BY e.rnk ", TBL_FillAll )
						Call SalTblSetContext( tblClient, 0)
						Call SalSendMsg( tblClient, SAM_RowSetContext, 0, 0 )
					On SAM_RowSetContext
						Call SalSendMsg(tblACC, UM_Populate, 0, 0)
			Child Table: tblACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   5.114"
						Top:    0.063"
						Width:  4.729"
						Width Editable? Yes
						Height: 3.885"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 3000
					Discardable? Yes
				Contents
					Column: colAcc
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Идентификатор
								расч. счета
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  2.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colNLS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Счет
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colKV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: kv
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colLCV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Валюта
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Center
						Width:  1.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On UM_Populate
						Call SalTblPopulate( tblACC, cSql.hSql() , "
								  SELECT b.stmt_acc, a.nls, a.kv, t.lcv
								  INTO :tblACC.colAcc, :tblACC.colNLS,
								       :tblACC.colKV,  :tblACC.colLCV  
								  FROM CUSTOMER_EMAIL_ACC b, accounts a, tabval t 
								  WHERE b.stmt_acc=a.acc and a.kv=t.kv and b.rnk=:tblClient.colRNK
								  ORDER BY a.nls, a.kv", TBL_FillAll )
		Functions
			Function: f_ForAll
				Description: Выполнение SQL-процедуры для всех клиентов
				Returns
				Parameters
				Static Variables
				Local variables
					Date/Time: dDat
					Number: nRNK
				Actions
					Call SalWaitCursor( TRUE )
					! Set dBD = SalStrToDate('21-FEB-2002')
					! Set nRNK = tblClient.colRNK
					If SqlPLSQLCommand(cSql.hSql(), "bars.p_f_vpsk(nUserId,dBD)")
						Call SqlCommit(cSql.hSql())
						Set nFlagInUse = 0
						If IsBankDayOpen() AND SalTblAnyRows( tblClient, ROW_Selected, 0 )
							Set nFlagInUse = ROW_Selected
						Set i = TBL_MinRow
						While SalTblFindNextRow( tblClient, i, nFlagInUse, 0 )
							Call SalTblSetContext( tblClient, i )
							Set nRNK = tblClient.colRNK
							!
							Call SqlPrepareAndExecute( cSql.hSql(), "
									  SELECT sysdate INTO :dKD FROM dual" )
							Call SqlFetchNext( cSql.hSql(), nFetchRes )
							Set dDat = tblClient.colDate + tblClient.colPeriod/24/3600
							If bOk or bZakl
								Call f_FormV(nRNK)
							Else
								If dDat <= dKD
									Call f_FormV(nRNK)
					Else
						Call SqlRollback( cSql.hSql() )
					Call SalWaitCursor( FALSE )
					Return TRUE
			! Если нет оборотов, в выписке только вх. и исх. остатки
			Function: f_FormV
				Description: Отбор данных для выписки 1-го клиента
				Returns
					Boolean:
				Parameters
					Number: nRNK
				Static Variables
				Local variables
					! Number: nCount
					Number: nIndex
					!
					String: sMFOB
					String: smMFOB[*]
					String: sOKPO
					String: smOKPO[*]
					String: sNLSB
					String: smNLSB[*]
					String: sNAMB 
					String: smNAMB[*]
					Number: nDK
					Number: nmDK[*]
					Number: nS
					Number: nmS[*]
					String: sND
					String: smND[*]
					String: sNAZN
					String: smNAZN[*]
					Number: nACC
					Number: nmACC[*]
					String: sNB 
					String: smNB[*]
				Actions
					Call SqlPrepareAndExecute( cSql.hSql(), T(
							"SELECT t.mfob, t.okpob, t.nlsb, t.namb, 
							        t.dk, t.s, t.nd, t.nazn, t.acc, b.nb  
							 INTO   :sMFOB, :sOKPO,  :sNLSB, :sNAMB, 
							        :nDK, :nS, :sND, :sNAZN, :nACC, :sNB  
							 FROM tmp_lici t, banks b 
							 WHERE t.id=:nUserId and t.mfob=b.mfo(+) AND t.kodirowka=:nRNK 
							 ORDER BY t.dk, t.s") )
					Set nIndex = 0
					Call SalArraySetUpperBound(smMFOB, 1, -1)
					Call SalArraySetUpperBound(smOKPO, 1, -1)
					Call SalArraySetUpperBound(smNLSB, 1, -1)
					Call SalArraySetUpperBound(smNAMB, 1, -1)
					Call SalArraySetUpperBound(nmDK,   1, -1)
					Call SalArraySetUpperBound(nmS,    1, -1)
					Call SalArraySetUpperBound(smND,   1, -1)
					Call SalArraySetUpperBound(smNAZN, 1, -1)
					Call SalArraySetUpperBound(nmACC,  1, -1)
					Call SalArraySetUpperBound(smNB,   1, -1)
					While SqlFetchNext( cSql.hSql(), nFetchRes )
						Set smMFOB[nIndex] = sMFOB
						Set smOKPO[nIndex] = sOKPO
						Set smNLSB[nIndex] = sNLSB
						Set smNAMB[nIndex] = sNAMB
						Set nmDK[nIndex]   = nDK
						Set nmS[nIndex]    = nS
						Set smND[nIndex]   = sND
						Set smNAZN[nIndex] = sNAZN
						Set nmACC[nIndex]  = nACC
						Set smNB[nIndex]   = sNB
						Set nIndex = nIndex + 1
					Call SaveInfoToLog( ' Отбор выписки для клиента ' || Str( tblClient.colRNK ) ||
							     ' (' || tblClient.colNMK || ')' )
					Call f_FormFile( nIndex, nRNK, smMFOB, smOKPO, smNLSB, smNAMB, 
							  nmDK, nmS, smND, smNAZN, nmACC, smNB )
			Function: f_FormFile
				Description: формирование файла 
				Returns
					Boolean:
				Parameters
					Number: nCount
					Number: nRNK
					String: smMFOB[*]
					String: smOKPO[*]
					String: smNLSB[*]
					String: smNAMB[*]
					Number: nmDK[*]
					Number: nmS[*]
					String: smND[*]
					String: smNAZN[*]
					Number: nmACC[*]
					String: smNB[*]
				Static Variables
				Local variables
					String: sNameF
					String: sNF
					File Handle: hNF
					Number: nKd
					Boolean: bZag
					Number: nIOST
					Number: nSdeb
					Number: nSkre
					String: sS
					String: sRNK
					String: sNLS
					String: sKV
					String: sLCV
					Number: nAcc
					Number: nK
				Actions
					Set sRNK = SalNumberToStrX( tblClient.colRNK, 0 )
					Set sNameF = sRNK || SalStrRepeatX( '_', 6 - SalStrLength( sRNK ) )
					Set sNameF = sNameF || GetCharForDigit( SalDateDay( dBD ) ) || GetCharForDigit( SalDateMonth( dBD ) ) 
					If bZakl
						Set sNameF = sNameF || '.Z00'
						Set sS = ' (закл.)'
					Else
						Set sNameF = sNameF || '.001'
						Set sS = ''
					Set sNF = strVPath || '\\' || sNameF
					If not SalFileOpen( hNF, sNF, OF_Create | OF_ReadWrite )
						Call SqlRollback( cSql.hSql() )
						Call MessageNoWait( 'Ошибка при создании файла ' || sNameF,
								     'Аварийная ситуация', 3, 1 )
						Return FALSE
					Call SalFilePutStr( hNF, Spac(15) || 'Дата: ' || SalFmtFormatDateTime( dBD, 'dd/MM/yyyy') || 
							    Spac(10) || 'Время: ' || Right( '0' || SalFmtFormatDateTime(SalDateCurrent(),'hhhh:mm:ss'), 8 )  )
					Call SalFilePutStr( hNF, '' )
					Call SqlPrepareAndExecute( cSql.hSql(),
							"SELECT b.stmt_acc, a.nls, a.kv, t.lcv, decode(s.fdat, to_date(:dBD), s.ostf, s.ostf-s.dos+s.kos) 
							 INTO :nAcc, :sNLS, :sKV, :sLCV, :nIOST 
							 FROM CUSTOMER_EMAIL_ACC b, accounts a, tabval t, saldoa s 
							 WHERE b.rnk=:nRNK AND b.stmt_acc=a.acc AND a.kv=t.kv AND a.acc=s.acc AND 
							       (a.acc,s.fdat)=
							          (SELECT c.acc,max(c.fdat)
							           FROM saldoa c
							           WHERE a.acc=c.acc AND c.fdat <= :dBD
							           GROUP BY c.acc) 
							 ORDER BY a.nls" )
					While SqlFetchNext( cSql.hSql(), nFetchRes )
						Set nKd = 0
						Set nSdeb = 0
						Set nSkre = 0
						Set nK = 0 ! кол-во документов (если=0,обороты не пишем,только ост.)
						Set bZag = TRUE
						If bZag ! Сформировать часть файла 
							Call SalFilePutStr( hNF, Spac(17) || 'Выписка по счету № ' || sNLS || '/' || sKV || sS )
							Call SalFilePutStr( hNF, '' )
							Call SalFilePutStr( hNF, Spac(19) || 'Входящий остаток : ' || PadR( SalNumberToStrX(nIOST/100,2), 25 ) )
							Call SalFilePutStr( hNF, '' )
						While nKd < nCount
							If nAcc = nmACC[nKd]
								Set nK = nK + 1
								If bZag ! Сформировать часть файла 
									Call SalFilePutStr( hNF, '  № док.  |' || 
											    '      Контрагент      |' || 'Д/К|' ||
											    '       Сумма        |' || 'Вал|' ||
											    '   Назначение' )
									Call SalFilePutStr( hNF, SalStrRepeatX( '_', 10 ) || '|' ||
											    SalStrRepeatX( '_', 22) || '|' ||
											    SalStrRepeatX( '_', 3 ) || '|' ||
											    SalStrRepeatX( '_', 20) || '|' ||
											    SalStrRepeatX( '_', 3 ) || '|' ||
											    SalStrRepeatX( '_', 17) )
									Set bZag = FALSE
								If nmDK[nKd] = 0
									Set nSdeb = nSdeb + nmS[nKd]
								Else
									Set nSkre = nSkre + nmS[nKd]
								If Val( smMFOB[nKd] ) = 0
									Set smMFOB[nKd] = GetBankMfo()
								Call SalFilePutStr( hNF, PadR( VisStrLeftTrim(smND[nKd]), 10 ) || '|' ||
										    'Счет : ' || 
										    PadR( VisStrLeftTrim(smNLSB[nKd]), 15) || '|' ||
										    IifS( nmDK[nKd]=0, ' Д |' || PadL( SalNumberToStrX( nmS[nKd]/100, 2 ), 20 ), 
										                       ' К |' || PadR( SalNumberToStrX( nmS[nKd]/100, 2 ), 20 )) || '|' ||
										    Right( '   ' || sLCV, 3 ) || '|' ||
										    VisStrLeftTrim(smNAZN[nKd]) )
								Call SalFilePutStr( hNF, SalStrRepeatX( ' ', 10) || '|' || 
										    '       ' || VisStrLeftTrim(smNAMB[nKd]) )
								Call SalFilePutStr( hNF, SalStrRepeatX( ' ', 10) || '|' || 
										    'МФО  : ' || VisStrLeftTrim(smMFOB[nKd]) )
								Call SalFilePutStr( hNF, SalStrRepeatX( ' ', 10) || '|' || 
										    'ОКПО : ' || VisStrLeftTrim(smOKPO[nKd]) )
								Call SalFilePutStr( hNF, SalStrRepeatX( ' ', 10) || '|' || 
										    '       ' || VisStrLeftTrim(smNB[nKd]) )
								Call SalFilePutStr( hNF, '' )
							Set nKd = nKd + 1
						If nK > 0
							Call SalFilePutStr( hNF, Spac(23) || 'Всего Дебет  : ' || PadL( SalNumberToStrX( nSdeb/100, 2 ), 20 ) )
							Call SalFilePutStr( hNF, Spac(23) || 'Всего Кредит : ' || PadR( SalNumberToStrX( nSkre/100, 2 ), 20 ) )
							Call SalFilePutStr( hNF, '' )
						Call SalFilePutStr( hNF, Spac(19) || 'Исходящий остаток: ' || PadR( SalNumberToStrX( (nIOST-nSdeb+nSkre)/100, 2 ), 25 ) )
						Call SalFilePutStr( hNF, '' )
						Call SalFilePutStr( hNF, SalStrRepeatX( '-', 80 ) )
						Call SalFilePutStr( hNF, '' )
					Call SalFileClose( hNF )
					If SqlPrepareAndExecute( cSql.hSql(), "
							  UPDATE CUSTOMER_EMAIL_STATEMENT 
							  SET  stmt_date=:dKD
							  WHERE rnk=:nRNK" )
						Call SqlCommit( cSql.hSql() )
						Set tblClient.colDate = dKD
		Window Parameters
		Window Variables
			: cSql
				Class: cABSConnect
			: cDop
				Class: cABSConnect
			Number: nFetchRes
			String: strVPath
			Number: nInterval
			Number: nUserId
			Date/Time: dBD
			Date/Time: dKD
			Date/Time: dBankDate
			Number: i
			Boolean: bZakl
			Boolean: bOk
			Number: nFlagInUse
			Boolean: fBD
			String: sTmp
			!
			Number: nWinX0
			Number: nWinY0
			Number: nWinWidth
			Number: nWinHeigh
			Number: nWinFW
			Number: nWinFH
			Number: nX
			Number: nY
		Message Actions
			On SAM_Create
				Call SalWaitCursor( TRUE )
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize( hWndForm )
				Call cVS.setLeftFrame( tblClient )
				Call cVS.setRightFrame( tblACC )
				Call cVS.setBarPosition( 700 )
				!
				Call XConnectGetParams( cSql )
				If NOT cSql.Connect()
					Return FALSE
				Call cDop.Clone( cSql, TRUE )
				! Вычитываем параметры
				Call SalUseRegistry( FALSE, GetCompanyName() )
				Call SalGetProfileString( INI_ElektroKlients, 'V_Path', '',
						     strVPath, GetIniFileName() )
				! По умолч. формируем выписки кажд. 3600 сек (1 час)
				Set nInterval = SalGetProfileInt ( INI_ElektroKlients, 'V_Interval', 3600, GetIniFileName() )
				!
				Set nUserId = GetUserId()
				Set dBankDate = GetBankDate()
				Set dBD = dBankDate
				Set cbBD = 1
				Set fBD =TRUE
				Call SalDisableWindow( dfDat )
				Call SalWaitCursor( FALSE )
			On SAM_CreateComplete
				Call SalSendMsg( tblClient, UM_Populate, 0, 0 )
			On SAM_User
				Call SalWaitCursor( TRUE )
				If NOT IsBankDayOpen()
					Set bZakl = TRUE
				!
				Call f_ForAll()
				!
				Set bOk = FALSE
				Set bZakl = FALSE
				Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
				Call SalWaitCursor( FALSE )
			On WM_Size
				Call SalGetWindowSize( hWndForm, nWinFW, nWinFH )
				If nWinFW >= 10
					If nWinFH < 3
						Call SalSetWindowSize( hWndForm, nWinFW, 3 )
				Else
					If nWinFH < 3
						Call SalSetWindowSize( hWndForm, 10, 3 )
					Else
						Call SalSetWindowSize( hWndForm, 10, nWinFH )
				Call GetClientRect( hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeigh )
				Call SalGetWindowLoc( hWndForm.frm_CEMS.pbExit, nX, nY )
				Call SalSetWindowLoc( hWndForm.frm_CEMS.pbExit,
						        SalPixelsToFormUnits( hWndForm, nWinWidth, FALSE )-2.5, nY )
				!
				Call SalUpdateWindow( hWndForm )
			On SAM_Destroy
				Set hWin0 = hWndNULL
				If cSql.IsConnected()
					Call cSql.Disconnect()
