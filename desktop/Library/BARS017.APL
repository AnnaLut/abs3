Application Description: Кредиты - 17-08-2007
		Перенос просроч.комис на сомн.
	Outline Version - 4.0.26
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000AA0000 002C000000020000 0003000000000000 00EF010000F8FFFF
0040: FFE1FFFFFFFFFFFF FF000000007C0200 004D010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F7773074B72
0080: 6564416363
.enddata
.data DT_MAKERUNDLG
0000: 02000000001D513A 5C4241525339385C 4C4942524152595C 424152533031352E
0020: 6578651D513A5C42 41525339385C4C49 42524152595C4241 52533031352E646C
0040: 6C1D513A5C424152 5339385C4C494252 4152595C42415253 3031352E61706300
0060: 000101011D513A5C 4241525339385C4C 4942524152595C42 4152533031352E72
0080: 756E1D513A5C4241 525339385C4C4942 524152595C424152 533031352E646C6C
00A0: 1D513A5C42415253 39385C4C49425241 52595C4241525330 31352E6170630000
00C0: 010101175C424152 5339385C42494E5C 424152533031372E 617064175C424152
00E0: 5339385C42494E5C 424152533031352E 646C6C175C424152 5339385C42494E5C
0100: 424152533031352E 6170630000010101 1D513A5C42415253 39385C4C49425241
0120: 52595C4241525330 31352E61706C1D51 3A5C424152533938 5C4C494252415259
0140: 5C42415253303135 2E646C6C1D513A5C 4241525339385C4C 4942524152595C42
0160: 4152533031352E61 70630000010101
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left:   -0.013"
			Top:    0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: 1018B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left:   4.15"
			Top:    1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left:   0.575"
			Top:    0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left:   6.388"
			Top:    0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		Dynalib: Global.apd
		File Include: Gentbl.apl
		File Include: Gentbls.apl
		File Include: Genlist.apl
		File Include: Winapi.apl
		File Include: Docwis6.apl
		File Include: Xsalcpt.apl
		! File Include: Docwis6.apl
		Dynalib: FINCALC.APD
		Dynalib: Absapi.apd
		Dynalib: Message.apd
		Dynalib: Custacnt.apd
		Dynalib: Nsiapi.apd
		Dynalib: Bars010.apd
		Dynalib: Bars017r.apd
		Dynalib: Service.apd
		Dynalib: Bars025.apd
		Dynalib: DOCVIEW.APD
		File Include: QCKTABS.APL
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
			Date/Time: d
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
				! Версионность 
				! Version
				String: ApdNum   =  '017'
				String: ApdVer   =  '163'
				!
				! by Motus
				Number: CDOC_ATTR_NAME = 0
				Number: CDOC_ATTR_VALUE = 1
				Number: CDOC_ATTR_TYPE = 2
				Number: CDOC_ATTR_LENGTH = 3
				! ! Максимальная длина RTF документа 16Мб
				Number: CDOC_MAX_RTF_LENGTH = 16777216
				Number: CDOC_DT_Text = 22
				Number: CDOC_DT_Binary = 23
				Number: CDOC_STATE_START = 0
				Number: CDOC_STATE_ID0 = 1
				Number: CDOC_STATE_ID_START = 2
				Number: CDOC_MSG_FetchRow = SAM_User
				Number: CDOC_FREQ_Never = 0
				Number: CDOC_FREQ_Day = 1
				Number: CDOC_FREQ_Free = 2
				Number: CDOC_FREQ_Week = 3
				Number: CDOC_FREQ_Month = 5
				Number: CDOC_FREQ_Quarter = 7
				Number: CDOC_FREQ_HalfYear = 180
				Number: CDOC_FREQ_Year = 360
		Resources
		Variables
.data RESOURCE 0 0 1 385711054
0000: 380000001A000000 0000000000000000 02000002000000EF 000000E002040000
0020: 00FF3FF300B80000 0200FFFF
.enddata
			Window Handle: hWin0
			Window Handle: hWin1
			Window Handle: hWin101
			Window Handle: hWin11
			Window Handle: hWin2
			Window Handle: hWin3
			Window Handle: hWin13
			Window Handle: hWin4
			Window Handle: hWin26
			Window Handle: hWin_CCK 
			Window Handle: hWin_TA
			Window Handle: hISG
			Window Handle: hWin_NAT
			!
			Window Handle: hDocWdog
			Window Handle: hWin5
			Boolean: bApdInited
			Number: nFetchRes
			Number: nHaveTOBO
			String: gOB22
		Internal Functions
			Function: Sel017	! __exported
				Description: Bars017_Selector
				Returns
				Parameters
					Window Handle: hWndParent
					Number: nTip_Ur
					Number: nMode 
					Number: nPar 
					String: strPar01
					String: strPar02
					Number: ACCS
				Static Variables
				Local variables
				Actions
					Set gOB22 = GetGlobalOption('OB22')
					Call Ini017()
					Call Initcc()
					Set nHaveTOBO = GetGlobalOptionEx('HAVETOBO')
					Select Case nMode
						Case 11 !! Выбор NDZ из всех существующих для данного КД
							If not IsWindow(hWin11)
								Set hWin11 = SalCreateWindow( NDZ, hWndMDI, nTip_Ur, nPar, strPar01, strPar02, ACCS )
							Else
								Call SalBringWindowToTop ( NDZ )
							Break
						Case 2 !! Договора Залога 
							If not IsWindow(hWin2)
								Set hWin2 = SalCreateWindow(frmOpZalAcc, hWndMDI, nTip_Ur, nPar, strPar01, strPar02, ACCS)
							Else
								Call SalBringWindowToTop ( frmOpZalAcc )
							Break
						Case 0 !! Счета и % ставки по договору
							! If not IsWindow(hWin0)
								                                                                                                                                                                                                                                              Set hWin0 = SalCreateWindow(frmOpKredAcc, hWndMDI, nTip_Ur, nPar, strPar01,strPar02)
							! Else
								                                                                                                                                                                                                                                              Call SalBringWindowToTop ( frmOpKredAcc )
							Call SalCreateWindow(KredAcc, hWndMDI, nTip_Ur, nPar, strPar01,strPar02)
							Break
						Case 26 !! Расчет Эф.% ставки по 1 КД
							If not IsWindow(hWin26)
								Set hWin26 = SalCreateWindow(Tbl_IRR, hWndMDI, nTip_Ur, nPar, strPar01, strPar02 )
							Else
								Call SalBringWindowToTop ( hWin26 )
							Break
						Case 200 !! Бланковый учет 
							If not IsWindow(hWin2)
								Set hWin2 = SalCreateWindow(CRD, hWndMDI, nTip_Ur, nPar, strPar01, strPar02)
							Else
								Call SalBringWindowToTop ( CRD )
							Break
						Case 297 ! Погашення кредиту готівкою
							If not IsWindow(hWin_CCK)
								! Set hWin_CCK = SalCreateWindow( CCK, hWndParent, nMode, nPar, strPar01, strPar02 )
								Set hWin_CCK = SalCreateWindow( CCK1, hWndParent, nMode, nPar, strPar01, strPar02 )
							Else
								Call SalBringWindowToTop ( hWin_CCK )
							Break
							! Call Sel017( hWndMDI, NUMBER_Null, nMode, nPar, strPar01, strPar02, NUMBER_Null )
						! Case 299 ! Тест-Аккета(OLD)
							                                                                                                                                                                                              If not IsWindow(hWin_TA)
								                                                                                                                                                                                              Set hWin_TA = SalCreateWindow( TA, hWndParent, nMode, nPar, strPar01, strPar02 )
							                                                                                                                                                                                              Else 
								                                                                                                                                                                                              Call SalBringWindowToTop ( hWin_TA )
							                                                                                                                                                                                              Break 
						Case 298 ! Тест-Аккета (NEW)
							If not IsWindow(hWin_NAT)
								Set hWin_NAT = SalCreateWindow( NAT, hWndParent, nMode, nPar, strPar01, strPar02 )
							Else
								Call SalBringWindowToTop ( hWin_NAT )
							Break
						Case 7 ! Ручной разбор кредитовых остатков ISG
							If IsWindow( hISG )
								Call SalDestroyWindow( hISG )
							Set hISG = SalCreateWindow(ISG, hWndMDI, nMode, nPar,strPar01,strPar02 )
							Break
			Function: Sel017d	! __exported
				Description: Запрс даты для рег по эф.% ставке
				Returns
					Number:
				Parameters
					String: sTitl
					Receive Date/Time: Dat_IRR
				Static Variables
				Local variables
					Date/Time: dTmp
				Actions
					Set gOB22 = GetGlobalOption('OB22')
					Set dTmp = Dat_IRR
					If SalModalDialog(dlg_IRR, hWndMDI, sTitl, dTmp ) = 1
						Set Dat_IRR = dTmp
						Return 1
					!
					Return 0
			Function: Initcc
				Description: инициализация библиотеки
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: strPathToLangResources
					String: strLangId
					String: strFileName
				Actions
					If not bApdInited
						Set strPathToLangResources = GetLangPath()
						Set strLangId = GetLang()
						Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars011.lng"
						If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
							Call CurrentLangTable.Init()
						Call DocWisInit( 'cDocWdog.' )
						Set bApdInited = TRUE
					Return bApdInited
			Function: Sel017t	! __exported
				Description:
				Returns
				Parameters
					Window Handle: hW
					String: Title
					Receive Number: fEdited
					Receive Long String: SQLText
					Number: bFL_Edit
				Static Variables
				Local variables
					Boolean: bTmp
					String: sTmp
				Actions
					Set gOB22 = GetGlobalOption('OB22')
					Set bTmp=fEdited
					Set sTmp=SQLText
					Call SalModalDialog( dlg_MemoEditor, hW, Title, bTmp, sTmp, bFL_Edit )
					Set fEdited=bTmp
					Set SQLText=sTmp
					Return TRUE
			Function: Sel017o	! __exported
				Description:
				Returns
				Parameters
					Window Handle: hW
					Number: nOper !! операция 0- выдача
							              !!          1 - пролонгация
					Number: nSumDog !! не исп
					Number: nKvDog
					Number: nRnk
					String: sAccA
					String: sAccB
					String: sMfoB
					Number: nNdog
					String: sNazn
					String: sPolu
					String: sNd
					Date/Time: dWida
					String: sKV1
					String: sKV2
					String: sKV3
					Window Handle: pbDisable
					Window Handle: pbRefreshG
				Static Variables
				Local variables
				Actions
					Call Sel017oEx(hW,
							 nOper, nSumDog, nKvDog, nRnk, sAccA, sAccB, sMfoB,
							 nNdog, sNazn  , sPolu , sNd , dWida, sKV1 , sKV2 , sKV3, '', pbDisable, pbRefreshG)
					! Set gOB22 = GetGlobalOption('OB22')
					! Call Ini017()
					! Call Initcc()
					! If not IsWindow(hDocWdog)
						                                                                                              Set hDocWdog = SalCreateWindow(cDocWdog, hW,
								 nOper, nSumDog, nKvDog, nRnk, sAccA, sAccB, sMfoB,
								 nNdog, sNazn  , sPolu , sNd , dWida, sKV1 , sKV2 , sKV3, '', pbDisable, pbRefreshG )
					! Else
						                                                                                              Call SalBringWindowToTop ( cDocWdog )
			Function: Sel017oEx
				Description:
				Returns
				Parameters
					Window Handle: hW
					Number: nOper !! операция 0- выдача
							              !!          1 - пролонгация
					Number: nSumDog !! не исп
					Number: nKvDog
					Number: nRnk
					String: sAccA
					String: sAccB
					String: sMfoB
					Number: nNdog
					String: sNazn
					String: sPolu
					String: sNd
					Date/Time: dWida
					String: sKV1
					String: sKV2
					String: sKV3
					String: D_REC
					Window Handle: pbDisable
					Window Handle: pbRefreshG
				Static Variables
				Local variables
				Actions
					Set gOB22 = GetGlobalOption('OB22')
					Call Ini017()
					Call Initcc()
					If not IsWindow(hDocWdog)
						Set hDocWdog = SalCreateWindow(cDocWdog, hW,
								 nOper, nSumDog, nKvDog, nRnk, sAccA, sAccB, sMfoB,
								 nNdog, sNazn  , sPolu , sNd , dWida, sKV1 , sKV2 , sKV3, D_REC, pbDisable, pbRefreshG )
					Else
						Call SalBringWindowToTop ( cDocWdog )
			Function: Ini017
				Description: инициализация библиотеки
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: strPathToLangResources
					String: strLangId
					String: strFileName
				Actions
					If not bApdInited
						Set strPathToLangResources = GetLangPath()
						Set strLangId = GetLang()
						Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars011.lng"
						If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
							Call CurrentLangTable.Init()
						Call DocWisInit( 'CB_VVOD1' )
						Set bApdInited = TRUE
					Return bApdInited
			Function: F_s080        ! __exported
				Description:
				Returns
				Parameters
					Number: FIN
					Number: OBS
					Receive String: S080
					Receive String: sRISK
				Static Variables
				Local variables
				Actions
					If FIN !=NUMBER_Null and OBS !=NUMBER_Null 
						If SqlPrepareAndExecute( hSql(), 
								  "SELECT c.crisk, c.name  
								   INTO  :S080, :sRISK
								   FROM FIN_OBS_S080 f, crisk c 
								   WHERE f.fin=:FIN and f.obs=:OBS and f.s080=c.crisk" ) 
								and SqlFetchNext( hSql(), nFetchRes )
						! Call Debug(S080)
						! Call Debug(sRISK)
			Function: ShowApdVersion
				Description:
				Returns
				Parameters
					String: sWin
				Static Variables
				Local variables
					String: strText
					Number: nLength
				Actions
					Call SalStrSetBufferLength( strText, 160 )
					Set nLength = SalGetWindowText ( hWndForm, strText, 160 )
					Call SalSetWindowText ( hWndForm, ApdNum||sWin||'.'||ApdVer||' '||SalStrTrimX(strText) )
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 25218691
0000: 37010000A2000000 0000000000000000 0200000200FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F22003C00 000A630047656E46
0040: 696C746500727400 00000400001E0002 0400C10001000000 3F8001F800000037
0060: 040001F00D000000 FF1F110000DC0002 00FF7F1570000000 0100FFFF21018022
0080: 000001C200000B63 47F8444669B30004 00770200F601004F 800100FE008D0400
00A0: 010DFD00FF371100 02F700FFDF15DC00 0100FF7F
.enddata
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton: ctb_pbRefresh
			Radio Button:
			Option Button:
			Check Box: cCheckBoxLabeled
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box:
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control:
		Application Actions
	Form Window: ISG	!! Индивидуальный ручной разбор сч.гашения
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Yes
		Visible? No
		Display Settings
			Display Style? Standard
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.038"
				Top:    0.031"
				Width:  13.933"
				Width Editable? Class Default
				Height: 5.583"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Top
				Visible? Class Default
				Size: 0.75"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Data Field: dND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   8.383"
							Top:    -0.012"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Dark Aqua
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Валюта счета гашения' )
				Data Field: dTxt
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    -0.012"
							Width:  5.9"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Dark Aqua
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Номер и дата КД' )
				Data Field: cOKPO
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.183"
							Top:    -0.012"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Dark Aqua
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Iд.код клiєнта' )
				!
				Data Field: Nls_A
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.183"
							Top:    0.321"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Blue
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Счет гашения' )
				Data Field: Kv
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.183"
							Top:    0.321"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Blue
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Валюта счета гашения' )
				Data Field: Nms_A
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.883"
							Top:    0.321"
							Width:  3.4"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Наименование счета гашения' )
				Data Field: Ost_A
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.983"
							Top:    0.321"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Blue
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Pushbutton: pb_Vypiska
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.183"
						Top:    0.321"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \bars98\RESOURCE\BMP\DOC_TURN.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Переглянути виписку за поточний день'
						On SAM_Click
							If nAcc != NUMBER_Null
								Call ShowTurnForAccount(nAcc, GetBankDateEx())
				Pushbutton: pb_Run
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.683"
						Top:    0.321"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \bars98\RESOURCE\BMP\ARR1TOR.BMP
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Виконати операцію погашення '
						On SAM_Click
							Set Ost_B = tbl2.F_Sum()
							If Nls_A != STRING_Null and Ost_A >= Ost_B
								If SalMessageBox( strTip ,
										'У в а г а! Ви дійсно бажаєте ? ', MB_IconQuestion | MB_YesNo) = IDYES
									If tbl2.F_Opl()
										If SqlCommitEx( hSql(), strTip )
											Set bOpl = TRUE
											Call SalDisableWindow( pb_Run )
											Call SalDisableWindow( tbl2.S )
											Call SalMessageBox( 'Операції погашення прийнято !
													Перегляньте Реф !
													Для продовження потрібно перечитати інф.',
													'У в а г а ! ', MB_OK )
											!
											! Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
										Else
											Call SqlRollback( hSql() )
				Data Field: Ost_B
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.183"
							Top:    0.321"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Red
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Сумма к погашению' )
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.383"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Set bOpl = FALSE
							Call tbl.Nas1()
							Call tbl2.Nas2()
				!
				Pushbutton: pbDetails
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.683"
						Top:    1.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.783"
						Top:    1.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.883"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Pushbutton: pbIns
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.783"
						Top:    1.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: F1
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF1_.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    0.238"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Salmon
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.283"
						Top:    1.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: F2
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF2_.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.783"
						Top:    1.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: F3
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BF3_.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Default
					Message Actions
				Line
					Resource Id: 23030
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  0.917"
						End X:  Class Default
						End Y:  0.5"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.283"
						Top:    1.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 23031
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  0.833"
						End X:  Class Default
						End Y:  0.417"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 23032
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  0.94"
						End X:  Class Default
						End Y:  0.524"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Custom Control: ccSplitter
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    1.655"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    -0.012"
						Width:  13.317"
						Width Editable? Class Default
						Height: 1.667"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Bold
					Text Color: Class Default
					Background Color: System Window Color
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: TIP_A
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Тип
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: String
						Justify: Left
						Width:  0.529"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KV_A
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Вал
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: Number
						Justify: Right
						Width:  0.5"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NLS_A
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Рах.Погашенн
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: String
						Justify: Left
						Width:  1.7"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NMS_A
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Назва рах
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: String
						Justify: Left
						Width:  3.4"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTB_A
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Плановий зал.
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: Number
						Justify: Right
						Width:  1.514"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTC_A
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Фактичний зал.
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: Number
						Justify: Right
						Width:  1.457"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: ACC_A
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ACC
						Visible? No
						Editable? No
						Maximum Data Length: 38
						Data Type: Number
						Justify: Right
						Width:  1.457"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: Nas1
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							String: sSql
						Actions
							Call SalWaitCursor(TRUE)
							Set sSql =
									"SELECT a.acc, a.tip, a.kv,a.nls, a.nms, (a.lim+a.ostb)/100, (a.lim+a.ostc)/100
									 INTO :tbl.ACC_A, :tbl.TIP_A, :tbl.KV_A, :tbl.NLS_A, :tbl.NMS_A, :tbl.OSTB_A, :tbl.OSTC_A
									 FROM accounts a, nd_acc n
									 WHERE n.nd=:nNd and a.tip in ('SG ','ISG','DEP')
									   and a.acc=n.acc and (a.lim+a.ostb)>0 and a.rnk="||sRnk
							Call SalTblPopulate( ISG.tbl, hSql(), sSql, TBL_FillAll )
							Call SalTblSetContext(ISG.tbl, 0)
							Call SalPostMsg(ISG.tbl, SAM_TblDoDetails, 0, 0)
							Call SalWaitCursor(FALSE)
					Function: F_Row1
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Set Nls_A = tbl.NLS_A
							Set Nms_A = tbl.NMS_A
							Set Ost_A = tbl.OSTB_A
							Set Kv = tbl.KV_A
							Set nAcc = tbl.ACC_A
							Set Ost_B = NUMBER_Null
				Window Variables
				Message Actions
					On SAM_Create
						Call tbl.Nas1()
						Call tbl.F_Row1()
						Call tbl2.Nas2()
					On SAM_TblDoDetails
						Call tbl.F_Row1()
						Call tbl2.Nas2()
					On SAM_DoubleClick
						Call tbl.F_Row1()
						Call tbl2.Nas2()
					On SAM_KillFocus
						Set hWndLost=hWndForm
					On SAM_FetchRowDone
						Call SalColorSet ( tbl, COLOR_IndexWindow, nCol1 )
						If tbl.OSTB_A != tbl.OSTC_A and tbl.OSTC_A != 0
							Call XSalTblSetCellBackColor( tbl.OSTB_A, COLOR_Salmon )
							Call XSalTblSetCellBackColor( tbl.OSTC_A, COLOR_LightGreen )
						Else
							Call XSalTblSetCellBackColor( tbl.OSTB_A, nCol1 )
							Call XSalTblSetCellBackColor( tbl.OSTC_A, nCol1 )
			Child Table: tbl2
				Class Child Ref Key: 27
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    1.726"
						Width:  13.35"
						Width Editable? Class Default
						Height: 1.976"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Bold
					Text Color: Class Default
					Background Color: System Window Color
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: TIP_B
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Тип
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: String
						Justify: Left
						Width:  0.529"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: KV_B
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Вал
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: Number
						Justify: Right
						Width:  0.486"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NLS_B
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Рах.Боргу
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: String
						Justify: Left
						Width:  1.714"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NMS_B
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Назва рах
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: String
						Justify: Left
						Width:  3.414"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: FDAT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Факт-дата
								видачи тр.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.1"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_KillFocus
								Call F_Kv()
							On SAM_Validate
								Call F_Kv()
								If S > -OSTC_B
									Call SalMessageBox('Введена сума перебільшує залишок на рахунку!',
											'У в а г а!', 0)
									Return VALIDATE_Cancel
								Return VALIDATE_Ok
					Column: OSTB_B
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Плановий зал.
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: Number
						Justify: Right
						Width:  1.5"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTC_B
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Фактичний зал.
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: Number
						Justify: Right
						Width:  1.443"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Погасити
								суму
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.4"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_KillFocus
								Call F_Kv()
							On SAM_Validate
								Call F_Kv()
								If S = 0
									Return VALIDATE_Ok
								If TIP_B != 'ISG'
									If TIP_B = 'SDI'
										If SqlPrepareAndExecute(hSql(), "select nvl(to_number(f_get_nd_txt(:nNd,'S_SDI',gl.bd)),0) into :nSDI from dual")
												and SqlFetchNext(hSql(), nFetchRes)
										If S > nSDI
											Call SalMessageBox('Введена сума перевищує суму комісії в параметрах договору!',
													'У в а г а!', 0)
											Return VALIDATE_Cancel
									Else
										If S > - OSTB_B
											Call SalMessageBox('Введена сума перевищує пл.залишок на рахунку!', 'У в а г а!', 0)
											Return VALIDATE_Cancel
								! Call DebugN(NPP)
								! Call DebugN(S )
								! Call DebugN(- OSTC_B  )
								If NPP != NUMBER_Null and S > - OSTC_B
									Call SalMessageBox('Введена сума перебільшує залишок траншу !', 'У в а г а!', 0)
									Return VALIDATE_Cancel
								Return VALIDATE_Ok
							On SAM_DoubleClick
								Call SalTblSetContext(hWndForm, lParam )
								If REF = NUMBER_Null
									If Ost_B = NUMBER_Null
										If TIP_B = 'SDI'
											If OSTC_B = 0
												If SqlPrepareAndExecute(hSql(), "select nvl(to_number(f_get_nd_txt(:nNd,'S_SDI',gl.bd)),0) into :nSDI from dual")
														and SqlFetchNext(hSql(), nFetchRes)
												Set S = nSDI
											Else
												Set S = 0
										Else
											Set S = - OSTC_B
									Call SalTblSetRowFlags(hWndForm, lParam, ROW_Edited, TRUE )
									Call Validate()
					Column: NPP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Ид.
								тр.
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.671"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_KillFocus
								Call F_Kv()
							On SAM_Validate
								Call F_Kv()
								If S > -OSTC_B
									Call SalMessageBox('Введена сума перебільшує залишок на рахунку!', 'У в а г а!', 0)
									Return VALIDATE_Cancel
								Return VALIDATE_Ok
					Column: MDATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: План-дата
								погаш. тр.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.1"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_KillFocus
								Call F_Kv()
							On SAM_Validate
								Call F_Kv()
								If S > -OSTC_B
									Call SalMessageBox('Введена сума перебільшує залишок на рахунку!', 'У в а г а!', 0)
									Return VALIDATE_Cancel
								Return VALIDATE_Ok
					Column: NAZN
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Призначення платежу
						Visible? Yes
						Editable? Yes
						Maximum Data Length: 160
						Data Type: String
						Justify: Left
						Width:  5.043"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_DoubleClick
								Set nRow_NAZN = lParam
								Call SalTblSetContext(hWndForm, nRow_NAZN )
								Set sNazn = NAZN
								If SalModalDialog(dlg_MSG, hWndForm, sNazn)
									Call SalTblSetContext(hWndForm, nRow_NAZN )
									Set tbl2.NAZN =  sNazn
					Column: REF
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Реф.
						Visible? Yes
						Editable? No
						Maximum Data Length: 38
						Data Type: Number
						Justify: Right
						Width:  1.443"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_DoubleClick
								Call SalTblSetContext(hWndForm, lParam )
								If REF != NUMBER_Null
									Call DocViewContentsEx( ISG, REF )
					Column: ACC_B
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: ACC
						Visible? No
						Editable? No
						Maximum Data Length: 38
						Data Type: Number
						Justify: Right
						Width:  1.457"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: Nas2
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							String: sSql
							String: sKom
						Actions
							Call SalWaitCursor(TRUE)
							Call SalEnableWindow( S )
							! Счета и транши
							! 21.01.2015 Сухова
									В счета задолженностей добавлена пеня 'SN8'
									Пока без 9 кл - 'SK9', 'SN9'
									http://jira.unity-bars.com.ua:11000/browse/COBUSUPABS-3042
							!
							! Списання комісійних доходів тільки з грн. рахунку
									Списання інш заборгованості - вал договору та грн.
									згідно договірного списання.
							! COBUSUPABS-3517:
							If Kv = n980
								Set sKom = " "
							Else
								Set sKom = " and a.tip not in ('SK0','SK9') "
							Set sSql =
									" SELECT to_date(null),to_date(null),to_number(null),a.tip,a.kv,a.nls,a.nms,a.ostb/100,a.ostc/100
									 INTO :tbl2.MDATE, :tbl2.FDAT, :tbl2.NPP, :tbl2.TIP_B, :tbl2.KV_B,
									 :tbl2.NLS_B, :tbl2.NMS_B, :tbl2.OSTB_B, :tbl2.OSTC_B
									  FROM accounts a, nd_acc n
									  WHERE n.nd="||Str(nNd)||" and a.acc=n.acc
									   and (a.nbs<'4' and a.ostb<0"|| sKom ||" or a.tip in ('ISG','SDI','SN8' ) )
									   and not exists (select 1 from cc_trans where acc=a.acc) and a.rnk="||sRnk||"
									 union all
									  SELECT t.d_plan,t.FDAT,t.NPP,a.tip,a.kv,a.nls,a.nms,a.ostb/100, -(t.sv-t.sz)/100
									  FROM accounts a, nd_acc n, cc_trans t
									  WHERE n.nd="||Str(nNd)||" and a.acc=n.acc and ( a.nbs <'4' and a.ostb<0 )
									   and a.acc=t.acc and t.d_fakt is null and a.rnk="||sRnk||"
									 union all
									  SELECT to_date(null),to_date(null),to_number(null),a.tip,a.kv,a.nls,a.nms,a.ostb/100, (a.ostc/100+ct.ss/100)
									  FROM accounts a, nd_acc n,(select acc,sum(sv-sz) ss from cc_trans where d_fakt is null group by acc) ct
									  WHERE n.nd="||Str(nNd)||" and a.acc=n.acc and exists (select 1 from cc_trans where acc = a.acc)
									  and a.rnk="|| sRnk   ||" and a.acc=ct.acc
									 Order by 4,5,1,2,3 "
							! Call Debug (sKom)
							! Call Debug (sSql)
							Call SalTblPopulate( ISG.tbl2, hSql(), sSql, TBL_FillAll )
							! !
							Call SalTblSetContext(tbl2, nRow )
							Call SalTblSetRowFlags( tbl2, nRow, ROW_New, FALSE )
							Call SalTblSetContext(tbl2, 0)
							Call SalPostMsg(tbl2, SAM_TblDoDetails, 0, 0)
							Call SalWaitCursor(FALSE)
					Function: F_Sum
						Description:
						Returns
							Number:
						Parameters
						Static Variables
						Local variables
							Number: nRow
							Number: nS
							Number: SQ
						Actions
							Set nRow = TBL_MinRow
							Set nS = 0
							While SalTblFindNextRow( tbl2, nRow, 0, 0)
								Call SalTblSetContext(tbl2, nRow)
								Call tbl2.F_Kv()
								If tbl2.KV_B = tbl.KV_A
									Set nS = nS + S
								Else
									Call SqlPrepareAndExecute (hSql(),'select (gl.p_ncurval(:tbl.KV_A,gl.p_icurval(:tbl2.KV_B, (:tbl2.S)*100, gl.bd),gl.bd))/100 into :SQ from dual')
									Call SqlFetchNext(hSql(),nFetchRes)
									Set nS = nS + SQ
							Return nS
					Function: F_Opl
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
							Number: nRow
							Number: nSA
							Number: nSB
							Number: nVob
							Number: nTmp
							Number: nRef
							String: Nazn
							String: sNd
							String: sTt
							String: sNlsB
						Actions
							Set nRow = TBL_MinRow
							While SalTblFindNextRow( tbl2, nRow, 0, 0)
								Call SalTblSetContext(tbl2, nRow)
								If S > 0 and NLS_B != STRING_Null and REF = NUMBER_Null
									If (Kv != n980 and TIP_B != 'SK0' and TIP_B != 'SK0' )
											Or (Kv  = n980)
										Set nSB = S * 100
										! 21.01.2015 Сухова Вынесла оплату 1 -го в пакедж
										If NOT SqlPLSQLCommand( hSql(),"CCK.ISG1( Kv, Nls_A, nSB, KV_B, NLS_B, NAZN, nRef ) ")
											Return FALSE
										If NPP != NUMBER_Null
											If NOT SqlPLSQLCommand( hSql(),"CCT.OTM1 ( NPP,nSB, nRef ) ")
												Return FALSE
										Set REF = nRef
							Return TRUE
					Function: F_Kv
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							If S < 0
								Set S = 0
					Function: Validate
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: SQ
							Number: I_S
						Actions
							Set nRow=TBL_MinRow
							Set I_S=0
							While SalTblFindNextRow( tbl2, nRow, ROW_Edited, 0)
								Call SalTblSetContext( tbl2, nRow )
								If tbl2.KV_B = tbl.KV_A
									Set I_S = I_S+S
								Else
									Call SqlPrepareAndExecute (hSql(),'select (gl.p_ncurval(:tbl.KV_A,gl.p_icurval(:tbl2.KV_B, (:tbl2.S)*100, gl.bd),gl.bd))/100 into :SQ from dual')
									Call SqlFetchNext(hSql(),nFetchRes)
									Set I_S = I_S+SQ
							If not bOpl
								If Nls_A !=STRING_Null and I_S<=Ost_A and I_S!=0
									Call SalEnableWindow( pb_Run )
								Else
									Call SalDisableWindow( pb_Run )
				Window Variables
					String: strSqlPopulate	! Строка SQL SELECT
					String: strSqlInsert	! Строка SQL INSERT
					String: strSqlDelete	! Строка SQL DELETE
					String: strSqlUpdate	! Строка SQL UPDATE
					String: strTitleAux
					String: sTmp
					String: sNazn1
					Number: nRow_NAZN
					Number: nSDI
				Message Actions
					On SAM_KillFocus
						Call tbl2.Validate()
						Set hWndLost=hWndForm
					On SAM_FetchRowDone
						Call SalColorSet ( tbl2, COLOR_IndexWindow, nCol2 )
						If tbl2.OSTB_B != tbl2.OSTC_B and tbl2.OSTC_B !=0
							Call XSalTblSetCellBackColor( tbl2.OSTB_B, COLOR_Salmon )
							Call XSalTblSetCellBackColor( tbl2.OSTC_B, COLOR_LightGreen )
						Else
							Call XSalTblSetCellBackColor( tbl2.OSTB_B, nCol2)
							Call XSalTblSetCellBackColor( tbl2.OSTC_B, nCol2 )
						If tbl2.NAZN = STRING_Null
							If tbl2.NPP != NUMBER_Null
								Set tbl2.NAZN =
										"Погаш.трнш, що видано " || SalFmtFormatDateTime( tbl2.FDAT, "dd.MM.yyyy" ) ||
										" та очiкує пог. "  || SalFmtFormatDateTime( tbl2.MDATE, "dd.MM.yyyy" )
							Else If tbl2.TIP_B = 'SS '
								Set tbl2.NAZN ="Погашення основного боргу "
							Else If tbl2.TIP_B = 'SN '
								Set tbl2.NAZN ="Погашення процентного боргу "
							Else If tbl2.TIP_B = 'SP '
								Set tbl2.NAZN ="Погашення проср.осн.боргу "
							Else If tbl2.TIP_B = 'SPN'
								Set tbl2.NAZN ="Погашення проср.проц.боргу "
							Else If tbl2.TIP_B = 'SL '
								Set tbl2.NAZN ="Погашення сумн.осн.боргу "
							Else If tbl2.TIP_B = 'SLN'
								Set tbl2.NAZN ="Погашення сумн.проц.боргу "
							Else If tbl2.TIP_B = 'SK0'
								Set tbl2.NAZN ="Погашення нарах. комісії "
							Else If tbl2.TIP_B = 'SK9'
								Set tbl2.NAZN ="Погашення проср.нарах.комісії "
							Else If tbl2.TIP_B = 'SN8'
								Set tbl2.NAZN ="Погашення нарах.пені "
							Else If tbl2.TIP_B = 'ISG'
								Set tbl2.NAZN ="Зарахування на доходи майб.періодів "
							Else If tbl2.TIP_B = 'SDI'
								Set tbl2.NAZN ="Перерахування на дисконт "
							! Call SqlPLSQLCommand( hSql(), "cck.cc_isg_nazn( nNd, sNazn1 )" )
							Set tbl2.NAZN = Subs( NAZN || ' зг. КД ' || sTxt, 1, 160)
					On SAM_RowValidate
						Call tbl2.Validate()
		Functions
		Window Parameters
			Number: nMode ! = 7
			Number: nNd  ! Реф КД
			String: sRnk
			String: sTxt
		Window Variables
			Number: nCol1
			Number: nCol2
			Number: n980
			Number: nRow
			String: aMFO
			String: aOKPO
			Date/Time: dDat
			!
			Window Handle: hWndLost
			Number: nTmpE
			String: sTmp
			String: sTmp2
			!
			Number: nAcc
			! Number: nRef
			: cDoc
				Class: cDoc
			!
			String: sOk
			String: sNazn
			Boolean: bOpl
		Message Actions
			On SAM_Create
				Set n980 = GetBaseVal()
				Set dDat = GetBankDate()
				Set aMFO = GetBankMfo()
				Set aOKPO= GetBankOkpoS()
				Set nCol2 = SalColorFromRGB( 255,210,210 ) ! СЛАБО-КРАСНЫЙ
				Set nCol1 = SalColorFromRGB( 220,255,255 ) ! голубой
				Call SqlPLSQLCommand( hSql(), "cck.cc_isg_nazn( nNd, sTxt )" )
				Set dTxt  = sTxt
				Set bOpl = FALSE
				Set dND = nNd
				If SqlPrepareAndExecute(hSql(), "SELECT okpo into :cOKPO from customer where rnk = "|| sRnk )
						and  SqlFetchNext(hSql(), nFetchRes)
				Call SalMapEnterToTab( TRUE )
				Call SalDisableWindow( pb_Run )
				Call PrepareWindowEx( hWndForm )
				Call SalSetWindowText(hWndForm, 'Индивидуальный разбор кредитовых остатков КД ' || Str(nNd) )
				Call ShowApdVersion('05')
				Call SetWindowFullSize( hWndForm )
				Call SalSendClassMessage( SAM_Create, 0, 0 )
	Table Window: KredAcc
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.138"
				Top:    1.083"
				Width:  19.933"
				Width Editable? Class Default
				Height: 6.857"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 20000
			Discardable? No
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.119"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call NASELENIE()
				Pushbutton: pbTabAcc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Details.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = "Таблична форма рах.КД (з редагуванням)"
						On SAM_Click
							Set sTmp =
									" a.acc in (select acc from nd_acc WHERE nd="||Str(N_ND)||" union all
									  select acc from cc_accp WHERE accs in (select acc from nd_acc WHERE nd=" || Str(N_ND) || "))"
							Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_ReadOnly | AVIEW_AllOptions, sTmp )
									
				Pushbutton: pb_Lim8
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbChilds
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F8
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Bf8_.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Встановити залишок на рах консолідації 8999*'
						On SAM_Click
							If SalIsWindowEnabled(pb_Lim9)
								If SqlPLSQLCommand(hSql(), "CCK.cc_START(N_ND) " ) 
									Call SqlCommitEx( hSql(),'Остатки на 89990'||Str(N_ND) )
									Call MessageNoWait('Установлены остатки на счете консолидации','Сообщение',3,0)
									Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
								Else
									Call SqlRollback(hSql())
									Call MessageNoWait('Неуспешное завершение', 'Ошибка', 0, 1)
							!
				Pushbutton: pb_Lim9
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbChilds
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F9
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Bf9_.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Актуализація ліміту КД на вимогу (9129)'
						On SAM_Click
							Call SalWaitCursor(TRUE)
							If SqlPLSQLCommand(hSql(), "CCK.CC_DAY_LIM ( bDat, N_ND ) " )
									and SqlPLSQLCommand(hSql(),"CCK.CC_9129 ( bDat, N_ND, 0 ) " )
								Call SqlCommitEx( hSql(), strTip )
								Call MessageNoWait( strTip,'Сообщение',3,0)
							Else
								Call SqlRollback(hSql())
								Call MessageNoWait('Неуспешно '|| strTip, 'Ошибка', 0, 1)
							Call SalWaitCursor(FALSE)
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Вивести рах(без закрытия) з-під КД'
						On SAM_Click
							If (hWndForm.KredAcc.colAcc = hWndForm.KredAcc.nAccLim) 
								Call SalMessageBox ( 'Вывод счета лимита кредитования из под договора недопустимо!','Error', MB_Ok )
								Return FALSE
							If YES_MOD ( hWndForm.KredAcc.NLS, hWndForm.KredAcc.TIP ) 
								Call SalMessageBox ( "Модульний рахунок" ,'Помилка', MB_Ok )
								Return FALSE
							!
							If not SqlPrepareAndExecute(hSql(),"DELETE FROM nd_acc WHERE nd=:N_ND and acc=:hWndForm.KredAcc.colAcc ") 
									or not SqlPrepareAndExecute(hSql(),"UPDATE accounts SET accc=null WHERE acc=:hWndForm.KredAcc.colAcc and accc=:hWndForm.KredAcc.nAccLim") 
								Call SqlRollback(hSql())
								Return FALSE
							!
							If (hWndForm.KredAcc.TIP = 'SS ' or hWndForm.KredAcc.TIP = 'SP ' or hWndForm.KredAcc.TIP = 'SL ' )
									and not SqlPLSQLCommand(hSql(), "CCK.cc_START(N_ND) " ) 
								Call SqlRollback(hSql())
								Return FALSE
							!
							Call SqlCommitEx( hSql(),'Выведен счет '|| hWndForm.KredAcc.NLS ||' из дог реф='||Str(N_ND) )
							Call SqlPrepareAndExecute( hSql(),"INSERT INTO cc_sob (nd,fdat,txt) VALUES (:hWndForm.KredAcc.N_ND,:hWndForm.KredAcc.bDat,'Выведен счет '|| :hWndForm.KredAcc.NLS ||' ('|| :hWndForm.KredAcc.colKv ||') из дог реф='||:N_ND )" )
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
							Return TRUE
				!
				Data Field: dCC_ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.583"
							Top:    0.071"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Ід. КД' )
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.083"
							Top:    0.405"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата-1(заключення КД) ' )
				Data Field: DAT3
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.483"
							Top:    0.405"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата-3(видачі) ' )
				Data Field: DAT4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.883"
							Top:    0.405"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата-4(завершення) ' )
				!
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Open.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Карточка Рахунку'
						On SAM_Click
							If hWndForm.KredAcc.colAcc != NUMBER_Null
								Call OperWithAccount( ALL_ACCOUNTS, hWndForm.KredAcc.colAcc, 0, ACCESS_FULL )
				Pushbutton: pb_SpecPar
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_spec.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Карточка спец.парметрів рах.'
						On SAM_Click
							If hWndForm.KredAcc.colAcc != NUMBER_Null
								! Функция "Спецпараметры счета"
										ShowAccSpecParams(colAcc,nMode)
										nMode=0(редактировать)/ACCESS_READONLY(просмотр)
								Call ShowAccSpecParams( hWndForm.KredAcc.colAcc,0 )
				Pushbutton: pb_ProcStav
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\A_ints.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Процентна карточка рах'
						On SAM_Click
							If hWndForm.KredAcc.colAcc != NUMBER_Null
								! % ставку на все типы счетов SS-ссудный, SP-прсрочен, SL-безнадежный(сомнительный)
								If sNlsSD='N/A'
									Set sNlsSD = STRING_Null
								If sNlsSD8='N/A'
									Set sNlsSD8 = STRING_Null
								If hWndForm.KredAcc.TIP = 'SS ' 
									! Осн % ставка(0)
									Call SetProcParN( hWndForm.KredAcc.colAcc, hWndForm.KredAcc.colKv, sNlsSN, sNlsSD)
								Else If hWndForm.KredAcc.TIP = 'CR9'
									! Осн % ставка(0)
									If SqlPrepareAndExecute(hSql(), "SELECT acc into :sNlsSNalt from accounts where acc=cc_o_nls(substr(:NLS,1,4),:nRnk,:sSour,:N_ND,:colKv,'CR9')  ")
											and not SqlFetchNext(hSql(), nFetchRes)
									If SqlPrepareAndExecute(hSql(), "SELECT acc into :sNlsSDalt from accounts where acc=cc_o_nls(substr(:NLS,1,4),:nRnk,:sSour,:N_ND,:colKv,'SD ')  ")
											and not SqlFetchNext(hSql(), nFetchRes)
									Call SetProcParN(hWndForm.KredAcc.colAcc, hWndForm.KredAcc.colKv, sNlsSNalt||','||sNlsSN8, sNlsSDalt||','||sNlsSD8)
								Else If hWndForm.KredAcc.TIP = 'SP '
									! Осн % ставка(0) + Пеня (2)
									Call SetProcParN(hWndForm.KredAcc.colAcc, hWndForm.KredAcc.colKv, sNlsSN||','||sNlsSN8, sNlsSD||','||sNlsSD8)
								Else If hWndForm.KredAcc.TIP = 'SPN' or hWndForm.KredAcc.TIP = 'SL ' or hWndForm.KredAcc.TIP = 'SLN'
									! только Пеня (2)
									If CCK_NBU
										Call SetProcParN(hWndForm.KredAcc.colAcc, hWndForm.KredAcc.colKv, ','||sNlsSN9, ','||sNlsSD8)
									Else
										Call SetProcParN(hWndForm.KredAcc.colAcc, hWndForm.KredAcc.colKv, ','||sNlsSN8, ','||sNlsSD8)
								Else If hWndForm.KredAcc.TIP = 'LIM' 
									! только Комиссия (2)
									If SqlPrepareAndExecute( hSql(), "
											declare
											l_int_idn int;
											begin
											select count(id) into l_int_idn from int_idn where id=4;
											if l_int_idn=1 then
											   begin
											    insert into int_accn (ACC,ID,acrb,METR,BASEM,BASEY,FREQ)
											    values("||Str(hWndForm.KredAcc.colAcc)||",4,cc_o_nls(substr("||NLS||",1,4),"||Str(nRnk)||","||sSour||","||Str(N_ND)||","||Str(colKv)||",'SD4'),0,0,0,1);
											   exception when dup_val_on_index then 
											   update int_accn set acrb=cc_o_nls(substr("||NLS||",1,4),"||Str(nRnk)||","||sSour||","||Str(N_ND)||","||Str(colKv)||",'SD4')  where acc="||Str(hWndForm.KredAcc.colAcc)||"  and id=4 and acrb is null;
											   end;
											  end if;
											end; "
											) 
										Call SqlCommit(hSql())
									If SK0 != STRING_Null
										Call SetProcParN(hWndForm.KredAcc.colAcc, hWndForm.KredAcc.colKv, ','||SK0, '' )
				Pushbutton: pb_IRR_Stav
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.683"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_INTS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Cyan
					Message Actions
						On SAM_Create
							Set strTip = 'Розрах ЕПС по КД'
						On SAM_Click
							Call Sel017(hWndMDI,nTip_Ur, 26, N_ND, dCC_ID, sNmk, NUMBER_Null )
				Pushbutton: pb_SGR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbUpdate
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.483"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\UNION.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Індивідуальний Ручний розбір кредит.залишків'
							If NOT (nSOS >=10 and nSOS <15) 
									OR NOT (nTip_Ur = 10 OR nTip_Ur = 0)
								Call SalDisableWindow( pb_SGR )
						On SAM_Click
							Call Sel017(hWndMDI, nTip_Ur, 7, N_NDp, Str(nRnk),
									CC_ID || ' від '|| SalFmtFormatDateTime( DAT1, 'dd/MM/yyyy' ) ,0 )
				Pushbutton: pbWida
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.883"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Dark Aqua
					Background Color: 3D Face Color
					Message Actions
						On SAM_Create
							Set strTip = 
									'Видача кредиту - 
									 створити НОРМАЛЬНИЙ ОСНОВНИЙ борг'
						On SAM_Click
							Call WIDA()
				Pushbutton: pb_Prosr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRelation
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Arr1tor.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Orchid
					Message Actions
						On SAM_Create
							Set strTip =
									'Перенос основного боргу на прострочку -
									 створити ПРОСТРОЧЕННИЙ ОСНОВНИЙ борг'
						On SAM_Click
							Call Prosr()
				Pushbutton: pb_Pog_Nal
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.083"
						Top:    0.071"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Custclsd.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Dark Aqua
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 
									' ! Погашення готівкою - 
									 (для ФО в нац.вал) '
							! Call SalDisableWindow( pb_Pog_Nal )
						On SAM_Click
							If sSG != STRING_Null
								Call Sel025( hWndMDI, 297, N_ND, 'CCK',  sSG )
							Else
								Call SalMessageBox('Не открыт Счет гашения SG! ', "ВНИМАНИЕ ! ", MB_IconStop)
				Pushbutton: pb_Pog_Bnal
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.483"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOC_DOWN.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 
									" Стягнення вибраного боргу (без/гот)" 
						On SAM_Click
							Call Pog_Bnal()
				Pushbutton: pb_Clos
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Delete.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Закрити КД'
						On SAM_Click
							Set sErr = STRING_Null
							If SqlPLSQLCommand(hSql(), "CCK.cc_CLOSE  (N_ND, sErr ) " ) 
								If sErr = STRING_Null
									Set sErr = "Закрыт кредитный договор, реф= "||Str(N_ND)
									Call SqlCommitEx( hSql(), sErr )
									Call MessageNoWait(sErr, 'Сообщение', 3, 0)
								Else
									Call SqlRollback(  hSql() )
									Call MessageError( "Невозможно закрыть договор "||Str(N_ND)||" / "||sErr )
							Else
								Call SqlRollback(hSql())
				!
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.483"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pb_Proc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbEdit
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\A_proc.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 
									'Нарахувати %% та коміс по рах КД -
									створити НОРМАЛЬНИЙ ПРОЦЕНТНИЙ і КОМІСІЙНИЙ борг'
						On SAM_Click
							! Для НБУ вызываем ведомость с параметром "Счета" (наименование счета), для остальных - "Клиенты"
							If CCK_NBU
								Call Sel010(hWndMDI,0, 
										IifN( nTip_Ur=20 or nTip_Ur=0, 0, 1 ),
										" and s.NBS<>'8999' and s.ACC in (select acc from nd_acc where nd="||Str(N_ND)||")" ,
										"S"   )
							Else
								Call Sel010(hWndMDI,0, 
										IifN( nTip_Ur=20 or nTip_Ur=0, 0, 1 ),
										" and s.NBS<>'8999' and s.ACC in (select acc from nd_acc where nd="||Str(N_ND)||")" ,
										" "   )
				Pushbutton: pbIRR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.283"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\A_proc.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Cyan
					Message Actions
						On SAM_Create
							Set strTip = 'Формування визнаних доходів (ЕПС) по КД '|| Str(N_NDp)
						On SAM_Click
							Call BAB_ALL (N_NDp)
				Pushbutton: pb_SG
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.883"
						Top:    0.405"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\SELECT.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip =
									"Розбір надходжень на рах SG по КД "||Str(N_ND)
						On SAM_Click
							If N_ND > 0
								Call SalWaitCursor(TRUE)
								If SqlPLSQLCommand( hSql(), "CCK.CC_ASG( -N_ND, 1 )" )
									Call SqlCommitEx( hSql(), strTip )
									Call SalWaitCursor(FALSE)
									Call MessageNoWait(strTip ,'Сообщение',3,0)
								Else
									Call SqlRollback(hSql())
									Call SalWaitCursor(FALSE)
									Call MessageNoWait('Неуспешный '||strTip, 'Ошибка', 0, 1)
				Pushbutton: pb_Pros_Proc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.683"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\A_proc.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Red
					Background Color: Orchid
					Message Actions
						On SAM_Create
							Set strTip = 
									'Перенос нар.Дох( % и Коміс) на просрочку -
									 створити ПРОСТРОЧЕНИЙ ПРОЦЕНТНИЙ та КОМІСІЙНИЙ борг'
						On SAM_Click
							Call Pros_Proc()
				Pushbutton: pb_DebZap
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.083"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\BACK.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Red
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Сформувати ДЕБ.запит на суму нарах.ПЕНІ'
						On SAM_Click
							Call DEB_Zap()
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.283"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Pushbutton: pbZalog
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.283"
						Top:    0.738"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\A_accs.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Yellow
					Background Color: Gray
					Message Actions
						On SAM_Create
							Set strTip = 'Нові Договора забеспечення'
						On SAM_Click
							If ACCS >0
								Call Sel017(hWndMDI,nTip_Ur, 2, N_ND, sGr, Str(nRnk), ACCS )
							Else
								Call Debug('Не открыт осн.счет')
				Pushbutton: pbZalog_All
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.883"
						Top:    0.738"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Pach.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Gray
					Message Actions
						On SAM_Create
							Set strTip = 'Існуючі Договора забеспечення'
						On SAM_Click
							If ACCS >0
								Call Sel017(hWndMDI,nTip_Ur,11, N_ND, sGr, Str(nRnk), ACCS )
							Else
								Call Debug('Не открыт осн.счет')
				!
				Data Field: NLS_Add
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.483"
							Top:    0.738"
							Width:  2.3"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рах кл для зв`язку з КД' )
						On SAM_AnyEdit
							Set NMS_Add = ''
							If NLS_Add != STRING_Null
								Call SalEnableWindow( pb_Add )
							Else
								Call SalDisableWindow( pb_Add )
				Data Field: KV_Add
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 3
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   6.883"
							Top:    0.738"
							Width:  0.6"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Вал.рах' )
				Data Field: TIP_Add
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 3
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.083"
							Top:    0.738"
							Width:  0.5"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Тип Рахунку' )
				Data Field: BRN_Add
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.783"
							Top:    0.738"
							Width:  2.75"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Бранч Рахунку' )
				Data Field: DZS_Add
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.583"
							Top:    0.738"
							Width:  1.2"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата закриття рах ' )
				Data Field: NMS_Add
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 38
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.883"
							Top:    0.738"
							Width:  3.6"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва Рахунку' )
				Pushbutton: pb_Add
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.483"
						Top:    0.738"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\NEWREC.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Установити зв`язок існуючого рахунку з КД'
							Call SalDisableWindow( pb_Add )
						On SAM_Click
							If ND_ACC (NLS_Add, KV_Add)
								If SqlPrepareAndExecute( hSql(),
										 "insert into nd_acc (nd,acc) values(:N_ND,:ACC_Add)")
										and SqlCommitEx( hSql(), strTip ||': ND='||Str(N_ND)||', Acc='|| Str(ACC_Add)  )
									Call MessageNoWait('Виконано : '|| strTip, 'Повыдомлення', 3, 0)
									Set NLS_Add = STRING_Null
									Set NMS_Add = STRING_Null
									Set KV_Add = NUMBER_Null
									Set ACC_Add = NUMBER_Null
							Else
								Call SqlRollback(hSql())
				! !!!!!!!!!!!!!
				Data Field: N_ND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.783"
							Top:    0.071"
							Width:  1.2"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Реф. КД' )
				Data Field: OSTX
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.983"
							Top:    0.071"
							Width:  1.583"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Maize
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Встановлений Ліміт (МАКС-допустимий залишок)' )
				Data Field: OSTF
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.9"
							Top:    0.071"
							Width:  1.483"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'НЕвикористаний Ліміт (+), ПРОСТРОЧКА (-)' )
				Background Text: +
					Resource Id: 47585
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   14.383"
						Top:    0.095"
						Width:  0.35"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Justify: Center
					Font Name: Default
					Font Size: 14
					Font Enhancement: None
					Text Color: Default
					Background Color: Default
				Data Field: OSTC
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   14.75"
							Top:    0.071"
							Width:  1.617"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Light Green
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Використаний Ліміт (ФАКТИЧ.залишок)' )
				!
				Data Field: sNmk
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.783"
							Top:    0.405"
							Width:  2.75"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Позичальник' )
				Data Field: Branch
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.483"
							Top:    0.738"
							Width:  2.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Бранч КД' )
				Data Field: sVIDD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.9"
							Top:    0.405"
							Width:  1.783"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Вид КД' )
				Data Field: sSOS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   14.75"
							Top:    0.405"
							Width:  1.617"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Стан КД' )
				!
				Background Text: =
					Resource Id: 47586
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   12.483"
						Top:    0.095"
						Width:  0.35"
						Width Editable? Yes
						Height: 0.262"
						Height Editable? Yes
					Visible? Yes
					Justify: Center
					Font Name: Default
					Font Size: 14
					Font Enhancement: None
					Text Color: Default
					Background Color: Default
				!
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 47587
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  12.767"
						Begin Y:  -0.06"
						End X:  12.767"
						End Y:  0.405"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.05"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 47588
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.433"
						Begin Y:  0.06"
						End X:  4.433"
						End Y:  0.524"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 47589
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  1.85"
						Begin Y:  -0.024"
						End X:  1.85"
						End Y:  0.44"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.5"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Pushbutton: pb_Viza2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbExecute
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.083"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\UNDO1.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip =
									 ' Віза № 2 :
									"Передати для авторизації" '
						On SAM_Click
							! Call DOP_MOS (ND, CC_ID, sNMK, 'All')
							If SalMessageBox(
									'Вы действительно хотите выполнить
									'|| strTip || ' ?',
									'В Н И М А Н И Е ! ',
									MB_IconQuestion | MB_YesNo) = IDYES
								If SqlPrepareAndExecute( hSql(),
										"Update cc_deal set sos=4 where nd=:N_ND " )
										and SqlCommitEx( hSql(),'КД.'|| Str(N_ND) || strTip  )
									Call SalDisableWindow( pb_Viza2 )
				Data Field: sVersia
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   16.383"
							Top:    0.071"
							Width:  2.15"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Dark Aqua
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Версія ПЗ' )
		Contents
			Column: TIP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тип
						рах
				Visible? No
				Editable? No
				Maximum Data Length: 3
				Data Type: String
				Justify: Left
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TIPN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тип рах
				Visible? Yes
				Editable? No
				Maximum Data Length: 30
				Data Type: String
				Justify: Left
				Width:  0.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва рах
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 70
				Data Type: String
				Justify: Left
				Width:  1.833"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ISP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вик
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 30
				Data Type: Number
				Justify: Right
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: GRP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Гр
						дост
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 30
				Data Type: Number
				Justify: Right
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Номер рах
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  1.867"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If (hWndForm.KredAcc.colAcc = NUMBER_Null or hWndForm.KredAcc.colAcc = 0) 
								and  hWndForm.KredAcc.TIP ='CRC' and hWndForm.KredAcc.colKv=n980
							If SqlPrepareAndExecute( hSql(),
									"SELECT a.acc, a.nms, a.isp, a.grp, a.nls 
									 INTO :colAcc, :NMS, :ISP, :GRP, :NLS
									 FROM accounts a, cust_acc u
									 WHERE u.rnk=:nRnk and u.acc=a.acc and nbs='8021' 
									   and tip='CRC' and nls like '9%' and kv=:n980" )
									  and not SqlFetchNext(hSql(), nFetchRes)
						Set NLS1 = hWndForm.KredAcc.NLS
					On SAM_Validate
						Call CHK_NLS()
					On SAM_DoubleClick
						If (hWndForm.KredAcc.colAcc = NUMBER_Null or hWndForm.KredAcc.colAcc = 0) and  hWndForm.KredAcc.TIP ='SS '
							Set sTmp=Str(nAim) 
							Call FunNSIGet('CC_AIM','NAME', sTmp, hWndForm.KredAcc.NMS)
							If sTmp != Str(nAim) 
								If SqlPrepareAndExecute(hSql(), "delete from nd_txt where nd=:N_ND  and tag='CC_AE' ")  and 
										SqlPrepareAndExecute(hSql(), " insert into nd_txt (nd,tag,txt)  values (:N_ND,'CC_AE',:sTmp)")
									Call SqlCommit(hSql())
								Else
									Call MessageErrorEx('Невозможно изменить цель!')
									Call SqlRollback(hSql())
									Return FALSE
								Call NBS_AIM(Val(sTmp))
								Set hWndForm.KredAcc.NLS = 
										KeyAccount(sBankMfo, sNbs_Aim || '0' || Subs(hWndForm.KredAcc.NLS,6,9))
			Column: colKv
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
						
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 3
				Data Type: Number
				Justify: Center
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						If NOT ( Subs(NLS,1,1) = '3' or nVidd=3 or nVidd=13 )
							Set colKv = nKvD
			Column: OB22
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Пар.
						OB22
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 2
				Data Type: String
				Justify: Center
				Width:  0.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If NOT 
								( OB22 != STRING_Null or TIP='LIM' or TIP='SD8' or TIP='SN8' or NLS='N/A' )
							If SqlPrepareAndExecute( hSql(),
									"SELECT min(OB22) INTO :OB22 FROM SB_OB22 
									 WHERE d_close is null and r020='"|| Subs(NLS,1,4) ||"'"  )
									and not SqlFetchNext(hSql(), nFetchRes)
					On SAM_Validate
						If OB22 != STRING_Null
							If SqlPrepareAndExecute( hSql(),
									"SELECT 1 FROM SB_OB22 WHERE d_close is null and r020='"|| Subs(NLS,1,4) ||"'"  ) 
									and not SqlFetchNext(hSql(), nFetchRes)
								Call SalMessageBox("Недопустимы пар.ОБ22","Ошибка", MB_IconExclamation)
								Return VALIDATE_Cancel
						Return VALIDATE_Ok
					On SAM_DoubleClick
						If NOT ( TIP='LIM' or TIP='SD8' or TIP='SN8' or NLS='N/A' )
							Set sTmp=OB22 
							Call FunNSIGetFiltered 
									("SB_OB22",
									 "TXT", 
									 "r020='"|| Subs(NLS,1,4) ||"'" ,
									 sTmp,
									 sErrTxt )
							If sTmp != OB22 and sTmp != STRING_Null
								Set OB22 = sTmp 
								If colFlOp = 1
									Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE )
			Column: colS080
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кат
						Риска
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 1
				Data Type: Number
				Justify: Center
				Width:  0.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colFlOp
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Відкр
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						If colFlOp = 1
							If TIP='ODB' and YES_MOD( NLS, TIP)
								Set colFlOp = 0 
								Call SalMessageBox ( '"Модульний" рахунок' ,'Помилка', MB_Ok )
							If Subs(NLS,1,2) != '20' and 
									   Subs(NLS,1,2) != '22' and 
									   Subs(NLS,1,1) != '3'  and
									   Subs(NLS,1,1) != '8'  and
									   Subs(NLS,1,1) != '9' 
								Set colFlOp = 0 
								Call SalMessageBox ( 'НЕдозволение бал.рах' ,'Помилка', MB_Ok )
			Column: colRat
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: %
						ставка
				Visible? Yes
				Editable? No
				Maximum Data Length: 5
				Data Type: Number
				Justify: Right
				Width:  0.7"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: Basey
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: %
						база
				Visible? Yes
				Editable? No
				Maximum Data Length: 5
				Data Type: Number
				Justify: Left
				Width:  0.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colAcc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC
				Visible? No
				Editable? Yes
				Maximum Data Length: 6
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colMDate
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						погашення
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.083"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colPRT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Пріор.
						погаш
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  0.783"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If hWndForm.KredAcc.TIP ='SS ' or
								hWndForm.KredAcc.TIP ='SP '  or
								hWndForm.KredAcc.TIP ='SPN'  or
								hWndForm.KredAcc.TIP ='SK0'  or
								hWndForm.KredAcc.TIP ='SK9'  or
								hWndForm.KredAcc.TIP ='SL '  or
								hWndForm.KredAcc.TIP ='SLN'  or
								hWndForm.KredAcc.TIP ='S9N'  or
								hWndForm.KredAcc.TIP ='S9K' 
						Else
							Set hWndForm.KredAcc.colPRT = STRING_Null
						Return VALIDATE_Ok
			Column: colOstc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Залишок
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDos
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Обороти
						Дебет
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.167"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colKos
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Обороти
						Кредит
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.15"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDapp
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						руху
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.067"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colDaos
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						відкриття
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.083"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colOrd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Порядок
						сортування
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colZDate
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						закр..
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.083"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colOstB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Залишок
						планов
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: NASELENIE
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set Fl_SS = FALSE
					If SqlPrepareAndExecute(hSql(), "
							SELECT -ostx/100, -ostc/100, (ostc-ostx)/100          
							INTO :OSTX, :OSTC, :OSTF
							FROM accounts WHERE acc=:nAccLim ") 
							and SqlFetchNext(hSql(), nFetchRes)
						If OSTF < 0 
							Call SalColorSet( OSTF, COLOR_IndexWindow, COLOR_Salmon )
						Else
							Call SalColorSet( OSTF, COLOR_IndexWindow, COLOR_Sky )
					!
					Call SalWaitCursor(TRUE)
					Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
					Set sSG = STRING_Null
					Call SalTblPopulate( hWndForm, hSql(), hWndForm.KredAcc.strSqlPopulate, TBL_FillAll )
					Call SalTblSetContext( hWndForm, 0)
					Call SalPostMsg( hWndForm, SAM_TblDoDetails, 0, 0)
					Call SalWaitCursor(FALSE)
			Function: WIDA 
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: AccKred
					String: MfoKred
					String: sTmp_TT
					Date/Time: dfDAT2
					Date/Time: dfDAT3
					Number: nSum1
					Number: nSum
					Number: nBlk
					!
					Long String: sNaznL
					Long String: sDop
					String: sTag
					! String: sPawnId		! Id застави sPawnName
					! String: sPawnName
					! Number: nNd
					Number: i
				Actions
					! Выдача только с SS-ссудный
					Set nSum1 = SalNumberMax( 0, OSTF)*100
					If hWndForm.KredAcc.TIP ='SS ' and hWndForm.KredAcc.colFlOp = 1 and hWndForm.KredAcc.colZDate = DATETIME_Null
						If hWndForm.KredAcc.colKv != nKvD 
							If SqlPrepareAndExecute( hSql(),
									  "SELECT gl.p_Ncurval(:hWndForm.KredAcc.colKv, gl.p_Icurval(:hWndForm.KredAcc.nKvD,:nSum1,BANKDATE), BANKDATE) /100 
									   INTO :nSum FROM dual")
									and SqlFetchNext( hSql(), nFetchRes)
								Set nSum = SalNumberRound( nSum-0.5 ) 
						Else
							Set nSum = nSum1/100
						!
						If SqlPrepareAndExecute( hSql(),
								  "SELECT acckred, mfokred, bdate, wdate
								   INTO :AccKred, :MfoKred, :dfDAT2, :dfDAT3
								   FROM cc_add where nd=:N_ND and adds=0 " )
								and SqlFetchNext( hSql(), nFetchRes)
						If MfoKred = STRING_Null and not CCK_NBU
							Set MfoKred = GetBankMfo()
						If MfoKred = GetBankMfo()
							If AccKred = STRING_Null 
									OR (SqlPrepareAndExecute( hSql(),
									   "SELECT 1 FROM accounts WHERE dazs is null and kv=:hWndForm.KredAcc.colKv and nls=:AccKred " )
									    and NOT SqlFetchNext( hSql(), nFetchRes)
									   )
								If SqlPrepareAndExecute( hSql(),
										  "SELECT nls INTO :AccKred  FROM accounts 
										   WHERE rnk=:nRnk and dazs is null and kv=:hWndForm.KredAcc.colKv 
										     and nls like '26%' and substr(nls,4,1) <'5' 
										   ORDER BY nbs,acc" )
										and SqlFetchNext( hSql(), nFetchRes)
						Else If MfoKred != STRING_Null
							If SqlPrepareAndExecute( hSql(),
									" select nvl(blk,0) into :nBlk from banks where mfo = :MfoKred and nvl(blk,0)<>4 ")
									and NOT SqlFetchNext( hSql(), nFetchRes)
								Call SalMessageBox( "Недіючий код МФО " || MfoKred, "Помилка ! ", MB_IconExclamation ) 
								Return FALSE
							If AccKred != STRING_Null and AccKred != KeyAccount( MfoKred, AccKred)
								Call SalMessageBox( "Невірний контр.розряд рахунку " || AccKred, "Помилка ! ", MB_IconExclamation ) 
								Return FALSE
						If Subs(AccKred,1,2)='10' and MfoKred=GetBankMfo()
							Set sTmp_TT='KK3'
							Set sNazn = 'Видача коштів готівкою згідно кредитного договору № ' || CC_ID ||
									' від ' || SalFmtFormatDateTime( DAT1, 'dd/MM/yyyy' )
						Else
							If MfoKred != GetBankMfo()
								Set sTmp_TT='KK2'
							Else
								Set sTmp_TT='KK1'
								Set sNazn = 'Перерахування коштів згідно кредитного договору № ' || CC_ID ||
										' від ' || SalFmtFormatDateTime( DAT1, 'dd/MM/yyyy' )
						!
						Set D_REC = ''
						If CCK_NBU
							! Set nNd = N_ND
							! ! NaznL = 160 (oper.nazn) + 200 (operw.value)
							Set sTmp_TT='KK2'
							If SqlPrepareAndExecute(hSql(), 
									"select nd into :i  from nd_txt n, cc_pawn p
									  where n.nd = :N_ND and tag='ZAY0P' and txt = to_char(p.pawn)
									      and p.code='DCP'") and SqlFetchNext(hSql(), nFetchRes)
								If not F_DCP(N_ND, GetBankMfo(), MfoKred, AccKred, sOKPOB, nSum1)
									Return FALSE
							Call SqlSetLongBindDatatype(2, 22)
							If SqlPrepareAndExecute(hSql(), 
									  "SELECT substr(MBK.F_GetNazn('CCK',:N_ND),1,360) 
									   INTO :sNaznL FROM dual" )
									and SqlFetchNext(hSql(), nFetchRes)
									and sNaznL != ''
								Set sNazn= sNaznL
						!
						Call Sel017oEx (hWndForm,
								 0, nSum, hWndForm.KredAcc.colKv, nRnk, hWndForm.KredAcc.NLS, AccKred, MfoKred,
								 N_ND, sNazn, sNmk, Subs(CC_ID,1,10), dfDAT3, sTmp_TT, 'KK2', 'KK3', D_REC,
								 pbWida, pbRefresh)
					Return TRUE
			Function: Pog_Bnal
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If hWndForm.KredAcc.colFlOp = 1 and hWndForm.KredAcc.colOstB < 0 and
							  (hWndForm.KredAcc.TIP ='SS ' or hWndForm.KredAcc.TIP ='SP ' or 
							   hWndForm.KredAcc.TIP ='SL ' or hWndForm.KredAcc.TIP ='SN ' or 
							   hWndForm.KredAcc.TIP ='SPN' or hWndForm.KredAcc.TIP ='SLN') 
						If SqlPrepareAndExecute( hSqlAux(), 
								  "SELECT nls into :NLS2 FROM accounts  where dazs is null and rnk=:nRnk 
								     and nbs in ( '2600','2650') and kv=:colKv ORDER BY ostb " )
								and not SqlFetchNext(hSqlAux(), nFetchRes) 
							Call SalMessageBox(
									"Не найден ни один счет клиента "||Str(colKv)||"/2600*(2650*)",
									 'Взыскание невозможно ! ', MB_IconStop)
							Return FALSE
						! !!!!!!!!!!!!!!!
						Set sNazn = 
								'Погашення боргу згідно угоди № ' || CC_ID ||
								' від ' || SalFmtFormatDateTime( DAT1, 'dd/MM/yyyy' )
						Call Sel017o (hWndForm, 2, hWndForm.KredAcc.colOstB, hWndForm.KredAcc.colKv, 
								 nRnk, hWndForm.KredAcc.NLS, NLS2, sBankMfo,
								 N_ND, sNazn, hWndForm.KredAcc.NMS, Str(N_ND), GetBankDate(), 'KK1', 'KK1' ,'KK1' , 
								 pb_Pog_Bnal, pbRefresh  )
			Function: DEB_Zap
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: AccKred
					String: MfoKred
					String: LCV
					Number: nEqv
					Number: nNom
					String: sTmp_TT
					Date/Time: dfDAT2
					! Date/Time: dfDAT3
				Actions
					! Выдача только с SS-ссудный
					If hWndForm.KredAcc.TIP ='SN8' and hWndForm.KredAcc.colFlOp = 1 and hWndForm.KredAcc.colOstc != 0 
						Set nNom = hWndForm.KredAcc.colOstc * 100
						If SqlPrepareAndExecute( hSql(),
								  "SELECT a.acckred, a.mfokred, t.lcv, gl.p_icurval(t.kv, :nNom, :bDat ) 
								   INTO :AccKred, :MfoKred, :LCV , :nEqv
								   FROM cc_add a, tabval t where a.nd=:N_ND and a.adds=0 and t.kv=:hWndForm.KredAcc.colKv " )
								and SqlFetchNext( hSql(), nFetchRes)
						If MfoKred = STRING_Null
							Set MfoKred = GetBankMfo()
						Set sTmp_TT='KK4'
						Set sNazn = 
								"Заборгованість по пені згідно КД № " || CC_ID ||
								' від ' || SalFmtFormatDateTime( DAT1, 'dd/MM/yyyy' ) ||
								" станом на  " || SalFmtFormatDateTime( bDat, 'dd/MM/yyyy' )   || 
								" становить "  || SalNumberToStrX( hWndForm.KredAcc.colOstc, 2  ) || "/" || LCV || 
								IifS(hWndForm.KredAcc.colKv = n980,'',", в еквіваленті " || SalNumberToStrX(nEqv/100,2) )
						Call Sel017o (hWndForm,
								 0, nEqv/100,  n980 , nRnk, STRING_Null, AccKred, MfoKred,
								 N_ND, sNazn, sNmk, Subs(CC_ID,1,10), bDat, sTmp_TT, 'KK4', 'KK4',
								 pbWida, pbRefresh  )
			Function: Pros_Proc
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If (hWndForm.KredAcc.TIP ='SN ' or hWndForm.KredAcc.TIP ='SK0' ) and 
							hWndForm.KredAcc.colFlOp = 1 and hWndForm.KredAcc.colOstc !=0
						If SqlPrepareAndExecute( hSqlAux(), 
								  "SELECT a.nls, a.acc into :NLS2, :nAcc2 
								   from accounts a, nd_acc n 
								   where a.tip=decode(:hWndForm.KredAcc.TIP,'SN ', 'SPN', 'SK9' ) 
								     and a.acc=n.acc and n.nd=:N_ND and a.kv=:hWndForm.KredAcc.colKv and 
								         substr(a.nls,1,3) = substr(:hWndForm.KredAcc.NLS,1,3) " )
								and not SqlFetchNext(hSqlAux(), nFetchRes)
							Call SalMessageBox("Нет счета для просроч." ||
									                    IifS(hWndForm.KredAcc.TIP='SPN','процентов SPN','комисии SK9'),
									 "Ошибка ! ", MB_IconStop)
						Else
							! Спецпараметры
							If SqlPrepareAndExecute( hSqlAux(), "SELECT acc FROM specparam WHERE acc=:nAcc2 " )
									and not SqlFetchNext(hSqlAux(), nFetchRes)
								Call SqlPrepareAndExecute( hSql(),
										   "INSERT INTO specparam (ACC,R011,R013,S080, S180,S181,S190,S200,S230,S240,D020,S120)
										    select :nAcc2,R011,R013,S080, S180,S181,S190,S200,S230,S240,D020,S120
										    from specparam where acc=:hWndForm.KredAcc.colAcc ")
							!
							Set sNazn = 'Перенесення на прострочку нарахованих ' || 
									IifS( hWndForm.KredAcc.TIP ='SN ','відсотків', 'комісій' ) || 
									' згідно угоди № ' || CC_ID ||
									' від ' || SalFmtFormatDateTime( DAT1, 'dd/MM/yyyy' )
							Call Sel017o (hWndForm,
									 0, NUMBER_Null, hWndForm.KredAcc.colKv, 0, NLS2, hWndForm.KredAcc.NLS, GetBankMfo(),
									 N_ND, sNazn, sNmk, Str(N_ND), GetBankDate(), 'KK1', 'KK1' ,'KK1' , 
									 pb_Pros_Proc, pbRefresh )
			Function: Prosr
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: nSum_SS
					Number: nSum_LIM
					Number: nSum_SP
					Number: nSum
				Actions
					! SP-Просрочка только с SS-ссудный
					If hWndForm.KredAcc.TIP ='SS ' and 
							   hWndForm.KredAcc.colFlOp = 1 and 
							   hWndForm.KredAcc.colOstc !=0
						If SqlPrepareAndExecute( hSqlAux(), 
								  "SELECT a.nls, a.acc, ostb into :NLS2, :nAcc2, :nSum_SP
								   from accounts a, nd_acc n 
								   where a.tip='SP ' and a.acc=n.acc and n.nd=:N_ND and a.kv=:hWndForm.KredAcc.colKv and substr(a.nls,1,3) = substr(:NLS,1,3) 
								        and a.dazs is null" )
								and not SqlFetchNext(hSqlAux(), nFetchRes)
							Call SalMessageBox("Нет счета для просрочки осн.долга SP" , "Ошибка ! ", MB_IconStop)
							Return FALSE
						!
						! Спецпараметры
						If SqlPrepareAndExecute( hSqlAux(),"SELECT acc FROM specparam WHERE acc=:nAcc2 " )
								and not SqlFetchNext(hSqlAux(), nFetchRes)
							Call SqlPrepareAndExecute( hSql(),
									   "INSERT INTO specparam (ACC,R011,R013,S080, S180,S181,S190,S200,S230,S240,D020,S120)
									    select :nAcc2,R011,R013,S080, S180,S181,S190,S200,S230,S240,D020,S120
									    from specparam where acc=:hWndForm.KredAcc.colAcc ")
						! залоги
						If SqlPrepareAndExecute( hSql(), "DELETE FROM cc_accp where accs=:nAcc2 ")
								and SqlPrepareAndExecute( hSql(),  
								   "INSERT INTO cc_accp (ACC,ND,ACCS) SELECT ACC,ND,:nAcc2 from cc_accp where accs=:hWndForm.KredAcc.colAcc ")
								and SqlCommit( hSql() )
						! определение суммі для выноса на просрочку - пока тоько для НБУ
						Set nSum = NUMBER_Null
						If CCK_NBU
							If SqlPrepareAndExecute( hSqlAux(),
									  "SELECT (lim.ostx-lim.ostb), ss.ostb 
									   into :nSum_LIM, :nSum_SS 
									   from accounts lim, accounts ss 
									   where lim.acc= :nAccLim  
									     and ss.acc=:hWndForm.KredAcc.colAcc" )
									and not SqlFetchNext(hSqlAux(), nFetchRes)
								Return FALSE
							Set nSum= SalNumberMin ( SalNumberMax( 0, nSum_LIM + nSum_SP ), -nSum_SS )/100
						Set sNazn = 'Перенесення на прострочку основного боргу угоди № ' || CC_ID ||
								' від ' || SalFmtFormatDateTime( DAT1, 'dd/MM/yyyy' )
						Call Sel017o (hWndForm,
								 1, nSum, hWndForm.KredAcc.colKv, 0, NLS2, hWndForm.KredAcc.NLS, GetBankMfo(),
								 N_ND, sNazn, sNmk, Str(N_ND), GetBankDate(), 'KK1', 'KK1', 'KK1',
								 pb_Prosr, pbRefresh  )
			Function: NBS_AIM
				Description: Получение Ьал сч от цели
				Returns
				Parameters
					Number: nAi
				Static Variables
				Local variables
					String: sSqlAim
				Actions
					! определение БС для SS
					Set sSqlAim = 'SELECT '
					If nSrok      < 12 and nCusttype <= 2 ! короткий ЮЛ
						Set sSqlAim = sSqlAim || 'nbs'
					Else If nSrok > 11 and nCusttype <= 2 ! длиный   ЮЛ
						Set sSqlAim = sSqlAim || 'nbs2'
					Else If nSrok < 12 and nCusttype = 3 ! короткий ФЛ
						Set sSqlAim = sSqlAim || 'nbsf'
					Else If nSrok > 11 and nCusttype = 3 ! длиный   ФЛ
						Set sSqlAim = sSqlAim || 'nbsf2'
					Set sSqlAim = sSqlAim || ' INTO :sNbs_Aim FROM cc_aim WHERE aim='||Str(nAi)  
					If SqlPrepareAndExecute( hSqlAux(), sSqlAim ) and not SqlFetchNext( hSqlAux(), nFetchRes)
						Set sNbs =  '9999'
			!
			Function: F_IRR
				Description:
				Returns
					Boolean:
				Parameters
					Number: nMod
					String: strTip
					Date/Time: Dat_IRR
				Static Variables
				Local variables
					! Number: nRow
					Number: nRet
					String: sRet
					String: sTT 
					String: sSQL
				Actions
					Set sRet = strTip ||
							SalFmtFormatDateTime( Dat_IRR, 'dd/MM/yyyy') || ', КД='|| Str(N_ND)
					! Код оп. sTT из гл.параметров, по умолч = 'IRR'
					If SqlPrepareAndExecute( hSql(),"SELECT val into :sTT from params where par='CC_IRR' ")
							and NOT SqlFetchNext(hSql(), nFetchRes)
						Set sTT = 'IRR'
					! Код ТТ есть ли в TTS ?
					If SqlPrepareAndExecute( hSql(),"SELECT 1 into :nRet from TTS where TT=:sTT ")
							and NOT SqlFetchNext(hSql(), nFetchRes)
						Call MessageNoWait("ОШ ! Не найдена операция "||sTT || " в каталоге операций TTS" , 'Ошибка', 0, 1)
						Return FALSE
					! !!!!
					Call SalWaitCursor(TRUE)
					If nMod = 1 ! Угегулирование нач.% по методу эф.ставки по одному КД
						! Set sSQL = "CC_Rmany (N_ND,Dat_,3) "
						Set sSQL= IifS(CCK_NBU,"cc_irr_nbu(N_ND, Dat_IRR,dVdat,n_Vob )","cc_rmany (N_ND, Dat_IRR, 3)")  
						! Call Debug('6. Дата валют.  ' || SalFmtFormatDateTime(dVdat, 'DDMMYYYY' ))
						Set nRet = 1
						! Set sSQL = "CCK.cc_IRR( sTT, N_ND, Dat_, nRet ) "
					Else If nMod = 2 ! Выравнивание факт.бал.стоимости до плановой при досрочном гашении
						Set sSQL = "CCK.cc_IRR1(sTT, N_ND, Dat_IRR, NUMBER_Null, nRet ) "
					! ! 
					If SqlPLSQLCommand(hSql(), sSQL  )
						If nRet = 1
							Call SqlCommit( hSql())
							Call SalWaitCursor(FALSE)
							Call MessageNoWait( sRet,'Сообщение',0.1,0)
							Return TRUE
						! !!!
					Call SqlRollback(hSql())
					Call SalWaitCursor(FALSE)
					Call MessageNoWait('ОШ ! '|| sRet , 'Ошибка', 0, 1)
					Return FALSE
					!
			Function: F_DCP
				Description:
				Returns
					Boolean:
				Parameters
					Number: mND
					!
					String: MfoA
					String: MfoB
					String: NlsB
					String: OkpoB
					Number: SumB
				Static Variables
				Local variables
					Number: ID
					String: MDOA
					String: MDOB
					String: OZN_SP
					String: Id_Ug
					String: Dat_Ug
				Actions
					If SqlPrepareAndExecute( hSql(),
							"SELECT id, mdoa, mdob, ozn_sp, id_ug, to_char(dat_ug,'YYYYMMDD')  
							        INTO  :ID, :MDOA, :MDOB, :OZN_SP, :Id_Ug, :Dat_Ug
							      FROM dcp_p
							  WHERE (ref =:mND AND ref<0 ) OR
							       (mfoa=:MfoA AND
							        mfob=:MfoB AND nlsb=:NlsB AND okpob=:OkpoB AND s=:SumB AND ref is null)
							 FOR UPDATE OF ref NOWAIT " )
							and not SqlFetchNext( hSql(), nFetchRes)
						Call SalMessageBox("Не найдена информация-подтверждение из Депозитария !" ,
								"В Н И М А Н И Е ! ", MB_IconStop)
						Return FALSE
					Else
						If not SqlPrepareAndExecute(hSql(), "UPDATE dcp_p Set ref=-:mND, acc=:colAcc WHERE id=:ID")
							Call SqlRollback(hSql())
							Return FALSE
					Set D_REC =  '#d' || MDOA || MDOB || Id_Ug || Dat_Ug || OZN_SP || '#'
					Return TRUE
			Function: YES_MOD
				Description:
				Returns
					Boolean:
				Parameters
					String: p_NLS
					String: p_TIP
				Static Variables
				Local variables
					String: B2
					String: B4
				Actions
					Set B4 = Subs( p_NLS,1,4)
					Set B2 = Subs( p_NLS,1,2)
					If B2 ='20' 
							or B2 ='22' 
							OR B4='3579' and p_TIP = 'SK9' 
							OR B4='3578' and p_TIP = 'SK0' 
							OR B4='9129' and p_TIP = 'CR9' 
						Return TRUE
					Else
						Return FALSE
			Function: ND_ACC
				Description:
				Returns
					Boolean:
				Parameters
					String: p_NLS
					Number: p_KV
				Static Variables
				Local variables
					String: B2
					Number: Rn
					String: SNot 
					Number: Yes
				Actions
					Set SNot = STRING_Null
					If SqlPrepareAndExecute( hSql(),
							"select a.dazs,a.Branch,a.Rnk,a.tip,Substr(a.nbs,1,2),a.acc, 
							(select 1 from nd_acc where acc = a.acc and nd = :N_ND)
							 into :DZS_Add, :BRN_Add, :Rn, :TIP_Add, :B2, :ACC_Add , :Yes 
							 from accounts a 
							 where a.nls = :p_NLS and a.kv = :p_KV " ) 
					!
					If not SqlFetchNext(hSql(), nFetchRes)
						Set SNot = "Рахунок НЕ існує"
					Else If Yes = 1
						Set SNot = "Рахуонк вже зв`язано з цим же КД " ||Str(N_ND)
					Else If DZS_Add != DATETIME_Null
						Set SNot = "Рахуонк Закритий"
					Else If Rn != nRnk 
						Set SNot = "Рахунок Іншого РНК"
					Else If (B2 = '22' or B2='20' or TIP_Add ='SK0' or TIP_Add ='SK9' or TIP_Add ='CR9') 
						Set SNot = 'Рахунк "Модульний"'
					Else If SalStrLength( Branch ) >= SalStrLength(BRN_Add)  and Branch != BRN_Add
						Set SNot = "Рахунок з чужого бранчу "
					!
					If SNot != STRING_Null
						Call SalMessageBox ( SNot ,'Помилка', MB_Ok )
						Return FALSE
					Return TRUE
			Function: CHK_NLS
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					If NLS != STRING_Null
						Set NLS = KeyAccount(sBankMfo, hWndForm.KredAcc.NLS )
						If not SalIsValidInteger(hWndItem)
							Call SalMessageBox("НЕцифра в номері рах.", "Помилка", MB_IconExclamation)
							Set NLS = STRING_Null
							Call SalDisableWindow( pb_Add )
						Else If SqlPrepareAndExecute( hSql(),
								"SELECT acc, nms, isp, grp , tip 
								 INTO :hWndForm.KredAcc.colAcc, :hWndForm.KredAcc.NMS, :hWndForm.KredAcc.ISP, 
								      :hWndForm.KredAcc.GRP   , :hWndForm.KredAcc.TIP
								 from accounts where nls= :hWndForm.KredAcc.NLS and kv=:hWndForm.KredAcc.colKv" )
								and SqlFetchNext(hSql(), nFetchRes)
							Call SalMessageBox("Такий рахунок уже відкрито !", "Помилка", MB_IconExclamation)
							Set NLS = STRING_Null
							Call SalDisableWindow( pb_Add )
					Return TRUE
			Function: BAB_ALL
				Description:
				Returns
					Boolean:
				Parameters
					Number: nNd
				Static Variables
				Local variables
					String: sNd
					String: sFdat1
				Actions
					Set sNd =  Str(nNd)
					Set sFdat1 = 
							"MDAT=to_date(pul.get_mas_ini_val('sFdat1'),'dd.mm.yyyy') "||
							"and ND="||sNd 
					!
					If SqlPLSQLCommand( hSql(), "PUL.Set_Mas_Ini( 'MODE_', sNd , 'Режим начисления' )" )
					If SalMessageBox( 
							"Переформувати IRR1:Пiдсумковий Протокол по КД "||sNd ||" ?",
							"Увага: один КД "|| sNd  ,
							 MB_IconQuestion | MB_YesNo) = IDYES
						Call FunNSIEditFFiltered(
								"PRVN_BV_DETAILS[NSIFUNCTION]" ||
								"[PROC=>PRVN_FLOW.BAB_ALL("||sNd ||",0,:D)]"||
								"[PAR=>:D(SEM=Звітна_дата,TYPE=D)]"||
								"[EXEC=>BEFORE]", 2, sFdat1 )
					Else
						Call FunNSIEditFFiltered(
								"PRVN_BV_DETAILS[NSIFUNCTION][PROC=>PUL_DAT(:D,STRING_Null)][PAR=>:D(SEM=Звітна_дата,TYPE=S)][EXEC=>BEFORE]",2,sFdat1 )
					!
					Return TRUE
		Window Parameters
			Number: nTip_Ur
			Number: N_NDp !! реф КД--
			String: CC_ID !! Ид  КД
			String: sGr   !! Группа доступа
		Window Variables
			Number: ACC_Add
			Date/Time: Dat_IRR
			Number: ACC_KOL
			Number: ACCS
			String: sErr
			String: CC_KOM_
			Number: nSOS
			String: NLS1
			String: CC_NSMEP
			String: sSG
			String: sNd
			String: sNmk1
			Number: nGrp
			Number: nIsp
			String: sErrTxt
			String: sNlsSS
			String: sNlsSN
			String: sNlsSD
			String: sNlsSNalt
			String: sNlsSDalt
			String: sNlsSN8
			String: sNlsSN9
			String: sNlsSD8
			String: sNbs
			String: NBS5
			String: NBS6
			String: NBS7
			String: NBS8
			String: NBS9
			String: NBS0
			String: sNbs_Aim
			Number: nAcc
			Number: nId
			Date/Time: bDat
			Number: nPap
			! Для таблицы INT_RATES
			Number: nIr_C
			Number: nIr_D
			! Для таблицы INT_ACC
			Number: nMetr
			Number: nBaseM
			Number: nBaseY
			Number: nFreq
			Boolean: bRat
			Number: nRow
			!
			Number: nRnk
			! Number: nFetchRes
			Number: nTmp
			String: sTmp
			Number: mMetr[*]
			Number: mBaseY[*]
			Number: mBaseM[*]
			Number: mFreq[*]
			!
			String: sFnls
			String: sSour
			Number: nKvD
			String: sBankMfo
			Date/Time: mdate
			Number: nAim
			Number: nCusttype
			Number: nSrok
			Number: nAccLim
			Number: nVidd
			String: sUNION
			!
			Number: FIN
			Number: OBS
			String: S080
			String: sRISK
			!
			String: sNazn
			String: NLS2
			! String: sSqlAim
			String: sSql_NLS
			Number: nAcc2
			Number: n980
			Date/Time: DAT2
			String: SK0
			String: sSql_SD
			Number: nSos_A 
			Number: accF9 ! Для вкл и откл клавиши F9
			Boolean: CCK_NBU
			Boolean: Fl_SS
			String: D_REC
			String: sOKPOB
			String: Day_ZO
			Date/Time: dTmp
			Number: n_Vob
			Date/Time: dVdat
			! String: sErr20
		Message Actions
			On SAM_Create
				Set CCK_NBU = GetGlobalOption('CCK_NBU') = '1'
				! Set sErr20 = 'Заборона ручного вводу/виводу 
						рах.BV=20**(22**) та CR9, SK0, SK9 в КП ! '
				!
				Call SalDisableWindow( pb_Viza2 )
				If nTip_Ur  = 10
					! Кредитчик 
					If SqlPrepareAndExecute( hSql(),"SELECT val from params where par='CC_KRED' and val='1' " )
							and not SqlFetchNext(hSql(), nFetchRes)
						Call SalDisableWindow( hWndForm.KredAcc.NMS )
						Call SalDisableWindow( hWndForm.KredAcc.ISP )
						Call SalDisableWindow( hWndForm.KredAcc.GRP )
						Call SalDisableWindow( hWndForm.KredAcc.NLS )
						Call SalDisableWindow( hWndForm.KredAcc.colKv )
						Call SalDisableWindow( hWndForm.KredAcc.colFlOp )
						!
				Else If nTip_Ur  = 20
					! Бухгалтер
					Call SalDisableWindow( hWndForm.KredAcc.colS080 )
					Call SalDisableWindow( hWndForm.KredAcc.colMDate )
					Call SalDisableWindow( hWndForm.KredAcc.colPRT )
					Call SalDisableWindow( pb_Clos )
				Else If nTip_Ur  >= 80
					Call SalDisableWindow( hWndForm.KredAcc.NMS )
					Call SalDisableWindow( hWndForm.KredAcc.ISP )
					Call SalDisableWindow( hWndForm.KredAcc.GRP )
					Call SalDisableWindow( hWndForm.KredAcc.NLS )
					Call SalDisableWindow( hWndForm.KredAcc.colKv )
					Call SalDisableWindow( hWndForm.KredAcc.colFlOp )
					Call SalDisableWindow( hWndForm.KredAcc.colS080 )
					Call SalDisableWindow( hWndForm.KredAcc.colMDate )
					Call SalDisableWindow( hWndForm.KredAcc.colPRT )
					Call SalDisableWindow( pb_Lim9 )
					Call SalDisableWindow( pbDel )
					Call SalDisableWindow( pbUpdate )
					Call SalDisableWindow( pbWida )
					Call SalDisableWindow( pb_SG )
					Call SalDisableWindow( pb_Prosr )
					Call SalDisableWindow( pb_Pros_Proc )
					Call SalDisableWindow( pb_Pog_Nal )
					Call SalDisableWindow( pb_DebZap )
					Call SalDisableWindow( pb_Pog_Bnal )
					Call SalDisableWindow( pb_Add )
					Call SalDisableWindow( NLS_Add )
					Call SalDisableWindow( KV_Add )
					Call SalDisableWindow( pb_Proc)
					Call SalDisableWindow( pbIRR )
					Call SalDisableWindow( pb_Clos )
				If SqlPrepareAndExecute(hSql(), "SELECT val into :CC_KOM_ from params where par='CC_KOM'")
						and not SqlFetchNext(hSql(), nFetchRes)
					Set CC_KOM_ = '92'
				If SqlPrepareAndExecute( hSql(),"SELECT val from params where par='CC_9031' and val='1' " )
						and not SqlFetchNext(hSql(), nFetchRes)
				If SqlPrepareAndExecute( hSql(),"SELECT val from params where par='CC_AADD' and val='1' " )
						and not SqlFetchNext(hSql(), nFetchRes)
					Call SalHideWindow( NLS_Add )
					Call SalHideWindow( NMS_Add )
					Call SalHideWindow( KV_Add )
					Call SalHideWindow( pb_Add )
				Set hWndForm.KredAcc.strPrintFileName = 'DNLS'
				Set hWndForm.KredAcc.nTabInstance = 1
				Set bDat = GetBankDate()
				Set n980 = GetBaseVal()
				Set sBankMfo = GetBankMfo()
				!
				Set ACCS = 0
				Set N_ND =N_NDp
				Set dCC_ID = CC_ID
				!
				If SqlPrepareAndExecute(hSql(), 
						  "SELECT d.rnk, a.sour, a.kv, d.wdate, a.aim, substr(c.nmk,1,38), 
						     v.custtype, months_between(d.wdate, a.bdate), d.vidd, l.acc, c.CRISK, 
						     d.OBS, d.SOS, v.name,s.name,  a.wdate, substr(pul.Get_Mas_Ini_Val('CC_NSMEP'),1,1),
						     d.sdate, d.wdate, c.okpo , d.branch 
						   INTO :nRnk, :sSour,:nKvD,:mdate,:nAim, :sNmk, :nCusttype, :nSrok, :nVidd,:nAccLim, 
						     :FIN, :OBS, :nSOS, :sVIDD, :sSOS, :DAT3, :CC_NSMEP, :DAT1,:DAT4  , :sOKPOB, :Branch  
						   FROM cc_deal d, cc_add a,  customer c, cc_lim l, CC_VIDD v, cc_sos s
						   WHERE s.sos=d.sos AND v.VIDD=d.vidd AND d.rnk=c.rnk AND a.nd=d.nd and a.adds=0 and 
						         d.nd=:N_ND and l.nd=:N_ND") 
						and NOT SqlFetchNext(hSql(), nFetchRes)
					Call SalMessageBox('Не найден договор №' ||Str(N_ND), 'Ошибка', MB_IconExclamation)
					Call SalDestroyWindow(hWndForm)
					Return FALSE
				!
				If OSTF < 0 
					Call SalColorSet( OSTF, COLOR_IndexWindow, COLOR_Salmon )
				Else
					Call SalColorSet( OSTF, COLOR_IndexWindow, COLOR_Sky )
				If nSOS < 10 or nSOS > 14 or DAT3 > GetBankDate() or nTip_Ur  = 10
					Call SalDisableWindow( pbWida )
					Call SalDisableWindow( pb_Pros_Proc )
					Call SalDisableWindow( pb_DebZap )
					Call SalDisableWindow( pb_Pog_Nal ) 
					Call SalDisableWindow( pb_Pog_Bnal ) 
					Call SalDisableWindow( pb_Prosr )
					! Call SalDisableWindow( pb_Clos )
				If nKvD != n980 or nVidd <10
					Call SalDisableWindow( pb_Pog_Nal )
				If nVidd <10 
				If nSOS < 10 or nSOS > 14 or DAT3 > GetBankDate()
					Call SalDisableWindow( pb_Clos )
				Call F_s080 ( FIN, OBS, S080, sRISK)
				Call NBS_AIM(nAim)
				!
				Set sFnls = 'N/A'
				Set sFnls = "'" || sFnls || "'"
				If Subs(GetGlobalOption('KD_NMS'),1,1)='1' 
					Set sNmk1 = Subs(Subs(GetGlobalOption('KD_NMS'),2,10) ||' '|| sNmk,1,38)
				Else
					Set sNmk1 = Subs(CC_ID||' '|| sNmk,1,38)
				Set nGrp=Val(sGr)
				Set nIsp=GetUserId()
				Set sNd = Str(N_ND)
				Set sUNION =
						"SELECT ord, TIP, name,'N/A',0,0,0,0,0,0,null,null,0,Null,0,0,null,null, null,null,Null,Null FROM tips WHERE " 
				If nVidd=3 or nVidd=13 or nVidd=2 or nVidd=12 
					Set sUNION = sUNION || " 
							(TIP not in (SELECT a.tip FROM accounts a,nd_acc n WHERE a.acc=n.acc and n.nd="||sNd ||" )
							  or TIP in ('SS ','SL ','SP ','SN ','SG ','SPN', 'SG ' ) )
							 and TIP in ( SELECT tip FROM vidd_tip WHERE vidd="|| Str (nVidd) || " )"
				Else
					Set sUNION = sUNION || 
							" tip not in (SELECT a.tip FROM accounts a,nd_acc n WHERE a.acc=n.acc and n.nd=" || sNd || ") 
							  and tip in (SELECT   tip FROM vidd_tip  WHERE vidd=" || Str(nVidd) || ")"
				Set hWndForm.KredAcc.strSqlPopulate =
						 "SELECT t.ord, t.tip, t.name, a.nls, a.kv, 1, a.acc, a.ostc/100, a.dos/100, 
						         a.kos/100, a.dapp, a.daos,  acrN.fprocN(a.acc,0), a.nms, a.isp,
						         a.grp, to_number(s.s080), a.mdate, a.dazs,a.nlsalt, a.ostB/100,a.OB22 
						  INTO :hWndForm.KredAcc.colOrd,:hWndForm.KredAcc.TIP,    :hWndForm.KredAcc.TIPN,
						       :hWndForm.KredAcc.NLS,   :hWndForm.KredAcc.colKv,  :hWndForm.KredAcc.colFlOp, 
						       :hWndForm.KredAcc.colAcc,:hWndForm.KredAcc.colOstc,:hWndForm.KredAcc.colDos, 
						       :hWndForm.KredAcc.colKos,:hWndForm.KredAcc.colDapp,:hWndForm.KredAcc.colDaos, 
						       :hWndForm.KredAcc.colRat,:hWndForm.KredAcc.NMS,    :hWndForm.KredAcc.ISP,  
						       :hWndForm.KredAcc.GRP,   :hWndForm.KredAcc.colS080,:hWndForm.KredAcc.colMDate,
						       :hWndForm.KredAcc.colZDate,:hWndForm.KredAcc.colPRT,:hWndForm.KredAcc.colOstB,
						       :hWndForm.KredAcc.OB22 
						    FROM accounts a, nd_acc n, tips t, specparam s 
						    WHERE n.nd="|| sNd ||" and a.acc=n.acc and a.tip=t.tip and a.acc=s.acc (+) 
						    UNION ALL " || sUNION || "   
						    UNION ALL SELECT 99, 'ODB','Новий рахунок 3*','N/A',0,0,0,0,0,0,null,null,0,null,0,0, 
						       null,null,null,null,Null,Null FROM dual 
						  ORDER BY 1,4 "
				Set hWndForm.KredAcc.strSqlDelete = "DELETE FROM nd_acc WHERE nd="|| sNd ||" and acc=:hWndForm.KredAcc.colAcc"
				Call SalSetWindowText(hWndForm,'Счета по КД '|| CC_ID || ' Реф КД ' || sNd|| ' ' || sNmk )
				Set sVersia = '10.01.2017'
				Call ShowApdVersion(sVersia)
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				If gOB22 = '1'
					Call SalShowWindow( OB22 )
				Else
					Call SalHideWindow( OB22 )
				If SqlPrepareAndExecute( hSql(),
						"SELECT max(sos) INTO :nSos_A FROM cc_sos where sos<10 ")
						and SqlFetchNext(hSql(), nFetchRes)
					If nSos_A != 4
						Call SalHideWindow( pb_Viza2 )
				! Call Debug(gOB22)
				Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Call SalWaitCursor(FALSE)
			On UM_Update
				Set nRow = TBL_MinRow
				While SalTblFindNextRow(hWndForm, nRow,  ROW_New | ROW_Edited, 0)
					Call SalTblSetContext(hWndForm, nRow)
					If colFlOp = 1
						If SqlPLSQLCommand(hSql(), "CCK.cc_op_nls (N_ND,colKv,NLS,TIP||colPRT,ISP,GRP,Str(colS080),colMDate, nAcc )" ) 
								and  SqlPrepareAndExecute( hSql(),"Update accounts set tobo = :Branch where acc = :nAcc ")
							Set colAcc = nAcc 
							If NOT ( OB22 = STRING_Null or TIP='LIM' or TIP='SD8' or TIP='SN8'  )
								If SqlPLSQLCommand( hSql(),"Accreg.setAccountSParam(colAcc, 'OB22', OB22)")
							Call SqlCommit( hSql() )
						Else
							Call SqlRollback(hSql())
							Break
						If TIP='SS '
							Set sNlsSS = NLS 
				Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
			On SAM_TblDoDetails
				If hWndForm.KredAcc.colFlOp
					Call SalEnableWindow(pbDetails)
				Else
					Call SalDisableWindow(pbDetails)
			On SAM_FetchRowDone
				If ACCS = 0 and colFlOp =1 and ( TIP ='SS ' or  TIP ='SL ' or  TIP ='SP ')  
					Set ACCS = hWndForm.KredAcc.colAcc
				If NMS = STRING_Null
					Set hWndForm.KredAcc.NMS = sNmk1
				If TIP = 'SD ' or TIP = 'SD8'
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray ) ! серый
				If ISP = 0
					Set ISP = nIsp
				If GRP = 0
					Set GRP = nGrp 
				! подбор БС: от цели, срока и типа кл
				If TIP = 'SS '
					Set sNbs = SalStrLeftX(NLS, 4)
					If sNbs = 'N/A' or sNbs = ''
						Set sNbs =  sNbs_Aim
					If CCK_NBU=1
						If sNbs = '1410' or  sNbs = '1411'  or sNbs = '1412' or  sNbs = '1414' or  sNbs = '1415'
							Set NBS6 = Subs( sNbs, 1,3)||'3'
						Else
							Set NBS6 = Subs( sNbs, 1,3)||'5'
						Set NBS5 = Subs( sNbs, 1,3)||'6'
					Else
						! Set NBS5 = Subs( sNbs, 1,3)||'5'
						Set NBS5 = Subs( sNbs, 1,3)||'6'
						Set NBS6 = Subs( sNbs, 1,3)||'6'
					! Set NBS7 = Subs( sNbs, 1,3)||'7'
					Set NBS7 = Subs( sNbs, 1,3)||'3'
					Set NBS8 = Subs( sNbs, 1,3)||'8'
					! Set NBS9 = Subs( sNbs, 1,3)||'9'
					Set NBS9 = Subs( sNbs, 1,3)||'8'
					Set NBS0 = Subs( sNbs, 1,2)||'9'|| Subs( sNbs, 3,1)
				!
				If TIP = 'SD '
					Set sNlsSD = NLS
				Else If TIP = 'SK0'
					Set SK0 = NLS
				Else If TIP = 'SN '
					Set sNlsSN = NLS
				Else If TIP = 'SD8'
					Set sNlsSD8 = NLS
				Else If TIP = 'SN8'
					Set sNlsSN8 = NLS
				Else If TIP = 'SN9'
					Set sNlsSN9 = NLS
				Else If TIP = 'SG ' and colFlOp != 0
					Set sSG = hWndForm.KredAcc.NLS
				If NLS = 'N/A'
					If TIP = 'ODB' 
						Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Yellow ) ! желтый
					Set sTmp = STRING_Null
					If SqlPrepareAndExecute(hSqlAux(),
							"SELECT BARS.F_NEWNLS(:nAccLim, :TIP, decode(:TIP,
							 'SPI',:NBS5,
							 'SDI',:NBS6, 
							 'SP ',:NBS7,
							 'SN ',:NBS8,
							 'SPN',:NBS9, 
							 'SS ',:sNbs_Aim, 
							 'SL ',:NBS7, 
							 'SLN',:NBS9, 
							 'ODB', '3578', null ) ) 
							INTO :sTmp from NLSMASK where maskid=:TIP ") and not SqlFetchNext(hSqlAux(), nFetchRes)
						If nHaveTOBO != 2 OR gOB22='1'
							Set sSql_SD = "SELECT BARS.cc_f_nls(:sNbs_Aim,:nRnk,:sSour,:N_ND,:nKvD,:TIP ) INTO :sTmp FROM dual"
						Else
							Set sSql_SD = "SELECT decode(:nKvD,980,g67,v67)  INTO :sTmp FROM proc_dr 
									 WHERE nbs=:sNbs_Aim and sour=:sSour and nvl(rezid,0)=0 "
						If SqlPrepareAndExecute ( hSqlAux(), sSql_SD  ) and SqlFetchNext(hSqlAux(), nFetchRes) 
					If SalStrLeftX(sTmp, 2) = '99'
						Set hWndForm.KredAcc.NLS = '????0' || SalStrMidX(sTmp, 5, SalStrLength(sTmp)-5)
					Else
						Set NLS = sTmp
					If colFlOp = 0
						If TIP = 'SD ' or TIP = 'SD8' or  TIP = 'SN8' or TIP = 'CRD'
							Set colKv =  n980
						Else
							If nVidd != 3 and nVidd != 13 
								Set colKv = nKvD
				Call SalTblSetCellTextColor( colOstc, IifN( colOstc <0, COLOR_Red, COLOR_Blue), TRUE)
				Set colOstc = SalNumberAbs(colOstc)
				If colZDate != DATETIME_Null
					Call SetTblRowColor( hWndForm, COLOR_Periwinkle )
					Set hWndForm.KredAcc.colFlOp = 0
				If colRat != NUMBER_Null and colRat > 0 
						and SqlPrepareAndExecute( hSqlAux(),"SELECT basey INTO :Basey from int_accn where acc=:colAcc" ) 
						and SqlFetchNext( hSqlAux(), nFetchRes)
				Else
					Set colRat = NUMBER_Null
				If ( TIP = 'SK0' or TIP = 'SK9') and CC_KOM_ ='91'
					Set colKv = n980
				If TIP = 'SS ' and colFlOp =1
					Set Fl_SS = TRUE
			On UM_Populate
				Call NASELENIE()
				If Fl_SS and nSOS =2 and ( nTip_Ur  = 20 or nTip_Ur  = 0 )
					Call SalEnableWindow( pb_Viza2 )
				Else
					Call SalDisableWindow( pb_Viza2 )
	Dialog Box: dlg_MSG
		Class:
		Property Template:
		Class DLL Name:
		Title: Призначення платежу
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  9.117"
				Width Editable? Yes
				Height: 3.0"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Frame
				Resource Id: 19535
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.086"
					Top:    0.052"
					Width:  8.7"
					Width Editable? Yes
					Height: 1.76"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Frame
				Resource Id: 19536
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.086"
					Top:    1.875"
					Width:  7.257"
					Width Editable? Yes
					Height: 0.688"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			! cFieldLabel: tbgSave	!Сохранить сделку с назначением
				                                                                                                                                                                                                                                      Message Actions
			Multiline Field: mlTxt
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 160
					String Type: String
					Editable? Yes
				Display Settings
					Border? Yes
					Word Wrap? Yes
					Vertical Scroll? Yes
					Window Location and Size
						Left:   0.2"
						Top:    0.531"
						Width:  8.383"
						Width Editable? Yes
						Height: 1.2"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Message Actions
					On SAM_Validate
						Set mlTxt = SalStrTrimX( mlTxt )
						If SalStrLength( mlTxt ) < 3
							Call SalMessageBox(
									"Призначення платежу менше 3-х знаків неможливе !",
									 "Помилка !",
									MB_IconStop)
							Set mlTxt = sNazn
							Return VALIDATE_Cancel
						Else
							Return VALIDATE_Ok
			Pushbutton: pbOk	! Сохранить
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Сохранить
				Window Location and Size
					Left:   4.8"
					Top:    1.99"
					Width:  1.2"
					Width Editable? Class Default
					Height: 0.448"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set sNazn = mlTxt
						Call SalEndDialog( hWndForm, TRUE )
			Pushbutton: pbClose	! Отменить
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Отменить
				Window Location and Size
					Left:   6.0"
					Top:    1.99"
					Width:  1.2"
					Width Editable? Class Default
					Height: 0.448"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( hWndForm, FALSE )
		Functions
		Window Parameters
			Receive String: sNazn
		Window Variables
		Message Actions
			On SAM_Create
				Call SalCenterWindow( hWndForm )
				Call SetWindowFont( hWndForm )
				! Присваиваем значения многоязыковым объектам
				! Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
				!
				! Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('dlg_MSG.cTWndTitle')  )
				!
				Set mlTxt = sNazn
				Call SalSetFocus( pbOk )
	Form Window: CCK1
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.45"
				Top:    0.542"
				Width:  12.083"
				Width Editable? Yes
				Height: 6.833"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Data Field: nS1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.183"
						Top:    1.155"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Dark Red
					Background Color: Cyan
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сума ОСТАТОЧНОГО платежу')
					On SAM_SetFocus
						Set rb1 = TRUE
						Set nS_OLD = nS1
						Call F_SumPr(nS1)
						Call SalMapEnterToTab( TRUE )
					On SAM_Validate
						Call f_Tochka (hWndItem)
						Call F_SumPr(nS1)
						If nS1 > nS_OLD
							If SalMessageBox(
									'Введена Сума платежу перевищує ЗАГАЛЬНИЙ кінцевий борг !
									 Відмовитись від цієї суми = '|| SalNumberToStrX( nS1, 2 ) || ' ? ',
									 'Можлива переплата  !',
									MB_IconQuestion | MB_YesNo) = IDYES
								Set nS1 = nS_OLD
								Call SalSetFocus( nS1 )
								Return VALIDATE_Cancel
						Return VALIDATE_Ok
					On SAM_KillFocus
						Call f_Tochka (hWndItem)
						Call F_SumPr(nS1)
						If nS1 > nS_OLD
							If SalMessageBox(
									'Введена Сума платежу перевищує ЗАГАЛЬНИЙ кінцевий борг !
									 Відмовитись від цієї суми = '|| SalNumberToStrX( nS1, 2 ) || ' ? ',
									 'Можлива переплата  !',
									MB_IconQuestion | MB_YesNo) = IDYES
								Set nS1 = nS_OLD
								Call SalSetFocus( nS1 )
								Return FALSE 
						Return TRUE
			!
			Background Text: Сплата боргу за користування позикою згідно кредитної угоди
				Resource Id: 52594
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.133"
					Top:    0.095"
					Width:  10.65"
					Width Editable? Yes
					Height: 0.286"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: 12
				Font Enhancement: Bold-Underline
				Text Color: Default
				Background Color: Default
			Data Field: TXT_END
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.25"
						Top:    0.345"
						Width:  8.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pb_F6
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbRefresh
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.683"
					Top:    0.821"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: F6
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: White
				Message Actions
					On SAM_Create
						Set strTip = 'F6. Новий '
					On SAM_Click
						Call F_NULL()
			Pushbutton: pb_Exit
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.683"
					Top:    1.155"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Esc
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Default
				Message Actions
					On SAM_Create
						Set strTip = 'ESC. Завершити  '
					On SAM_Click
						Call SalDestroyWindow(hWndForm)
			!
			!
			Background Text: № Угоди
				Resource Id: 52595
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   1.133"
					Top:    0.655"
					Width:  2.05"
					Width Editable? Yes
					Height: 0.179"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Midnight Blue
				Background Color: Default
			Data Field: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.183"
						Top:    0.821"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '№ Угоди')
					On SAM_Validate
						Set CC_ID = SalStrTrimX( CC_ID )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Дата Угоди
				Resource Id: 52596
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.2"
					Top:    0.655"
					Width:  2.05"
					Width Editable? Yes
					Height: 0.179"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Midnight Blue
				Background Color: Default
			Data Field: DAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.183"
						Top:    0.821"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата Угоди')
					On SAM_Validate
						If DAT1 != DATETIME_Null and DAT1 >= GetBankDate()
							Call SalMessageBox("Дата начала КД должна быть МЕНЬШЕ текущей банковской",
									"Ошибка ! ", MB_IconStop)
							Set DAT1 = DATETIME_Null
						Return VALIDATE_Ok
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Pushbutton: pb_F1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbHelp
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.183"
					Top:    0.821"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: F1
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'F1. Пошук угоди в БД '
					On SAM_Click
						Call F_DISA ()
						If CC_ID != STRING_Null and DAT1 != DATETIME_Null
							Call SalDisableWindow( nSP )
							Call SalHideWindow( cb_SN8 )
							Set cb_SN8 = 0
							Set KV = NUMBER_Null 
							! !!!!!!!!!!  В другом МФО - искать через запрос
							If nHaveTOBO = 2 AND NOT 
									(SqlPrepareAndExecute( hSql(),"SELECT 1 from cc_deal where CC_ID=:CC_ID and SDATE=:DAT1 ")
									  and SqlFetchNext( hSql(), nFetchRes )
									)
								If NOT f_Oleg() 
									Call SalSetFocus( CC_ID )
							! !!!!!!!!!! В своем МФО - берем прямо
							Else
								If SqlPLSQLCommand( hSql(), "CCK.GET_INFO 
										(CC_ID, DAT1,  nRet_, sRet_, nRnk,
										  nS_100, nS1_100, NMK, OKPO, sADRES, KV, LCV, NAMEV, sUNIT, sGENDER, 
										  nSS_100, dSS1, nSS1_100, dSN, nSN_100, nSN1_100, dSK, nSK_100, nSK1_100, KV_KOM,    
										  dSP, nSP_100, SN8_NLS, SD8_NLS, MFOK_, NLSK_ )" ) 
									Set nS  = nS_100 
									Set nS1 = nS1_100
									Set nSS = nSS_100
									Set nSS1=nSS1_100
									Set nSN = nSN_100
									Set nSN1=nSN1_100
									Set nSK = nSK_100
									Set nSK1=nSK1_100
									Set nSP = nSP_100
									!
									! Set nS  = nS_100 /100
									! Set nS1 = nS1_100/100
									! Set nSS = nSS_100/100
									! Set nSS1=nSS1_100/100
									! Set nSN = nSN_100/100
									! Set nSN1=nSN1_100/100
									! Set nSK = nSK_100/100
									! Set nSK1=nSK1_100/100
									! Set nSP = nSP_100/100
									!
									If NMK != STRING_Null
										Call F_VALUTA( KV )
										If KV=KV_KOM or KV_KOM = NUMBER_Null
											Call SalHideWindow( TXT_KOM )
										Else
											Call SalShowWindow( TXT_KOM )
										If nSP > 0
											Call SalEnableWindow( nSP )
											Call SalShowWindow( cb_SN8 )
											Set cb_SN8 = 1
										! Договор истек
										If dSS1 <= dSS
											Call SalShowWindow( TXT_END )
											Set nSS=nSS1
											Set nSN=nSN1
											Set nSK=nSK1
											Set nS = nS1
										Else
											Call SalHideWindow( TXT_END )
										!
										Call SalSetFocus( nS )
										Call SalEnableWindow( pb_F10 )
									Else
										Call SalMessageBox(
												'Угоду № '|| CC_ID ||
												' з датою заключення ' ||
												SalFmtFormatDateTime( DAT1, 'dd/MM/yyyy' ) ||
												' не знайдено серед діючих ',
												"Помилки в заданих параметрах пошуку ! ", MB_IconStop)
										! Call SalMessageBeep( MB_IconAsterisk )
										Call SalSetFocus( CC_ID )
			Data Field: nSKP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.683"
						Top:    0.821"
						Width:  0.5"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Dark Red
					Background Color: Sky
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Символ Кас.Плана')
					On SAM_Validate
						If nSKP > 39
							Return VALIDATE_Cancel
						Return VALIDATE_Ok
			Pushbutton: pb_F10
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.283"
					Top:    0.821"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: F10
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\Execute.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Sky
				Message Actions
					On SAM_Create
						Set strTip = 'F10. Ввести '
					On SAM_Click
						If SalMessageBox(
								'Виконати 
								'|| IifS (rb1, 'О С Т А Т О Ч Н И Й ','П О Т О Ч Н И Й ') || '
								разрахунок ? ',
								 'УВАГА !',
								MB_IconQuestion | MB_YesNo) = IDYES
							If f_Opl(sErr)
								Call SqlCommit(hSql())
								If nSP > 0 
										AND cb_SN8 = 1 
										AND SalMessageBox(
										'Сплатити штраф-пеню в розмірі '|| SalNumberToStrX( nSP, 2 )||' ?',
										 'УВАГА !',
										MB_IconQuestion | MB_YesNo) = IDYES
									If f_Opl_SN8()
										Call SqlCommit(hSql())
								Call F_DISA1()
								Call SalSendMsg( pb_F5, SAM_Click, 0, 0 )
							Else
								Call SqlRollback(hSql())
								! Set sErr = "6) Доп рекв для больших сумм "
								Call SalMessageBox(sErr,"Помилка при сплаті основної суми ! ", MB_IconStop)
			Pushbutton: pb_F5
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbPrint
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.783"
					Top:    0.821"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: F5
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Sky
				Message Actions
					On SAM_Create
						Set strTip = 'F5. Надрукувати '
					On SAM_Click
						Set cDoc.m_nRef = REF
						Call cDoc.pDoc()
						If REF8 > 0
							Set cDoc.m_nRef = REF8
							Call cDoc.pDoc()
						Call SalWaitCursor(FALSE)
			!
			Background Text: Сума платежу
				Resource Id: 52597
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   7.083"
					Top:    0.679"
					Width:  2.05"
					Width Editable? Yes
					Height: 0.179"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
			Radio Button: rb
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Поточний
				Window Location and Size
					Left:   9.183"
					Top:    0.821"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.321"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Sky
				Message Actions
					On SAM_Click
						If rb
							Call SalSetFocus( nS )
			Radio Button: rb1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Остаточний
				Window Location and Size
					Left:   9.183"
					Top:    1.155"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.321"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Cyan
				Message Actions
					On SAM_Click
						If rb1
							Call SalSetFocus( nS1 )
			Data Field: nS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.183"
						Top:    0.821"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Dark Red
					Background Color: Sky
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сума ПОТОЧНОГО платежу')
					On SAM_SetFocus
						Set rb = TRUE
						Set nS_OLD = nS
						Call F_SumPr(nS)
						! Call SalMapEnterToTab( TRUE )
					On SAM_Validate
						Call f_Tochka (hWndItem)
						Call F_SumPr(nS)
						If nS > nS1
							If SalMessageBox(
									'Введена Сума платежу перевищує ЗАГАЛЬНИЙ кінцевий борг !
									 Відмовитись від цієї суми = '|| SalNumberToStrX( nS, 2 ) || ' ? ',
									 'Можлива переплата  !',
									MB_IconQuestion | MB_YesNo) = IDYES
								Set nS = nS_OLD
								Call SalSetFocus( nS )
								Return VALIDATE_Cancel
						Return VALIDATE_Ok
					On SAM_KillFocus
						Call f_Tochka (hWndItem)
						Call F_SumPr(nS)
						If nS > nS1
							If SalMessageBox(
									'Введена Сума платежу перевищує ЗАГАЛЬНИЙ кінцевий борг !
									 Відмовитись від цієї суми = '|| SalNumberToStrX( nS, 2 ) || ' ? ',
									 'Можлива переплата  !',
									MB_IconQuestion | MB_YesNo) = IDYES
								Set nS = nS_OLD
								Call SalSetFocus( nS )
								Return FALSE
						Return TRUE
			Data Field: nPUSTO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.183"
						Top:    0.821"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Dark Red
					Background Color: Sky
					Input Mask: Unformatted
				Message Actions
			!
			Data Field: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.183"
						Top:    1.155"
						Width:  4.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Позичальник')
			Data Field: OKPO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.183"
						Top:    1.155"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Ідентиф.код')
			!
			! Data Field: ND
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.183"
						Top:    1.488"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Jade
					Background Color: White
					Input Mask: Unformatted
.end
				                                                                                                                                                                                                                           Message Actions 
					                                                                                                                                                                                                                           On SAM_TooltipSetText
						                                                                                                                                                                                                                           Return XSalTooltipSetText( lParam, 'Реф.КД')
			Data Field: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.183"
						Top:    1.821"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф.Платежу')
			Data Field: NLS_1002
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.183"
						Top:    2.155"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Рахунок каси')
			Data Field: NLS_2902
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.183"
						Top:    2.488"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Рахунок погашення')
			! Data Field: NLS_2902
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.183"
						Top:    2.488"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
.end
				                                                                                                                                                                                                                      Message Actions 
					                                                                                                                                                                                                                      On SAM_TooltipSetText
						                                                                                                                                                                                                                      Return XSalTooltipSetText( lParam, 'Рахунок погашення')
			Data Field: REF8
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.183"
						Top:    2.821"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф.Платежу по пені')
			Data Field: NLS_6397
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.183"
						Top:    3.155"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Рахунок погашення Пені')
			!
			Background Text: Кредит
				Resource Id: 52598
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    1.929"
					Width:  1.1"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dSS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.183"
						Top:    1.821"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Дата ОСНОВНОГО поточного боргу ')
			Data Field: nSS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.183"
						Top:    1.821"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Sky
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Сума ОСНОВНОГО поточного боргу ')
			Data Field: dSS1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.183"
						Top:    1.821"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Дата ОСНОВНОГО кінцевого боргу ')
			Data Field: nSS1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.183"
						Top:    1.821"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Cyan
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Сума ОСНОВНОГО кінцевого боргу ')
			!
			Background Text: Проценти
				Resource Id: 52599
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    2.262"
					Width:  1.1"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dSN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.183"
						Top:    2.155"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Дата ПРОЦЕНТНОГО поточного боргу ')
			Data Field: nSN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.183"
						Top:    2.155"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Sky
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Сума ПРОЦЕНТНОГО поточного боргу ')
			Data Field: dSN1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.183"
						Top:    2.155"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Дата ПРОЦЕНТНОГО кінцевого боргу ')
			Data Field: nSN1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.183"
						Top:    2.155"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Cyan
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Сума ПРОЦЕНТНОГО кінцевого боргу ')
			!
			Background Text: Комісія
				Resource Id: 52600
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    2.595"
					Width:  1.1"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dSK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.183"
						Top:    2.488"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Дата КОМІСІЙНОГО поточного боргу ')
			Data Field: nSK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.183"
						Top:    2.488"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Sky
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Сума КОМІСІЙНОГО поточного боргу ')
			Data Field: dSK1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.183"
						Top:    2.488"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Дата КОМІСІЙНОГО кінцевого боргу ')
			Data Field: nSK1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.183"
						Top:    2.488"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Cyan
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Сума КОМІСІЙНОГО кінцевого боргу ')
			!
			Background Text: Пеня
				Resource Id: 52601
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    2.929"
					Width:  1.1"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dSP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.183"
						Top:    2.821"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Дата ШТРАФНОГО поточного боргу ')
			Data Field: nSP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.183"
						Top:    2.821"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Сума ШТРАФНОГО поточного боргу ')
					On SAM_SetFocus
						Set SN8_OST = nSP
					On SAM_KillFocus
						If nSP > SN8_OST
							Set nSP = SN8_OST
			Data Field: dSP1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.183"
						Top:    2.821"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Дата ШТРАФНОГО кінцевого боргу ')
			Data Field: nSP1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.183"
						Top:    2.821"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Cyan
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, ' Сума ШТРАФНОГО кінцевого боргу ')
			Check Box: cb_SN8
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Додатково погасити ГРН-пеню 
				Window Location and Size
					Left:   5.183"
					Top:    2.821"
					Width:  4.0"
					Width Editable? Yes
					Height: 0.321"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Blue
				Background Color: Default
				Message Actions
			!
			Data Field: TXT_KOM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.183"
						Top:    3.155"
						Width:  6.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Multiline Field: ml1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					String Type: String
					Editable? No
				Display Settings
					Border? Yes
					Word Wrap? Yes
					Vertical Scroll? No
					Window Location and Size
						Left:   0.683"
						Top:    3.738"
						Width:  10.5"
						Width Editable? Yes
						Height: 0.417"
						Height Editable? Yes
					Visible? Yes
					Font Name: Arial
					Font Size: 11
					Font Enhancement: Bold
					Text Color: Red
					Background Color: 3D Face Color
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Залальна Сума літерами')
			Data Field: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.683"
						Top:    4.238"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Числовий код валюти')
			Data Field: LCV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.483"
						Top:    4.238"
						Width:  0.8"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'ISO код валюти')
			Data Field: KURS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.283"
						Top:    4.238"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Курс валюти')
			Data Field: UVAGA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.183"
						Top:    4.238"
						Width:  4.0"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: NAMEV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.183"
						Top:    4.238"
						Width:  4.0"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Найменування валюти')
			Multiline Field: ml1V
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					String Type: String
					Editable? No
				Display Settings
					Border? Yes
					Word Wrap? Yes
					Vertical Scroll? No
					Window Location and Size
						Left:   0.683"
						Top:    4.571"
						Width:  10.5"
						Width Editable? Yes
						Height: 0.405"
						Height Editable? Yes
					Visible? Yes
					Font Name: Arial
					Font Size: 11
					Font Enhancement: Bold
					Text Color: Red
					Background Color: 3D Face Color
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сума літерами в цілих одиницях валюти')
			Multiline Field: ml1G
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					String Type: String
					Editable? No
				Display Settings
					Border? Yes
					Word Wrap? Yes
					Vertical Scroll? No
					Window Location and Size
						Left:   0.683"
						Top:    4.988"
						Width:  10.5"
						Width Editable? Yes
						Height: 0.405"
						Height Editable? Yes
					Visible? Yes
					Font Name: Arial
					Font Size: 11
					Font Enhancement: Bold
					Text Color: Blue
					Background Color: 3D Face Color
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сума літерами в нац.валюті по викупу нерозмінної монети')
			!
			! ctb_pbGetValue: pb_SN1F
.winattr class Pushbutton:
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   9.983"
					Top:    2.988"
					Width:  0.43"
					Width Editable? No
					Height: 0.317"
					Height Editable? No
				Visible? No
				Keyboard Accelerator: F10
				Font Name: Default
				Font Size: Default
				Font Enhancement: None
				Picture File Name: \BARS98\RESOURCE\BMP\A_ints.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Cyan
.end
				                                                                                                                                                                                                                                                Message Actions 
					                                                                                                                                                                                                                                                On SAM_Create
						                                                                                                                                                                                                                                                Set strTip = 'Нарахувати з проводками ПРОЦЕНТНІ та КОМІСІЙНІ доходи'
					                                                                                                                                                                                                                                                On SAM_Click
						! Call Sel010(hWndMDI,0, 0,
								" and s.TIP in ('SS ','SP ','SL ')
								  and s.ACC in (select acc from nd_acc where nd="||Str(ND)||")" ,
								" "   )
						                                                                                                                                                                                                                                                Call Sel010(hWndMDI,0, 0,
								"  and
								(i.id=2 and s.acc=" ||Str(ACC8)|| " OR
								 s.TIP in ('SS ','SP ','SL ') and s.ACC in (select acc from nd_acc where nd="||Str(ND)||")
								 )" ,
								" "   )
			! !!!!!!!!!!!!!!!
			! !
			Data Field: KV_KOM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.483"
						Top:    2.488"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Код вал комісійного боргу')
		Functions
			Function: f_Oleg
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: l_id
					Number: status
					Long String: errmsg
					String: l_CC_ID
					Date/Time: l_DAT1
					!
					Number: i
				Actions
					! Послать запрос, получить в ответ ИД запроса( l_id )
					If NOT SqlPLSQLCommand( hSql(),"bars_gqcck.create_doginfo_query(CC_ID,DAT1,BankDate_1,l_id ) ")
						Call SqlRollback(  hSql())
						Return FALSE 
					Call SqlCommit( hSql())
					!
					Set i = 0
					While i < nCount
						! Узнать ответ на запрос с ИД = nIz
						Set status = 0
						If NOT SqlPLSQLCommand( hSql(), "bars_gqcck.get_doginfo_query_centura
								(l_id,status, errmsg,   l_CC_ID, l_DAT1, 
								 nS_100, nS1_100, NMK, OKPO, sADRES, KV, LCV, NAMEV, sUNIT, sGENDER, 
								 nSS_100, dSS1, nSS1_100, dSN, nSN_100, nSN1_100, dSK, nSK_100, nSK1_100, KV_KOM,    
								 dSP, nSP_100, SN8_NLS, SD8_NLS, MFOK_, NLSK_)" ) 
							Return FALSE 
						!
						If status = 1 ! обработан успешно
							Set LCV = Subs(LCV,1,3)
							Set NAMEV = Subs(NAMEV,1,25)
							Set sUNIT = Subs(sUNIT,1,3)
							Set sGENDER = Subs(sGENDER,1,1)
							Return TRUE
						Else If status = 2 ! обработан с ошибкой
							Call MessageNoWait(
									"Помилка при обробці запиту " || Str(l_id)|| " по КД "|| CC_ID ||" від "|| SalFmtFormatDateTime( DAT1, 'dd/MM/yyyy'),
									Subs(errmsg,1,250), 0, 1)
							Return FALSE
						! Если ответа пока нет - Ждать nSecond секунд
						Set i = i +1
						If MessageNoWait("Обробка запиту " || Str(l_id)|| " по КД "|| CC_ID ||" від "|| SalFmtFormatDateTime( DAT1, 'dd/MM/yyyy')||" 
								" ||Str(nSecond*i) || " сек. із " || Str(nSecond*nCount)||"
								 <ESC> - Відмова від запиту ",
								"Чекаю відповіді, ітерація № " || Str(i),
								 nSecond,0) = 1
							Return FALSE 
					!
					Call MessageNoWait("Час пошуку в ЦКС = "||Str(nSecond*nCount) || " сек. вичерпано !", 
							'УВАГА !', 0, 1)
					Return FALSE 
			!
			Function: F_NULL
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set dSS = GetBankDate()
					Set nSS = NUMBER_Null
					Set dSS1 = DATETIME_Null
					Set nSS1 = NUMBER_Null
					Set dSN = DATETIME_Null
					Set nSN = NUMBER_Null
					Set dSN1 = GetBankDate() - 1
					Set nSN1= NUMBER_Null
					Set dSK = DATETIME_Null
					Set nSK = NUMBER_Null
					Set dSK1 = GetBankDate() - 1
					Set nSK1= NUMBER_Null
					Set CC_ID = STRING_Null
					Set DAT1 = DATETIME_Null
					Set NMK = STRING_Null
					Set OKPO = STRING_Null
					Set nS = NUMBER_Null
					Set nS1 = NUMBER_Null
					Call SalHideWindow( TXT_KOM )
					Call SalHideWindow( TXT_END )
					! Set ND = NUMBER_Null
					Set REF = NUMBER_Null
					Set REF8 = NUMBER_Null
					!
					Set ml1 = STRING_Null
					Set KV = NUMBER_Null
					Set LCV = STRING_Null
					Set NAMEV = STRING_Null
					Set ml1V = STRING_Null
					Set ml1G = STRING_Null
					Set KURS = NUMBER_Null
					Call SalEnableWindow( rb )
					Call SalEnableWindow( rb1 )
					Call SalEnableWindow( CC_ID )
					Call SalEnableWindow( DAT1 )
					! Call SalEnableWindow( ND )
					Call SalEnableWindow( nS )
					Call SalEnableWindow( nS1 )
					Call SalEnableWindow( pb_F1 )
					Call F_VALUTA( n980 )
					Call F_DISA ()
					Call SalSetFocus( CC_ID )
			Function: F_DISA
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalDisableWindow( pb_F10 )
					Call SalDisableWindow( pb_F5 )
			Function: F_VALUTA
				Description:
				Returns
				Parameters
					Number: nKV
				Static Variables
				Local variables
				Actions
					If nKV = n980
						Call SalHideWindow( UVAGA )
						Call SalHideWindow( ml1V )
						Call SalHideWindow( ml1G )
						Set KURS = NUMBER_Null
					Else
						Call SalShowWindow( UVAGA )
						If SqlPrepareAndExecute( hSql(),
								  "SELECT r.RATE_O/r.BSUM into :KURS from cur_rates r
								   WHERE r.kv=:KV and (r.kv,r.vdate)=
								    (select kv,max(vdate) from cur_rates
								     where kv=:KV and vdate<=:BankDate group by kv) ")
								and SqlFetchNext( hSql(), nFetchRes )
					Call SalHideWindow( ml1V )
					Call SalHideWindow( ml1G )
			Function: f_Opl
				Description:
				Returns
					Boolean:
				Parameters
					Receive String: sErr
				Static Variables
				Local variables
					Number: nSk
					Number: S_
					Number: nSum
					String: sNazn     !! Назначение пл
					!
					String: sPASP
					String: sPASPN
					String: sATRT
					String: sDT_R
				Actions
					Set S_ = IifN(rb, nS, nS1)
					Set sErr = STRING_Null
					If S_ != NUMBER_Null and S_ > 0
						Set nSum = S_ * 100
						Set sNazn = 'Сплата боргу за кредит згідно договору №'||CC_ID||
								            ' від '|| SalFmtFormatDateTime( DAT1, 'dd/MM/yyyy' )
						If KV = n980
							Set nSk = nSKP
						Else
							Set nSk = NUMBER_Null
						If MFOK_ = STRING_Null
							Set MFOK_ = BankMfo
						! Для тех, кто не имеет индив.счета гашения,
								  а также для ДЕМАРКА - всегда,
								берем КОТЛОВОЙ счет гашения NLS_2902
						If NLSK_ = STRING_Null OR BankMfo = '353575'
							Set NLSK_ = NLS_2902
						Set REF = NUMBER_Null
						If MFOK_ = BankMfo
							! Call cDoc.SetDoc( REF, sTT, 1, nVOB[nORD], Subs(CC_ID,1,10),
									     SalDateCurrent( ), SalDateCurrent( ), BankDate, BankDate,
									     NLS_1002,NMS_1002, BankMfo, '', KV, nSum, GetBankOkpoS(), 
									     NLSK_   ,NMK     , BankMfo, '', KV, nSum, OKPO,
									     sNazn, '',GetIdOper(),'', nSk ,0)
							Call cDoc.SetDoc( REF, sTT, 0, nVOB[nORD], Subs(CC_ID,1,10),
									     SalDateCurrent( ), SalDateCurrent( ), BankDate, BankDate,     
									     NLSK_   ,NMK     , BankMfo, '', KV, nSum, OKPO,
									     NLS_1002,NMS_1002, BankMfo, '', KV, nSum, GetBankOkpoS(), 
									     sNazn, '',GetIdOper(),'', nSk ,0)
							If NOT cDoc.oDoc()
								Set sErr = "1) Деб="||NLS_1002|| "  Крд="|| NLSK_
								Return FALSE
						Else
							Call cDoc.SetDoc( REF, sTT2, 1, nVOB[nORD], Subs(CC_ID,1,10),
									     SalDateCurrent( ),  SalDateCurrent( ), BankDate, BankDate,
									     NLS_2902,NMS_2902, BankMfo, '', KV, nSum, GetBankOkpoS(),
									     NLSK_   ,NMK     , MFOK_  , '', KV, nSum, OKPO, 
									     sNazn, '',GetIdOper(),'', nSk ,0)
							If NOT cDoc.oDoc() 
								Set sErr = "2) Деб="|| NLS_2902 || "  Крд= МФО и сч."||MFOK_||", "|| NLSK_
								Return FALSE
							If NOT cDoc.PayV (0, cDoc.m_nRef, BankDate, sTT, 1, KV, NLS_1002, nSum, KV, NLS_2902, nSum )
								Set sErr = "3) Деб="|| NLS_1002 || "  Крд="|| NLS_2902
								Return FALSE
						Set REF = cDoc.m_nRef
						! Доп рекв ФИО
						If NOT SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref,tag,value) VALUES (:REF,'FIO',:NMK )" )
							Set sErr = "4) FIO="||NMK
							Return FALSE
						Set nQ = nSum
						If KV != n980
							! Доп рекв для 1-ПБ и #073
							If NOT
									(   SqlPrepareAndExecute( hSql(),"select gl.p_Icurval(:KV,:nSum,:BankDate) into :nQ from dual")
									and SqlFetchNext( hSql(), nFetchRes )
									and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref,tag,value) VALUES (:REF,'KOD_B',:sKOD_B )" )
									and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref,tag,value) VALUES (:REF,'KOD_G','804'   )" )
									and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref,tag,value) VALUES (:REF,'KOD_N','8446'  )" )
									and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref,tag,value) VALUES (:REF,'D#73' , '246'   )" )
									)
								Set sErr = "5) для 1-ПБ и #073"
								Return FALSE
						! Доп рекв для больших сумм
						If nQ >=5000000
							If NOT
									 (  SqlPrepareAndExecute( hSql(),
									     "SELECT k.name, 
									             p.SER   ||' '|| p.NUMDOC, 
									             p.ORGAN ||' '|| To_char(p.PDATE,'dd/mm/yyyy'), 
									             to_char(p.BDAY,'dd/mm/yyyy')
									      INTO :sPASP, :sPASPN, :sATRT ,:sDT_R
									      from PASSP k, person p where p.rnk=:nRnk and NVL(p.PASSP,1)=k.PASSP (+) " )
									and SqlFetchNext( hSql(), nFetchRes )
									and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref,tag,value) VALUES (:REF,'PASP', :sPASP  )" )
									and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref,tag,value) VALUES (:REF,'PASPN',:sPASPN )" )
									and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref,tag,value) VALUES (:REF,'ATRT', :sATRT  )" )
									and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref,tag,value) VALUES (:REF,'DT_R', :sDT_R  )" )
									and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref,tag,value) VALUES (:REF,'ADRES',:sADRES )" )
									  )
								Set sErr = "6) Доп рекв для больших сумм "
								Return FALSE
						Return TRUE
			Function: f_Opl_SN8
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: nSk
					Number: S_
					Number: nSum
					String: sNazn     !! Назначение пл
					!
					String: sPASP
					String: sPASPN
					String: sATRT
					String: sDT_R
				Actions
					Set nSum = nSP * 100
					Set sNazn = 'Сплата штрафу ( пенi ) за просрочені проценти згідно договору №'||CC_ID||
							            ' від '|| SalFmtFormatDateTime( DAT1, 'dd/MM/yyyy' )
					Set nSk = nSKP
					Set REF8 = NUMBER_Null
					Call cDoc.SetDoc( REF8, sTT, 0, nVOB[1], Subs(CC_ID,1,10),
							     SalDateCurrent( ),  SalDateCurrent( ), BankDate, BankDate,
							     NLS_6397, NMS_6397, BankMfo,'',n980,nSum,GetBankOkpoS(),
							     NLS_1002, NMS_1002, BankMfo,'',n980,nSum,OKPO,sNazn, '',GetIdOper(),'', nSk ,0)
					If NOT cDoc.oDoc()
						Return FALSE
					Set REF8 = cDoc.m_nRef
					If NOT cDoc.PayTT (0,REF8,BankDate,sTT,1,n980,SD8_NLS,nSum,n980,SN8_NLS,nSum) 
							OR NOT SqlPrepareAndExecute( hSql(),
							      "INSERT INTO operw (ref,tag,value) VALUES (:REF8,'FIO',:NMK )" )
							OR NOT SqlPrepareAndExecute( hSql(),"DELETE From nlk_ref where ref1=:REF8 " )
						Return FALSE
					Return TRUE
			Function: F_DISA1
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalDisableWindow( pb_F10 )
					Call SalEnableWindow( pb_F5 )
					! Call SalDisableWindow( ND )
					!
					Call SalDisableWindow( CC_ID )
					Call SalDisableWindow( DAT1 )
					Call SalDisableWindow( nS )
					Call SalDisableWindow( nS1 )
					! Call SalDisableWindow( pb_F1 )
					Call SalDisableWindow( rb )
					Call SalDisableWindow( rb1 )
			Function: F_SumPr
				Description:
				Returns
					Boolean:
				Parameters
					Number: S_
				Static Variables
				Local variables
					Number: nKop
					Number: nS_980
				Actions
					!
					!
					Set ml1 = SumPr( S_ *100, sGENDER, LCV, sUNIT )
					Call SalHideWindow( ml1V )
					Call SalHideWindow( ml1G )
					Set ml1V = STRING_Null
					Set ml1G = STRING_Null
					Set nORD = 1
					If KV != 980
						Set nKop = SalNumberMod( S_, IifN ( KV=978,5,1 ) )
						Set nORD = 2
						If nKop > 0
							Set ml1V = SumPr( (S_ - nKop)*100, sGENDER, LCV, sUNIT )
							Set nS_980 = SalNumberRound( nKop*100 * KURS )
							Set ml1G = SumPr( nS_980, 'F', "грн.", "коп." )
							Call SalShowWindow( ml1V )
							Call SalShowWindow( ml1G )
							Set nORD = 3
						!
						If nVOB[nORD] = NUMBER_Null
							If SqlPrepareAndExecute( hSql(),
									   "SELECT vob INTO :nVOB["||Str(nORD)||"] FROM tts_vob WHERE tt=:sTT and ORD=:nORD " )
									and SqlFetchNext( hSql(), nFetchRes )
							Else
								Set nVOB[nORD] = nVOB[1]
					Return TRUE
			Function: f_Tochka
				Description:
				Returns
				Parameters
					Window Handle: hWnd
				Static Variables
					String: sTmp
				Local variables
				Actions
					Set sTmp=SalStrRepeatX( ' ', 20 )
					Call SalGetWindowText ( hWnd, sTmp, 20 )
					While SalStrScan(sTmp, sDecimal2) > 0
						Set sTmp = SalStrReplaceX(sTmp,SalStrScan(sTmp,sDecimal2),1,sDecimal)
					Call SalFmtStrToField ( hWnd, sTmp, TRUE)
		Window Parameters
			Number: nMode ! 297
			Number: nPar  ! 0 (NUMBER_Null) или реф КД
			String: sTT ! Операция CCK - внутренняя
			String: sTT2 ! Операция KK2 - внешняя
		Window Variables
			Number: nRet_
			String: sRet_
			String: SD8_NLS
			String: SN8_NLS
			Number: SN8_OST
			Number: nSecond 
			Number: nCount
			! String: NLS_6397
			String: NMS_6397
			String: sADRES
			!
			Number: nS_OLD
			Number: nORD
			String: CC_FL_PR !! Флаг начисления % проводками в ТОБО
			String: sUNIT
			String: sGENDER
			String: Sql_1002
			String: NMS_1002
			String: NMS_2902
			Number: n980
			Number: nQ
			String: BankMfo
			String: sKOD_B
			Date/Time: BankDate
			Date/Time: BankDate_1
			String: sErr
			Number: nVOB[*]
			String: sDecimal2  ! симв десятичной точки alt
			String: sDecimal   ! симв десятичной точки
			: cDoc
				Class: cDoc
			! Number: KV_KOM
			String: TOBO
			String: s6397
			! Boolean: FL_SN1_Add 
			String: MFOK_
			String: NLSK_
			! nS nS1 nSS nSS1 nSN nSN1 nSK nSK1 nSP  
			Number: nS_100
			Number: nS1_100
			Number: nSS_100
			Number: nSS1_100
			Number: nSN_100
			Number: nSN1_100
			Number: nSK_100
			Number: nSK1_100
			Number: nSP_100
			!
			Number: nRnk
		Message Actions
			On SAM_Create
				Set nVOB[1] = NUMBER_Null
				Set nVOB[2] = NUMBER_Null
				Set nVOB[3] = NUMBER_Null
				Set n980 = GetBaseVal()
				Set nORD = 1
				Set TXT_KOM ='Комісія до суми платежу НЕ додається !'
				Set TXT_END = "Термін дії угоди завершено !"
				Call SalHideWindow( TXT_KOM )
				Set UVAGA = 'У В А Г А,  В А Л Ю Т А ! '
				Call F_VALUTA( n980 )
				Set sDecimal =SalStrMidX(SalNumberToStrX(1.1,1),1,1)
				Set sDecimal2 = IifS ( sDecimal = '.', ',', '.' )
				Call F_DISA ()
				Set BankMfo =  GetBankMfo()
				Set BankDate = GetBankDate()
				Set BankDate_1 = GetBankDate() - 1
				Set sKOD_B =  GetGlobalOption('1_PB')
				!
				If nHaveTOBO = 2
					Set nSecond= GetGlobalOptionEx('CCK_1S') ! Cек.ожидания проверки отв на запрос-1
					Set nCount = GetGlobalOptionEx('CCK_1C') ! Кол-во итераций проверки отв на запрос-1
					! 1002 
					Set Sql_1002 = "tobopack.GetToboCASH"
					! 2902 
					If SqlPrepareAndExecute( hSql(),
							"SELECT val INTO :NLS_2902 from BRANCH_PARAMETERS 
							 where tag='CCK_ASG' and branch=sys_context('bars_context','user_branch')")
							and NOT SqlFetchNext( hSql(), nFetchRes )
						Call SalMessageBox("Не описан в BRANCH_PARAMETERS tag='CCK_ASG' ", "Ошибки в настройках ! ", MB_IconStop)
						Call SalDestroyWindow(hWndForm)
				Else
					! 1002 
					Set Sql_1002 = "pul.Get_Mas_Ini_Val('CASH')"
					! 2902 
					Set NLS_2902 = GetGlobalOption('CCK_ASG')
					! общий 6397 NLX 
					If SqlPrepareAndExecute( hSql(),
							  "Select a.nls,substr(a.nms,1,380) 
							   into :NLS_6397,:NMS_6397 
							   from accounts a, params p 
							   where a.kv= :n980 and a.dazs is null and a.nls=p.val and p.par='CC_NLX_G' ") 
							and not SqlFetchNext( hSql(), nFetchRes )
						Call SalMessageBox('Не определен Счет доходов по ПЕНЕ !', "Ошибки в настройках ! ", MB_IconStop)
						Call SalDestroyWindow(hWndForm)
					! NLS_GB_TOBO
					Set s6397 = NLS_6397 
					If SqlPrepareAndExecute( hSql(),
							  "SELECT a.nls,substr(a.nms,1,380) into :NLS_6397,:NMS_6397 
							   from accounts a, NLS_GB_TOBO p 
							   where a.kv= :n980 and a.dazs is null and a.nls=p.nlst and p.nlsg=:s6397 and p.tobo=:TOBO ") 
							and SqlFetchNext( hSql(), nFetchRes )
					!
				! If nPar >0
					                                                                                                                                                                       Set ND = nPar
					                                                                                                                                                                       Call SalDisableWindow( CC_ID )
					                                                                                                                                                                       Call SalDisableWindow( DAT1 )
					                                                                                                                                                                       Call SalDisableWindow( pb_F1 )
					! и задан индив 2902
					                                                                                                                                                                       If strPar02 !=STRING_Null
						                                                                                                                                                                       Set NLS_2902 = SalStrTrimX( strPar02 )
				If SqlPrepareAndExecute( hSql(),
						"SELECT nls, nms INTO :NLS_1002,:NMS_1002 from accounts where kv=:n980 and nls = Substr(" || Sql_1002 || ",1,14) ")
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Call SalMessageBox('Не определен счет кассы ', "Ошибки в настройках ! ", MB_IconStop)
					Call SalDestroyWindow(hWndForm)
				If SqlPrepareAndExecute( hSql(),
						"SELECT nms INTO :NMS_2902 from accounts where kv=:n980 and nls = :NLS_2902 ")
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Call SalMessageBox('Не определен счет гашения ', "Ошибки в настройках ! ", MB_IconStop)
					Call SalDestroyWindow(hWndForm)
				!
				If SqlPrepareAndExecute( hSql(),
						 "SELECT Nvl(t.SK,32), v.vob INTO :nSKP, :nVOB[1] FROM tts t, tts_vob v
						  WHERE v.tt=t.tt and t.tt=:sTT and v.ORD=1 ") 
						AND NOT SqlFetchNext( hSql(), nFetchRes )
					Call SalMessageBox('Не определена операция '||sTT, "Ошибки в настройках ! ", MB_IconStop)
					Call SalDestroyWindow(hWndForm)
				!
				! Флаг начисления % проводками
				Set CC_FL_PR = '0'
				! в ТОБО из ini-файла
				If SqlPrepareAndExecute(hSql(),
						"SELECT substr(pul.Get_Mas_Ini_Val('KOD_TOBO'),1,12) INTO :TOBO from dual ")
						and SqlFetchNext(hSql(), nFetchRes)
				Call F_NULL()
				! If nPar >0
					                                                                                                                                                                                                                           Call SalSendMsg( pb_F1, SAM_Click, 0, 0 )
					                                                                                                                                                                                                                           Set ND = nPar
					                                                                                                                                                                                                                           Call SalDisableWindow( CC_ID )
					                                                                                                                                                                                                                           Call SalDisableWindow( DAT1 )
					                                                                                                                                                                                                                           Call SalDisableWindow( pb_F1 )
				Call SalMapEnterToTab( TRUE )
				Call SalSetWindowText(hWndForm, 'Погашення кредиту готівкою ' )
				Call ShowApdVersion('06')
	! !!!
	! Form Window: CCK1  демарк
.winattr
		Class:
		Property Template:
		Class DLL Name:
		Title: Погашення кредиту готівкою
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.45"
				Top:    0.542"
				Width:  12.083"
				Width Editable? Yes
				Height: 6.833"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
.end
		                                                                                                                                                                       Description: 
		                                                                                                                                                                       Named Menus 
		                                                                                                                                                                       Menu 
		                                                                                                                                                                       Tool Bar 
			                                                                                                                                                                       Contents 
		                                                                                                                                                                       Contents 
			                                                                                                                                                                       Background Text: Сплата боргу за користування позикою згідно кредитної угоди
			                                                                                                                                                                       Data Field: TXT_END
				                                                                                                                                                                       Message Actions 
			                                                                                                                                                                       Pushbutton: pb_F6
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_Create
						                                                                                                                                                                       Set strTip = 'F6. Новий '
					                                                                                                                                                                       On SAM_Click
						                                                                                                                                                                       Call F_NULL()
			                                                                                                                                                                       Pushbutton: pb_Exit
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_Create
						                                                                                                                                                                       Set strTip = 'ESC. Завершити  '
					                                                                                                                                                                       On SAM_Click
						                                                                                                                                                                       Call SalDestroyWindow(hWndForm)
			!
			                                                                                                                                                                       Background Text: № Угоди
			                                                                                                                                                                       Data Field: CC_ID
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, '№ Угоди')
					                                                                                                                                                                       On SAM_Validate
						                                                                                                                                                                       Set CC_ID = SalStrTrimX( CC_ID )
					                                                                                                                                                                       On SAM_SetFocus
						                                                                                                                                                                       Call SalMapEnterToTab( TRUE )
			                                                                                                                                                                       Background Text: Дата Угоди
			                                                                                                                                                                       Data Field: DAT1
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, 'Дата Угоди')
					                                                                                                                                                                       On SAM_Validate
						                                                                                                                                                                       If DAT1 != DATETIME_Null and DAT1 >= GetBankDate()
							                                                                                                                                                                       Call SalMessageBox("Дата начала КД должна быть МЕНЬШЕ текущей банковской",
									"Ошибка ! ", MB_IconStop)
							                                                                                                                                                                       Set DAT1 = DATETIME_Null
						                                                                                                                                                                       Return VALIDATE_Ok
					                                                                                                                                                                       On SAM_SetFocus
						                                                                                                                                                                       Call SalMapEnterToTab( TRUE )
			                                                                                                                                                                       Pushbutton: pb_F1
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_Create
						                                                                                                                                                                       Set strTip = 'F1. Пошук угоди в БД '
					                                                                                                                                                                       On SAM_Click
						                                                                                                                                                                       Set sSql = STRING_Null
						                                                                                                                                                                       Call F_DISA ()
						                                                                                                                                                                       If CC_ID != STRING_Null and DAT1 != DATETIME_Null
							                                                                                                                                                                       Set sSql = sSql1
						                                                                                                                                                                       Else If ND != NUMBER_Null
							                                                                                                                                                                       Set sSql = sSql2
						                                                                                                                                                                       If sSql != STRING_Null
							                                                                                                                                                                       If SqlPrepareAndExecute( hSql(), sSql ) and SqlFetchNext( hSql(), nFetchRes )
								                                                                                                                                                                       Call NASELENIE()
							                                                                                                                                                                       Else 
								                                                                                                                                                                       Call SalMessageBox(
										'Угоду № '|| CC_ID ||
										' з датою заключення ' ||
										SalFmtFormatDateTime( DAT1, 'dd/MM/yyyy' ) ||
										' не знайдено серед діючих ',
										"Помилки в заданих параметрах пошуку ! ", MB_IconStop)
								! Call SalMessageBeep( MB_IconAsterisk )
								                                                                                                                                                                       Call SalSetFocus( CC_ID )
			                                                                                                                                                                       Data Field: nSKP
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, 'Символ Кас.Плана')
					                                                                                                                                                                       On SAM_Validate
						                                                                                                                                                                       If nSKP > 39
							                                                                                                                                                                       Return VALIDATE_Cancel
						                                                                                                                                                                       Return VALIDATE_Ok
			                                                                                                                                                                       Pushbutton: pb_F10
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_Create
						                                                                                                                                                                       Set strTip = 'F10. Ввести '
					                                                                                                                                                                       On SAM_Click
						                                                                                                                                                                       If SalMessageBox(
								'Виконати
								'|| IifS (rb1, 'О С Т А Т О Ч Н И Й ','П О Т О Ч Н И Й ') || '
								разрахунок ? ',
								 'УВАГА !',
								MB_IconQuestion | MB_YesNo) = IDYES
							                                                                                                                                                                       If f_Opl()
								                                                                                                                                                                       Call SqlCommit(hSql())
								                                                                                                                                                                       If nSP > 0
										AND cb_SN8 = 1
										AND SalMessageBox(
										'Сплатити штраф-пеню в розмірі '|| SalNumberToStrX( nSP, 2 )||' ?',
										 'УВАГА !',
										MB_IconQuestion | MB_YesNo) = IDYES
									                                                                                                                                                                       If f_Opl_SN8()
										                                                                                                                                                                       Call SqlCommit(hSql())
								                                                                                                                                                                       Call F_DISA1()
								                                                                                                                                                                       Call SalSendMsg( pb_F5, SAM_Click, 0, 0 )
							                                                                                                                                                                       Else 
								                                                                                                                                                                       Call SqlRollback(hSql())
			                                                                                                                                                                       Pushbutton: pb_F5
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_Create
						                                                                                                                                                                       Set strTip = 'F5. Надрукувати '
					                                                                                                                                                                       On SAM_Click
						                                                                                                                                                                       Set cDoc.m_nRef = REF
						                                                                                                                                                                       Call cDoc.pDoc()
						                                                                                                                                                                       If REF8 > 0
							                                                                                                                                                                       Set cDoc.m_nRef = REF8
							                                                                                                                                                                       Call cDoc.pDoc()
						                                                                                                                                                                       Call SalWaitCursor(FALSE)
			!
			                                                                                                                                                                       Background Text: Сума платежу
			                                                                                                                                                                       Radio Button: rb
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_Click
						                                                                                                                                                                       If rb
							                                                                                                                                                                       Call SalSetFocus( nS )
			                                                                                                                                                                       Radio Button: rb1
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_Click
						                                                                                                                                                                       If rb1
							                                                                                                                                                                       Call SalSetFocus( nS1 )
			                                                                                                                                                                       Data Field: nS
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, 'Сума платежу')
					                                                                                                                                                                       On SAM_SetFocus
						                                                                                                                                                                       Set rb = TRUE
						                                                                                                                                                                       Set nS_OLD = nS
						                                                                                                                                                                       Call F_SumPr(nS)
						! Call SalMapEnterToTab( TRUE )
					                                                                                                                                                                       On SAM_Validate
						                                                                                                                                                                       Call f_Tochka (hWndItem)
						                                                                                                                                                                       Call F_SumPr(nS)
						                                                                                                                                                                       If nS > nS1
							                                                                                                                                                                       If SalMessageBox(
									'Введена Сума платежу перевищує ЗАГАЛЬНИЙ кінцевий борг !
									 Відмовитись від цієї суми = '|| SalNumberToStrX( nS, 2 ) || ' ? ',
									 'Можлива переплата  !',
									MB_IconQuestion | MB_YesNo) = IDYES
								                                                                                                                                                                       Set nS = nS_OLD
								                                                                                                                                                                       Call SalSetFocus( nS )
								                                                                                                                                                                       Return VALIDATE_Cancel
						                                                                                                                                                                       Return VALIDATE_Ok
					                                                                                                                                                                       On SAM_KillFocus
						                                                                                                                                                                       Call f_Tochka (hWndItem)
						                                                                                                                                                                       Call F_SumPr(nS)
						                                                                                                                                                                       If nS > nS1
							                                                                                                                                                                       If SalMessageBox(
									'Введена Сума платежу перевищує ЗАГАЛЬНИЙ кінцевий борг !
									 Відмовитись від цієї суми = '|| SalNumberToStrX( nS, 2 ) || ' ? ',
									 'Можлива переплата  !',
									MB_IconQuestion | MB_YesNo) = IDYES
								                                                                                                                                                                       Set nS = nS_OLD
								                                                                                                                                                                       Call SalSetFocus( nS )
								                                                                                                                                                                       Return FALSE
						                                                                                                                                                                       Return TRUE
			                                                                                                                                                                       Data Field: nS1
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, 'Сума платежу')
					                                                                                                                                                                       On SAM_SetFocus
						                                                                                                                                                                       Set rb1 = TRUE
						                                                                                                                                                                       Set nS_OLD = nS1
						                                                                                                                                                                       Call F_SumPr(nS1)
						                                                                                                                                                                       Call SalMapEnterToTab( TRUE )
					                                                                                                                                                                       On SAM_Validate
						                                                                                                                                                                       Call f_Tochka (hWndItem)
						                                                                                                                                                                       Call F_SumPr(nS1)
						                                                                                                                                                                       If nS1 > nS_OLD
							                                                                                                                                                                       If SalMessageBox(
									'Введена Сума платежу перевищує ЗАГАЛЬНИЙ кінцевий борг !
									 Відмовитись від цієї суми = '|| SalNumberToStrX( nS1, 2 ) || ' ? ',
									 'Можлива переплата  !',
									MB_IconQuestion | MB_YesNo) = IDYES
								                                                                                                                                                                       Set nS1 = nS_OLD
								                                                                                                                                                                       Call SalSetFocus( nS1 )
								                                                                                                                                                                       Return VALIDATE_Cancel
						                                                                                                                                                                       Return VALIDATE_Ok
					                                                                                                                                                                       On SAM_KillFocus
						                                                                                                                                                                       Call f_Tochka (hWndItem)
						                                                                                                                                                                       Call F_SumPr(nS1)
						                                                                                                                                                                       If nS1 > nS_OLD
							                                                                                                                                                                       If SalMessageBox(
									'Введена Сума платежу перевищує ЗАГАЛЬНИЙ кінцевий борг !
									 Відмовитись від цієї суми = '|| SalNumberToStrX( nS1, 2 ) || ' ? ',
									 'Можлива переплата  !',
									MB_IconQuestion | MB_YesNo) = IDYES
								                                                                                                                                                                       Set nS1 = nS_OLD
								                                                                                                                                                                       Call SalSetFocus( nS1 )
								                                                                                                                                                                       Return FALSE
						                                                                                                                                                                       Return TRUE
			!
			                                                                                                                                                                       Data Field: NMK
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, 'Позичальник')
			                                                                                                                                                                       Data Field: OKPO
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, 'Ідентиф.код')
			!
			                                                                                                                                                                       Data Field: ND
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, 'Реф.КД')
			                                                                                                                                                                       Data Field: REF
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, 'Реф.Платежу')
			                                                                                                                                                                       Data Field: NLS_1002
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, 'Рахунок каси')
			                                                                                                                                                                       Data Field: NLS_2902
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, 'Рахунок погашення')
			                                                                                                                                                                       Data Field: REF8
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, 'Реф.Платежу по пені')
			                                                                                                                                                                       Data Field: NLS_6397
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, 'Рахунок погашення Пені')
			!
			                                                                                                                                                                       Background Text: Кредит
			                                                                                                                                                                       Data Field: dSS
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, ' Дата ОСНОВНОГО поточного боргу ')
			                                                                                                                                                                       Data Field: nSS
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, ' Сума ОСНОВНОГО поточного боргу ')
			                                                                                                                                                                       Data Field: dSS1
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, ' Дата ОСНОВНОГО кінцевого боргу ')
			                                                                                                                                                                       Data Field: nSS1
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, ' Сума ОСНОВНОГО кінцевого боргу ')
			!
			                                                                                                                                                                       Background Text: Проценти
			                                                                                                                                                                       Data Field: dSN
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, ' Дата ПРОЦЕНТНОГО поточного боргу ')
			                                                                                                                                                                       Data Field: nSN
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, ' Сума ПРОЦЕНТНОГО поточного боргу ')
			                                                                                                                                                                       Data Field: dSN1
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, ' Дата ПРОЦЕНТНОГО кінцевого боргу ')
			                                                                                                                                                                       Data Field: nSN1
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, ' Сума ПРОЦЕНТНОГО кінцевого боргу ')
			!
			                                                                                                                                                                       Background Text: Комісія
			                                                                                                                                                                       Data Field: dSK
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, ' Дата КОМІСІЙНОГО поточного боргу ')
			                                                                                                                                                                       Data Field: nSK
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, ' Сума КОМІСІЙНОГО поточного боргу ')
			                                                                                                                                                                       Data Field: dSK1
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, ' Дата КОМІСІЙНОГО кінцевого боргу ')
			                                                                                                                                                                       Data Field: nSK1
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, ' Сума КОМІСІЙНОГО кінцевого боргу ')
			!
			                                                                                                                                                                       Background Text: Пеня
			                                                                                                                                                                       Data Field: dSP
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, ' Дата ШТРАФНОГО поточного боргу ')
			                                                                                                                                                                       Data Field: nSP
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, ' Сума ШТРАФНОГО поточного боргу ')
					                                                                                                                                                                       On SAM_SetFocus
						                                                                                                                                                                       Set SN8_OST = nSP
					                                                                                                                                                                       On SAM_KillFocus
						                                                                                                                                                                       If nSP > SN8_OST
							                                                                                                                                                                       Set nSP = SN8_OST
			                                                                                                                                                                       Data Field: dSP1
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, ' Дата ШТРАФНОГО кінцевого боргу ')
			                                                                                                                                                                       Data Field: nSP1
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, ' Сума ШТРАФНОГО кінцевого боргу ')
			                                                                                                                                                                       Check Box: cb_SN8
				                                                                                                                                                                       Message Actions 
			!
			                                                                                                                                                                       Data Field: TXT_KOM
				                                                                                                                                                                       Message Actions 
			!
			                                                                                                                                                                       Multiline Field: ml1
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, 'Залальна Сума літерами')
			                                                                                                                                                                       Data Field: KV
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, 'Числовий код валюти')
			                                                                                                                                                                       Data Field: LCV
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, 'ISO код валюти')
			                                                                                                                                                                       Data Field: KURS
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, 'Курс валюти')
			                                                                                                                                                                       Data Field: UVAGA
				                                                                                                                                                                       Message Actions 
			                                                                                                                                                                       Data Field: NAMEV
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, 'Найменування валюти')
			                                                                                                                                                                       Multiline Field: ml1V
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, 'Сума літерами в цілих одиницях валюти')
			                                                                                                                                                                       Multiline Field: ml1G
				                                                                                                                                                                       Message Actions 
					                                                                                                                                                                       On SAM_TooltipSetText
						                                                                                                                                                                       Return XSalTooltipSetText( lParam, 'Сума літерами в нац.валюті по викупу нерозмінної монети')
			!
			! ctb_pbGetValue: pb_SN1F
				                                                                                                                                                                                      Message Actions
					                                                                                                                                                                                      On SAM_Create
						                                                                                                                                                                                      Set strTip = 'Нарахувати з проводками ПРОЦЕНТНІ та КОМІСІЙНІ доходи'
					                                                                                                                                                                                      On SAM_Click
						! Call Sel010(hWndMDI,0, 0,
								" and s.TIP in ('SS ','SP ','SL ')
								  and s.ACC in (select acc from nd_acc where nd="||Str(ND)||")" ,
								" "   )
						                                                                                                                                                                                      Call Sel010(hWndMDI,0, 0,
								"  and
								(i.id=2 and s.acc=" ||Str(ACC8)|| " OR
								 s.TIP in ('SS ','SP ','SL ') and s.ACC in (select acc from nd_acc where nd="||Str(ND)||")
								 )" ,
								" "   )
		                                                                                                                                                                       Functions 
			                                                                                                                                                                       Function: F_NULL
				                                                                                                                                                                       Description: 
				                                                                                                                                                                       Returns 
				                                                                                                                                                                       Parameters 
				                                                                                                                                                                       Static Variables 
				                                                                                                                                                                       Local variables 
				                                                                                                                                                                       Actions 
					                                                                                                                                                                       Set dSS = GetBankDate()
					                                                                                                                                                                       Set nSS = NUMBER_Null
					                                                                                                                                                                       Set dSS1 = DATETIME_Null
					                                                                                                                                                                       Set nSS1 = NUMBER_Null
					!
					                                                                                                                                                                       Set dSN = DATETIME_Null
					                                                                                                                                                                       Set nSN = NUMBER_Null
					                                                                                                                                                                       Set dSN1 = GetBankDate() - 1
					                                                                                                                                                                       Set nSN1= NUMBER_Null
					!
					                                                                                                                                                                       Set dSK = DATETIME_Null
					                                                                                                                                                                       Set nSK = NUMBER_Null
					                                                                                                                                                                       Set dSK1 = GetBankDate() - 1
					                                                                                                                                                                       Set nSK1= NUMBER_Null
					!
					                                                                                                                                                                       Set CC_ID = STRING_Null
					                                                                                                                                                                       Set DAT1 = DATETIME_Null
					                                                                                                                                                                       Set NMK = STRING_Null
					                                                                                                                                                                       Set OKPO = STRING_Null
					                                                                                                                                                                       Set nS = NUMBER_Null
					                                                                                                                                                                       Set nS1 = NUMBER_Null
					                                                                                                                                                                       Call SalHideWindow( TXT_KOM )
					                                                                                                                                                                       Call SalHideWindow( TXT_END )
					                                                                                                                                                                       Set ND = NUMBER_Null
					                                                                                                                                                                       Set REF = NUMBER_Null
					                                                                                                                                                                       Set REF8 = NUMBER_Null
					!
					                                                                                                                                                                       Set ml1 = STRING_Null
					                                                                                                                                                                       Set KV = NUMBER_Null
					                                                                                                                                                                       Set LCV = STRING_Null
					                                                                                                                                                                       Set NAMEV = STRING_Null
					                                                                                                                                                                       Set ml1V = STRING_Null
					                                                                                                                                                                       Set ml1G = STRING_Null
					                                                                                                                                                                       Set KURS = NUMBER_Null
					                                                                                                                                                                       Call SalEnableWindow( rb )
					                                                                                                                                                                       Call SalEnableWindow( rb1 )
					                                                                                                                                                                       Call SalEnableWindow( CC_ID )
					                                                                                                                                                                       Call SalEnableWindow( DAT1 )
					                                                                                                                                                                       Call SalEnableWindow( ND )
					                                                                                                                                                                       Call SalEnableWindow( nS )
					                                                                                                                                                                       Call F_VALUTA( n980 )
					                                                                                                                                                                       Call F_DISA ()
					                                                                                                                                                                       Call SalSetFocus( CC_ID )
			                                                                                                                                                                       Function: F_DISA
				                                                                                                                                                                       Description: 
				                                                                                                                                                                       Returns 
				                                                                                                                                                                       Parameters 
				                                                                                                                                                                       Static Variables 
				                                                                                                                                                                       Local variables 
				                                                                                                                                                                       Actions 
					                                                                                                                                                                       Call SalDisableWindow( pb_F10 )
					                                                                                                                                                                       Call SalDisableWindow( pb_F5 )
			                                                                                                                                                                       Function: F_VALUTA
				                                                                                                                                                                       Description: 
				                                                                                                                                                                       Returns 
				                                                                                                                                                                       Parameters 
					                                                                                                                                                                       Number: nKV
				                                                                                                                                                                       Static Variables 
				                                                                                                                                                                       Local variables 
				                                                                                                                                                                       Actions 
					                                                                                                                                                                       If nKV = n980
						                                                                                                                                                                       Call SalHideWindow( UVAGA )
						                                                                                                                                                                       Call SalHideWindow( ml1V )
						                                                                                                                                                                       Call SalHideWindow( ml1G )
						                                                                                                                                                                       Set KURS = NUMBER_Null
					                                                                                                                                                                       Else 
						                                                                                                                                                                       Call SalShowWindow( UVAGA )
						                                                                                                                                                                       If SqlPrepareAndExecute( hSql(),
								  "SELECT r.RATE_O/r.BSUM into :KURS from cur_rates r
								   WHERE r.kv=:KV and (r.kv,r.vdate)=
								    (select kv,max(vdate) from cur_rates
								     where kv=:KV and vdate<=:BankDate group by kv) ")
								and SqlFetchNext( hSql(), nFetchRes )
					                                                                                                                                                                       Call SalHideWindow( ml1V )
					                                                                                                                                                                       Call SalHideWindow( ml1G )
			!
			                                                                                                                                                                       Function: NASELENIE
				                                                                                                                                                                       Description: 
				                                                                                                                                                                       Returns 
				                                                                                                                                                                       Parameters 
				                                                                                                                                                                       Static Variables 
				                                                                                                                                                                       Local variables 
					                                                                                                                                                                       Number: nLIM
				                                                                                                                                                                       Actions 
					                                                                                                                                                                       Call F_VALUTA( KV )
					                                                                                                                                                                       Set KV_KOM = KV
					! По какую дату нач % ?
					                                                                                                                                                                       If SqlPrepareAndExecute( hSql(),
							  "SELECT max(i.acr_dat) into :dSN
							   FROM accounts a, nd_acc n, int_accn i
							   WHERE n.nd=:ND and n.acc=a.acc and a.tip in ('SS ','SP ','SL ')
							     and i.id=0 and a.acc=i.acc and i.acr_dat is not null")
							and SqlFetchNext( hSql(), nFetchRes )
					! По какую дату нач ком ?
					                                                                                                                                                                       Set nSK = 0
					                                                                                                                                                                       If SqlPrepareAndExecute( hSql(),
							  "SELECT acr_dat into :dSK FROM int_accn WHERE acc=:ACC8 and id=2 ")
							and SqlFetchNext( hSql(), nFetchRes )
						! Вал и сумма уже начисленной комиссии
						                                                                                                                                                                       If SqlPrepareAndExecute( hSql(),
								  "SELECT min(a.kv),Nvl(-SUM(a.ostb+a.ostf),0)/100
								   INTO :KV_KOM, :nSK
								   FROM accounts a, nd_acc n
								   WHERE n.nd=:ND and n.acc=a.acc and a.tip in ('SK0','SK9') ")
								and SqlFetchNext( hSql(), nFetchRes )
					! По какую дату нач пеня ?
					                                                                                                                                                                       Set nSP = 0
					                                                                                                                                                                       Call SalDisableWindow( nSP )
					                                                                                                                                                                       Call SalHideWindow( cb_SN8 )
					                                                                                                                                                                       Set cb_SN8 = 0
					                                                                                                                                                                       If SqlPrepareAndExecute( hSql(),
							  "SELECT Nvl(i.acr_dat,a.daos-1),a8.NLS,a6.NLS,-(a8.ostb+a.ostf)/100
							   INTO :dSP, :SN8_NLS, :SD8_NLS , :nSP
							   FROM accounts a, nd_acc n, int_accn i, accounts a8, accounts a6
							   WHERE n.nd=:ND and n.acc=a.acc and a.tip='SPN'
							    and i.id=2 and a.acc=i.acc and i.acrA=a8.acc and i.acrB=a6.acc")
							and SqlFetchNext( hSql(), nFetchRes )
					                                                                                                                                                                       If nSP > 0
						                                                                                                                                                                       Call SalEnableWindow( nSP )
						                                                                                                                                                                       Call SalShowWindow( cb_SN8 )
						                                                                                                                                                                       Set cb_SN8 = 1
					                                                                                                                                                                       If SqlPrepareAndExecute( hSql(),
							  "SELECT acr_dat into :dSP FROM int_accn WHERE acc=:ACC8 and id=2 ")
							and SqlFetchNext( hSql(), nFetchRes )
						! Вал и сумма уже начисленной комиссии
						                                                                                                                                                                       If SqlPrepareAndExecute( hSql(),
								  "SELECT min(a.kv),Nvl(-SUM(a.ostb+a.ostf),0)/100
								   INTO :KV_KOM, :nSK
								   FROM accounts a, nd_acc n
								   WHERE n.nd=:ND and n.acc=a.acc and a.tip in ('SK0','SK9') ")
								and SqlFetchNext( hSql(), nFetchRes )
					                                                                                                                                                                       If SqlPrepareAndExecute( hSql(),
							    "SELECT -SUM(decode(a.tip,'LIM',ostb+ostf,0))/100,
							            -SUM(decode(a.tip,'LIM',0, ostb+ostf))/100,
							            -SUM(decode(a.tip,'LIM',ostx,0))/100
							     INTO :nSS1, :nSN, :nLIM
							     FROM accounts a, nd_acc n
							     WHERE n.nd=:ND and n.acc=a.acc and a.tip in ('SN ','SPN','SLN','LIM') ")
							and SqlFetchNext( hSql(), nFetchRes )
							and (nSS1 >0 or nSN1 > 0 )
						                                                                                                                                                                       Set nSS = SalNumberMax(  nSS1 - nLIM, 0)
						                                                                                                                                                                       If KV=KV_KOM
							                                                                                                                                                                       Call SalHideWindow( TXT_KOM )
						                                                                                                                                                                       Else 
							                                                                                                                                                                       Call SalShowWindow( TXT_KOM )
						! Поточний платіж
						                                                                                                                                                                       Set nS = nSS + nSN + IifN( KV=KV_KOM, nSK, 0)
						! Кінцевий платіж
						                                                                                                                                                                       If dSN = DATETIME_Null or dSN < dSN1
							                                                                                                                                                                       Set nSN1 = F_Proc()
						                                                                                                                                                                       Else 
							                                                                                                                                                                       Set nSN1 = 0
							                                                                                                                                                                       Set nSK1 = 0
						                                                                                                                                                                       Set nSN1 = nSN + nSN1
						                                                                                                                                                                       Set nSK1 = nSK + nSK1
						                                                                                                                                                                       Set nS1 = nSS1 + nSN1 +  IifN( KV=KV_KOM, nSK1, 0)
						! Договор истек
						                                                                                                                                                                       If dSS1 <= dSS
							                                                                                                                                                                       Call SalShowWindow( TXT_END )
							                                                                                                                                                                       Set nSS=nSS1
							                                                                                                                                                                       Set nSN=nSN1
							                                                                                                                                                                       Set nSK=nSK1
							                                                                                                                                                                       Set nS = nS1
						                                                                                                                                                                       Else 
							                                                                                                                                                                       Call SalHideWindow( TXT_END )
						!
						                                                                                                                                                                       Call SalSetFocus( nS )
						                                                                                                                                                                       Call SalEnableWindow( pb_F10 )
						!
			!
			                                                                                                                                                                       Function: f_Opl
				                                                                                                                                                                       Description: 
				                                                                                                                                                                       Returns 
					                                                                                                                                                                       Boolean: 
				                                                                                                                                                                       Parameters 
				                                                                                                                                                                       Static Variables 
				                                                                                                                                                                       Local variables 
					                                                                                                                                                                       Number: nSk
					                                                                                                                                                                       Number: S_
					                                                                                                                                                                       Number: nSum
					                                                                                                                                                                       String: sNazn     !! Назначение пл
					!
					                                                                                                                                                                       String: sPASP
					                                                                                                                                                                       String: sPASPN
					                                                                                                                                                                       String: sATRT
					                                                                                                                                                                       String: sDT_R
				                                                                                                                                                                       Actions 
					                                                                                                                                                                       Set S_ = IifN(rb, nS, nS1)
					                                                                                                                                                                       If S_ != NUMBER_Null and S_ > 0
						                                                                                                                                                                       Set nSum = S_ * 100
						                                                                                                                                                                       Set sNazn = 'Сплата боргу за кредит згідно договору №'||CC_ID||
								            ' від '|| SalFmtFormatDateTime( DAT1, 'dd/MM/yyyy' )
						                                                                                                                                                                       If KV = n980
							                                                                                                                                                                       Set nSk = nSKP
						                                                                                                                                                                       Else 
							                                                                                                                                                                       Set nSk = NUMBER_Null
						                                                                                                                                                                       Call cDoc.SetDoc( REF, sTT, 0, nVOB[nORD], Subs(CC_ID,1,10),
								     SalDateCurrent( ),  SalDateCurrent( ), BankDate, BankDate,
								     NLS_2902, NMS_2902, BankMfo, '', KV, nSum, OKPO,
								     NLS_1002, NMS_1002, BankMfo, '', KV, nSum, OKPO, sNazn, '',GetIdOper(),'', nSk ,0)
						                                                                                                                                                                       If NOT cDoc.oDoc()
							                                                                                                                                                                       Return FALSE
						                                                                                                                                                                       Set REF = cDoc.m_nRef
						! Доп рекв ФИО
						                                                                                                                                                                       If NOT SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref,tag,value) VALUES (:REF,'FIO',:NMK )" )
							                                                                                                                                                                       Return FALSE
						                                                                                                                                                                       Set nQ = nSum
						                                                                                                                                                                       If KV != n980
							! Доп рекв для 1-ПБ и #073
							                                                                                                                                                                       If NOT
									(   SqlPrepareAndExecute( hSql(),"select gl.p_Icurval(:KV,:nSum,:BankDate) into :nQ from dual")
									and SqlFetchNext( hSql(), nFetchRes )
									and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref,tag,value) VALUES (:REF,'KOD_B',:sKOD_B )" )
									and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref,tag,value) VALUES (:REF,'KOD_G','804'   )" )
									and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref,tag,value) VALUES (:REF,'KOD_N','8446'  )" )
									and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref,tag,value) VALUES (:REF,'D#73' , '246'   )" )
									)
								                                                                                                                                                                       Return FALSE
						! Доп рекв для больших сумм
						                                                                                                                                                                       If nQ >=5000000
							                                                                                                                                                                       If NOT
									 (  SqlPrepareAndExecute( hSql(),
									     "SELECT k.name, p.SER||' '||p.NUMDOC, p.ORGAN, to_char(p.BDAY,'dd/mm/yyyy')
									      INTO :sPASP, :sPASPN, :sATRT ,:sDT_R
									      from PASSP k, person p where p.rnk=:nRnk and NVL(p.PASSP,1)=k.PASSP (+) " )
									and SqlFetchNext( hSql(), nFetchRes )
									and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref,tag,value) VALUES (:REF,'PASP', :sPASP  )" )
									and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref,tag,value) VALUES (:REF,'PASPN',:sPASPN )" )
									and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref,tag,value) VALUES (:REF,'ATRT', :sATRT  )" )
									and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref,tag,value) VALUES (:REF,'DT_R', :sDT_R  )" )
									and SqlPrepareAndExecute( hSql(),"INSERT INTO operw (ref,tag,value) VALUES (:REF,'ADRES',:sADRES )" )
									  )
								                                                                                                                                                                       Return FALSE
						                                                                                                                                                                       Return TRUE
			                                                                                                                                                                       Function: f_Opl_SN8
				                                                                                                                                                                       Description: 
				                                                                                                                                                                       Returns 
					                                                                                                                                                                       Boolean: 
				                                                                                                                                                                       Parameters 
				                                                                                                                                                                       Static Variables 
				                                                                                                                                                                       Local variables 
					                                                                                                                                                                       Number: nSk
					                                                                                                                                                                       Number: S_
					                                                                                                                                                                       Number: nSum
					                                                                                                                                                                       String: sNazn     !! Назначение пл
					!
					                                                                                                                                                                       String: sPASP
					                                                                                                                                                                       String: sPASPN
					                                                                                                                                                                       String: sATRT
					                                                                                                                                                                       String: sDT_R
				                                                                                                                                                                       Actions 
					                                                                                                                                                                       Set nSum = nSP * 100
					                                                                                                                                                                       Set sNazn = 'Сплата пені за просрочені проценти згідно договору №'||CC_ID||
							            ' від '|| SalFmtFormatDateTime( DAT1, 'dd/MM/yyyy' )
					                                                                                                                                                                       Set nSk = nSKP
					                                                                                                                                                                       Set REF8 = NUMBER_Null
					                                                                                                                                                                       Call cDoc.SetDoc( REF8, sTT, 0, nVOB[1], Subs(CC_ID,1,10),
							     SalDateCurrent( ),  SalDateCurrent( ), BankDate, BankDate,
							     NLS_6397, NMS_6397, BankMfo,'',n980,nSum,GetBankOkpoS(),
							     NLS_1002, NMS_1002, BankMfo,'',n980,nSum,OKPO,sNazn, '',GetIdOper(),'', nSk ,0)
					                                                                                                                                                                       If NOT cDoc.oDoc()
						                                                                                                                                                                       Return FALSE
					                                                                                                                                                                       Set REF8 = cDoc.m_nRef
					                                                                                                                                                                       If NOT cDoc.PayTT (0,REF8,BankDate,sTT,1,n980,SD8_NLS,nSum,n980,SN8_NLS,nSum)
							OR NOT SqlPrepareAndExecute( hSql(),
							      "INSERT INTO operw (ref,tag,value) VALUES (:REF8,'FIO',:NMK )" )
							OR NOT SqlPrepareAndExecute( hSql(),"DELETE From nlk_ref where ref1=:REF8 " )
						                                                                                                                                                                       Return FALSE
					                                                                                                                                                                       Return TRUE
			                                                                                                                                                                       Function: F_Proc
				                                                                                                                                                                       Description: 
				                                                                                                                                                                       Returns 
					                                                                                                                                                                       Number: 
				                                                                                                                                                                       Parameters 
				                                                                                                                                                                       Static Variables 
				                                                                                                                                                                       Local variables 
					                                                                                                                                                                       Number: nKom
					                                                                                                                                                                       Number: nMetr
					                                                                                                                                                                       Number: nAcc
					                                                                                                                                                                       Number: nS
					                                                                                                                                                                       String: sTip
					                                                                                                                                                                       Date/Time: Dat1_
				                                                                                                                                                                       Actions 
					                                                                                                                                                                       Set nS = 0
					                                                                                                                                                                       Set nKom = 0
					                                                                                                                                                                       If SqlPrepareAndExecute( hSqlAux2(), "delete from ACR_INTN ")
							and SqlPrepareAndExecute( hSqlAux2(),
							  "SELECT a.acc, a.tip, i.metr, NVL(i.acr_dat, a.daos-1) + 1
							   INTO :nAcc, :sTip, :nMetr, :Dat1_
							   FROM nd_acc n, accounts a, int_accn i
							   WHERE n.nd=:ND and n.acc=a.acc and a.dazs is null
							     and a.acc=i.acc and
							(i.id=0 and a.tip in ('SS ','SP ','SL ') OR i.id=2 and a.tip='LIM' and i.metr >90 )" )
						                                                                                                                                                                       While SqlFetchNext( hSqlAux2(), nFetchRes )
							                                                                                                                                                                       If sTip = 'LIM' and nMetr > 90
								! ! Начисление комиссий по КD по разным METR > 90
								                                                                                                                                                                       If SqlPLSQLCommand(hSql(),
										   "CC_KOMISSIA (nMetr, nAcc, 2, Dat1_, dSK1, nKom, NUMBER_Null, 1)")
									                                                                                                                                                                       Set nSK1 = -nKom/100
							                                                                                                                                                                       Else 
								                                                                                                                                                                       Call p_intN (nAcc,0,Dat1_,dSN1,NUMBER_Null,1)
						                                                                                                                                                                       If SqlPrepareAndExecute( hSqlAux2(),
								  "SELECT - sum(round(ACRD+ REMI,0)) into :nS from ACR_INTN " )
								and SqlFetchNext( hSqlAux2(), nFetchRes )
						                                                                                                                                                                       Return (nS) / 100
			                                                                                                                                                                       Function: F_DISA1
				                                                                                                                                                                       Description: 
				                                                                                                                                                                       Returns 
				                                                                                                                                                                       Parameters 
				                                                                                                                                                                       Static Variables 
				                                                                                                                                                                       Local variables 
				                                                                                                                                                                       Actions 
					                                                                                                                                                                       Call SalDisableWindow( pb_F10 )
					                                                                                                                                                                       Call SalEnableWindow( pb_F5 )
					!
					                                                                                                                                                                       Call SalDisableWindow( CC_ID )
					                                                                                                                                                                       Call SalDisableWindow( DAT1 )
					                                                                                                                                                                       Call SalDisableWindow( ND )
					                                                                                                                                                                       Call SalDisableWindow( nS )
					                                                                                                                                                                       Call SalDisableWindow( rb )
					                                                                                                                                                                       Call SalDisableWindow( rb1 )
			                                                                                                                                                                       Function: F_SumPr
				                                                                                                                                                                       Description: 
				                                                                                                                                                                       Returns 
					                                                                                                                                                                       Boolean: 
				                                                                                                                                                                       Parameters 
					                                                                                                                                                                       Number: S_
				                                                                                                                                                                       Static Variables 
				                                                                                                                                                                       Local variables 
					                                                                                                                                                                       Number: nKop
					                                                                                                                                                                       Number: nS_980
				                                                                                                                                                                       Actions 
					!
					                                                                                                                                                                       Set ml1 = SumPr( S_ *100, sGENDER, LCV, sUNIT )
					                                                                                                                                                                       Call SalHideWindow( ml1V )
					                                                                                                                                                                       Call SalHideWindow( ml1G )
					                                                                                                                                                                       Set ml1V = STRING_Null
					                                                                                                                                                                       Set ml1G = STRING_Null
					                                                                                                                                                                       Set nORD = 1
					                                                                                                                                                                       If KV != 980
						                                                                                                                                                                       Set nKop = SalNumberMod( S_, IifN ( KV=978,5,1 ) )
						                                                                                                                                                                       Set nORD = 2
						                                                                                                                                                                       If nKop > 0
							                                                                                                                                                                       Set ml1V = SumPr( (S_ - nKop)*100, sGENDER, LCV, sUNIT )
							                                                                                                                                                                       Set nS_980 = SalNumberRound( nKop*100 * KURS )
							                                                                                                                                                                       Set ml1G = SumPr( nS_980, 'F', "грн.", "коп." )
							                                                                                                                                                                       Call SalShowWindow( ml1V )
							                                                                                                                                                                       Call SalShowWindow( ml1G )
							                                                                                                                                                                       Set nORD = 3
						!
						                                                                                                                                                                       If nVOB[nORD] = NUMBER_Null
							                                                                                                                                                                       If SqlPrepareAndExecute( hSql(),
									   "SELECT vob INTO :nVOB["||Str(nORD)||"] FROM tts_vob WHERE tt=:sTT and ORD=:nORD " )
									and SqlFetchNext( hSql(), nFetchRes )
							                                                                                                                                                                       Else 
								                                                                                                                                                                       Set nVOB[nORD] = nVOB[1]
					                                                                                                                                                                       Return TRUE
			                                                                                                                                                                       Function: f_Tochka
				                                                                                                                                                                       Description: 
				                                                                                                                                                                       Returns 
				                                                                                                                                                                       Parameters 
					                                                                                                                                                                       Window Handle: hWnd
				                                                                                                                                                                       Static Variables 
					                                                                                                                                                                       String: sTmp
				                                                                                                                                                                       Local variables 
				                                                                                                                                                                       Actions 
					                                                                                                                                                                       Set sTmp=SalStrRepeatX( ' ', 20 )
					                                                                                                                                                                       Call SalGetWindowText ( hWnd, sTmp, 20 )
					                                                                                                                                                                       While SalStrScan(sTmp, sDecimal2) > 0
						                                                                                                                                                                       Set sTmp = SalStrReplaceX(sTmp,SalStrScan(sTmp,sDecimal2),1,sDecimal)
					                                                                                                                                                                       Call SalFmtStrToField ( hWnd, sTmp, TRUE)
		                                                                                                                                                                       Window Parameters 
			                                                                                                                                                                       Number: nMode ! 297
			                                                                                                                                                                       Number: nPar  ! 0 (NUMBER_Null) или реф КД
			                                                                                                                                                                       String: strPar01 ! Операция CCK
			                                                                                                                                                                       String: strPar02 ! Счет 2902 для инд догов
		                                                                                                                                                                       Window Variables 
			                                                                                                                                                                       String: SD8_NLS
			                                                                                                                                                                       String: SN8_NLS
			                                                                                                                                                                       Number: SN8_OST
			! String: NLS_6397
			                                                                                                                                                                       String: NMS_6397
			                                                                                                                                                                       Number: nRnk
			                                                                                                                                                                       Number: ACC8
			                                                                                                                                                                       String: sADRES
			!
			                                                                                                                                                                       Number: nS_OLD
			                                                                                                                                                                       Number: nORD
			                                                                                                                                                                       String: sSEL
			                                                                                                                                                                       String: CC_FL_PR !! Флаг начисления % проводками в ТОБО
			                                                                                                                                                                       String: sUNIT
			                                                                                                                                                                       String: sGENDER
			                                                                                                                                                                       String: sSqlK
			                                                                                                                                                                       String: sSql2
			                                                                                                                                                                       String: sSql1
			                                                                                                                                                                       String: sSql
			                                                                                                                                                                       String: NMS_1002
			                                                                                                                                                                       String: NMS_2902
			                                                                                                                                                                       String: sTT
			                                                                                                                                                                       Number: n980
			                                                                                                                                                                       Number: nQ
			                                                                                                                                                                       String: BankMfo
			                                                                                                                                                                       String: sKOD_B
			                                                                                                                                                                       Date/Time: BankDate
			                                                                                                                                                                       Number: nVOB[*]
			                                                                                                                                                                       String: sDecimal2  ! симв десятичной точки alt
			                                                                                                                                                                       String: sDecimal   ! симв десятичной точки
			                                                                                                                                                                       : cDoc
			                                                                                                                                                                       Number: KV_KOM
			                                                                                                                                                                       String: TOBO
			                                                                                                                                                                       String: s6397
			! Boolean: FL_SN1_Add
		                                                                                                                                                                       Message Actions 
			                                                                                                                                                                       On SAM_Create
				                                                                                                                                                                       Set nVOB[1] = NUMBER_Null
				                                                                                                                                                                       Set nVOB[2] = NUMBER_Null
				                                                                                                                                                                       Set nVOB[3] = NUMBER_Null
				                                                                                                                                                                       Set n980 = GetBaseVal()
				                                                                                                                                                                       Set nORD = 1
				                                                                                                                                                                       Set TXT_KOM ='Комісія до суми платежу НЕ додається !'
				                                                                                                                                                                       Set TXT_END = "Термін дії угоди завершено !"
				                                                                                                                                                                       Call SalHideWindow( TXT_KOM )
				                                                                                                                                                                       Set UVAGA = 'У В А Г А,  В А Л Ю Т А ! '
				                                                                                                                                                                       Call F_VALUTA( n980 )
				                                                                                                                                                                       Set sDecimal =SalStrMidX(SalNumberToStrX(1.1,1),1,1)
				                                                                                                                                                                       Set sDecimal2 = IifS ( sDecimal = '.', ',', '.' )
				                                                                                                                                                                       Set sSEL =
						"SELECT d.nd,d.cc_id,d.sdate,d.wdate,c.NMK,c.okpo,c.rnk,c.ADR,
						      ad.KV, t.LCV, t.NAME, t.UNIT, t.GENDER, a.acc
						 INTO :ND,:CC_ID,:DAT1,:dSS1,:NMK,:OKPO,:nRnk,:sADRES,
						      :KV, :LCV, :NAMEV, :sUNIT, :sGENDER, :ACC8
						 FROM cc_deal d, customer c, cc_add ad, tabval t, accounts a
						 WHERE d.ND=ad.ND and ad.KV=t.KV and d.sos>9 and d.sos<15 and d.rnk=c.rnk
						   and a.nls like '8999_'||d.nd and a.kv=ad.kv and "
				                                                                                                                                                                       Set sSql1 = sSEL || " d.cc_id=:CC_ID and d.SDATE = :DAT1 "
				                                                                                                                                                                       Set sSql2 = sSEL || " d.nd=:ND "
				                                                                                                                                                                       Call F_DISA ()
				                                                                                                                                                                       Set BankMfo =  GetBankMfo()
				                                                                                                                                                                       Set BankDate = GetBankDate()
				                                                                                                                                                                       Set sKOD_B =  GetGlobalOption('1_PB')
				                                                                                                                                                                       Set sTT = strPar01
				! ---1 счет кассы
				! Взять счет кассы и его наименование сначала из карточки операции CCK
				                                                                                                                                                                       If SqlPrepareAndExecute( hSql(),
						  "SELECT t.nlsb,a.nms INTO :NLS_1002,:NMS_1002
						   from tts t,accounts a where t.tt=:sTT and a.kv=:n980 and t.nlsb=a.nls")
						and SqlFetchNext( hSql(), nFetchRes )
				! если нет , то из из INI-файла
				                                                                                                                                                                       Else 
					! Взять счет кассы и его наименование из INI-файла
					                                                                                                                                                                       If SqlPrepareAndExecute( hSql(),
							  "SELECT substr(pul.Get_Mas_Ini_Val('CASH'),1,14) into :NLS_1002 from dual" )
							and SqlFetchNext( hSql(), nFetchRes )
							and SqlPrepareAndExecute( hSql(),"SELECT nms INTO :NMS_1002 from accounts where kv=:n980 and nls=:NLS_1002")
							and SqlFetchNext( hSql(), nFetchRes )
					                                                                                                                                                                       Else 
						                                                                                                                                                                       Call SalMessageBox('Не определен счет кассы, операция '||sTT, "Ошибки в настройках ! ", MB_IconStop)
						                                                                                                                                                                       Call SalDestroyWindow(hWndForm)
				! ---2 счет 2902 индив или общий
				                                                                                                                                                                       Set NLS_2902 = STRING_Null
				! Ecли по одному дог
				                                                                                                                                                                       If nPar >0
					                                                                                                                                                                       Set ND = nPar
					                                                                                                                                                                       Call SalDisableWindow( CC_ID )
					                                                                                                                                                                       Call SalDisableWindow( DAT1 )
					                                                                                                                                                                       Call SalDisableWindow( pb_F1 )
					! и задан индив 2902
					                                                                                                                                                                       If strPar02 !=STRING_Null
						                                                                                                                                                                       Set NLS_2902 = SalStrTrimX( strPar02 )
				                                                                                                                                                                       If NLS_2902 = STRING_Null
					                                                                                                                                                                       Set sSqlK =
							"SELECT  Nvl(t.SK,32), v.vob, t.nlsa, Substr(a.nms,1,38 )
							    into  :nSKP,  :nVOB[1], :NLS_2902, :NMS_2902
							    from tts t, tts_vob v, accounts a
							    where a.kv=:n980 and a.nls=t.NLSa and v.tt=t.tt and t.tt=:sTT and v.ORD=1 "
				                                                                                                                                                                       Else 
					                                                                                                                                                                       Set sSqlK =
							"SELECT  Nvl(t.SK,32), v.vob, Substr(a.nms,1,38 )
							    into  :nSKP,  :nVOB[1], :NMS_2902
							    from tts t, tts_vob v, accounts a
							    where a.kv=:n980 and a.nls=:NLS_2902 and v.tt=t.tt and t.tt=:sTT and v.ORD=1 "
				                                                                                                                                                                       If SqlPrepareAndExecute( hSql(),sSqlK) and not SqlFetchNext( hSql(), nFetchRes )
					                                                                                                                                                                       Call SalMessageBox('Не определен Счет гашения, операция '||sTT, "Ошибки в настройках ! ", MB_IconStop)
					                                                                                                                                                                       Call SalDestroyWindow(hWndForm)
				! !!! Флаг начисления % проводками
				                                                                                                                                                                       Set CC_FL_PR = '0'
				! Call SalHideWindow( pb_SN1F )
				! в ТОБО из ini-файла
				                                                                                                                                                                       If SqlPrepareAndExecute(hSql(),
						"SELECT substr(pul.Get_Mas_Ini_Val('KOD_TOBO'),1,12),
						        substr(pul.Get_Mas_Ini_Val('CC_FL_PR'),1,1)
						 INTO :TOBO, :CC_FL_PR from dual ")
						and SqlFetchNext(hSql(), nFetchRes)
				                                                                                                                                                                       If CC_FL_PR != '1'
					                                                                                                                                                                       Set CC_FL_PR = GetGlobalOption('CC_FL_PR')
				! общий 6397 NLX
				! NLS_GB_TOBO
				                                                                                                                                                                       If SqlPrepareAndExecute( hSql(),
						  "Select a.nls,substr(a.nms,1,380)
						   into :NLS_6397,:NMS_6397
						   from accounts a, params p
						   where a.kv= :n980 and a.dazs is null and a.nls=p.val and p.par='CC_NLX_G' ")
						and not SqlFetchNext( hSql(), nFetchRes )
					                                                                                                                                                                       Call SalMessageBox('Не определен Счет доходов по ПЕНЕ !', "Ошибки в настройках ! ", MB_IconStop)
					                                                                                                                                                                       Call SalDestroyWindow(hWndForm)
				                                                                                                                                                                       Set s6397 = NLS_6397
				                                                                                                                                                                       If SqlPrepareAndExecute( hSql(),
						  "SELECT a.nls,substr(a.nms,1,380) into :NLS_6397,:NMS_6397
						   from accounts a, NLS_GB_TOBO p
						   where a.kv= :n980 and a.dazs is null and a.nls=p.nlst and p.nlsg=:s6397 and p.tobo=:TOBO ")
						and SqlFetchNext( hSql(), nFetchRes )
				! If CC_FL_PR = '1'
					                                                                                                                                                                                      Call SalShowWindow( pb_SN1F )
				                                                                                                                                                                       Call F_NULL()
				                                                                                                                                                                       If nPar >0
					                                                                                                                                                                       Call SalSendMsg( pb_F1, SAM_Click, 0, 0 )
				                                                                                                                                                                       Call SalMapEnterToTab( TRUE )
	! !!!!
	Table Window: frmOpZalAcc
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.438"
				Top:    0.49"
				Width:  21.567"
				Width Editable? Class Default
				Height: 6.298"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 20000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.881"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							If Kol_Ins = 0
								Call SalSendMsg(hWndForm, UM_Insert, 0, 0)
								Set Kol_Ins = Kol_Ins  + 1 
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.567"
						Top:    0.143"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.083"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 46075
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.071"
						Begin Y:  -0.031"
						End X:  4.071"
						End Y:  0.427"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.583"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.6"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Карточка Счета'
						On SAM_Click
							If colAcc != NUMBER_Null
								Call OperWithAccount(ALL_ACCOUNTS, colAcc, 0, 
										 IifN(nTip_Ur=90, ACCESS_READONLY, ACCESS_FULL))
				Pushbutton: pb_SpecPar
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.083"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_spec.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Карточка спец.парметров счета'
						On SAM_Click
							If colAcc != NUMBER_Null
								! Функция "Спецпараметры счета"
										ShowAccSpecParams(colAcc,nMode)
										nMode=0(редактировать)/ACCESS_READONLY(просмотр)
								Call ShowAccSpecParams(colAcc, IifN(nTip_Ur=90, ACCESS_READONLY, 0))
				!
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.583"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 46076
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.583"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 46077
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pb2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Book.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Паспорт клиента-залогодателя'
						On SAM_Click
							Set nTmp = SalStrToNumber(GetValueStr("
									    SELECT custtype
									    FROM customer
									    WHERE rnk=" || Str(colRnk)))
							Set nFlCustEdit = IifN(nTip_Ur=90, 
									  CVIEW_ReadOnly | CVIEW_Accounts | AVIEW_ReadOnly, 
									  CVIEW_ReadOnly | CVIEW_Accounts )
							If nTmp = 2
								Call EditCustCorps(colRnk, nFlCustEdit, hWndMDI)
							Else If nTmp = 3
								Call EditCustPerson(colRnk, nFlCustEdit, hWndMDI)
							Else If nTmp = 1
								Call EditCustBanks(colRnk, nFlCustEdit, hWndMDI)
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Background Text: Реф.КД
					Resource Id: 46078
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   3.083"
						Top:    0.179"
						Width:  1.117"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: dNd
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   3.083"
							Top:    0.31"
							Width:  1.114"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Background Text: № КД
					Resource Id: 46080
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.283"
						Top:    0.179"
						Width:  1.217"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: CC_ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.283"
							Top:    0.321"
							Width:  1.371"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Background Text: Рег.№ 
					Resource Id: 46081
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.683"
						Top:    0.179"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: dRNK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.683"
							Top:    0.321"
							Width:  1.114"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Background Text: Ссудозаемщик
					Resource Id: 46079
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   6.783"
						Top:    0.179"
						Width:  2.957"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Background Text: Дата 
					Resource Id: 63817
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   10.983"
						Top:    0.179"
						Width:  1.417"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: dNMK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.783"
							Top:    0.321"
							Width:  3.983"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.883"
							Top:    0.321"
							Width:  1.583"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Pushbutton: pbZ
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.083"
						Top:    0.155"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Tudasuda.bmp
					Picture Transparent Color: White
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Gray
					Message Actions
						On SAM_Create
							Set strTip = 'Зв`язки рах.забезпечення та боргу'
						On SAM_Click
							Call Bars017r1 
									( NUMBER_Null, NUMBER_Null, NUMBER_Null,
									 " WHERE  ( KU_109.ND2 = "||Str(nNd) || " or KU_109.ND1 = "||Str(nNd)||")" )
				!
				Data Field: dKVK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   3.083"
							Top:    0.571"
							Width:  1.117"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Вал долга' )
				Data Field: dNLSK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.283"
							Top:    0.571"
							Width:  2.533"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Счет долга' )
				Data Field: dNMSK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.783"
							Top:    0.571"
							Width:  3.983"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Наименование счета долга' )
		Contents
			Column: colNdz
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						дог.
						зал.
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.667"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CC_IDZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № догов 
						забезпеч
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.233"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SDATZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата догов
						забезпеч
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.35"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MDATZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Забезп.
						діє до...
						(Дата)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.35"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NREE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № в 
						реєстрі
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.233"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colRnk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег №
						забезчеч
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: Zalogodatel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Забезпеченець
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.45"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If colNdz = NUMBER_Null
							Set sTmp=Str(colRnk)
							! Call FunNSIGet('CUSTOMER','NMK',sTmp,Zalogodatel)
							Call FunNSIGetFiltered
									("CUSTOMER","NMK","date_off is null", sTmp, Zalogodatel)
							Set colRnk=Val(sTmp)
					On SAM_SetFocus
						If colRnk = NUMBER_Null
							Set colRnk=Val(dRNK)
							Set Zalogodatel=dNMK
						If IDZ = NUMBER_Null
							Set IDZ=GetUserId()
			Column: colVidZal
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вид 
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Create
						Call SqlPrepareAndExecute(hSql(),
								    "SELECT name,pawn, substr(nbsz,1,3),s031 INTO :sTmp,:nPawn,:sTmp3,:nS031
								     FROM cc_pawn WHERE d_close is null ORDER BY NBSZ, S031, NAME")
						Set nTmp = 0
						Call SalArraySetUpperBound(mPawn, 1, -1)
						Call SalListClear(hWndItem)
						While SqlFetchNext(hSql(), nFetchRes)
							Call SalListAdd(hWndItem, sTmp)
							Set mPawn[nTmp] = nPawn
							Set mS031[nTmp] = nS031
							Set sNbs3[nTmp] = sTmp3
							Set nTmp = nTmp+1
					On SAM_Validate
						Set nTmp = SalListQuerySelection(hWndItem)
						If nTmp >= 0
							Set colPawn = mPawn[nTmp]
							Set colS031 = mS031[nTmp]
							! Изменение вида залога 
							If colAcc !=NUMBER_Null 
								If SqlPrepareAndExecute( hSql(),"UPDATE PAWN_ACC SET pawn=:colPawn WHERE acc="||Str(frmOpZalAcc.colAcc)  )
										and SqlCommit(hSql())
						Else
							Set colPawn = 0
							Set colS031 = 0
						Call SalSetFocus( colDep )
						Return VALIDATE_Ok
			Column: colDep
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ном.
						дог.
						деп.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  0.667"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						! If colNdz = NUMBER_Null
						Set sTmp=STRING_Null
						If colS031=15
							! Call FunNSIGet('CUSTOMER','NMK',sTmp,Zalogodatel)
							Call FunNSIGetFiltered
									("DPT_ZAL","DEPOSIT_ID","rnk="||Str(colRnk), sTmp, colDep)
						Set colDep=sTmp
						Call SalTblSetRowFlags ( hWndForm, lParam, ROW_Edited, TRUE )
					On SAM_Validate
						Call SqlPrepareAndExecute(hSql(), "
								     SELECT deposit_id
								     INTO :colDep
								     FROM DPT_ZAL
								     WHERE rnk=:colRnk and deposit_id=:colDep")
						If not SqlFetchNext(hSql(), nFetchRes)
							Call SalMessageBox("Не найден ном.договора " ||
									     colDep, 'Ошибка', MB_IconExclamation)
							Set colDep=STRING_Null
							! Return VALIDATE_Ok
						Return VALIDATE_Ok
			Column: colMestoZal
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Місце
						знаходж
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.3"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Create
						Call SqlPrepareAndExecute(hSql(), T("
								     SELECT name,mpawn
								     INTO :sTmp,:nPawnM
								     FROM cc_mpawn
								     ORDER by mpawn"))
						Set nTmp = 0
						Call SalArraySetUpperBound(mPawnM, 1, -1)
						Call SalListClear(hWndItem)
						While SqlFetchNext(hSql(), nFetchRes)
							Call SalListAdd(hWndItem, sTmp)
							Set mPawnM[nTmp] = nPawnM
							Set nTmp = nTmp+1
					On SAM_Validate
						Set nTmp = SalListQuerySelection(hWndItem)
						If nTmp >= 0
							Set colPawnM = mPawnM[nTmp]
							! Изменение места залога 
							If colAcc !=NUMBER_Null 
								If SqlPrepareAndExecute( hSql(),"UPDATE PAWN_ACC SET mpawn=:colPawnM WHERE acc=:nAcc" )
										and SqlCommit(hSql())
						Else
							Set colPawnM = 0
						Call SalSetFocus( colSumZal )
						Return VALIDATE_Ok
			Column: PR_12
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Прз
						1/2
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmp12 = PR_12
					On SAM_KillFocus
						If PR_12 != NUMBER_Null and PR_12 != 1 and PR_12 !=2
							Set PR_12 = nTmp12
					On SAM_Validate
						If PR_12 != NUMBER_Null and PR_12 != 1 and PR_12 !=2
							Set PR_12 = nTmp12
			Column: SV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума забезп
						справедл
						(додатково)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.3"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colSumZal_1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума забезп
						балансова
						поточна
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.3"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colSumZal
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: + Доб,  - Зменш
						суму забезп
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.433"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If not SalIsValidDecimal(hWndItem, 15, 2) 
							Call SalMessageBox("Неверный формат суммы", "Ошибка", MB_IconExclamation)
							Return VALIDATE_Cancel
						If colSumZal !=0 and colSumZal !=NUMBER_Null
							If NAZN = STRING_Null
								If colSumZal>0
									Set NAZN =  "Оприбуткування"
									Set colVob=VOB9_P
								Else
									Set NAZN = "Списання"
									Set colVob=VOB9_R
								Set NAZN = NAZN || " застави " || IifS(CC_IDZ=STRING_Null," ", " згідно договору № ") || CC_IDZ  || IifS(SDATZ=DATETIME_Null," ", " від ")  || SalFmtFormatDateTime(SDATZ,'dd/MM/yyyy') || " для кред.угоди " || CC_ID || ' від '|| SalFmtFormatDateTime(DAT1,'dd/MM/yyyy')
						Else
							Set NAZN = STRING_Null
			Column: colValZal
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 3
				Data Type: String
				Justify: Center
				Width:  0.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? No
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If SalIsValidInteger(hWndItem)
							Set sTmp = 'kv'
						Else
							Set sTmp = 'lcv'
							Set colValZal = SalStrUpperX(colValZal)
						Call SqlPrepareAndExecute(hSql(), "
								     SELECT kv,lcv
								     INTO :colKv,:colValZal
								     FROM tabval
								     WHERE " || sTmp || "=:colValZal")
						If not SqlFetchNext(hSql(), nFetchRes)
							Call SalMessageBox("Не найден код валюты " ||
									     colValZal, 'Ошибка', MB_IconExclamation)
							Return VALIDATE_Cancel
						Set colGrp=Val(sGr)
						Set colIsp=GetUserId()
						Return VALIDATE_Ok
			Column: colNls
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 14
				Data Type: String
				Justify: Left
				Width:  1.614"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If not SalIsValidInteger(hWndItem)
							Call SalMessageBox("Нецифра в номере счета", "Ошибка", MB_IconExclamation)
							Return VALIDATE_Cancel
						Set colNls = KeyAccount(sBankMfo, colNls)
						Call F_NEW()
						Return VALIDATE_Ok
					On SAM_SetFocus
						If colNdz = NUMBER_Null
							If SqlPrepareAndExecute(hSqlAux(),
									"SELECT S_CC_DEAL.NEXTVAL INTO :colNdz FROM dual") 
									and  SqlFetchNext(hSqlAux(), nFetchRes)
						If SalIsNull(colNls)
							If SqlPrepareAndExecute(hSqlAux(),
									  "SELECT BARS.F_NEWNLS2( :nAcc8 , 'ZAL', 
									    decode (:colPawnM, 1,nbsz, 2,nvl(nbsz2,nbsz), nvl(nbsz3,nbsz) ), :colRnk, Null)
									   INTO :colNls FROM cc_pawn where pawn=:colPawn ") 
									and SqlFetchNext(hSqlAux(), nFetchRes)
							Call F_NEW()
			Column: OB22
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Пар.
						OB22
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 2
				Data Type: String
				Justify: Center
				Width:  0.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If NOT 
								( OB22 != STRING_Null  or colNls='N/A' or colNls='' )
							If SqlPrepareAndExecute( hSql(),
									"SELECT min(OB22) INTO :OB22 FROM SB_OB22 
									 WHERE d_close is null and r020='"|| Subs(colNls,1,4) ||"'"  )
									and not SqlFetchNext(hSql(), nFetchRes)
					On SAM_Validate
						If OB22 != STRING_Null
							If SqlPrepareAndExecute( hSql(),
									"SELECT 1 FROM SB_OB22 WHERE d_close is null and r020='"|| Subs(colNls,1,4) ||"'"  ) 
									and not SqlFetchNext(hSql(), nFetchRes)
								Call SalMessageBox("Недопустимы пар.ОБ22","Ошибка", MB_IconExclamation)
								Return VALIDATE_Cancel
						Return VALIDATE_Ok
					On SAM_DoubleClick
						If NOT (  colNls='N/A' or colNls='' )
							Set sTmp=OB22 
							Call FunNSIGetFiltered 
									("SB_OB22",
									 "TXT", 
									 "r020='"|| Subs(colNls,1,4) ||"'" ,
									 sTmp,
									 sErrTxt )
							If sTmp != OB22 and sTmp != STRING_Null
								Set OB22 = sTmp 
								Call SalTblSetRowFlags ( frmOpZalAcc, SalTblQueryContext ( frmOpZalAcc ), ROW_Edited, TRUE )
			Column: colGrp
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Гр.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.583"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colIsp
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вик.
						по
						рах.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: IDZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Инс.
						по
						обс.
				Visible? No
				Editable? Yes
				Maximum Data Length: 14
				Data Type: Number
				Justify: Right
				Width:  0.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colAcc
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № счета
						внутр
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colPawn
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						залога
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colS031
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						залога НБУ
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colPawnM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код места
						залога
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colKv
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						валюты
				Visible? No
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_NEW()
						Return VALIDATE_Ok
			Column: colVob
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вид
						док
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 3
				Data Type: Number
				Justify: Right
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAZN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Призначення платежу
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Set sTmp=NAZN
						Call Sel017t( frmOpZalAcc, 'Редактирование назначения пл по залогу', bTmp, sTmp, TRUE )
						If bTmp
							Set NAZN = sTmp
			Column: NMS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва рах
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colFL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Флаг
				Visible? No
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: colPap
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: а/п
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nCol
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Флаг
				Visible? No
				Editable? No
				Maximum Data Length: 3
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? No
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_NEW
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If SqlPrepareAndExecute( hSql(), 
							"SELECT  a.acc,  t.lcv, a.ostB/100, c.rnk, c.nmk, a.grp, a.isp, a.nms,a.pap 
							    INTO :frmOpZalAcc.colAcc, :frmOpZalAcc.colValZal, :frmOpZalAcc.colSumZal_1,          
							         :frmOpZalAcc.colRnk, :frmOpZalAcc.Zalogodatel,
							         :frmOpZalAcc.colGrp, :frmOpZalAcc.colIsp, :frmOpZalAcc.NMS,
							         :frmOpZalAcc.colPap
							    FROM accounts a, tabval t, customer c, cust_acc u 
							    WHERE a.acc=u.acc and c.rnk=u.rnk and a.kv=t.kv and u.rnk=c.rnk 
							        and a.nls=:frmOpZalAcc.colNls and a.kv=:frmOpZalAcc.colKv") 
							and not SqlFetchNext(hSql(), nFetchRes)
						Set NMS = Subs(frmOpZalAcc.Zalogodatel || ' Забезпечення.',1,38)
						Set frmOpZalAcc.colAcc = NUMBER_Null
		Window Parameters
			Number: nTip_Ur
			Number: nNd
			String: sGr
			String: sRNK
			Number: ACCS
		Window Variables
			Number: nGrp
			Number: nTmp12
			String: sRP_12
			String: sSel1 
			!
			Number: Kol_Ins
			String: sBlok
			String: sBlok1
			String: sBlok2
			String: sBlok3
			String: sTmp
			String: sSql
			Boolean: bTmp
			String: sTmp3
			String: sSql1
			Number: nTmp
			Number: nId
			Date/Time: dDat
			Number: nFetchRes
			Number: nRnk
			Number: mRnk[*]
			Number: nPawn
			Number: mPawn[*]
			Number: nS031
			Number: mS031[*]
			String: sNbs3[*]
			Number: nPawnM
			Number: mPawnM[*]
			Number: nKv
			Number: mKv[*]
			String: sBankMfo
			String: CC_TOBO_
			String: rTOBO_
			String: sNaz
			: cDoc
				Class: cDoc
			String: sNlsK
			Number: nDk
			Number: nAcc
			Number: VOB9_P
			Number: VOB9_R
			Number: nRet
			Number: nAcc8
			Number: nFlCustEdit
			String: sErrTxt
		Message Actions
			On SAM_Create
				Call ShowApdVersion('04')
				Set frmOpZalAcc.strPrintFileName = 'DZal'
				! If SqlPrepareAndExecute( hSql(),"SELECT val from params where par='ZAL_DPT' and val='1' " )
						and not SqlFetchNext(hSql(), nFetchRes)
					                             Call SalHideWindow ( colDep )
				If nTip_Ur >= 80
					Call SalDisableWindow( pbIns )
					! Call SalDisableWindow( pbDel )
					Call SalDisableWindow( pbUpdate )
					Call SalDisableWindow( pbZ )
				Set frmOpZalAcc.nTabInstance = 1
				Set nFlags = GT_NoDel
				Set nId = GetUserId()
				Set dDat = GetBankDate()
				Set sBankMfo = GetBankMfo()
				If (nNd = NUMBER_Null or nNd = 0) and ACCS > 0
					If SqlPrepareAndExecute( hSql(),
							  "SELECT NVL(max(n.nd),0) INTO :dNd from
							   (select acc,nd from  nd_acc union all select acc,nd from acc_over) n
							   where n.acc=:ACCS" )
							and not SqlFetchNext(hSql(), nFetchRes)
						Set dNd = 0
				Else
					Set dNd = nNd
				Set dRNK=sRNK
				! Set Kol_Ins = 0
				If SqlPrepareAndExecute(hSql(),"SELECT to_number(val) into :VOB9_P from params where par='VOB9_P' ")
						and not SqlFetchNext(hSql(), nFetchRes)
					Set VOB9_P=6
				If SqlPrepareAndExecute(hSql(),"SELECT to_number(val) into :VOB9_R from params where par='VOB9_R' ")
						and not SqlFetchNext(hSql(), nFetchRes)
					Set VOB9_R=6
				!
				Set sSql1 = "SELECT Substr(tobopack.GetTOBOParam('NLS_9900'),1,15),c.NMK INTO :sNlsK,:dNMK FROM customer c WHERE c.rnk="||sRNK
				If SqlPrepareAndExecute(hSql(),sSql1) and not SqlFetchNext(hSql(), nFetchRes)
					Call SalMessageBox('Не знайдено GetTOBOParam(NLS_9900)', 'Помилка', MB_IconExclamation)
					Call SalDestroyWindow(hWndForm)
					Return FALSE
				If sGr = 'CP'
					If SqlPrepareAndExecute(hSql(),
							"SELECT Cp_ID, DAT_em, kv, (select nmk from customer where rnk=cp_kod.rnk)
							 INTO :CC_ID, :DAT1, :dKVK , :dNMSK
							 FROM cp_kod  WHERE id = :dNd ")
							and SqlFetchNext(hSql(), nFetchRes)
					Call SalSetWindowText(hWndForm,'Забезпечення по ЦП Вн.№=' || Str(dNd))
					Set frmOpZalAcc.strSqlPopulate =
							 "SELECT 1, decode(A.dazs,null,0,1),A.acc, A.nls, A.kv, T.lcv,abs(A.ostB/100),
							         SZ.pawn, SZ.mpawn, SZ.nree, SZ.ndz, SZ.idz, SZ.deposit_id, SZ.cc_idz, SZ.sdatz,
							         C.rnk, C.nmk,  A.grp, A.isp, A.nms,A.pap, null, SZ.SV/100, a.OB22 ,a.mdate
							  INTO :frmOpZalAcc.colFL, :frmOpZalAcc.nCol, :frmOpZalAcc.colAcc,
							       :frmOpZalAcc.colNls,:frmOpZalAcc.colKv,
							       :frmOpZalAcc.colValZal,:frmOpZalAcc.colSumZal_1,
							       :frmOpZalAcc.colPawn,:frmOpZalAcc.colPawnM, :frmOpZalAcc.NREE,
							       :frmOpZalAcc.colNdz, :frmOpZalAcc.IDZ,:frmOpZalAcc.colDep,
							       :frmOpZalAcc.CC_IDZ, :frmOpZalAcc.SDATZ,
							       :frmOpZalAcc.colRnk, :frmOpZalAcc.Zalogodatel,
							       :frmOpZalAcc.colGrp, :frmOpZalAcc.colIsp, :frmOpZalAcc.NMS,
							       :frmOpZalAcc.colPap, :frmOpZalAcc.PR_12, :frmOpZalAcc.SV,:hWndForm.frmOpZalAcc.OB22,
							       :frmOpZalAcc.MDATZ
							  FROM accounts A, cp_accp P, tabval T, customer C, pawn_acc SZ
							  WHERE SZ.acc(+) = A.acc AND a.rnk=C.rnk AND A.kv=T.kv AND  A.acc=P.acc and id =  " || Str(dNd)
				Else
					! KeyAccount(sBankMfo, '8999_'||d.nd)
					If SqlPrepareAndExecute(hSql(),
							  "SELECT d.CC_ID,d.SDATE, a.acc
							   INTO :CC_ID,:DAT1, :nAcc8 FROM cc_deal d, accounts a, nd_acc n
							   WHERE d.nd=:dNd and d.nd=n.nd and n.acc=a.acc and a.tip=(select decode(vidd,1,'LIM',2,'LIM',3,'LIM',11,'LIM',12,'LIM',13,'LIM','SS ') from cc_deal where nd=d.nd ) ")
							and SqlFetchNext(hSql(), nFetchRes)
					If SqlPrepareAndExecute(hSql(), "SELECT kv,nls,nms INTO :dKVK,:dNLSK,:dNMSK FROM accounts where acc=:ACCS")
							and SqlFetchNext(hSql(), nFetchRes)
					Call SalSetWindowText(hWndForm,'Забезпечення по КД Реф.' || Str(dNd))
					! Set frmOpZalAcc.strSqlPopulate =
							 "SELECT distinct 1,decode(A.dazs,null,0,1), A.acc, A.nls, A.kv, T.lcv,abs(A.ostB/100),
							         SZ.pawn, SZ.mpawn, SZ.nree, SZ.ndz, SZ.idz, SZ.deposit_id, SZ.cc_idz, SZ.sdatz,
							         C.rnk, C.nmk,  A.grp, A.isp, A.nms,A.pap, P.PR_12, SZ.SV/100, a.OB22 ,a.mdate
							  INTO :frmOpZalAcc.colFL,  :frmOpZalAcc.nCol, :frmOpZalAcc.colAcc,
							       :frmOpZalAcc.colNls,:frmOpZalAcc.colKv,
							       :frmOpZalAcc.colValZal,:frmOpZalAcc.colSumZal_1,
							       :frmOpZalAcc.colPawn,:frmOpZalAcc.colPawnM, :frmOpZalAcc.NREE,
							       :frmOpZalAcc.colNdz, :frmOpZalAcc.IDZ,:frmOpZalAcc.colDep,
							       :frmOpZalAcc.CC_IDZ, :frmOpZalAcc.SDATZ,
							       :frmOpZalAcc.colRnk, :frmOpZalAcc.Zalogodatel,
							       :frmOpZalAcc.colGrp, :frmOpZalAcc.colIsp, :frmOpZalAcc.NMS,
							       :frmOpZalAcc.colPap, :frmOpZalAcc.PR_12, :frmOpZalAcc.SV,:hWndForm.frmOpZalAcc.OB22,
							       :frmOpZalAcc.MDATZ
							  FROM accounts A, cc_accp P, tabval T, customer C, pawn_acc SZ
							  WHERE A.acc = SZ.acc(+) 
							    AND a.rnk = C.rnk 
							    AND A.kv = T.kv 
							    AND A.acc = P.acc 
							    and  ( p.nd = "||Str(frmOpZalAcc.dNd )|| 
							      " OR p.accs = "|| Str(frmOpZalAcc.ACCS) || 
							       ")"
					! Set sSel1 = 
							"(select * from cc_accp 
							  where (accs in (select accs from cc_accp where nd ="||Str(dNd)||" )
							      or accs = "||Str(ACCS) || " and dNd=0 ) ) p "
					If dNd = 0 
						Set frmOpZalAcc.strSqlPopulate =
								 "SELECT distinct 1,decode(A.dazs,null,0,1), A.acc, A.nls, A.kv, T.lcv,abs(A.ostB/100),
								         SZ.pawn, SZ.mpawn, SZ.nree, SZ.ndz, SZ.idz, SZ.deposit_id, SZ.cc_idz, SZ.sdatz,
								         C.rnk, C.nmk,  A.grp, A.isp, A.nms,A.pap, P.PR_12, SZ.SV/100, a.OB22 ,a.mdate
								  INTO :frmOpZalAcc.colFL,  :frmOpZalAcc.nCol, :frmOpZalAcc.colAcc,
								       :frmOpZalAcc.colNls,:frmOpZalAcc.colKv,
								       :frmOpZalAcc.colValZal,:frmOpZalAcc.colSumZal_1,
								       :frmOpZalAcc.colPawn,:frmOpZalAcc.colPawnM, :frmOpZalAcc.NREE,
								       :frmOpZalAcc.colNdz, :frmOpZalAcc.IDZ,:frmOpZalAcc.colDep,
								       :frmOpZalAcc.CC_IDZ, :frmOpZalAcc.SDATZ,
								       :frmOpZalAcc.colRnk, :frmOpZalAcc.Zalogodatel,
								       :frmOpZalAcc.colGrp, :frmOpZalAcc.colIsp, :frmOpZalAcc.NMS,
								       :frmOpZalAcc.colPap, :frmOpZalAcc.PR_12, :frmOpZalAcc.SV,:hWndForm.frmOpZalAcc.OB22,
								       :frmOpZalAcc.MDATZ
								  FROM accounts A, cc_accp P, tabval T, customer C, pawn_acc SZ
								  WHERE A.acc = SZ.acc(+) 
								    AND a.rnk = C.rnk 
								    AND A.kv = T.kv 
								    AND A.acc = P.acc 
								    and p.accs = " || Str(frmOpZalAcc.ACCS) 
					Else
						Set frmOpZalAcc.strSqlPopulate =
								 "SELECT distinct 1,decode(A.dazs,null,0,1), A.acc, A.nls, A.kv, T.lcv,abs(A.ostB/100),
								         SZ.pawn, SZ.mpawn, SZ.nree, SZ.ndz, SZ.idz, SZ.deposit_id, SZ.cc_idz, SZ.sdatz,
								         C.rnk, C.nmk,  A.grp, A.isp, A.nms,A.pap, max(P.PR_12), SZ.SV/100, a.OB22 ,a.mdate
								  INTO :frmOpZalAcc.colFL,  :frmOpZalAcc.nCol, :frmOpZalAcc.colAcc,
								       :frmOpZalAcc.colNls,:frmOpZalAcc.colKv,
								       :frmOpZalAcc.colValZal,:frmOpZalAcc.colSumZal_1,
								       :frmOpZalAcc.colPawn,:frmOpZalAcc.colPawnM, :frmOpZalAcc.NREE,
								       :frmOpZalAcc.colNdz, :frmOpZalAcc.IDZ,:frmOpZalAcc.colDep,
								       :frmOpZalAcc.CC_IDZ, :frmOpZalAcc.SDATZ,
								       :frmOpZalAcc.colRnk, :frmOpZalAcc.Zalogodatel,
								       :frmOpZalAcc.colGrp, :frmOpZalAcc.colIsp, :frmOpZalAcc.NMS,
								       :frmOpZalAcc.colPap, :frmOpZalAcc.PR_12, :frmOpZalAcc.SV,:hWndForm.frmOpZalAcc.OB22,
								       :frmOpZalAcc.MDATZ
								  FROM accounts A, tabval T, customer C, pawn_acc SZ, 
								       nd_acc n,cc_accp p 
								  WHERE A.acc = SZ.acc(+) 
								    AND a.rnk = C.rnk 
								    AND A.kv = T.kv 
								    AND A.acc = P.acc  
								    and n.nd = "||Str(dNd)||" 
								    and p.accs = n.acc 
								group by A.dazs, A.acc, A.nls, A.kv, T.lcv,A.ostB,  SZ.pawn, SZ.mpawn, SZ.nree, SZ.ndz, SZ.idz, SZ.deposit_id, SZ.cc_idz, SZ.sdatz,
								        C.rnk, C.nmk,  A.grp, A.isp, A.nms,A.pap,   SZ.SV, a.OB22 ,a.mdate  "    
				If CC_ID=STRING_Null and DAT1=DATETIME_Null
					If SqlPrepareAndExecute(hSql(),
							  "SELECT ndoc,DATD   INTO :CC_ID,:DAT1 FROM acc_over    WHERE nd=:dNd ")
							and SqlFetchNext(hSql(), nFetchRes)
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				If gOB22 = '1'
					Call SalShowWindow( OB22 )
				Else
					Call SalHideWindow( OB22 )
				Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
				Call SalWaitCursor(FALSE)
			On UM_Populate
				Set Kol_Ins = 0
				! Call SalSendClassMessage(UM_Populate, 0, 0)
				Call SalWaitCursor(TRUE)
				Call SalTblPopulate(hWndForm, hSql(),
						 frmOpZalAcc.strSqlPopulate, TBL_FillAll  )
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On UM_Update
				Set nRow = TBL_MinRow
				While SalTblFindNextRow(hWndForm, nRow,  ROW_New | ROW_Edited, 0)
					Call SalTblSetContext(hWndForm, nRow)
					If colRnk = NUMBER_Null
						Call SalMessageBox('Не вибрано РНК заставодавця/поручителя !', 'Помилка', MB_IconExclamation)
					Else
						Set nAcc =  frmOpZalAcc.colAcc
						Set sRP_12 = IifS( PR_12=NUMBER_Null, '1', Str(PR_12))
						If IDZ = NUMBER_Null
							Set IDZ=GetUserId()
						If colGrp = NUMBER_Null
							Set colGrp= nGrp
						! Открыть счет обеспечения с PAWN_ACC
						! Дополнить его спец.параметрами (PAWN_ACC)
						If Op_Reg(2, dNd, colPawn, colPawnM, nRet, colRnk, colNls, colKv, frmOpZalAcc.NMS, 'ZAL', frmOpZalAcc.colIsp, nAcc)
							! Привязки и спецпараметры
							If SqlPLSQLCommand(hSql(),
									 "p_pawn_nd(dNd,nAcc,OB22,"||IifS(sGr="CP","NUMBER_Null","ACCS")||",colGrp,NREE,CC_IDZ,SDATZ,MDATZ,IDZ,SV,colDep,PR_12)" )
								Call SqlCommitEx( hSql(),'Обесп к дог.'||Str(dNd) || ' ACCS='||Str(ACCS))
							If colSumZal !=0 and colSumZal !=NUMBER_Null
								Set nTmp = colSumZal * 100
								If SqlPrepareAndExecute( hSql(),
										"SELECT  a.pap INTO :frmOpZalAcc.colPap  FROM accounts a
										 WHERE a.nls=:frmOpZalAcc.colNls and a.kv=:frmOpZalAcc.colKv")
										 and not SqlFetchNext(hSql(), nFetchRes)
								! увеличение залога пассивные счета
								If nTmp > 0 and colPap = 2
									Set nDk = 1
								! уменьшение залога пассивные счета
								Else If nTmp < 0 and colPap = 2
									Set nDk =  0
								! увеличение залога активные счета
								Else If nTmp > 0 and colPap = 1
									Set nDk = 0
								! уменьшение залога активные счета
								Else If nTmp < 0 and colPap = 1
									Set nDk = 1
								Set nTmp = SalNumberAbs(nTmp)
								Call cDoc.SetDoc(0, 'ZAL', nDk, IifN(colVob=NUMBER_Null,6,colVob ), STRING_Null,
										     dDat, dDat, dDat, dDat,
										     sNlsK, GetBankName(),GetBankMfo(), '', colKv, nTmp, GetBankOkpoS(),
										     colNls,Zalogodatel,  GetBankMfo(), '', colKv, nTmp,
										     GetBankOkpoS(),  NAZN , '' , GetIdOper(), '', NUMBER_Null,0 )
								If cDoc.oDoc()
									Call SqlCommit(hSql())
								Else
									Call SqlRollback(hSql())
						Else
							Call SqlRollback(hSql())
							Call SalMessageBox('Еможлива відкрити рах.забезпечення='||colNls,'Помилка', MB_IconExclamation)
				Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
			On SAM_FetchRowDone
				If SqlPrepareAndExecute( hSqlAux2(), 
						"SELECT name INTO :frmOpZalAcc.colMestoZal FROM cc_mpawn WHERE mpawn=:frmOpZalAcc.colPawnM ")
						and SqlFetchNext( hSqlAux2(), nFetchRes)
				If SqlPrepareAndExecute( hSqlAux2(), 
						"SELECT name,s031 
						 INTO :frmOpZalAcc.colVidZal,:frmOpZalAcc.colS031 
						 FROM cc_pawn WHERE pawn=:frmOpZalAcc.colPawn AND d_close is null
						ORDER BY NBSZ, S031, NAME ")
						And SqlFetchNext( hSqlAux2(), nFetchRes)
				If hWndForm.frmOpZalAcc.nCol = 1
					Call SetTblRowColor( hWndForm, COLOR_Periwinkle )
				If nNd > 0
					If SqlPrepareAndExecute(hSqlAux(),
							"SELECT 0 from cc_accp z , nd_acc n
							 where z.acc = :frmOpZalAcc.colAcc and n.acc = z.accs and n.nd <> nvl(z.nd ,0)  " ) 
							and SqlFetchNext(hSqlAux(), nFetchRes)
						Call XSalTblSetRowBackColor( hWndForm, lParam,  COLOR_Gray )
	Dialog Box: cdoc_dlgSelectAdjustion
		Class:
		Property Template:
		Class DLL Name:
		Title: Выбор способа погашения:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  5.329"
				Width Editable? Yes
				Height: 1.938"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Radio Button: rbReset
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Погашение кредита равными суммами
				Window Location and Size
					Left:   0.186"
					Top:    0.073"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Radio Button: rbLast
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Возврат всей суммы кредита в конце срока
				Window Location and Size
					Left:   0.186"
					Top:    0.323"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Radio Button: rbEqual
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Погашение кредита равными долями с %%
				Window Location and Size
					Left:   0.186"
					Top:    0.573"
					Width:  5.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Line
				Resource Id: 50608
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Coordinates
					Begin X:  0.186"
					Begin Y:  0.906"
					End X:  5.086"
					End Y:  0.906"
				Visible? Yes
				Line Style: Etched
				Line Thickness: 1
				Line Color: Default
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Переразбить
				Window Location and Size
					Left:   2.671"
					Top:    1.031"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.5"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Enter
				Font Name: Arial Cyr
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nSelected = 0
						If rbReset
							Set nSelected = 1
						Else If rbLast
							Set nSelected = 2
						Else If rbEqual
							Set nSelected = 3
						Call SalEndDialog(hWndForm, 1)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сброс
				Window Location and Size
					Left:   3.871"
					Top:    1.031"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.5"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Esc
				Font Name: Arial Cyr
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, 0)
		Functions
		Window Parameters
			Receive Number: nSelected
		Window Variables
		Message Actions
			On SAM_Create
				If nSelected = 1
					Set rbReset = TRUE
				Else If nSelected = 2
					Set rbLast = TRUE
				Else If nSelected = 3
					Set rbEqual = TRUE
				Call SalCenterWindow(hWndForm)
	Dialog Box: dlg_MemoEditor
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   0.975"
				Top:    1.354"
				Width:  12.4"
				Width Editable? Yes
				Height: 3.381"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Multiline Field: mlEditor
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 10000
					String Type: Long String
					Editable? Yes
				Display Settings
					Border? Yes
					Word Wrap? No
					Vertical Scroll? Yes
					Window Location and Size
						Left:   0.217"
						Top:    0.452"
						Width:  11.1"
						Width Editable? Yes
						Height: 2.286"
						Height Editable? Yes
					Visible? Yes
					Font Name: Courier New
					Font Size: 12
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Message Actions
					On SAM_AnyEdit
						Set fEdited=TRUE
					On SAM_Create
						If not bFL_Edit
							Call SalDisableWindow( mlEditor )
		Functions
		Window Parameters
			String: Title
			Receive Boolean: fEdited
			Receive Long String: SQLText
			Number: bFL_Edit
		Window Variables
		Message Actions
			On SAM_Create
				Call SalSetWindowText( dlg_MemoEditor, Title )
				Call SalCenterWindow( dlg_MemoEditor )
				Set mlEditor=SQLText
				Set fEdited=FALSE
			On SAM_Close
				If fEdited and bFL_Edit
					If SalMessageBox( 'Сохранить изменения?', 'Редактирование',
							MB_YesNo | MB_IconQuestion | MB_DefButton1 ) = IDYES
						Set SQLText=mlEditor
	! cDocW: cDocWdog1
.winattr class Form Window:
		Class: cDocW
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Yes
		Visible? No
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? No
			Window Location and Size
				Left:   1.4"
				Top:    0.792"
				Width:  12.314"
				Width Editable? Yes
				Height: 5.99"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
.end
		                                                                                                                                                 Description: 
		                                                                                                                                                 Named Menus 
		                                                                                                                                                 Menu 
		                                                                                                                                                 Tool Bar 
			                                                                                                                                                 Contents 
				                                                                                                                                                 Pushbutton: pbPayDoc
					                                                                                                                                                 Message Actions 
						! On SAM_Click
							                                                                                                                                                                                                                                                                                                                                                          Set cDocWdog.nFli = IifN(dfBankB=GetBankMfo(), 0, 1)
							                                                                                                                                                                                                                                                                                                                                                          Set cDocWdog.sTT = IifS(dfBankB=GetBankMfo(), sKV1,    sKV2)
							                                                                                                                                                                                                                                                                                                                                                          Set cDocWdog.sTT = IifS(Subs(dfNlsB,1,2)='10', sKV3, cDocWdog.sTT )
							                                                                                                                                                                                                                                                                                                                                                          Call SalSendMsg( hWndForm, UM_Insert, 0, 0 )
				                                                                                                                                                 Pushbutton: pbExit
					                                                                                                                                                 Message Actions 
				                                                                                                                                                 Pushbutton: pbPrtDoc
					                                                                                                                                                 Message Actions 
				                                                                                                                                                 Line 
				                                                                                                                                                 Line 
				                                                                                                                                                 Line 
				                                                                                                                                                 Data Field: dfZn
					                                                                                                                                                 Message Actions 
				                                                                                                                                                 Data Field: dfOst
					                                                                                                                                                 Message Actions 
				                                                                                                                                                 Pushbutton: pbNewDoc
					                                                                                                                                                 Message Actions 
				                                                                                                                                                 Pushbutton: pbNewTTs
					                                                                                                                                                 Message Actions 
						                                                                                                                                                 On SAM_Create
							                                                                                                                                                 Set strTip = 'Перейти к следующему документу выдачи'
				                                                                                                                                                 Pushbutton: pbHelp
					                                                                                                                                                 Message Actions 
				                                                                                                                                                 Pushbutton: pbSaveKor
					                                                                                                                                                 Message Actions 
				                                                                                                                                                 Background Text: Остаток:
				                                                                                                                                                 Pushbutton: pbDocBal
					                                                                                                                                                 Message Actions 
				                                                                                                                                                 Line 
				                                                                                                                                                 Pushbutton: pbHotVytyag
					                                                                                                                                                 Message Actions 
				                                                                                                                                                 Pushbutton: pbHotName
					                                                                                                                                                 Message Actions 
				                                                                                                                                                 Pushbutton: pbHotFio
					                                                                                                                                                 Message Actions 
				!
				                                                                                                                                                 Pushbutton: pbLocalD
					                                                                                                                                                 Message Actions 
				                                                                                                                                                 Pushbutton: pbHotOstat
					                                                                                                                                                 Message Actions 
		                                                                                                                                                 Contents 
			                                                                                                                                                 Combo Box: cmbVob
				                                                                                                                                                 List Initialization 
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Background Text: №
			                                                                                                                                                 Data Field: dfNd
				                                                                                                                                                 Message Actions 
					                                                                                                                                                 On SAM_Create
						                                                                                                                                                 Call cDocWdog.UnHideIt(hWndItem)
						                                                                                                                                                 If cDocWdog.sNd
							                                                                                                                                                 Set dfNd = cDocWdog.sNd
			                                                                                                                                                 Data Field: dfDocD
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfBankA
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfKvA
				                                                                                                                                                 Message Actions 
					                                                                                                                                                 On SAM_Create
						                                                                                                                                                 Call SalSendClassMessage(SAM_Create, 0, 0)
			                                                                                                                                                 Data Field: dfNlsA
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfPlat
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfNamA
				                                                                                                                                                 Message Actions 
					                                                                                                                                                 On SAM_Create
						                                                                                                                                                 Call cDocWdog.UnHideIt( hWndItem )
						! If SalStrLength(dfNamA )>=3 and not (bFixNlsA or bFixAll)
							                                                                                                                                                                                                                                                                                                                                                          Call HideIt( hWndItem )
			                                                                                                                                                 Data Field: dfPlatB
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfNbA
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfBankB
				                                                                                                                                                 Message Actions 
					                                                                                                                                                 On SAM_Create
						                                                                                                                                                 Call cDocWdog.UnHideIt(hWndItem)
						                                                                                                                                                 If cDocWdog.sBankB
							                                                                                                                                                 Set dfBankB = cDocWdog.sBankB
							                                                                                                                                                 Call SalSendMsg(hWndItem, SAM_Validate, 0, 0)
					                                                                                                                                                 On SAM_Validate
						                                                                                                                                                 Set cDocWdog.dfBankB = SalStrTrimX(cDocWdog.dfBankB)
						                                                                                                                                                 If SalIsNull (cDocWdog.dfBankB) and not  cDocWdog.bTotVal
							                                                                                                                                                 Return VALIDATE_Ok
						                                                                                                                                                 If not SalIsValidInteger(cDocWdog.dfBankB)
							                                                                                                                                                 Call SalMessageBox("Нецифра в коде банка Б",     "Ошибка", MB_IconExclamation)
							                                                                                                                                                 Return VALIDATE_Cancel
						                                                                                                                                                 If not IsValidMFO(cDocWdog.dfBankB)
							                                                                                                                                                 Call SalMessageBox( "Ош контрольный разряд кода банка Б", "Ошибка", MB_IconExclamation)
							                                                                                                                                                 Return VALIDATE_Cancel
						!
						                                                                                                                                                 If SqlPrepareAndExecute(hSql(), 
								  "SELECT nb INTO :cDocWdog.dfNbB FROM banks 
								   WHERE mfo=:cDocWdog.dfBankB and nvl(blk,0)<>4")
								and not SqlFetchNext(hSql(),nFetchRes)
							                                                                                                                                                 Call SalMessageBox("Не найден банк " || dfBankB, "Ошибка", MB_IconExclamation)
							                                                                                                                                                 Return VALIDATE_Cancel
						!
						                                                                                                                                                 Call F_TT()
						                                                                                                                                                 Return VALIDATE_Ok
			                                                                                                                                                 Data Field: dfPoluB
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfNbB
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfKvB
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfNlsB
				                                                                                                                                                 Message Actions 
					                                                                                                                                                 On SAM_Create
						                                                                                                                                                 Call cDocWdog.UnHideIt(hWndItem)
						                                                                                                                                                 If cDocWdog.sNlsB
							                                                                                                                                                 Set dfNlsB = cDocWdog.sNlsB
							                                                                                                                                                 Call SalSendMsg(hWndItem, SAM_Validate, 0, 0)
					                                                                                                                                                 On SAM_Validate
						                                                                                                                                                 Call F_TT()
						                                                                                                                                                 Return SalSendClassMessage(SAM_Validate, 0, 0)
			                                                                                                                                                 Data Field: dfPolu
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfNamB
				                                                                                                                                                 Message Actions 
					                                                                                                                                                 On SAM_Create
						                                                                                                                                                 Call cDocWdog.UnHideIt(hWndItem)
			                                                                                                                                                 Data Field: dfSumA
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfSumB
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfRat
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfSumC
				                                                                                                                                                 Message Actions 
					                                                                                                                                                 On SAM_Create
						                                                                                                                                                 Call cDocWdog.UnHideIt( hWndItem )
						                                                                                                                                                 Set cDocWdog.dfSumC= SalNumberAbs( cDocWdog.nSumDog)
						                                                                                                                                                 Set cDocWdog.nS    = cDocWdog.dfSumC 
						                                                                                                                                                 Set cDocWdog.dfSumA= cDocWdog.dfSumC
						                                                                                                                                                 Set cDocWdog.dfSumB= cDocWdog.dfSumC
						                                                                                                                                                 Call SalSendClassMessage(SAM_Create, wParam, lParam)
					                                                                                                                                                 On SAM_Validate
						                                                                                                                                                 Call cDocWdog.DecPoint(hWndItem)
						                                                                                                                                                 If not SalIsValidDecimal( hWndItem, 15, cDocWdog.nDigA )
							                                                                                                                                                 Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrSumFormat'),
									                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
							                                                                                                                                                 Return VALIDATE_Cancel
						                                                                                                                                                 Set cDocWdog.dfSumC=SalNumberAbs(cDocWdog.dfSumC)
						!
						                                                                                                                                                 If SalIsNull( hWndItem ) or (cDocWdog.dfSumC=0 and not cDocWdog.aFlg[14]) ! nFeq
							                                                                                                                                                 Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrSumBlank'),
									                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
							                                                                                                                                                 Return VALIDATE_Cancel
						!
						! Call Debug('cDocWdog.dfSumC = '|| Str(cDocWdog.dfSumC)||' , cDocWdog.nSumDog='||Str(cDocWdog.nSumDog) )
						                                                                                                                                                 If cDocWdog.dfSumC > SalNumberAbs( cDocWdog.nSumDog) and nOper=2 
							                                                                                                                                                 Call SalMessageBox(
									"Сумма взыскания больше суммы общей задолженности по счету ",
									"Взыскание невозможно ! ",
									MB_IconStop)
							                                                                                                                                                 Set dfSumC = SalNumberAbs( cDocWdog.nSumDog)
							                                                                                                                                                 Return VALIDATE_Cancel
						!
						                                                                                                                                                 Set cDocWdog.dfSumA=cDocWdog.dfSumC
						                                                                                                                                                 Set cDocWdog.dfSumB=cDocWdog.dfSumC
						                                                                                                                                                 Return VALIDATE_Ok
			                                                                                                                                                 List Box: lb1
				                                                                                                                                                 List Initialization 
				                                                                                                                                                 Message Actions 
					                                                                                                                                                 On SAM_Create
						                                                                                                                                                 Call SalSendClassMessage( SAM_Create, 0, 0 )
						                                                                                                                                                 Set cDocWdog.i=0
						                                                                                                                                                 Call SalArrayGetUpperBound( cDocWdog.aTag, 1, cDocWdog.nTmp  )
						                                                                                                                                                 If SqlPrepareAndExecute( hSql(),
								"SELECT c.nmk, d.name,  p.SER||' '||p.NUMDOC, 
								        p.organ||' '||to_char(PDATE,'dd/mm/yyyy'), c.ADR, to_char(p.BDAY,'dd/mm/yyyy')
								 INTO :cDocWdog.aVal[1], :cDocWdog.aVal[2], :cDocWdog.aVal[3], 
								      :cDocWdog.aVal[4], :cDocWdog.aVal[5], :cDocWdog.aVal[6]
								 FROM customer c, person p, PASSP d
								 WHERE c.rnk=p.rnk and c.rnk=:nRnk and nvl(p.PASSP,1) =d.PASSP ")
								and SqlFetchNext(hSql(), nFetchRes)
						                                                                                                                                                 Call SalListSetSelect( lb1, 0 )
						                                                                                                                                                 Call SalSendMsg( hWndItem, SAM_Click, 0, 0 )
			                                                                                                                                                 Multiline Field: dfNazn
				                                                                                                                                                 Message Actions 
					                                                                                                                                                 On SAM_Create
						                                                                                                                                                 Call cDocWdog.UnHideIt(hWndItem)
						                                                                                                                                                 If cDocWdog.sNazn
							                                                                                                                                                 Set dfNazn = cDocWdog.sNazn
							                                                                                                                                                 Call SalSendMsg(hWndItem, SAM_Validate, 0, 0)
			                                                                                                                                                 Data Field: dfSk
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfValD1
				                                                                                                                                                 Message Actions 
					                                                                                                                                                 On SAM_Create
						                                                                                                                                                 Call SalSendClassMessage(SAM_Create, 0, 0)
						                                                                                                                                                 Set dfValD1 = IifD(dWida<cDocWdog.dDat, cDocWdog.dDat, dWida)
			                                                                                                                                                 Data Field: dfValD2
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfSumNA
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfSumNB
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfRatNomN
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfSumNC
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfSkN
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfValD2N
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfD
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfK
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Check Box: cbUgrnt
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfOkpoA
				                                                                                                                                                 Message Actions 
					                                                                                                                                                 On SAM_Create
						                                                                                                                                                 Call cDocWdog.UnHideIt( hWndItem )
			                                                                                                                                                 Data Field: dfOkpoB
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfVytyagN
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfEquivN
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfEquiv
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfLocDat
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfDateFrom
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfNssA
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfSlashD
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfNssB
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfSlashK
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Data Field: dfValD1N
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Picture: pic1f
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Picture: pic2f
				                                                                                                                                                 Message Actions 
			                                                                                                                                                 Picture: pic3f
				                                                                                                                                                 Message Actions 
		                                                                                                                                                 Functions 
			                                                                                                                                                 Function: oDoc
				                                                                                                                                                 Description: Оплатить  документ с прибамбасами
				                                                                                                                                                 Returns 
					                                                                                                                                                 Boolean: 
				                                                                                                                                                 Parameters 
				                                                                                                                                                 Static Variables 
				                                                                                                                                                 Local variables 
					                                                                                                                                                 String: sFio
					                                                                                                                                                 String: sPasp
					                                                                                                                                                 String: sAtrt
					                                                                                                                                                 String: sAdr
					                                                                                                                                                 String: sDobr
				                                                                                                                                                 Actions 
					                                                                                                                                                 If cDocWdog.sTT = sKV3 and cDocWdog.nKvA=GetBaseVal()
						                                                                                                                                                 Set cDocWdog.m_nSk=cDocWdog.dfSk
					! !!!!!!!!!!!!!!!!
					                                                                                                                                                 If cDocW.oDoc()
						! Перенос на просрочку 
						                                                                                                                                                 If nOper=1
							                                                                                                                                                 If SqlPrepareAndExecute( hSql(),"UPDATE cc_deal SET sos=13 WHERE nd=:N_ND ")
									   and SqlCommit( hSql() )
							                                                                                                                                                 Return TRUE
						                                                                                                                                                 Return TRUE
					                                                                                                                                                 Else 
						                                                                                                                                                 Call SqlRollback( hSql() )
						                                                                                                                                                 Return FALSE
					! Return cDocW.oDoc()
					! If cDocW.oDoc()
						! While TRUE
							                                                                                                                                                                                                                                                                                                                                                          If not SqlPrepareAndExecute(hSql(),
									 "INSERT INTO cc_refv (nd,ref) VALUES (:cDocWdog.nNdog,:cDocWdog.m_nRef)")
								                                                                                                                                                                                                                                                                                                                                                          Break
							! проверка суммы
							! !!!!!!!!!!!!!!!!!!
							                                                                                                                                                                                                                                                                                                                                                          Set nU = nU - cDocWdog.A.S
							                                                                                                                                                                                                                                                                                                                                                          If nU = 0
								                                                                                                                                                                                                                                                                                                                                                          If SqlPrepareAndExecute(hSql(),
										"UPDATE cc_add SET refv=:cDocWdog.m_nRef WHERE nd=:cDocWdog.nNdog and adds=0")
									                                                                                                                                                                                                                                                                                                                                                          Call SqlCommit(hSql())
								                                                                                                                                                                                                                                                                                                                                                          Else
									                                                                                                                                                                                                                                                                                                                                                          Break
							                                                                                                                                                                                                                                                                                                                                                          Return TRUE
					! !!!!!!!!!!!!!!!!
			                                                                                                                                                 Function: F_TT
				                                                                                                                                                 Description: 
				                                                                                                                                                 Returns 
				                                                                                                                                                 Parameters 
				                                                                                                                                                 Static Variables 
				                                                                                                                                                 Local variables 
				                                                                                                                                                 Actions 
					                                                                                                                                                 If cDocWdog.dfBankB=GetBankMfo()
						                                                                                                                                                 Set cDocWdog.nFli =  0
						                                                                                                                                                 If Subs(cDocWdog.dfNlsB,1,2)='10'
							                                                                                                                                                 Set cDocWdog.sTT = sKV3
							                                                                                                                                                 If SqlPrepareAndExecute(hSql(),"
									     SELECT sk INTO :cDocWdog.dfSk FROM tts WHERE tt=:cDocWdog.sTT ")
									and SqlFetchNext(hSql(), nFetchRes)
							                                                                                                                                                 If cDocWdog.nKvA=GetBaseVal()
								                                                                                                                                                 Set cDocWdog.nVob =KK3_NV
							                                                                                                                                                 Else 
								                                                                                                                                                 Set cDocWdog.nVob =KK3_IV
						                                                                                                                                                 Else 
							                                                                                                                                                 Set cDocWdog.sTT = sKV1
							! Set cDocWdog.nVob = 6
					                                                                                                                                                 Else 
						                                                                                                                                                 Set cDocWdog.nFli =  1
						                                                                                                                                                 Set cDocWdog.sTT = sKV2
						! If SqlPrepareAndExecute(hSql(),
								  "SELECT vob INTO :cDocWdog.nVob FROM tts_vob WHERE tt=:cDocWdog.sTT ")
								and not SqlFetchNext(hSql(), nFetchRes)
							                                                                                                                                                                                                                                                                                                                        Set cDocWdog.nVob = 1
		                                                                                                                                                 Window Parameters 
			                                                                                                                                                 Number: nOper !! 0-выдача, 1-пролонгация 2-погаш
			                                                                                                                                                 Number: nSumDog !! не исп
			                                                                                                                                                 Number: nKvDog
			                                                                                                                                                 Number: nRnk
			                                                                                                                                                 String: sAccA
			                                                                                                                                                 String: sAccB
			                                                                                                                                                 String: sMfoB
			                                                                                                                                                 Number: nNdog
			                                                                                                                                                 String: sNazn
			                                                                                                                                                 String: sPolu
			                                                                                                                                                 String: sNd
			                                                                                                                                                 Date/Time: dWida
			                                                                                                                                                 String: sKV1
			                                                                                                                                                 String: sKV2
			                                                                                                                                                 String: sKV3
			                                                                                                                                                 Window Handle: pbDisable
			                                                                                                                                                 Window Handle: pbRefreshG
		                                                                                                                                                 Window Variables 
			                                                                                                                                                 String: sNamB
			                                                                                                                                                 Number: nU
			                                                                                                                                                 Number: nSupro
			                                                                                                                                                 Number: KK3_NV
			                                                                                                                                                 Number: KK3_IV
			                                                                                                                                                 Number: nVx
		                                                                                                                                                 Message Actions 
			                                                                                                                                                 On SAM_Create
				                                                                                                                                                 Call SalDisableWindow( pbDisable )
				                                                                                                                                                 If SqlPrepareAndExecute(hSql(),
						  "SELECT to_number(val) INTO :KK3_NV FROM params WHERE par='KK3_NV'")
						and not SqlFetchNext(hSql(), nFetchRes)
					                                                                                                                                                 Set KK3_NV=22
				                                                                                                                                                 If SqlPrepareAndExecute(hSql(),
						  "SELECT to_number(val) INTO :KK3_IV FROM params WHERE par='KK3_IV'")
						and not SqlFetchNext(hSql(), nFetchRes)
					                                                                                                                                                 Set KK3_IV=42
				                                                                                                                                                 Call SalSendClassMessage(SAM_Create, 0, 0)
			                                                                                                                                                 On UM_Choose
				                                                                                                                                                 Set sNlsA_TT = sAccA
				                                                                                                                                                 Set sNlsB_TT = sAccB
				                                                                                                                                                 Set nKvA_TT = nKvDog
				                                                                                                                                                 Set dfNazn = sNazn
				                                                                                                                                                 Set sBankB_TT = sMfoB
				                                                                                                                                                 Set dfNd = sNd
				                                                                                                                                                 Set bDocStart = TRUE
				                                                                                                                                                 Set sTT = sKV1
				                                                                                                                                                 If not SqlPrepareAndExecute(hSql(),
						"SELECT name, fli, flv, decode(:nOper,2,0,dk), flags 
						 INTO :sTTN, :nFli,:nFlv, :nDk, :sFlags         
						 FROM tts  WHERE tt=:sTT ") 
						or not SqlFetchNext(hSql(), nFetchRes)
					                                                                                                                                                 Call SalMessageBox("Нет описана операция " || sTT,   "Ошибка", MB_IconExclamation)
					                                                                                                                                                 Call SalDestroyWindow(hWndForm)
				                                                                                                                                                 Call Flgs2aFlg(sFlags)
				                                                                                                                                                 Call SalSetWindowText(hWndForm, 'Ввод документа - [ ' ||  sTTN || ' ]')
				                                                                                                                                                 If not aFlg[9]
					                                                                                                                                                 Set nSk_TT = NUMBER_Null
				                                                                                                                                                 Call SalSendClassMessage(UM_Clear, 0, 0)
			                                                                                                                                                 On SAM_Destroy
				                                                                                                                                                 Call SalEnableWindow( pbDisable )
				                                                                                                                                                 Call SalSendMsg( pbRefreshG, SAM_Click, 0, 0 )
			                                                                                                                                                 On SAM_CreateComplete
				                                                                                                                                                 Call SalSendClassMessage(SAM_CreateComplete, 0, 0)
				                                                                                                                                                 Set nVx = 0
				                                                                                                                                                 If nOper = 2
					                                                                                                                                                 Call SalDisableWindow( dfBankA )  
					                                                                                                                                                 Call SalDisableWindow( dfBankB )  
					                                                                                                                                                 Call SalDisableWindow( dfOkpoA ) 
					                                                                                                                                                 Call SalDisableWindow( dfOkpoB ) 
					                                                                                                                                                 Call SalDisableWindow( dfNamA ) 
					                                                                                                                                                 Call SalDisableWindow( dfNamB )  
					                                                                                                                                                 Call SalDisableWindow( dfKvA ) 
					                                                                                                                                                 Call SalDisableWindow( dfKvB ) 
					                                                                                                                                                 Call SalDisableWindow( dfNlsA ) 
					                                                                                                                                                 Call SalDisableWindow( dfNlsB ) 
	Form Window: cDocWdog
		Class: cDocW
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbPayDoc
					Class Child Ref Key: 27
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbExit
					Class Child Ref Key: 29
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrtDoc
					Class Child Ref Key: 30
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 64935
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cDocW
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Background Text:
					Resource Id: 64936
					Class Child Ref Key: 75
					Class ChildKey: 0
					Class: cDocW
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Justify: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
				Line
					Resource Id: 64937
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cDocW
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 64938
					Class Child Ref Key: 59
					Class ChildKey: 0
					Class: cDocW
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: dfZn
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Class Default
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   Class Default
							Top:    Class Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Border? Class Default
						Justify: Class Default
						Format: Class Default
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
				Data Field: dfOst
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Class Default
						Data Type: Class Default
						Editable? Class Default
					Display Settings
						Window Location and Size
							Left:   Class Default
							Top:    Class Default
							Width:  Class Default
							Width Editable? Class Default
							Height: Class Default
							Height Editable? Class Default
						Visible? Class Default
						Border? Class Default
						Justify: Class Default
						Format: Class Default
						Country: Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
						Input Mask: Class Default
					Message Actions
				Pushbutton: pbNewDoc
					Class Child Ref Key: 53
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbNewTTs
					Class Child Ref Key: 60
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDocBal
					Class Child Ref Key: 72
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbHelp
					Class Child Ref Key: 62
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbSaveKor
					Class Child Ref Key: 64
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbLocalD
					Class Child Ref Key: 148
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 64939
					Class Child Ref Key: 77
					Class ChildKey: 0
					Class: cDocW
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbHotVytyag
					Class Child Ref Key: 138
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbHotFio
					Class Child Ref Key: 141
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbHotName
					Class Child Ref Key: 137
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbHotOstat
					Class Child Ref Key: 150
					Class ChildKey: 0
					Class: cDocW
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
		Contents
			Data Field: dfValD1
				Class Child Ref Key: 25
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call SalSendClassMessage(SAM_Create, 0, 0)
						Set cDocWdog.dfValD1 =
								 IifD(cDocWdog.dWida < cDocWdog.dDat, cDocWdog.dDat, cDocWdog.dWida )
			Combo Box: cmbVob
				Class Child Ref Key: 39
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
			Background Text:
				Resource Id: 64934
				Class Child Ref Key: 36
				Class ChildKey: 0
				Class: cDocW
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Justify: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Data Field: dfNd
				Class Child Ref Key: 23
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call cDocWdog.UnHideIt(hWndItem)
						If cDocWdog.sNd
							Set cDocWdog.dfNd = cDocWdog.sNd
			Data Field: dfDateFrom
				Class Child Ref Key: 155
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfDocD
				Class Child Ref Key: 22
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfBankA
				Class Child Ref Key: 4
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfKvA
				Class Child Ref Key: 50
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNlsA
				Class Child Ref Key: 2
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call SalSendClassMessage(SAM_Create, 0, 0)
						If CCK_NBU
							Call cDocWdog.UnHideIt(hWndItem)
			Data Field: dfPlat
				Class Child Ref Key: 8
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNamA
				Class Child Ref Key: 7
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call cDocWdog.UnHideIt( hWndItem )
					!
					On SAM_SetFocus
						If SalStrLength(cDocWdog.dfNamA)>38
							Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_LightPeriwinkle )
						Else
							Call SalColorSet( hWndItem, COLOR_IndexWindow, COLOR_Sky )
						Set cDocWdog.bNamA=TRUE
						! If not SalStrTrimX(cDocWdog.sNlsA_TT)
							! Set bNamA=TRUE
							! Set bAccA=2
							! Call SalEnableWindow( pbHelp )
			Data Field: dfOkpoA
				Class Child Ref Key: 139
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call cDocWdog.UnHideIt( hWndItem )
			Data Field: dfPlatB
				Class Child Ref Key: 9
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNbA
				Class Child Ref Key: 6
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfBankB
				Class Child Ref Key: 13
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call cDocWdog.UnHideIt(hWndItem)
						If cDocWdog.sBankB
							Set cDocWdog.dfBankB = cDocWdog.sBankB
							Call SalSendMsg(hWndItem, SAM_Validate, 0, 0)
					On SAM_Validate
						Set cDocWdog.dfBankB = SalStrTrimX(cDocWdog.dfBankB)
						If SalIsNull (cDocWdog.dfBankB) and not  cDocWdog.bTotVal
							Return VALIDATE_Ok
						If not SalIsValidInteger(cDocWdog.dfBankB)
							Call SalMessageBox("Нецифра в коде банка Б",     "Ошибка", MB_IconExclamation)
							Return VALIDATE_Cancel
						If not IsValidMFO(cDocWdog.dfBankB)
							Call SalMessageBox( "Ош контрольный разряд кода банка Б", "Ошибка", MB_IconExclamation)
							Return VALIDATE_Cancel
						!
						If SqlPrepareAndExecute(hSql(), 
								  "SELECT nb INTO :cDocWdog.dfNbB FROM banks 
								   WHERE mfo=:cDocWdog.dfBankB and nvl(blk,0)<>4")
								and not SqlFetchNext(hSql(),nFetchRes)
							Call SalMessageBox("Не найден банк " || cDocWdog.dfBankB, "Ошибка", MB_IconExclamation)
							Return VALIDATE_Cancel
						!
						Call cDocWdog.F_TT()
						Return VALIDATE_Ok
			Data Field: dfPoluB
				Class Child Ref Key: 18
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNbB
				Class Child Ref Key: 15
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfKvB
				Class Child Ref Key: 51
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNlsB
				Class Child Ref Key: 11
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call cDocWdog.UnHideIt(hWndItem)
						If cDocWdog.sNlsB
							Set cDocWdog.dfNlsB = cDocWdog.sNlsB
							Call SalSendMsg(hWndItem, SAM_Validate, 0, 0)
					On SAM_Validate
						Call cDocWdog.F_TT()
						Return SalSendClassMessage(SAM_Validate, 0, 0)
			Data Field: dfPolu
				Class Child Ref Key: 17
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfNamB
				Class Child Ref Key: 16
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call cDocWdog.UnHideIt(hWndItem)
						If CCK_NBU and sMfoB and cDocWdog.sTT = 'KK2'
							Call SqlPrepareAndExecute(hSql(), 
									    "select c.nmkk, c.okpo into :dfNamB, :dfOkpoB from customer c, custbank b where c.rnk = b.rnk and b.mfo=:sMfoB and c.date_off is null")
							Call SqlFetchNext(hSql(), nFetchRes)
			Data Field: dfOkpoB
				Class Child Ref Key: 140
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						If CCK_NBU
							Call cDocWdog.UnHideIt(hWndItem)
			Data Field: dfSumNA
				Class Child Ref Key: 135
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumA
				Class Child Ref Key: 20
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumNB
				Class Child Ref Key: 122
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumB
				Class Child Ref Key: 21
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfRatNomN
				Class Child Ref Key: 123
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfRatNom
				Class Child Ref Key: 57
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumNC
				Class Child Ref Key: 125
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSumC
				Class Child Ref Key: 44
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
					On SAM_Create
						Call cDocWdog.UnHideIt( hWndItem )
						Set cDocWdog.dfSumC= SalNumberAbs( cDocWdog.nSumDog)
						Set cDocWdog.nS    = cDocWdog.dfSumC 
						Set cDocWdog.dfSumA= cDocWdog.dfSumC
						Set cDocWdog.dfSumB= cDocWdog.dfSumC
						Call SalSendClassMessage(SAM_Create, wParam, lParam)
					On SAM_Validate
						Call cDocWdog.DecPoint(hWndItem)
						If not SalIsValidDecimal( hWndItem, 15, cDocWdog.nDigA )
							Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrSumFormat'),
									                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
							Return VALIDATE_Cancel
						Set cDocWdog.dfSumC=SalNumberAbs(cDocWdog.dfSumC)
						!
						If SalIsNull( hWndItem ) or (cDocWdog.dfSumC=0 and not cDocWdog.aFlg[14]) ! nFeq
							Call SalMessageBox( CurrentLangTable.GetAtomTitle('DocWMesErrSumBlank'),
									                    CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
							Return VALIDATE_Cancel
						!
						! Call Debug('cDocWdog.dfSumC = '|| Str(cDocWdog.dfSumC)||' , cDocWdog.nSumDog='||Str(cDocWdog.nSumDog) )
						If cDocWdog.dfSumC > SalNumberAbs( cDocWdog.nSumDog) and cDocWdog.nOper=2 
							Call SalMessageBox(
									"Сумма взыскания больше суммы общей задолженности по счету ",
									"Взыскание невозможно ! ",
									MB_IconStop)
							Set cDocWdog.dfSumC = SalNumberAbs( cDocWdog.nSumDog)
							Return VALIDATE_Cancel
						!
						Set cDocWdog.dfSumA=cDocWdog.dfSumC
						Set cDocWdog.dfSumB=cDocWdog.dfSumC
						Return VALIDATE_Ok
			Data Field: dfEquivN
				Class Child Ref Key: 144
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfEquiv
				Class Child Ref Key: 145
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			List Box: lb1
				Class Child Ref Key: 85
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Multiple selection? Class Default
				Sorted? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Horizontal Scroll? Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call SalSendClassMessage( SAM_Create, 0, 0 )
						If SqlPrepareAndExecute( hSql(),
								"SELECT c.nmk, d.name,  p.SER||' '||p.NUMDOC, 
								        p.organ||' '||to_char(PDATE,'dd/mm/yyyy'), c.ADR, to_char(p.BDAY,'dd/mm/yyyy')
								 INTO :cDocWdog.aVal[1], :cDocWdog.aVal[2], :cDocWdog.aVal[3], 
								      :cDocWdog.aVal[4], :cDocWdog.aVal[5], :cDocWdog.aVal[6]
								 FROM customer c, person p, PASSP d
								 WHERE c.rnk=p.rnk and c.rnk=:cDocWdog.nRnk and nvl(p.PASSP,1) =d.PASSP ")
								and SqlFetchNext(hSql(), nFetchRes)
						Set cDocWdog.i=0
						Call SalArrayGetUpperBound( cDocWdog.aTag, 1, cDocWdog.nTmp  )
						While cDocWdog.i < cDocWdog.nTmp
							Set cDocWdog.i = cDocWdog.i+1
							If SalStrTrimX(cDocWdog.aTag[cDocWdog.i]) = 'П'
								Set cDocWdog.aVal[cDocWdog.i] = sDop
						Call SalListSetSelect( cDocWdog.lb1, 0 )
						Call SalSendMsg( hWndItem, SAM_Click, 0, 0 )
			Multiline Field: dfNazn
				Class Child Ref Key: 24
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					String Type: Class Default
					Editable? Class Default
				Display Settings
					Border? Class Default
					Word Wrap? Class Default
					Vertical Scroll? Class Default
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
				Message Actions
					On SAM_Create
						Call cDocWdog.UnHideIt(hWndItem)
						If cDocWdog.sNazn
							Set cDocWdog.dfNazn = cDocWdog.sNazn
							Call SalSendMsg(hWndItem, SAM_Validate, 0, 0)
			Data Field: dfSkN
				Class Child Ref Key: 115
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSk
				Class Child Ref Key: 48
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfValD1N
				Class Child Ref Key: 160
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfValD2N
				Class Child Ref Key: 131
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfValD2
				Class Child Ref Key: 66
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfD
				Class Child Ref Key: 132
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfK
				Class Child Ref Key: 133
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfLocDat
				Class Child Ref Key: 149
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Check Box: cbUgrnt
				Class Child Ref Key: 130
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
			Data Field: dfVytyagN
				Class Child Ref Key: 142
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Picture: pic1f
				Class Child Ref Key: 156
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				File Name:
				Storage: Class Default
				Picture Transparent Color: Class Default
				Fit: Class Default
				Scaling
					Width:  Class Default
					Height:  Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Tile To Parent? Class Default
				Border Color: Class Default
				Background Color: Class Default
				Message Actions
			Picture: pic2f
				Class Child Ref Key: 157
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				File Name:
				Storage: Class Default
				Picture Transparent Color: Class Default
				Fit: Class Default
				Scaling
					Width:  Class Default
					Height:  Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Tile To Parent? Class Default
				Border Color: Class Default
				Background Color: Class Default
				Message Actions
			Picture: pic3f
				Class Child Ref Key: 158
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				File Name:
				Storage: Class Default
				Picture Transparent Color: Class Default
				Fit: Class Default
				Scaling
					Width:  Class Default
					Height:  Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Tile To Parent? Class Default
				Border Color: Class Default
				Background Color: Class Default
				Message Actions
			Data Field: dfSub
				Class Child Ref Key: 167
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: dfSubN
				Class Child Ref Key: 166
				Class ChildKey: 0
				Class: cDocW
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
		Functions
			Function: oDoc
				Description: Оплатить  документ с прибамбасами
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: sFio
					String: sPasp
					String: sAtrt
					String: sAdr
					String: sDobr
					!
					Number: i
				Actions
					If CCK_NBU and cDocWdog.sTT = 'KK2'
						Set cDocWdog.m_sDrec = D_REC
						If cDocWdog.m_sDrec
							Set cDocWdog.m_sNazns = '11'
						Else
							Set cDocWdog.m_sNazns = '10'
					!
					If cDocWdog.sTT = sKV3 and cDocWdog.nKvA=GetBaseVal()
						Set cDocWdog.m_nSk=cDocWdog.dfSk
					! !!!!!!!!!!!!!!!!
					If cDocW.oDoc()
						! Перенос на просрочку 
						If nOper=1
							If SqlPrepareAndExecute( hSql(),"UPDATE cc_deal SET sos=13 WHERE nd=:N_ND ")
									   and SqlCommit( hSql() )
							Return TRUE
						Return TRUE
					Else
						Call SqlRollback( hSql() )
						Return FALSE
					! Return cDocW.oDoc()
					! If cDocW.oDoc()
						! While TRUE
							                                                                                                                                                                                                                                                                                                                                                          If not SqlPrepareAndExecute(hSql(),
									 "INSERT INTO cc_refv (nd,ref) VALUES (:cDocWdog.nNdog,:cDocWdog.m_nRef)")
								                                                                                                                                                                                                                                                                                                                                                          Break
							! проверка суммы
							! !!!!!!!!!!!!!!!!!!
							                                                                                                                                                                                                                                                                                                                                                          Set nU = nU - cDocWdog.A.S
							                                                                                                                                                                                                                                                                                                                                                          If nU = 0
								                                                                                                                                                                                                                                                                                                                                                          If SqlPrepareAndExecute(hSql(),
										"UPDATE cc_add SET refv=:cDocWdog.m_nRef WHERE nd=:cDocWdog.nNdog and adds=0")
									                                                                                                                                                                                                                                                                                                                                                          Call SqlCommit(hSql())
								                                                                                                                                                                                                                                                                                                                                                          Else
									                                                                                                                                                                                                                                                                                                                                                          Break
							                                                                                                                                                                                                                                                                                                                                                          Return TRUE
					! !!!!!!!!!!!!!!!!
			Function: F_TT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If cDocWdog.dfBankB=GetBankMfo()
						Set cDocWdog.nFli =  0
						If Subs(cDocWdog.dfNlsB,1,2)='10'
							Set cDocWdog.sTT = sKV3
							If SqlPrepareAndExecute(hSql(),"
									     SELECT sk INTO :cDocWdog.dfSk FROM tts WHERE tt=:cDocWdog.sTT ")
									and SqlFetchNext(hSql(), nFetchRes)
							If cDocWdog.nKvA=GetBaseVal()
								Set cDocWdog.nVob =KK3_NV
							Else
								Set cDocWdog.nVob =KK3_IV
						Else
							Set cDocWdog.sTT = sKV1
							! Set cDocWdog.nVob = 6
					Else
						Set cDocWdog.nFli =  1
						Set cDocWdog.sTT = sKV2
						! If SqlPrepareAndExecute(hSql(),
								  "SELECT vob INTO :cDocWdog.nVob FROM tts_vob WHERE tt=:cDocWdog.sTT ")
								and not SqlFetchNext(hSql(), nFetchRes)
							                                                                                                                                                                                                                                                                                                                        Set cDocWdog.nVob = 1
			Function: iDop
				Description: Вставить доп реквизиты
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					If sDop
						If not SqlPrepareAndExecute(hSql(), "INSERT INTO operw (ref,tag,value) VALUES (:m_nRef,'П',:sDop)")
							Call SqlRollback(hSql())
							Call MessageErrorEx('Невозможно вставить TAG П в OPERW')
							Return FALSE
					Return cDocW.iDop()
		Window Parameters
			Number: nOper !! 0-выдача, 1-пролонгация 2-погаш
			Number: nSumDog !! не исп
			Number: nKvDog
			Number: nRnk
			String: sAccA
			String: sAccB
			String: sMfoB
			Number: nNdog
			String: sNazn
			String: sPolu
			String: sNd
			Date/Time: dWida
			String: sKV1
			String: sKV2
			String: sKV3
			String: D_REC
			Window Handle: pbDisable
			Window Handle: pbRefreshG
		Window Variables
			Boolean: CCK_NBU
			String: sNamB
			Number: nU
			Number: nSupro
			Number: KK3_NV
			Number: KK3_IV
			Number: nVx
			String: sDop
		Message Actions
			On SAM_Create
				Set CCK_NBU = GetGlobalOption('CCK_NBU') = '1' 
				If CCK_NBU and (sMfoB=STRING_Null or sAccB = STRING_Null)
					Call SalMessageBox('При вводе договора не заданы платежные инструкции! Введите вручную!', 'Внимание!', MB_IconAsterisk)
				Call SalDisableWindow( cDocWdog.pbDisable )
				If SqlPrepareAndExecute(hSql(),  "SELECT to_number(val) INTO :cDocWdog.KK3_NV FROM params WHERE par='KK3_NV'")
						and not SqlFetchNext(hSql(), nFetchRes)
					Set cDocWdog.KK3_NV = 22
				If SqlPrepareAndExecute(hSql(),  "SELECT to_number(val) INTO :cDocWdog.KK3_NV FROM params WHERE par='KK3_NV'")
						and not SqlFetchNext(hSql(), nFetchRes)
					Set cDocWdog.KK3_NV = 22
				Set cDocWdog.m_sDrec = D_REC
				Set sDop = Subs(sNazn,161,200)
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Choose
				Set cDocWdog.sNlsA_TT = cDocWdog.sAccA
				Set cDocWdog.sNlsB_TT = cDocWdog.sAccB
				Set cDocWdog.nKvA_TT = cDocWdog.nKvDog
				Set cDocWdog.dfNazn = cDocWdog.sNazn
				Set cDocWdog.sBankB_TT = cDocWdog.sMfoB
				Set cDocWdog.dfNd = cDocWdog.sNd
				Set cDocWdog.bDocStart = TRUE
				Set cDocWdog.sTT = cDocWdog.sKV1
				If not SqlPrepareAndExecute(hSql(),
						"SELECT name, fli, flv, decode(:nOper,2,0,dk), flags 
						 INTO :cDocWdog.sTTN,:cDocWdog.nFli,:cDocWdog.nFlv,:cDocWdog.nDk,:cDocWdog.sFlags         
						 FROM tts  WHERE tt=:cDocWdog.sTT ") 
						or not SqlFetchNext(hSql(), nFetchRes)
					Call SalMessageBox("Нет описана операция " || sTT,   "Ошибка", MB_IconExclamation)
					Call SalDestroyWindow(hWndForm)
				Call cDocWdog.Flgs2aFlg(cDocWdog.sFlags)
				Call SalSetWindowText(hWndForm, 'Ввод документа - [ ' ||  cDocWdog.sTTN || ' ]')
				If not cDocWdog.aFlg[9]
					Set cDocWdog.nSk_TT = NUMBER_Null
				Call SalSendClassMessage(UM_Clear, 0, 0)
			On SAM_Destroy
				Call SalEnableWindow( cDocWdog.pbDisable )
				Call SalSendMsg( cDocWdog.pbRefreshG, SAM_Click, 0, 0 )
			On SAM_CreateComplete
				Call SalSendClassMessage(SAM_CreateComplete, 0, 0)
				Set cDocWdog.nVx = 0
				If cDocWdog.nOper = 2
					Call SalDisableWindow( cDocWdog.dfBankA )  
					Call SalDisableWindow( cDocWdog.dfBankB )  
					Call SalDisableWindow( cDocWdog.dfOkpoA ) 
					Call SalDisableWindow( cDocWdog.dfOkpoB ) 
					Call SalDisableWindow( cDocWdog.dfNamA ) 
					Call SalDisableWindow( cDocWdog.dfNamB )  
					Call SalDisableWindow( cDocWdog.dfKvA ) 
					Call SalDisableWindow( cDocWdog.dfKvB ) 
					Call SalDisableWindow( cDocWdog.dfNlsA ) 
					Call SalDisableWindow( cDocWdog.dfNlsB ) 
	Table Window: NDZ
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.275"
				Top:    0.229"
				Width:  15.5"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 100000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 2.143"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pb_Obnov2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRefresh
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.783"
						Top:    1.738"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Оновити Верхню та Нижню таблиці'
						On SAM_Click
							Call NDZ.NASELENIE(Sel1)
							Call SalSendMsg( NDZ.pbRefresh, SAM_Click, 0, 0 )
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.467"
						Top:    1.738"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 8513
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.383"
						Top:    1.738"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.983"
						Top:    1.738"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 8514
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   10.583"
						Top:    1.738"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 8515
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Pushbutton: pb_Add ! ПриСоединить 
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.983"
						Top:    1.738"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Arr1tou.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'При-Єднати забезпечення '
						On SAM_Click
							Set NDZ.nRowCurr = TBL_MinRow
							While SalTblFindNextRow( NDZ, NDZ.nRowCurr, ROW_Selected, 0)
								Call SalTblSetContext( NDZ, NDZ.nRowCurr )
								Set bTmp = SqlPrepareAndExecute(hSql(),"INSERT into PAWN_ACC(ACC) SELECT :NDZ.ACCZ FROM DUAL WHERE NOT EXISTS (SELECT 1 FROM PAWN_ACC WHERE ACC= :NDZ.ACCZ)")
								If bTmp
									! Call Debug(sGr||'sGr')
									If sGr = 'CP'
										Set bTmp = SqlPrepareAndExecute( hSql(),"INSERT into Cp_ACCP(ACC,id) values (:NDZ.ACCZ,:NDZ.nPar )" )
									Else If sGr = 'OVER'
										! Call DebugN(nPar)
										Set bTmp = SqlPLSQLCommand(hSql(),"M_ACCP(1,nPar, NDZ.ACCZ,2)" )
									Else
										If (NDZ.nPar=NUMBER_Null or NDZ.nPar=0)
											Set bTmp = 
													SqlPrepareAndExecute( hSql(),
													"INSERT into CC_ACCP(ACC,ACCS,pr_12) values (:NDZ.ACCZ,:NDZ.ACCS,2)" )
											! Set bTmp = SqlPLSQLCommand(hSql(), "cck.CC_M_ACCP( 1, NDZ.nPar, NDZ.ACCZ ) " )
											! Call Debug(sGr||'cc')
											Call DebugN(NDZ.nPar)
										Else
											If sGr =  STRING_Null
												Set bTmp = SqlPLSQLCommand(hSql(),"M_ACCP(1,NDZ.nPar, NDZ.ACCZ,3)" )
											Else
												Set bTmp = SqlPLSQLCommand(hSql(),"M_ACCP(1,NDZ.nPar, NDZ.ACCZ,1)" )
												! Call Debug(sGr)
									Call SqlCommitEx( hSql(), strTip ||Str(NDZ.KV2)||"/" ||NDZ.NLS2|| " до " || sTitl )
								Else
									Call SqlRollback(hSql())
							Call SalSendMsg( NDZ.pb_Obnov2, SAM_Click, 0, 0 )
				Pushbutton: pb_Del ! ОтСоединить
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbOk
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.583"
						Top:    1.738"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Arr1tod.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Від`Єднати забезпечення '
						On SAM_Click
							! Есть ли счета обеспечения привязанные к другим договорам
							! Call DebugN(nPar)
							If SqlPrepareAndExecute(hSql(),
									"SELECT nd INTO :lNd from  cc_accp p, accounts a
									   where p.acc=:NDZ.tbl.ACCZ and nvl(p.nd,0) not in (:nPar) and p.accs=a.acc and a.dazs is null  and rownum=1")
									and SqlFetchNext( hSql(), nFetchRes )
								! Call DebugN(lNd+1)
							Else
								! Нет других договоров к которым привязан залог (Куда перепривязать?)
								If SalModalDialog( dlg_SetNd, hWndForm, nNd,nTip ) =0
									Return 1
							! Call Debug('Есть др.договора или 0 нет')
							! Call DebugN(lNd)
							If lNd = 0
								! Нет привязанных договоров и введен счет перепривязки
								! Проверка корректности счета перепривязки
								If nTip = 1
									If SqlPrepareAndExecute(hSql(),
											"SELECT nd INTO :lNd  from cc_deal d where d.nd= :nNd and  sos<15")
											and SqlFetchNext( hSql(), nFetchRes )
									Else
										Call Debug('Договор не открыт!!!')
										Return 1
								If nTip = 2
									If SqlPrepareAndExecute(hSql(),
											"SELECT nd into :lNd from acc_over d where d.nd=:nNd and rownum=1") and SqlFetchNext( hSql(), nFetchRes )
										! Set bTmp = SqlPrepareAndExecute(hSql(),"INSERT into PAWN_ACC(ACC) SELECT :NDZ.ACCZ FROM DUAL WHERE NOT EXISTS (SELECT 1 FROM PAWN_ACC WHERE ACC= :NDZ.ACCZ)")
										! If bTmp
											                                  Call Debug('OVER')
											                                  Call DebugN(NDZ.tbl.ACCZ)
											                                  Call DebugN(lAcc_over)
											                                  Call DebugN(dNd)
											                                  Set bTmp = SqlPrepareAndExecute( hSql(),"INSERT into CC_ACCP(ACC,ACCS,pr_12,nd) values (:NDZ.tbl.ACCZ,:lAcc_over,2,:dNd)" )
											                                  Set bTmp = SqlPLSQLCommand(hSql(), "cck.CC_M_ACCP( 1, dNd, NDZ.tbl.ACCZ ) " )
											                                  Return 1
									Else
										Call Debug('Договор не открыт!!!')
										Return 1
								If nTip = 3
									If SqlPrepareAndExecute(hSql(),
											"SELECT nd INTO :lNd  from v_W4_ACC where nd= :nNd")
											and SqlFetchNext( hSql(), nFetchRes )
									Else
										Call Debug('Договор не открыт!!!')
										Return 1
							Set NDZ.nRowCurr = TBL_MinRow
							While SalTblFindNextRow( NDZ.tbl, NDZ.nRowCurr, ROW_Selected, 0)
								Call SalTblSetContext( NDZ.tbl, NDZ.nRowCurr )
								If NDZ.tbl.nOk =1 
									If sGr = 'CP'
										Set bTmp = SqlPrepareAndExecute( hSql(),"DELETE from Cp_ACCP where id=:NDZ.nPar and ACC=:NDZ.tbl.ACCZ ")
									Else
										! Call DebugN(nNd)
										! Call Debug('перепривязка кредиты')
										If (nNd = NUMBER_Null or nNd = 0)
											! Set bTmp = SqlPrepareAndExecute( hSql(),"DELETE from CC_ACCP where ACCS=:NDZ.ACCS and ACC=:NDZ.tbl.ACCZ ")
											! Call DebugN(nPar)
											Set bTmp = SqlPLSQLCommand(hSql(), "M_ACCP( 0,NDZ.nPar, NDZ.tbl.ACCZ,nTip ) " )
										Else
											! Call DebugN(NDZ.nPar)
											! Call DebugN(NDZ.tbl.ACCZ)
											Set bTmp = SqlPLSQLCommand(hSql(), "M_ACCP( 0, NDZ.nPar, NDZ.tbl.ACCZ,nTip ) " )
											! Call DebugN(nNd)
											! Call DebugN(NDZ.tbl.ACCZ)
											Set bTmp = SqlPLSQLCommand(hSql(), "M_ACCP( 1, nNd, NDZ.tbl.ACCZ,nTip ) " )
									If bTmp
										Call SqlCommitEx( hSql(), strTip ||Str(NDZ.KV2)||"/" ||NDZ.NLS2|| " до " || sTitl )
									Else
										Call SqlRollback(hSql())
							Call SalSendMsg( NDZ.pb_Obnov2, SAM_Click, 0, 0 )
				Pushbutton: pbZ
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.183"
						Top:    1.738"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Tudasuda.bmp
					Picture Transparent Color: White
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Gray
					Message Actions
						On SAM_Create
							Set strTip = 'Зв`язки рах.забезпечення та боргу'
						On SAM_Click
							Call Bars017r1 
									( NUMBER_Null, NUMBER_Null, NUMBER_Null,
									 " WHERE  ( KU_109.ND2 = "||Str(NDZ.nPar) || " or KU_109.ND1 = "||Str(NDZ.nPar)||")" )
				Child Table: tbl ! наши залоги
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Display Settings
						Window Location and Size
							Left:   -0.017"
							Top:    0.143"
							Width:  13.4"
							Width Editable? Yes
							Height: 1.512"
							Height Editable? Yes
						Visible? Yes
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						View: Table
						Allow Row Sizing? No
						Lines Per Row: Default
					Memory Settings
						Maximum Rows in Memory: 2000
						Discardable? No
					Contents
						Column: NZ
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Реф
									ДогЗабезп.
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: Number
							Justify: Left
							Width:  0.95"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: NK
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Реф
									КрДог
							Visible? No
							Editable? No
							Maximum Data Length: Default
							Data Type: Number
							Justify: Left
							Width:  1.05"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: NMK
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Забезпечувач
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: String
							Justify: Left
							Width:  3.233"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: PR_12
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Прз
									1/2
							Visible? No
							Editable? No
							Maximum Data Length: Default
							Data Type: Number
							Justify: Left
							Width:  0.567"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: NLS
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Рахунок 
									забезпеч
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: String
							Justify: Left
							Width:  1.883"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: KV
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Вал
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: Number
							Justify: Left
							Width:  0.55"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: S
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Сума
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: Number
							Justify: Right
							Width:  1.9"
							Width Editable? Yes
							Format: Decimal
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: ACCZ
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: ACCZ
							Visible? No
							Editable? No
							Maximum Data Length: Default
							Data Type: Number
							Justify: Left
							Width:  0.567"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: PAWN
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: Вид
									забезпеч
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: String
							Justify: Left
							Width:  1.167"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: NREE
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: № в
									реєстрі
							Visible? Yes
							Editable? No
							Maximum Data Length: Default
							Data Type: String
							Justify: Left
							Width:  1.15"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: nCol
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: ACCZ
							Visible? No
							Editable? No
							Maximum Data Length: Default
							Data Type: Number
							Justify: Left
							Width:  0.567"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
						Column: nOk
							Class Child Ref Key: 0
							Class ChildKey: 0
							Class:
							Property Template:
							Class DLL Name:
							Title: ACCZ
							Visible? No
							Editable? No
							Maximum Data Length: Default
							Data Type: Number
							Justify: Left
							Width:  0.567"
							Width Editable? Yes
							Format: Unformatted
							Country: Default
							Input Mask: Unformatted
							Cell Options
								Cell Type? Standard
								Multiline Cell? No
								Cell DropDownList
									Sorted? Yes
									Vertical Scroll? Yes
									Auto Drop Down? No
									Allow Text Editing? Yes
								Cell CheckBox
									Check Value:
									Uncheck Value:
									Ignore Case? Yes
							List Values
							Message Actions
					Functions
					Window Variables
					Message Actions
						On SAM_FetchRowDone
							If hWndForm.tbl.nCol = 1
								Call SetTblRowColor( hWndForm, COLOR_Periwinkle )
							If nPar > 0
								If SqlPrepareAndExecute(hSqlAux(),
										"SELECT 0  into :NDZ.tbl.nOk 
										 from cc_accp z , nd_acc n
										 where z.acc = :NDZ.tbl.ACCZ and n.acc = z.accs and n.nd <> nvl(z.nd ,0)  " ) 
										and SqlFetchNext(hSqlAux(), nFetchRes)
									Call XSalTblSetRowBackColor( hWndForm, lParam,  COLOR_Gray )
								Else
									Set NDZ.tbl.nOk =1   
				Data Field: dKVK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.367"
							Top:    1.738"
							Width:  0.733"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Вал боргу' )
				Data Field: dNLSK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.117"
							Top:    1.738"
							Width:  2.117"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рах.боргу' )
				Data Field: dNMSK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   3.25"
							Top:    1.738"
							Width:  3.667"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва рах.боргу' )
		Contents
			Column: NZ2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						ДогЗабезп
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.267"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NK2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: MAX Реф
						КрДог 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.317"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Забезпечувач
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.25"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMS2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва рахунку
						забезпечення
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.667"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
						забезпеч
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.033"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.033"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACCZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.667"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PAWN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вид
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.15"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NREE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № в
						реєстрі
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.15"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nCol2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № в
						реєстрі
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.15"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			! все залоги, какие есть по данному договору
			Function: NASELENIE
				Description:
				Returns
				Parameters
					String: Sel_
				Static Variables
				Local variables
				Actions
					Call SalWaitCursor( TRUE )
					Call SalTblPopulate(NDZ.tbl, hSql(),Sel_, TBL_FillAll)
					Call SalWaitCursor(FALSE)
		Window Parameters
			Number: nTip_Ur
			Number: nPar  ! Реф КД или ID ценной бумаги
			String: sGr
			String: sRnk
			Number: ACCS
		Window Variables
			Number: nRowCurr
			Number: lNd
			Number: lAcc_over
			Number: nNd
			Boolean: bTmp
			Number: nTip
			String: sTitl
			String: Sel1
			String: Sel2
		Message Actions
			On SAM_Create
				Call SalCenterWindow( hWndForm )
				Call ShowApdVersion('05')
				Set hWndForm.NDZ.fFilterAtStart = TRUE
				If sGr = 'CP'
					If SqlPrepareAndExecute(hSql(),
							"SELECT kv,cp_id INTO :dKVK,:dNLSK FROM cp_kod  where id= :nPar")
							and SqlFetchNext( hSql(), nFetchRes )
					Set sTitl = "ЦП вн.№=" ||Str(nPar) || ", Зовн.код=" || Str(dKVK) || "/" ||dNLSK
					! ЦБ  Верхняя табл - эти есть
					Set Sel1 =
							 "SELECT decode(a.dazs,null,0,1), z.ACC, a.NLS, a.KV, abs(a.ostc)/100, c.NMK, p.NDZ, z.id,
							        (select name from cc_pawn where pawn= p.pawn)
							 INTO :NDZ.tbl.nCol,:NDZ.tbl.ACCZ,:NDZ.tbl.NLS ,:NDZ.tbl.KV,:NDZ.tbl.S,:NDZ.tbl.NMK,
							      :NDZ.tbl.NZ,  :NDZ.tbl.NK,:NDZ.tbl.PAWN
							 FROM accounts a, customer c, pawn_acc p, cP_accp z
							 WHERE  z.acc = a.acc and a.rnk = c.rnk and z.acc=p.acc and z.id = :nPar
							 ORDER  BY 1 "
					! ЦБ Нижняя табл - этих нет, но могут быть
					Set NDZ.strSqlPopulate =  "SELECT distinct
							         decode(accounts.dazs,null,0,1),c.NMk, accounts.NMS, accounts.NLS, accounts.KV, abs(accounts.ostc)/100, z.ACC
							  INTO  :NDZ.nCol2,:NDZ.NMK2, :NDZ.NMS2, :NDZ.NLS2, :NDZ.KV2, :NDZ.S2, :NDZ.ACCZ
							  FROM  accounts , customer c, cP_accp z
							  WHERE z.id<>" || Str(nPar)||" and accounts.acc=z.acc and accounts.rnk=c.rnk and accounts.dazs is null
							 ORDER BY accounts.nls "
				Else
					If SqlPrepareAndExecute( hSql(),"SELECT kv,nls,nms INTO :dKVK,:dNLSK,:dNMSK FROM accounts where acc=:ACCS ")
							and SqlFetchNext( hSql(), nFetchRes )
					Set sTitl = "Дог.вн.№=" ||Str(nPar) || ", Рах.боргу =" || Str(dKVK) || "/" ||dNLSK
					! КД Верхняя табл - эти есть
					Set Sel1 =
							 "SELECT distinct 
							         decode(a.dazs,null,0,1),z.ACC, a.NLS, a.KV, abs(a.ostc)/100, c.NMK, p.NREE,
							           (select name from cc_pawn where pawn= p.pawn)
							 INTO :NDZ.tbl.nCol, :NDZ.tbl.ACCZ, :NDZ.tbl.NLS, :NDZ.tbl.KV, :NDZ.tbl.S, :NDZ.tbl.NMK,
							      :NDZ.tbl.NREE, :NDZ.tbl.PAWN
							 FROM accounts a, customer c,  pawn_acc p ,
							    ( select * from cC_accp 
							      where accs in
							      (select acc from nd_acc where nd = :nPar union all 
							       select to_number(:ACCS) from dual) 
							     )  z 
							WHERE z.acc = a.acc and a.rnk = c.rnk and z.acc = p.acc "
					! КД Нижняя табл - этих нет, но могут быть
					Set NDZ.strSqlPopulate = 
							"SELECT distinct c.NMk, accounts.NMS, accounts.NLS, accounts.KV, 
							       abs(accounts.ostc)/100, z.ACC
							  INTO  :NDZ.NMK2,:NDZ.NMS2,:NDZ.NLS2,:NDZ.KV2,:NDZ.S2,:NDZ.ACCZ
							  FROM accounts, customer c,  cC_accp z 
							  where  accounts.acc=z.acc and accounts.rnk=c.rnk and accounts.dazs is null
							 ORDER BY accounts.nls "
				Call SalSetWindowText( NDZ, "Підбір договорів забезпеч. для "|| sTitl )
				Call NDZ.NASELENIE(Sel1)
				If NDZ.nTip_Ur  = 90 
					Call SalDisableWindow( NDZ.pb_Add )
					Call SalDisableWindow( NDZ.pb_Del )
					Call SalDisableWindow( NDZ.pbZ )
				Set NDZ.strFilterTblName = "ACCOUNTS"
				Call SalSendClassMessage(SAM_Create, 0, 0)
	Dialog Box: dlg_IRR
		Class:
		Property Template:
		Class DLL Name:
		Title: Угегулирование нач.% по методу эф.ставки
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   0.625"
				Top:    0.625"
				Width:  8.167"
				Width Editable? Yes
				Height: 2.726"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Data Field: Dat
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.583"
						Top:    0.821"
						Width:  3.0"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: dd-MM-yyyy
					Country: Default
					Font Name: Default
					Font Size: 12
					Font Enhancement: Bold
					Text Color: Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Утвердить
				Window Location and Size
					Left:   2.583"
					Top:    1.238"
					Width:  1.5"
					Width Editable? Yes
					Height: 0.5"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Enter
				Font Name: Arial Cyr
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set Dat_IRR = Dat
						Call SalEndDialog(hWndForm, 1)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сброс
				Window Location and Size
					Left:   4.083"
					Top:    1.238"
					Width:  1.5"
					Width Editable? Yes
					Height: 0.5"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Esc
				Font Name: Arial Cyr
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, 0)
			Background Text: Начислить по дату
				Resource Id: 53361
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.283"
					Top:    0.488"
					Width:  3.6"
					Width Editable? Yes
					Height: 0.333"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: 12
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dTxt
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.583"
						Top:    0.071"
						Width:  7.2"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
		Functions
		Window Parameters
			String: sTitl
			Receive Date/Time: Dat_IRR
		Window Variables
			String: sTmp
		Message Actions
			On SAM_Create
				Set dTxt = sTitl
				Set Dat = Dat_IRR
				Call SalCenterWindow(hWndForm)
	Form Window: NAT
		Class: cQuickTabsForm
		Property Template:
		Class DLL Name:
		Title: Кредитня угода з фізичною особою
		Icon File:
		Accesories Enabled? Yes
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.375"
				Top:    1.719"
				Width:  12.733"
				Width Editable? Class Default
				Height: 6.452"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pb_F6
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbRefresh
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F6
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: White
					Message Actions
						On SAM_Create
							Set strTip = 'F6. Новий '
						On SAM_Click
							Call F_NULL()
				Pushbutton: pb_F1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbHelp
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: F1
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Pach.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'F1. Види банкiвських продуктiв'
						On SAM_Click
							Call F_DISA()
							Set sTmp =''
							Call FunNSIGetFiltered
									("CC_POTR", "NAME",
									 "CC_POTR.FLAG=1 and CC_POTR.ID in (select ID from CC_TOBO_POTR)", 
									 sTmp, NAME )
							Set KRDN = NUMBER_Null
							Call SalColorSet( KRDS_, COLOR_IndexWindow, nColR )
							If sTmp !=''
								If SqlPrepareAndExecute( hSql(),
										"SELECT p.ID,p.NAME,p.IR,p.MES,p.SMAX/100,p.PRK,p.METR90,p.MODE_GPK,
										     p.SURVEY, s.SURVEY_NAME, m.name, p.BASEY, b.NAME, nvl(KRDN,0),
										     p.pawn, w.name 
										 INTO :ID,:NAME,:IR,:MES,:SMAX,:PRK,:METR90,:MODE_GPK,
										      :SURVEY,:SURVEY_NAME, :NAME90, :BASEY, :SBASEY, :KRDN,
										      :nPAWN, :sPAWN 
										 from CC_POTR p, int_metr m, SURVEY s, basey b, cc_pawn w
										 WHERE p.basey=b.basey and s.SURVEY_ID=p.SURVEY 
										   and p.METR90 = m.metr (+) and p.pawn = w.pawn (+) 
										   and  p.ID="||sTmp )
										and SqlFetchNext( hSql(), nFetchRes )  
									Set YAR = MES/12
									Set NAME_GPK = 
											IifS (MODE_GPK = 1, "Равними долями кредит",
											IifS (MODE_GPK = 2,"В кінці сроку","Рівними долями кредит з процентами"))
									Call F_ENA ()
									Call cmb_TORG.Init(cmb_TORG)
									Call cmb_TORG.Populate( hSql(), 
											 "TORG_ID", "TORG_NAME", "V_CC_TOBO_TORG_POTR_SCHEME",
											" WHERE POTR_ID="||Str(ID)||" ORDER BY TORG_ID " )
									! Set
							Call SalMapEnterToTab( TRUE )
				Pushbutton: pb_Exit
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbCancel
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Esc
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Default
					Message Actions
						On SAM_Create
							Set strTip = 'ESC. Завершити  '
						On SAM_Click
							Call SalDestroyWindow(hWndForm)
				Data Field: ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.75"
							Top:    0.095"
							Width:  0.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код банкiвського продукту')
				Data Field: NAME
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.65"
							Top:    0.095"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва банкiвського продукту' )
				Data Field: IR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.05"
							Top:    0.095"
							Width:  0.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рiчна % ставка' )
				Data Field: BASEY
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.45"
							Top:    0.262"
							Width:  0.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код базового року для %%' )
				Data Field: SBASEY
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.75"
							Top:    0.095"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва базового року для %%' )
				Data Field: MES
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.55"
							Top:    0.095"
							Width:  0.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Макс.довжина дiї (мiс)' )
				Data Field: YAR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.25"
							Top:    0.095"
							Width:  0.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Макс.довжина дiї (років)' )
				Data Field: SMAX
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.85"
							Top:    0.095"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Макс.сума кредиту' )
				Data Field: PRK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.65"
							Top:    0.095"
							Width:  0.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, '% вiд суми для ЩОМIС.комiсiї')
				Data Field: METR90
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.75"
							Top:    0.512"
							Width:  0.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код методики ЩОМIСЯЧНОЇ комiсiї')
				Data Field: NAME90
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.55"
							Top:    0.345"
							Width:  1.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва методики ЩОМIСЯЧНОЇ комiсiї')
				Data Field: MODE_GPK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.25"
							Top:    0.762"
							Width:  0.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код моделі погашення кредиту')
				Data Field: NAME_GPK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.65"
							Top:    0.345"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва моделі погашення кредиту')
				Data Field: SURVEY
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.75"
							Top:    0.762"
							Width:  0.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код мотодики (анкети)')
				Data Field: SURVEY_NAME
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.05"
							Top:    0.345"
							Width:  2.5"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва мотодики (анкети)')
				Data Field: nPAWN
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.75"
							Top:    1.012"
							Width:  0.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код виду забезпечення')
				Data Field: sPAWN
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.55"
							Top:    0.345"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва виду забезпечення')
		Contents
			Picture: picTabs
.data CLASSPROPS
0000: 5461624F7269656E 746174696F6E0001 0000005461624C65 66744D617267696E
0020: 0002003000005461 6243757272656E74 0006004E616D6531 0000546162426F74
0040: 746F6D4D61726769 6E00020030000054 616250616765436F 756E740002003100
0060: 005461624C616265 6C73008000D2E5F1 F22DD1EAEEF0E8ED E32C20E4E0EDB320
0080: 2009D2E5F1F22DD1 EAEEF0E8EDE32C20 E4E0EDB32C20F0EE E7F0E0F5F3EDEEEA
00A0: 2009C4EEE4E0F2EA EEE2E020B3E4E5ED F22EEFEEE7E8F7E0 EBFCEDE8EAE02020
00C0: 09C4EEE4E0F2EAEE E2E020B3EDF42EEF EE20EAF0E5E4E8F2 F32009C4EEE4E0F2
00E0: EAEEE2E020E0EDEA E5F2E02000005461 624E616D6573001E 004E616D6531094E
0100: 616D6532094E616D 6533094E616D6534 094E616D65350000 5461625269676874
0120: 4D617267696E0002 0030000054616244 7261775374796C65 000B0057696E3935
0140: 5374796C65000054 6162466F726D5061 6765730005000909 0909000054616254
0160: 6F704D617267696E 0002003000000000 0000000000000000 0000000000000000
0180: 00000000
.enddata
.data CLASSPROPSSIZE
0000: 8401
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cQuickTabsForm
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   Class Default
					Top:    Class Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				File Name:
				Storage: Class Default
				Picture Transparent Color: Class Default
				Fit: Class Default
				Scaling
					Width:  Class Default
					Height:  Class Default
				Corners: Class Default
				Border Style: Class Default
				Border Thickness: Class Default
				Tile To Parent? Yes
				Border Color: Default
				Background Color: 3D Face Color
				Message Actions
			! 1  Тест-Скоринг, дані  
			Pushbutton: pb_Main
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbHelp
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   9.283"
					Top:    0.726"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Yes
				Keyboard Accelerator: F10
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\CUSTCLSD.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Maize
				Message Actions
					On SAM_Create
						Set strTip = 'Ввести тестові дані'
					On SAM_Click
						Call F_Main()
			Background Text: Дата народження
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Resource Id: 62851
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.183"
					Top:    0.512"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Midnight Blue
				Background Color: Default
			Data Field: BDAT_
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.583"
						Top:    0.488"
						Width:  2.533"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата народження позичальника')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_Validate
						Return F_BDAT()
			Background Text: Вік(років)
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 3654
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   7.683"
					Top:    0.512"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Midnight Blue
				Background Color: Default
			Data Field: YAR_
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.983"
						Top:    0.488"
						Width:  1.633"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Вік позич.(років)')
			Data Field: OKPO_
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.583"
						Top:    0.738"
						Width:  2.533"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Ід.код позичальника')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_Validate
						Return F_BDAT()
			Data Field: dFIO
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.083"
						Top:    0.738"
						Width:  6.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Check Box: cb_FAM
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Одружений
				Window Location and Size
					Left:   0.583"
					Top:    1.238"
					Width:  2.533"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Midnight Blue
				Background Color: Default
				Message Actions
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Background Text: Кількість неповноліт.дітей
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 3655
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.183"
					Top:    1.512"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Midnight Blue
				Background Color: Default
			Data Field: KINDER_
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.583"
						Top:    1.488"
						Width:  2.533"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Кількість неповнолітніх дітей')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_Validate
						If KINDER_ <0 and KINDER_ != NUMBER_Null
							Call SalMessageBox("Кількість неповноліт.дітей",
									"Помилка ! ", MB_IconStop)
							Set KINDER_ = NUMBER_Null
							Return VALIDATE_Cancel
						Return VALIDATE_Ok
			Background Text: Час прож на ост.місці (років)
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 3657
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.183"
					Top:    1.762"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Midnight Blue
				Background Color: Default
			Data Field: TERM_
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.583"
						Top:    1.738"
						Width:  2.533"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Час(років) проживання на ост.місці')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_Validate
						If YAR_!=NUMBER_Null and TERM_ != NUMBER_Null and (YAR_- TERM_ < 0)
							Call SalMessageBox("Нереальний Час проживання ",
									"Помилка ! ", MB_IconStop)
							Set TERM_ = NUMBER_Null
							Return VALIDATE_Cancel
						Return VALIDATE_Ok
			Background Text: Стаж роб на ост.місці (років)
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 3656
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.183"
					Top:    2.012"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Midnight Blue
				Background Color: Default
			Data Field: STAG_
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.583"
						Top:    1.988"
						Width:  2.533"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Стаж (років) на ост.місці роботи')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_Validate
						If YAR_ !=NUMBER_Null and STAG_ != NUMBER_Null and ( YAR_- STAG_ < 16 )
							Call SalMessageBox("Нереальний Стаж ",
									"Помилка ! ", MB_IconStop)
							Set STAG_ = NUMBER_Null
							Return VALIDATE_Cancel
						Return VALIDATE_Ok
			Combo Box: cmb_RAB
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.583"
					Top:    2.321"
					Width:  3.2"
					Width Editable? Class Default
					Height: 1.81"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Вид зайнятості' )
					On SAM_Create
						Call cmb_RAB.Init(hWndItem)
						Call cmb_RAB.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=18 ORDER BY opt_id" )
						Set nRAB = 175
						Call cmb_RAB.SetSelectById (nRAB)
					On SAM_Click
						Set nRAB = cmb_RAB.GetKey( SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Combo Box: cmb_RANG
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.583"
					Top:    2.571"
					Width:  3.2"
					Width Editable? Class Default
					Height: 2.429"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Посадова ієрархія' )
					On SAM_Create
						Call cmb_RANG.Init(hWndItem)
						Call cmb_RANG.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=19 ORDER BY opt_id" )
						Set nRANG = 180
						Call cmb_RANG.SetSelectById (nRANG)
					On SAM_Click
						Set nRANG = cmb_RANG.GetKey( SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Combo Box: cmb_OSVITA
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.583"
					Top:    2.821"
					Width:  3.2"
					Width Editable? Class Default
					Height: 2.429"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Освіта' )
					On SAM_Create
						Call cmb_OSVITA.Init(hWndItem)
						Call cmb_OSVITA.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=20 ORDER BY opt_id" )
						Set nOSVITA = 184
						Call cmb_OSVITA.SetSelectById (nOSVITA)
					On SAM_Click
						Set nOSVITA = cmb_OSVITA.GetKey( SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Combo Box: cmb_KV
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   5.983"
					Top:    1.488"
					Width:  3.2"
					Width Editable? Class Default
					Height: 1.19"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Вал кредиту' )
					On SAM_Create
						Call cmb_KV.Init(hWndItem)
						Call cmb_KV.Populate( hSql(), "KV", "NAME", "TABVAL", " ORDER BY KV desc" )
						Set nKV = n980
						Call cmb_KV.SetSelectById (nKV)
						Call F_SUM()
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_Click
						Set nKV = cmb_KV.GetKey( SalListQuerySelection(hWndItem))
						Return F_SUM()
			Data Field: nKV
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.983"
						Top:    1.988"
						Width:  0.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Числовий код валюти')
			Data Field: KURS
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.683"
						Top:    1.988"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Курс валюти')
			Background Text: Сума кр (в вал)
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 3658
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   7.683"
					Top:    1.762"
					Width:  1.5"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Red
				Background Color: Default
			Data Field: PV_
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   5.983"
						Top:    1.738"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Початкова Сума кредиту в валюті')
					On SAM_Validate
						Return F_SUM()
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: PG_
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.583"
						Top:    1.988"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Початкова Сума кредиту в еквіваленті')
			Background Text: Cрок (в міс)
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 3659
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   7.683"
					Top:    2.345"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Red
				Background Color: Default
			Data Field: MES_
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   5.983"
						Top:    2.321"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Cрок кредиту в міс ')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_Validate
						If MES_ < 0
							Call SalMessageBox("Cрок кредиту <= 0 ",
									"Помилка ! ", MB_IconStop)
							Set MES_ = NUMBER_Null
							Return VALIDATE_Cancel
						Else If MES_ > MES
							Call SalMessageBox("Cрок кредиту більше максимально-допустимого "||Str(MES),
									"Помилка ! ", MB_IconStop)
							Set MES_ = NUMBER_Null
							Return VALIDATE_Cancel
						Return VALIDATE_Ok
			Combo Box: cmb_IST
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   5.983"
					Top:    2.571"
					Width:  3.2"
					Width Editable? Class Default
					Height: 0.881"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Кредитна історія' )
					On SAM_Create
						Call cmb_IST.Init(hWndItem)
						Call cmb_IST.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=25 ORDER BY opt_id" )
						Set nIST = 199
						Call cmb_IST.SetSelectById (nIST)
					On SAM_Click
						Set nIST = cmb_IST.GetKey( SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Combo Box: cmb_DEP
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6531000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   5.983"
					Top:    2.821"
					Width:  3.2"
					Width Editable? Class Default
					Height: 0.726"
					Height Editable? Class Default
				Visible? Yes
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Наявність депозитних вкладів' )
					On SAM_Create
						Call cmb_DEP.Init(hWndItem)
						Call cmb_DEP.Populate( hSql(), "OPT_ID", "OPT_VAL", "SURVEY_ANSWER_OPT", " WHERE list_id=26 ORDER BY opt_id" )
						Set nDEP = 205
						Call cmb_DEP.SetSelectById (nDEP)
					On SAM_Click
						Set nDEP = cmb_DEP.GetKey( SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			! 2 Тест-Скоринг, дані, розрахунок 
			Child Table: tb_Dox
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.15"
						Top:    0.405"
						Width:  11.633"
						Width Editable? Yes
						Height: 3.083"
						Height Editable? Yes
					Visible? No
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: Kod_D
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.5"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: Nam_D
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Стаття
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  5.933"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: Poz
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Позич.
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  Default
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: Por_1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Поруч.-1
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.083"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: Por_2
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Поруч.-2
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.0"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: Por_3
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Поруч.-3
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.067"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Call SalTblPopulate( tb_Dox, hSql(),
								"select QUEST_ID_P,QUEST_NAME 
								 into :Kod_D, :Nam_D
								 from SURVEY_QUEST 
								 where SURVEY_ID =1 and  QUEST_ID_P in (83,84,85,86,87,88,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111)  
								 order by QGRP_ID, QUEST_ORD", 
								TBL_FillAll )
					On SAM_RowValidate
						Call SalTblSetRowFlags( tb_Dox, SalTblQueryContext(tb_Dox), ROW_New,  TRUE )
					On SAM_RowSetContext
						Call SalTblSetRowFlags( tb_Dox, SalTblQueryContext(tb_Dox), ROW_New,  TRUE )
			Background Text: Чист міс.дох (грн)
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Resource Id: 9420
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.283"
					Top:    3.595"
					Width:  1.7"
					Width Editable? Yes
					Height: 0.321"
					Height Editable? Yes
				Visible? No
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Red
				Background Color: Default
			Data Field: DOX_
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.883"
						Top:    3.571"
						Width:  1.633"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Center
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Чистий місячний дохід')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					! On SAM_Validate
						                                                                                                                                                                               If DOX_ <=0
							                                                                                                                                                                               Call SalMessageBox(" Чистий дохід <= 0",
									"Помилка ! ", MB_IconStop)
							                                                                                                                                                                               Set DOX_ = NUMBER_Null
						                                                                                                                                                                               Return VALIDATE_Ok
			Data Field: KRDN
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.583"
						Top:    3.571"
						Width:  1.633"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Center
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Sky
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Порогова Кредитоспроможність')
			Pushbutton: pb_F10
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbHelp
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.283"
					Top:    3.571"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: F10
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\EXECUTE.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'F10. Виконати розрахунок Кредитоспроможності'
					On SAM_Click
						Call F_RUN()
			Data Field: KRDS_
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6532000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.783"
						Top:    3.571"
						Width:  1.633"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Center
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Salmon
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Розрахована Кредитоспроможність')
			! 3 Додаткова ідент.позичальника  
			Data Field: FIO_
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.95"
						Top:    0.845"
						Width:  6.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'ПІБ позичальника')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Combo Box: cmb_DOK
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.95"
					Top:    1.095"
					Width:  6.0"
					Width Editable? Class Default
					Height: 2.274"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Вид документу, 
								що засвідчує особу позичальника' )
					On SAM_Create
						Call cmb_DOK.Init(hWndItem)
						Call cmb_DOK.Populate( hSql(), "PASSP",  "NAME", "PASSP",
								" WHERE PASSP >0 ORDER BY PASSP " )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_Click
						Set nDOK = cmb_DOK.GetKey( SalListQuerySelection(hWndItem))
			Data Field: SER_
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.95"
						Top:    1.345"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Серія документу ')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: NUM_
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.95"
						Top:    1.345"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '№ документу ')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: DATV_
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.95"
						Top:    1.345"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата выдачі документу ')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: KEM_
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.95"
						Top:    1.595"
						Width:  6.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Ким виданий документ ')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: REG_
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.95"
						Top:    1.845"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Область')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: DST_ 
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.95"
						Top:    1.845"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Район')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: TWN_
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.95"
						Top:    1.845"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Місто/село ')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: IDX_
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.95"
						Top:    2.095"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Почтовий індекс ')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: STR_
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.95"
						Top:    2.095"
						Width:  4.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Вулиця, буд., квартира ')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: ADR
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.95"
						Top:    2.345"
						Width:  6.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Повна адреса ')
			Check Box: cb_Email
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: SMS, Email
				Window Location and Size
					Left:   0.95"
					Top:    2.679"
					Width:  2.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Інформувати по SMS,Email' )
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: TEL1_
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.95"
						Top:    2.679"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Контактний телефон-1')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: TEL2_
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.95"
						Top:    2.679"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Контактний телефон-2')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: KONT
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6533000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.95"
						Top:    2.929"
						Width:  6.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Додаткова інф.для контакту')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			! 4 Додаткова інф.по кредиту 
			Combo Box: cmb_TORG
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   1.85"
					Top:    0.702"
					Width:  6.4"
					Width Editable? Class Default
					Height: 2.738"
					Height Editable? Class Default
				Visible? No
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Торговець та Платіжні інструкції' )
					On SAM_Click
						Set nTORG = cmb_TORG.GetKey( SalListQuerySelection(hWndItem))
						If nTORG = 0
							Call SalEnableWindow( OKPO_P ) 
							Call SalEnableWindow( MFO_P ) 
							Call SalEnableWindow( NLS_P ) 
							Call SalEnableWindow( pb_1002 )
						Else
							If SqlPrepareAndExecute( hSql(),
									"SELECT t.MFOP, t.NLSP, t.OKPOP, b.nb
									 INTO :MFO_P,:NLS_P,:OKPO_P, :NB
									 from CC_torg t, banks b WHERE t.ID = :nTORG and t.MFOP = b.mfo " )
									and SqlFetchNext( hSql(), nFetchRes )  
								Call SalDisableWindow( OKPO_P ) 
								Call SalDisableWindow( MFO_P ) 
								Call SalDisableWindow( NLS_P ) 
								Call SalDisableWindow( pb_1002 ) 
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Pushbutton: pb_1002
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbSwitch
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   8.25"
					Top:    0.679"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Кредит готівкою'
					On SAM_Click
						Set OKPO_P = GetBankOkpoS()
						Set MFO_P = BankMfo
						Set NLS_P = NLS_1002
						Set cmb_TORG = GetBankName()
			Data Field: OKPO_P
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.85"
						Top:    1.012"
						Width:  2.333"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'ОПКО згідно пл.інструкції')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: MFO_P
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.15"
						Top:    1.012"
						Width:  2.333"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'МФО банку згідно пл.інструкції')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_Validate
						Set NB = GetValueStr("SELECT nb FROM banks WHERE mfo=" || MFO_P)
						Set NLS_P =''
						Return VALIDATE_Ok
			Data Field: NLS_P
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.45"
						Top:    1.012"
						Width:  2.333"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Рахунок згідно пл.інструкції')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
					On SAM_Validate
						If NLS_P != STRING_Null
							If Vkrz2(MFO_P,NLS_P) != NLS_P
								Call SalMessageBox("Контр.розряд",
										"Помилка ! ", MB_IconStop)
								Return VALIDATE_Cancel
						Return VALIDATE_Ok
			Data Field: NB
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.85"
						Top:    1.262"
						Width:  6.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Назва банку згідно пл.інструкції')
			Data Field: SUMZ
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.85"
						Top:    1.512"
						Width:  2.333"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Center
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сума забезпечення в грн')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Data Field: PAWN
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   1.85"
						Top:    1.845"
						Width:  6.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Додаткова інф.про забезпечення')
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Pushbutton: pb_KD
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbHelp
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.817"
					Top:    2.119"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: F10
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\SAVE_M.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'Ввести КД'
					On SAM_Click
						If F_SAVE_KD()
							Call SalEnableWindow( pb_PR_1 ) 
							Call SalEnableWindow( pb_PR_2 ) 
						Else
							Call SalDisableWindow( pb_PR_1 ) 
							Call SalDisableWindow( pb_PR_2 ) 
			Pushbutton: pb_PR_1
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbHelp
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   2.817"
					Top:    2.119"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: F10
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\WORD.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'Друкувати КД'
					On SAM_Click
						! Call F_RUN()
			Pushbutton: pb_PR_2
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbHelp
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   3.317"
					Top:    2.119"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: F10
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\BACK.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = 'Друкувати ГПК'
					On SAM_Click
						! Call F_RUN()
			! 5 Додаткова анкета 
			Pushbutton: pb_Ank
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6535000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbInsert
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   7.45"
					Top:    0.679"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? No
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\CUSTCLSD.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call F_WEB ()
					On SAM_Create
						Set strTip = 'Додаткові дані анкети (WEB)'
			!
		Functions
			Function: F_SAVE_KD
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: RNK_
					Number: PND_
					Number: SUM_CASH_
					Number: PREF_
				Actions
					If FIO_ = STRING_Null OR SalStrLength( FIO_ ) < 3 
							OR cmb_DOK = STRING_Null OR KEM_ = STRING_Null OR DATV_ = DATETIME_Null
							OR SER_ = STRING_Null OR NUM_ = STRING_Null 
							OR IDX_ = STRING_Null OR REG_ = STRING_Null OR DST_ = STRING_Null 
							OR TWN_ = STRING_Null OR STR_ = STRING_Null 
							OR (nPAWN != NUMBER_Null AND SUMZ = NUMBER_Null)
						Call SalMessageBox(
								"Не введено ВСІ необхідні дані для реєстрації
								 Клієнта-Позичальника та КД ",
								"Помилка ! ", MB_IconStop)
						Return FALSE
					!
					If SqlPLSQLCommand( hSql(), 
							"CCWebPK.REGISTER_CREDIT
							( RNK_, PND_, PREF_, FIO_, BDAT_, OKPO_, SER_, NUM_, KEM_, DATV_, 
							  IDX_, REG_, DST_, TWN_ , STR_ ,TEL1_,TEL2_, 
							  nKV , nTORG, ID,cmb_TORG,MFO_P,NLS_P,OKPO_P,SUMZ, SUM_CASH_, 
							  BankDate, PAWN )" ) 
							and SqlCommitEx( hSql(),'Открыт КД, реф='|| Str(PND_) ) 
						Call MessageNoWait('Открыт КД, реф='|| Str(PND_),'Сообщение',3,0)
						Return TRUE
					!
					Call SqlRollback(hSql())
					Call MessageNoWait('Неуспешное сохранение КД', 'Ошибка', 0, 1)
					Return FALSE
			Function: D_Ins
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					If TRUE
						Call SalEnableWindow( OKPO_ ) 
						Call SalEnableWindow( BDAT_ ) 
						Call SalDisableWindow( FIO_ )
						! Call SalDisableWindow( OKPO_ ) 
						Call SalDisableWindow( cmb_DOK )
						Call SalDisableWindow( KEM_ ) 
						Call SalDisableWindow( DATV_ ) 
						Call SalDisableWindow( SER_ ) 
						Call SalDisableWindow( NUM_ ) 
						Call SalDisableWindow( IDX_ ) 
						Call SalDisableWindow( REG_ ) 
						Call SalDisableWindow( DST_ ) 
						Call SalDisableWindow( TWN_ ) 
						Call SalDisableWindow( STR_ ) 
						Call SalDisableWindow( cb_Email ) 
						Call SalDisableWindow( TEL1_ ) 
						Call SalDisableWindow( TEL2_ ) 
						Call SalDisableWindow( KONT ) 
						Call SalDisableWindow( cmb_TORG ) 
						Call SalDisableWindow( pb_1002 ) 
						Call SalDisableWindow( MFO_P ) 
						Call SalDisableWindow( NLS_P ) 
						Call SalDisableWindow( OKPO_P ) 
						Call SalDisableWindow( SUMZ ) 
						Call SalDisableWindow( PAWN ) 
						Call SalDisableWindow( pb_KD ) 
						Call SalDisableWindow( pb_PR_1 ) 
						Call SalDisableWindow( pb_PR_2 ) 
					!
			Function: E_Ins
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					If TRUE
						Call SalEnableWindow( FIO_ )
						! Call SalEnableWindow( OKPO_ ) 
						Call SalDisableWindow( OKPO_ ) 
						Call SalDisableWindow( BDAT_ ) 
						Call SalEnableWindow( cmb_DOK ) 
						Call SalEnableWindow( KEM_ ) 
						Call SalEnableWindow( DATV_ ) 
						Call SalEnableWindow( SER_ ) 
						Call SalEnableWindow( NUM_ ) 
						Call SalEnableWindow( IDX_ )
						Call SalEnableWindow( REG_ ) 
						Call SalEnableWindow( DST_ ) 
						Call SalEnableWindow( KEM_ ) 
						Call SalEnableWindow( DATV_ ) 
						Call SalEnableWindow( SER_ ) 
						Call SalEnableWindow( TWN_ ) 
						Call SalEnableWindow( STR_ ) 
						Call SalEnableWindow( cb_Email ) 
						Call SalEnableWindow( TEL1_ ) 
						Call SalEnableWindow( TEL2_ ) 
						Call SalEnableWindow( KONT ) 
						Call SalEnableWindow( cmb_TORG ) 
						Call SalEnableWindow( pb_KD ) 
					If nPAWN != NUMBER_Null
						Call SalEnableWindow( SUMZ ) 
						Call SalEnableWindow( PAWN ) 
					!
			!
			Function: F_NULL
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					Call F_DISA ()
					Set ID = NUMBER_Null
					Call SalColorSet( KRDS_, COLOR_IndexWindow, nColR )
					Set NAME = STRING_Null
					Set IR = NUMBER_Null
					Set MES = NUMBER_Null
					Set SMAX = NUMBER_Null
					Set PRK = NUMBER_Null
					Set METR90 = NUMBER_Null
					Set NAME90 = STRING_Null
					Set MODE_GPK = NUMBER_Null
					Set NAME_GPK = STRING_Null
					Set SURVEY = NUMBER_Null
					Set SURVEY_NAME = STRING_Null
					Set KRDN = NUMBER_Null
					Set BASEY = NUMBER_Null
					Set SBASEY = STRING_Null
					!
					Set BDAT_ = DATETIME_Null
					Set OKPO_ = STRING_Null
					Set dFIO  = STRING_Null
					!
					Set YAR_ = NUMBER_Null
					Set cb_FAM = FALSE
					Set KINDER_ = NUMBER_Null
					Call SalSendMsg( tb_Dox, SAM_Create, 0, 0 )
					! Set nRAB = NUMBER_Null
					! Set cmb_RAB = STRING_Null
					Set STAG_ = NUMBER_Null
					Set TERM_ = NUMBER_Null
					! Set nRANG = NUMBER_Null
					! Set cmb_RANG = STRING_Null
					! Set nOSVITA = NUMBER_Null
					! Set cmb_OSVITA = STRING_Null
					Set PV_ = NUMBER_Null
					! Set nKV = NUMBER_Null
					! Set cmb_KV = STRING_Null
					Set PG_ = NUMBER_Null
					Set MES_ = NUMBER_Null
					Set KURS = NUMBER_Null
					Set DOX_ = NUMBER_Null
					! Set nIST = NUMBER_Null 
					! Set cmb_IST = STRING_Null
					Set KRDS_ = NUMBER_Null 
					Call D_Ins () 
					!
			Function: F_DISA
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalEnableWindow( BDAT_ )
					Call SalEnableWindow( OKPO_ )
					Call SalDisableWindow( cb_FAM ) 
					Call SalDisableWindow( KINDER_ )
					Call SalDisableWindow( cmb_RAB ) 
					Call SalDisableWindow( STAG_ ) 
					Call SalDisableWindow( cmb_RANG ) 
					Call SalDisableWindow( TERM_ ) 
					Call SalDisableWindow( cmb_OSVITA ) 
					Call SalDisableWindow( PV_ ) 
					Call SalDisableWindow( cmb_KV ) 
					Call SalDisableWindow( MES_ ) 
					Call SalDisableWindow( DOX_ ) 
					Call SalDisableWindow( cmb_IST ) 
					Call SalDisableWindow( cmb_DEP ) 
					! Set cb_Commit = FALSE
					!
			Function: F_Main
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					Set BDAT_ = SalDateConstruct( 1953, 1, 25, 0, 0, 0 )
					Set OKPO_ ='1938307209'
					Set YAR_ = 54
					Set cb_FAM = TRUE
					Set KINDER_ = 0
					Set STAG_ = 16
					Set TERM_ = 35
					Set PV_ = 10000
					Set MES_ = 12
					! Set DOX_ = 3000
					Set nKV = 980
					Call cmb_KV.SetSelectById( nKV )
					Set KURS = 1
					Set PG_ = 10000
					Set FIO_ = 'Сухова Т.О.'
					Set nDOK = 1
					Call cmb_DOK.SetSelectById( nDOK )
					Set DATV_ = SalDateConstruct( 1996, 11, 12, 0, 0, 0 )
					Set SER_='CH'
					Set NUM_='36123'
					Set REG_ = "Київ"
					Set DST_ = "Дарницький"
					Set IDX_ = "252068"
					Set TWN_ = "Київ"
					Set STR_ = "Коциця 10 кв 55"
					Set TEL1_ = "(044)5651851"
					Set KEM_ = "РУГУ"
					Set TEL2_ = "(044)5533948"
					Set KONT = "з 09:00 до 18:00"
					Set OKPO_P ='12345678'
					Set MFO_P ='300012'
					Set NLS_P ='26003'
					Set SUMZ = 12000
					Set PAWN ='Товар, що купується'
					!
					! Set nRAB = NUMBER_Null
					! Set cmb_RAB = STRING_Null
					! Set nRANG = NUMBER_Null
					! Set cmb_RANG = STRING_Null
					! Set nOSVITA = NUMBER_Null
					! Set cmb_OSVITA = STRING_Null
			Function: f_Tochka
				Description:
				Returns
					Boolean:
				Parameters
					Window Handle: hWnd
				Static Variables
					String: sTmp
				Local variables
				Actions
					Set sTmp=SalStrRepeatX( ' ', 20 )
					Call SalGetWindowText ( hWnd, sTmp, 20 )
					While SalStrScan(sTmp, sDecimal2) > 0
						Set sTmp = SalStrReplaceX(sTmp,SalStrScan(sTmp,sDecimal2),1,sDecimal)
					Call SalFmtStrToField ( hWnd, sTmp, TRUE)
			Function: F_ENA
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalEnableWindow( BDAT_ )
					Call SalEnableWindow( OKPO_ )
					Call SalEnableWindow( PV_ ) 
					Call SalEnableWindow( cmb_KV ) 
					Call SalEnableWindow( cmb_IST ) 
					Call SalEnableWindow( MES_ ) 
					! Call SalEnableWindow( DOX_ ) 
					If SURVEY =1
						Call SalEnableWindow( cb_FAM )
						Call SalEnableWindow( KINDER_ )
						Call SalEnableWindow( cmb_RAB ) 
						Call SalEnableWindow( STAG_ ) 
						Call SalEnableWindow( cmb_RANG ) 
						Call SalEnableWindow( TERM_ ) 
						Call SalEnableWindow( cmb_OSVITA ) 
					Else If SURVEY =2
						Call SalEnableWindow( cmb_DEP ) 
					!
			Function: F_RUN
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: n37 
					Number: FIN_
				Actions
					If (YAR_=NUMBER_Null OR PV_ = NUMBER_Null OR nKV = NUMBER_Null OR 
							    MES_=NUMBER_Null OR nIST= NUMBER_Null )
							OR SURVEY  = 1 AND 
							   (KINDER_= NUMBER_Null OR nRAB = NUMBER_Null OR STAG_=NUMBER_Null OR 
							    nRANG  = NUMBER_Null OR TERM_= NUMBER_Null OR nOSVITA=NUMBER_Null )
							OR SURVEY  = 2 AND ( nDEP = NUMBER_Null )
						Call SalMessageBox("Не введено ВСІ необхідні дані ",
								"Помилка ! ", MB_IconStop)
						Return FALSE
					Set n37 = 169 - cb_FAM  
					If SqlPrepareAndExecute( hSql(), "delete from CCK_AN_TMP " ) 
							and SqlPrepare( hSql(), 
							   "insert into CCK_AN_TMP(PR,N4 ,N1,N2,N3) values 
							       (:tb_Dox.Kod_D, :tb_Dox.Poz, :tb_Dox.Por_1, :tb_Dox.Por_2, :tb_Dox.Por_3 )")
							and SalTblDoInserts( tb_Dox, hSql(), FALSE ) 
						Call SqlPLSQLCommand( hSql(),  "CCWebPK.SURVEY0 (OKPO_, SURVEY,BDAT_,
								                       TERM_,n37,KINDER_,nRAB,nRANG,STAG_,nOSVITA,PV_,MES_,0,nKV,nIST,nDEP )")
						Call SqlPrepareAndExecute( hSql(), "delete from CCK_AN_TMP " ) 
						! Call SqlPLSQLCommand(hSql(),"CCWebPK.SUR_DOX(NUMBER_Null,ID,DOX_)")
						If SqlPrepareAndExecute( hSql(), "select CCWebPK.SUR_INB(null,to_number("||Str(ID)||") )  into :KRDS_ from dual " )
								  and SqlFetchNext( hSql(), nFetchRes ) 
							If KRDS_>= KRDN
								Call SqlCommit( hSql() )
								Call SalColorSet( KRDS_, COLOR_IndexWindow, nColG )
								Call E_Ins ()
							Else
								Call SqlRollback( hSql() )
								Call SalColorSet( KRDS_, COLOR_IndexWindow, nColR )
								Call D_Ins ()
					!
			Function: F_SUM
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					If nKV != NUMBER_Null 
						If nKV = n980
							Call SalHideWindow( nKV )
							Call SalHideWindow( KURS )
							Call SalHideWindow( PG_ )
						Else
							Call SalShowWindow( nKV )
							Call SalShowWindow( KURS )
							Call SalShowWindow( PG_ )
						If SqlPrepareAndExecute( hSql(),
								"SELECT gl.p_icurval (:nKV, 1000000, :BankDate)/ 1000000 into :KURS from dual" )
								and NOT SqlFetchNext( hSql(), nFetchRes )  
							Return VALIDATE_Cancel
					!
					If PV_ != NUMBER_Null 
						If PV_ <=0 
							Call SalMessageBox(" Початкова Сума кредиту <= 0",
									"Помилка ! ", MB_IconStop)
							Set PV_ = NUMBER_Null
							Return VALIDATE_Cancel
					!
					If KURS != NUMBER_Null and PV_ != NUMBER_Null
						Set PG_ = PV_ * KURS 
						If SMAX != NUMBER_Null and  PG_ > SMAX 
							Call SalMessageBox("Cума кредиту в грн більше максимально-допустимої "||Str(SMAX),
									"Помилка ! ", MB_IconStop)
							Set PV_ = NUMBER_Null
							Set PG_ = NUMBER_Null
							Return VALIDATE_Cancel
					!
					Return VALIDATE_Ok
			Function: F_BDAT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If OKPO_ != STRING_Null
						Set nTmp = 0
						If SqlPrepareAndExecute( hSql(),"
								select c.nmk,p.bday, p.passp, p.organ, p.pdate, p.ser, p.numdoc, p.teld, p.telw,
								  substr(f_SEB (1,c.rnk,'FGIDX'),1,10),substr(f_SEB (1,c.rnk,'FGTWN'),1,35),
								  substr(f_SEB (1,c.rnk,'FGOBL'),1,35),substr(f_SEB (1,c.rnk,'FGDST'),1,35),
								  substr(f_SEB (1,c.rnk,'FGADR'),1,35) 
								into :FIO_,:BDAT_,:nDOK,:KEM_,:DATV_,:SER_, :NUM_,:TEL1_,:TEL2_,
								     :IDX_,:TWN_,:REG_,:DST_, :STR_ 
								from customer c, person p where c.okpo = :OKPO_ and c.rnk = p.rnk (+) " )
								and NOT SqlFetchNext( hSql(), nFetchRes )  
							Set dFIO ='Новий клiєнт'
						Else
							Set dFIO =FIO_
						If SqlPrepareAndExecute( hSql(),"select 1 into :nTmp from CC_Sec where okpo = :OKPO_ " )
								and SqlFetchNext( hSql(), nFetchRes ) 
							If nTmp = 1
								Call SalMessageBox("Клієнт є НЕБАЖАНИМ ! ",
										"Служба безпеки ! ", MB_IconStop)
								Set BDAT_ = DATETIME_Null
								Set OKPO_ = STRING_Null
								Set dFIO  = STRING_Null
								!
								! Call SalSendMsg( pb_F6, SAM_Click, 0, 0 )
					If BDAT_ != DATETIME_Null
						Set YAR_ = SalNumberRound( (SalDateCurrent( ) - BDAT_ ) / 365 )
						If YAR_ < n16 or YAR_ > n90 
							Call SalMessageBox("Нереальний вік позичальника",
									"Помилка ! ", MB_IconStop)
							Set YAR_ = NUMBER_Null
							Set BDAT_ = DATETIME_Null
							Return VALIDATE_Cancel
						!
						! Set cb_FAM = IifN (YAR_ > 24, 1,0 )
					If OKPO_ != STRING_Null and BDAT_ != DATETIME_Null
						If SqlPrepareAndExecute( hSql(),
								"select Substr(V_OKPO10(:OKPO_,:BDAT_),1,10) into :sTmp from dual" )
								and SqlFetchNext( hSql(), nFetchRes )  
								and sTmp != OKPO_ 
							Call SalMessageBox("Ід.код не відповідає даті народження ! ",
									"Помилка ! ", MB_IconStop)
							Set OKPO_ = STRING_Null
							Return VALIDATE_Cancel
					!
					Return VALIDATE_Ok
			Function: F_WEB
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: strCompanyName
					String: strProductName
					String: strUrlPrefix
					String: strUrlFunction
					String: strIEXPLORE
				Actions
					Set strCompanyName = GetCompanyName( )
					Set strProductName = GetProductName( )
					Call SalUseRegistry( TRUE, strCompanyName )
					!
					! Адрес ВЕВ-сервера - strUrlPrefix = 'http://129.0.0.89'
					! Call SalGetProfileString( 
							"Credit&Loans",
							"Web_Url", 
							'http://129.0.0.89',
							 strUrlPrefix,
							 strProductName )
					Set strUrlPrefix = GetGlobalOption('UrlPref')
					! Адрес интернет-єксплорера  strIEXPLORE = "D:\\Progra~1\\Intern~1\\IEXPLORE.EXE"
					Call SalGetProfileString( 
							"Credit&Loans",
							"IEXPLORE", 
							"D:\\Progra~1\\Intern~1\\IEXPLORE.EXE",
							 strIEXPLORE,
							 strProductName )
					! Адрес веб-страницы АНКЕТЫ
					Set strUrlFunction = '/BarsWeb.Credit/New.aspx'
					Call SalLoadApp ( strIEXPLORE,  strUrlPrefix || strUrlFunction )
			!
		Window Parameters
			Number: nMode ! 297
			Number: nPar  ! 
			String: sPar1 ! 
			String: sPar2 ! 
		Window Variables
			String: sDecimal2  ! симв десятичной точки alt
			String: sDecimal   ! симв десятичной точки
			String: sTmp
			String: NLS_1002
			Number: nTmp
			Number: n980
			String: BankMfo
			Date/Time: BankDate
			Number: nSecond 
			Number: nCount
			Number: nColR 
			Number: nColG
			!
			Number: nRAB
			Number: nRANG
			Number: nOSVITA
			Number: nIST
			Number: nId 
			Number: nDEP
			Number: nDOK
			Number: nTORG
			Number: n16
			Number: n90
		Message Actions
			On SAM_Create
				Set n980 = GetBaseVal()
				Set sDecimal =SalStrMidX(SalNumberToStrX(1.1,1),1,1)
				Set sDecimal2 = IifS ( sDecimal = '.', ',', '.' )
				Set BankMfo =  GetBankMfo()
				Set BankDate = GetBankDate()
				Set nId = - GetUserId()
				Set nColG = COLOR_LightGreen
				Set nColR = SalColorGet ( KRDS_, COLOR_IndexWindow )
				Set n16 = GetGlobalOptionEx('CC_YAR1')
				Set n90 = GetGlobalOptionEx('CC_YAR2')
				If nHaveTOBO = 2
					Set nSecond= GetGlobalOptionEx('CCK_1S') ! Cек.ожидания проверки отв на запрос-1
					Set nCount = GetGlobalOptionEx('CCK_1C') ! Кол-во итераций проверки отв на запрос-1
					Set sTmp = "tobopack.GetToboCASH"
				Else
					Set sTmp = "pul.Get_Mas_Ini_Val('CASH')"
				If SqlPrepareAndExecute( hSql(),
						"SELECT substr(" || sTmp || ",1,14) INTO :NLS_1002 from dual ")
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Call SalMessageBox('Не определен счет кассы ', "Ошибки в настройках ! ", MB_IconStop)
					Call SalDestroyWindow(hWndForm)
				Call F_NULL()
				Call SalMapEnterToTab( TRUE )
	Table Window: CRD
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.438"
				Top:    0.49"
				Width:  17.267"
				Width Editable? Class Default
				Height: 5.119"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 20000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.881"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Оприбуткувати договір'
						On SAM_Click
							Call SalSendMsg(hWndForm, UM_Insert, 0, 0)
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.1"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Списати договір'
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.083"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Внести зміни'
				Line
					Resource Id: 36325
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.071"
						Begin Y:  -0.031"
						End X:  4.071"
						End Y:  0.427"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.583"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.983"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\rep_join.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						! On SAM_Create
							                                                                                                                           Set strTip = 'Карточка Счета'
						On SAM_Click
							! If colAcc != NUMBER_Null
								                                                                                                                           Call OperWithAccount(ALL_ACCOUNTS, colAcc, 0, 
										 IifN(nTip_Ur=90, ACCESS_READONLY, ACCESS_FULL))
							Set sTmp='CC_KOL_ALL.ND='||Str(nNd)
							Call FunNSIEditFFiltered('CC_KOL_ALL',1,sTmp)
				!
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.583"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 36326
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 36327
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Background Text: Реф.КД
					Resource Id: 36328
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.083"
						Top:    0.095"
						Width:  1.117"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: dNd
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.083"
							Top:    0.226"
							Width:  1.114"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Background Text: № КД
					Resource Id: 36329
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.283"
						Top:    0.095"
						Width:  1.217"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: CC_ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.283"
							Top:    0.238"
							Width:  1.371"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Background Text: Рег.№ 
					Resource Id: 36330
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   6.683"
						Top:    0.095"
						Width:  1.3"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: dRNK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.683"
							Top:    0.238"
							Width:  1.114"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Background Text: Позичальник
					Resource Id: 36331
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   7.783"
						Top:    0.095"
						Width:  2.957"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Background Text: Дата 
					Resource Id: 36332
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   11.983"
						Top:    0.095"
						Width:  1.417"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: dNMK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.783"
							Top:    0.238"
							Width:  3.983"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.883"
							Top:    0.238"
							Width:  1.583"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				!
				Check Box: CB_DK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Виконати дію без проводок
					Window Location and Size
						Left:   0.083"
						Top:    0.5"
						Width:  3.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							If CB_DK
								Set nDk=3
							Else
								Set nDk=1
				Pushbutton: pbDetails_one
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.983"
						Top:    0.488"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? Yes
					Keyboard Accelerator: (none)
					Font Name: Default
					Font Size: Default
					Font Enhancement: None
					Picture File Name: \BARS98\RESOURCE\BMP\rep_solo.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						! On SAM_Create
							                                                                                                                           Set strTip = 'Карточка Счета'
						On SAM_Click
							! If colAcc != NUMBER_Null1
								                                                                                                                           Call OperWithAccount(ALL_ACCOUNTS, colAcc, 0, 
										 IifN(nTip_Ur=90, ACCESS_READONLY, ACCESS_FULL))
							Set sTmp='CC_KOL_ALL.ND='||Str(nNd)||' AND CC_KOL_ALL.CRDND='||Str(CRD.CRDND)
							Call FunNSIEditFFiltered('CC_KOL_ALL',1,sTmp)
		Contents
			Column: CRDND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № 
						документа
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.383"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: O9819
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_StrId
				Property Template:
				Class DLL Name:
				Title: Стан
						документа
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  1.567"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_Create
						If O9819.Init( hWndItem )
							Call O9819.Populate( hSql(), "KOD", "TXT", "CC_KOL_O9819", " ORDER BY kod" )
					On SAM_AnyEdit
						Set O9819_N= O9819.GetKey( SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Column: T9819
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenColComboBox_StrId
				Property Template:
				Class DLL Name:
				Title: Тип
						 документа
				Visible? Class Default
				Editable? Class Default
				Maximum Data Length: Class Default
				Data Type: Class Default
				Justify: Class Default
				Width:  1.6"
				Width Editable? Class Default
				Format: Class Default
				Country: Class Default
				Input Mask: Class Default
				Cell Options
					Cell Type? Class Default
					Multiline Cell? Class Default
					Cell DropDownList
						Sorted? Class Default
						Vertical Scroll? Class Default
						Auto Drop Down? Class Default
						Allow Text Editing? Class Default
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Class Default
				List Values
				Message Actions
					On SAM_Create
						If T9819.Init( hWndItem )
							Call T9819.Populate( hSql(), "TBLANK", "TXT", "CC_KOL_TBLANK", " ORDER BY TBLANK" )
					On SAM_AnyEdit
						Set T9819_N= T9819.GetKey( SalListQuerySelection(hWndItem))
					On SAM_SetFocus
						Call SalMapEnterToTab( TRUE )
			Column: GOLD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Найменування 
						обліку
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.35"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NDDOP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						дод.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.867"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FIO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кому 
						належать 
						документи
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.1"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CRDVD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата постановки 
						на облік
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.633"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAZN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Призначення 
						платежу
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Set sTmp=NAZN
						If sTmp =STRING_Null
							If O9819_N='2' or O9819_N='3'
								If SqlPrepareAndExecute( hSql(), "select c.nmk into :NAME_O from customer c,accounts a        
										                                                                     where c.rnk=a.rnk and a.kv=:n980 and a.nls=:NLS" )
										and SqlFetchNext( hSql(), nFetchRes )
								Set sTmp=Subs(dNMK||" "|| O9819||" "||NAME_O||NAZN_VIDD|| " № "||CC_ID ||" від "|| SalFmtFormatDateTime( DAT1, "dd/MM/yyyy" ),  1, 160)
							Else
								Set sTmp=Subs(dNMK||" "|| O9819||NAZN_VIDD||" № "||CC_ID ||" від "|| SalFmtFormatDateTime( DAT1, "dd/MM/yyyy" ),  1, 160)
						Call Sel017t( CRD, 'Редактирование назначения платежа', bTmp, sTmp, TRUE )
						If bTmp
							Set NAZN = sTmp
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок 
						для перерахування
						(в підзвіт, ...)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.733"
				Width Editable? Yes
				Format: Uppercase
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					! On SAM_KillFocus
						                                                                                                                   If SqlPrepareAndExecute( hSql(), "SELECT NMS into :NAME_NLS from accounts  WHERE kv=:n980 and nls=:NLS" )
								and SqlFetchNext( hSql(), nFetchRes )
					On SAM_AnyEdit
						If SqlPrepareAndExecute( hSql(), "SELECT NMS into :NAME_NLS from accounts  WHERE kv=:n980 and nls=:NLS" )
								and SqlFetchNext( hSql(), nFetchRes )
			Column: NAME_NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва 
						рахунку
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.633"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VLASN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Власник
						документів
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.133"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CRDSN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
						документу
						(обліковиваемого)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.367"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Set sTmp =ACCSV
						Call FunNSIGetFiltered
								("SALDO", "ACC",
								 " SALDO.ACC in (select acc from nd_acc WHERE nd="||Str(dNd)||" union all
								  select acc from cc_accp WHERE accs in (select acc from nd_acc WHERE nd=" || Str(dNd) || "))"
								,  sTmp, sTmp2 )
						! Call Debug (sTmp)
						! Call Debug(sTmp2)
						If sTmp2!=STRING_Null and sTmp2!=ACCSV
							If SqlPrepareAndExecute( hSql(),
									  "SELECT nls,kv  INTO :CRDSN,:CRDSK from accounts where acc=:sTmp2" )
									and not SqlFetchNext(hSql(), nFetchRes) 
								Set ACCSV=sTmp2
							Else
								Call SalTblSetRowFlags ( CRD, SalTblQueryContext ( CRD ), ROW_Edited, TRUE )
			Column: O9819_N
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № место
						нахождения
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: T9819_N
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: N типа 
						операции
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.25"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: O9819_OLD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: № местонахождения 
						изначальный
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.983"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CRDSK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Валюта
						рахун.
						обл. док.
				Visible? Yes
				Editable? No
				Maximum Data Length: 3
				Data Type: String
				Justify: Left
				Width:  0.85"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: SOS
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.9"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: REF
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACCSV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: АСС Счета договора
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.6"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: DK
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nTip_Ur
			Number: nNd
			String: sGr                        !-- пока не используется
			String: sRNK                    !-- пока не используется
		Window Variables
			String: sTmp
			String: sTmp2
			Boolean: bTmp
			Date/Time: dDat
			String: sSql
			String: sSql1
			Number: nKv
			String: sBankMfo
			String: rTOBO_
			String: sNaz
			: cDoc
				Class: cDoc
			Number: VIDD
			String: NAZN_VIDD
			String: sNlsK
			Number: nDk
			Number: nAcc
			Number: nRet
			Number: nAcc8
			Number: nId
			Number: colVob
			Number: n980
			String: NAME_O
		Message Actions
			On SAM_Create
				Set CRD.strPrintFileName = 'DCRD'
				If nTip_Ur > 20 or nTip_Ur  = 10 
					Call SalDisableWindow( pbIns )
					Call SalDisableWindow( pbDel )
					Call SalDisableWindow( pbUpdate )
				! Set CRD.nTabInstance = 1
				Set nFlags = GT_NoDel
				Set nId = GetUserId()
				Set dDat = GetBankDate()
				Set sBankMfo = GetBankMfo()
				Set n980 = GetBaseVal()
				Set nDk=1
				Set CB_DK=FALSE
				Set dNd=nNd
				Set dRNK=sRNK 
				!
				If SqlPrepareAndExecute(hSql(), 
						  "SELECT d.CC_ID,d.SDATE, a.acc ,c.nmk,d.vidd
						   INTO :CC_ID,:DAT1, :nAcc8 ,:dNMK,:VIDD
						  FROM cc_deal d, accounts a,customer c 
						   WHERE d.rnk=c.rnk and d.nd=:nNd and a.nls (+) like '8999_'||d.nd  and a.tip='LIM' ")
						and SqlFetchNext(hSql(), nFetchRes)
				If VIDD=1 or VIDD=2 or VIDD=3 or VIDD=11or VIDD=12or VIDD=13
					Set NAZN_VIDD=' КД '
				If VIDD=9 or VIDD=19 or VIDD=29 or VIDD=39
					Set NAZN_VIDD=' ДГ '
				If VIDD=4 or VIDD=14
					Set NAZN_VIDD=' ДО '
				! If SqlPrepareAndExecute(hSql(), "SELECT kv,nls,nms INTO :dKVK,:dNLSK,:dNMSK FROM accounts where acc=:ACCS")
						and SqlFetchNext(hSql(), nFetchRes)
				!
				Call SalSetWindowText(hWndForm,'Бланковый учет  по КД Реф.' || Str(nNd))
				Call SalSendClassMessage(SAM_Create, 0, 0)
				!
				Set CRD.strSqlPopulate = 
						"select ref,sos,dk,VDAT,O9819,T9819,
						               GOLD,NDDOP,FIO,nvl(VLASN,(select val from params where par='NAME')),
						               CRDND,O9819_N,O9819_OLD,T9819_N, CRDSN,CRDSK,
						               (case when O9819_N in ('2','4','6','8') then nlsb else null end) nlsb,
						               (case when O9819_N in ('2','4','6','8') then nam_b else null end)name_nls
						   INTO  :hWndForm.CRD.REF, :hWndForm.CRD.SOS, :hWndForm.CRD.DK, :hWndForm.CRD.CRDVD, :hWndForm.CRD.O9819, :hWndForm.CRD.T9819, 
						                :hWndForm.CRD.GOLD,:hWndForm.NDDOP,:hWndForm.CRD.FIO, :hWndForm.CRD.VLASN, 
						                :hWndForm.CRD.CRDND, :hWndForm.CRD.O9819_N, :hWndForm.CRD.O9819_OLD,:hWndForm.T9819_N,
						                :hWndForm.CRD.CRDSN, :hWndForm.CRD.CRDSK,
						                :hWndForm.CRD.NLS, :hWndForm.CRD.NAME_NLS
						  from 
						  (   
						  select  r.ref,r.sos,r.dk,
						    nvl((select to_date(value,'dd.mm.yyyy') from operw  where tag='CRDVD'  and ref=r.ref),r.vdat) VDAT,
						   ( select txt from operw,cc_kol_o9819 where kod=value and tag='O9819' and ref=r.ref) O9819,
						   ( select txt from operw,cc_kol_tblank where tblank=value and tag='T9819' and ref=r.ref) T9819,
						   ( select value from operw where tag='GOLD'  and ref=r.ref)  GOLD,
						   ( select value from operw where tag='NDDOP'  and ref=r.ref)  NDDOP,
						   ( select value from operw where tag='FIO'  and ref=r.ref)  FIO,
						   ( select value from operw where tag='VLASN'  and ref=r.ref)  VLASN,
						   ( select value from operw where tag='CRDND' and ref=r.ref) CRDND,
						   ( select value from operw where tag='O9819' and ref=r.ref) O9819_N,
						  ( select value from operw where tag='O9819' and ref=r.ref) O9819_OLD,
						   ( select value from operw where tag='T9819' and ref=r.ref) T9819_N,
						   ( select value from operw where tag='CRDSN' and ref=r.ref) CRDSN,
						   ( select value from operw where tag='CRDSK' and ref=r.ref) CRDSK,
						nlsb,
						nam_b
						   from oper r
						  where ref in (select max(ref) from
						                  (select oo.ref ref,
						                       (select value from operw where ref=oo.ref and tag='CRDND') CRDND
						                   from nd_ref rr,oper oo 
						                   where rr.nd=:nNd and rr.ref=oo.ref and oo.sos>=0
						                  )where crdnd is not null group by crdnd 
						                ) 
						 )" 
			On UM_Update
				Set nRow = TBL_MinRow
				While SalTblFindNextRow(hWndForm, nRow,  ROW_New|ROW_Edited|ROW_MarkDeleted, 0)
					Call SalTblSetContext(hWndForm, nRow)
					If SalTblQueryRowFlags ( hWndForm, nRow, ROW_New )	 
						If SqlPLSQLCommand( hSql(),  "CCK.CC_CRD  (nNd,  nDk, CRDND , NLS,
								  GOLD,NDDOP,T9819_N, O9819_N,FIO,VLASN, NAZN,CRDVD,CRDSN,CRDSK)" )     
							Call SqlCommit( hSql())
					Else If SalTblQueryRowFlags ( hWndForm, nRow, ROW_MarkDeleted)	 
						If SqlPLSQLCommand( hSql(),  "CCK.CC_CRD  (nNd,  nDk, CRDND , NLS,
								  GOLD,NDDOP,T9819_N, O9819_N,FIO,VLASN, NAZN,CRDVD,CRDSN,CRDSK)" )  and SqlCommit( hSql())  
							Call SqlCommit( hSql())
						Else
							Call SqlRollback(hSql())
					Else If SalTblQueryRowFlags ( hWndForm, nRow, ROW_Edited )	 
						If SqlPLSQLCommand( hSql(),  "CCK.CC_CRD  (nNd,  nDk, CRDND , NLS,
								  GOLD,NDDOP,T9819_N, O9819_N,FIO,VLASN, NAZN,CRDVD,CRDSN,CRDSK)" ) and SqlCommit( hSql())  
							Call SqlCommit( hSql())
						Else
							Call SqlRollback(hSql())
					Else
						Call SqlRollback(hSql())
				Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
			On SAM_FetchRowDone
				If SOS<5 
					Call SetTblRowColor(hWndForm, COLOR_DarkGreen)
					! Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGreen ) 
				Else
					Call SetTblRowColor(hWndForm, COLOR_Default)
				If O9819_N='2'  or  O9819_N='4' or O9819_N='6' or O9819_N='8'
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray ) ! серый
				If O9819_N='0'  
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Gray ) ! серый
				! Set NAZN="Hello"
				! If SqlPrepareAndExecute( hSqlAux2(), 
						"SELECT name INTO :CRD.colMestoZal FROM cc_mpawn WHERE mpawn=:CRD.colPawnM ")
						and SqlFetchNext( hSqlAux2(), nFetchRes)
				! If SqlPrepareAndExecute( hSqlAux2(), 
						"SELECT name,s031 
						 INTO :CRD.colVidZal,:CRD.colS031 
						 FROM cc_pawn WHERE pawn=:CRD.colPawn  ")
						 and SqlFetchNext( hSqlAux2(), nFetchRes)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
				Call SalTblPopulate(hWndForm, cMain.hSql(), CRD.strSqlPopulate, nTabPopulateMethod)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
	Dialog Box: dlg_SetNd
		Class:
		Property Template:
		Class DLL Name:
		Title: Переприв'язати до договора №
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  9.257"
				Width Editable? Yes
				Height: 2.396"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: УВАГА! Переприв`язка забезпечення
				Resource Id: 42389
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.386"
					Top:    0.177"
					Width:  4.9"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Light Gray
			Background Text: Референс договору
				Resource Id: 42390
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.286"
					Top:    0.76"
					Width:  2.5"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cTBarButton
				Property Template:
				Class DLL Name:
				Title: Відхилити
				Window Location and Size
					Left:   2.986"
					Top:    1.323"
					Width:  2.4"
					Width Editable? Class Default
					Height: 0.583"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( hWndForm, 0 )
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cTBarButton
				Property Template:
				Class DLL Name:
				Title: Встановити
				Window Location and Size
					Left:   0.286"
					Top:    1.323"
					Width:  2.4"
					Width Editable? Class Default
					Height: 0.583"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\APPLY.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						If nTip=4
							If not ShowInputPassword()
								Call SalEndDialog( hWndForm,  0 )
						Set nNd=dfNewNd
						Call SalEndDialog( hWndForm,  1 )
			Frame
				Resource Id: 42391
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.286"
					Top:    0.073"
					Width:  5.1"
					Width Editable? Yes
					Height: 0.333"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Solid
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Frame
				Resource Id: 42392
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.986"
					Top:    0.656"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.5"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Solid
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Data Field: dfNewNd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.086"
						Top:    0.74"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Combo Box: cmbTip
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   5.586"
					Top:    0.656"
					Width:  3.4"
					Width Editable? Class Default
					Height: 1.333"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? No
				Vertical Scroll? No
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						If cmbTip.Init(hWndItem)
							Call cmbTip.Populate(hSql(), 'tip', 'name', 'tip_aktiv', 'order by tip')
							Call cmbTip.SetSelectById(nTip)
					On SAM_Click
						Call SalSendClassMessage(SAM_Click, 0, 0)
						Set nTip = cmbTip.GetCurrentKey()
			Background Text: Перенесення забезпечення в портфель:
				Resource Id: 42393
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.686"
					Top:    0.094"
					Width:  3.1"
					Width Editable? Yes
					Height: 0.313"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
		Functions
		Window Parameters
			Receive Number: nNd
			Receive Number: nTip
		Window Variables
		Message Actions
			On SAM_Create
				Call SalCenterWindow( hWndForm )
	Table Window: Tbl_IRR
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Плановые потоки денежных средств и расчет IRR
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.613"
				Top:    2.219"
				Width:  15.283"
				Width Editable? Class Default
				Height: 4.464"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: None
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 7000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.76"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Data Field: Kol_Pot
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.083"
							Top:    0.071"
							Width:  1.033"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Количество потоков ' )
				Data Field: Kol_Dni
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.083"
							Top:    0.405"
							Width:  1.033"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Общее Количество дней ' )
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				! !=========================
				! Расчитать и сохранить Эф.ст., потоки, счет (от начальных условий по КД)
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.183"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\execute.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip =
									'Расчитать и сохранить Эф.ст., потоки, счет
									(от начальных условий по КД)'
						On SAM_Click
							Call F_SAVE( 0, sErr)
				! Расчитать и сохранить Эф.ст., потоки, счет (от бал.стоимости)
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.683"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\execute.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip =
									'Расчитать и сохранить Эф.ст., потоки, счет
									(от бал.стоимости)'
						On SAM_Click
							Call F_SAVE(1, sErr)
				Data Field: R_DAT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   2.183"
							Top:    0.406"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.313"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата для расч.эф.ставки по бал.стоимости' )
						! On SAM_CreateComplete
							                             Set R_DAT = GetBankDate()
				! !=========================
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.583"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 52436
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.783"
						Top:    0.405"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
					Picture Transparent Color: White
					Image Style: Class Default
					Text Color: White
					Background Color: Light Gray
					Message Actions
				Line
					Resource Id: 52437
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.283"
						Top:    0.406"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Gray
					Message Actions
				Line
					Resource Id: 52438
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: CC_ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.586"
							Top:    0.073"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Ид.КД' )
				Data Field: NMK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.386"
							Top:    0.071"
							Width:  4.9"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Заемщик' )
				Data Field: IR_N0
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.186"
							Top:    0.073"
							Width:  0.9"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Номинальная % ставка' )
				Data Field: dND
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   5.786"
							Top:    0.073"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Реф.КД' )
						On SAM_SetFocus
							Set nTmpE = dND
						On SAM_AnyEdit
							Set dND = nTmpE
				Data Field: IRR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   2.186"
							Top:    0.071"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Эф. % ст.(Реальная, с учетом Д/П)' )
				Data Field: IRRE
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   3.986"
							Top:    0.071"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Эф. % ст.(Эталон., без учета Д/П)' )
				!
				Data Field: NLS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   3.986"
							Top:    0.405"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Сч.коррекции нач.доходов' )
						On SAM_Validate
							If NLS != STRING_Null
								If SqlPrepareAndExecute( hSql(), "select acc into :ACC6 from accounts where nls=:NLS and kv=:n980 and dazs is null") and NOT SqlFetchNext( hSql(), nFetchRes)
									Set NLS = NLS_OLD
									Call SalMessageBox("Счет НЕ открыт !","Ошибка ", MB_IconStop)
							Else
								Set ACC6 = NUMBER_Null
							Return VALIDATE_Ok
		Contents
			Column: NPP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						периода
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  0.867"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						из ГПК
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.067"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SS1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План
						Выдачи
						кредита
						1. Поток -
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.071"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SDI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План
						начального
						Дисконта
						2. Поток +
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.743"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SPI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План
						начальной
						Премии
						3. Поток -
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.0"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: SS2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План-
						погашения
						кредита
						4. Поток (+)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.929"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SN2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План-
						погашения
						%
						5. Поток +
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.071"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Суммарный
						со знаком
						1+2+3+4+5=
						6.поток
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.129"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SDP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План
						Дисконта
						(Премии)
						Поток + (-)
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.4"
				Width Editable? Yes
				Format: ###000
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: NASELENIE  ! Вычитать проц.карточку Эф.% ставки + Вычитать(или Создать для rb_NEW) денежные потоки
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sSql
					Number: nRow
					String: sDat
				Actions
					If SqlPrepareAndExecute(hSql(),
							"select acrn.fprocn( a.acc,0, :R_DAT), a.acc,  d.sdate, d.wdate,  d.wdate - d.sdate
							 into :IR_N0, :ACC8, :SDATE, :WDATE , :Kol_Dni
							 from accounts a, nd_acc n, cc_deal d where n.nd=:ND and a.acc=n.acc and a.tip='LIM'     ")
							and SqlFetchNext(hSql(), nFetchRes)
					If SqlPrepareAndExecute(hSql(),
							"select acrn.fprocn(:ACC8,-2, :R_DAT), i.acrb, a.nls,  d.IR
							 INTO :IRR, :ACC6, :NLS_OLD,  :IRRE
							 from int_accn I, cc_deal d, accounts a
							 where d.nd=:ND and i.acc=:ACC8 and  i.id=-2 and i.acrb = a.acc(+) ")
							and SqlFetchNext( hSql(), nFetchRes)
						Set NLS = NLS_OLD
					!
					! Вычитать сохраненные ранее денежные потоки
					Set sSql ="SELECT FDAT,SS1,SDP,SS2,SN2 INTO :FDAT,:SS1,:SDP,:SS2,:SN2 from CC_many where nd=:ND ORDER BY 1"
					Set Kol_Pot = 0
					Set iSS1 = 0
					Set iSDP = 0
					Set iSS2 = 0
					Set iSN2 = 0
					Set iS   = 0
					!
					Call SalTblPopulate(hWndForm, hSql(),sSql, TBL_FillAll )
					!
					Call SalTblDefineSplitWindow(hWndForm, 1, TBL_Split_Adjustable)
					Set nRow = SalTblInsertRow(hWndForm,TBL_MinSplitRow)
					Call SalTblFetchRow(hWndForm, nRow )
					Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
					Set SS1 = iSS1
					If iSDP > 0
						Set SDI = iSDP
					Else
						Set SPI = iSDP
					Set SS2 = iSS2
					Set SN2 = iSN2
					Set S = iS
			Function: F_S
				Description: Поддержка  колонки S "Суммарный поток "
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set S = (SS1 + SN2 + SDP + SS2)
					!
					If SDP > 0
						Set SDI = SDP
					Else
						Set SPI = SDP
					Set iSS1 = iSS1 + SS1
					Set iSDP = iSDP + SDP
					Set iSS2 = iSS2 + SS2
					Set iSN2 = iSN2 + SN2
					Set iS   = iS   + S
					Set Kol_Pot = Kol_Pot + 1
					If Kol_Pot = 1
						Set Dat1 = FDAT
						Set NPP =1
					Else
						Set NPP = FDAT - Dat1 +1
					!
					Call XSalTblSetCellBackColor( SS1, SalColorFromRGB( 230,255,230 ) )
					Call XSalTblSetCellBackColor( SDI, SalColorFromRGB( 255,255,220 ) )
					Call XSalTblSetCellBackColor( SPI, SalColorFromRGB( 255,255,220 ) )
					Call XSalTblSetCellBackColor( SS2, SalColorFromRGB( 255,210,250 ) )
					Call XSalTblSetCellBackColor( SN2, SalColorFromRGB( 220,255,255 ) )
					! Call XSalTblSetCellBackColor( SN2, SalColorFromRGB( 220,255,255 ) )
			Function: F_SAVE
				Description: Расчитать и Сохранить ставку IRR, денежные потоки, сч.6 класса,
				Returns
					Boolean:
				Parameters
					! nMode=0 = от начальных условий по КД
					! nMode=1 = от текущей балансовой стоимости КД
					Number: nMode
					Receive String: sErr
				Static Variables
				Local variables
					Number: i
					Number: nNd
				Actions
					!
					! Удалить Старые потоки
					! Сохранить Новые потоки
					! Сохранить ставку
					If nMode = 0
						Set nNd = - ND
					Else
						Set nNd =  ND
					If NOT SqlPLSQLCommand(hSql(), "p_irr_BV(nNd, R_DAT ) " )
						Call SqlRollback( hSql() )
						Return FALSE
					Call NASELENIE()
					Call SqlCommit( hSql())
					! Отличается ли счет
					If NLS != NLS_OLD
						If SqlPrepareAndExecute(hSql(), "update int_accn set acrb=:ACC6 where acc=:ACC8 and id=-2")
							Call SqlCommit(hSql())
							Set NLS_OLD = NLS
							Call SalMessageBox("Сохранены изменения в счете доходов!" ,"В н и м а н и е!",  MB_Ok)
						Else
							Call SqlRollback(hSql())
					Call FunNSIEditF("PROT_IRR",2)
					Return TRUE
		Window Parameters
			Number: nTip_Ur
			Number: ND
			String: strPar01
			String: strPar02
		Window Variables
			Date/Time: Dat1
			String: NLS_OLD
			String: sErr
			Number: ACC8
			Number: ACC6
			Number: n980
			Number: nId
			Date/Time: SDATE  !  begin KD
			Date/Time: WDATE ! end KD
			!
			Number: iSS2
			Number: iSS1
			Number: iSDP
			Number: iSN2
			Number: iS
			String: NBS5
			String: NBS6
			Number: SOUR_
			Number: KV_DOG
			Number: RNK_
			Number: nTmpE
		Message Actions
			On SAM_Create
				Call PrepareWindowEx(hWndForm)
				Set hWndForm.Tbl_IRR.strPrintFileName = 'СС_IRR'
				Set n980 = GetBaseVal()
				Set nId  = GetUserId()
				Set R_DAT = GetBankDate()
				Set dND   = ND
				Set CC_ID = strPar01
				Set NMK   = strPar02
				Call SalSetWindowText(hWndForm, "Плановые потоки денежных средств по КД:" || CC_ID || " " || NMK)
				Call ShowApdVersion('02')
				Call PrepareWindowEx(hWndForm)
				Call SalTblSetLockedColumns(hWndForm, 5)
				!
				Call NASELENIE()
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Close
				Call SalDestroyWindow(hWndForm)
			On SAM_FetchRowDone
				Call F_S()
			On SAM_ColumnSelectClick
