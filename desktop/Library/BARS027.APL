Application Description: Ажио
		1) работа с файлами зачислений для BCZ
	Outline Version - 4.0.26
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 00000000009C0000 002C000000020000 0003000000000000 0022030000F8FFFF
0040: FFE2FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.data DT_MAKERUNDLG
0000: 0200000000001D51 3A5C424152533938 5C4C494252415259 5C42415253303135
0020: 2E646C6C1D513A5C 4241525339385C4C 4942524152595C42 4152533031352E61
0040: 706300000101011D 513A5C4241525339 385C4C4942524152 595C424152533031
0060: 352E72756E1D513A 5C4241525339385C 4C4942524152595C 424152533031352E
0080: 646C6C1D513A5C42 41525339385C4C49 42524152595C4241 52533031352E6170
00A0: 630000010101175C 4241525339385C42 494E5C4241525330 32372E6170640C5C
00C0: 4241525339385C42 494E5C0C5C424152 5339385C42494E5C 0000010101001D51
00E0: 3A5C424152533938 5C4C494252415259 5C42415253303135 2E646C6C1D513A5C
0100: 4241525339385C4C 4942524152595C42 4152533031352E61 70630000010101
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left:   -0.013"
			Top:    0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: 1018B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left:   4.15"
			Top:    1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left:   0.575"
			Top:    0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left:   6.388"
			Top:    0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		File Include: Gentbl.apl
		File Include: Genlist.apl
		File Include: Gentbls.apl
		File Include: GENTBLF.APL
		File Include: Vttblwin.apl
		File Include: Docfun6.apl
		File Include: Xsalcpt.apl
		File Include: vtcal.apl
		File Include: XSALSPL.APL
		File Include: XSALIMG.APL
		File Include: Vtmeter.apl
		File Include: Vtfile.apl
		File Include: QCKTABS.APL
		!
		Dynalib: CustAcnt.apd
		Dynalib: Nsiapi.apd
		Dynalib: Bars010.apd
		Dynalib: Bars017.apd
		Dynalib: DOCVIEW.APD
		Dynalib: Cc_doc.apd
		Dynalib: Absapi.apd
		Dynalib: Global.apd
		Dynalib: CC_Input.apd
		Dynalib: Repbank.apd
		!
		! Dynalib: Otcn.apd
		! Dynalib: ImpExp.apd
		!
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
		External Functions
			! Library name: hex2bin.dll
				! Function: ConvertBinToHex
					                                                        Description: void ConvertBinToHex(char* szSource,	// Исходный сырой BLOB
									     char* szDest,	// буфер для результирующей строки
							                                        // hex-цифр
									     long  nSourceLen);	// размер исходного массива
					                                                        Export Ordinal: 0
					                                                        Returns 
					                                                        Parameters 
						                                                        String: LPCSTR
						                                                        String: LPSTR
						                                                        Number: LONG
				                                                       Function: InsertBuf
					                                                       Description: void InsertBuf(
							char*szTarget,       // результирующий BLOB
							longnTargetOffset,   // смещение в результирующем BLOBе
							const char*szSource, // исходный сырой BLOB
							longnSourceOffset,   // смещение в исходном BLOBеlong
							nCopySize            // размер копируемого буфера)
					                                                       Export Ordinal: 0
					                                                       Returns 
					                                                       Parameters 
						                                                       Receive String: LPVOID
						                                                       Number: LONG
						                                                       String: LPVOID
						                                                       Number: LONG
						                                                       Number: LONG
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
				String: ApdNum   =  '27'
				String: ApdVer   =  '00'
				! История изменений: -----------------------------------------------------|
		Resources
		Variables
			Window Handle: hREK
			Window Handle: hREP
			Window Handle: hWin0
			Window Handle: hWin10
			Window Handle: hCP
			Window Handle: hVS
			Window Handle: hWin24
			Window Handle: hWin25
			Window Handle: hWin26
			String: aTOBO
			String: sTOBO
			String: BRO_OB
			! Window Handle: hWin2
			Number: nFetchRes
			Boolean: bApdInited
		Internal Functions
			Function: Sel027	! __exported
				Description: Bars027_Selector
				Returns
				Parameters
					Window Handle: hWndParent
					Number: nMode
					Number: nPar
					String: strPar01
					String: strPar02
				Static Variables
				Local variables
					Number: n1
					Number: n2
					Number: n3
					String: s1 
					!
					String: SqlDatabase
					String: SqlUser
					String: SqlPassword 
					String: sTemplate 
					String: sTemplatePath
				Actions
					! надо вставить инициализацию apd
					! Call Ini027() ! инициализация
					Set BRO_OB = GetGlobalOption ("BRO_OB")
					Select Case nMode
						Case 0 ! Формирование пакетов для "Модуля эмитента BCZCard+ v1.1" (АЖИО)
							If not IsWindow(hWin0)
								Set hWin0 = SalCreateWindow(frmBCZCard, hWndParent)
							Else
								Call SalBringWindowToTop(frmBCZCard)
							Break
						!
						Case 1 ! ЗАЛОГИ. Ключик
							Call Sel017( hWndMDI,10, 2, nPar, STRING_Null, strPar01 , Val(strPar02)  )
							Break
							! nPar - ND
							! strPar01 = Str(RNK)
							! strPar02 = Str(ACC)
						Case 2 ! ЗАЛОГИ. Кубик
							Call Sel017( hWndMDI,10, 11, nPar, STRING_Null, strPar01, Val(strPar02) )
							Break
						Case 3 ! ЗАЛОГИ. Туды-Сюды
							Break
						Case 33 ! Печать одного отчета по требованию
							Set sTemplate = strPar01
							Set sTemplatePath = GetTemplateDir() || "\\" || sTemplate
							! Call PrintTemplate( SqlDatabase,SqlUser,SqlPassword, sTemplatePath )
							Break
						!
						Case 7 ! ЦП НБУ
							If IsWindow( hCP )
								Call SalDestroyWindow( hCP )
							Set hCP = SalCreateWindow(CP, hWndMDI, nMode, nPar,strPar01,strPar02 )
							Break
						Case 10 ! Реструктуризация КД   пока только для ЦФР)- Диалог-по старому,- окно по-новому 
							! '&0.Старая'
							! Set hBtnOld = VisMessageLoadButton('&0. По старой ' , 0)
							! '&1.Новая
							! Set hBtnNew = VisMessageLoadButton('&1. По новой ', 1)
							! '&2.ОТКАЗ'
							! Set hBtnNo = VisMessageLoadButton('&2. Отказ ' , 2)
							! Call WaitCursorOff()
							!
							If SalMessageBox(
									'Работаем 
									по старой (Да/Yes) процедуре , По новой (Нет/No) процедуре ',
									'В н и м а н и е ! ', MB_IconQuestion | MB_YesNo) = IDYES
								Call SalModalDialog(dlg_Modify, hWndForm, nPar, strPar01 ) 
							Else
								If IsWindow( hWin10 )
									Call SalDestroyWindow(hWin10 )
								Set hWin10 = SalCreateWindow(MODN, hWndParent, nMode, nPar,strPar01,strPar02 )
								!
							Break
						Case 11 ! Визирование Реструктуризации КД пока только для ЦФР)
							If IsWindow( hREK )
								Call SalDestroyWindow(hREK )
							Set hREK = SalCreateWindow(REK, hWndParent, nMode, nPar,strPar01,strPar02 )
							Break
						Case 13 ! Портфель Реструктуризации КД пока только для ЦФР)
							If IsWindow( hREP )
								Call SalDestroyWindow(hREP )
							Set hREP = SalCreateWindow(REP, hWndParent, nMode, nPar,strPar01,strPar02 )
							Break
						Case 12 ! Просмотр Реструктуризации КД пока только для ЦФР)
							If SqlPrepareAndExecute( hSql(),
									  "select to_number(substr(nlsb,7,9)), 
									          to_number(substr(nlsa,7,9)), nam_a   into :n1, :n2, :s1
									   from oper where ref=:nPar and sos>0 and tt='REK' " )
									and SqlFetchNext( hSql(), nFetchRes )
								If IsWindow( hVS )
									Call SalDestroyWindow(hVS )
								Set hVS = SalCreateWindow(VS, hWndMDI, 0, n1, n2, nPar, s1, 0, hWndNULL )
							Break
						!
						Case 24 !! Заявка казначейства на ресурсы и его цену по бронированию средств на сч.ХО
							If not IsWindow(hWin24)
								Set hWin24= SalCreateWindow( BRK, hWndParent,nMode,nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( hWin24 )
							Break
						! ! Бронирование средств на сч.ХО
						Case 25 !! Управление баз.ставками по бронированию средств на сч.ХО
							If not IsWindow(hWin25)
								Set hWin25 = SalCreateWindow( BR0, hWndParent,nMode,nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( hWin25 )
							Break
						! ! Для nMode=26 :Если ТОБО=0 = видят все, иначе только свое ТОБО
						Case 26 !! Бронирование средств на сч.ХО - полный доступ
							If not IsWindow(hWin26)
								Set hWin26 = SalCreateWindow( BR1, hWndParent,nMode,nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( hWin26 )
							Break
						! ! Для nMode=27 :видят только свое ТОБО, даже если ТОБО=0
						Case 27 !! Бронирование средств на сч.ХО - доступ по ТОБО
							If not IsWindow(hWin26)
								Set hWin26 = SalCreateWindow( BR1, hWndParent,nMode,nPar, strPar01,strPar02 )
							Else
								Call SalBringWindowToTop ( hWin26 )
							Break
					Return TRUE
			! Function: Ini027
				                                                        Description: инициализация библиотеки
				                                                        Returns 
					                                                        Boolean: 
				                                                        Parameters 
				                                                        Static Variables 
				                                                        Local variables 
					                                                        String: strPathToLangResources
					                                                        String: strLangId
					                                                        String: strFileName
				                                                        Actions 
					                                                        If not bApdInited
						! Инициализация LNG-файла
						                                                        Set strPathToLangResources = GetLangPath()
						                                                        Set strLangId = GetLang()
						                                                        Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars027.lng"
						                                                        If (not strLangId) or (not CurrentLangTable.InitFromFile(strFileName, strLangId))
							                                                        Call CurrentLangTable.Init()
						                                                        Set bApdInited = TRUE
					                                                        Return bApdInited
			Function: ShowApdVersion
				Description: Показать версию APD
				Returns
				Parameters
					String: sWin
				Static Variables
				Local variables
					String: strText
					Number: nLength
				Actions
					Call SalStrSetBufferLength( strText, 160 )
					Set nLength = SalGetWindowText ( hWndForm, strText, 160 )
					Call SalSetWindowText ( hWndForm, ApdNum||sWin||ApdVer||' '||SalStrTrimX(strText) )
			Function: GetServerDate
				Description:
				Returns
					Date/Time:
				Parameters
				Static Variables
				Local variables
					Date/Time: Result
					Number: nFetchRes
				Actions
					If SqlPrepareAndExecute( hSql(), "SELECT SYSDATE INTO :Result FROM dual " )
						If SqlFetchNext( hSql(), nFetchRes )
							Return Result
					Return DATETIME_Null
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 25218691
0000: 37010000A2000000 0000000000000000 0200000200FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F22003C00 000A630047656E46
0040: 696C746500727400 00000400001E0002 0400C10001000000 3F8001F800000037
0060: 040001F00D000000 FF1F110000DC0002 00FF7F1570000000 0100FFFF21018022
0080: 000001C200000B63 47F8444669B30004 00770200F601004F 800100FE008D0400
00A0: 010DFD00FF371100 02F700FFDF15DC00 0100FF7F
.enddata
			Functional Class: cDocV
				Description:
				Derived From
					Class: cDoc
				Class Variables
				Instance Variables
					String: s1
					String: s2
				Functions
					Function: iDop
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
						Actions
							Call SqlPrepareAndExecute(hSql(), "
									     INSERT
									     INTO operw (ref,tag,value)
									     VALUES (:cDoc.m_nRef,'RNK  ',:s1)")
							Call SqlPrepareAndExecute(hSql(), "
									     INSERT
									     INTO operw (ref,tag,value)
									     VALUES (:cDoc.m_nRef,'ZDNUM',:s2)")
							Return TRUE
			Functional Class: cDocCP
				Description:
				Derived From
					Class: cDoc
				Class Variables
				Instance Variables
					String: sNlsT1
					String: sNlsT2
				Functions
					Function: iDop
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
						Actions
							! Вставить в OPLDOK
							Set A.Nls = sNlsT1
							Set B.Nls = sNlsT2
							Return TRUE
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton: ctb_pbDetail
			Radio Button:
			Option Button:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box:
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control: cMeter
		Application Actions
	! Table Window: frmBCZCardOld
.winattr
		Class:
		Property Template:
		Class DLL Name:
		Title: Работа с файлами зачислений для BCZ
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   2.338"
				Top:    1.031"
				Width:  13.4"
				Width Editable? Yes
				Height: 6.619"
				Height Editable? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
			View: Table
			Allow Row Sizing? No
			Lines Per Row: Default
		Memory Settings
			Maximum Rows in Memory: 20000
			Discardable? Yes
.end
		                                                        Description: 
		                                                        Named Menus 
		                                                        Menu 
		                                                        Tool Bar 
			                                                        Contents 
				! !
				                                                        Combo Box: cmbBanks
					                                                        List Initialization 
					                                                        Message Actions 
						                                                        On SAM_Create
							                                                        Call cmbBanks.Init(hWndItem)
							                                                        Call cmbBanks.Populate(hSql(), "sab", "nb", "Banks", "WHERE mfop = " || strBankMfo ||
									     " ORDER BY sab")
							                                                        Call cmbBanks.Add('*', '*')
						                                                        On SAM_Click
							                                                        Call SalSendMsg(cmbFileDate, SAM_User, 0, 0)
				! !
				                                                        Group Box: Признак файлов
				                                                        Radio Button: rb2
					                                                        Message Actions 
						                                                        On SAM_Click
							                                                        Set strFileStatus = 'Сквитованые'
							                                                        If SalTblAnyRows(tblFilesSep, ROW_Edited, 0)
								                                                        Call SalSendMsg(pbSave, SAM_Click, 0, 0)
							                                                        Set szOtm = ' and otm>=5'
							                                                        Call SalSendMsg(tblFilesSep, UM_Populate, 0, 0)
				                                                        Radio Button: rb3
					                                                        Message Actions 
						                                                        On SAM_Click
							                                                        Set strFileStatus = 'Несквитованые'
							                                                        If SalTblAnyRows(tblFilesSep, ROW_Edited, 0)
								                                                        Call SalSendMsg(pbSave, SAM_Click, 0, 0)
							                                                        Set szOtm = ' and otm<5'
							                                                        Call SalSendMsg(tblFilesSep, UM_Populate, 0, 0 )
				                                                        Radio Button: rbAll
					                                                        Message Actions 
						                                                        On SAM_Click
							                                                        Set strFileStatus = 'Несквитованые'
							                                                        If SalTblAnyRows(tblFilesSep, ROW_Edited, 0)
								                                                        Call SalSendMsg(pbSave, SAM_Click, 0, 0)
							                                                        Set szOtm = ' and otm<5'
							                                                        Call SalSendMsg(tblFilesSep, UM_Populate, 0, 0 )
				                                                        Radio Button: rb1
					                                                        Message Actions 
						                                                        On SAM_Click
							                                                        Set strFileDirection = 'Входящие'
							                                                        If SalTblAnyRows(tblFilesSep, ROW_Edited, 0)
								                                                        Call SalSendMsg(pbSave, SAM_Click, 0, 0)
							                                                        Set TypedCond = 'Zag_a'
							                                                        Call SalSendMsg(tblFilesSep, UM_Populate, 0, 0)
				                                                        Pushbutton: pbProvodki
					                                                        Message Actions 
						                                                        On SAM_Create
							                                                        Set strTip = 'Удалить файл'
						                                                        On SAM_Click
							                                                        If MessageQuestion(MSG_DEL_Q_R_U_SureEx || tblFilesSep.colFN) != IDYES
								                                                        Return FALSE
							                                                        Call WaitCursorOn()
							                                                        While TRUE
								                                                        Set sDat = SalFmtFormatDateTime(tblFilesSep.colDAT_Z,'MM/dd/yyyy')
								                                                        Call SqlIsolationExclusive(hSql())
								                                                        If not SqlPrepareAndExecute(hSql(), T('
										   DELETE
										   FROM rec_que
										   WHERE rec in (SELECT rec
										                 FROM arc_rrp
										                 WHERE fn_a=:tblFilesSep.colFN and date(dat_a) = :sDat )'))
									                                                        Break 
								                                                        If not SqlPrepareAndExecute(hSql(), T('
										   DELETE
										   FROM arc_rrp
										   WHERE fn_a=:tblFilesSep.colFN and date(dat_a) = :sDat '))
									                                                        Break 
								                                                        If not SqlPrepareAndExecute(hSql(), T('
										   DELETE
										   FROM zag_a
										   WHERE fn=:tblFilesSep.colFN and date(dat) = :sDat  and otm=0'))
									                                                        Break 
								                                                        If tblFilesSep.colREF
									                                                        If not Pay_Bck(tblFilesSep.colREF, 5, '')
										                                                        Break 
								                                                        If not SqlCommitEx(hSql(), 'Удаление файла СЭП: ' || tblFilesSep.colFN)
									                                                        Break 
								                                                        Call SqlIsolationNormal(hSql())
								                                                        Call MessageInfo('Файл СЭП: ' || tblFilesSep.colFN ||' успешно удален!')
								                                                        Return SalPostMsg(tblFilesSep, UM_Populate, 0, 0)
							                                                        Call SqlRollback(hSql())
							                                                        Return MessageError('Ошибка удаления файла СЭП: ' || tblFilesSep.colFN)
				                                                        Pushbutton: pbUnCreate
					                                                        Message Actions 
						                                                        On SAM_Create
							                                                        Set strTip = 'Расформировать файл'
						                                                        On SAM_Click
							                                                        If not rbTypeB ! // возможно расформирование только ИСХОДЯЩИХ файлов СЭП !
								                                                        Return FALSE
							                                                        If MessageQuestion('Расформировать файл СЭП: ' || tblFilesSep.colFN || ' ?') != IDYES
								                                                        Return FALSE
							                                                        Set nBpr = ShowRefBpReason(TRUE) ! // выбрать код ошибки для файла СЭП
							                                                        If nBpr = NUMBER_Null Or nBpr = -1
								                                                        Return FALSE
							                                                        Call WaitCursorOn()
							                                                        While TRUE
								                                                        Set strTT = 'RT0' ! // возможно расформирование только ИСХОДЯЩИХ файлов СЭП!
								                                                        Set nSdb = tblFilesSep.colSDE * 100
								                                                        Set nSkr = tblFilesSep.colSDK * 100
								                                                        Set nRec = 0
								                                                        Set nError = nBpr
								                                                        Set nDetail = 1
								                                                        Set nRetCode = 0
								                                                        Set strTextError = ''
								                                                        If not p_kwt(nRetCode, tblFilesSep.colFN, tblFilesSep.colDAT_Z, nRec, nError)
									                                                        Break 
								                                                        Call SaveInfoToLog('Блокировка документов файла. Код возврата: ' || NumberToStr(nRetCode))
								                                                        If nRetCode != 0  ! // ошибка ...
									                                                        Call SqlRollback(hSql())
									                                                        Set strRetCode = Right('0000' || Str(nRetCode), 4)
									                                                        Call SqlPrepareAndExecute(hSql(), T("
											     SELECT n_er
											     INTO :strTextError
											     FROM S_er
											     WHERE k_er=:strRetCode"))
									                                                        Call SqlFetchNext(hSql(), nFetchRes)
									                                                        Return MessageError('Файл СЭП: ' || tblFilesSep.colFN
											       || ' не расформирован. Код ошибки: ' || strRetCode || ' Описание ошибки: '
											       || strTextError)
								                                                        Set nRetCode = 0
								                                                        Set strTextError = ''
								                                                        If not ps_grc(nRetCode, strTT, tblFilesSep.colFN, tblFilesSep.colDAT_Z,
										   tblFilesSep.colN, nSdb, nSkr, nError, nDetail)
									                                                        Break 
								                                                        Call SaveInfoToLog('Расформирование файла. Код возврата: ' || NumberToStr(nRetCode))
								                                                        If nRetCode != 0 ! // ошибка ...
									                                                        Call SqlRollback(hSql())
									                                                        Set strRetCode = Right('0000' || Str(nRetCode), 4)
									                                                        Call SqlPrepareAndExecute(hSql(), T("
											     SELECT n_er
											     INTO :strTextError
											     FROM S_er
											     WHERE k_er=:strRetCode"))
									                                                        Call SqlFetchNext(hSql(), nFetchRes)
									                                                        Return MessageError('Файл СЭП: ' || tblFilesSep.colFN
											       || ' не расформирован. Код ошибки: ' || strRetCode || ' Описание ошибки: '
											       || strTextError)
								                                                        If SqlCommitEx(hSql(), 'Расформирование файла СЭП: ' || tblFilesSep.colFN) = FALSE
									                                                        Break 
								                                                        Call MessageInfo('Файл СЭП: ' || tblFilesSep.colFN ||
										     ' успешно расформирован. Код ошибки: ' || Str(nRetCode))
								                                                        Return SalSendMsg(tblFilesSep, UM_Populate, 0, 0)
							                                                        Call SqlRollback(hSql())
							                                                        Return MessageError('Ошибка расформирования файла СЭП: ' || tblFilesSep.colFN)
				                                                        Pushbutton: pbNewCreate
					                                                        Message Actions 
						                                                        On SAM_Create
							                                                        Set strTip = 'Переформировать файл'
						                                                        On SAM_Click
							                                                        If rbTypeB = FALSE ! // возможно переформирование только ИСХОДЯЩИХ файлов СЭП !
								                                                        Return FALSE
							                                                        If MessageQuestion('Переформировать файл СЭП: ' || tblFilesSep.colFN || ' ?') != IDYES
								                                                        Return FALSE
							                                                        Call WaitCursorOn()
							                                                        While TRUE
								                                                        Set sDat = SalFmtFormatDateTime(tblFilesSep.colDAT_Z,'MM/dd/yyyy')
								                                                        Call SqlIsolationExclusive(hSql())
								                                                        If not SqlPrepareAndExecute(hSql(), T("
										   UPDATE Zag_b
										   SET otm=1
										   WHERE trim(fn)=:tblFilesSep.colFN and date(dat) = :sDat  and otm=3"))
									                                                        Break 
								                                                        If not SqlCommitEx(hSql(), 'Переформирование файла СЭП: ' || tblFilesSep.colFN)
									                                                        Break 
								                                                        Call SqlIsolationNormal(hSql())
								                                                        Call MessageInfo('Файл СЭП: ' || tblFilesSep.colFN || ' успешно переформирован !')
								                                                        Return SalPostMsg(tblFilesSep, UM_Populate, 0, 0)
							                                                        Call SqlRollback(hSql())
							                                                        Return MessageError('Ошибка переформирования файла СЭП: ' || tblFilesSep.colFN)
		                                                        Contents 
			                                                        Column: colFN
				                                                        List Values 
				                                                        Message Actions 
			                                                        Column: colKV
				                                                        List Values 
				                                                        Message Actions 
			                                                        Column: colDAT_Z
				                                                        List Values 
				                                                        Message Actions 
			                                                        Column: colSDE
				                                                        List Values 
				                                                        Message Actions 
			                                                        Column: colSDK
				                                                        List Values 
				                                                        Message Actions 
			                                                        Column: colN
				                                                        List Values 
				                                                        Message Actions 
			                                                        Column: colOTM
				                                                        List Values 
				                                                        Message Actions 
			                                                        Column: colDATK
				                                                        List Values 
				                                                        Message Actions 
			                                                        Column: colREF
				                                                        List Values 
				                                                        Message Actions 
		                                                        Functions 
		                                                        Window Parameters 
		                                                        Window Variables 
		                                                        Message Actions 
	Form Window: frmBCZCard
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name:
		Title: Работа с файлами зачислений для BCZ
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   2.575"
				Top:    0.99"
				Width:  Class Default
				Width Editable? Class Default
				Height: 9.286"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.083"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 24063
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalSendClassMessage(SAM_Click, 0, 0)
							Set strFilterC = SalStrTrimX(frmBCZCard.tbl.cF.GetFilterWhereClause(FILTER_StandAlone))
							Set strFilterC = IifS(Len(strFilterC)=0, '', ' and ' || strFilterC)
				Pushbutton: pbDetails
					Class Child Ref Key: 31
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 24064
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableSpl
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.083"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 24065
					Class Child Ref Key: 26
					Class ChildKey: 0
					Class: cGenericTableSpl
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbRun
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \Bars98\RESOURCE\BMP\Execute.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Выполнить проводку'
						On SAM_Click
							Call SqlPrepareAndExecute(hSql(), "
									     SELECT nlsk t, nms a
									     INTO :sNLSfromTTS,:sNAMfromTTS
									     FROM tts t, accounts a
									     WHERE t.tt=:sTT and a.nls=t.nlsk and a.kv=:nBaseVal")
							Call SqlFetchNext(hSql(), nFetchRes)
							Set nRefZ = NUMBER_Null
							Call cDoc.SetDoc(nRefZ, sTT, 1, 6, '', GetBankDate(), GetBankDate(), GetBankDate(), GetBankDate(), tbl.colNls2924,
									     tbl.colNam2924, GetBankMfo(), '', nBaseVal, tbl.colSumAll*100, tbl.colOkpo2924, sNLSfromTTS, sNAMfromTTS,
									     GetBankMfo(), '', nBaseVal, tbl.colSumAll*100, GetBankOkpoS(),
									     "Зачисление средств на карточные счета по КЛИЕНТСКОМУ файлу " || tbl.colFileIn, '', GetIdOper(), '',
									     NUMBER_Null, 0)
							Set cDoc.s1 = GetValueStr("
									    SELECT to_char(rnk)
									    FROM customer
									    WHERE stmt=5 and sab='" || Subs(tbl.colFileIn, 3, 4) || "'") ! sRnk
							Set cDoc.s2 = Str(nNumberZap) ! sZDnum
							If not cDoc.oDoc()
								If SqlPrepareAndExecute(hSql(), "
										   UPDATE klp_zd
										   SET comments='Ош.Оплаты'
										   WHERE namefile=:tbl.colFileIn")
									Call SqlCommit(hSql())
							Else
								! сформировать DBF-файл
								Call SalWaitCursor(TRUE)
								! прочитать в файл (DBF)
								Call SqlPrepareAndExecute(hSqlAux2(), "
										     SELECT body
										     INTO :sLong
										     FROM klp_ZD
										     WHERE namefile=:tbl.colFileIn")
								Call SqlFetchNext(hSqlAux2(), nFetchRes)
								Call SalFileOpen(fH, GetPrnDir() || '\\' || tbl.colFileIn, OF_Create | OF_Write)
								! определяем количество записей в файле
								Set sTemp = '    '
								Call InsertBuf(sTemp, 0, sLong, 4, 4)
								Set n1 = SalStrLop(sTemp)
								Set n2 = SalStrLop(sTemp)
								Set n3 = SalStrLop(sTemp)
								Set n4 = SalStrLop(sTemp)
								Set nNumberZap = n4*256*256*256 + n3*256*256 + n2*256 + n1
								! определяем длину заголовка
								Set sTemp = '  '
								Call InsertBuf(sTemp, 0, sLong, 8, 2)
								Set n1 = SalStrLop(sTemp)
								Set n2 = SalStrLop(sTemp)
								Set nHeader = n2*256 + n1
								! определяем длину записи
								Set sTemp = '  '
								Call InsertBuf(sTemp, 0, sLong, 10, 2)
								Set n1 = SalStrLop(sTemp)
								Set n2 = SalStrLop(sTemp)
								Set nLenZap = n2*256 + n1
								Set nLenFile = nHeader + nNumberZap*nLenZap
								Set s65534 = Spac(nLenFile)
								Call InsertBuf(s65534, 0, sLong, 0, nLenFile)
								Call SalFileWrite(fH, s65534, nLenFile)
								Call SalFileClose(fH)
								Call SalWaitCursor(FALSE)
								Set nErr = VisFileCopy(GetPrnDir() || '\\' || tbl.colFileIn, sZDfileDir || tbl.colFileIn)
								If nErr = 1
									Call VisFileDelete(GetPrnDir() || '\\' || tbl.colFileIn)
									!
									Set dServerDate = GetServerDate() 
									Set nRefZ = cDoc.m_nRef
									If SqlPrepareAndExecute(hSql(), "
											   UPDATE klp_zd
											   SET otm=2,userout=:nUserId,dateform=:dServerDate,nameform=:tbl.colFileIn,
											       comments='ОПЛАЧЕНО, ref=" || Str(nRefZ) || "'
											   WHERE namefile=:tbl.colFileIn")
										Call SqlCommit(hSql())
										Call MessageNoWait('Оплачен документ по файлу ' || tbl.colFileIn || ', REF='
												     || Str(nRefZ), 'СООБЩЕНИЕ !', 7, 0)
								Else
									Call SqlRollback(hSql())
									If SqlPrepareAndExecute(hSql(), "
											   UPDATE klp_zd
											   SET otm=1,comments='Невозможно сформировать файл " || sZDfileDir || tbl.colFileIn || "'
											   WHERE namefile=:tbl.colFileIn")
										Call SqlCommit(hSql())
										Call MessageNoWait('Невозможно сформировать файл ' || sZDfileDir || tbl.colFileIn || ' (' || Str(nErr) ||
												     ') ...', 'ОШИБКА !', 7, 1)
								Call SalSendMsg(tbl, UM_Populate, 0, 0)
							! If cDoc.sDoc()
								                                                   If cDoc.iDoc()
								                                                   Else 
									                                                   Call SqlRollback(hSql())
									                                                   If SqlPrepareAndExecute(hSql(), "
											   UPDATE klp_zd
											   SET comments='Ош.Оплаты2'
											   WHERE namefile=:tbl.colFileIn")
										                                                   Call SqlCommit(hSql())
							! Else
								                                                   Call SqlRollback(hSql())
								                                                   If SqlPrepareAndExecute(hSql(), "
										   UPDATE klp_zd
										   SET comments='Ош.Оплаты1'
										   WHERE namefile=:tbl.colFileIn")
									                                                   Call SqlCommit(hSql())
				! cMeter: ccProgressBar
.winattr class Custom Control:
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cMeter
					Property Template:
					Class DLL Name:
					Display Settings
						DLL Name: vti11.dll
						MS Windows Class Name: VT:cMeter:10
						Style:  0x00000000
						ExStyle:  0x00000000
						Title:
						Window Location and Size
							Left:   6.8"
							Top:    0.06"
							Width:  5.0"
							Width Editable? Yes
							Height: 0.333"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Etched Border? Yes
						Hollow? No
						Vertical Scroll? No
						Horizontal Scroll? No
						Tab Stop? None
						Tile To Parent? No
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Blue
						Background Color: System Window Color
						DLL Settings
.end
					                                                       Message Actions 
				Combo Box: cmbOtm
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   3.217"
						Top:    0.095"
						Width:  3.55"
						Width Editable? Yes
						Height: 1.19"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: Default
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Click
							If cmbOtm = 'Принятые'
								Set strFilter = ' and klp_zd.otm=1 and klp_zd.comments is null'
							If cmbOtm = 'Обработанные'
								Set strFilter = ' and klp_zd.otm=2'
							If cmbOtm = 'Необработанные'
								Set strFilter = ' and klp_zd.otm=1 and klp_zd.comments is not null'
							Call SalSendMsg(tbl, UM_Populate, 0, 0)
		Contents
			Custom Control: ccSplitter
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.0"
						Top:    7.095"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Child Table: tbl
				Class Child Ref Key: 28
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    0.0"
						Width:  11.533"
						Width Editable? Class Default
						Height: 3.452"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: colDatIn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								поступления
								файла
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Class Default
						Width:  1.817"
						Width Editable? Class Default
						Format: DateTime
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colFileIn
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Имя вх.
								файла
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  0.783"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSab
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
								органи-
								зации
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.217"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colNmk
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Наиме-
								нование
								организации
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  1.4"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSumAll
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Итоговая
								сумма
								по файлу
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  0.967"
						Width Editable? Class Default
						Format: ###000
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSum2924
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сумма
								на счёте
								2924 кл.
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  0.917"
						Width Editable? Class Default
						Format: ###000
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colFileOut
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Имя вых.
								файла
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  0.933"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colDatForm
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								формирования
								файла
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Class Default
						Width:  1.517"
						Width Editable? Class Default
						Format: DateTime
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colComments
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								Примечание
						Visible? Class Default
						Editable? Yes
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  1.15"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colOtm
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								Примечание
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  1.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colUin
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								Примечание
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  1.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colUout
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								Примечание
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  1.8"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colTUin
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								Принял
						Visible? Yes
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  0.833"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colTUout
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								Сформировал
						Visible? Yes
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  1.383"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colNls2924
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								Сформировал
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  1.383"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colNam2924
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								Сформировал
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  1.383"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colOkpo2924
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								Сформировал
						Visible? No
						Editable? No
						Maximum Data Length: Class Default
						Data Type: String
						Justify: Class Default
						Width:  1.383"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On UM_Populate
						Call SalWaitCursor(TRUE)
						! Call Debug('5')
						! Set strSqlPopulate = "
								    SELECT z.datetime,z.namefile,z.userin,z.otm,z.userout,z.dateform,z.nameform,z.sumdok/100,z.comments,c.nmk,c.sab,
								           a.ostc/100,s1.fio,s2.fio,a.nls,a.nms,c.okpo
								    INTO :colDatIn,:colFileIn,:colUin,:colOtm,:colUout,:colDatForm,:colFileOut,:colSumAll,:colComments,:colNmk,
								         :colSab,:colSum2924,:colTUin,:colTUout,:colNls2924,:colNam2924,:colOkpo2924
								    FROM klp_zd z, customer c, accounts a, cust_acc cu, staff s1, staff s2
								    WHERE c.sab=substr(z.namefile,3,4) and c.rnk=cu.rnk and cu.acc=a.acc and a.kv=980 and a.nbs='2924' and
								          a.dazs is null and z.userin=s1.id and z.userout=s2.id(+) " || strFilter || "
								    ORDER BY 1"
						Set strSqlPopulate = "
								    SELECT klp_zd.datetime,klp_zd.namefile,klp_zd.userin,klp_zd.otm,klp_zd.userout,klp_zd.dateform,klp_zd.nameform,
								           klp_zd.sumdok/100,klp_zd.comments,c.nmk,c.sab,a.ostc/100,s1.fio,s2.fio,a.nls,a.nms,c.okpo
								    INTO :colDatIn,:colFileIn,:colUin,:colOtm,:colUout,:colDatForm,:colFileOut,:colSumAll,:colComments,:colNmk,
								         :colSab,:colSum2924,:colTUin,:colTUout,:colNls2924,:colNam2924,:colOkpo2924
								    FROM klp_zd klp_zd, customer c, accounts a, cust_acc cu, staff s1, staff s2
								    WHERE c.sab=substr(klp_zd.namefile,3,4) and c.rnk=cu.rnk and cu.acc=a.acc and a.kv=980 and
								          a.nls like '2924%001' and a.dazs is null and klp_zd.userin=s1.id and klp_zd.userout=s2.id(+) "
								          || strFilter || strFilterC || "
								    ORDER BY 1"
						! SELECT ниже для отладки (там стоит ЛЕВЫЙ счёт)
						! Set strSqlPopulate = "
								    SELECT klp_zd.datetime,klp_zd.namefile,klp_zd.userin,klp_zd.otm,klp_zd.userout,klp_zd.dateform,klp_zd.nameform,
								           klp_zd.sumdok/100,klp_zd.comments,c.nmk,c.sab,a.ostc/100,s1.fio,s2.fio,a.nls,a.nms,c.okpo
								    INTO :colDatIn,:colFileIn,:colUin,:colOtm,:colUout,:colDatForm,:colFileOut,:colSumAll,:colComments,:colNmk,
								         :colSab,:colSum2924,:colTUin,:colTUout,:colNls2924,:colNam2924,:colOkpo2924
								    FROM klp_zd klp_zd, customer c, accounts a, cust_acc cu, staff s1, staff s2
								    WHERE c.sab=substr(klp_zd.namefile,3,4) and c.rnk=cu.rnk and cu.acc=a.acc and a.kv=980 and
								          (a.nls like '2924%001' or a.nls like '2600006377') and a.dazs is null and klp_zd.userin=s1.id and
								          klp_zd.userout=s2.id(+) " || strFilter || strFilterC || "
								    ORDER BY 1"
						Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						Call SalTblPopulate(hWndForm, hSql(), T(strSqlPopulate), TBL_FillAll)
						! Set nRow = VisTblFindString(tbl, 0, colId_Key, sId_Key)
						! If nRow = -1
							                                                        Call SalTblSetContext(hWndForm, 0)
						! Else
							                                                        Call SalTblSetContext(hWndForm, nRow )
							                                                        Call SalTblSetRowFlags(hWndForm, nRow, ROW_Selected, TRUE)
							                                                        Call SalTblSetFocusRow(hWndForm, nRow)
						Call VisTblAutoSizeColumn(tbl, hWndNULL)
						If SalTblSetFocusRow(hWndForm, 0) and SalTblSetContext(hWndForm, 0)
							Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
						Else
							Set nCurrentRow = TBL_MinRow							
							Loop
								If SalTblFindNextRow(tbl2, nCurrentRow, 0, 0)
									Call SalTblDeleteRow(tbl2, nCurrentRow, TBL_Adjust)
								Else
									Break
						Call SalTblSetFocusRow(hWndForm, 0)
						Call SalTblSetContext(hWndForm, 0)
						Call SalTblSetRowFlags(hWndForm, 0, ROW_Selected, TRUE)
						If cmbOtm = 'Обработанные'
							Call SalDisableWindow(pbRun)
							Call SalDisableWindow(pbUpdate)
						Else
							Call SalEnableWindow(pbRun)
							Call SalEnableWindow(pbUpdate)
						Call SalWaitCursor(FALSE)
					On SAM_Create
						! Call Debug('tbl - 1')
						Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
						Set strFilter = ' and klp_zd.otm=1 and klp_zd.comments is null'
						Set strFilterC = ''
						Set strSqlUpdate = "
								    UPDATE klp_zd
								    SET otm=1,comments=:tbl.colComments
								    WHERE namefile=:tbl.colFileIn"
					! On SAM_CreateComplete
						! Call Debug('tbl1 - 2')
						! Call VisTblAutoSizeColumn(tbl, hWndNULL)
						                                                   Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
					On SAM_TblDoDetails
						Call SalSendMsg(tbl2, UM_Populate, 0, 0)
					On UM_Update
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(tbl, nRow, ROW_Edited, 0)
							Call SalTblSetContext(tbl, nRow)
							Call SqlPrepare(hSql(), T(strSqlUpdate))
							Call SalTblDoUpdates(tbl, hSql(), TRUE)
						Call SqlCommit(hSql())
						Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
					On SAM_FetchRowDone
						If colOtm = 1
							If colSum2924 >= colSumAll
								Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_LightGreen)
							Else
								Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_Orchid)
			Child Table: tbl2
				Class Child Ref Key: 27
				Class ChildKey: 0
				Class: cGenericTableSpl
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    0.071"
						Width:  11.533"
						Width Editable? Class Default
						Height: 4.798"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 20000
					Discardable? Class Default
				Contents
					Column: colBranchPart
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
								операционной
								точки
						Visible? Class Default
						Editable? No
						Maximum Data Length: 3
						Data Type: String
						Justify: Left
						Width:  1.333"
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colCompany
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
								органи-
								зации
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  0.867"
						Width Editable? Class Default
						Format: #0
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSBK_NUM
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Клиентский
								карточный
								счёт
						Visible? Class Default
						Editable? No
						Maximum Data Length: 20
						Data Type: String
						Justify: Left
						Width:  1.167"
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSBK_SUM
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Сумма
								зачис-
								ления
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  0.867"
						Width Editable? Class Default
						Format: Decimal
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSBK_FIO
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: 
								ФИО
						Visible? Class Default
						Editable? No
						Maximum Data Length: 40
						Data Type: String
						Justify: Left
						Width:  0.583"
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSBK_CRD
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Номер
								кредитного
								счёта
						Visible? Class Default
						Editable? No
						Maximum Data Length: 20
						Data Type: String
						Justify: Left
						Width:  1.1"
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSBK_COR
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Номер
								корреспондирующего
								счёта
						Visible? Class Default
						Editable? No
						Maximum Data Length: 20
						Data Type: String
						Justify: Left
						Width:  1.933"
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSBK_PAS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Серия и
								номер
								паспорта
						Visible? Class Default
						Editable? No
						Maximum Data Length: 20
						Data Type: String
						Justify: Left
						Width:  1.0"
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSBK_INN
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Идентификационный
								код
								клиента
						Visible? Class Default
						Editable? No
						Maximum Data Length: 10
						Data Type: String
						Justify: Left
						Width:  1.883"
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSBK_SHR
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Короткий
								комментарий
								к операции
						Visible? Class Default
						Editable? No
						Maximum Data Length: 10
						Data Type: String
						Justify: Left
						Width:  1.267"
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSBK_FLR
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назна-
								чение
								платежа
						Visible? Class Default
						Editable? No
						Maximum Data Length: 250
						Data Type: String
						Justify: Left
						Width:  0.833"
						Width Editable? Class Default
						Format: Unformatted
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On UM_Populate
						Call SalWaitCursor(TRUE)
						! прочитать в файл (DBF)
						Call SqlPrepareAndExecute(hSqlAux2(), "
								     SELECT body
								     INTO :sLong
								     FROM klp_ZD
								     WHERE namefile=:tbl.colFileIn")
						Call SqlFetchNext(hSqlAux2(), nFetchRes)
						Call SalFileOpen(fH, GetPrnDir() || '\\' || tbl.colFileIn, OF_Create | OF_Write)
						! определяем количество записей в файле
						Set sTemp = '    '
						Call InsertBuf(sTemp, 0, sLong, 4, 4)
						Set n1 = SalStrLop(sTemp)
						Set n2 = SalStrLop(sTemp)
						Set n3 = SalStrLop(sTemp)
						Set n4 = SalStrLop(sTemp)
						Set nNumberZap = n4*256*256*256 + n3*256*256 + n2*256 + n1
						! Call DebugN(nNumberZap)
						! определяем длину заголовка
						Set sTemp = '  '
						Call InsertBuf(sTemp, 0, sLong, 8, 2)
						Set n1 = SalStrLop(sTemp)
						Set n2 = SalStrLop(sTemp)
						Set nHeader = n2*256 + n1
						! Call DebugN(nHeader)
						! определяем длину записи
						Set sTemp = '  '
						Call InsertBuf(sTemp, 0, sLong, 10, 2)
						Set n1 = SalStrLop(sTemp)
						Set n2 = SalStrLop(sTemp)
						Set nLenZap = n2*256 + n1
						! Call DebugN(nLenZap)
						!
						Set nLenFile = nHeader + nNumberZap*nLenZap
						! Call DebugN(nLenFile)
						!
						! Call DebugN(nLenFile)
						!
						Set s65534 = Spac(nLenFile)
						Call InsertBuf(s65534, 0, sLong, 0, nLenFile)
						Call SalFileWrite(fH, s65534, nLenFile)
						Call SalFileClose(fH)
						! Call Debug('4')
						Set nCurrentRow = TBL_MinRow							
						Loop
							If SalTblFindNextRow(hWndForm, nCurrentRow, 0, 0)
								Call SalTblDeleteRow(hWndForm, nCurrentRow, TBL_Adjust)
							Else
								Break
						Call SalFileGetCurrentDirectory(sCurrentDir)
						Call SalFileSetCurrentDirectory(GetPrnDir())
						Set SqlDatabase = 'dBase_Files'
						Call SqlConnect(hSqlA)
						Call SqlPrepareAndExecute(hSqlA, "
								     SELECT BRANCHPART,COMPANY,SBK_NUM,SBK_SUM,SBK_FIO,SBK_CRD,SBK_COR,SBK_PAS,SBK_INN,SBK_SHR,SBK_FLR
								     FROM " || tbl.colFileIn || "
								     INTO :sBRANCHPART,:nCOMPANY,:sSBK_NUM,:nSBK_SUM,:sSBK_FIO,:sSBK_CRD,:sSBK_COR,:sSBK_PAS,:sSBK_INN,:sSBK_SHR,
								          :sSBK_FLR")
						While SqlFetchNext(hSqlA, nFetchRes)
							Set nRow = SalTblInsertRow(tbl2, TBL_MaxRow)
							Call SalTblSetContext(tbl2, nRow)				
							Set tbl2.colBranchPart = SalStrTrimX(StrDosToWinX(sBRANCHPART))
							Set tbl2.colCompany    = nCOMPANY
							Set tbl2.colSBK_NUM    = SalStrTrimX(StrDosToWinX(sSBK_NUM))
							Set tbl2.colSBK_SUM    = nSBK_SUM
							Set tbl2.colSBK_FIO    = SalStrTrimX(StrDosToWinX(sSBK_FIO))
							Set tbl2.colSBK_CRD    = SalStrTrimX(StrDosToWinX(sSBK_CRD))
							Set tbl2.colSBK_COR    = SalStrTrimX(StrDosToWinX(sSBK_COR))
							Set tbl2.colSBK_PAS    = SalStrTrimX(StrDosToWinX(sSBK_PAS))
							Set tbl2.colSBK_INN    = SalStrTrimX(StrDosToWinX(sSBK_INN))
							Set tbl2.colSBK_SHR    = SalStrTrimX(StrDosToWinX(sSBK_SHR))
							Set tbl2.colSBK_FLR    = SalStrTrimX(StrDosToWinX(sSBK_FLR))
						Call SalFileSetCurrentDirectory(sCurrentDir)
						Call SqlDisconnect(hSqlA)
						Call VisFileDelete(GetPrnDir() || '\\' || tbl.colFileIn)
						! Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						!
						! Call SalTblDefineSplitWindow(hWndForm, 1, TRUE)
						! Set nRow = SalTblInsertRow(hWndForm, TBL_MinRow)
						! Call SalTblSetContext(hWndForm, nRow)
						Call SalTblSetFlagsAnyRows(tbl2, ROW_New, FALSE, 0, 0)
						Call VisTblAutoSizeColumn(tbl2, hWndNULL)
						Call SalWaitCursor(FALSE)
						! Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
						!
						! Set nRow = VisTblFindString(tbl2, 0, colKkd, sKkd)
						! If nRow=-1
							                                                        Call SalTblSetContext( hWndForm, 0 )
						! Else
							                                                        Call SalTblSetContext( hWndForm, nRow )
							                                                        Call SalTblSetRowFlags( hWndForm, nRow, ROW_Selected, TRUE )
							                                                        Call SalTblSetFocusRow( hWndForm, nRow )
						! Call SalSendMsg( hWndForm, SAM_TblDoDetails, 0, 0 )
						! Call SalWaitCursor(FALSE)
					! On SAM_Create
						                                                   Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
						! Call Debug('tbl2 - 1')
					! On SAM_CreateComplete
						! Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
		Functions
		Window Parameters
		Window Variables
			String: strSqlPopulate
			String: strSqlUpdate
			Number: nRow
			String: sTemp
			Number: n1
			Number: n2
			Number: n3
			Number: n4
			Number: nLenZap
			Number: nHeader
			Number: nLenFile
			String: s65534
			Number: nCurrentRow
			Number: nNumberZap
			Sql Handle: hSqlA
			File Handle: fH
			String: sCurrentDir
			Long String: sLong
			!
			String: sBRANCHPART
			Number: nCOMPANY
			String: sSBK_NUM
			Number: nSBK_SUM
			String: sSBK_FIO
			String: sSBK_CRD
			String: sSBK_COR
			String: sSBK_PAS
			String: sSBK_INN
			String: sSBK_SHR
			String: sSBK_FLR
			!
			String: sZDfileDir
			String: strFilter
			String: strFilterC
			!
			Number: nUserId
			String: sTT
			Number: nBaseVal
			Number: nRefZ
			Date/Time: dServerDate
			String: sNLSfromTTS
			: cDoc
				Class: cDocV
			String: sNAMfromTTS
			!
			! Boolean: bConnectDBF
			Number: nErr
		Message Actions
			On SAM_Create
				! Call Debug('1')
				Call PrepareWindowEx(hWndForm)
				! Call Debug('2')
				Call SetWindowFullSize(hWndForm)
				! Call Debug('3')
				Call ShowApdVersion('02')
				! Call Debug('4')
				Call SalUseRegistry(FALSE, '')
				Call SalGetProfileString('Export', 'PK_FILE', GetPrnDir(), sZDfileDir, GetIniFileName())
				Set sZDfileDir = sZDfileDir || IifS(Right(sZDfileDir, 1)='\\', '', '\\')
				Call SalListAdd(cmbOtm, 'Принятые')
				Call SalListAdd(cmbOtm, 'Необработанные')
				Call SalListAdd(cmbOtm, 'Обработанные')
				Call SalListSetSelect(cmbOtm, 0)
				! Call SalListSelectString(cmbOtm, 0, 'Принятые')
				Set nUserId = GetUserId()
				Set sTT = 'ZD0'
				Set nBaseVal = GetBaseVal()
				! Set bConnectDBF = FALSE
				! Set dDat=GetBankDate()
				Set strFilterTblName = 'KLP_ZD'
				Call SalSendClassMessage(SAM_Create, 0, 0)
			! On SAM_Destroy
				                                                   If bConnectDBF
					                                                   Call SalFileSetCurrentDirectory(sCurrentDir)
					                                                   Call SqlDisconnect(hSqlA)
					                                                   Set bConnectDBF = FALSE
	Dialog Box: dlg_Modify
		Class:
		Property Template:
		Class DLL Name:
		Title: Изменение условий КД реф.=
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   0.95"
				Top:    0.271"
				Width:  10.567"
				Width Editable? Yes
				Height: 5.274"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Group Box: Новые условия
				Resource Id: 2087
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.683"
					Top:    0.571"
					Width:  3.3"
					Width Editable? Yes
					Height: 4.167"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
			Group Box: Действующие условия
				Resource Id: 2088
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.483"
					Top:    0.571"
					Width:  3.1"
					Width Editable? Yes
					Height: 4.167"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Blue
				Background Color: Default
			!
			Data Field: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.383"
						Top:    0.155"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '№ договора' )
			Data Field: PROD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    0.155"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '№ договора' )
			Data Field: SDATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.283"
						Top:    0.155"
						Width:  1.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата договора' )
			Data Field: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.183"
						Top:    0.155"
						Width:  3.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Заемщик' )
			Data Field: OST
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.883"
						Top:    0.571"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Текущая Сумма задолженности по телу КД' )
			!
			Background Text: ___Сумма Норм.долга___
				Resource Id: 2089
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.883"
					Top:    0.845"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: LIMIT_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.683"
						Top:    0.821"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: LIMIT_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.883"
						Top:    0.821"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Background Text: Дата Первого погашения
				Resource Id: 2090
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.883"
					Top:    1.095"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: FDAT_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.683"
						Top:    1.071"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: FDAT_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.883"
						Top:    1.071"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_KillFocus
						If FDAT_new < GetBankDate()
							Call SalMessageBox('Ошибка !',
									'Дата первого погашения д.б. >= Текущей !', MB_IconStop)
							Set FDAT_new = dTmpE
					On SAM_SetFocus
						Set dTmpE = FDAT_new
			!
			Background Text: ____Дата завершения____
				Resource Id: 2091
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.883"
					Top:    1.345"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: WDATE_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.683"
						Top:    1.321"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: WDATE_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.883"
						Top:    1.321"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_KillFocus
						If WDATE_new <= FDAT_new
							Call SalMessageBox('Ошибка !',
									'Дата завершения д.б. > Даты начала !', MB_IconStop)
							Set WDATE_new  = WDATE_old
			!
			Background Text: ______Базовый год______
				Resource Id: 2092
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.883"
					Top:    1.595"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: Basey_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.683"
						Top:    1.571"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: Basey_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.883"
						Top:    1.571"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Background Text: ____Годовая % ставка____
				Resource Id: 2093
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.883"
					Top:    1.845"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: IR_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.683"
						Top:    1.821"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: IR_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.883"
						Top:    1.821"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Background Text: ____Метод комиссии____
				Resource Id: 2094
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.883"
					Top:    2.095"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: Metr96_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.683"
						Top:    2.071"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: Metr96_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.883"
						Top:    2.071"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Background Text: ___% ставка комисси___
				Resource Id: 2095
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.883"
					Top:    2.345"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: KOM_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.683"
						Top:    2.321"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: KOM_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.883"
						Top:    2.321"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Background Text: _Способ построения ГПК_
				Resource Id: 2096
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.883"
					Top:    2.595"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: GPK_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.683"
						Top:    2.571"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: GPK_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.883"
						Top:    2.571"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Background Text: ___Период погашения___
				Resource Id: 2097
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.883"
					Top:    2.845"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: FREQ_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.683"
						Top:    2.821"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: FREQ_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.883"
						Top:    2.821"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Background Text: _"Платежный" день в ГПК_
				Resource Id: 2098
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.683"
					Top:    3.095"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? No
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: DEN_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.683"
						Top:    3.071"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: DEN_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.383"
						Top:    3.071"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Принять
				Window Location and Size
					Left:   3.883"
					Top:    3.405"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.5"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Enter
				Font Name: Arial Cyr
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						If WDATE_new = WDATE_old AND
								   LIMIT_new = LIMIT_old AND
								   IR_new    = IR_old    AND
								   KOM_new   = KOM_old   AND
								   FDAT_new =  FDAT_old
							Call SalMessageBox('Нет изменений условий !',
									'Внимание !', MB_IconStop)
						Else
							If SalMessageBox(
									'Вы действительно хотите перестроить ГПК по новым условиям ?',
									'В Н И М А Н И Е !', MB_IconQuestion | MB_YesNo) = IDYES
								Call F_SAVE()
							Call SalEndDialog(hWndForm, 1)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сброс
				Window Location and Size
					Left:   5.083"
					Top:    3.405"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.5"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Esc
				Font Name: Arial Cyr
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, 0)
			!
			Group Box: Способ округления
				Resource Id: 2099
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.833"
					Top:    3.321"
					Width:  3.05"
					Width Editable? Yes
					Height: 1.333"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
			Radio Button: rb0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 0. Коп  1123.45
				Window Location and Size
					Left:   6.983"
					Top:    3.571"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Red
				Background Color: Default
				Message Actions
			Radio Button: rb1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 1. 10 "Коп"  1123.50
				Window Location and Size
					Left:   6.983"
					Top:    4.071"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Red
				Background Color: Default
				Message Actions
			Radio Button: rb2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 2.  100 "коп" 1124.00
				Window Location and Size
					Left:   6.983"
					Top:    3.821"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Red
				Background Color: Default
				Message Actions
			Radio Button: rb3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 3. 1000 "Коп"   1120.00
				Window Location and Size
					Left:   6.983"
					Top:    4.321"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Red
				Background Color: Default
				Message Actions
			Group Box: "Каникулы"
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Resource Id: 2100
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.783"
					Top:    3.321"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.667"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Blue
				Background Color: Default
			Radio Button: rb_KY
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 0.Есть
				Window Location and Size
					Left:   0.917"
					Top:    3.536"
					Width:  1.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Blue
				Background Color: Default
				Message Actions
			Radio Button: rb_KN
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 1.Нет
				Window Location and Size
					Left:   2.017"
					Top:    3.536"
					Width:  0.9"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Blue
				Background Color: Default
				Message Actions
			Group Box: %% За предыщущий
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Resource Id: 2101
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.783"
					Top:    4.071"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.607"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Blue
				Background Color: Default
			Radio Button: rb_D
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 0.День
				Window Location and Size
					Left:   0.883"
					Top:    4.321"
					Width:  1.0"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Blue
				Background Color: Default
				Message Actions
			Radio Button: rb_M
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6530000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1900
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: 1.Месяц
				Window Location and Size
					Left:   1.983"
					Top:    4.321"
					Width:  1.1"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Midnight Blue
				Background Color: Default
				Message Actions
		Functions
			Function: F_SAVE
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nDig
					Number: nAcc
					String: sTag
					String: sTxt
					String: FLAGS2
					String: sTip
					String: sErr
					String: sMess
				Actions
					Set sErr = ''
					If FDAT_new < GetBankDate()
						Set sErr = sErr || '
								Дата начала погашения д.б. >= Текущей !'
					If WDATE_new <= FDAT_new
						Set sErr = sErr || '
								Дата завершения д.б. > Даты начала погашения !'
					! If OST >
					!
					If sErr != ''
						Call SalMessageBox('Ошибка !', sErr, MB_IconStop)
						Return FALSE
					!
					Call SalWaitCursor(TRUE)
					Set nDig  = 0
					If rb1
						Set nDig  = 1
					Else If rb2
						Set nDig  = 2
					Else If rb3
						Set nDig  = 3
					!
					If SqlPrepareAndExecute(hSql(),
							"SELECT tag,Substr(txt,1,250) INTO :sTag,:sTxt FROM ND_TXT WHERE nd=:nNd")
						While SqlFetchNext( hSql(), nFetchRes )
							If sTag='FLAGS'
								If Subs(sTxt,1,1)='1'
									Set rb_KN = TRUE
								Else
									Set rb_KY = TRUE
								If Subs(sTxt,2,1)='1'
									Set rb_M = TRUE
								Else
									Set rb_D = TRUE
					!
					If rb_M
						Set FLAGS2='1'
					Else
						Set FLAGS2='0'
					!
					Set sMess = 'Cохранение модиф.ГПК КД '||CC_ID
					If SqlPLSQLCommand(hSql(), "PM_GPK
							(nRnk, nNd, acc8, IR_old, KOM_old,
							 nGpk, FLAGS2, LIMIT_new*100, FDAT_new, WDATE_new,
							 IR_new, nFreq, nBasey, nMetr96, KOM_new, nDig ) " )
						Call SqlCommitEx(hSql(),sMess)
						Call MessageNoWait(sMess,'Сообщение',3,0)
						! Set bOk=TRUE
					Else
						Call SqlRollback(hSql())
						Call MessageNoWait('Неуспешная модификация ГПК КД='||CC_ID, 'Ошибка', 0, 1)
						! Set bOk=FALSE
					Call SalWaitCursor(FALSE)
		Window Parameters
			Number: p_ND
			String: P_Title
		Window Variables
			Number: acc8
			Number: nGpk
			Number: nGpk_A
			Number: nBasey
			Number: nFreq
			Number: nMetr96
			Number: nNd
			Number: nRnk
			Date/Time: bDate
			Date/Time: dTmpE
		Message Actions
			On SAM_Create
				Call SalSetWindowText( hWndForm, P_Title || ' реф='|| Str(p_ND) )
				Call SalCenterWindow(hWndForm)
				Set nNd = p_ND
				Set bDate = GetBankDate()
				Call SalDisableWindow( rb_KY )
				Call SalDisableWindow( rb_KN )
				Call SalDisableWindow( rb_D )
				Call SalDisableWindow( rb_M )
				! nGpk Берем Из описания продукта, а надо бы из счета 8999(vid)
						    p_mode_gpk      := to_number(wcs_utl.get_mac(p_bid_id, 'MODE_GPK'));
				If SqlPrepareAndExecute( hSql(),
						  "SELECT d.CC_ID, d.SDATE, c.NMK, d.WDATE, -ss.ostc/100,
						          acrn.FPROCN(a.acc,0,:bDate),  acrn.FPROCN(a.acc,2,:bDate),
						          a.acc, decode(a.vid,4,3,1),  c.rnk, -a.ostc/100, d.prod,
						    (select min(fdat) from cc_lim where nd=d.nd and fdat>=:bDate)
						   INTO :CC_ID , :SDATE, :NMK, :WDATE_old, :LIMIT_old, :IR_old,
						        :KOM_old, :acc8, :nGpk_A, :nRnk,  :OST, :PROD, :FDAT_old
						   FROM cc_deal d, customer c, nd_acc n, accounts a, accounts SS
						   WHERE d.nd=:p_ND and d.rnk=c.rnk and d.sos<15
						     and d.nd=n.nd and n.acc=a.acc and a.tip='LIM'
						     and ss.tip='SS ' and ss.accc=a.acc " )
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Call SalEndDialog(hWndForm, 0)
				!
				If SqlPrepareAndExecute( hSql(),
						  "select b.name, i.basey, i.freq, i.s , q.name
						   into :Basey_old, :nBasey, :nFreq, :DEN_old, :FREQ_old
						   from int_accn i, basey b, freq q
						   where i.acc=:acc8 and id=0 and i.basey=b.basey and i.freq=q.freq" )
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Call SalEndDialog(hWndForm, 0)
				!
				If SqlPrepareAndExecute( hSql(),
						  "Select b.name, i.metr into :Metr96_old, :nMetr96
						   from int_accn i, int_metr b
						   where i.acc=:acc8 and id=2 and i.metr= b.metr " )
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Call SalEndDialog(hWndForm, 0)
				! CCK_GPK_TYPES
				If SqlPrepareAndExecute( hSql(),
						  "SELECT name, id INTO  :GPK_old, :nGpk FROM CCK_GPK_TYPES
						   WHERE id = to_number(wcs_utl.get_mac( :nNd, 'MODE_GPK' )) " )
						and NOT SqlFetchNext( hSql(), nFetchRes )
					! Call Debug('aa')
					Call SalEndDialog(hWndForm, 0)
				!
				Set FDAT_new  = FDAT_old
				Set WDATE_new = WDATE_old
				Set LIMIT_new = LIMIT_old
				Set IR_new    = IR_old
				Set KOM_new   = KOM_old
				Set Basey_new = Basey_old
				Set DEN_new   = DEN_old
				Set Metr96_new= Metr96_old
				Set GPK_new   = GPK_old
				Set FREQ_new  = FREQ_old
				Set rb0 = TRUE
				!
				!
	Form Window: VS
		Class:
		Property Template:
		Class DLL Name:
		Title: Подтверждение Изменений условий КД 
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.075"
				Top:    -0.156"
				Width:  12.3"
				Width Editable? Yes
				Height: 7.738"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.5"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Data Field: NMK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.683"
							Top:    0.155"
							Width:  10.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Заемщик' )
		Contents
			Group Box: Предыдущие условия
				Resource Id: 2068
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    2.905"
					Width:  3.8"
					Width Editable? Yes
					Height: 2.833"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Blue
				Background Color: Default
			Data Field: SDATE_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    3.155"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата заключения договора' )
			Data Field: WDATE_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.083"
						Top:    3.155"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата завершения договора' )
			Data Field: CC_ID_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    3.405"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '№  КД' )
			Data Field: p_OLD_ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.083"
						Top:    3.405"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф. КД' )
			Data Field: SDOG_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    3.655"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Начальная Сумма по КД' )
			Data Field: LIMIT_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.083"
						Top:    3.655"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Текущая Сумма по телу КД' )
			Data Field: PROD_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    3.905"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Продукт' )
			Data Field: FDAT_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.083"
						Top:    3.905"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Следующая пл.дата' )
			Data Field: Basey_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    4.405"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '%-База' )
			Data Field: IR_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.083"
						Top:    4.405"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% ставка' )
			Data Field: Metr96_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    4.655"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Метод ежемес.комиссии' )
			Data Field: KOM_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.083"
						Top:    4.655"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Ставка ежем.комиссии' )
			Data Field: GPK_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    4.905"
						Width:  3.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Способ построения ГПК' )
			Data Field: BR_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    5.155"
						Width:  3.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: BR_NAME_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    5.405"
						Width:  3.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Background Text: Дата Начала и Завершения
				Resource Id: 51827
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.083"
					Top:    3.179"
					Width:  3.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Внешний № и Реф. КД
				Resource Id: 51828
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.083"
					Top:    3.429"
					Width:  3.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Начальная и Текущая Сумма 
				Resource Id: 51829
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.083"
					Top:    3.679"
					Width:  3.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Код Продукта. Дата погашения
				Resource Id: 51830
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.083"
					Top:    3.929"
					Width:  3.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Грейс по Телу или по  Проц+Ком
				Resource Id: 51832
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.083"
					Top:    4.179"
					Width:  3.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Red
				Background Color: Default
			Background Text: Базовый год и % ставка
				Resource Id: 51833
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.083"
					Top:    4.429"
					Width:  3.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Метод и % ставка (Сумма)комисси
				Resource Id: 51834
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.083"
					Top:    4.679"
					Width:  3.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Способ построения ГПК
				Resource Id: 51835
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.083"
					Top:    4.929"
					Width:  3.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Group Box: Новые условия
				Resource Id: 2067
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   7.583"
					Top:    2.905"
					Width:  3.9"
					Width Editable? Yes
					Height: 2.833"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
			Data Field: SDATE_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.783"
						Top:    3.155"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата заключения договора' )
			Data Field: WDATE_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.583"
						Top:    3.155"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата завершения договора' )
			Data Field: CC_ID_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.783"
						Top:    3.405"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '№  КД' )
			Data Field: p_NEW_ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.583"
						Top:    3.405"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф. КД' )
			Data Field: SDOG_new 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.783"
						Top:    3.655"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Начальная Сумма по КД' )
			Data Field: LIMIT_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.583"
						Top:    3.655"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Новая сумма тела кредита' )
			Data Field: PROD_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.783"
						Top:    3.905"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Продукт' )
			Data Field: FDAT_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.583"
						Top:    3.905"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Первая платежная дата' )
			!
			Data Field: P_GRACE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.283"
						Top:    4.155"
						Width:  0.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Действует: Кол-во грейс-периодов (месяцев)' )
			Data Field: GRC_N
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.783"
						Top:    4.155"
						Width:  0.5"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Отменено : Кол-во грейс-периодов (месяцев)' )
			Check Box: cb_T
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тело
				Window Location and Size
					Left:   8.883"
					Top:    4.155"
					Width:  0.8"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Red
				Background Color: Default
				Message Actions
					On SAM_SetFocus
						Set nTmpE = cb_T
					On SAM_Click
						Set cb_T = nTmpE 
			Check Box: cb_P
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: % и Kомис
				Window Location and Size
					Left:   9.883"
					Top:    4.155"
					Width:  1.5"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Red
				Background Color: Default
				Message Actions
					On SAM_SetFocus
						Set nTmpE = cb_P
					On SAM_Click
						Set cb_P = nTmpE 
			!
			Data Field: Basey_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.783"
						Top:    4.405"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '%-База' )
			Data Field: IR_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.583"
						Top:    4.405"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% ставка' )
			Data Field: IR_newG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.483"
						Top:    4.405"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% ставка на тело кредита в грейс-периоде' )
			Data Field: Metr96_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.783"
						Top:    4.655"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Метод ежемес.комиссии' )
			Data Field: KOM_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.583"
						Top:    4.655"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Ставка ежем.комиссии' )
			Data Field: KOM_newG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.483"
						Top:    4.655"
						Width:  0.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Ставка ежем.комиссии в грейс-периоде' )
			Data Field: GPK_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.783"
						Top:    4.905"
						Width:  3.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Способ построения ГПК' )
			Data Field: BR_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.783"
						Top:    5.155"
						Width:  3.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: BR_NAME_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.783"
						Top:    5.405"
						Width:  3.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: SN8
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.583"
						Top:    3.655"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? No
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Списано пени' )
			!
			!
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbOk
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.483"
					Top:    5.405"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = "Подтвердить реструктуризацию КД реф=" ||
								Str(ND_OLD) || "->" || Str(ND_NEW)
						If Mode != 1
							Call SalDisableWindow( pbOk )
							Call SalDisableWindow( pb_Not )
					On SAM_Click
						If SalMessageBox(
								"Вы действительно хотите " || strTip ||" ?",
								'В Н И М А Н И Е !', MB_IconQuestion | MB_YesNo) = IDYES
							If F_Save( 1, P_REF )
								Call SqlCommitEx(  hSqlAux2(), strTip )
								Call SalSendMsg( hWnd, SAM_Click, 0, 0 )
								Call SalWaitCursor(FALSE)
							Else
								Call SqlRollback(hSqlAux2() )
							Call SalDestroyWindow(hWndForm)
			Pushbutton: pb_Not
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbOk
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   5.983"
					Top:    5.405"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Orchid
				Message Actions
					On SAM_Create
						Set strTip = "О Т М Е Н И Т Ь реструктуризацию КД реф=" ||
								Str(ND_OLD) || "->" || Str(ND_NEW)
					On SAM_Click
						If SalMessageBox(
								"Вы действительно хотите " || strTip ||" ?",
								'В Н И М А Н И Е !', MB_IconQuestion | MB_YesNo) = IDYES
							If F_Save( 1, P_REF )
								Call SqlCommitEx(  hSqlAux2(), strTip )
								Call SalWaitCursor(FALSE)
							Else
								Call SqlRollback(hSqlAux2() )
							Call SalDestroyWindow(hWndForm)
						!
						If F_Save( 3, P_REF )
							! Закріть счета удалить из CP_REF
							Call SqlCommitEx(  hSqlAux2(), strTip  )
							Call SalSendMsg( hWnd, SAM_Click, 0, 0 )
							Call SalWaitCursor(FALSE)
						Else
							Call SqlRollback( hSqlAux2() )
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.483"
					Top:    5.405"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = " Выйти "
					On SAM_Click
						Call SalDestroyWindow(hWndForm)
			!
			! !!!!!!!!!!!!!!!!!!!!
			Data Field: P_REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   4.883"
						Top:    5.155"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф.МО по перезачислению ' )
					On SAM_SetFocus
						Set nTmpE = P_REF
					On SAM_KillFocus
						Set P_REF = nTmpE
			!
			Pushbutton: pb_Ref
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   4.983"
					Top:    5.405"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: C:\bars98\RESOURCE\BMP\OPEN.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Просмотреть док.по перезачислению '
					On SAM_Click
						If P_REF >0
							Call DocViewContentsEx(hWndForm, P_REF )
			! !!!!!!!!!!!!!!!!!
			Child Table: tbl_NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.55"
						Top:    -0.012"
						Width:  11.133"
						Width Editable? Yes
						Height: 2.833"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: NLSD
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дебет
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.683"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NLSK
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Кредит
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.683"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: TXT
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Подробно
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  5.033"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: S
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Cумма
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.9"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
					String: sSql1
				Message Actions
					On SAM_Create
						Call SalWaitCursor(TRUE)
						Set sSql1 =
								"SELECT ad.nls, ak.nls, o.txt, o.s/100 INTO :NLSD, :NLSK, :TXT, :S 
								 FROM accounts ad, accounts ak,
								  (SELECT stmt,s,txt,SUM (DECODE(dk,0,acc,0)) ad, SUM(DECODE(dk,1,acc,0)) ak 
								   FROM opldok WHERE ref=:REF GROUP BY stmt,s,txt) o
								 WHERE o.ad = ad.acc  AND o.ak = ak.acc 
								   and (ad.nls not like '8%' or o.TXT = 'Списання пенi старого кредиту' )
								 order by 1,2 "
						Call SalTblPopulate(tbl_NLS, hSql(), sSql1, TBL_FillAll )
						Call SalWaitCursor(FALSE)
					On SAM_FetchRowDone
						! - СЕРЫЙ
						If TXT = 'Списання пенi старого кредиту' 
							Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
						Else If TXT ='Перерахування заг.суми нового кредиту'
							Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGreen )
		Functions
			Function: F_OLD
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nIk
				Actions
					! Call Debug('q0')
					If SqlPrepareAndExecute( hSql(),
							  "SELECT d.SDATE, d.CC_ID, d.WDATE, d.SDOG,  -a.ostC/100,  d.prod,  
							          acrn.FPROCN(a.acc,0,:bDate), acrn.FPROCN(a.acc,2,:bDate), d.rnk,
							         d.branch, b.name, a.acc 
							   INTO :SDATE_old, :CC_ID_old, :WDATE_old, :SDOG_old, :LIMIT_old, :PROD_old, 
							        :IR_old, :nIk, :RNK, :BR_old, :BR_NAME_old, :acc8
							   FROM cc_deal d, nd_acc n, accounts a,  branch b
							   WHERE d.nd=:ND_OLD and d.nd=n.nd and n.acc=a.acc and a.tip='LIM' 
							     and d.branch=b.branch  " )
							and NOT SqlFetchNext( hSql(), nFetchRes )
					! Call Debug('q')
					If SqlPrepareAndExecute( hSql(),
							  "select min(fdat) into :FDAT_old from cc_lim where nd=:ND_OLD and fdat>=:bDate " )
							and NOT SqlFetchNext( hSql(), nFetchRes )
					! Call Debug('w')
					!
					If SqlPrepareAndExecute( hSql(),
							  "select b.name into :Basey_old  from int_accn i, basey b
							   where i.acc=:acc8 and id=0 and i.basey=b.basey " )
							and NOT SqlFetchNext( hSql(), nFetchRes )
						Call SalDestroyWindow(hWndForm)
					! Call Debug('e')
					!
					If SqlPrepareAndExecute( hSql(),
							  "Select b.name, i.metr into :Metr96_old, :nMetr96
							   from int_accn i, int_metr b
							   where i.acc=:acc8 and id=2 and i.metr= b.metr " )
							and NOT SqlFetchNext( hSql(), nFetchRes )
					! Call Debug('r')
					!
					If SqlPrepareAndExecute( hSql(),
							  "SELECT name INTO  :GPK_old  FROM CCK_GPK_TYPES
							   WHERE id = to_number(wcs_utl.get_mac( :ND_OLD, 'MODE_GPK' )) " )
							and NOT SqlFetchNext( hSql(), nFetchRes )
					If nMetr96 = 95
						Set KOM_old = SDOG_old * nIk/100
					Else
						Set KOM_old = nIk
					! Data Field: Metr96_old
						                                    Message Actions 
			Function: F_NEW
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nIk
					Number: nIkG
				Actions
					! Call Debug('u0')
					If SqlPrepareAndExecute( hSql(),
							  "SELECT d.SDATE, d.CC_ID, d.WDATE, d.SDOG,  -a.ostC/100,  d.prod,  
							          acrn.FPROCN(a.acc,0,d.WDATE),  acrn.FPROCN(a.acc,0,d.SDATE), 
							          acrn.FPROCN(a.acc,2,d.WDATE),  acrn.FPROCN(a.acc,2,d.SDATE), 
							         d.branch, b.name
							   INTO :SDATE_new, :CC_ID_new, :WDATE_new, :SDOG_new, :LIMIT_new,:PROD_new,
							        :IR_new, :IR_newG, :nIk, :nIkG, :BR_new, :BR_NAME_new
							   FROM cc_deal d, nd_acc n, accounts a,  branch b
							   WHERE d.nd=:ND_NEW and d.nd=n.nd and n.acc=a.acc and a.tip='LIM' 
							     and d.branch=b.branch  " )
							and NOT SqlFetchNext( hSql(), nFetchRes )
					! Call Debug('u1')
					If SqlPrepareAndExecute( hSql(),
							  "select min(fdat) into :FDAT_new from cc_lim where nd=:ND_NEW and fdat > :SDATE_new " )
							and NOT SqlFetchNext( hSql(), nFetchRes )
					! Call Debug('uu')
					!
					Set Basey_new = Basey_old
					Set Metr96_new = Metr96_old
					Set GPK_new = GPK_old
					! Call SalDisableWindow( cb_T )
					! Call SalDisableWindow( cb_P )
					! Call Debug('ND_NEW='||Str(ND_NEW) )
					If SqlPrepareAndExecute( hSql(),
							  "SELECT trim(substr(txt,1,3)) INTO :sTmp FROM nd_txt where nd=:ND_NEW and tag='GRACE' " )
							and SqlFetchNext( hSql(), nFetchRes )
						! Call Debug('P_GRACE='||sTmp)
						Set P_GRACE = Val(sTmp)
						If SqlPrepareAndExecute( hSql(),
								  "select 1 from cc_lim where nd=:ND_NEW and fdat=:FDAT_new and sumg=0" )
								and SqlFetchNext( hSql(), nFetchRes )
							Set cb_T = 1
						If IR_newG != IR_new or nIkG != nIk 
							Set cb_P = 1
					If nMetr96 = 95
						Set KOM_new = SDOG_new * nIk /100
						Set KOM_newG = SDOG_new * nIkG /100
					!
					! Call Debug('i')
					!
			Function: F_Save
				Description:
				Returns
					Boolean:
				Parameters
					Number: nStatus
					Number: nRef
				Static Variables
				Local variables
					String: CHK_
					Number: nUserId
					String: strKeyId
				Actions
					Call SalWaitCursor(TRUE)
					Set nUserId =GetUserId()
					Set strKeyId = GetIdOper( )
					! прочитать  РЕФ  и залочить 
					If SqlPrepareAndExecute(hSqlAux2(),
							   "SELECT chk INTO :CHK_ FROM oper WHERE ref=:nRef FOR UPDATE OF chk NOWAIT ")
							and SqlFetchNext(hSqlAux2(),  nFetchRes)
						Return f_VISA_REF(nCheckId, nUserId, strKeyId, nRef, nStatus, CHK_)
			Function: f_VISA_REF
				Description:
				Returns
					Boolean:
				Parameters
					Number: nCheckId
					Number: nUserId
					String: strKeyId
					Number: nRef
					Number: nStatus
					String: CHK_
				Static Variables
				Local variables
					String: strHexMark2Ret
					String: sPrich
					Number: n2Pay
					Number: n2Sig
				Actions
					Call SalWaitCursor(TRUE)
					Set strHexMark2Ret = SalStrTrimX(CHK_) ||
							    SalStrRightX('00'   ||  NumberToHexSX(nCheckId), 2) ||
							    SalStrRightX('0000' ||  NumberToHexSX(nUserId), 4)
					! без подписи
					If not SqlPrepareAndExecute(hSqlAux2(),
							"INSERT INTO oper_visa (ref,dat,userid,groupid,status) VALUES 
							(:nRef,sysdate,:nUserId,:nCheckId,:nStatus)")
						Return FALSE
					If not SqlPrepareAndExecute(hSqlAux2(),
							 "UPDATE oper SET chk=:strHexMark2Ret WHERE ref=:nRef ")
						Return FALSE
					!
					! Хорошая виза  (НЕ ПОСЛЕДНЯЯ ! - без факт оплаты) = уже ВСЕ
					! Плахая виза надо  бекнуть
					If nStatus = 3
						If not Pay_Bck( nRef, 5, '')
								or not SqlPrepareAndExecute( hSqlAux2(),
								 "INSERT INTO operw(ref,tag,value) VALUES 
								(:nRef, 'BACKR', 'Отказ в рестректуризации' ) " ) 
								or not SqlPrepareAndExecute( hSqlAux2(), 
								  "update cc_deal set sos=15 where nd=:ND_NEW " )
							Return FALSE
					If nStatus = 1
						If NOT SqlPLSQLCommand(hSql(),
								 "cck.cc_autor(ND_NEW, 'Реструктуризация', sUserName)" ) 
							Return FALSE
						! --    cck.cc_autor(p_NEW_ND,  'Авто-Реструктуризация', 'Автоматично');
					Return TRUE
		Window Parameters
			Number: Mode
			Number: ND_OLD
			Number: ND_NEW  
			Number: REF 
			String: pNMK
			Number: nCheckId  
			Window Handle: hWnd
		Window Variables
			Number: acc8
			Number: RNK
			Date/Time: bDate
			! Number: nSN8
			! Number: nRef
			!
			Number: nGpk
			Number: nGpk_A
			Number: nBasey
			Number: nFreq
			Number: nMetr96
			Date/Time: dTmpE
			Number: nTmpE 
			String: sUserName
			String: sTmp
		Message Actions
			On SAM_Create
				Call SalCenterWindow(hWndForm)
				Set p_OLD_ND = ND_OLD
				Set sUserName = 'Визуально,' || GetUserRealName()
				Set p_NEW_ND = ND_NEW
				Set bDate = GetBankDate()
				Set P_REF = REF
				! Set n980 = GetBaseVal()
				Set NMK= pNMK
				Call F_OLD()
				Call F_NEW()
				If Mode != 1
					Call SalSetWindowText( hWndForm, 'Просмотр Изменений условий КД' )
					If SqlPrepareAndExecute( hSql(),
							  "SELECT trim(substr(txt,1,3)) INTO :sTmp FROM nd_txt where nd=:ND_NEW and tag='GRC_N' " )
							and SqlFetchNext( hSql(), nFetchRes )
						Set GRC_N = Val(sTmp)
				Else
					Call SalHideWindow( GRC_N )
	Form Window: MODN
		Class:
		Property Template:
		Class DLL Name:
		Title: Изменение условий КД реф.=
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   1.15"
				Top:    -0.021"
				Width:  13.017"
				Width Editable? Yes
				Height: 7.298"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.845"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Background Text: Продукт
					Resource Id: 51821
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.283"
						Top:    0.095"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: PROD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.283"
							Top:    0.321"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Продукт' )
				Background Text: Дата КД
					Resource Id: 51822
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   2.183"
						Top:    0.095"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Center
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: SDATE
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.183"
							Top:    0.321"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата договора' )
				Background Text: Заемщик
					Resource Id: 51823
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   7.283"
						Top:    0.095"
						Width:  2.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: NMK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.283"
							Top:    0.321"
							Width:  4.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Заемщик' )
				Data Field: NLS_SG
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.483"
							Top:    0.321"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, '№ договора' )
				Background Text: Бранч
					Resource Id: 51824
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   4.183"
						Top:    0.095"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: BRANCH
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.083"
							Top:    0.321"
							Width:  3.2"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код Бранча' )
				Data Field: BRANCH_NAME
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.083"
							Top:    0.571"
							Width:  7.633"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Бранч' )
				Background Text: № пп
					Resource Id: 51825
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   11.383"
						Top:    0.095"
						Width:  1.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: KPROLOG
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   11.683"
							Top:    0.321"
							Width:  0.8"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, '№ пп доп.соглашения' )
				!
				Data Field: SK_
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.283"
							Top:    0.571"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 
									'Базовая сумма комиссии 
									за реструктуризацию' )
				Data Field: PK_
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.183"
							Top:    0.571"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam,
									 '+ % комиссии (от суммы нового КД) 
									за реструктуризацию' )
		Contents
			Group Box: Действующие условия
				Resource Id: 51810
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    2.821"
					Width:  3.9"
					Width Editable? Yes
					Height: 2.417"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Blue
				Background Color: Default
			Data Field: SDOG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    3.405"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Начальная Сумма по КД' )
			Data Field: LIMIT_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.983"
						Top:    3.405"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: FDAT_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    3.655"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: WDATE_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.983"
						Top:    3.655"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: Basey_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    4.405"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: IR_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.983"
						Top:    4.405"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: Metr96_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    4.655"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: KOM_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.983"
						Top:    4.655"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: GPK_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.183"
						Top:    4.905"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: FREQ_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.983"
						Top:    4.905"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Group Box: Новые условия
				Resource Id: 51811
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   7.783"
					Top:    2.821"
					Width:  4.7"
					Width Editable? Yes
					Height: 2.417"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
			Data Field: LIMIT_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.883"
						Top:    3.405"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Новая сумма тела кредита (с Комиссией) ' )
			Data Field: LIMIT_n
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.883"
						Top:    3.155"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Новая сумма тела кредита (без Комиссии) ' )
			Data Field: nKom
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.583"
						Top:    3.405"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Новая сумма тела кредита' )
			Pushbutton: pb_Sum
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   10.083"
					Top:    3.321"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: C:\bars98\RESOURCE\BMP\SUMM.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = " Новая Сумма нормального долга по телу кредита "
					On SAM_Click
						Call tbl_NLS.F_Sum() 
			Data Field: FDAT_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.883"
						Top:    3.655"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					! On SAM_KillFocus
						                                      If FDAT_new < GetBankDate()
							                                      Call SalMessageBox('Ошибка !',
									'Дата первого погашения д.б. >= Текущей !', MB_IconStop)
							                                      Set FDAT_new = dTmpE
					! On SAM_SetFocus
						                                      Set dTmpE = FDAT_new
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Первая платежная дата' )
			Data Field: WDATE_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   10.083"
						Top:    3.655"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_KillFocus
						If WDATE_new <= bDate
							Return VALIDATE_Cancel
						Set WDATE_new = CorrectDate(n980, WDATE_new, WDATE_new -1 )
						If WDATE_new <= FDAT_new
							Call SalMessageBox('Ошибка !',
									'Дата завершения д.б. > Даты начала !', MB_IconStop)
							Set WDATE_new  = WDATE_old
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Последняя платежная дата' )
			Data Field: Basey_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.883"
						Top:    4.405"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: IR_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.083"
						Top:    4.405"
						Width:  1.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: IR_newG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   11.183"
						Top:    4.405"
						Width:  1.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% ставка на тело кредита в грейс-периоде' )
			Data Field: Metr96_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.883"
						Top:    4.655"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: KOM_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.083"
						Top:    4.655"
						Width:  1.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: KOM_newG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   11.183"
						Top:    4.655"
						Width:  1.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Ставка ежем.комиссии в грейс-периоде' )
			Data Field: GPK_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.883"
						Top:    4.905"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: FREQ_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.083"
						Top:    4.905"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Background Text: ___Сумма Норм.долга___
				Resource Id: 51812
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.983"
					Top:    3.345"
					Width:  3.7"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: в тч Комиссия  
				Resource Id: 59673
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   10.183"
					Top:    3.202"
					Width:  2.1"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Даты Первого-Последнего пог.
				Resource Id: 51813
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.983"
					Top:    3.595"
					Width:  3.7"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Грейс по Телу или по  Проц+Ком
				Resource Id: 51814
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.983"
					Top:    4.012"
					Width:  3.7"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Red
				Background Color: Default
			Background Text: Базовый год и % ставка
				Resource Id: 51815
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.983"
					Top:    4.429"
					Width:  3.7"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: Метод и % ставка (Сумма)комисси
				Resource Id: 51816
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.983"
					Top:    4.679"
					Width:  3.7"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Background Text: ГПК и Период погашения
				Resource Id: 51817
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.983"
					Top:    4.929"
					Width:  3.7"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			!
			Frame
				Resource Id: 51818
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   7.883"
					Top:    3.905"
					Width:  4.4"
					Width Editable? Yes
					Height: 0.417"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Raised-Shadow
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Data Field: P_GRACE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.883"
						Top:    3.988"
						Width:  0.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Количество грейс-периодов (месяцев)' )
					! On SAM_Validate
						                             Call F_PGRACE ()
			Check Box: cb_T
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тело
				Window Location and Size
					Left:   8.783"
					Top:    3.988"
					Width:  0.8"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Red
				Background Color: Default
				Message Actions
					On SAM_Create
						Set cb_T =0 
						Call F_GRACE()
					On SAM_Click
						Call F_GRACE()
			Check Box: cb_P
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: %ст + сумма Kоммис
				Window Location and Size
					Left:   9.883"
					Top:    3.988"
					Width:  2.3"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Red
				Background Color: Default
				Message Actions
					On SAM_Create
						Set cb_P =0 
					On SAM_Click
						Call F_GRACE()
			!
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbOk
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   11.383"
					Top:    2.488"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = " Сформировать новый КД "
					On SAM_Click
						Call tbl_NLS.F_Sum() 
						If F_PGRACE()
							If SalMessageBox(
									'Вы действительно хотите Изменить КД по новым условиям ?',
									'В Н И М А Н И Е !', MB_IconQuestion | MB_YesNo) = IDYES
								Call F_SAVE()
								Call SalDestroyWindow(MODN)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   11.883"
					Top:    2.488"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = " Выйти "
					On SAM_Click
						Call SalDestroyWindow(MODN)
			!
			! !============================
			Child Table: tbl_NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    -0.012"
						Width:  12.2"
						Width Editable? Yes
						Height: 2.417"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: TIP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Тип
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.833"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NLS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: № сч
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.683"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NMS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование сч
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.617"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTB
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Пл.остаток
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.833"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Списать сумму
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.617"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								If TIP != 'SN8'
									Set OSTP= NUMBER_Null
							On SAM_KillFocus
								Call F_OSTP()
							On SAM_Validate
								Call F_OSTP()
					Column: OSTN
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Включить сумму
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.817"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: F_Sum
						Description:
						Returns
							Number:
						Parameters
						Static Variables
						Local variables
							Number: nRow
							Number: nS
							Number: nP
							! Number: SK_
							! Number: PK_
							! Number: nKom
						Actions
							If SqlPrepareAndExecute( hSql(),
									  "select Nvl(sm.VAL_DECIMAL,0) into :SK_ 
									   from wcs_subproduct_macs sm              
									   where sm.SUBPRODUCT_ID = :PROD and sm.MAC_ID = 'KRK_S'")
									and NOT SqlFetchNext( hSql(), nFetchRes )
								Set SK_ = 0
							If SqlPrepareAndExecute( hSql(),
									"select Nvl(sm.VAL_DECIMAL,0) into :PK_ 
									 from wcs_subproduct_macs sm              
									 where sm.SUBPRODUCT_ID = :PROD and sm.MAC_ID = 'KRK_P'")
									and NOT SqlFetchNext( hSql(), nFetchRes )  
								Set PK_ = 0
							!
							Set nRow = TBL_MinRow
							Set nS = 0
							Set nP = 0
							Set nKom = 0 
							While SalTblFindNextRow( tbl_NLS, nRow, 0, 0)
								Call SalTblSetContext(tbl_NLS, nRow)
								Set nS = nS + OSTN
								If TIP='SN8' 
									Set nP = nP + OSTP
							!
							Set LIMIT_n = SalNumberMax( nS, 0 )
							Set nKom = SK_ + LIMIT_n *PK_ /100
							Set LIMIT_new = LIMIT_n + nKom
							!
							Return nP
					Function: F_OSTP
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							If TIP = 'SN8' 
								If OSTP > OSTB
									Set OSTP= 0
									Call SalMessageBox('Сумма списания пени > Всей пени !','Ошибка !', MB_IconStop)
								Else
									Set OSTN = OSTB - OSTP
				Window Variables
					String: sSql1
					Number: flag_ost
					Number: nOstC
				Message Actions
					On SAM_Create
						Call SalWaitCursor(TRUE)
						Set nSN8 =0
						Set flag_ost = 0
						Set sSql1 =
								"SELECT a.tip, a.nls,a.nms, -a.ostb/100, -ostc/100 
								 INTO :tbl_NLS.TIP, :tbl_NLS.NLS, :tbl_NLS.NMS, :tbl_NLS.OSTB,
								      :nOstC 
								 from accounts a, nd_acc n 
								 where n.nd=:p_ND and n.acc=a.acc 
								  and a.rnk=:RNK and a.dazs is null and (a.ostb<>0 OR a.tip='SG ')
								  and a.tip not in ('LIM','SDI','SPI') "
						Call SalTblPopulate(tbl_NLS, hSql(), sSql1, TBL_FillAll )
						If flag_ost = 1
							Call SalWaitCursor(FALSE)
							Call SalMessageBox('Пл. и факт. остатки НЕ совпадают !',
									'Реструктуризация невозможна !', 
									MB_IconStop)
							Call SalDestroyWindow(MODN)
						!
						Call F_Sum()
						!
						Call SalWaitCursor(FALSE)
						If LIMIT_new = 0
							Call SalMessageBox('Общ.сумма задолженностей = 0 !',
									'Реструктуризация невозможна !', 
									MB_IconStop)
							Call SalDestroyWindow(MODN)
					On SAM_FetchRowDone
						! - СЕРЫЙ
						If nOstC != OSTB
							Set flag_ost = 1
						Set OSTN = OSTB
						If TIP = 'SG ' 
							Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGreen  )
							Set NLS_SG = NLS
							Set NMS_SG = NMS
							! Set tbl_NLS.OTM=1
						Else If TIP = 'SN8'  
							Call XSalTblSetCellBackColor( OSTN, SalColorFromRGB( 255,210,250 ) )
							Call XSalTblSetCellBackColor( OSTP, COLOR_LightGreen )
							Set OSTP = 0
						Else
							Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
			! !============================
			Data Field: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.883"
						Top:    2.488"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '№ предыдущего КД' )
			Data Field: p_OLD_ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.583"
						Top:    2.488"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф.предыдущего КД' )
					On SAM_SetFocus
						Set nTmpE = p_OLD_ND
					On SAM_KillFocus
						Set p_OLD_ND = nTmpE
			Background Text: >
				Resource Id: 51819
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.283"
					Top:    2.512"
					Width:  0.3"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: 12
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: P_REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.683"
						Top:    2.488"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф.МО по перезачислению ' )
					On SAM_SetFocus
						Set nTmpE = P_REF
					On SAM_KillFocus
						Set P_REF = nTmpE
			Data Field: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.683"
						Top:    2.738"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Рег.№ клиента' )
					On SAM_SetFocus
						Set nTmpE = RNK
					On SAM_KillFocus
						Set RNK = nTmpE
			Background Text: >
				Resource Id: 51820
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   7.083"
					Top:    2.512"
					Width:  0.3"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: 12
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: p_NEW_ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   7.383"
						Top:    2.488"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: #0
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Реф.нового КД' )
					On SAM_SetFocus
						Set nTmpE = p_NEW_ND
					On SAM_KillFocus
						Set p_NEW_ND = nTmpE
			Data Field: P_CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.083"
						Top:    2.488"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '№ нового КД' )
			!
			Pushbutton: pb_Info_Old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.383"
					Top:    2.488"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: C:\bars98\RESOURCE\BMP\HELP.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Sky
				Message Actions
					On SAM_Create
						Set strTip = 'Инфо-выписка предыдущего КД' 
					On SAM_Click
						! Call Sel017f(hWndMDI, nTip_Fun, 114, p_OLD_ND,
								CC_ID || ' від '||
								SalFmtFormatDateTime( SDATE, 'dd/MM/yyyy' ),
								NMK ,'','','' )
			Pushbutton: pb_Ref
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.383"
					Top:    2.488"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: C:\bars98\RESOURCE\BMP\OPEN.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Orchid
				Message Actions
					On SAM_Create
						Set strTip = 'Просмотреть док.по перезачислению '
					On SAM_Click
						If P_REF >0
							Call DocViewContentsEx(hWndForm, P_REF )
			Pushbutton: pb_Info_New 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   10.883"
					Top:    2.488"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: C:\bars98\RESOURCE\BMP\HELP.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Orchid
				Message Actions
					On SAM_Create
						Set strTip = 'Инфо-выписка нового КД'
					On SAM_Click
						! Call Sel017f(hWndMDI, nTip_Fun, 114, p_NEW_ND,
								P_CC_ID || ' від '||
								SalFmtFormatDateTime( bDate, 'dd/MM/yyyy' ),
								NMK ,'','','' )
		Functions
			Function: F_SAVE
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sErr
					Number: nP
					String: sMess
					Number: T_GRACE
				Actions
					If p_NEW_ND = NUMBER_Null
						Set sErr = ''
						If FDAT_new < GetBankDate()
							Set sErr = sErr || '
									Дата начала погашения д.б. >= Текущей !'
						If WDATE_new <= FDAT_new
							Set sErr = sErr || '
									Дата завершения д.б. > Даты начала погашения !'
						If sErr != ''
							Call SalMessageBox('Ошибка !', sErr, MB_IconStop)
							Return FALSE
						Call SalWaitCursor(TRUE)
						Set nP = tbl_NLS.F_Sum() * 100
						Set T_GRACE = 0
						If cb_T=1 and cb_P=0 
							Set T_GRACE = 1
						Else If cb_T=0 and cb_P=1 
							Set T_GRACE = 2
						Else If cb_T=1 and cb_P=1 
							Set T_GRACE = 3
						If SqlPLSQLCommand(hSql(), "wcs_register.re_credit
								( nNd,     LIMIT_new, 
								  bDate,   WDATE_new, FDAT_new, 
								  T_GRACE, P_GRACE,
								  nBasey,  IR_new,    IR_newG,   nMetr96,KOM_new,KOM_newG, 
								  nP,  
								  p_NEW_ND,  P_REF,  P_CC_ID ) " ) 
							Set sMess = 'Создан новый КД реф='|| Str(p_NEW_ND)
							Call SqlCommitEx(hSql(),sMess)
							Call SalDisableWindow( pbOk )
							Call SalWaitCursor(FALSE)
							Call MessageNoWait(sMess,'Сообщение',3,0)
			Function: F_GRACE
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If cb_P = 1
						Set IR_newG = IR_new
						Set KOM_newG= KOM_new
						Call SalEnableWindow( IR_newG )
						Call SalEnableWindow( KOM_newG )
					Else
						Set IR_newG = IR_new
						Set KOM_newG= KOM_new
						Call SalDisableWindow( IR_newG )
						Call SalDisableWindow( KOM_newG )
			Function: F_PGRACE
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: sErr
					Number: nKolD
					Date/Time: dDatW
					Date/Time: dDatG
				Actions
					Set sErr = ''
					If P_GRACE = 0 
					Else If P_GRACE < 0 
						Set sErr = 'Кол-во Грейс-периодов меньше 0 !'
					! Else If P_GRACE > 12 
						               Set sErr = 'Грейс-период не м.б.более 12 месяцев !'
					Else
						Set dDatW = CorrectDate(n980, WDATE_new, WDATE_new -1)
						If SqlPrepareAndExecute( hSql(),
								  "select add_months(:bDate,:P_GRACE) into :dDatG from dual " )
								and  SqlFetchNext( hSql(), nFetchRes )
						Set dDatG = CorrectDate(n980, dDatG, dDatG -1 )
						If dDatG >= dDatW
							Set sErr = 'Грейс-период больше общего периода !'
					!
					If sErr != ''
						Call SalMessageBox( sErr,'О ш и б к а !', MB_IconStop)
						Set P_GRACE = 0
						Return FALSE
					Return TRUE
		Window Parameters
			Number: nMode
			Number: p_ND  ! nPar
			String: P_Title ! strPar01
			String: strPar02
		Window Variables
			! Number: p_NEW_ND
			! Number: P_REF
			Number: nSN8
			Number: acc8
			Number: nGpk
			Number: nGpk_A
			Number: nBasey
			Number: nFreq
			Number: nMetr96
			Number: nNd
			Date/Time: bDate
			Date/Time: dTmpE
			Number: nTmpE 
			String: NMS_SG
			Number: n980
			: cDoc
				Class: cDoc
		Message Actions
			On SAM_Create
				Call SalSetWindowText( hWndForm, P_Title || ' реф='|| Str(p_ND) )
				Call SalCenterWindow(hWndForm)
				Set nNd = p_ND
				Set p_OLD_ND = p_ND
				Set bDate = GetBankDate()
				Set n980 = GetBaseVal()
				If SqlPrepareAndExecute( hSql(),
						  "SELECT d.CC_ID, d.SDATE, c.NMK, d.WDATE, -ss.ostB/100,
						          acrn.FPROCN(a.acc,0,:bDate),  acrn.FPROCN(a.acc,2,:bDate),
						          a.acc, decode(a.vid,4,3,1),  c.rnk, d.SDOG, 
						          d.prod, d.branch, b.name,  nvl(d.KPROLOG,0),
						    (select min(fdat) from cc_lim where nd=d.nd and fdat>=:bDate)
						   INTO :CC_ID , :SDATE, :NMK, :WDATE_old, :LIMIT_old, :IR_old,
						        :KOM_old, :acc8, :nGpk_A, :RNK, :SDOG,
						        :PROD, :BRANCH, :BRANCH_NAME, :KPROLOG, :FDAT_old
						   FROM cc_deal d, customer c, nd_acc n, accounts a, accounts SS, branch b
						   WHERE d.nd=:p_ND and d.rnk=c.rnk and d.sos<15
						     and d.nd=n.nd and n.acc=a.acc and a.tip='LIM' and d.branch=b.branch 
						     and ss.tip='SS ' and ss.accc=a.acc " )
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Call SalDestroyWindow(MODN)
				!
				If SqlPrepareAndExecute( hSql(),
						  "select b.name, i.basey, i.freq,  q.name
						   into :Basey_old, :nBasey, :nFreq, :FREQ_old
						   from int_accn i, basey b, freq q
						   where i.acc=:acc8 and id=0 and i.basey=b.basey and i.freq=q.freq" )
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Call SalDestroyWindow(MODN)
				!
				If SqlPrepareAndExecute( hSql(),
						  "Select b.name, i.metr into :Metr96_old, :nMetr96
						   from int_accn i, int_metr b
						   where i.acc=:acc8 and id=2 and i.metr= b.metr " )
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Call SalDestroyWindow(MODN)
				If nMetr96 = 95
					Set KOM_old = SDOG * KOM_old/100
				! CCK_GPK_TYPES
				If SqlPrepareAndExecute( hSql(),
						  "SELECT name, id, add_months(gl.BD,1)
						   INTO  :GPK_old, :nGpk , :FDAT_new 
						   FROM CCK_GPK_TYPES
						   WHERE id = to_number(wcs_utl.get_mac( :nNd, 'MODE_GPK' )) " )
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Call SalDestroyWindow(MODN)
				!
				Set LIMIT_new = LIMIT_old
				! Set FDAT_new  = FDAT_old
				Set WDATE_new = WDATE_old
				!
				Set Basey_new = Basey_old
				Set IR_new    = IR_old
				!
				Set Metr96_new= Metr96_old
				Set KOM_new   = KOM_old
				!
				Set GPK_new   = GPK_old
				Set FREQ_new  = FREQ_old
				!
				! !
				Set P_GRACE = 0
				Set IR_newG = IR_new
				Set KOM_newG= KOM_new
	Form Window: MODI
		Class:
		Property Template:
		Class DLL Name:
		Title: Изменение условий КД реф.=
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   1.15"
				Top:    -0.021"
				Width:  13.2"
				Width Editable? Yes
				Height: 6.833"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: 0.786"
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Background Text: Продукт
					Resource Id: 34219
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.283"
						Top:    0.095"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: PROD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.283"
							Top:    0.321"
							Width:  1.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Продукт' )
				Background Text: № КД
					Resource Id: 34220
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   1.983"
						Top:    0.095"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: CC_ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.983"
							Top:    0.321"
							Width:  1.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, '№ договора' )
				Background Text: Дата КД
					Resource Id: 34221
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   3.583"
						Top:    0.095"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Center
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Background Text: Бранч
					Resource Id: 34222
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.783"
						Top:    0.095"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: SDATE
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   3.583"
							Top:    0.321"
							Width:  1.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата договора' )
				Background Text: Заемщик
					Resource Id: 34223
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   8.383"
						Top:    0.095"
						Width:  2.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Left
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Background Text: № пп
					Resource Id: 34224
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   11.383"
						Top:    0.095"
						Width:  1.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: NMK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.183"
							Top:    0.321"
							Width:  3.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Заемщик' )
				Data Field: KPROLOG
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   12.083"
							Top:    0.321"
							Width:  0.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, '№ пп доп.соглашения' )
				Data Field: NLS_SS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.483"
							Top:    0.321"
							Width:  2.1"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, '№ договора' )
				Data Field: BRANCH
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.483"
							Top:    0.321"
							Width:  2.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код Бранча' )
		Contents
			Group Box: Действующие условия
				Resource Id: 34212
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    3.571"
					Width:  3.9"
					Width Editable? Yes
					Height: 1.583"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Blue
				Background Color: Default
			Group Box: Новые условия
				Resource Id: 34213
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   8.083"
					Top:    3.571"
					Width:  3.9"
					Width Editable? Yes
					Height: 1.583"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
			!
			Data Field: LIMIT_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    3.821"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: ___Сумма Норм.долга___
				Resource Id: 34214
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.983"
					Top:    3.845"
					Width:  2.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: LIMIT_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.283"
						Top:    3.821"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Data Field: FDAT_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    4.071"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: FDAT_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   8.283"
						Top:    4.071"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_KillFocus
						If FDAT_new < GetBankDate()
							Call SalMessageBox('Ошибка !',
									'Дата первого погашения д.б. >= Текущей !', MB_IconStop)
							Set FDAT_new = dTmpE
					On SAM_SetFocus
						Set dTmpE = FDAT_new
			Background Text: Даты Первого  и Последнего погашения
				Resource Id: 34215
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.083"
					Top:    4.095"
					Width:  3.9"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: WDATE_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.083"
						Top:    4.071"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: WDATE_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   10.083"
						Top:    4.071"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_KillFocus
						If WDATE_new <= FDAT_new
							Call SalMessageBox('Ошибка !',
									'Дата завершения д.б. > Даты начала !', MB_IconStop)
							Set WDATE_new  = WDATE_old
			!
			Data Field: Basey_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    4.321"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: Basey_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.283"
						Top:    4.321"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Базовый год и % ставка
				Resource Id: 34216
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.083"
					Top:    4.345"
					Width:  3.9"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: IR_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.083"
						Top:    4.321"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: IR_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   10.083"
						Top:    4.321"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Data Field: Metr96_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    4.571"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: Metr96_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.283"
						Top:    4.571"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Метод и % ставка комисси
				Resource Id: 34217
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.083"
					Top:    4.595"
					Width:  3.9"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: KOM_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.083"
						Top:    4.571"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: KOM_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.083"
						Top:    4.571"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Data Field: GPK_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    4.821"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: GPK_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.283"
						Top:    4.821"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: Построения ГПК и Период погашения
				Resource Id: 34218
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   4.083"
					Top:    4.845"
					Width:  3.9"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Justify: Center
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: FREQ_old
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   2.083"
						Top:    4.821"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: FREQ_new
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   10.083"
						Top:    4.821"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Принять
				Window Location and Size
					Left:   6.083"
					Top:    3.238"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.5"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Enter
				Font Name: Arial Cyr
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call tbl_NLS.F_Sum() 
						! If WDATE_new = WDATE_old AND
								   LIMIT_new = LIMIT_old AND
								   IR_new    = IR_old    AND
								   KOM_new   = KOM_old   AND
								   FDAT_new =  FDAT_old
							                                           Call SalMessageBox('Нет изменений условий !',
									'Внимание !', MB_IconStop)
						! Else
						If SalMessageBox(
								'Вы действительно хотите Изменить КД по новым условиям ?',
								'В Н И М А Н И Е !', MB_IconQuestion | MB_YesNo) = IDYES
							Call tbl_NLS.F_SAVE()
							Call SalEndDialog(hWndForm, 1)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сброс
				Window Location and Size
					Left:   4.783"
					Top:    3.238"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.5"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Esc
				Font Name: Arial Cyr
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, 0)
			!
			Pushbutton: pb_Sum
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbGetValue
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   10.183"
					Top:    3.738"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: C:\bars98\RESOURCE\BMP\SUMM.BMP
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Light Green
				Message Actions
					On SAM_Create
						Set strTip = " Новая Сумма нормального долга по телу кредита "
					On SAM_Click
						Call tbl_NLS.F_Sum() 
			Data Field: BRANCH_NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.383"
						Top:    3.238"
						Width:  5.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Бранч' )
			!
			Child Table: tbl_NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    -0.012"
						Width:  12.3"
						Width Editable? Yes
						Height: 3.167"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: TIP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Тип
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.633"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NLS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: № сч
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.467"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NMS
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование сч
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.617"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTB
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Пл.остаток
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.283"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OSTP
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Списать сумму
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.45"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								If TIP != 'SN8'
									Set OSTP= NUMBER_Null
							! On SAM_SetFocus
								                                           Set nTmpE = OSTP
							! On SAM_KillFocus
								                                           Set OSTN = OSTB - OSTP
					Column: OSTN
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Включить сумму
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.65"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								If TIP != 'SN8'
									Set OSTN= nTmpE
							On SAM_SetFocus
								Set nTmpE = OSTN
							On SAM_KillFocus
								Set OSTP = OSTB - OSTN
					Column: OTM
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Вкл.осн.долг
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.517"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_AnyEdit
								If TIP = 'SS ' 
									Set OTM = 1
				Functions
					Function: F_Sum
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nRow
							Number: nS
						Actions
							Set nRow = TBL_MinRow
							Set nS = 0
							While SalTblFindNextRow( tbl_NLS, nRow, 0, 0)
								Call SalTblSetContext(tbl_NLS, nRow)
								If tbl_NLS.OTM = 1 
									Set nS = nS + tbl_NLS.OSTN
							Set LIMIT_new = nS
							Return TRUE
					Function: F_SAVE
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Number: nDig
							Number: nAcc
							String: sTag
							String: sTxt
							String: FLAGS2
							String: sTip
							String: sErr
							String: sMess
							!
							Number: nRow
							String: sNazn
							Number: nRef
							Number: n980
							Number: nS
							Number: nDk
							Number: nFlag
							Date/Time: dDat
							String: aOkpo
							String: aMfo
							! String: sNlsK
							! String: sNmsK
							String: sNls_8006
							String: sNms_8006
							String: sNls_6397
							String: sNms_6397
							!
						Actions
							Set sErr = ''
							If FDAT_new < GetBankDate()
								Set sErr = sErr || '
										Дата начала погашения д.б. >= Текущей !'
							If WDATE_new <= FDAT_new
								Set sErr = sErr || '
										Дата завершения д.б. > Даты начала погашения !'
							!
							If sErr != ''
								Call SalMessageBox('Ошибка !', sErr, MB_IconStop)
								Return FALSE
							Set nFlag = 1
							Call SalWaitCursor(TRUE)
							! Проводки
							Set nRef = NUMBER_Null
							! Set nId  = GetUserId()
							Set dDat = GetBankDate()
							Set n980 = GetBaseVal()
							Set aMfo = GetBankMfo()
							Set aOkpo= GetBankOkpoS()
							Set nRow = TBL_MinRow
							While SalTblFindNextRow( tbl_NLS, nRow, 0, 0)
								Call SalTblSetContext(tbl_NLS, nRow)
								If TIP != 'SS ' 
									If OTM = 1  and OSTN != 0 OR TIP = 'SN8' and OSTP != 0
										If nRef = NUMBER_Null
											Set sNazn =  'Реструктуризація КД № ' || CC_ID || ' Від ' || SalFmtFormatDateTime( SDATE, 'dd/MM/yyyy' )
											Set nS = LIMIT_new * 100
											! Call Debug('0 = ' ||Str(nRef))
											Call cDoc.SetDoc( nRef, 'REK', 1, 6, Subs(CC_ID,1,10),
													     dDat, dDat, dDat, dDat,
													     NLS_SS, NMS_SS, aMfo,'', n980, nS, aOkpo,
													     NLS_SS, NMS_SS, aMfo,'', n980, nS, aOkpo,
													     sNazn, '', GetIdOper(), '', NUMBER_Null, 0 )
											Call Ref(cDoc.m_nRef)
											Set nRef = cDoc.m_nRef
											If NOT cDoc.iDoc()
												Set nFlag =0 
												Break
										! Пеня
										If TIP = 'SN8'
											If SqlPrepareAndExecute( hSql(),
													  "SELECT nls INTO :sNls_8006 FROM accounts WHERE kv=:n980 and dazs is null and nls = 
													    substr(NLS_PROD_BRANCH('NLS1_8006', :PROD,:BRANCH),1,14) " )
													and NOT SqlFetchNext( hSql(), nFetchRes )
												Set nFlag =0 
												Break
											! Простить пеню
											If OSTP > 0
												! Call Debug('2=' ||Str(nRef))
												If NOT cDoc.PayV (0,nRef,dDat,'REK',1,n980,sNls_8006,OSTP*100,n980,NLS,OSTP*100)
													Set nFlag =0 
													Break
											! Включить пеню
											If OSTN > 0 and OTM = 1 
												If NOT cDoc.PayV (0,nRef,dDat,'REK',1,n980,sNls_8006,OSTN*100,n980,NLS,OSTN*100)
													Set nFlag =0 
													Break
												If SqlPrepareAndExecute( hSql(),
														  "SELECT nls INTO :sNls_6397 FROM accounts WHERE kv=:n980 and dazs is null and nls = 
														    substr(NLS_PROD_BRANCH('NLS1_6397', :PROD,:BRANCH),1,14) " )
														and NOT SqlFetchNext( hSql(), nFetchRes ) 
													Set nFlag =0 
													Break
												If NOT cDoc.PayV (0,nRef,dDat,'REK',1,n980,NLS_SS,OSTN*100,n980,sNls_6397,OSTN*100)
													Set nFlag =0 
													Break
										! Включить иное в осн.долг
										Else If OTM = 1 and OSTB != 0
											Set nS =  SalNumberAbs( OSTN * 100 )
											Set nDk = IifN( TIP = 'SG ', 0, 1)
											If NOT cDoc.PayV (0,nRef,dDat,'REK',nDk,n980,NLS_SS,OSTB*100,n980,NLS,OSTB*100)
												Set nFlag =0 
												Break
							!
							If nFlag = 1
								Set nDig  = 0
								Set sMess = 'Cохранение модиф.ГПК КД '||CC_ID
								If SqlPLSQLCommand(hSql(), "PM_GPK
										(nRnk, nNd, acc8, IR_old, KOM_old,
										 nGpk, FLAGS2, LIMIT_new*100, FDAT_new, WDATE_new,
										 IR_new, nFreq, nBasey, nMetr96, KOM_new, nDig ) " ) 
										and SqlPrepareAndExecute( hSql(),
										"update cc_deal set KPROLOG = nvl(KPROLOG,0) +1 
										 where nd="||Str(p_ND) ) 
									Call SqlCommitEx(hSql(),sMess)
									Call MessageNoWait(sMess,'Сообщение',3,0)
									! Set bOk=TRUE
							Else
								Call SqlRollback(hSql())
								Call MessageNoWait('Неуспешная модификация ГПК КД='||CC_ID, 'Ошибка', 0, 1)
								! Set bOk=FALSE
							Call SalWaitCursor(FALSE)
				Window Variables
					String: sSql1
					Number: nTmpE
				Message Actions
					On SAM_Create
						Call SalWaitCursor(TRUE)
						Set nSN8 =0
						Set sSql1 =
								"SELECT a.tip, a.nls,a.nms, -a.ostb/100 
								 INTO :tbl_NLS.TIP, :tbl_NLS.NLS, :tbl_NLS.NMS, :tbl_NLS.OSTB 
								 from accounts a, nd_acc n 
								 where n.nd=:p_ND and n.acc=a.acc 
								  and a.rnk=:nRnk and a.dazs is null and (a.ostb<>0 OR a.tip='SS ')
								  and a.tip not in ('LIM','SDI','SPI') "
						Call SalTblPopulate(tbl_NLS, hSql(), sSql1, TBL_FillAll )
						Call SalWaitCursor(FALSE)
					On SAM_FetchRowDone
						! - СЕРЫЙ
						Set OSTN = OSTB
						If TIP = 'SS ' 
							Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
							Set NLS_SS = NLS
							Set NMS_SS = NMS
							Set tbl_NLS.OTM=1
						If TIP = 'SN8'  
							Call XSalTblSetCellBackColor( OSTN, SalColorFromRGB( 255,210,250 ) )
							Call XSalTblSetCellBackColor( OSTP, COLOR_LightGreen )
							Set OSTP = 0
			!
		Functions
		Window Parameters
			Number: nMode
			Number: p_ND  ! nPar
			String: P_Title ! strPar01
			String: strPar02
		Window Variables
			Number: nSN8
			Number: acc8
			Number: nGpk
			Number: nGpk_A
			Number: nBasey
			Number: nFreq
			Number: nMetr96
			Number: nNd
			Number: nRnk
			Date/Time: bDate
			Date/Time: dTmpE
			String: NMS_SS
			: cDoc
				Class: cDoc
		Message Actions
			On SAM_Create
				Call SalSetWindowText( hWndForm, P_Title || ' реф='|| Str(p_ND) )
				Call SalCenterWindow(hWndForm)
				Set nNd = p_ND
				Set bDate = GetBankDate()
				If SqlPrepareAndExecute( hSql(),
						  "SELECT d.CC_ID, d.SDATE, c.NMK, d.WDATE, -ss.ostB/100,
						          acrn.FPROCN(a.acc,0,:bDate),  acrn.FPROCN(a.acc,2,:bDate),
						          a.acc, decode(a.vid,4,3,1),  c.rnk,  
						          d.prod, d.branch, b.name,  nvl(d.KPROLOG,0)
						    (select min(fdat) from cc_lim where nd=d.nd and fdat>=:bDate)
						   INTO :CC_ID , :SDATE, :NMK, :WDATE_old, :LIMIT_old, :IR_old,
						        :KOM_old, :acc8, :nGpk_A, :nRnk, 
						        :PROD, :BRANCH, :BRANCH_NAME, :KPROLOG, :FDAT_old
						   FROM cc_deal d, customer c, nd_acc n, accounts a, accounts SS, branch b
						   WHERE d.nd=:p_ND and d.rnk=c.rnk and d.sos<15
						     and d.nd=n.nd and n.acc=a.acc and a.tip='LIM' and d.branch=b.branch 
						     and ss.tip='SS ' and ss.accc=a.acc " )
						and NOT SqlFetchNext( hSql(), nFetchRes )
					! Call SalEndDialog(hWndForm, 0)
				!
				If SqlPrepareAndExecute( hSql(),
						  "select b.name, i.basey, i.freq,  q.name
						   into :Basey_old, :nBasey, :nFreq, :FREQ_old
						   from int_accn i, basey b, freq q
						   where i.acc=:acc8 and id=0 and i.basey=b.basey and i.freq=q.freq" )
						and NOT SqlFetchNext( hSql(), nFetchRes )
					! Call SalEndDialog(hWndForm, 0)
				!
				If SqlPrepareAndExecute( hSql(),
						  "Select b.name, i.metr into :Metr96_old, :nMetr96
						   from int_accn i, int_metr b
						   where i.acc=:acc8 and id=2 and i.metr= b.metr " )
						and NOT SqlFetchNext( hSql(), nFetchRes )
					Call SalEndDialog(hWndForm, 0)
				! CCK_GPK_TYPES
				If SqlPrepareAndExecute( hSql(),
						  "SELECT name, id INTO  :GPK_old, :nGpk FROM CCK_GPK_TYPES
						   WHERE id = to_number(wcs_utl.get_mac( :nNd, 'MODE_GPK' )) " )
						and NOT SqlFetchNext( hSql(), nFetchRes )
					! Call Debug('aa')
					! Call SalEndDialog(hWndForm, 0)
				!
				Set LIMIT_new = LIMIT_old
				Set FDAT_new  = FDAT_old
				Set WDATE_new = WDATE_old
				!
				Set Basey_new = Basey_old
				Set IR_new    = IR_old
				!
				Set Metr96_new= Metr96_old
				Set KOM_new   = KOM_old
				!
				Set GPK_new   = GPK_old
				Set FREQ_new  = FREQ_old
				!
	Table Window: REK
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Авторизация Реструктуризаций КД
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   -0.563"
				Top:    -0.042"
				Width:  17.267"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 500
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.44"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.45"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 51807
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						! On SAM_Click
							                                    If ND_OLD >0 and  ISP != nUserId 
								                                    If IsWindow( hVS )
									                                    Call SalDestroyWindow(hVS )
								                                    Set hVS = SalCreateWindow(VS, hWndMDI, ND_OLD, ND_NEW, REF, NMK, nCheckId, pbRefresh)
								!
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 51808
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 51809
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ФИО
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.033"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAZN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назначение 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  4.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сист.
						Дата
						 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.233"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PTIME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сист.
						время
						 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Center
				Width:  1.183"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег.
						№ кл
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = RNK
					On SAM_AnyEdit
						Set RNK = nTmpE
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						МО
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.083"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = REF
					On SAM_AnyEdit
						Set REF = nTmpE
			Column: ND_OLD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф.
						старого
						КД
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.083"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = ND_OLD
					On SAM_AnyEdit
						Set ND_OLD = nTmpE
			Column: ND_NEW
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						Нового
						КД
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = ND_NEW
					On SAM_AnyEdit
						Set ND_NEW = nTmpE
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума
						нового КД
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = REF
					On SAM_AnyEdit
						Set REF = nTmpE
			Column: ISP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						Исп
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.7"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						вал
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.933"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			! Column: BRANCH
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Бранч КБ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.3"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                    List Values 
				                                    Message Actions 
		Functions
		Window Parameters
			Number: nMode
			Number: nCheckId  
			String: strPar01
			String: strPar02
		Window Variables
			Number: nTmpE
			Number: nUserId
			String: sFilter
		Message Actions
			On SAM_Create
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns( hWndForm, 4 )
				Call SetWindowFullSize(hWndForm)
				Set nUserId =GetUserId()
				Set REK.strFilterTblName = 'CC_REK'
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				! - СЕРЫЙ
				If ISP = nUserId
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray  )
			On UM_Populate
				Call SalWaitCursor(TRUE)
				!
				Set sFilter = cF.GetFilterWhereClause(FALSE)
				!
				Set REK.strSqlPopulate =
						"SELECT NDO, NDN, NMK, REF, S , NAZN, PDAT, PTIME, ISP, KV, RNK 
						INTO :REK.ND_OLD, :REK.ND_NEW, :REK.NMK, :REK.REF, :REK.S, 
						     :REK.NAZN, :REK.PDAT, :REK.PTIME,:REK.ISP, :REK.KV,  :REK.RNK   
						FROM (SELECT to_number(substr(o.nlsb,7,9)) NDO, 
						        to_number(substr(o.nlsa,7,9)) NDN, 
						        o.nam_a NMK, o.REF, o.s/100 S,
						        o.NAZN, trunc(o.pdat) PDAT, to_char(o.pdat,'hh24:mi:ss') PTIME,
						        o.USERID ISP, o.KV, a.RNK  
						      FROM oper o, STAFF_CHK s, accounts a 
						      where a.kv=o.KV and a.nls=o.nlsa 
						        and o.sos=1 and o.tt='REK'  and s.id=" || Str(nUserId) || "  
						        and s.chkid= "||Str(nCheckId) || " and s.approve=1 
						        and  o.nextvisagrp = \'" || NumberToHexSX(nCheckId) || "\' ) CC_REK " || 
						IifS(sFilter = "",""," WHERE " || sFilter ) || " 
						order by REF desc "
				!
				Call SalWaitCursor(TRUE)
				Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
				Call SalTblPopulate(hWndForm, hSql(), REK.strSqlPopulate, TBL_FillAll )
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_DoubleClick
				If ND_OLD >0 and  ISP != nUserId 
					If IsWindow( hVS )
						Call SalDestroyWindow(hVS )
					Set hVS = SalCreateWindow(VS, hWndMDI, 1, ND_OLD, ND_NEW, REF, NMK, nCheckId, pbRefresh)
					!
	Table Window: REP
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Портфель реструктуризированных КД
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.425"
				Top:    0.823"
				Width:  17.267"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 500
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.44"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.783"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 57716
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.283"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.783"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.783"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 57717
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.283"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 57718
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.283"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Gray
					Message Actions
						On SAM_Create
							Set strTip = "Информация о КД Old"
						On SAM_Click
							If not SalIsNull(hWndForm.REP.ND_OLD)
								Call Sel017с( 90, ND_OLD, 3, NUMBER_Null, STRING_Null, STRING_Null, STRING_Null, S0_OLD, 0)
							! ! Number: nTip_Fun = 90
							! ! Number: ND
							! ! Number: nTip_Kl = 3
							! ! Number: nGr = NUMBER_Null
							! ! String: sKV1=STRING_Null
							! ! String: sKV2= STRING_Null
							! ! String: sKV3= STRING_Null
							! ! Number: SDOG= 
							! ! Number: nTip_Dop=0	! пока используется только в функции просмотра
				Pushbutton: pb_R
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDetail
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.75"
						Top:    0.095"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: C:\bars98\RESOURCE\BMP\DOC_IN.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = "Условия реструктуризации"
						On SAM_Click
							If IsWindow( hVS )
								Call SalDestroyWindow(hVS )
							Set hVS = SalCreateWindow(VS, hWndMDI, 0, ND_OLD, ND_NEW, REF, NMK, 0, hWndNULL )
				Pushbutton: pb_New
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbDetail
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = "Информация о КД New"
						On SAM_Click
							If not SalIsNull(hWndForm.REP.ND_NEW)
								Call Sel017с( 90, ND_NEW, 3, NUMBER_Null, STRING_Null, STRING_Null, STRING_Null, S0_NEW, 0)
		Contents
			Column: BRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Бранч 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.833"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PROD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						продукта
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.95"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег.
						№ кл
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = RNK
					On SAM_AnyEdit
						Set RNK = nTmpE
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ФИО
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.033"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: ND_NEW
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						New 
						КД
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = ND_NEW
					On SAM_AnyEdit
						Set ND_NEW = nTmpE
			Column: ID_NEW
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ид. 
						New 
						КД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.117"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT1_NEW
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата 
						начала 
						New КД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.233"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT4_NEW
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата 
						завершения
						New КД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.233"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S0_NEW
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Начальная
						Сума
						New КД
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = REF
					On SAM_AnyEdit
						Set REF = nTmpE
			Column: ST_NEW
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Начальная
						Сума
						New КД
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = REF
					On SAM_AnyEdit
						Set REF = nTmpE
			Column: SOS_NEW
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сост
						New 
						КД
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = ND_NEW
					On SAM_AnyEdit
						Set ND_NEW = nTmpE
			!
			Column: ND_OLD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф.
						Old
						КД
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.083"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = ND_OLD
					On SAM_AnyEdit
						Set ND_OLD = nTmpE
			Column: ID_OLD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ид. 
						Old
						КД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.017"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT1_OLD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата 
						начала 
						Old КД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.233"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT4_OLD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата 
						завершения
						Old КД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.233"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S0_OLD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Начальная
						Сума
						Old КД
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.2"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = REF
					On SAM_AnyEdit
						Set REF = nTmpE
			!
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						МО
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.083"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = REF
					On SAM_AnyEdit
						Set REF = nTmpE
			! Column: KV
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						вал
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.933"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                   List Values 
				                   Message Actions 
		Functions
		Window Parameters
			Number: nMode
			Number: nCheckId  
			String: strPar01
			String: strPar02
		Window Variables
			Number: nTmpE
			Number: nCol
			Date/Time: dDat
			! Number: nUserId
			! String: sFilter
		Message Actions
			On SAM_Create
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns( hWndForm, 4 )
				Call SetWindowFullSize(hWndForm)
				! Set nUserId =GetUserId()
				Set dDat = GetBankDate()
				Set REP.strFilterTblName = 'CC_REP'
				Set REP.strPrintFileName = 'KD_RES'
				Set REP.strSqlPopulate =
						"SELECT BRANCH, PROD, RNK, NMK, REF,
						   ND_NEW,ID_NEW,DAT1_NEW,DAT4_NEW,S0_NEW,ST_NEW,SOS_NEW,
						   ND_OLD,ID_OLD,DAT1_OLD,DAT4_OLD,S0_OLD 
						INTO
						 :REP.BRANCH, :REP.PROD, :REP.RNK, :REP.NMK, :REP.REF,
						 :REP.ND_NEW, :REP.ID_NEW, :REP.DAT1_NEW, :REP.DAT4_NEW, :REP.S0_NEW,
						 :REP.ST_NEW, :REP.SOS_NEW,
						 :REP.ND_OLD, :REP.ID_OLD, :REP.DAT1_OLD, :REP.DAT4_OLD, :REP.S0_OLD  
						FROM v_RR_DEAL order by REF desc "
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_FetchRowDone
				! - СЕРЫЙ
				Call XSalTblSetCellBackColor( ND_OLD, COLOR_LightGray )
				Call XSalTblSetCellBackColor( ID_OLD, COLOR_LightGray )
				Call XSalTblSetCellBackColor( DAT1_OLD, COLOR_LightGray )
				Call XSalTblSetCellBackColor( DAT4_OLD, COLOR_LightGray )
				Call XSalTblSetCellBackColor( S0_OLD, COLOR_LightGray )
				!
				Call XSalTblSetCellBackColor( RNK, SalColorFromRGB( 255,255,180)  )
				Call XSalTblSetCellBackColor( NMK, SalColorFromRGB( 255,255,180) )
				!
				If SOS_NEW < 13 
					Set nCol = COLOR_LightGreen
				Else If DAT4_NEW <= dDat
					Set nCol =  SalColorFromRGB( 255,210,250 )
				Else
					Set nCol =  COLOR_Salmon
				!
				Call XSalTblSetCellBackColor( ND_NEW, nCol )
				Call XSalTblSetCellBackColor( ID_NEW, nCol )
				Call XSalTblSetCellBackColor( DAT1_NEW, nCol )
				Call XSalTblSetCellBackColor( DAT4_NEW, nCol )
				Call XSalTblSetCellBackColor( S0_NEW, nCol )
				Call XSalTblSetCellBackColor( SOS_NEW, nCol )
				Call XSalTblSetCellBackColor( ST_NEW, nCol )
				! If ISP = nUserId
					                   Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray  )
			! On UM_Populate
				                   Call SalWaitCursor(TRUE)
				!
				                   Set sFilter = cF.GetFilterWhereClause(FALSE)
				!
				                   Set REP.strSqlPopulate =
						"SELECT BRANCH, PRODC, RNK, NMK, REF,
						   ND_NEW,ID_NEW,DAT1_NEW,DAT4_NEW,S0_NEW,ST_NEW,SOS_NEW,
						   ND_OLD,ID_OLD,DAT1_OLD,DAT4_OLD,S0_OLD 
						INTO
						 :REP.BRANCH, :REP.PRODC, :REP.RNK, :REP.NMK, :REP.REF,
						 :REP.ND_NEW, :REP.ID_NEW, :REP.DAT1_NEW, :REP.DAT4_NEW, :REP.S0_NEW,
						 :REP.ST_NEW, :REP.SOS_NEW,
						 :REP.ND_OLD, :REP.ID_OLD, :REP.DAT1_OLD, :REP.DAT4_OLD, :REP.S0_OLD  
						FROM v_RR_DEAL order by REF desc "
				!
				                   Call SalWaitCursor(TRUE)
				                   Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
				                   Call SalTblPopulate(hWndForm, hSql(), REP.strSqlPopulate, TBL_FillAll )
				                   Call SalTblSetContext(hWndForm, 0)
				                   Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				                   Call SalWaitCursor(FALSE)
			On SAM_DoubleClick
				! If ND_OLD >0 
					                   If IsWindow( hVS )
						                   Call SalDestroyWindow(hVS )
					                   Set hVS = SalCreateWindow(VS, hWndMDI, 1, ND_OLD, ND_NEW, REF, NMK, nCheckId, pbRefresh)
					!
	! cGenericTableSpl: ISG	!! Индивидуальный ручной разбор сч.гашения
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
.winattr class Form Window:
		Class: cGenericTableSpl
		Property Template:
		Class DLL Name: vti11.dll;0;3145728;;;
		Title: Індивідуальний ручний розбір кредитових залишків
		Icon File:
		Accesories Enabled? Yes
		Visible? No
		Display Settings
			Display Style? Standard
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Maximized
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.038"
				Top:    0.031"
				Width:  13.833"
				Width Editable? Yes
				Height: 5.583"
				Height Editable? Yes
			Form Size
				Width:  -1.0"
				Height: -1.0"
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
.end
		                            Description: 
		                            Named Menus 
		                            Menu 
		                            Tool Bar 
			                            Contents 
				                            Data Field: dTxt
					                            Message Actions 
				!
				                            Data Field: Nls_A
					                            Message Actions 
				                            Data Field: Kv
					                            Message Actions 
				                            Data Field: Nms_A
					                            Message Actions 
				                            Data Field: Ost_A
					                            Message Actions 
				                            Pushbutton: pb_Vypiska
					                            Message Actions 
						                            On SAM_Create
							                            Set strTip = 'Переглянути виписку за поточний день'
						                            On SAM_Click
							                            If nAcc != NUMBER_Null
								                            Call ShowTurnForAccount(nAcc, GetBankDateEx())
				                            Pushbutton: pb_Run
					                            Message Actions 
						                            On SAM_Create
							                            Set strTip = 'Виконати операцію погашення '
						                            On SAM_Click
							                            Set Ost_B = tbl2.F_Sum()
							                            If Nls_A != STRING_Null and Ost_A >= Ost_B
								                            If SalMessageBox( strTip ,
										'Увага ! Ви дійсно бажаєте ? ', MB_IconQuestion | MB_YesNo) = IDYES
									                            If tbl2.F_Opl(strTip)
										                            If SqlCommitEx( hSql(), strTip )
											                            Call SalDisableWindow( pb_Run )
											                            Call SalDisableWindow( tbl2.S )
										                            Else 
											                            Call SqlRollback( hSql() )
				                            Data Field: Ost_B
					                            Message Actions 
				                            Pushbutton: pbRefresh
					                            Message Actions 
						                            On SAM_Click
							                            Call tbl.Nas1()
							                            Call tbl2.Nas2()
				!
				                            Pushbutton: pbDetails
					                            Message Actions 
				                            Pushbutton: pbPrint
					                            Message Actions 
				                            Pushbutton: pbExit
					                            Message Actions 
				!
				                            Pushbutton: pbIns
					                            Message Actions 
				                            Pushbutton: pbFilter
					                            Message Actions 
				                            Pushbutton: pbDel
					                            Message Actions 
				                            Pushbutton: pbUpdate
					                            Message Actions 
				                            Line 
				                            Pushbutton: pbSearch
					                            Message Actions 
				                            Line 
				                            Line 
		                            Contents 
			                            Custom Control: ccSplitter
				                            Message Actions 
			                            Child Table: tbl
				                            Contents 
					                            Column: TIP_A
						                            List Values 
						                            Message Actions 
					                            Column: KV_A
						                            List Values 
						                            Message Actions 
					                            Column: NLS_A
						                            List Values 
						                            Message Actions 
					                            Column: NMS_A
						                            List Values 
						                            Message Actions 
					                            Column: OSTB_A
						                            List Values 
						                            Message Actions 
					                            Column: OSTC_A
						                            List Values 
						                            Message Actions 
					                            Column: ACC_A
						                            List Values 
						                            Message Actions 
				                            Functions 
					                            Function: Nas1
						                            Description: 
						                            Returns 
						                            Parameters 
						                            Static Variables 
						                            Local variables 
							                            String: sSql
						                            Actions 
							                            Call SalWaitCursor(TRUE)
							                            Set sSql =
									"SELECT a.acc, a.tip, a.kv,a.nls, a.nms, (a.lim+a.ostb)/100, (a.lim+a.ostc)/100
									 INTO :ACC_A, :TIP_A, :KV_A, :NLS_A, :NMS_A, :OSTB_A, :OSTC_A
									 FROM accounts a, nd_acc n
									 WHERE n.nd=:nNd and a.nbs <'4' 
									   and a.acc=n.acc and (a.lim+a.ostb)>0 and a.rnk="||sRnk 
							                            Call SalTblPopulate( ISG.tbl, hSql(), sSql, TBL_FillAll )
							                            Set Nls_A = STRING_Null
							                            Set Nms_A = STRING_Null
							                            Set Kv = NUMBER_Null
							                            Set nAcc = NUMBER_Null
							                            Set Ost_A = NUMBER_Null
							                            Set Ost_B = NUMBER_Null
							                            Call SalEnableWindow( pb_Run )
							                            Call SalWaitCursor(FALSE)
				                            Window Variables 
				                            Message Actions 
					                            On SAM_DoubleClick
						                            Set Nls_A = NLS_A
						                            Set Nms_A = NMS_A
						                            Set Ost_A = OSTB_A
						                            Set Kv = KV_A
						                            Set nAcc = ACC_A
					                            On SAM_KillFocus
						                            Set hWndLost=hWndForm
					                            On SAM_FetchRowDone
						                            Call XSalTblSetRowBackColor( hWndForm, lParam, nCol1 )
					                            On SAM_Create
						                            Call Nas1()
			                            Child Table: tbl2
				                            Contents 
					                            Column: TIP_B
						                            List Values 
						                            Message Actions 
					                            Column: KV_B
						                            List Values 
						                            Message Actions 
					                            Column: NLS_B
						                            List Values 
						                            Message Actions 
					                            Column: NMS_B
						                            List Values 
						                            Message Actions 
					                            Column: OSTB_B
						                            List Values 
						                            Message Actions 
					                            Column: OSTC_B
						                            List Values 
						                            Message Actions 
					                            Column: S
						                            List Values 
						                            Message Actions 
							                            On SAM_KillFocus
								                            Call F_Kv()
							                            On SAM_Validate
								                            Call F_Kv()
					                            Column: REF
						                            List Values 
						                            Message Actions 
					                            Column: ACC_B
						                            List Values 
						                            Message Actions 
				                            Functions 
					                            Function: Nas2
						                            Description: 
						                            Returns 
						                            Parameters 
						                            Static Variables 
						                            Local variables 
							                            String: sSql
						                            Actions 
							                            Call SalWaitCursor(TRUE)
							                            Call SalEnableWindow( S )
							                            Set sSql =
									"SELECT a.tip, a.kv,a.nls, a.nms, a.ostb/100, a.ostc/100
									 INTO :TIP_B, :KV_B, :NLS_B, :NMS_B, :OSTB_B, :OSTC_B
									 FROM accounts a, nd_acc n
									 WHERE n.nd=:nNd and a.acc=n.acc 
									   and a.nbs <'4' and a.ostb<0 and a.rnk="||sRnk 
							                            Call SalTblPopulate( ISG.tbl2, hSql(), sSql, TBL_FillAll )
							                            Call SalWaitCursor(FALSE)
					                            Function: F_Sum
						                            Description: 
						                            Returns 
							                            Number: 
						                            Parameters 
						                            Static Variables 
						                            Local variables 
							                            Number: nRow
							                            Number: nS
						                            Actions 
							                            Set nRow = TBL_MinRow
							                            Set nS = 0
							                            While SalTblFindNextRow( tbl2, nRow, 0, 0)
								                            Call SalTblSetContext(tbl2, nRow)
								                            Call F_Kv()
								                            Set nS = nS + S
							                            Return nS
					                            Function: F_Opl
						                            Description: 
						                            Returns 
							                            Boolean: 
						                            Parameters 
							                            String: pOk
						                            Static Variables 
						                            Local variables 
							                            Number: nRow
							                            Number: nS
							                            String: Nazn
						                            Actions 
							                            Set nRow = TBL_MinRow
							                            Set Nazn =  'Погашення зг. КД ' || sTxt
							                            While SalTblFindNextRow( tbl2, nRow, 0, 0)
								                            Call SalTblSetContext(tbl2, nRow)
								                            If S > 0
									                            Set nS = S * 100
									                            Call cDoc.SetDoc( 0, 'ISG', 1, 6, STRING_Null,
											     dDat, dDat, dDat, dDat,
											     Nls_A, Nms_A, aMFO,'', Kv, nS, aOKPO,
											     NLS_B, NMS_B, aMFO,'', KV_B, nS, aOKPO,
											     Nazn, '', GetIdOper(), '', NUMBER_Null, 0 )
									                            If NOT cDoc.oDoc()
										                            Return FALSE
									                            Set REF = cDoc.m_nRef
							                            Return TRUE
					                            Function: F_Kv
						                            Description: 
						                            Returns 
						                            Parameters 
						                            Static Variables 
						                            Local variables 
						                            Actions 
							                            If (Kv != NUMBER_Null and Kv != KV_B) Or S < 0 
								                            Set S = 0 
				                            Window Variables 
					                            String: strSqlPopulate	! Строка SQL SELECT
					                            String: strSqlInsert	! Строка SQL INSERT
					                            String: strSqlDelete	! Строка SQL DELETE
					                            String: strSqlUpdate	! Строка SQL UPDATE
					                            String: strTitleAux
					                            String: sTmp
				                            Message Actions 
					                            On SAM_DoubleClick
						                            If REF != NUMBER_Null
							                            Call DocViewContentsEx( ISG, REF )
						                            Else 
							                            If Ost_B = NUMBER_Null
								                            Set S = - OSTC_B 
					                            On SAM_KillFocus
						                            Set hWndLost=hWndForm
					                            On SAM_FetchRowDone
						                            Call XSalTblSetRowBackColor( hWndForm, lParam, nCol2 )
						                            Set S = 0
					                            On SAM_Create
						                            Call Nas2()
		                            Functions 
		                            Window Parameters 
			                            Number: nMode
			                            Number: nNd
			                            String: sRnk
			                            String: sTxt
		                            Window Variables 
			                            Number: nCol1
			                            Number: nCol2
			                            Number: n980
			                            Number: nRow
			                            String: aMFO
			                            String: aOKPO
			                            Date/Time: dDat
			!
			                            Window Handle: hWndLost
			                            Number: nTmpE
			                            String: sTmp
			                            String: sTmp2
			!
			                            Number: nAcc
			! Number: nRef
			                            : cDoc
			!
			                            String: sOk
			! Number: dVOBn
			! Number: dVOBv
			!
			! String: KKK
			! Number: kVOBn
			! Number: kVOBv
			!
			! String: BBB
			! Number: bVOB
			!
			! String: SSS
			! Number: sVOB
			!
		                            Message Actions 
			                            On SAM_Create
				                            Set n980 = GetBaseVal()
				                            Set dDat = GetBankDate()
				                            Set aMFO = GetBankMfo()
				                            Set aOKPO= GetBankOkpoS()
				                            Set nCol2 = SalColorFromRGB( 255,210,210 ) ! СЛАБО-КРАСНЫЙ
				                            Set nCol1 = SalColorFromRGB( 220,255,255 ) ! голубой
				                            Set dTxt  = sTxt
				! Set rb_37 = TRUE
				! Set rb_39 = FALSE
				!
				                            Call SalMapEnterToTab( TRUE )
				                            Call PrepareWindowEx( hWndForm )
				                            Call SetWindowFullSize( hWndForm )
				! Call ShowApdVersion('06')
				                            Call SalSendClassMessage( SAM_Create, 0, 0 )
	Table Window: CP
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Відкриття позасистемних рахунків та виконання проводок по ЦП
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Maximized
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.825"
				Top:    1.031"
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 1.44"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Combo Box: cmb_RYN
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data CLASSPROPSSIZE
0000: 1700
.enddata
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cGenComboBox_NumId
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   0.383"
						Top:    0.179"
						Width:  4.8"
						Width Editable? Yes
						Height: 1.964"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: 35
					Sorted? Class Default
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Click
							Set nRYN = cmb_RYN.GetKey(SalListQuerySelection(hWndItem))
						On SAM_SetFocus
							Call SalMapEnterToTab( TRUE )
						On SAM_Create
							! ! Выбор субпортфеля
							Call cmb_RYN.Init(cmb_RYN)
							Call cmb_RYN.Populate(hSql(), "RYN","NAME","CP_RYN",
									" WHERE KV="||Str(n980)||" and TIPD=1 ORDER BY RYN " )
				Data Field: TIP
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 3
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    0.488"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код-тип позасистемних рахунків' )
						On SAM_Validate
							If SqlPrepareAndExecute( hSql(),
									"SELECT name into :Tip_NAME from tips where tip=:TIP ")
									and NOT SqlFetchNext ( hSql(), nFetchRes)
								Call SalMessageBox( 'Код-тип ' || CP.TIP || ' не знайдено', 'Увага, помилка !', MB_IconStop)
								Set TIP = STRING_Null
				Data Field: Tip_NAME
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    0.905"
							Width:  4.7"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва-тип позасистемних рахунків' )
				!
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.683"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.183"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.683"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.183"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.683"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Line
					Resource Id: 23857
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 23858
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 23859
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.583"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				!
				Frame
					Resource Id: 41294
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.283"
						Top:    0.071"
						Width:  9.9"
						Width Editable? Yes
						Height: 0.833"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Raised-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.483"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = " Відкрити позасистемні рахунки "
						On SAM_Click
							If SalMessageBox(
									'Ви дійсно бажаєте ' ||strTip || ' ?',
									'У В А Г А  !', MB_IconQuestion | MB_YesNo) = IDYES
								Call F_Opl(0)
								Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
								Call SalWaitCursor(FALSE)
				Background Text: Деб
					Resource Id: 41296
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.983"
						Top:    0.595"
						Width:  0.5"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: NMSD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.483"
							Top:    0.155"
							Width:  4.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: TIPD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.583"
							Top:    0.488"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Тип рахунку Дебет' )
				Data Field: NLSD
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   7.583"
							Top:    0.488"
							Width:  2.333"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рахунок Дебет' )
						On SAM_Validate
							If SqlPrepareAndExecute( hSql(),
									"SELECT tip,nms into :TIPD, :NMSD 
									 from accounts where nls=:NLSD and kv=:n980 and dazs is null ")
									and NOT SqlFetchNext ( hSql(), nFetchRes)
								Call SalMessageBox( 'Рах.' || NLSD || ' не знайдено', 'Увага, помилка !', MB_IconStop)
								Set NLSD = STRING_Null
				Background Text: Крд
					Resource Id: 41295
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   9.983"
						Top:    0.595"
						Width:  0.5"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Justify: Right
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
				Data Field: NMSK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   9.983"
							Top:    0.155"
							Width:  4.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: TIPK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.583"
							Top:    0.488"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Тип рахунку Кредит' )
				Data Field: NLSK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   11.583"
							Top:    0.488"
							Width:  2.333"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рахунок Кредит' )
						On SAM_Validate
							If SqlPrepareAndExecute( hSql(),
									"SELECT tip,nms into :TIPK, :NMSK
									 from accounts where nls=:NLSK and kv=:n980 ")
									and NOT SqlFetchNext ( hSql(), nFetchRes)
								Call SalMessageBox( 'Рах.' || NLSK || ' не знайдено', 'Увага, помилка !', MB_IconStop)
								Set NLSK = STRING_Null
				!
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   13.983"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = " Виконати проводки згідно макету"
						On SAM_Click
							If SalMessageBox(
									'Ви дійсно бажаєте ' ||strTip || ' ?',
									'У В А Г А  !', MB_IconQuestion | MB_YesNo) = IDYES
								Call F_Opl(1)
								Call SalWaitCursor(FALSE)
				!
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   14.483"
						Top:    0.488"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = " Зберегти суму для відкладеної проводки "
						On SAM_Click
							If SalMessageBox(
									'Ви дійсно бажаєте ' ||strTip || ' ?',
									'У В А Г А  !', MB_IconQuestion | MB_YesNo) = IDYES
								Call F_Opl(2)
								Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
								Call SalWaitCursor(FALSE)
				!
				Data Field: TT
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: 3
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.383"
							Top:    1.155"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код операції' )
						On SAM_Validate
							If SqlPrepareAndExecute( hSql(),
									"SELECT name into :TT_NAME from tts where tt=:TT ")
									and NOT SqlFetchNext ( hSql(), nFetchRes)
								Call SalMessageBox( 'Код оп.' || CP.TT || ' не знайдено', 'Увага, помилка !', MB_IconStop)
								Set TT = STRING_Null
				Data Field: TT_NAME
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.283"
							Top:    0.905"
							Width:  9.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва операції' )
				Data Field: VOB
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.583"
							Top:    1.155"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Вид обробки' )
						On SAM_Validate
							If VOB = 6
								Set VDAT = dDAT
							Else If VOB = 96
								Set VDAT = mDAT
							Else If VOB = 99
								Set VDAT = yDAT
							Else
								Call SalMessageBox( 'Вид обр не = 6, 96, 99' , 'Увага, помилка !', MB_IconStop)
								Set VOB = 6
								Set VDAT = dDAT
				Data Field: VDAT 
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   2.683"
							Top:    1.155"
							Width:  2.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата валютування' )
						On SAM_Validate
							If VDAT = mDAT
								Set VOB = 96
							Else If VDAT = yDAT
								Set VOB = 99
							Else If VDAT >= dDAT
								Set VOB = 6
							Else
								Call SalMessageBox( 'Дата валютування' , 'Увага, помилка !', MB_IconStop)
								Set VOB = 6
								Set VDAT = dDAT
				Data Field: NAZN
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   5.283"
							Top:    1.155"
							Width:  9.9"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Призначення платежу' )
				Data Field: KV
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   1.583"
							Top:    0.488"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: #0
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Bold
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Код валюти' )
		Contents
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: № угоди
						купівлі
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.083"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DATD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата угоди
						купівлі
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.15"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Реф угоди
						купівлі
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сист
						№ ЦП
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CP_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Код
						ЦП
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.333"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Рах.
						Номіналу
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Зал. на рах.
						номіналу
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.667"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MDATE
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Дата
						погашення
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Right
				Width:  1.283"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: NLSM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Приєднаний
						Рах 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.467"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OTM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Відк
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						If NLSM != STRING_Null
							Set OTM = 0
			Column: OSTM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Зал. на рах.
						Приєднаному
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.367"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Сума
						проводки
				Visible? Yes
				Editable? Class Default
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.417"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						If NLSM = STRING_Null
							Set S = NUMBER_Null
			Column: REF2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Реф 
						МО
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If REF2 > 0
							Call DocViewContentsEx(hWndForm, REF2 )
			Column: ACCM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cColumnLabeled
				Property Template:
				Class DLL Name:
				Title: Осн
						ACC
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.043"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_INS
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					String: sErr
				Actions
					! Call SalWaitCursor(TRUE)
					Set sErr = ''
					If nRYN = NUMBER_Null
						Set sErr = sErr || '
								Не вибрано код суб/портф. !'
					If TIP = STRING_Null
						Set sErr = sErr || '
								Не задано тип рахунку !'
					Else
						If SqlPrepareAndExecute( hSql(),
								"SELECT 1 from tips where tip=:TIP ")
								and NOT SqlFetchNext ( hSql(), nFetchRes)
							Set sErr = sErr || '
									Помилковий тип рахунку !'
					!
					If sErr != ''
						Call SalMessageBox( sErr, 'Увага, помилка !', MB_IconStop)
						Return FALSE
					!
					Return TRUE
			Function: F_Opl
				Description:
				Returns
				Parameters
					Number: nReg
				Static Variables
				Local variables
					String: sErr
					Number: nRow 
					Number: nAcc  
					Number: nGrp
					String: sNbs
					String: sNms
					String: sNmsA
					String: sNmsB
					String: sNls
					String: sNlsB
					Number: nRnk
					Number: nIsp
					Number: nR1
					Number: nRef
					Number: nDk
					!
					String: sNlsR
				Actions
					Set sErr = ''
					If nReg < 2
						If NLSD = STRING_Null OR NLSK = STRING_Null 
							Set sErr = sErr || '
									Не задано рахунки (Деб/Кред) для кореспонденції !'
						Else
							If TIPD != TIP and TIPK != TIP 
								Set sErr = sErr || '
										 Тип рах (Деб/Кред) не відповідають типу позаситемних !'
						If nReg = 1 and NAZN = STRING_Null
							Set sErr = sErr || '
									 Не введено признач.платежу !'
						If sErr != ''
							Call SalMessageBox( sErr, 'Увага, помилка !', MB_IconStop)
							Return FALSE
						Call SalWaitCursor(TRUE)
						If SqlPrepareAndExecute( hSql(),
								"SELECT nbs,  grp,  rnk,  isp, acc ,  nms 
								 into :sNbs,:nGrp,:nRnk,:nIsp,:ACCC, :sNmsA  from accounts 
								 where kv=:n980 and nls= decode (:TIP, :TIPD, :NLSD, :NLSK) ")
								and NOT SqlFetchNext ( hSql(), nFetchRes)
						If TIP =TIPD
							Set sNmsB = NMSK
							Set sNlsB = NLSK
							Set nDk = 1
							Set sNlsR = NLSD
						Else
							Set sNmsB = NMSD
							Set sNlsB = NLSD
							Set nDk = 0
							Set sNlsR = NLSK
					!
					Set nRow = TBL_MinRow
					While SalTblFindNextRow( hWndForm, nRow, 0, 0)
						Call SalTblSetContext(hWndForm, nRow)
						Set sNms = Subs(CP_ID || ' '|| sNmsA,1,38)
						If nReg = 0 and CP.OTM = 1 and CP.NLSM  = STRING_Null
							Set sNls = sNbs||'0'||Subs(TIP,1,1) || Subs( CP.NLS,7,8)
							If SqlPLSQLCommand(hSql(),
									 "cp.CP_REG_EX( 99,0,0,nGrp,nR1,nRnk,sNls,n980, sNms,TIP,nIsp,nAcc) " ) 
									and SqlPrepareAndExecute( hSql(),
									  "UPDATE accounts SET mdate=:MDATE,accc=:ACCC,seci=4,pos=1,daos=:dDAT  
									   WHERE acc=:nAcc")
									and SqlPrepareAndExecute( hSql(), "insert into cp_REF_ACC(ref,acc) values (:CP.REF,:nAcc) " )
							Else
								Call SqlRollback( hSql() )
								Return FALSE
						Else If nReg=1 and CP.S> 0 and CP.NLSM != STRING_Null and CP.REF2 = NUMBER_Null 
							Set nRef = NUMBER_Null
							Call cDoc.SetDoc(nRef, TT , nDk, VOB, '', dDAT, dDAT, VDAT, VDAT, 
									     sNlsR, sNmsA, aMfo,'', n980, CP.S*100, aOkpo, 
									     sNlsB, sNmsB, aMfo,'', n980, CP.S*100, aOkpo,
									     CP.CP_ID|| '/'||Str(CP.REF)|| ' '||
									     NAZN, '', GetIdOper(), '',  NUMBER_Null, 0)
							Set cDoc.sNlsT1 = CP.NLSM
							Set cDoc.sNlsT2 = sNlsB
							If NOT cDoc.oDoc()
								Call SqlRollback( hSql() )
								Return FALSE
							Set CP.REF2 = cDoc.m_nRef
						Else If nReg=2 and CP.S != NUMBER_Null and CP.ACCM != NUMBER_Null and CP.REF2 = NUMBER_Null
							If NOT SqlPrepareAndExecute( hSql(),
									  "UPDATE cp_REF_ACC SET s = :CP.S where ref=:CP.REF and acc=:CP.ACCM " )
								Call SqlRollback( hSql() )
								Return FALSE
					!
					Call SqlCommit(hSql())
					Return TRUE
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Number: n980 
			String: aMfo 
			String: aOkpo
			String: sFilter
			Number: ACCC
			!
			Date/Time: dDAT
			Date/Time: mDAT
			Date/Time: yDAT
			!
			Number: nRYN
			! cDoc: cDocCP
.winattr class :
				Class: cDoc
.end
			: cDoc
				Class: cDocCP
		Message Actions
			On SAM_Create
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Set n980 = GetBaseVal()
				Set KV   = n980
				Set dDAT = GetBankDate()
				Set aMfo = GetBankMfo()
				Set aOkpo= GetBankOkpoS()
				! Set TT   = 'FXM'
				Set VOB  = 6 
				Set VDAT = dDAT
				Call SalTblSetLockedColumns( hWndForm, 8 )
				If SqlPrepareAndExecute( hSql(),
						"SELECT max(fdat) into :mDAT 
						 from fdat where to_char(fdat,'yyyymm')< to_char(:dDAT,'yyyymm') ")
						and SqlFetchNext ( hSql(), nFetchRes)
				If SqlPrepareAndExecute( hSql(),
						"SELECT max(fdat) into :yDAT 
						 from fdat where to_char(fdat,'yyyy')< to_char(:dDAT,'yyyy') ")
						and SqlFetchNext( hSql(), nFetchRes)
				Set CP.strFilterTblName = 'CP_REF_ACC'
				Set CP.strPrintFileName = 'CPI'
				Set CP.fFilterAtStart = TRUE
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				Call SalMapEnterToTab( TRUE )
				! Call SalEnableWindow( pbFilter )
				Call SalWaitCursor(FALSE)
			On UM_Populate
				If F_INS () 
					Call SalWaitCursor(TRUE)
					Set sFilter = cF.GetFilterWhereClause(FALSE)
					!
					Set CP.strSqlPopulate ="
							SELECT ND,DATD,REF,ID,CP_ID,NLS,OST,ACC,S,NLSM,OSTM,MDATE 
							INTO :CP.ND,:CP.DATD,:CP.REF,:CP.ID,:CP.CP_ID,:CP.NLS,:CP.OSTA, 
							     :CP.ACCM,:CP.S, :CP.NLSM, :CP.OSTM, :CP.MDATE 
							FROM (SELECT o.nd,o.datd,o.ref,k.ID,k.cp_id,a.nls,a.ostc/100 ost,
							             c.acc,c.S,c.NLS nlsm, c.OSTC/100 ostm, a.MDATE 
							      FROM oper o, cp_deal e, cp_kod k, accounts a, 
							          (select x.ref, x.S, y.NLS, y.OSTC, y.acc
							           from cp_ref_acc x, 
							                (select acc, nls, ostc from accounts 
							                 where tip ='"|| TIP || "' and accc is not null) y
							            where x.acc=y.acc (+)
							           ) C
							      where o.sos=5 and o.ref=e.ref and e.ryn= "|| Str(nRYN)||" 
							        and a.acc=e.acc and a.ostc < 0 and e.id=k.id 
							        and o.ref = c.REF(+)  ) CP_REF_ACC
							  " || IifS (sFilter=STRING_Null,""," WHERE "|| sFilter ) || "
							 ORDER BY REF desc"
					Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
					Call SalTblPopulate(hWndForm, hSql(), CP.strSqlPopulate, TBL_FillAll )
					Call SalTblSetContext(hWndForm, 0)
					Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
					Call SalWaitCursor(FALSE)
			! On SAM_TblDoDetails
				                          Call SalEnableWindow( pbRepo )
				                          If PF = 3
					                          Call SalDisableWindow( pbRepo )
				                          Else 
					                          If CP_REPO  != '1'
						                          Call SalDisableWindow( pbRepo )
	!
	Form Window: BR0 ! Управление баз.ставками по бронированию средств на сч.ХО
		Class: cGenericTableFrm
		Property Template:
		Class DLL Name:
		Title: Управление баз.ставками по бронированию средств на сч.ХО
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.275"
				Top:    0.344"
				Width:  16.7"
				Width Editable? Class Default
				Height: 6.31"
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 14
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Добавить новую запись'
							If nPar = 0
								Call SalDisableWindow( pbIns )
						On SAM_Click
							Call SalSendMsg( hWndLost, UM_Insert, 0, 0 )
				Pushbutton: pbDel
					Class Child Ref Key: 15
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Пометить/Снять пометку на удаление'
							If nPar = 0
								Call SalDisableWindow( pbDel )
						On SAM_Click
							Call SalSendMsg( hWndLost, UM_Delete, 0, 0 )
				Pushbutton: pbRefresh
					Class Child Ref Key: 16
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 17
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Внести изменения в Базу Данных'
							If nPar = 0
								Call SalDisableWindow( pbUpdate )
						On SAM_Click
							Call SalSendMsg( hWndLost, UM_Update, 0, 0)
				Line
					Resource Id: 20298
					Class Child Ref Key: 18
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 19
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 20
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 21
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 22
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 20299
					Class Child Ref Key: 23
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 24
					Class ChildKey: 0
					Class: cGenericTableFrm
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 20300
					Class Child Ref Key: 25
					Class ChildKey: 0
					Class: cGenericTableFrm
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			!
			Child Table: tbl
				Class Child Ref Key: 1
				Class ChildKey: 0
				Class: cGenericTableFrm
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  9.017"
						Width Editable? Class Default
						Height: 2.012"
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? Class Default
				Contents
					Column: BR_ID
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								баз.ст.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.817"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование
								базовой ставки
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.133"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: BR_TYPE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								типа.ст.
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.9"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_Validate
								If BR_TYPE != 3 and BR_TYPE !=6 OR BR_TYPE=NUMBER_Null
									Set BR_TYPE = nTmp
							On SAM_SetFocus
								If BR_TYPE = NUMBER_Null
									Set BR_TYPE = 3
								Set nTmp = BR_TYPE
					Column: NAME_T
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование
								типа ставки
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  3.383"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Set BR0.strSqlDelete = "delete from BRATES where BR_ID = :BR0.tbl.BR_ID "
						Set BR0.strSqlInsert = "insert into BRATES (BR_ID, BR_TYPE, NAME) values (:BR0.tbl.BR_ID,:BR0.tbl.BR_TYPE,:BR0.tbl.NAME) "
						Set BR0.strSqlUpdate = "update BRATES set NAME = :BR0.tbl.NAME, BR_TYPE = :BR0.tbl.BR_TYPE where BR_ID = :BR0.tbl.BR_ID "
						Call SalSendClassMessage(SAM_Create, 0, 0)
					On SAM_CreateComplete
						If nPar = 0
							Call SalDisableWindow( tbl.NAME )
							Call SalDisableWindow( tbl.BR_TYPE )
						Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
					On UM_Populate
						Call SalWaitCursor(TRUE)
						Set BR0.strSqlPopulate =
								"SELECT BR_ID, BR_TYPE, NAME
								 into :BR0.tbl.BR_ID,:BR0.tbl.BR_TYPE,:BR0.tbl.NAME
								 FROM  BRATES WHERE BR_ID >50000  and BR_TYPE =3
								 ORDER BY BR_ID "
						Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						Call SalTblPopulate(hWndForm, hSql(), BR0.strSqlPopulate, TBL_FillAll )
						Set nRow = VisTblFindString (tbl, 0, tbl.BR_ID, Str(nSch))
						If nRow=-1
							Call SalTblSetContext( hWndForm, 0 )
						Else
							Call SalTblSetContext ( hWndForm, nRow )
							Call SalTblSetRowFlags( hWndForm, nRow, ROW_Selected, TRUE )
							Call SalTblSetFocusRow( hWndForm, nRow )
						Call SalSendMsg( hWndForm, SAM_TblDoDetails, 0, 0 )
						Call SalWaitCursor(FALSE)
					On SAM_TblDoDetails
						Set nSch=tbl.BR_ID
						Call SalSendMsg( tbl2, UM_Populate, 0, 0 )
						Call SalSendMsg( tbl3, UM_Populate, 0, 0 )
					On SAM_SetFocus
						If nPar = 1
							Call SalEnableWindow( pbIns )
							Call SalEnableWindow( pbDel )
					On SAM_KillFocus
						Set hWndLost = BR0.tbl
					On UM_Update
						Call SalWaitCursor(TRUE)
						!
						Call SqlPrepare( hSql(), BR0.strSqlDelete)
						Call SalTblDoDeletes( BR0.tbl, hSql(),ROW_MarkDeleted)
						!
						Call SqlPrepare( hSql(), BR0.strSqlInsert)
						Call SalTblDoInserts( BR0.tbl, hSql(), TRUE)
						!
						Call SqlPrepare( hSql(), BR0.strSqlUpdate)
						Call SalTblDoUpdates( BR0.tbl, hSql(), TRUE)
						!
						Call SqlCommit(hSql())
						! Call SalPostMsg( BR0.tbl, UM_Populate, 0, 0)
						Call SalSendMsg(BR0.tbl, UM_Populate, 0, 0)
						Call SalWaitCursor(FALSE)
					On UM_Insert
						If not SalTblAnyRows( BR0.tbl, ROW_New, 0)
							Call SalTblDefineSplitWindow( BR0.tbl, 1, TBL_Split_Adjustable)
						Set nRow = SalTblInsertRow( BR0.tbl, TBL_MinRow)
						Call SalTblSetContext( BR0.tbl, nRow)
						If SqlPrepareAndExecute( hSql(),
								"select min(c.num) into :tbl.BR_ID from conductor c where c.num not in (select BR_ID from brates)")
								and SqlFetchNext( hSql(),nFetchRes)
							Set nSch = tbl.BR_ID
						Call SalTblSetFocusCell( BR0.tbl, nRow,  BR0.tbl.NAME, 0, 1)
					On UM_Delete
						Set nRow = TBL_MinRow
						While SalTblFindNextRow( BR0.tbl, nRow, ROW_Selected, 0)
							If NOT SalTblQueryRowFlags( BR0.tbl, nRow, ROW_New)
								Call SalTblSetRowFlags(BR0.tbl, nRow, ROW_MarkDeleted,
										     not SalTblQueryRowFlags(BR0.tbl, nRow, ROW_MarkDeleted))
							Else
								Call SalTblDeleteRow( BR0.tbl, nRow, TBL_NoAdjust)
			!
			Custom Control: cVSpl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitter
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Yes
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cHSpl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalHSplitter
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			!
			Child Table: tbl2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.133"
						Top:    2.333"
						Width:  9.05"
						Width Editable? Yes
						Height: 2.393"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? Yes
				Contents
					Column: BDATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата начала
								действия
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Date/Time
						Justify: Center
						Width:  1.517"
						Width Editable? Yes
						Format: Date
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								If BDATE = DATETIME_Null
									Set BDATE = GetBankDate()
					Column: KV
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								вал
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.35"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								If KV = NUMBER_Null
									Set KV = GetBaseVal()
					Column: S
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Сумма "верхняя",
								включитильно, в "коп"
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  2.4"
						Width Editable? Yes
						Format: #0
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								If S = NUMBER_Null
									Set S = 999999999999
					Column: RATE
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Значение проц.
								ставки
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  2.917"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								If RATE = NUMBER_Null
									Set RATE = 0
					Column: RI
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: RowID
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: String
						Justify: Right
						Width:  2.917"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
							On SAM_SetFocus
								If RATE = NUMBER_Null
									Set RATE = 0
				Functions
				Window Variables
					String: strSqlPopulate2
					String: strSqlDelete2
					String: strSqlInsert2
					String: strSqlUpdate2
				Message Actions
					On SAM_Create
						Set strSqlPopulate2=
								"SELECT rowid, BDATE, KV, S, RATE  INTO :RI, :BDATE, :KV, :S, :RATE
								 FROM BR_TIER WHERE BR_ID=:nSch order by BDATE,S,KV "
						Set strSqlDelete2='DELETE FROM BR_TIER WHERE BR_ID=:nSch and rowid=:RI '
						Set strSqlInsert2='INSERT INTO BR_TIER (BR_ID,BDATE,KV,S,RATE) values (:nSch,:BDATE,:KV,:S,:RATE)'
						Set strSqlUpdate2='UPDATE BR_TIER
								    SET RATE=:RATE, s=:S, kv=:KV, BDATE=:BDATE where BR_ID=:nSch and rowid=:RI '
						!
					On SAM_CreateComplete
						If nPar = 0
							Call SalDisableWindow( tbl2.BDATE )
							Call SalDisableWindow( tbl2.KV )
							Call SalDisableWindow( tbl2.S )
							Call SalDisableWindow( tbl2.RATE )
						Call SalSendMsg( BR0.tbl2, UM_Populate, 0, 0 )
					On UM_Populate
						Call SalWaitCursor(TRUE)
						Call SalTblDefineSplitWindow( BR0.tbl2, 0, FALSE)
						Call SalTblPopulate( BR0.tbl2, hSql(), strSqlPopulate2, TBL_FillAll)
						Call SalWaitCursor(FALSE)
					On SAM_SetFocus
						If nPar = 1
							Call SalEnableWindow( pbIns )
							Call SalEnableWindow( pbDel )
					On SAM_KillFocus
						Set hWndLost = BR0.tbl2
					On UM_Update
						Call SalWaitCursor(TRUE)
						!
						Call SqlPrepare( hSql(), strSqlDelete2)
						Call SalTblDoDeletes( BR0.tbl2, hSql(),ROW_MarkDeleted)
						!
						Call SqlPrepare( hSql(), strSqlInsert2)
						Call SalTblDoInserts( BR0.tbl2, hSql(), TRUE)
						!
						Call SqlPrepare( hSql(), strSqlUpdate2)
						Call SalTblDoUpdates( BR0.tbl2, hSql(), TRUE)
						!
						Call SqlCommit(hSql())
						! Call SalPostMsg( BR0.tbl2, UM_Populate, 0, 0)
						Call SalSendMsg(BR0.tbl2, UM_Populate, 0, 0)
						Call SalWaitCursor(FALSE)
					On UM_Insert
						If not SalTblAnyRows( BR0.tbl2, ROW_New, 0)
							Call SalTblDefineSplitWindow( BR0.tbl2, 3, TBL_Split_Adjustable)
						Set nRow = SalTblInsertRow( BR0.tbl2, TBL_MinRow)
						Call SalTblSetContext( BR0.tbl2, nRow)
						Call SalTblSetFocusCell( BR0.tbl2, nRow,  BR0.tbl2.BDATE, 0, 1)
					On UM_Delete
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
							If NOT SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
								Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted,
										     not SalTblQueryRowFlags(hWndForm, nRow, ROW_MarkDeleted))
							Else
								Call SalTblDeleteRow(hWndForm, nRow, TBL_NoAdjust)
					! On SAM_FetchRowDone
						                                                                                                                                                                                                                                                                                                                                               Call tbl2.colFreqn.SetSelectById( tbl2.colFreq )
					! On SAM_DoubleClick
						                                                                                                                                                                                                                                                                                                                                               If tbl2.IDD != NUMBER_Null
							                                                                                                                                                                                                                                                                                                                                               Call SalModalDialog(dlgCalendar, hWndForm, tbl.NMK, tbl2.colNlsA,
									tbl2.IDD, tbl2.colFreq, tbl2.colDat1, tbl2.colDat2, tbl2.WEND, tbl2.colFreqn )
			!
			Child Table: tbl3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   9.283"
						Top:    -0.036"
						Width:  5.4"
						Width Editable? Yes
						Height: 4.702"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 2000
					Discardable? Yes
				Contents
					Column: BRANCH
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
								Branch
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: BRANCH_NAME
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование
								Branch
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  2.217"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: OTM
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Включить/
								Исключить
						Visible? Yes
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  Default
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Check Box
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value: 1
								Uncheck Value: 0
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: F_UPD
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
						Actions
							Call SalWaitCursor( TRUE )
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(BR0.tbl3, nRow, ROW_Edited, 0)
								Call SalTblSetContext(BR0.tbl3, nRow)
								If NOT SqlPrepareAndExecute( hSql(),"delete from br_branch where branch=:BRANCH and BR=:nSch " )
									Return FALSE
								!
								If BR0.tbl3.OTM = 1
									If NOT SqlPrepareAndExecute( hSql(),"insert into br_branch(branch,br) values (:BRANCH,:nSch) " )
										Return FALSE
							!
							Return TRUE
				Window Variables
					String: strSqlPop
				Message Actions
					On SAM_Create
						! Set strSqlPop =
								"SELECT a.tobo, a.name, decode(b.br,null,0,1)
								 INTO :BR0.tbl3.BRANCH, :BR0.tbl3.BRANCH_NAME, :BR0.tbl3.OTM
								 FROM br_branch b, tobo a
								 WHERE a.tobo=b.branch (+) and :nSch = b.BR (+) "|| sTOBO ||"
								 order by a.tobo"
						Set strSqlPop =
								"SELECT a.tobo, a.name, decode(b.br,null,0,1)
								 INTO :BR0.tbl3.BRANCH, :BR0.tbl3.BRANCH_NAME, :BR0.tbl3.OTM
								 FROM br_branch b, tobo a
								 WHERE a.tobo=b.branch (+) and :nSch = b.BR (+) "||
								IifS (nPar=0," and a.tobo='"||aTOBO ||"'",sTOBO) || "
								 order by a.tobo"
					On SAM_CreateComplete
						If nPar = 0
							Call SalDisableWindow( tbl3 )
						Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
					On UM_Populate
						Call SalWaitCursor(TRUE)
						Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
						Call SalTblPopulate(hWndForm, hSql(), strSqlPop, TBL_FillAll )
						Call SalWaitCursor(FALSE)
					On SAM_SetFocus
						If nPar = 1
							Call SalDisableWindow( pbIns )
							Call SalDisableWindow( pbDel )
					On SAM_KillFocus
						Set hWndLost = BR0.tbl3
					On UM_Update
						If tbl3.F_UPD()
							Call SqlCommit( hSql())
						Else
							Call SqlRollback( hSql())
						Call SalSendMsg(BR0.tbl3, UM_Populate, 0, 0)
			!
		Functions
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Window Handle: hWndLost
			Number: nRow
			Number: nSch
			Number: nTmp
		Message Actions
			On SAM_Create
				Call PrepareWindowEx(hWndForm)
				! Call SetWindowFullSize(hWndForm)
				Call SalShowWindow(cVSpl)
				Call SalShowWindow(cHSpl)
				!
				Call cVSpl.setBarPosition(600)
				Call cVSpl.setLeftFrame(cHSpl)
				Call cVSpl.setRightFrame(tbl3)
				!
				Call cHSpl.setBarPosition(500)
				Call cHSpl.setTopFrame(tbl)
				Call cHSpl.setBottomFrame(tbl2)
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
	Table Window: BR1
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Брон.средств на сч.ХО
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.163"
				Top:    0.479"
				Width:  21.6"
				Width Editable? Class Default
				Height: 6.512"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.702"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Открыть Новый договор с Клиентом '
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Удалить новый договор с Клиентом '
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Просмотреть счета по договору'
						On SAM_Click
							If not SalIsNull(ACRA)
								Set sTmp=" a.acc in ("||Str(ACC)||","||Str(ACRA) ||")"
							Else
								Set sTmp=" a.acc ="||Str(ACC)
							Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_ReadOnly | AVIEW_AllOptions, sTmp )
				Pushbutton: pbKAZ
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.183"
						Top:    0.155"
						Width:  0.433"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\K.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = "Просмотреть казначейскую заявку"
						On SAM_Click
							If not IsWindow(hWin24)
								Set hWin24 = SalCreateWindow( BRK, hWndMDI,24,0, " "," " )
							Else
								Call SalBringWindowToTop ( hWin24 )
				!
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						! On SAM_Create
							                                                                                                                                                                                                                                                                                                                           Set strTip = 'Печать договора '
						! On SAM_Click
							! Call PrintFAKTORData()
				Pushbutton: pb_Kli ! Паспорт клиента
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.083"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Book.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Паспорт Клиента (просмотр)'
						On SAM_Click
							If RNK >0
								Call EditCustCorps( RNK,CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
				Pushbutton: pb_PUSTO
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.483"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\FORMULA.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Line
					Resource Id: 20301
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.75"
						Begin Y:  -0.012"
						End X:  5.783"
						End Y:  0.405"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 20302
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.183"
						Begin Y:  0.071"
						End X:  4.183"
						End Y:  0.536"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 20303
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbDoc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.183"
						Top:    0.155"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Tomail.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Документы договора'
						On SAM_Click
							Call Print_RTF ()
							! Call cdoc_ShowAllDocs(ND, hWndForm)
				Pushbutton: pb_All
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOCS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Просмотреть архив договоров '
							If nPar = 9
								Call SalHideWindow( pb_All )
						On SAM_Click
							Call SalCreateWindow( BR1, hWndMDI,26,9, "","" )
				! Frame
.winattr
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   7.083"
						Top:    0.071"
						Width:  1.4"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Raised-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
.end
				! ctb_pbExecute: pb_Nach
					                                                                                                                                                                                                                                                                                                                 Message Actions
				! ctb_pbExecute: pb_Vypl
					                                                                                                                                                                                                                                                                                                                 Message Actions
						                                                                                                                                                                                                                                                                                                                 On SAM_Create
							                                                                                                                                                                                                                                                                                                                 Set strTip =
									'Капитализация % за бронь по закрывающимся '||
									SalFmtFormatDateTime( bDat, 'dd.MM.yyyy' )|| ' договорам'
							                                                                                                                                                                                                                                                                                                                 If nPar != 4
								                                                                                                                                                                                                                                                                                                                 Call SalDisableWindow( pb_Vypl )
						                                                                                                                                                                                                                                                                                                                 On SAM_Click
				Frame
					Resource Id: 20304
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   6.883"
						Top:    0.071"
						Width:  9.3"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Radio Button: rb1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Ввод,Корр
					Window Location and Size
						Left:   7.083"
						Top:    0.155"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nPar = 1
							Call F_Start ()
				Radio Button: rb2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Согласование
					Window Location and Size
						Left:   8.783"
						Top:    0.155"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nPar = 2
							Call F_Start ()
				Radio Button: rb3
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Активация
					Window Location and Size
						Left:   10.683"
						Top:    0.155"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nPar = 3
							Call F_Start ()
				Radio Button: rb4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Сопровожнение
					Window Location and Size
						Left:   12.383"
						Top:    0.155"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nPar = 4
							Call F_Start ()
				Radio Button: rb9
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Анализ
					Window Location and Size
						Left:   14.383"
						Top:    0.155"
						Width:  1.5"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_Click
							Set nPar = 9
							Call F_Start ()
		Contents
			Column: TOBO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						Branch
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.85"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = TOBO
					On SAM_AnyEdit
						Set TOBO = sTmpE
			Column: INSP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						инсп
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						сост
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.783"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sSOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сост
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.167"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OTM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Согл
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.933"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						If nPar     =1 and SOS =  0 and BRO_OB ='0' and F_VISA2()
						Else If nPar=1 and SOS =  0 and BRO_OB ='1' and F_VISA6()
						Else If nPar=2 and SOS =  2 and F_VISA6()
						Else If nPar=3 and SOS =  6 and F_VISA10()
						Else If nPar=4 and SOS = 10 and F_VISA15()
						Else
							Set OTM =0
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
						!
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рег№
						клиента
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.783"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_RNK()
					On SAM_SetFocus
						Set nTmpE = RNK
					On SAM_AnyEdit
						Set RNK = nTmpE
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование
						клиента
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.65"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_RNK()
					On SAM_SetFocus
						Set sTmpE = NMK
					On SAM_AnyEdit
						Set NMK = sTmpE
			Column: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Идент.
						Договора
				Visible? Yes
				Editable? Yes
				Maximum Data Length: 20
				Data Type: String
				Justify: Left
				Width:  1.183"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						Дог
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.867"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmpE = ND
					On SAM_AnyEdit
						Set ND = nTmpE
			Column: DAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						 Нач
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.183"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_DAT()
					On SAM_KillFocus
						Call F_DAT()
			Column: DAT4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						кон
						включит.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.2"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_DAT()
					On SAM_KillFocus
						Call F_DAT()
			Column: DNI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дней
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						вал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.583"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If nPar = 1 and (SOS = NUMBER_Null or SOS = 0) and RNK != NUMBER_Null
							Set sTmp = STRING_Null
							Call FunNSIGetFiltered
									("ACCOUNTS","NLS",
									    " ACCOUNTS.rnk="||Str(RNK)|| 
									" and ACCOUNTS.dazs is null and ACCOUNTS.pap=2 and ACCOUNTS.nbs in ('2600','2603','2650') 
									  and ACCOUNTS.branch like sys_context('bars_context','user_branch')||'%'  
									  and ACCOUNTS.acc in (select acc from int_accn where id=1) ", sTmp, NLS)
							If sTmp != STRING_Null
								If SqlPrepareAndExecute( hSql(),
										"SELECT tobo, kv, ACC, ostc/100 into :TOBO, :KV, :ACC, :OSTC from accounts where acc="|| sTmp )
										and SqlFetchNext(hSql(), nFetchRes)
								If ND != NUMBER_Null
									Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE )
					On SAM_SetFocus
						Set sTmpE = NLS
					On SAM_AnyEdit
						Set NLS = sTmpE
			Column: OSTC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Текущая
						остаток
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: IR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Согл.
						% ст
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.633"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_IR()
					On SAM_KillFocus
						Call F_IR()
			Column: IR0
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тек.
						% ст
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.633"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: IR1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Бонус
						% ст
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.771"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: LIMIT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Неснижаемый
						остаток
						по Договору
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If LIMIT = NUMBER_Null
							Set LIMIT = 0
			!
			Column: LIM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Неснижаемый
						остаток
						фактический
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.35"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If LIMIT = NUMBER_Null
							Set LIMIT = 0
			Column: SUMP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Бонус
						Сумма 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.9"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: ACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACRA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACRA
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TXT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS8
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет
						нач%
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.333"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpE = NLS8
					On SAM_AnyEdit
						Set NLS8 = sTmpE
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						Нач+Выпл
						бонуса
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.329"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If REF > 0
							Call DocViewContentsEx(hWndForm, REF )
					On SAM_SetFocus
						Set nTmpE = REF
					On SAM_AnyEdit
						Set REF = nTmpE
		Functions
			Function: F_RNK
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If nPar = 1 and ( SOS = NUMBER_Null or SOS = 0 )
						Set sTmp = STRING_Null
						Call FunNSIGetFiltered
								("CUSTOMER","NMK",
								 " CUSTOMER.rnk in 
								(select a.rnk from V_GL a, int_accn i 
								 where a.acc=i.acc and i.id=1 and a.pap=2 and a.nbs in ('2600','2603','2650')  and a.dazs is null ) ", sTmp,NMK)
						If sTmp != STRING_Null
							Set RNK=Val(BR1.sTmp)
							If ND = NUMBER_Null
								Set DAT1=BR1.bDat
								Set INSP=BR1.nUser
								Set LIMIT = 0
							Else
								Call SalTblSetRowFlags( hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE )
						Call F_NLS()
			Function: F_NLS
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If SOS = NUMBER_Null or SOS = 0
						Set NLS = SalStrTrimX( NLS )
						If KV != NUMBER_Null and NLS != STRING_Null and RNK != NUMBER_Null
							If SqlPrepareAndExecute( hSql(),
									"SELECT tobo,ACC, ostc/100 into :TOBO,:ACC, :OSTC from accounts
									 where kv=:KV and nls=:NLS and dazs is null and rnk=:RNK ")
									and SqlFetchNext(hSql(), nFetchRes)
							Else
								Set ACC = NUMBER_Null
			Function: F_DAT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If DAT4 < DAT1 and DAT1 != DATETIME_Null and DAT4 != DATETIME_Null
						Call SalMessageBox("Дата-начала БОЛЬШЕ Даты-завершения",
								"Внимание, ошибка !", MB_IconStop)
						Set DAT4 = DAT1
					Set DNI = DAT4 - DAT1
			Function: F_IR
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: IRK_
					Number: DNI_
				Actions
					If BR1.SOS=0 or BR1.SOS=2 or BR1.SOS= NUMBER_Null
						If KV = NUMBER_Null OR IR = NUMBER_Null
								OR DNI = NUMBER_Null OR DNI < 1
								OR DAT1=DATETIME_Null OR DAT4=DATETIME_Null OR DAT1 >= DAT4
							Set IR = NUMBER_Null
							Return FALSE
						If BRO_OB = '1' 
							Set IRK_ = 100
						Else
							If SqlPrepareAndExecute( hSql(),
									"select dni, ir into :DNI_,:IRK_ from br_kaz
									 where kv=:KV and fdat=:bDat and ir is not null and DNI>=:DNI
									 order by dni" )
									and not SqlFetchNext(hSql(), nFetchRes)
								Call SalMessageBox("Ставка Не установлена казначейством ",
										"Внимание, ошибка !", MB_IconStop)
								Set IR = NUMBER_Null
								Return FALSE
						!
						If IR > IRK_
							Call SalMessageBox("Ставка="|| Str(IR)|| "
									БОЛЬШЕ максимально-допустимой=" || Str(IRK_),
									"Внимание, ошибка !", MB_IconStop)
							Set IR = NUMBER_Null
							Return FALSE
					!
					Return TRUE
			Function: F_VISA2
				Description: На согласование. Ничего не происходит, только cc_deal.sos= 2
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nLim
					String: sTxt
				Actions
					Set sTxt =
							"Передача на согласование неснижаемого остатка по сч." ||NLS||"/"||Str(KV)||
							" на сумму="||SalNumberToStrX( LIMIT, 2 )
					If OTM = 1
						If SqlPLSQLCommand(hSql(),"BRO.Visa( ND, LIMIT, IR, 2 ) " ) and SqlCommitEx(hSql(),sTxt  )
							Return TRUE
						Else
							Call SalMessageBox("Не успешная передача на согласование !",
									"Передача невозможна !", MB_IconStop)
							Call SqlRollback( hSql() )
					Return FALSE
			Function: F_VISA6
				Description: Установка лимита
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nLim
					String: sTxt
				Actions
					Set sTxt =
							"Установка неснижаемого остатка по сч." ||NLS||"/"||Str(KV)||
							" на сумму="||SalNumberToStrX( LIMIT, 2 )
					If OTM = 1 and LIMIT > 0 and IR > 0
							and SalMessageBox("Внимание !
							" || sTxt ,
							"Договор согласован ?", MB_IconQuestion | MB_YesNo) = IDYES
						If SqlPLSQLCommand(hSql(),"BRO.Visa( ND, LIMIT, IR,6 ) " ) and SqlCommitEx(hSql(),sTxt  )
							Return TRUE
						Else
							Call SalMessageBox("Не успешное блокирование счета !",
									"Согласование невозможно !", MB_IconStop)
							Call SqlRollback( hSql() )
					Return FALSE
			Function: F_VISA10
				Description: Установка ставки
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nInt
					! String: sInt
					Number: nBr
					Number: nLim
					Number: nL99
					Number: nIr0
					String: sTxt
					String: sBr
					String: sName
					String: sDetali
					Boolean: FL
					Date/Time: dDat4
				Actions
					Set sTxt =
							"Установка ставки брони="|| Str(IR)||"% по сч." ||NLS||"/"||Str(KV)
					If OTM = 1 and IR != NUMBER_Null
							and SalMessageBox("Внимание !
							" || sTxt ,
							"Окончательный ввод в действие ?", MB_IconQuestion | MB_YesNo) = IDYES
						If SqlPLSQLCommand(hSql(),"BRO.Visa( ND, LIMIT, IR,10 ) " ) 
								and SqlCommitEx(hSql(),sTxt  )
							Return TRUE
					Return FALSE
			Function: F_VISA15
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nLim
					Number: nBr
					String: sTxt
					String: sTxt2
					Date/Time: BDAT
					String: sSqli
					Number: nSos
					!
					String: sDetali
					String: sSqld
					!
					Number: n5000
				Actions
					If DAT4 >= bDat
						Set sTxt = "Аннулирование БПС и неснижаемого остатка по сч." ||NLS||"/"||Str(KV)
						Set sTxt2 = "Д О С Р О Ч Н О Е ! "
					Else
						!
						Set sTxt ="Прекращение действия БПС и неснижаемого остатка по сч." ||NLS||"/"||Str(KV)
						Set sTxt2 = "Нормальное"
					If NOT ( OTM = 1  and SalMessageBox("Внимание !
							" || sTxt , sTxt2||" Завершение действия договора ?", MB_IconQuestion | MB_YesNo) = IDYES )
						Return FALSE
					If SqlPLSQLCommand(hSql(),"BRO.Visa( ND, LIMIT, IR,15 ) " ) and SqlCommitEx(hSql(),sTxt  )
						If DAT4 < bDat 
							Call F_Opl()
						Call SalMessageBox( sTxt ,"Договор закрыт !", MB_Ok  )
						Return TRUE
					Return FALSE
			Function: Print_RTF
				Description:
				Returns
					Number:
				Parameters
				Static Variables
				Local variables
					String: sTemplateId
					Long String: sDoc
					: cCnc
						Class: cABSConnect
					: cCnc2
						Class: cABSConnect
				Actions
					If NOT cdoc_SelectDocTemplate( "DOC_SCHEME", "ID", "NAME",
							" ID LIKE 'BRO%' ", sTemplateId )
						Return 0
					If sTemplateId
						Call XConnectGetParams( cCnc )
						If cCnc.Connect() and cCnc2.Clone( cCnc, TRUE )
							Set sDoc=cdoc_CreateDocFromTemplate( cCnc.hSql(), cCnc2.hSql(), sTemplateId,  ND, 0)
							If sDoc
								Call cdoc_ShowDoc(sDoc,TRUE,FALSE)
							Call cCnc.Disconnect()
							Call cCnc2.Disconnect()
			Function: F_Opl
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					!
					String: sNLSB
					String: sMFOB
					String: sNAMB
					String: sTxt1
					Number: nRef
				Actions
					If DAT4 < bDat and SUMP > 0
						If SqlPrepareAndExecute( hSql(),
								  "SELECT  NLSB, MFOB, NAMB    INTO  :sNLSB, :sMFOB, :sNAMB    FROM int_accn
								   WHERE acc=:ACC and id=1 and NLSB is not null and MFOB is not null and NAMB is not null ")
								and NOT SqlFetchNext(hSql(), nFetchRes)
							Set sNLSB= NLS
							Set sMFOB=aMfo
							Set sNAMB=NMK
						!
						Set sTxt1 = "Выполнить начисление и капитализацию %% за броню в сумме "||
								SalNumberToStrX(SUMP,2)||" на счет "|| sNLSB 
						If sNLSB != NLS or sMFOB != aMfo
							Call SalModalDialog(BRP, hWndForm, sNLSB, sMFOB, sNAMB, NLS  , aMfo , NMK )
						If SqlPLSQLCommand(hSql(),"BRO.BONUS( ND, sMFOB, sNLSB, sNAMB, nRef ) " ) and SqlCommitEx(hSql(), sTxt1  )
							Set SUMP=0
							Set REF = nRef
							Call XSalTblSetCellBackColor( REF, COLOR_LightGreen )
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
							Return TRUE
					Return FALSE
			Function: F_Start
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalDisableWindow( BR1.pbIns )
					Call SalDisableWindow( BR1.INSP )
					Call SalDisableWindow( BR1.CC_ID )
					Call SalDisableWindow( BR1.DAT1 )
					Call SalDisableWindow( BR1.DAT4 )
					Call SalDisableWindow( BR1.pbDel )
					Call SalDisableWindow( BR1.pbUpdate )
					If pPar =4
						Call SalEnableWindow( BR1.rb1 )
						Call SalEnableWindow( BR1.rb2 )
						Call SalEnableWindow( BR1.rb3 )
						Call SalEnableWindow( BR1.rb4 )
						Call SalEnableWindow( BR1.rb9 )
					Else
						Call SalDisableWindow( BR1.rb1 )
						Call SalDisableWindow( BR1.rb2 )
						Call SalDisableWindow( BR1.rb3 )
						Call SalDisableWindow( BR1.rb4 )
						Call SalDisableWindow( BR1.rb9 )
					!
					If nPar = 1
						Set sFilter_SOS = strPar01 || " and d.sos>=0  and d.sos < 2  "
						Set BR1.rb1 = TRUE
						Call SalShowWindow( BR1.OTM )
						Set sTitl = "BR1: Брон.средств на сч.ХО: Просмотр,Ввод,Корр"
						If BRO_OB = '1' 
							Call SalTblSetColumnTitle( BR1.OTM, "Согл
									2" )
						Else
							Call SalTblSetColumnTitle( BR1.OTM, "Виза
									1" )
						!
						Call SalEnableWindow( BR1.pbIns )
						Call SalEnableWindow( BR1.INSP )
						Call SalEnableWindow( BR1.CC_ID )
						Call SalEnableWindow( BR1.DAT1 )
						Call SalEnableWindow( BR1.DAT4 )
						Call SalEnableWindow( BR1.pbDel )
						Call SalEnableWindow( BR1.pbUpdate )
					Else If nPar = 2
						Set sFilter_SOS = strPar01 || " and d.sos>=2  and d.sos < 6  "
						Set BR1.rb2 = TRUE
						Call SalShowWindow( BR1.OTM )
						Call SalTblSetColumnTitle( BR1.OTM, "Согл
								2" )
						Set sTitl = "BR2: Брон.средств на сч.ХО: Просмотр, Согласование"
						!
						Call SalEnableWindow( BR1.pbDel )
						Call SalEnableWindow( BR1.pbUpdate )
					Else If nPar = 3
						Set sFilter_SOS = strPar01 || " and d.sos>=6  and d.sos < 10 "
						Set BR1.rb3 = TRUE
						Call SalShowWindow( BR1.OTM )
						Call SalTblSetColumnTitle( BR1.OTM, "Актив
								3" )
						Call SalEnableWindow( BR1.pbDel )
						Call SalEnableWindow( BR1.pbUpdate )
						Set sTitl = "BR3: Брон.средств на сч.ХО: Просмотр, Активация"
					Else If nPar = 4
						Set sFilter_SOS = "and d.sos>=10 and d.sos < 14 "
						Set BR1.rb4 = TRUE
						Call SalShowWindow( BR1.OTM )
						Call SalTblSetColumnTitle( BR1.OTM, "Завершить
								4" )
						Set sTitl = "BR4: Брон.средств на сч.ХО: Просмотр, Сопровожнение БО"
					Else If nPar = 9
						Set sFilter_SOS = strPar01 || " and d.sos>=0  and d.sos <=15 "
						Set BR1.rb9 = TRUE
						Call SalHideWindow( BR1.OTM )
						Set sTitl = "BR9: Брон.средств на сч.ХО: Просмотр, Анализ"
					If BRO_OB = '1'
						Call SalDisableWindow( BR1.rb2 )
					!
					Call SalSetWindowText( hWndForm, sTitl || '/'|| strPar01 )
					Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
		Window Parameters
			Number: nMode ! 26-полный доступ, 27-доступ по ТОБО
			Number: pPar
			! = 1 Просмотр,Ввод,Корр.
			String: strPar01 !! предустановл фильтр
			String: strPar02
		Window Variables
			Number: nPar
			String: aMfo
			Number: n980
			Date/Time: bDat
			Number: nTmp
			String: sTmp
			String: sFilter_SOS
			String: sSql
			Number: nUser
			! Number: ACRA
			String: sFilter
			String: sTitl
			String: sInt
			String: sFilter_Pr
			Number: nPorogB
			! cDoc: cDoc
.winattr class :
				Class: cDoc
.end
			Number: nTmpE
			String: sTmpE
			Date/Time: dTmpE
		Message Actions
			On SAM_Create
				Set nPar= pPar
				If SalStrTrimX( strPar02 ) = ''
					Set nPorogB = 150000
				Else
					Set nPorogB = Val( SalStrTrimX( strPar02 ))
				! nPar =
						   1 Просмотр + ввод + коррекция + улаление + виза1
						   2 Просмотр + коррекция (LIM,BR)+ улаление + Согласование(виза2)-Установка accounts.LIM
						   3 Просмотр + Активация-виза3. Установка ставки.
						   4 Просмотр + БЄК-оф функции
						   9 Просмотр
				Set aMfo = GetBankMfo()
				Set BR1.nTabInstance = 1
				Set BR1.strPrintFileName = 'BR'||Str(nPar)
				Set BR1.strFilterTblName = 'BR1'
				Set bDat = GetBankDate()
				Set n980 = GetBaseVal()
				!
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns( hWndForm, 15 )
				Set nUser = GetUserId()
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				Call F_Start ()
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				Set sSql =
						"SELECT BR1.INSP, BR1.SOS, BR1.RNK, BR1.NMK, BR1.CC_ID, BR1.ND, BR1.DAT1,
						        BR1.DAT4, BR1.KV,  BR1.NLS, BR1.ACC, BR1.LIMIT, BR1.IR, BR1.OSTC, BR1.TOBO,
						        BR1.LIM , ar.ACC, AR.NLS, substr(t.txt,1,16), BR1.DNI,
						        acrn.fprocn ( BR1.ACC,1,:bDat) IR0
						 INTO  :hWndForm.BR1.INSP,:hWndForm.BR1.SOS,  :hWndForm.BR1.RNK,
						       :hWndForm.BR1.NMK, :hWndForm.BR1.CC_ID,:hWndForm.BR1.ND,
						       :hWndForm.BR1.DAT1,:hWndForm.BR1.DAT4, :hWndForm.BR1.KV,
						       :hWndForm.BR1.NLS, :hWndForm.BR1.ACC,  :hWndForm.BR1.LIMIT,
						       :hWndForm.BR1.IR,  :hWndForm.BR1.OSTC, :hWndForm.BR1.TOBO,
						       :hWndForm.BR1.LIM ,:hWndForm.BR1.ACRA, :hWndForm.BR1.NLS8,
						       :hWndForm.BR1.TXT, :hWndForm.BR1.DNI,  :hWndForm.BR1.IR0 
						 FROM (SELECT d.SOS , 
						              d.RNK, c.NMK, d.CC_ID, d.ND, d.user_id INSP, 
						              d.sdate DAT1, d.wdate DAT4, d.wdate-d.sdate DNI,
						              accounts.KV, accounts.NLS, accounts.ACC, d.LIMIT,  accounts.ostc/100 OSTC,
						              d.IR, accounts.TOBO, -accounts.lim/100 LIM
						       FROM cc_deal d, customer c, V_GL accounts, nd_acc n
						       WHERE n.nd=d.nd
						         and n.acc = accounts.acc and d.vidd = 26 and d.rnk=c.rnk " || sFilter_SOS  || " 
						       ) BR1,  
						      (select * from accounts where tip ='BRO' ) ar ,  
						      (select * from nd_txt where  tag = 'KNL' ) t
						 WHERE BR1.ND = t.nd (+) and BR1.rnk = ar.rnk (+) " || IifS (sFilter="", ""," and "|| sFilter ) || "
						 ORDER BY BR1.ND desc "
				! Set sSql =
						"SELECT BR1.INSP, BR1.SOS, BR1.RNK, BR1.NMK, BR1.CC_ID, BR1.ND, BR1.DAT1,
						        BR1.DAT4, BR1.KV,  BR1.NLS, BR1.ACC, BR1.LIMIT, BR1.IR, BR1.OSTC, BR1.TOBO,
						        BR1.LIM , BR1.ACRA, AR.NLS, substr(t.txt,1,16), BR1.DNI,
						        acrn.fprocn ( BR1.ACC,1,:bDat) IR0
						 INTO  :hWndForm.BR1.INSP,:hWndForm.BR1.SOS,  :hWndForm.BR1.RNK,
						       :hWndForm.BR1.NMK, :hWndForm.BR1.CC_ID,:hWndForm.BR1.ND,
						       :hWndForm.BR1.DAT1,:hWndForm.BR1.DAT4, :hWndForm.BR1.KV,
						       :hWndForm.BR1.NLS, :hWndForm.BR1.ACC,  :hWndForm.BR1.LIMIT,
						       :hWndForm.BR1.IR,  :hWndForm.BR1.OSTC, :hWndForm.BR1.TOBO,
						       :hWndForm.BR1.LIM ,:hWndForm.BR1.ACRA, :hWndForm.BR1.NLS8,
						       :hWndForm.BR1.TXT, :hWndForm.BR1.DNI,  :hWndForm.BR1.IR0 
						 FROM (SELECT d.SOS , 
						              d.RNK, c.NMK, d.CC_ID, d.ND, d.user_id INSP, 
						              d.sdate DAT1, d.wdate DAT4, d.wdate-d.sdate DNI,
						              accounts.KV, accounts.NLS, accounts.ACC, d.LIMIT,  accounts.ostc/100 OSTC,
						              d.IR, accounts.TOBO, -accounts.lim/100 LIM,
						              i.ACRA
						       FROM cc_deal d, customer c, V_GL accounts, nd_acc n, int_accn i
						       WHERE accounts.acc=i.acc and i.id=1 and n.nd=d.nd
						         and n.acc = accounts.acc and d.vidd = 26 and d.rnk=c.rnk " || sFilter_SOS  || " 
						       ) BR1,    V_GL AR,  (select * from nd_txt where  tag = 'KNL' ) t
						 WHERE BR1.ND = t.nd (+) and ar.acc=BR1.ACRA " || IifS (sFilter="", ""," and "|| sFilter ) || "
						 ORDER BY BR1.ND desc "
				! Set sSql =
						"SELECT BR1.INSP, BR1.SOS, BR1.RNK, BR1.NMK, BR1.CC_ID, BR1.ND, BR1.DAT1,
						        BR1.DAT4, BR1.KV,  BR1.NLS, BR1.ACC, BR1.LIMIT, BR1.IR, BR1.OSTC, BR1.TOBO,
						        BR1.LIM , BR1.ACRA, AR.NLS, substr(t.txt,1,16), BR1.DNI,
						        acrn.fprocn ( BR1.ACC,1,:bDat) IR0
						 INTO  :hWndForm.BR1.INSP,:hWndForm.BR1.SOS,  :hWndForm.BR1.RNK,
						       :hWndForm.BR1.NMK, :hWndForm.BR1.CC_ID,:hWndForm.BR1.ND,
						       :hWndForm.BR1.DAT1,:hWndForm.BR1.DAT4, :hWndForm.BR1.KV,
						       :hWndForm.BR1.NLS, :hWndForm.BR1.ACC,  :hWndForm.BR1.LIMIT,
						       :hWndForm.BR1.IR,  :hWndForm.BR1.OSTC, :hWndForm.BR1.TOBO,
						       :hWndForm.BR1.LIM ,:hWndForm.BR1.ACRA, :hWndForm.BR1.NLS8,
						       :hWndForm.BR1.TXT, :hWndForm.BR1.DNI,  :hWndForm.BR1.IR0 
						 FROM (SELECT decode( 1,"|| BRO_OB ||", decode(d.SOS,0,2,d.SOS) ) SOS , 
						              d.RNK, c.NMK, d.CC_ID, d.ND, d.user_id INSP, 
						              d.sdate DAT1, d.wdate DAT4, d.wdate-d.sdate DNI,
						              accounts.KV, accounts.NLS, accounts.ACC, d.LIMIT,  accounts.ostc/100 OSTC,
						              d.IR, accounts.TOBO, -accounts.lim/100 LIM, i.ACRA
						       FROM cc_deal d, customer c, V_GL accounts, nd_acc n, int_accn i
						       WHERE accounts.acc=i.acc and i.id=1 and n.nd=d.nd
						         and n.acc = accounts.acc and d.vidd = 26 and d.rnk=c.rnk " || sFilter_SOS  || " 
						       ) BR1,    V_GL AR,  (select * from nd_txt where  tag = 'KNL' ) t
						 WHERE BR1.ND = t.nd (+) and ar.acc=BR1.ACRA " || IifS (sFilter="", ""," and "|| sFilter ) || "
						 ORDER BY BR1.ND desc "
				Call SalTblPopulate(hWndForm, hSql(), BR1.sSql, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On UM_Update
				Set nRow = TBL_MinRow
				While SalTblFindNextRow(hWndForm, nRow,
						 ROW_New | ROW_Edited | ROW_MarkDeleted , 0)
					Call SalTblSetContext(hWndForm, nRow)
					! Insert
					If SalTblQueryRowFlags( hWndForm, nRow, ROW_New )
							 and hWndForm.BR1.ND   = NUMBER_Null
							 and hWndForm.BR1.ACC != NUMBER_Null
							 and hWndForm.BR1.RNK != NUMBER_Null
						If SqlPLSQLCommand(hSql(),"BRO.Ins1( ND, ACC, CC_ID, DAT1, DAT4, LIMIT, IR, INSP ) " ) 
							If SqlCommitEx( hSql(), "Введен Дог на бр.ср "||Str(ND) )
					! Update
					Else If SalTblQueryRowFlags( hWndForm, nRow, ROW_Edited )
							and hWndForm.BR1.ND != NUMBER_Null
							and (hWndForm.BR1.SOS=0 or hWndForm.BR1.SOS=2 )
							and hWndForm.BR1.ACC != NUMBER_Null and hWndForm.BR1.RNK != NUMBER_Null
						If SqlPLSQLCommand(hSql(),"BRO.Upd1( ND, ACC, CC_ID, DAT1, DAT4, LIMIT, IR, INSP ) " ) 
							If SqlCommitEx( hSql(), "Изменен Дог на бр.ср "||Str(ND) )
					! Delete
					Else If SalTblQueryRowFlags( hWndForm, nRow, ROW_MarkDeleted ) 
							and ND != NUMBER_Null and ( SOS=0 or SOS=2 or SOS=6 )
						If SqlPLSQLCommand(hSql(),"BRO.Del1( ND )  " ) 
							If SqlCommitEx( hSql(), "Удален Дог на бр.ср "||Str(ND)  )
				!
				Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
			On SAM_FetchRowDone
				If BR1.DAT4 < bDat
					Call XSalTblSetCellBackColor( BR1.DAT4, SalColorFromRGB( 255,210,210 ) )
				If OSTC < LIMIT
					! Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Salmon )
					Call XSalTblSetCellBackColor( BR1.OSTC, COLOR_Salmon )
					Call XSalTblSetCellBackColor( BR1.LIMIT, SalColorFromRGB( 230,255,230 ) )
				!
				If SOS = NUMBER_Null or SOS=0
					Set sSOS = "Новый"
				Else If SOS=2
					Set sSOS = "Передан"
				Else If SOS=6
					Set sSOS = "Согласован"
				Else If SOS=10
					Set sSOS = "Активирован"
				Else If SOS=15
					Set sSOS = "Завершен"
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
				Else If SOS=14
					Set sSOS = "Досрочно закр"
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
				Set sSOS = Str(SOS)||' '|| sSOS
				If SOS >= 2 and nPar=1
						OR SOS >= 6 and nPar=2
						OR SOS >= 10 and nPar=3
					Set OTM = 1
				If TXT != STRING_Null
					Set SUMP = Val(TXT)/100
				If SOS=14
					Call XSalTblSetCellBackColor( sSOS, SalColorFromRGB( 255,210,210 ) )
				If IR >=0 
					Set IR1 = IR - IR0
			On SAM_TblDoDetails
	Table Window: BRK
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Заявка казначейства на ресурсы и его цену
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.163"
				Top:    0.479"
				Width:  17.267"
				Width Editable? Class Default
				Height: 6.512"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.512"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pb_Pred
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\REP_JOIN.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Дублировать заявки предыдущего дня'
						On SAM_Click
							If SqlPrepareAndExecute( hSql(),
									"insert into BR_KAZ( FDAT, KV, S_min, s_max, DNI, IR, pap)
									   select           :bDat, KV, S_min, s_max, DNI, IR, pap
									   from BR_KAZ
									   where FDAT = (select max(FDAT) from BR_KAZ where FDAT < :bDat )
									     and (:bDat,KV,DNI,PAP) not in (select FDAT,KV,DNI,PAP from BR_KAZ ) " )
								Call SqlCommit(hSql())
								Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.283"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Просмотреть договора портфеля выбранной строки'
						On SAM_Click
							Call Sel027(hWndMDI,26,9,
									" and to_char(d.sdate,'yyyyMMdd')='"|| yyyyMMdd ||"' and accounts.kv="||Str(KV),
									" ")
				Pushbutton: pb_All
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.783"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\DOCS.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Просмотреть все действующие договора портфеля'
						On SAM_Click
							Call Sel027(hWndMDI,26,9," and d.sos<14 "," ")
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
				Line
					Resource Id: 20305
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  5.75"
						Begin Y:  -0.012"
						End X:  5.783"
						End Y:  0.405"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 20306
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  4.183"
						Begin Y:  0.071"
						End X:  4.183"
						End Y:  0.536"
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Line
					Resource Id: 20307
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.183"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_DAT()
					On SAM_KillFocus
						Call F_DAT()
					On SAM_SetFocus
						If FDAT = DATETIME_Null
							Set FDAT = bDat
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						вал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.583"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_KV ()
			Column: NAM_VAL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Валюта
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_KV ()
			Column: S_MIN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Min
						сумма
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.9"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_SUM()
					On SAM_KillFocus
						Call F_SUM()
			Column: S_MAX
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Max
						сумма
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.017"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_SUM()
					On SAM_KillFocus
						Call F_SUM()
			Column: DNI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: MAX
						дней
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: IR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Max
						% ст
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.033"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S_FAKT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						фактич
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.017"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Call F_SUM()
					On SAM_KillFocus
						Call F_SUM()
			Column: I_FAKT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Срд.
						взв.
						% ст
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
				! List Values
				! Message Actions
			Column: T_FAKT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Срд-
						взв.
						срок
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_KV ()
			Column: KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол-во
						дог
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.717"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_KV ()
			Column: DKOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кол-во
						доср.
						расторг.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.833"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_KV ()
			!
			Column: RI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Rowid
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						Call F_KV ()
			Column: yyyyMMdd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ---
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_DAT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If FDAT < bDat
						Set FDAT = bDat
			Function: F_KV
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set sTmp = STRING_Null
					Call FunNSIGetFiltered
							("TABVAL","NAME",
							  " D_CLOSE is null ",sTmp,NAM_VAL)
					If sTmp != STRING_Null
						Set KV=Val(sTmp)
			Function: F_SUM
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If S_MIN != NUMBER_Null and  S_MAX != NUMBER_Null and S_MIN>S_MAX
						Call SalMessageBox("Min-Сумма БОЛЬШЕ Max-Суммы",
								"Внимание, ошибка !", MB_IconStop)
						Set S_MAX = S_MIN
		Window Parameters
			Number: nMode
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			String: sSql
			String: aMfo
			Number: n980
			Date/Time: bDat
			String: sTmp
			String: sFilter_SOS
			Number: nUser
			Number: ACRA
			String: sFilter
			Number: nMod_Int
			Date/Time: FDAT0
			Number: DNI0
			Number: KV0
		Message Actions
			On SAM_Create
				Set BRK.nTabInstance = 1
				Set BRK.strPrintFileName = 'BRK'
				! Set BRK.strFilterTblName = 'BRK'
				!
				Set aMfo = GetBankMfo()
				Set BRK.bDat = GetBankDate()
				Set n980 = GetBaseVal()
				Set nUser = GetUserId()
				!
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Call SalTblSetLockedColumns( hWndForm, 7 )
				Set BRK.sSql =
						"select to_char(b.FDAT,'yyyyMMdd'),
						      b.FDAT, b.KV, b.S_MIN, b.S_MAX, b.DNI, b.IR, t.NAME, b.RI
						 INTO :BRK.yyyyMMdd, :BRK.FDAT, :BRK.KV,
						      :BRK.S_MIN, :BRK.S_MAX, :BRK.DNI, :BRK.IR, :BRK.NAM_VAL, :BRK.RI
						 from (SELECT FDAT, KV, S_min, S_max, DNI, IR, rowid RI
						       from BR_KAZ  where pap=2  order by FDAT desc, kv desc, dni) b,
						       tabval t
						 where B.kv=t.kv and rownum<101 "
				Set BRK.strSqlInsert =
						"insert into BR_KAZ(FDAT,KV,S_min,s_max, DNI, IR, pap) values
						   (:BRK.FDAT,:BRK.KV,:BRK.S_MIN,:BRK.S_MAX, :BRK.DNI, :BRK.IR,2)"
				Set BRK.strSqlDelete =
						"delete from BR_KAZ where fdat>= :BRK.bDat
						  and FDAT=:BRK.FDAT and KV=:BRK.KV and dni=:BRK.DNI and pap=2 "
				Set BRK.strSqlUpdate =
						"update BR_KAZ set s_min=:BRK.S_MIN, s_max=:BRK.S_MAX, dni=:BRK.DNI, ir=:BRK.IR, kv=:BRK.KV
						  where fdat>= :BRK.bDat and rowid= :BRK.RI "
				Set FDAT0= bDat-1000
				Set DNI0= 0
				Set KV0=0
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				If nPar = 0
					Call SalHideWindow( BRK.pbIns )
					Call SalHideWindow( BRK.pbUpdate )
					Call SalHideWindow( BRK.pbDel )
					Call SalHideWindow( BRK.pbDetails )
				Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Call SalTblPopulate(hWndForm, hSql(), BRK.sSql, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If BRK.FDAT < bDat
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray )
				If FDAT0 != FDAT or KV0 != KV
					Set DNI0 = 0
					Set FDAT0 = FDAT
					Set KV0 = KV
				If SqlPrepareAndExecute( hSqlAux2(),
						"select Nvl(sum(d.LIMIT),0), count(*),
						  decode (Nvl(sum(d.limit),0),0,0,
						          Round(sum(d.limit*d.ir)/sum(d.limit),4)),
						  decode (Nvl(sum(d.limit),0),0,0,
						          Round(sum(d.limit*(d.wdate-d.sdate))/sum(d.limit),0))
						 into :S_FAKT, :KOL, :I_FAKT, :T_FAKT
						 from cc_deal d, nd_acc n, accounts a
						 where d.vidd=26 and d.sdate=:FDAT and d.nd=n.nd
						   and n.acc=a.acc and a.kv=:KV and d.sos<>14 and
						   (d.wdate-d.sdate) > :DNI0 and (d.wdate-d.sdate) <= :DNI " )
						and  SqlFetchNext( hSqlAux2(), nFetchRes)
				If SqlPrepareAndExecute( hSqlAux2(),
						"select count(*) into :DKOL
						 from cc_deal d, nd_acc n, accounts a
						 where d.vidd=26 and d.sdate=:FDAT and d.nd=n.nd
						   and n.acc=a.acc and a.kv=:KV and d.sos=14 and
						   (d.wdate-d.sdate) > :DNI0 and (d.wdate-d.sdate) <= :DNI " )
						and  SqlFetchNext( hSqlAux2(), nFetchRes)
				If DKOL >0
					Call XSalTblSetCellBackColor( DKOL, SalColorFromRGB( 255,210,210 ) )
				!
				Set DNI0 = DNI
	Dialog Box: BRP
		Class:
		Property Template:
		Class DLL Name:
		Title: Уточнить пл.инструкции для капитализации %%
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   0.625"
				Top:    0.625"
				Width:  8.8"
				Width Editable? Yes
				Height: 3.81"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			!
			Radio Button: rb2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: На другой счет
				Window Location and Size
					Left:   0.286"
					Top:    0.594"
					Width:  3.3"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 12
				Font Enhancement: Bold
				Text Color: Dark Red
				Background Color: Default
				Message Actions
			Radio Button: rb1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: На основной счет
				Window Location and Size
					Left:   0.286"
					Top:    1.656"
					Width:  3.3"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 12
				Font Enhancement: Bold
				Text Color: Midnight Blue
				Background Color: Default
				Message Actions
			!
			Data Field: MFO2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.786"
						Top:    0.573"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: NLS2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.786"
						Top:    0.573"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: NMS2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    0.905"
						Width:  7.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Data Field: MFO1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.786"
						Top:    1.656"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: NLS1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.786"
						Top:    1.656"
						Width:  2.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Data Field: NMS1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.286"
						Top:    1.99"
						Width:  7.9"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Midnight Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Выполнить
				Window Location and Size
					Left:   2.886"
					Top:    2.49"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.476"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Enter
				Font Name: Arial Cyr
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						If rb1
							Set sNLSB= NLS
							Set sMFOB=aMfo
							Set sNAMB=sNms
						Call SalEndDialog(hWndForm, 1)
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отказаться
				Window Location and Size
					Left:   4.086"
					Top:    2.49"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.476"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Esc
				Font Name: Arial Cyr
				Font Size: Default
				Font Enhancement: Default
				Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Gray
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, 0)
		Functions
		Window Parameters
			Receive String: sNLSB
			Receive String: sMFOB
			Receive String: sNAMB
			!
			String: NLS
			String: aMfo
			String: sNms
			! SalModalDialog(BRP, hWndForm, sNLSB, sMFOB, sNAMB, NLS  , aMfo , NMK )
		Window Variables
		Message Actions
			On SAM_Create
				Set rb2  = TRUE
				Set rb1  = FALSE
				!
				Set MFO2 = sMFOB
				Set NLS2 = sNLSB
				Set NMS2 = sNAMB
				!
				Set MFO1 = aMfo
				Set NLS1 = NLS
				Set NMS1 = sNms
				!
				Call SalCenterWindow(hWndForm)
