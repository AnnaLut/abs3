.head 0 +  Application Description: ! BARS000.APD - Dynalib
! BARS000.APL - Для всякого барахла...
! ООО Унити-Барс  ( C )  1996-2002
! Разработчик: Марценюк М.П.
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000B30000 002C000000030000 0003000000000000 00CF010000F8FFFF
0040: FFE2FFFFFF000000 0000000000230300 00E3010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F77730C6672
0080: 6D5F417578456E74 6572
.enddata
.data DT_MAKERUNDLG
0000: 0200000000001E71 3A5C626172733938 5C6C696272617279 5C524547434C4E45
0020: 582E646C6C1E713A 5C6261727339385C 6C6962726172795C 524547434C4E4558
0040: 2E61706300000101 011E713A5C626172 7339385C6C696272 6172795C52454743
0060: 4C4E45582E72756E 1E713A5C62617273 39385C6C69627261 72795C524547434C
0080: 4E45582E646C6C1E 713A5C6261727339 385C6C6962726172 795C524547434C4E
00A0: 45582E6170630000 010101175C424152 5339385C42494E5C 626172733030302E
00C0: 617064175C424152 5339385C42494E5C 70726F636170692E 646C6C175C424152
00E0: 5339385C42494E5C 70726F636170692E 6170630000010101 001E713A5C626172
0100: 7339385C6C696272 6172795C52454743 4C4E45582E646C6C 1E713A5C62617273
0120: 39385C6C69627261 72795C524547434C 4E45582E61706300 00010101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0818B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  Dynalib: Absapi.apd
.head 2 -  Dynalib: Global.apd
.head 2 -  Dynalib: Message.apd
.head 2 -  Dynalib: Nsiapi.apd
.head 2 -  Dynalib: Docview.apd
.head 2 -  Dynalib: CC_DOC.APD
.head 2 -  Dynalib: BARS021.APD
.head 2 -  Dynalib: Bars012.apd
.head 2 -  Dynalib: OTCN.APD
.head 2 -  !
.head 2 -  File Include: Genfcls.apl
.head 2 -  File Include: Genbutn.apl
.head 2 -  File Include: Gentbl.apl
.head 2 -  File Include: Gentbl.apl
.head 2 -  File Include: Genlist.apl
.head 2 -  File Include: Genlabel.apl
.head 2 -  File Include: Winapi.apl
.head 2 -  !
.head 2 -  ! File Include: Docfun6.apl
.head 2 -  File Include: Vtmeter.apl
.head 2 -  File Include: Vttblwin.apl
.head 2 -  File Include: Vtarray.apl
.head 2 -  File Include: Vtcomm.apl
.head 2 -  File Include: Vtsplit.apl
.head 2 -  File Include: Vtcal.apl
.head 2 -  File Include: Vtfile.apl
.head 2 -  File Include: Vtmsgbox.apl
.head 2 -  File Include: DOCWIS6.APL
.head 2 -  File Include: vtdos.apl
.head 2 -  File Include: XSALSPL.APL
.head 2 -  File Include: XSALCPT.APL
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: dd-MM-yy
.head 3 -  Date/Time: dd/MM/yyyy
.head 3 -  Number: ###00000
.head 3 -  Number: ###00000
.head 3 -  Number: 00000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Number: #000
.head 3 -  Input: 9
.head 3 -  Date/Time: dd-mm hhh:mm
.head 3 -  Date/Time: dd-MM-yyyy
.head 3 -  Date/Time: d
.head 3 -  Number: 000
.head 3 -  Date/Time: dd.MM.yyyy
.head 3 -  Date/Time: dd.MM.yyyy hh:mm:ss
.head 3 -  Date/Time: dd/MM/yyyy hh:mm:ss
.head 3 -  Input: DateTime
.head 3 -  Date/Time: dd-MM hhhh:mm
.head 2 +  External Functions
.head 3 +  Library name: LZPACK.DLL
.head 4 +  Function: LzPack
.head 5 -  Description:
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  String: LPSTR
.head 6 -  String: LPSTR
.head 6 -  String: LPSTR
.head 3 +  Library name: DbfSign.dll
.head 4 +  Function: SignProc
.head 5 -  Description: /**
 * Наложение/снятие внутр. ЭЦП НБУ на DBF файлы аля moper.dbf
 * @param  [in]  szOption - опция "put" или "check" - накладывать или снимать ЭЦП
 * @param  [in]  szFilename - путь к DBF файлу
 * @param  [in]  szKey - имя секретного ключа, может быть NULL или ""
 * @param  [out] szErrMsg - буфер сообщения об ошибках
 * @param  [in]  nErrMsgSize - размер буфера сообщения об ошибках (не меньше 4096 байт)
 * @return 0 - Ok, иначе - код ошибки (описание см. в параметре szErrMsg)
 */
int DBFSIGN_DECL SignProc(
			const char* szOption,
			const char* szFilename,
			const char* szKey,
			char*       szErrMsg,
			int         nErrMsgSize
)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  String: LPCSTR
.head 6 -  String: LPCSTR
.head 6 -  String: LPCSTR
.head 6 -  Receive String: LPSTR
.head 6 -  Number: INT
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 4 -  Number: ID_Ok = 0
.head 4 -  Number: ID_Yes = 1
.head 4 -  Number: ID_No = 2
.head 2 +  Resources
.head 2 +  Variables
.head 3 -  Boolean: bApdInited
.head 3 -  !
.head 3 -  Window Handle: hWin0
.head 3 -  Window Handle: hWin1
.head 3 -  Window Handle: hWin5
.head 3 -  Window Handle: hWin6
.head 3 -  Window Handle: hWin7
.head 3 -  Window Handle: hWin8
.head 3 -  Window Handle: hWin9
.head 3 -  Window Handle: hWin10
.head 3 -  Window Handle: hWin11
.head 3 -  Window Handle: hWin111
.head 3 -  Window Handle: hWin13
.head 3 -  Window Handle: hWin14
.head 3 -  Window Handle: hWin15
.head 3 -  Window Handle: hWin16
.head 3 -  Window Handle: hWin17
.head 3 -  Window Handle: hWin18
.head 3 -  Window Handle: hWin21
.head 3 -  Window Handle: hWin22
.head 3 -  Window Handle: hWin25
.head 3 -  Window Handle: hWin26
.head 3 -  Window Handle: hWin27
.head 3 -  Window Handle: hWndFormReserv
.head 3 -  Window Handle: hWin29
.head 3 -  Window Handle: hWin30
.head 3 -  Window Handle: hWin31
.head 3 -  Window Handle: hWin32
.head 3 -  Window Handle: hWin33
.head 3 -  Window Handle: hWin34
.head 3 -  Window Handle: hWin37
.head 3 -  !
.head 3 -  Number: nFetchRes
.head 3 -  Number: nResult
.head 3 -  !
.head 3 -  Date/Time: dOt
.head 3 -  Date/Time: dDo
.head 2 +  Internal Functions
.head 3 +  Function: Ini000
.head 4 -  Description: инициализация библиотеки
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strPathToLangResources
.head 5 -  String: strLangId
.head 5 -  String: strFileName
.head 4 +  Actions
.head 5 +  If not bApdInited
.head 6 -  Set strPathToLangResources = GetLangPath()
.head 6 -  Set strLangId = GetLang()
.head 6 -  Set strFileName = strPathToLangResources || "\\" ||
    strLangId || "\\bars000.lng"
.head 6 +  If (not strLangId) or (not
   CurrentLangTable.InitFromFile(strFileName, strLangId))
.head 7 -  Call CurrentLangTable.Init()
.head 6 -  Call DocWisInit( '' )
.head 6 -  Set bApdInited = TRUE
.head 5 -  Return bApdInited
.head 3 +  Function: Sel000	! __exported
.head 4 -  Description: Bars000_Selector
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nMode
.head 5 -  Number: nPar
.head 5 -  String: strPar01
.head 5 -  String: strPar02
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: s1
.head 5 -  String: s2
.head 5 -  String: sFilter
.head 5 -  : cncParamsX
.head 6 -  Class: cABSConnect
.head 5 -  : cncParams
.head 6 -  Class: cParams
.head 4 +  Actions
.head 5 -  Call Ini000()
.head 5 +  Select Case nMode
.head 6 +  Case 0
.head 7 +  If not IsWindow(hWin0)
.head 8 -  Set hWin0 = SalCreateWindow(frm_Acc4EK, hWndParent)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(frm_Acc4EK)
.head 7 -  Break
.head 6 +  Case 1
.head 7 +  If not IsWindow(hWin1)
.head 8 -  Set hWin1 = SalCreateWindow(frm_Acc4IK, hWndParent)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(frm_Acc4IK)
.head 7 -  Break
.head 6 +  Case 2
.head 7 -  Call SalModalDialog(dlg_ImpFil8, hWndParent)
.head 7 -  Break
.head 6 +  Case 3
.head 7 -  Call FunNSIGetFiltered('OKKKLOWK', '', sFilter, s1, s2)
.head 7 -  Break
.head 6 +  Case 4
.head 7 -  ! Set sFilter = 'eom=' || Str(GetUserId())
.head 7 -  ! Set sFilter = ''
.head 7 -  Call FunNSIGetFiltered('OKKKLOOK', '', sFilter, s1, s2)
.head 7 -  Break
.head 6 +  Case 5
.head 7 +  If not IsWindow(hWin5)
.head 8 -  Set hWin5 = SalCreateWindow(buch_a_b, hWndParent)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(buch_a_b)
.head 7 -  Break
.head 6 +  Case 6
.head 7 +  If not IsWindow(hWin6)
.head 8 -  Set hWin6 = SalCreateWindow(T_SQL, hWndParent)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(hWin6)
.head 7 -  Break
.head 6 +  Case 7
.head 7 +  If not IsWindow(hWin7)
.head 8 -  Set hWin7 = SalCreateWindow(abonKB, hWndParent)
.head 7 +  ! Else
.head 8 -    Call SalBringWindowToTop(hWin7)
.head 7 -  Break
.head 6 +  Case 8
.head 7 +  If SqlPrepareAndExecute(hSql(), T('
   DELETE
   FROM custcount'))
.head 8 -  Call SqlCommitEx(hSql(), 'Произведена очистка ' ||
     'CUSTCOUNT (для КЛИЕНТ-БАНК SBB).')
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Call MessageNoWait('Ошибка при очистке ' ||
     'CUSTCOUNT (для КЛИЕНТ-БАНК). Выясните причину '
     || ' и повторите вызов функции.', 'СООБЩЕНИЕ',
     0, 1)
.head 7 -  Break
.head 6 +  Case 9
.head 7 +  If not IsWindow(hWin9)
.head 8 -  Set hWin9 = SalCreateWindow(JN, hWndParent,nPar)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(hWin9)
.head 7 -  Break
.head 6 +  Case 10
.head 7 +  If not IsWindow(hWin10)
.head 8 -  Set hWin10 = SalCreateWindow(frmPolKB, hWndParent)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(hWin10)
.head 7 -  Break
.head 6 +  Case 11 !! Доввод доп. реквизитов ( вся таблица)
.head 7 +  If not IsWindow(hWin11)
.head 8 -  Set hWin11 =  SalCreateWindow(frm_AuxReenter, hWndParent, strPar01, strPar02 )
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(hWin11)
.head 7 -  Break
.head 6 +  Case 111 !! Доввод доп. реквизитов ( один РЕФ)
.head 7 +  If not IsWindow(hWin111)
.head 8 -  Set hWin111 =  SalCreateWindow(frm_AuxEnter, hWndMDI, nPar, strPar01 )
.head 8 -  ! nPar = REF , strPar01 = доп.фильтр на доп рекв
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(hWin111)
.head 7 -  Break
.head 6 +  ! Case 12
.head 7 -  Call SalModalDialog(IbisZN, hWndNULL)
.head 7 -  Break
.head 6 +  Case 13 !! Кориг.проводки по нал учету
.head 7 +  If not IsWindow(hWin13)
.head 8 -  Set hWin13 = SalCreateWindow(Zo8, hWndParent, nPar)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(hWin13)
.head 7 -  Break
.head 6 +  Case 14 !! Расчет норм резервирования по КредПортфелю ЮЛ
.head 7 +  If not IsWindow(hWin14)
.head 8 -  Set hWin14 = SalCreateWindow(frm_ViewRisk, hWndParent, hSql(),nPar, strPar01, strPar02 )
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(frm_ViewRisk)
.head 7 -  Break
.head 6 +  ! Case 15 !! Анализ клиентов
.head 7 +   If not IsWindow(hWin15)
.head 8 -   Set hWin15 = SalCreateWindow(AN, hWndParent, nPar, strPar01, strPar02 )
.head 7 +   Else
.head 8 -   Call SalBringWindowToTop(AN)
.head 7 -   Break
.head 6 +  Case 16 !! Печать договоров за РКО по Клиент-Банк
.head 7 +  ! If not IsWindow(hWin16)
.head 8 -  Set hWin16 = SalCreateWindow(frm_CustKBD, hWndParent, strPar01 )
.head 7 +  ! Else
.head 8 -  Call SalBringWindowToTop(frm_CustKBD)
.head 7 -  Break
.head 6 +  Case 17 !! Разбор реестров от прямых участников (ANNY - 21/02/2002)
.head 7 +  If not IsWindow(hWin17)
.head 8 -  Set hWin17 = SalCreateWindow(tbl_Reestr, hWndParent)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(tbl_Reestr)
.head 7 -  Break
.head 6 +  Case 18
.head 7 +  If not IsWindow(hWin18)
.head 8 -  Set hWin18 = SalCreateWindow(UPDEK, hWndParent)
.head 7 -  Break
.head 6 +  Case 19 !! Отбор справочника участников СЭП (Казначейство, НБУ)
.head 7 -  Call SalModalDialog(otborS_UCH, hWndForm)
.head 7 -  Break
.head 6 +  Case 20 !! Вызов функций КОШТОРИСА
.head 7 -  Call cncParams.Clear()
.head 7 -  Call XConnectGetParams( cncParamsX )
.head 7 -  Call cncParams.SetAsString( 'DBNAME', cncParamsX.strDBName )
.head 7 -  Call cncParams.SetAsString( 'USER', cncParamsX.strUserName )
.head 7 -  Call cncParams.SetAsString( 'PASS', cncParamsX.strPassword )
.head 7 -  Call Sel021( nPar, hWndNULL, 0, cncParams.GetParams() )
.head 7 -  Break
.head 6 +  Case 21 !! Вызов приема MOPERов
.head 7 -  ! Call SalModalDialog(dlg_ImpMoperi, hWndForm)
.head 7 +  If not IsWindow(hWin21)
.head 8 -  Set hWin21 = SalCreateWindow(frm_ImpMoperi, hWndParent)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(frm_ImpMoperi)
.head 7 -  Break
.head 6 +  Case 22 !! Вызов приема MOPERов КОШТОРИСА от R3
.head 7 -  ! Call SalModalDialog(dlg_ImpMoper3, hWndForm)
.head 7 +  If not IsWindow(hWin22)
.head 8 -  Set hWin22 = SalCreateWindow(frm_ImpMoper3, hWndParent)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(frm_ImpMoper3)
.head 7 -  Break
.head 7 -  Break
.head 6 -  !
.head 6 +  Case 23 !! Вызов экспорта для РЦК (Bars012.apd)
.head 7 -  Call Sel012( hWndMDI, nPar, '', '' )
.head 7 -  Break
.head 6 +  Case 24 !! Вызов лимитов для РЦК (Bars012.apd)
.head 7 -  Call Sel012( hWndMDI, nPar, '', '' )
.head 7 -  Break
.head 6 +  Case 25 !! АРХИВ КБ
.head 7 +  If not IsWindow(hWin25)
.head 8 -  Set hWin25 = SalCreateWindow(AKB2, hWndParent)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(AKB2)
.head 7 -  Break
.head 6 +  Case 26 !! Отбор полного списка загранбанков (ИКТ)
.head 7 +  If not IsWindow(hWin26)
.head 8 -  Set hWin26 = SalCreateWindow(otborSWBANKS, hWndParent)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(otborSWBANKS)
.head 7 -  Break
.head 6 +  Case 27 !! Необработанные документы в нац.валюте от КБ
.head 7 +  If not IsWindow(hWin27)
.head 8 -  Set hWin27 = SalCreateWindow(KLP, hWndParent, nPar)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(KLP)
.head 7 -  Break
.head 6 +  Case 28 !! Экспорт в ХД
.head 7 -  Set nResult =SalModalDialog( dlgExportWH, hWndParent, '', '' )
.head 7 -  Break
.head 6 +  Case 29 !! Импорт кодов пунктов АНЕЛИК
.head 7 +  If not IsWindow(hWin29)
.head 8 -  Set hWin29 = SalCreateWindow(importANELIKcode, hWndParent)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(importANELIKcode)
.head 7 -  Break
.head 6 +  Case 30 !! ХД: История выполнения выгрузки данных
.head 7 +  If not IsWindow(hWin30)
.head 8 -  Set hWin30 = SalCreateWindow(frm_WHHistory, hWndParent)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(frm_WHHistory)
.head 7 -  Break
.head 6 +  Case 31 !! ХД: Переданные данные с ошибками
.head 7 +  If not IsWindow(hWin29)
.head 8 -  Set hWin31 = SalCreateWindow(frm_WHChkList, hWndParent)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(frm_WHChkList)
.head 7 -  Break
.head 6 -  !
.head 6 +  Case 32 !! Приём файлов от R3 в формате XML
.head 7 +  If not IsWindow(hWin32)
.head 8 -  Set hWin32 = SalCreateWindow(R3XML, hWndParent)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(R3XML)
.head 7 -  Break
.head 6 +  Case 33
.head 7 +  If not IsWindow(hWin33)
.head 8 -  Set hWin33 = SalCreateWindow(frm_AccKB, hWndParent)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(frm_AccKB)
.head 7 -  Break
.head 6 +  Case 34
.head 7 +  If not IsWindow(hWin34)
.head 8 -  Set hWin34 = SalCreateWindow(frm_UpdRODO, hWndParent)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(frm_UpdRODO)
.head 7 -  Break
.head 6 +  Case 37 !! Необработанные документы от КБ (SBB)
.head 7 +  If not IsWindow(hWin37)
.head 8 -  Set hWin37 = SalCreateWindow(KLPnotSBB, hWndParent, nPar)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(KLPnotSBB)
.head 7 -  Break
.head 6 +  Default
.head 7 -  Break
.head 3 +  Function: DelRightSpace
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sPar
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sStr
.head 4 +  Actions
.head 5 -  Set sStr = sPar
.head 5 +  Loop
.head 6 +  If Right(sStr, 1) = ' '
.head 7 -  Set sStr = Left(sStr, Len(sStr)-1)
.head 6 +  Else
.head 7 -  Break
.head 5 -  Return sStr
.head 3 +  Function: FindVar2
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  String: sDbf
.head 5 -  String: sRef99bm
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  File Handle: hF
.head 5 -  Number: nI
.head 5 -  String: sTemp
.head 5 -  String: sBuf
.head 5 -  String: sBufOut
.head 5 -  String: s1
.head 5 -  Number: n1
.head 5 -  Number: n2
.head 5 -  Number: n3
.head 5 -  Number: n4
.head 5 -  Number: n
.head 5 -  File Handle: hF2
.head 5 -  Number: nOffsetFirstRecord
.head 5 -  Number: nRecc
.head 5 -  Number: nLengthRecord
.head 5 -  String: sFileName
.head 5 -  Boolean: bnotKASSA
.head 5 -  String: smPole[*]
.head 5 -  Number: nLengthRecordNew
.head 5 -  Number: nFieldCount
.head 5 -  Number: nLocationField
.head 5 -  Boolean: bnotREF
.head 5 -  Number: nErrCode
.head 5 -  String: s0D
.head 5 -  String: sPole
.head 5 -  String: sPtip
.head 5 -  String: sPlen
.head 5 -  String: sPdrb
.head 5 -  String: smPtip[*]
.head 5 -  ! String: sTip
.head 5 -  ! String: sYMD
.head 5 -  String: smPlen[*]
.head 5 -  Number: nmPlen[*]
.head 5 -  String: smPdrb[*]
.head 5 -  Number: nmPdrb[*]
.head 5 -  Number: n0
.head 4 +  Actions
.head 5 +  If SalStrUpperX(Right(sDbf, 4)) != '.DBF'
.head 6 -  Return 4
.head 5 -  !
.head 5 -  ! Call Debug('1')
.head 5 +  If not CheckDbf(sDbf)
.head 6 -  Return 2
.head 5 -  !
.head 5 -  ! Call Debug('2')
.head 5 +  If VisFileOpen(hF, sDbf, OF_Read | OF_Binary) < 0
.head 6 -  Return 1
.head 5 +  Else
.head 6 -  ! прочитать ВСЮ необходимую информация о файле:
.head 6 -  ! 00    : Тип файла                                                sTip
.head 6 -  ! 01-03 : Последнее изменение (ГГММДД)                             sYMD
.head 6 -  ! 04-07 : Число записей в файле                                    nRecc
.head 6 -  ! 08-09 : Положение первой записи с данными                        nOffsetFirstRecord
.head 6 -  ! 10-11 : Длина одной записи с данными (включая признак удаления)  nLengthRecord
.head 6 -  ! 28    : 1-есть структ.составной инд.файл (типа .CDX),0-нет
.head 6 -  ! 32-n  : Подзаписи полей**
.head 6 -  ! n+1   : Признак завершения записи заголовка (0х01)
.head 6 -  ! ------- Подзаписи полей
.head 6 -  ! 00-10 : Название поля (максимально - 10 символов, если :меньше 10, то дополняется пустым символом (0х00))
.head 6 -  ! 11    : Тип данных:
        : C - символьное;
        : N - числовое;
        : L - логическое;
        : M - типа memo;
        : D - дата;
        : F - с плавающей точкой;
        : P - шаблон.
.head 6 -  ! 12-15 : Расположение поля внутри записи
.head 6 -  ! 16    : Длина поля (в байтах)
.head 6 -  ! Call VisFileClose(hF)
.head 6 -  !
.head 6 -  ! Set sTip = ' '
.head 6 -  ! Call VisFileRead(hF, sTip, 1)
.head 6 -  !
.head 6 -  ! Set sYMD = '   '
.head 6 -  ! Call VisFileRead(hF, sYMD, 3)
.head 6 -  !
.head 6 -  Set sTemp = Spac(8)
.head 6 -  Call VisFileRead(hF, sTemp, 8)
.head 6 -  Set s1 = ' '
.head 6 -  Call InsertBuf(s1, 0, sTemp, 4, 1)
.head 6 -  Set n4 = Asc(s1)
.head 6 -  Call InsertBuf(s1, 0, sTemp, 5, 1)
.head 6 -  Set n3 = Asc(s1)
.head 6 -  Call InsertBuf(s1, 0, sTemp, 6, 1)
.head 6 -  Set n2 = Asc(s1)
.head 6 -  Call InsertBuf(s1, 0, sTemp, 7, 1)
.head 6 -  Set n1 = Asc(s1)
.head 6 -  ! Set s1 = ' '
.head 6 -  ! Call VisFileRead(hF, s1, 1)
.head 6 -  ! Set s1 = Chr(4)
.head 6 -  ! Set n4 = SalStrLop(s1)
.head 6 -  ! Set s1 = ' '
.head 6 -  ! Call VisFileRead(hF, s1, 1)
.head 6 -  ! Set n3 = SalStrLop(s1)
.head 6 -  ! Set s1 = ' '
.head 6 -  ! Call VisFileRead(hF, s1, 1)
.head 6 -  ! Set n2 = SalStrLop(s1)
.head 6 -  ! Set s1 = ' '
.head 6 -  ! Call VisFileRead(hF, s1, 1)
.head 6 -  ! Set n1 = SalStrLop(s1)
.head 6 -  Set nRecc = n1*256*256*256 + n2*256*256 + n3*256 + n4
.head 6 -  !
.head 6 -  ! Call Debug('n1 = ' || Str(n1))
.head 6 -  ! Call Debug('n2 = ' || Str(n2))
.head 6 -  ! Call Debug('n3 = ' || Str(n3))
.head 6 -  ! Call Debug('n4 = ' || Str(n4))
.head 6 -  ! Call Debug('nRecc = ' || Str(nRecc))
.head 6 -  !
.head 6 -  Set sTemp = '  '
.head 6 -  Call VisFileRead(hF, sTemp, 2)
.head 6 -  Set s1 = ' '
.head 6 -  Call InsertBuf(s1, 0, sTemp, 0, 1)
.head 6 -  Set n2 = Asc(s1)
.head 6 -  Call InsertBuf(s1, 0, sTemp, 1, 1)
.head 6 -  Set n1 = Asc(s1)
.head 6 -  Set nOffsetFirstRecord = n1*256 + n2
.head 6 -  !
.head 6 -  ! Call Debug('nOffsetFirstRecord = ' || Str(nOffsetFirstRecord))
.head 6 -  !
.head 6 -  Set sTemp = '  '
.head 6 -  Call VisFileRead(hF, sTemp, 2)
.head 6 -  Set s1 = ' '
.head 6 -  Call InsertBuf(s1, 0, sTemp, 0, 1)
.head 6 -  Set n2 = Asc(s1)
.head 6 -  Call InsertBuf(s1, 0, sTemp, 1, 1)
.head 6 -  Set n1 = Asc(s1)
.head 6 -  Set nLengthRecord = n1*256 + n2
.head 6 -  !
.head 6 -  ! Call Debug('nLengthRecord = ' || Str(nLengthRecord))
.head 6 -  !
.head 6 -  Set nI = 0
.head 6 +  Loop
.head 7 -  Call VisFileSeek(hF, nI*32+32, SEEK_Begin)
.head 7 -  Set sBuf = Spac(32)
.head 7 -  Call VisFileRead(hF, sBuf, 32)
.head 7 -  Set s0D = ' '
.head 7 -  Call InsertBuf(s0D, 0, sBuf, 0, 1)
.head 7 +  If s0D = Chr(13)
.head 8 -  Break
.head 7 -  Set smPole[nI] = Spac(10)
.head 7 -  Call InsertBuf(smPole[nI], 0, sBuf, 0, 10)
.head 7 -  Set smPole[nI] = Left(smPole[nI], 10)
.head 7 -  ! Call Debug('smPole[nI] = ' || smPole[nI])
.head 7 -  Set smPtip[nI] = ' '
.head 7 -  Call InsertBuf(smPtip[nI], 0, sBuf, 11, 1)
.head 7 -  ! Call Debug('smPtip[nI] = ' || smPtip[nI])
.head 7 -  Set smPlen[nI] = ' '
.head 7 -  Call InsertBuf(smPlen[nI], 0, sBuf, 16, 1)
.head 7 -  Set nmPlen[nI] = Asc(smPlen[nI])
.head 7 -  Set smPdrb[nI] = ' '
.head 7 -  Call InsertBuf(smPdrb[nI], 0, sBuf, 17, 1)
.head 7 -  Set nmPdrb[nI] = Asc(smPdrb[nI])
.head 7 -  Set nI = nI + 1
.head 6 -  ! nFieldCount - количество полей
.head 6 -  Set nFieldCount = nI
.head 6 -  !
.head 6 -  ! Call Debug('nFieldCount = ' || Str(nFieldCount))
.head 6 -  !
.head 6 +  If Type("NM",    smPole, smPtip) != "N" or Type("DK",   smPole, smPtip) != "N" or
   Type("MFO",   smPole, smPtip) != "N" or Type("ND",   smPole, smPtip) != "C" or
   Type("VOB",   smPole, smPtip) != "N" or Type("NLS",  smPole, smPtip) != "C" or
   Type("NLSK",  smPole, smPtip) != "C" or Type("SK",   smPole, smPtip) != "N" or
   Type("S",     smPole, smPtip) != "N" or Type("DATD", smPole, smPtip) != "D" or
   Type("DA",    smPole, smPtip) != "D" or Type("PLAT", smPole, smPtip) != "C" or
   Type("POLU",  smPole, smPtip) != "C" or Type("NAZ1", smPole, smPtip) != "C" or
   Type("VSPO",  smPole, smPtip) != "C" or Type("KOD",  smPole, smPtip) != "C" or
   Type("KODB",  smPole, smPtip) != "C" or Type("KISP", smPole, smPtip) != "C" or
   Type("SIGN",  smPole, smPtip) != "C" or Type("NS",   smPole, smPtip) != "N" or
   Type("NP",    smPole, smPtip) != "N" or Type("SOS",  smPole, smPtip) != "N" or
   Type("VDATE", smPole, smPtip) != "D"
.head 7 -  Call VisFileClose(hF)
.head 7 -  Return 3
.head 6 -  Set bnotKASSA = Type("KASFIO", smPole, smPtip)="U" or Type("KASDOK", smPole, smPtip)="U" or
    Type("KASSER", smPole, smPtip)="U" or Type("KASNDOK", smPole, smPtip)="U" or Type("KASVID", smPole, smPtip)="U"
.head 6 -  Set bnotREF = Type("REF", smPole, smPtip)="U"
.head 6 -  !
.head 6 -  ! Call Debug('do sRef99bm')
.head 6 -  !
.head 6 +  If Type(SalStrUpperX(sRef99bm), smPole, smPtip) = "N"
.head 7 -  Call VisFileClose(hF)
.head 6 +  Else
.head 7 -  ! добавить в структуру поле REF99BM N,16,0
.head 7 -  ! создать НОВЫЙ временный файл с НОВОЙ структурой (hF2) и переписать туда ВСЮ информацию из файла (hF)
.head 7 -  ! перезаписать файл hF файлом hF2
.head 7 -  Set sFileName = VisFileCreateTemp('Dbf')
.head 7 -  Set nErrCode = VisFileOpen(hF2, sFileName, OF_Write)
.head 7 -  ! Call Debug('sFileName = ' || sFileName)
.head 7 +  If nErrCode = VTERR_Ok
.head 8 -  ! собственно блок перезаписи файла hF2
.head 8 -  Call VisFileSeek(hF, 0, SEEK_Begin)
.head 8 -  Set sBuf = Spac(8)
.head 8 -  Call VisFileRead(hF, sBuf, 8)
.head 8 -  ! перенос 8-ми байт заголовка
.head 8 -  Call VisFileWrite(hF2, sBuf, 8)
.head 8 -  !
.head 8 -  Set sBuf = '  '
.head 8 -  Call VisFileRead(hF, sBuf, 2)
.head 8 -  ! получили положение первой записи с данными, надо добавить 32 для нового поля
.head 8 -  Call InsertBuf(s1, 0, sBuf, 0, 1)
.head 8 -  Set n2 = Asc(s1)
.head 8 -  Call InsertBuf(s1, 0, sBuf, 1, 1)
.head 8 -  Set n1 = Asc(s1)
.head 8 -  Set n3 = n1*256 + n2 + 32
.head 8 -  Set s1 = Chr(Mod(n3, 256))
.head 8 -  Call InsertBuf(sBuf, 0, s1, 0, 1)
.head 8 -  Set s1 = Chr(Int(n3/256))
.head 8 -  Call InsertBuf(sBuf, 1, s1, 0, 1)
.head 8 -  Call VisFileWrite(hF2, sBuf, 2)
.head 8 -  !
.head 8 -  Set sBuf = '  '
.head 8 -  Call VisFileRead(hF, sBuf, 2)
.head 8 -  ! получили длину одной записи с данными (включая признак удаления), надо добавить 16 для нового поля
.head 8 -  Set nLengthRecordNew = nLengthRecord + 16
.head 8 -  Set s1 = Chr(Mod(nLengthRecordNew, 256))
.head 8 -  Call InsertBuf(sBuf, 0, s1, 0, 1)
.head 8 -  Set s1 = Chr(Int(nLengthRecordNew/256))
.head 8 -  Call InsertBuf(sBuf, 1, s1, 0, 1)
.head 8 -  Call VisFileWrite(hF2, sBuf, 2)
.head 8 -  !
.head 8 -  Set sBuf = Spac(20)
.head 8 -  Call VisFileRead(hF, sBuf, 20)
.head 8 -  ! холостое чтение 20 байт и их перенос
.head 8 -  Call VisFileWrite(hF2, sBuf, 20)
.head 8 -  !
.head 8 -  Set nI = 0
.head 8 +  While nI < nFieldCount
.head 9 -  Set sBuf = Spac(32)
.head 9 -  Call VisFileRead(hF, sBuf, 32)
.head 9 -  Call VisFileWrite(hF2, sBuf, 32)
.head 9 -  Set nI = nI + 1
.head 8 -  ! дописываем описание нового поля (REF99BM)
.head 8 -  Set sTemp = 'REF99BM'
.head 8 -  Call InsertBuf(sBuf, 0, sTemp, 0, 7)
.head 8 -  Set sTemp = Chr(0)
.head 8 -  Call InsertBuf(sBuf, 7, sTemp, 0, 1)
.head 8 -  Set sTemp = 'N'
.head 8 -  Call InsertBuf(sBuf, 11, sTemp, 0, 1)
.head 8 -  Set s1 = ' '
.head 8 -  Call InsertBuf(s1, 0, sBuf, 12, 1)
.head 8 -  Set n4 = Asc(s1)
.head 8 -  Call InsertBuf(s1, 0, sBuf, 13, 1)
.head 8 -  Set n3 = Asc(s1)
.head 8 -  Call InsertBuf(s1, 0, sBuf, 14, 1)
.head 8 -  Set n2 = Asc(s1)
.head 8 -  Call InsertBuf(s1, 0, sBuf, 15, 1)
.head 8 -  Set n1 = Asc(s1)
.head 8 -  Call InsertBuf(s1, 0, sBuf, 16, 1)
.head 8 -  Set n0 = Asc(s1)
.head 8 -  Set nLocationField = n1*256*256*256 + n2*256*256 + n3*256 + n4 + n0
.head 8 -  Set n = nLocationField
.head 8 -  Set n1 = Int(n/256/256/256)
.head 8 -  Set n = n - n1*256*256*256
.head 8 -  Set n2 = Int(n/256/256)
.head 8 -  Set n = n - n2*256*256
.head 8 -  Set n3 = Int(n/256)
.head 8 -  Set n = n - n3*256
.head 8 -  Set n4 = n
.head 8 -  Set s1 = Chr(n4)
.head 8 -  Call InsertBuf(sBuf, 12, s1, 0, 1)
.head 8 -  Set s1 = Chr(n3)
.head 8 -  Call InsertBuf(sBuf, 13, s1, 0, 1)
.head 8 -  Set s1 = Chr(n2)
.head 8 -  Call InsertBuf(sBuf, 14, s1, 0, 1)
.head 8 -  Set s1 = Chr(n1)
.head 8 -  Call InsertBuf(sBuf, 15, s1, 0, 1)
.head 8 -  Set s1 = Chr(16)
.head 8 -  Call InsertBuf(sBuf, 16, s1, 0, 1)
.head 8 -  Call VisFileWrite(hF2, sBuf, 32)
.head 8 -  !
.head 8 -  Set s1 = Chr(13)
.head 8 -  Call VisFileWrite(hF2, s1, 1)
.head 8 -  !
.head 8 -  ! запись 00 (на всякий пожарный)
.head 8 -  Set s1 = Chr(0)
.head 8 -  Call VisFileWrite(hF2, s1, 1)
.head 8 -  Call VisFileSeek(hF2, nOffsetFirstRecord+32, SEEK_Begin)
.head 8 -  !
.head 8 -  Call VisFileSeek(hF, nOffsetFirstRecord, SEEK_Begin)
.head 8 -  ! запись записей входного файла
.head 8 -  Set nI = 0
.head 8 -  ! Call Debug('nLengthRecord = ' || Str(nLengthRecord))
.head 8 -  ! Call Debug('nLengthRecordNew = ' || Str(nLengthRecordNew))
.head 8 +  While nI < nRecc
.head 9 -  Set sBuf = Spac(nLengthRecord+1)
.head 9 -  Set sBufOut = Spac(nLengthRecord+16)
.head 9 -  Call VisFileRead(hF, sBuf, nLengthRecord+1)
.head 9 -  ! Call Debug('1 Len(sBuf) = ' || Str(Len(sBuf)))
.head 9 -  ! Set sBuf = sBuf || Spac(16) ! почему-то Spac(16) не подходит
.head 9 -  ! Set sBuf = sBuf || Spac(16)
.head 9 -  Call InsertBuf(sBufOut, 0, sBuf, 0, nLengthRecord)
.head 9 -  ! Call Debug('2 Len(sBuf) = ' || Str(Len(sBuf)))
.head 9 -  ! Call VisFileWrite(hF2, sBuf, nLengthRecordNew)
.head 9 -  ! Call VisFileWrite(hF2, sBuf, Len(sBuf))
.head 9 -  Call VisFileWrite(hF2, sBufOut, nLengthRecord+16)
.head 9 -  Set nI = nI + 1
.head 9 -  Call VisFileSeek(hF, -1, SEEK_Current)
.head 8 -  Set sTemp = Chr(26)
.head 8 -  Call VisFileWrite(hF2, sTemp, 1)
.head 8 -  ! конец
.head 8 -  Call VisFileClose(hF2)
.head 8 -  Call VisFileClose(hF)
.head 8 -  ! Set nErrCode = VisFileCopy(sFileName, sDbf)
.head 8 -  Call VisFileCopy(sFileName, sDbf)
.head 8 -  ! Call Debug('nErrCode = ' || Str(nErrCode))
.head 8 -  Call VisFileDelete(sFileName)
.head 7 +  Else
.head 8 -  Call VisFileClose(hF)
.head 8 -  Return 1
.head 6 -  !
.head 6 -  Return IifN(bnotKASSA, 0, 10) + IifN(bnotREF, 0, 7)
.head 3 +  Function: CheckDbf
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sDbf
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sP
.head 5 -  Number: nP
.head 5 -  File Handle: hF
.head 4 +  Actions
.head 5 +  If VisFileOpen(hF, sDbf, OF_Read) < 0
.head 6 -  ! Call Debug('Файл ' || sDbf || ' не открылся')
.head 6 -  Return FALSE
.head 5 -  Set sP = Spac(32)
.head 5 +  If VisFileRead(hF, sP, 32) != 32
.head 6 -  ! Call Debug('Файл ' || sDbf || ' не прочитались 32 байта')
.head 6 -  Call VisFileClose(hF)
.head 6 -  Return FALSE
.head 5 -  Call VisFileClose(hF)
.head 5 -  Set nP = SalStrLop(sP)
.head 5 -  ! Call DebugN(nP)
.head 5 -  Return nP = 3 or nP = 83
.head 3 +  Function: Type
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sPoleT
.head 5 -  String: smPoleT[*]
.head 5 -  String: smPtipT[*]
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nIndex
.head 4 +  Actions
.head 5 -  Set nIndex = VisArrayFindString(smPoleT, sPoleT)
.head 5 -  ! Call Debug('sPoleT = ' || sPoleT)
.head 5 -  ! Call Debug('nIndex = ' || Str(nIndex))
.head 5 +  If nIndex < 0
.head 6 -  Return 'U'
.head 5 +  Else
.head 6 -  ! Call Debug('smPtipT[nIndex] = ' || smPtipT[nIndex])
.head 6 -  Return smPtipT[nIndex]
.head 5 -  ! Return IifS(nIndex<0, 'U', smPtipT[nIndex])
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 25218691
0000: 37010000A2000000 0000000000000000 0200000200FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F22003C00 000A630047656E46
0040: 696C746500727400 00000400001E0002 0400C10001000000 3F8001F800000037
0060: 040001F00D000000 FF1F110000DC0002 00FF7F1570000000 0100FFFF21018022
0080: 000001C200000B63 47F8444669B30004 00770200F601004F 800100FE008D0400
00A0: 010DFD00FF371100 02F700FFDF15DC00 0100FF7F
.enddata
.head 3 -  ! ---- Для работы с реестрами (ANNY)
.head 3 +  Functional Class: cElKlient
.head 4 -  Description: Класс клиента (для печати реестров)
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Long String: strA[*,15]  ! - - Документы из arc_rrp
.head 5 -  Long String: strB[*,15]  ! - - Документы из dbf
.head 5 -  Number: nACou            ! - - Размерность strA
.head 5 -  Number: nBCou            ! - - Размерность strB
.head 5 -  Number: nASortOrder[*]   ! - - Для сортировки
.head 5 -  Number: nBSortOrder[*]   ! - - Для сортировки
.head 5 -  String: sSab             ! - - SAB клиента
.head 5 -  String: sName            ! - - Наименование клиента
.head 5 -  String: sOkpo            ! - - ОКПО клиента
.head 5 -  ! ************************************************
.head 5 -  ! * Описание массива документа (strA, strB)
! ************************************************
!! -  вторая размерноесть - это присутствие данного номера док-та в dbf файле
!!    [*, 0] - ref_a
!!    [*, 1] - Flag
!!    [*, 2] - strNlsb
!!    [*, 3] - strNlsa
!!    [*, 4] - strMfob
!!    [*, 5] - strSum
!!    [*, 6] - strNd
!!    [*, 7] - strOkpo
!!    [*, 8] - strNameK
!!    [*, 9] - strVob
!!    [*, 10] - сюда ставим номер противоположного массива (напр. strModyPond) если нашли совпадение номеров
!!    [*, 11] -  strNazn
!!    [*, 12] -  strDat (Дата документа)
!!    [*, 13] -   strDat (Дата + время валютирования)
!!    [*, 14] -   strDat (Дата + время валютирования)
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description: Инициализация класса
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sName_
.head 7 -  String: sOkpo_
.head 7 -  String: sSab_
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set sSab  = sSab_
.head 7 -  Set sName = sName_
.head 7 -  Set sOkpo = sOkpo_
.head 5 +  Function: Clear
.head 6 -  Description: Инициализация класса
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nACou = 0
.head 7 -  Set nBCou = 0
.head 5 +  Function: StrToStrFormat
.head 6 -  Description: !! Превращает строку в строку заданной длины (nLen) - дополняя впереди символом
.head 6 +  Returns
.head 7 -  String: strVal
.head 6 +  Parameters
.head 7 -  String: sVal
.head 7 -  Number: nLen
.head 7 -  String: strChar
.head 7 -  Boolean: bAlign ! - -  true = right,   false = left
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: i
.head 7 -  String: strRet
.head 6 +  Actions
.head 7 -  Set i = Len(sVal)
.head 7 -  Set strRet = sVal
.head 7 +  While i < nLen
.head 8 +  If bAlign
.head 9 -  Set strRet = strChar || strRet
.head 8 +  Else
.head 9 -  Set strRet =strRet || strChar
.head 8 -  Set i = i + 1
.head 7 -  Return strRet
.head 5 +  Function: F_pond
.head 6 -  Description: F(pond, sSab) = ref_a
.head 6 +  Returns
.head 7 -  String: sRef_a
.head 6 +  Parameters
.head 7 -  String: pond
.head 7 -  String: sSab
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sTmp
.head 7 -  String: sRet
.head 7 -  Number: nAsci1
.head 7 -  Number: nAsci2
.head 6 +  Actions
.head 7 -  Call SalStrUpper(Right(sSab, 2), sTmp)
.head 7 -  Set nAsci1 = SalStrLop(sTmp)
.head 7 -  Set nAsci2 = SalStrLop(sTmp)
.head 7 -  Set sRet = SalNumberToStrX(((nAsci1 - IifN(nAsci1>57, 55, 48)) *  36 + nAsci2 -
    IifN(nAsci2>57, 55, 48))  * SalNumberPower(10, 5) + SalStrToNumber(pond), 0)
.head 7 -  Return sRet
.head 5 +  Function: NestInfo
.head 6 -  Description: заполнение данных реестра в массивы из arc_rrp (strA[..])+ dbf(strB[..]))
.head 6 +  Returns
.head 7 -  Number: nRet
.head 6 +  Parameters
.head 7 -  String: strFileDate    ! - - дата за какую собирается инфа о реестре
                            (дата файла *.zee  в формате dd/mm/yyyy)
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: strReeDir      ! - - директория, где находятся *.zee
.head 7 -  String: strZeeFileName ! - - имя файла *.zee
.head 7 -  String: strDbfFileName ! - - имя файла *.dbf
.head 7 -  !
.head 7 -  Number: i
.head 7 -  Number: nCurRow
.head 7 -  ! - -
.head 7 -  String: strPond
.head 7 -  String: strNlsb
.head 7 -  String: strNlsa
.head 7 -  String: strMfob
.head 7 -  String: strSum
.head 7 -  String: strOkpo
.head 7 -  String: strDateD
.head 7 -  String: strNameK
.head 7 -  String: strNazn
.head 7 -  String: strVob
.head 7 -  String: strSql
.head 7 -  String: strNd
.head 7 -  String: strDatD
.head 7 -  String: strDatV
.head 7 -  String: sDebugMsg
.head 7 -  ! - -
.head 7 -  File Handle: hSqlA
.head 7 -  Boolean: bIsZeeExists
.head 7 -  !
.head 7 -  Date/Time: dDatFile1
.head 7 -  Date/Time: dDatFile2
.head 6 +  Actions
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Set bIsZeeExists = FALSE
.head 7 -  ! ============================
.head 7 -  ! Вычитаем из файла параметров
.head 7 -  ! ============================
.head 7 -  Call SalUseRegistry(FALSE, '')
.head 7 -  Call SalGetProfileString('Kliks', 'ReestrDir', '', strReeDir, GetIniFileName())
.head 7 +  If strReeDir = ''
.head 8 -  Call SalMessageBox(
     'В файле параметров в группе [Kliks] отсутствует параметр ReestrDir',
     'Внимание!', 0)
.head 8 -  Return -1
.head 7 +  Else
.head 8 +  If not VisDosExist(strReeDir)
.head 9 +  If not SalFileCreateDirectory(strReeDir)
.head 10 -  Call SalMessageBox('Не могу создать каталог:' || strReeDir, 'Внимание',
     MB_IconStop)
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Return -1
.head 7 -  ! ==================
.head 7 -  ! Разархивируем файл
.head 7 -  ! ==================
.head 7 +  If not SalFileSetCurrentDirectory(strReeDir)
.head 8 -  Call SalMessageBox('Невозможно установить текущую директорию ' || strReeDir,
     'Внимание!', 0)
.head 8 -  Return -1
.head 7 -  ! - -  если существует разархивированный - удалим его
.head 7 +  If VisFileFind(sSab || Left(strFileDate, 2)|| SalStrMidX(strFileDate, 3, 2) ||
   '.dbf') != ''
.head 8 +  If VisFileDelete(strReeDir || '\\' || sSab || Left(strFileDate, 2) ||
   SalStrMidX(strFileDate, 3, 2) || '.dbf') < 0
.head 9 -  Call SalMessageBox('Невозможно удалить файл ' || strReeDir || '\\' || sSab ||
     Left(strFileDate, 2) || SalStrMidX(strFileDate, 3, 2) || '.dbf',
     'Внимание!', 0)
.head 9 -  Return -1
.head 7 -  !
.head 7 -  Set strZeeFileName = strReeDir || '\\' || sSab || SalStrLeftX(strFileDate, 2) ||
    SalStrMidX(strFileDate,3,2) || '.zee'
.head 7 -  Set strDbfFileName = strReeDir || '\\' || sSab || SalStrLeftX(strFileDate, 2) ||
    SalStrMidX(strFileDate,3,2) || '.dbf'
.head 7 -  ! Проверим существует ли файл ZEE
.head 7 +  If VisFileFind(strZeeFileName) = ''
.head 8 -  ! Call SalMessageBox('Файл реестра для ' || sSab || ' не существует ',
     'Внимание!', 0)
.head 8 -  Set nBCou = 0
.head 7 +  Else
.head 8 -  Set bIsZeeExists = TRUE
.head 7 -  ! =======================================================
.head 7 -  ! Вытяним номера док-ов из dbf если файлл существувет ...
.head 7 +  ! =======================================================
.head 8 -  ! - - - - - установим текущую директорию для реестров
.head 7 +  If bIsZeeExists
.head 8 +  If LzPack('D', strZeeFileName, strDbfFileName) != 0
.head 9 -  Call SalMessageBox('Не выполнена функция LzPack из LzPack.DLL для lzpack.exe D '
     || strZeeFileName || ' ' || strDbfFileName || PutCrLf(), 'Внимание!', 0)
.head 9 -  Return -1
.head 8 -  Set strDbfFileName = sSab || SalStrLeftX(strFileDate, 2) ||
    SalStrMidX(strFileDate, 3, 2) || '.dbf'
.head 8 -  ! ============================
.head 8 -  ! Вытяним номера док-ов из dbf
.head 8 +  ! ============================
.head 9 -  ! - - - - - установим текущую директорию для реестров
.head 8 +  If not SalFileSetCurrentDirectory(strReeDir)
.head 9 -  Call SalMessageBox('Невозможно установить текущую директорию ' || strReeDir,
     'Внимание!', 0)
.head 9 -  Return -1
.head 8 -  !
.head 8 -  Set SqlDatabase = 'dBase_Files'
.head 8 -  Set nBCou = 0
.head 8 +  If SqlConnect(hSqlA)
.head 9 -  ! - - - - - создание индекса
.head 9 +  ! If SqlPrepareAndExecute(hSqlA, "
   CREATE INDEX ree ON " || strDbfFileName || "(nlsa ASC, s ASC)")
.head 10 -  Call Debug('COOL INDEX CREATED')
.head 9 +  ! Else
.head 10 -  Call Debug('FAILED INDEX not CREATED')
.head 9 +  If SqlPrepareAndExecute(hSqlA, "
   SELECT pond,mfob,nlsa,nlsb,s,DtoS(da),DtoS(dppb)+' '+tppb,kokb,korr,nazn,vob,nd
   INTO   :strPond,:strMfob,:strNlsa,:strNlsb,:strSum,:strDatD,:strDatV,:strOkpo,:strNameK,:strNazn,:strVob,
          :strNd
   FROM   " || strDbfFileName || "
   WHERE  pond IS NOT NULL
   ORDER  BY nlsa,s")
.head 10 -  Set i = 0
.head 10 +  While SqlFetchNext(hSqlA, nCurRow)
.head 11 -  ! - - - Приведем значение pond в значение ref_a
.head 11 -  Set strB[i,0] = F_pond(strPond, sSab)
.head 11 -  Set strB[i,1] = '1'
.head 11 -  Set strB[i,2] = strNlsb
.head 11 -  Set strB[i,3] = strNlsa
.head 11 -  Set strB[i,4] = strMfob
.head 11 -  Set strB[i,5] = strSum
.head 11 -  Set strB[i,6] = strNd
.head 11 -  Set strB[i,7] = strOkpo
.head 11 -  Set strB[i,8] = StrDosToWinX(SalStrTrimX(strNameK))
.head 11 -  Set strB[i,9] = strVob
.head 11 -  Set strB[i,10] = '0'
.head 11 -  Set strB[i,11] = StrDosToWinX(SalStrTrimX(strNazn))
.head 11 -  Set strB[i,12] = SalStrRightX(strDatD, 2) || '/' ||
    SalStrMidX(strDatD, 4, 2) || '/' || SalStrLeftX(strDatD, 4)
.head 11 -  Set strB[i,13] = SalStrMidX(strDatV, 6, 2) || '/' ||
    SalStrMidX(strDatD, 4, 2) || '/' || SalStrLeftX(strDatD, 4) ||
    SalStrRightX(strDatV, 9)
.head 11 -  Set i = i + 1
.head 10 -  !
.head 10 -  Set nBCou = i
.head 10 +  If not SqlDisconnect(hSqlA)
.head 11 -  Call SalMessageBox('Невозможно закрыть соединение с файлом ' || strReeDir ||
     '\\' || sSab || SalStrLeftX(strFileDate, 2) ||
     SalStrMidX(strFileDate, 3, 2) || '.dbf', 'Внимание!', 0)
.head 11 -  Return -1
.head 9 +  Else
.head 10 -  Call SqlDisconnect(hSqlA)
.head 10 -  Call SalMessageBox('Невозможно подсоединится через драйвер <dBase_Files>',
     'Внимание!', 0)
.head 10 -  Return -1
.head 8 -  ! - - - -  удалим за собой этот файл
.head 8 +  If not SalFileSetCurrentDirectory(strReeDir)
.head 9 -  Call SalMessageBox('Невозможно установить текущую директорию ' || strReeDir,
     'Внимание!', 0)
.head 9 -  Return -1
.head 8 +  If VisFileFind(sSab || SalStrLeftX(strFileDate, 2) || SalStrMidX(strFileDate, 3, 2) || '.dbf') != ''
.head 9 +  If VisFileDelete(strReeDir || '\\' || sSab || SalStrLeftX(strFileDate, 2) ||
   SalStrMidX(strFileDate, 3, 2) || '.dbf') < 0
.head 10 -  Call SalMessageBox('Невозможно удалить файл ' || strReeDir || '\\' || sSab ||
     SalStrLeftX(strFileDate, 2) || SalStrMidX(strFileDate, 3, 2) || '.dbf',
     'Внимание!', 0)
.head 10 -  Return -1
.head 7 -  Set dDatFile1 = SalDateConstruct(Val(Right(strFileDate, 4)), Val(Subs(strFileDate, 4, 2)),
                Val(Left(strFileDate, 2)), 0, 0, 0)
.head 7 -  Set dDatFile2 = dDatFile1 + 1
.head 7 -  ! добавлен HINT
.head 7 -  Set strSql = "
    SELECT /*+INDEX(arc_rrp XIE_DAT_A_MFOA_ARC_RRP)*/
           ref_a,mfob,nlsa,nlsb,to_char(s),to_char(datd,'DD/MM/YYYY'),to_char(dat_a,'DD/MM/YYYY') || ' ' ||
           to_char(dat_a,'hh24:mi:ss'),id_b,substr(convert(nam_b,'RU8PC866','CL8MSWIN1251'),1,200),
           substr(convert(nazn,'RU8PC866','CL8MSWIN1251'),1,200),vob,
           substr(convert(nd,'RU8PC866','CL8MSWIN1251'),1,200)
    INTO   :strPond,:strMfob,:strNlsa,:strNlsb,:strSum,:strDatD,:strDatV,:strOkpo,:strNameK,:strNazn,:strVob,:strNd
    FROM   arc_rrp
    WHERE  sos>3 and fn_a like '$A" || sSab || "%' and dat_a>=:dDatFile1 and dat_a<:dDatFile2 and dk<=1
    ORDER  BY nlsa,s"
.head 7 -  Set nACou = 0
.head 7 +  If SqlPrepareAndExecute(hSqlAux(), strSql)
.head 8 -  Set i = 0
.head 8 +  While SqlFetchNext(hSqlAux(), nCurRow)
.head 9 -  Set strA[i,0] = strPond
.head 9 -  Set strA[i,1] = '1'
.head 9 -  Set strA[i,2] = strNlsb
.head 9 -  Set strA[i,3] = strNlsa
.head 9 -  Set strA[i,4] = strMfob
.head 9 -  Set strA[i,5] = strSum
.head 9 -  Set strA[i,6] = strNd
.head 9 -  Set strA[i,7] = strOkpo
.head 9 -  Set strA[i,8] = StrDosToWinX(strNameK)
.head 9 -  Set strA[i,9] = strVob
.head 9 -  Set strA[i,10] = '0'
.head 9 -  Set strA[i,11] = StrDosToWinX(strNazn)
.head 9 -  Set strA[i,12] = strDatD
.head 9 -  Set strA[i,13] = strDatV
.head 9 -  Set i = i + 1
.head 8 -  Set nACou = i
.head 7 +  Else
.head 8 -  Call SalMessageBox('Невозможно выбрать данные из таблицы arc_rrp', 'Внимание!', 0)
.head 8 -  Return -1
.head 7 -  Set i = 0
.head 7 -  Call SalWaitCursor(FALSE)
.head 5 +  Function: IsDiffer
.head 6 -  Description: ! - -  Проверяет есть ли расхождения в реестре и в базе
! - -  возвращ.  FALSE -  НЕТУ,  TRUE - ЕСТЬ
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  ! String: strArr  [*, 15]
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nUpBound
.head 7 -  Number: i
.head 7 -  Boolean: bRes1
.head 7 -  Boolean: bRes2
.head 6 +  Actions
.head 7 -  Set i=0
.head 7 -  Set bRes1 = FALSE
.head 7 -  Set bRes2 = FALSE
.head 7 +  While i <= nACou
.head 8 +  If strA[i, 1] = '1' or strA[i, 1] = '3' or SalStrToNumber(strA[i, 1]) > 4
.head 9 -  Set bRes1 = TRUE
.head 9 -  Break
.head 8 -  Set i = i + 1
.head 7 -  !
.head 7 -  Set i = 0
.head 7 +  While i <= nBCou
.head 8 +  If strB[i, 1] = '1' or strB[i, 1] = '3' or SalStrToNumber(strB[i, 1]) > 4
.head 9 -  Set bRes2 = TRUE
.head 9 -  Break
.head 8 -  Set i = i + 1
.head 7 -  Return bRes2 or bRes1
.head 5 +  Function: SaveToFile
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Number: nRet
.head 6 +  Parameters
.head 7 -  String: strFileDate
.head 7 -  Number: nSel
.head 7 -  Boolean: bIsPutMessage
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sRepDir
.head 7 -  String: sFilePath
.head 7 -  String: sFileTitle
.head 7 -  File Handle: hFileIn
.head 7 -  File Handle: hFileDebIn
.head 7 -  !
.head 7 -  Number: nDocCount
.head 7 -  Number: i
.head 7 -  Long String: sDocsForPrint[*,15]  ! Временный массив для печати документов
.head 7 -  !
.head 7 -  String: sReportHeader
.head 7 -  String: sFileName
.head 7 -  Number: nDebVer
.head 7 -  String: sDebugFilePath
.head 7 -  String: sDebugMsg
.head 7 -  String: sFileLine
.head 6 +  Actions
.head 7 -  Set sFileName = sSab || SalStrLeftX(strFileDate, 2) || SalStrMidX(strFileDate, 3, 2)
    || '.00' || SalNumberToStrX(nSel, 0)
.head 7 -  !
.head 7 -  Set nDebVer = GetGlobalOptionEx('REEDEB')
.head 7 -  ! ===  Debug INFO ==============
.head 7 +  If nDebVer = 1
.head 8 -  Call SalUseRegistry(FALSE, '')
.head 8 -  Call SalGetProfileString('Kliks', 'ReestrRepDir', '', sDebugFilePath, GetIniFileName())
.head 8 +  If not VisDosExist(sDebugFilePath)
.head 9 +  If not SalFileCreateDirectory(sDebugFilePath)
.head 10 -  Call SalMessageBox('Не могу создать каталог:' || sDebugFilePath, 'Внимание',
     MB_IconStop)
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Return -1
.head 8 -  Set sDebugFilePath=sDebugFilePath || '\\' || sSab || '.deb_save2file'
.head 8 +  If not SalFileOpen(hFileDebIn, sDebugFilePath, OF_Write)
.head 9 -  Call SalMessageBox('Невозможно открыть для записи файл ' || sDebugFilePath,
     'Внимание!', 0)
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Return -1
.head 7 -  ! === Debug INFO ==============
.head 7 -  !
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  !
.head 7 -  ! ======================================
.head 7 -  ! - - - Вычитаем параметр 'ReestrRepDir'
.head 7 -  ! ======================================
.head 7 -  Call SalUseRegistry(FALSE, '')
.head 7 -  Call SalGetProfileString('Kliks', 'ReestrRepDir', '', sRepDir, GetIniFileName())
.head 7 +  If sRepDir = ''
.head 8 -  Set sFilePath = tbl_Reestr.strReeDir || '\\' || sFileName
.head 7 +  Else
.head 8 +  If not VisDosExist(sRepDir)
.head 9 +  If not SalFileCreateDirectory(sRepDir)
.head 10 -  Call SalMessageBox('Не могу создать каталог:' || sRepDir, 'Внимание',
     MB_IconStop)
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 +  If nDebVer = 1
.head 11 +  If not SalFileClose(hFileDebIn)
.head 12 -  Call SalMessageBox('Невозможно закрыть трасcироваочный файл '||sDebugFilePath, 'Внимание!', 0)
.head 12 -  Call SalWaitCursor(FALSE)
.head 10 -  Return -1
.head 8 -  Set sFilePath = sRepDir || '\\' || sFileName
.head 7 -  ! ========================
.head 7 -  ! - - -Cделаем шапку файла
.head 7 -  ! ========================
.head 7 -  Set sFileTitle =  SalFmtFormatDateTime(SalDateCurrent(), 'dd-MM-yy hhhh:mm:ss') ||
    PutCrLf() || ' ' || PutCrLf() || tbl_Reestr.colKliName || '  ' ||
    tbl_Reestr.colOkpo || PutCrLf() || GetBankName() || '     ' || GetBankMfo() ||
    PutCrLf() || PutCrLf()
.head 7 +  Select Case nSel
.head 8 -  ! - - - - - - Полный реестр - - - - - - - - - - - - - - - - - - - - - - - -
.head 8 +  Case 1
.head 9 -  !
.head 9 -  Set sFileTitle = sFileTitle ||
    'ПОВНИЙ РЕЄСТР РОЗРАХУНКОВИХ ДОКУМЕНТІВ, ЯКІ ОТРИМАНІ КАНАЛАМИ ЗВ`ЯЗКУ' ||
    PutCrLf() || 'ПО СИСТЕМІ "КЛІЄНТ-БАНК" І ПРИЙНЯТІ БАНКОМ ДО ОПЛАТИ' ||
    PutCrLf()
.head 9 -  Break
.head 8 -  ! - - - - - - Внутрение  документы - - - - - - - - - - - - - - - - -
.head 8 +  Case 2
.head 9 -  !
.head 9 -  Set sFileTitle = sFileTitle ||
    'РЕЄСТР ВНУТРІШНІХ РОЗРАХУНКОВИХ ДОКУМЕНТІВ, ЯКІ ОТРИМАНІ КАНАЛАМИ ЗВ`ЯЗКУ'
    || PutCrLf() || 'ПО СИСТЕМІ "КЛІЄНТ-БАНК" І ПРИЙНЯТІ БАНКОМ ДО ОПЛАТИ' ||
    PutCrLf()
.head 9 -  Break
.head 8 -  ! - - - - - - Межбанковские  документы - - - - - - - - - - - -
.head 8 +  Case 3
.head 9 -  !
.head 9 -  Set sFileTitle = sFileTitle ||
    'РЕЄСТР ПОЧАТКОВИХ РОЗРАХУНКОВИХ ДОКУМЕНТІВ, ЯКІ ОТРИМАНІ КАНАЛАМИ ЗВ`ЯЗКУ'
    || PutCrLf() || 'ПО СИСТЕМІ "КЛІЄНТ-БАНК" І ПРИЙНЯТІ БАНКОМ ДО ОПЛАТИ' ||
    PutCrLf()
.head 9 -  Break
.head 8 -  ! - - - - - - Док-ты ненайденые   в файле dbf - но присутствующие в базе - - - - - - -
.head 8 +  Case 4
.head 9 -  !
.head 9 -  Set sFileTitle = sFileTitle ||
    'РЕЄСТР РОЗРАХУНКОВИХ ДОКУМЕНТІВ, ЯКІ ОТРИМАНІ КАНАЛАМИ ЗВ`ЯЗКУ' ||
    PutCrLf() || 'ПО СИСТЕМІ "КЛІЄНТ-БАНК" І ПРИЙНЯТІ БАНКОМ ДО ОПЛАТИ, АЛЕ ' ||
    'НЕЗНАЙДЕНІ В РЕЄСТРІ' || PutCrLf()
.head 9 -  !
.head 9 -  Break
.head 8 -  ! - - - - - - Док-ты ненайденые   в базе - - но присутствующие в dbf- - - - - - - - - - - -
.head 8 +  Case 5
.head 9 -  !
.head 9 -  Set sFileTitle = sFileTitle ||
    'РЕЄСТР РОЗРАХУНКОВИХ ДОКУМЕНТІВ, ЯКІ ОТРИМАНІ КАНАЛАМИ ЗВ`ЯЗКУ' ||
    PutCrLf() || 'ПО СИСТЕМІ "КЛІЄНТ-БАНК", АЛЕ НЕЗНАЙДЕНІ В БАНКУ' ||
    PutCrLf()
.head 9 -  Break
.head 8 -  ! - - - - - - Заключительный реестр - это все документы из  dbf- - - - - - - - - - - -
.head 8 +  Case 6
.head 9 -  !
.head 9 -  Set sFileTitle = sFileTitle || 'ЗАКЛЮЧНИЙ РЕЄСТР ПОЧАТКОВИХ РОЗРАХУНКОВИХ ' ||
    'ДОКУМЕНТІВ, ЯКІ ОТРИМАНІ КАНАЛАМИ ЗВ`ЯЗКУ' || PutCrLf() ||
    'ПО СИСТЕМІ "КЛІЄНТ-БАНК"' || PutCrLf()
.head 9 -  Break
.head 8 -  ! - - - - - - Ненайденые там и там - - - - - - - - - - - -
.head 8 +  Case 7
.head 9 -  !
.head 9 -  Set sFileTitle = sFileTitle ||
    'ЗАКЛЮЧНИЙ РЕЄСТР РОЗХОДЖЕНЬ ДОКУМЕНТІВ БАНКУ ТА РЕЄСТРУ' || PutCrLf()
.head 9 -  Break
.head 7 -  Set sFileTitle = sFileTitle || 'за ' ||strFileDate || PutCrLf()
.head 7 -  Set sReportHeader = ''
.head 7 +  If nSel = 7
.head 8 -  Set sReportHeader =
    '**************************************************************' || PutCrLf()
    || '*** ДОКУМЕНТИ, ЩО ЗНАЙДЕНІ В БАНКУ, АЛЕ ВІДСУТНІ В РЕЄСТРІ ***' ||
    PutCrLf() || '**************************************************************'
    || PutCrLf()
.head 7 -  Set sReportHeader = sReportHeader ||
'-----------------------------------------------------------------------------------------------------------------------------------' || PutCrLf() ||
'Nпп  | N докум.|  Рахунок А   |Мфо Б |Рахунок Б    |      Сума      |Дата одер.| ОКПО * Кореспондент' || PutCrLf() ||
'     |         |              |      |             |                |Час одер. | Призначення плат.' || PutCrLf() ||
'     |         |              |      |             |                |Дата док. |' || PutCrLf() ||
'-----------------------------------------------------------------------------------------------------------------------------------'
.head 7 -  ! - - -Запишем в файл
.head 7 +  If not SalFileOpen(hFileIn, sFilePath, OF_Write)
.head 8 -  Call SalMessageBox('Невозможно открыть для записи файл ' || sFilePath,
     'Внимание!', 0)
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 +  If nDebVer = 1
.head 9 +  If not SalFileClose(hFileDebIn)
.head 10 -  Call SalMessageBox('Невозможно закрыть трасcироваочный файл '||sDebugFilePath, 'Внимание!', 0)
.head 10 -  Call SalWaitCursor(FALSE)
.head 8 -  Return -1
.head 7 +  Else
.head 8 -  Call SalFilePutStr(hFileIn, StrWinToDosX(sFileTitle))
.head 8 -  Call SalFilePutStr(hFileIn, StrWinToDosX(sReportHeader))
.head 8 -  ! =====================================
.head 8 -  ! ==== Все что связано с БАНКОМ (базой)
.head 8 -  ! =====================================
.head 8 +  If nDebVer = 1
.head 9 -  Call SalFilePutStr(hFileDebIn, '==== Все что связано с с БАНКОМ (базой) =====')
.head 9 -  !
.head 8 -  !
.head 8 +  If nSel = 2 or nSel = 3 or nSel = 1 or nSel = 4 or nSel = 7
.head 9 -  Set nDocCount=0
.head 9 +  While i < nACou
.head 10 +  If ((SalStrTrimX(strA[i,4]) = GetBankMfo()) and nSel = 2) or
   ((SalStrTrimX(strA[i,4]) != GetBankMfo()) and nSel = 3) or
   (nSel = 7 and strA[i,1] != '2') or (nSel = 1) or
   (nSel = 4 and strA[i,1] != '2')
.head 11 -  ! Call VisArrayCopy(strA[i], sDocsForPrint[nDocCount], DT_String)
.head 11 -  Call copyArrayFromMx(i, nDocCount, strA, sDocsForPrint )
.head 11 -  Set nDocCount=nDocCount + 1
.head 10 -  Set i=i+1
.head 9 -  Call PrintDocs(nDocCount, sDocsForPrint, hFileIn, hFileDebIn, sFileName, nDebVer)
.head 9 -  !
.head 8 -  !
.head 8 -  ! ============================================
.head 8 -  ! ===== Все что связано с РЕЕСТРОМ (dbf) =====
.head 8 -  ! ============================================
.head 8 +  If nDebVer = 1
.head 9 -  Call SalFilePutStr(hFileDebIn, '==== Все что связано с РЕЕСТРОМ (dbf) ====='||'
Сохраняем информацию в файл')
.head 9 -  !
.head 8 +  If nSel = 7
.head 9 -  Set sReportHeader = PutCrLf() ||
    '**************************************************************' ||
    PutCrLf() ||
    '*** ДОКУМЕНТИ, ЩО ЗНАЙДЕНІ В РЕЄСТРІ, АЛЕ ВІДСУТНІ В БАНКУ ***' ||
    PutCrLf() ||
    '**************************************************************' ||
    PutCrLf()
.head 9 -  Set sReportHeader = sReportHeader ||
'-----------------------------------------------------------------------------------------------------------------------------------' || PutCrLf() ||
'Nпп  | N докум.|  Рахунок А   |Мфо Б |Рахунок Б    |      Сума      |Дата одер.| ОКПО * Кореспондент' || PutCrLf() ||
'     |         |              |      |             |                |Час одер. | Призначення плат.' || PutCrLf() ||
'     |         |              |      |             |                |Дата док. |' || PutCrLf() ||
'-----------------------------------------------------------------------------------------------------------------------------------'
.head 9 -  Call SalFilePutStr(hFileIn, StrWinToDosX(sReportHeader))
.head 8 +  If nSel = 7 or nSel = 5 or nSel = 6
.head 9 -  Set nDocCount=0
.head 9 +  While i < nBCou
.head 10 +  If (strB[i,1] != '2' and nSel = 7) or (strB[i,1] != '2' and nSel = 5) or nSel = 6
.head 11 -  ! Set sDocsForPrint[nDocCount, *] = strB[i,*];
.head 11 -  Call copyArrayFromMx(i, nDocCount, strB, sDocsForPrint )
.head 11 -  Set nDocCount=nDocCount+1
.head 10 -  Set i=i+1
.head 9 -  Call PrintDocs(nDocCount, sDocsForPrint, hFileIn, hFileDebIn, sFileName, nDebVer )
.head 7 -  !
.head 7 -  !
.head 7 -  !
.head 7 +  If not SalFileClose(hFileIn)
.head 8 -  Call SalMessageBox('Невозможно закрыть файл ' || sFileName, 'Внимание!', 0)
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 +  If nDebVer = 1
.head 9 +  If not SalFileClose(hFileDebIn)
.head 10 -  Call SalMessageBox('Невозможно закрыть трасcироваочный файл '||sDebugFilePath, 'Внимание!', 0)
.head 10 -  Call SalWaitCursor(FALSE)
.head 8 -  Return -1
.head 7 +  Else
.head 8 -  ! ------ если данных вообще нету - удалим этот файл
.head 8 +  If nDocCount = 0
.head 9 +  If VisFileDelete(sFilePath) < 0
.head 10 -  Call SalMessageBox('Файл ' || sFilePath ||
     ' невозможно удалить (удаляем, так как данных для этого файла нет)',
     'Внимание!', 0)
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 +  If nDebVer = 1
.head 11 +  If not SalFileClose(hFileDebIn)
.head 12 -  Call SalMessageBox('Невозможно закрыть трасcироваочный файл '||sDebugFilePath, 'Внимание!', 0)
.head 12 -  Call SalWaitCursor(FALSE)
.head 10 -  Return -1
.head 9 -  Call SalWaitCursor(FALSE)
.head 8 +  Else
.head 9 +  If bIsPutMessage
.head 10 -  Call SalMessageBox('Информация сохранена в файл ' || sFilePath, '', 0)
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 +  If nDebVer = 1
.head 10 +  If not SalFileClose(hFileDebIn)
.head 11 -  Call SalMessageBox('Невозможно закрыть трасcироваочный файл '||sDebugFilePath, 'Внимание!', 0)
.head 11 -  Call SalWaitCursor(FALSE)
.head 9 -  Return 1
.head 7 +  If nDebVer = 1
.head 8 +  If not SalFileClose(hFileDebIn)
.head 9 -  Call SalMessageBox('Невозможно закрыть трасcироваочный файл '||sDebugFilePath, 'Внимание!', 0)
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Return -1
.head 5 +  Function: Compare
.head 6 -  Description: ! - - Сличает два массива платежей (из реестра и базы) и
! - - как результат проставляет соответствующие флаги
! - - strRefArc[i,1] = '1' - первоначальное значение ключа - это значение
                             остается в длинном массиве, чтоб не
                             заполнять его '3' ('3' эквивалентно '1')
! - - strRefArc[i,1] = '2' - плптежи есть там и там
! - - strRefArc[i,1] = '3' - платеж есть в arc_rrp, но нету в dbf
                             (и наоборот)
! - - strRefArc[i,1] > '4' - плптежи есть там и там. но реквизиты не
                             совпадают, а значение этого параметра =
                             номеру поля в таблице + 1 + 4,
                             (поля, которое не совпадает)
.head 6 +  Returns
.head 7 -  Number: nRet
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nUpBound
.head 7 -  Number: nUpBound2
.head 7 -  Number: j
.head 7 -  Number: i
.head 7 -  Number: i0
.head 7 -  Number: i1
.head 7 -  Number: i2
.head 7 -  Number: k1
.head 7 -  Number: k2
.head 7 -  Number: nMinBound
.head 7 -  Number: sA[*,2]
.head 7 -  Number: sB[*,2]
.head 7 -  ! - -nDebVer=1 - дебаг версия
.head 7 -  Number: nDebVer
.head 7 -  String: sDebugFileName
.head 7 -  String: sDebugFilePath
.head 7 -  String: sFileLine
.head 7 -  File Handle: hFileIn
.head 6 +  Actions
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Set nUpBound = nACou
.head 7 -  Set nUpBound2 = nBCou
.head 7 -  !
.head 7 -  Set nDebVer = GetGlobalOptionEx('REEDEB')
.head 7 -  ! ===  Debug INFO ==============
.head 7 +  If nDebVer = 1
.head 8 -  Set sDebugFileName = sSab || '.deb_compare'
.head 8 -  Call SalUseRegistry(FALSE, '')
.head 8 -  Call SalGetProfileString('Kliks', 'ReestrRepDir', '', sDebugFilePath, GetIniFileName())
.head 8 +  If not VisDosExist(sDebugFilePath)
.head 9 +  If not SalFileCreateDirectory(sDebugFilePath)
.head 10 -  Call SalMessageBox('Не могу создать каталог:' || sDebugFilePath, 'Внимание',
     MB_IconStop)
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Return -1
.head 8 -  Set sDebugFilePath = sDebugFilePath || '\\' || sDebugFileName
.head 8 -  ! ===================
.head 8 -  ! - - -Запишем в файл
.head 8 -  ! ===================
.head 8 +  If not SalFileOpen(hFileIn, sDebugFilePath, OF_Write)
.head 9 -  Call SalMessageBox('Невозможно открыть для записи файл ' || sDebugFilePath,
     'Внимание!', 0)
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Return -1
.head 8 +  Else
.head 9 -  Call SalFilePutStr(hFileIn, '==================================')
.head 9 -  Call SalFilePutStr(hFileIn, 'Документы из базы (БАНК)' || PutCrLf())
.head 9 -  Call SalFilePutStr(hFileIn, '==================================')
.head 9 -  Set i = 0
.head 9 -  Set sFileLine = ''
.head 9 +  While i < nACou
.head 10 -  Set sFileLine = sFileLine || Str(i) || ' - ' || strA[i,0] || ' - ' ||
    strA[i,2] || ' - ' || strA[i,3] || ' - ' || strA[i,4] || ' - ' ||
    strA[i,5] || ' - ' || strA[i,6] || PutCrLf()
.head 10 -  Set i =i + 1
.head 9 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 9 -  !
.head 9 -  Set sFileLine = ''
.head 9 -  Set sFileLine = '==================================' || PutCrLf() ||
    'Документы из файла реестра' || PutCrLf() ||
    '==================================' || PutCrLf()
.head 9 -  Set i = 0
.head 9 +  While i < nBCou
.head 10 -  Set sFileLine = sFileLine || Str(i) || ' - ' || strB[i,0] || ' - ' ||
    strB[i,2] || ' - ' || strB[i,3] || ' - ' || strB[i,4] || ' - ' ||
    strB[i,5] || ' - ' || strB[i,6] || PutCrLf()
.head 10 -  Set i = i + 1
.head 9 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 7 -  ! === Debug INFO ==============
.head 7 -  !
.head 7 -  ! ======================================================
.head 7 -  ! - - - Отсортируем предварительно
.head 7 -  ! - - - ref - ы, поместив их в отдельные массивы sA и sB
.head 7 -  ! ======================================================
.head 7 -  !
.head 7 -  Set i = 0
.head 7 +  While i < nACou
.head 8 -  Set sA[i,0] = SalStrToNumber(strA[i,0])
.head 8 -  Set sA[i,1] = i
.head 8 -  Set i = i + 1
.head 7 -  Set i = 0
.head 7 +  While i < nBCou
.head 8 -  Set sB[i,0] = SalStrToNumber(strB[i,0])
.head 8 -  Set sB[i,1] = i
.head 8 -  Set i = i + 1
.head 7 -  ! ===  Debug INFO ==============
.head 7 +  If nDebVer = 1
.head 8 -  Set i = 0
.head 8 -  Set sFileLine = PutCrLf() || '==================================' || PutCrLf() ||
    'Массив номеров для БАЗЫ' || PutCrLf() || '=================================='
    || PutCrLf()
.head 8 +  While i < nACou
.head 9 -  Set sFileLine = sFileLine || Str(sA[i,0]) || ' - '|| Str(sA[i,1]) || PutCrLf()
.head 9 -  Set i = i + 1
.head 8 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 8 -  !
.head 8 -  Set i = 0
.head 8 -  Set sFileLine = PutCrLf() || '==================================' || PutCrLf() ||
    'Массив номеров для Файла реестра' || PutCrLf() ||
    '==================================' || PutCrLf()
.head 8 +  While i < nBCou
.head 9 -  Set sFileLine = sFileLine || Str(sB[i,0]) || ' - ' || Str(sB[i,1]) || PutCrLf()
.head 9 -  Set i = i + 1
.head 8 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 7 -  ! === Debug INFO ==============
.head 7 -  Call SortArray(nACou, sA)
.head 7 -  Call SortArray(nBCou, sB)
.head 7 -  ! === Debug INFO ==============
.head 7 +  If nDebVer = 1
.head 8 -  Set i = 0
.head 8 -  Set sFileLine = PutCrLf() || '==================================' || PutCrLf() ||
    'Массив отсортированных номеров для БАЗЫ' || PutCrLf() ||
    '==================================' || PutCrLf()
.head 8 +  While i < nACou
.head 9 -  Set sFileLine = sFileLine || Str(i) || '-' || Str(sA[i,0]) || ' - ' ||
    Str(sA[i,1]) || PutCrLf()
.head 9 -  Set i = i + 1
.head 8 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 8 -  !
.head 8 -  Set i = 0
.head 8 -  Set sFileLine = PutCrLf() || '==================================' || PutCrLf() ||
    'Массив отсортированных номеров для Файла реестра' || PutCrLf() ||
    '==================================' || PutCrLf()
.head 8 +  While i < nBCou
.head 9 -  Set sFileLine = sFileLine || Str(i) || '-' || Str(sB[i,0]) || ' - ' ||
    SalNumberToStrX(sB[i,1],0) || PutCrLf()
.head 9 -  Set i = i + 1
.head 8 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 8 -  !
.head 8 +  ! If not SalFileClose(hFileIn)
.head 9 -  Call SalMessageBox('Невозможно закрыть файл ' || sDebugFilePath, 'Внимание!', 0)
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Return -1
.head 8 -  ! Return 1
.head 7 -  ! === Debug INFO ==============
.head 7 -  !
.head 7 -  ! ==============================================================================
.head 7 -  ! - - - Сравним ref_ы
.head 7 -  ! ==============================================================================
.head 7 -  Set i1 = 0
.head 7 -  Set i2 = 0
.head 7 +  If nUpBound  = 0
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  ! Закрой трассироваочн. файл
.head 8 +  If nDebVer=1
.head 9 +  If not SalFileClose(hFileIn)
.head 10 -  Call SalMessageBox('Невозможно закрыть файл ' || sDebugFilePath, 'Внимание!', 0)
.head 10 -  Call SalWaitCursor(FALSE)
.head 8 -  Return -1
.head 7 -  ! Call SalMessageBox('В базе нету ни одного платежа для ' || sSab, 'Внимание!', 0)
.head 7 -  Set nMinBound = SalNumberMin(nUpBound, nUpBound2)
.head 7 -  !
.head 7 -  !
.head 7 -  ! === Debug INFO ==============
.head 7 +  If nDebVer = 1
.head 8 -  Set sFileLine = PutCrLf() || '==================================' || PutCrLf() ||
    'Начинаем сличать платежи........' || PutCrLf() ||
    '==================================' || PutCrLf()
.head 8 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 7 -  ! === Debug INFO ==============
.head 7 -  !
.head 7 +  While i1 < nUpBound and i2 < nUpBound2
.head 8 +  If sA[i1,0] = sB[i2,0]
.head 9 -  Set strA[sA[i1,1],1] = '2'
.head 9 -  Set strB[sB[i2,1],1] = '2'
.head 9 -  ! === Debug INFO ==============
.head 9 +  If nDebVer = 1
.head 10 -  Set sFileLine= ' --------------------------- '
.head 10 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 10 -  Set sFileLine='sA[' || Str(i1) || ',0] = ' || 'sB[' || Str(i2) || ',0] => ' ||
    Str(sA[i1,0]) || '=' || Str(sB[i2,0]) || PutCrLf()
.head 10 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 9 -  ! === Debug INFO ==============
.head 9 -  !
.head 9 -  ! =================================
.head 9 -  ! - - - Проверка реквизитов платежа
.head 9 -  ! =================================
.head 9 -  Set j = 2
.head 9 +  While j <= 6
.head 10 +  If SalStrTrimX(strA[sA[i1,1],j]) != SalStrTrimX(strB[sB[i2,1],j])
.head 11 -  Set strA[sA[i1,1],1] = SalNumberToStrX(4+j+1, 0)
.head 11 -  Set strB[sB[i2,1],1] = SalNumberToStrX(4+j+1, 0)
.head 11 -  ! ===  Debug INFO ==============
.head 11 +  If nDebVer = 1
.head 12 -  Set sFileLine='          !--!!-- For sA[' || Str(i1) ||
    ',1]   params not equal - ' || Str(j) || PutCrLf() ||
    '          strA[' || Str(sA[i1,1]) || ',' || Str(j) || '] != strB[ '
    || Str(sB[i2,1]) || ',' || Str(j) || ']  => ' ||
    SalStrTrimX(strA[sA[i1,1],j]) || ' != ' ||
    SalStrTrimX(strB[sB[i2,1],j])
.head 12 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 11 -  ! === Debug INFO ==============
.head 11 -  Break
.head 10 -  Set j = j+ 1
.head 9 -  ! ===  Debug INFO ==============
.head 9 +  If nDebVer = 1
.head 10 -  Set sFileLine = ' .. strA[' || Str(sA[i1,1]) || ',1] = ' || strA[sA[i1,1],1]
    || PutCrLf() || ' .. strB[' || Str(sB[i2,1]) || ',1] = ' ||
    strB[sB[i2,1],1]
.head 10 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 9 -  ! === Debug INFO ==============
.head 9 -  Set i1 = i1 + 1
.head 9 -  Set i2 = i2 + 1
.head 8 -  ! - - - - -
.head 8 +  Else
.head 9 +  If sA[i1,0] > sB[i2,0]
.head 10 -  Set k1 = i1
.head 10 -  Set i0 = i2
.head 10 -  Set k2 = i2
.head 10 -  !
.head 10 -  ! === Debug INFO ==============
.head 10 +  If nDebVer = 1
.head 11 -  Set sFileLine= ' --------------------------- '
.head 11 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 11 -  Set sFileLine = 'sA[' || Str(i1) || ',0] >  ' || 'sB[' || Str(i2) ||
    ',0] => ' || Str(sA[i1,0]) || '>' || Str(sB[i2,0]) || PutCrLf()
.head 11 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 10 -  ! === Debug INFO ==============
.head 10 +  While sB[k2,0] < sA[k1,0] and k2 < nUpBound2
.head 11 -  Set k2 = k2 + 1
.head 10 +  If sB[k2,0] = sA[k1,0]
.head 11 -  Set strB[sB[k2,1],1] = '2'
.head 11 -  Set strA[sA[k1,1],1] = '2'
.head 11 -  ! === Debug INFO ==============
.head 11 +  If nDebVer = 1
.head 12 -  Set sFileLine = 'After inc : sA[' || Str(k1) || ',0] = sB[' || Str(k2) ||
    ',0] = ' || Str(sB[k2,0]) || ' - sA[' || Str(k1) || ',1] = ' ||
    Str(sA[k1,1]) || ' - sB[' || Str(k2) || ',1] = ' || Str(sB[k2,1]) ||
    PutCrLf() || '      Suspect strA[' || Str(sA[k1,1]) || ',1]=' ||
    strA[sA[k1,1],1] || PutCrLf() || '      Suspect strB[' ||
    Str(sB[k2,1]) || ',1]=' || strB[sB[k2,1],1] || PutCrLf()
.head 12 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 11 -  ! === Debug INFO ==============
.head 11 -  !
.head 11 -  ! =================================
.head 11 -  ! - - - Проверка реквизитов платежа
.head 11 -  ! =================================
.head 11 -  Set j = 2
.head 11 +  While j <= 6
.head 12 +  If SalStrTrimX(strA[sA[k1,1],j]) != SalStrTrimX(strB[sB[k2,1],j])
.head 13 -  Set strA[sA[k1,1],1] = Str(4+j+1)
.head 13 -  Set strB[sB[k2,1],1] = Str(4+j+1)
.head 13 -  ! === Debug INFO ==============
.head 13 +  If nDebVer = 1
.head 14 -  Set sFileLine = '        --???-- For sA[' || Str(k1) ||
    ',1]   params not equal - ' || Str(j) || PutCrLf() ||
    '        strA[' || Str(sA[k1,1]) || ',' || Str(j) || '] != strB[ '
    || Str(sB[k2,1]) || ',' || Str(j) || ']  => ' ||
    SalStrTrimX(strA[sA[k1,1],j]) || ' != ' ||
    SalStrTrimX(strB[sB[k2,1],j]) || PutCrLf()
.head 14 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 13 -  ! === Debug INFO ==============
.head 13 -  Break
.head 12 -  Set j = j+ 1
.head 11 -  ! =============
.head 11 -  Set i1 = i1 + 1
.head 11 -  Set i2 = k2 + 1
.head 10 +  Else
.head 11 -  Set strB[sB[k2,1],1] = '3'
.head 11 -  Set strA[sA[k1,1],1] = '3'
.head 11 -  ! === Debug INFO ==============
.head 11 +  If nDebVer = 1
.head 12 -  Set sFileLine = 'After inc : sA[' || Str(k1) || ',1] <> sB[' || Str(k2) ||
    ',1] => ' || Str(sA[k1,0]) || ' <> ' || Str(sB[k2,0]) || PutCrLf() ||
    '  .. strA[' || Str(sA[k1,1]) || ',1]=' || strA[sA[k1,1],1] ||
    PutCrLf() || '  .. strB[' || Str(sB[k2,1]) || ',1]=' ||
    strB[sB[k2,1],1] || PutCrLf()
.head 12 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 11 -  ! === Debug INFO ==============
.head 11 -  Set i1 = i1 + 1
.head 11 -  Set i2 = k2
.head 10 -  Set i = i0
.head 10 +  While i < k2
.head 11 -  Set strB[sB[i,1],1] = '3'
.head 11 -  ! === Debug INFO ==============
.head 11 +  If nDebVer = 1
.head 12 -  Set sFileLine = '        Not found : ' || PutCrLf() || ' ..strB[' ||
    Str(sB[i,1]) || ',1] =' || strB[sB[i,1],1]
.head 12 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 11 -  ! === Debug INFO ==============
.head 11 -  Set i = i + 1
.head 9 +  Else
.head 10 -  Set k1 = i1
.head 10 -  Set i0 = i1
.head 10 -  Set k2 = i2
.head 10 -  ! === Debug INFO ==============
.head 10 +  If nDebVer = 1
.head 11 -  Set sFileLine= ' --------------------------- '
.head 11 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 11 -  Set sFileLine = 'sA[' || Str(i1) || ',0] <  ' || 'sB[' || Str(i2) ||
    ',0] => ' || Str(sA[i1,0]) || '<' || Str(sB[i2,0]) || PutCrLf()
.head 11 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 10 -  ! === Debug INFO ==============
.head 10 +  While sB[k2,0] > sA[k1,0] and k1 < nUpBound
.head 11 -  Set k1 = k1 + 1
.head 10 +  If sB[k2,0] = sA[k1,0]
.head 11 -  Set strB[sB[k2,1],1] = '2'
.head 11 -  Set strA[sA[k1,1],1] = '2'
.head 11 -  ! === Debug INFO ==============
.head 11 +  If nDebVer = 1
.head 12 -  Set sFileLine = 'After inc : sA[' || Str(k1) || ',0] = sB[' || Str(k2) ||
    ',0] = ' || Str(sB[k2,0]) || ' - sA[' || Str(k1) || ',1] = ' ||
    Str(sA[k1,1]) || ' - sB[' || Str(k2) || ',1] = ' || Str(sB[k2,1]) ||
    PutCrLf() || '      Suspect strA[' || Str(sA[k1,1]) || ',1]=' ||
    strA[sA[k1,1],1] || PutCrLf() || '      Suspect strB[' ||
    Str(sB[k2,1]) || ',1]=' || strB[sB[k2,1],1] || PutCrLf()
.head 12 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 11 -  ! === Debug INFO ==============
.head 11 -  !
.head 11 -  ! =================================
.head 11 -  ! - - - Проверка реквизитов платежа
.head 11 -  ! =================================
.head 11 -  Set j = 2
.head 11 +  While j <= 6
.head 12 +  If SalStrTrimX(strA[sA[k1,1],j]) != SalStrTrimX(strB[sB[k2,1],j])
.head 13 -  Set strA[sA[k1,1],1] = Str(4+j+1)
.head 13 -  Set strB[sB[k2,1],1] = Str(4+j+1)
.head 13 -  ! === Debug INFO ==============
.head 13 +  If nDebVer = 1
.head 14 -  Set sFileLine = '        --???-- For sA[' || Str(k1) ||
    ',1]   params not equal - ' || Str(j) || PutCrLf() ||
    '        strA[' || Str(sA[k1,1]) || ',' || Str(j) || '] != strB[ '
    || Str(sB[k2,1]) || ',' || Str(j) || ']  => ' ||
    SalStrTrimX(strA[sA[k1,1],j]) || ' != ' ||
    SalStrTrimX(strB[sB[k2,1],j]) || PutCrLf()
.head 14 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 13 -  ! === Debug INFO ==============
.head 13 -  Break
.head 12 -  Set j = j+ 1
.head 11 -  ! === Debug INFO ==============
.head 11 +  If nDebVer = 1
.head 12 -  Set sFileLine = ' .. strA[' || Str(sA[k1,1]) || ',1] = ' ||
    strA[sA[k1,1],1] || PutCrLf() || ' .. strB[' || Str(sB[k2,1]) ||
    ',1] = ' || strB[sB[k2,1],1] || PutCrLf()
.head 12 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 11 -  ! === Debug INFO ==============
.head 11 -  Set i1 = k1 + 1
.head 11 -  Set i2 = i2 + 1
.head 10 +  Else
.head 11 -  Set strB[sB[k2,1],1] = '3'
.head 11 -  Set strA[sA[k1,1],1] = '3'
.head 11 -  ! === Debug INFO ==============
.head 11 +  If nDebVer = 1
.head 12 -  Set sFileLine = 'After inc : sA[' || Str(k1) || ',1] <> sB[' || Str(k2) ||
    ',1] => ' || Str(sA[k1,0]) || ' <> ' || Str(sB[k2,0]) || PutCrLf() ||
    '  .. strA[' || Str(sA[k1,1]) || ',1]=' || strA[sA[k1,1],1] ||
    PutCrLf() || '  .. strB[' || Str(sB[k2,1]) || ',1]=' ||
    strB[sB[k2,1],1] || PutCrLf()
.head 12 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 11 -  ! === Debug INFO ==============
.head 11 -  Set i1 = k1
.head 11 -  Set i2 = i2 + 1
.head 10 -  Set i = i0
.head 10 +  While i < k1
.head 11 -  Set strA[sA[i,1], 1] = '3'
.head 11 -  ! === Debug INFO ==============
.head 11 +  If nDebVer = 1
.head 12 -  Set sFileLine = '      Not found : ' || PutCrLf() || ' ..strA[' ||
    Str(sA[i,1]) || ',1] =' || strA[sA[i,1],1]
.head 12 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 11 -  ! === Debug INFO ==============
.head 11 -  Set i = i + 1
.head 8 -  ! === Debug INFO ==============
.head 8 +  If nDebVer = 1
.head 9 -  Set sFileLine = ' i1 = ' || Str(i1) || '- nUpBound1=' || Str(nUpBound) ||
    PutCrLf() || ' i2 = ' || Str(i2) || '- nUpBound2=' || Str(nUpBound2) ||
    PutCrLf()
.head 9 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 8 -  ! === Debug INFO ==============
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  ! === Debug INFO ==============
.head 7 +  If nDebVer = 1
.head 8 -  Call SalFilePutStr(hFileIn, '==================================')
.head 8 -  Call SalFilePutStr(hFileIn, ' Просмотренные Документы из базы (БАНК)' ||
     PutCrLf())
.head 8 -  Call SalFilePutStr(hFileIn, '==================================')
.head 8 -  Set i = 0
.head 8 -  Set sFileLine = ''
.head 8 +  While i < nACou
.head 9 -  Set sFileLine = sFileLine || Str(i) || ' - ' || strA[i,0] || ' >> ' || strA[i,1]
    || ' << ' || strA[i,2] || ' - ' || strA[i,3] || ' - ' || strA[i,4] || ' - '
    || strA[i,5] || ' - ' || strA[i,6] || PutCrLf()
.head 9 -  Set i =i + 1
.head 8 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 8 -  !
.head 8 -  Set sFileLine = ''
.head 8 -  Set sFileLine = '==================================' || PutCrLf() ||
    'Просмотренные Документы из файла реестра' || PutCrLf() ||
    '==================================' || PutCrLf()
.head 8 -  Set i = 0
.head 8 +  While i < nBCou
.head 9 -  Set sFileLine = sFileLine || Str(i) || ' - ' || strB[i,0] || ' >> ' || strB[i,1]
    || ' << ' || strB[i,2] || ' - ' || strB[i,3] || ' - ' || strB[i,4] || ' - '
    || strB[i,5] || ' - ' || strB[i,6] || PutCrLf()
.head 9 -  Set i = i + 1
.head 8 -  Call SalFilePutStr(hFileIn, sFileLine)
.head 8 +  If not SalFileClose(hFileIn)
.head 9 -  Call SalMessageBox('Невозможно закрыть файл ' || sDebugFilePath, 'Внимание!', 0)
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Return -1
.head 7 -  ! === Debug INFO ==============
.head 7 -  Return 1
.head 5 +  Function: SortArray
.head 6 -  Description: Сортировка символьного массива по возрастанию
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nCou
.head 7 -  Receive Number: sArr[*,2]
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: i
.head 7 -  Number: k
.head 7 -  Number: sTmp
.head 6 +  Actions
.head 7 -  Set i = 0
.head 7 -  Set k = nCou
.head 7 +  While k > 1
.head 8 -  Set i = 0
.head 8 +  While i < k - 1
.head 9 +  If sArr[i,0] > sArr[i+1,0]
.head 10 -  Set sTmp = sArr[i+1,0]
.head 10 -  Set sArr[i+1,0] = sArr[i,0]
.head 10 -  Set sArr[i,0] = sTmp
.head 10 -  Set sTmp = sArr[i+1,1]
.head 10 -  Set sArr[i+1,1] = sArr[i,1]
.head 10 -  Set sArr[i,1] = sTmp
.head 9 -  Set i = i + 1
.head 8 -  Set k = k - 1
.head 5 +  Function: ConstructFileLine
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  String:
.head 6 +  Parameters
.head 7 -  Long String: sParams[*,15]  ! - - Документы
.head 7 -  Number: ncou  !-- последовательность платежа
.head 7 -  Number: i     !-- номер массива
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return StrToStrFormat(Str(ncou), 5, ' ', TRUE) || ' ' ||
    StrToStrFormat(SalStrTrimX(sParams[i,6]), 9, ' ', TRUE) || ' ' ||
    StrToStrFormat(sParams[i,3], 14, ' ', FALSE) || ' ' ||
    StrToStrFormat(sParams[i,4], 6, ' ', FALSE) || ' ' ||
    StrToStrFormat(sParams[i,2], 14, ' ', FALSE) || ' ' || StrToStrFormat(
    SalNumberToStrX(SalStrToNumber(sParams[i,5])/100, 2), 15, ' ',TRUE) || ' '
    || Left(sParams[i,13], 10) || ' ' ||
    StrToStrFormat(sParams[i,7], 9, ' ', FALSE) || ' * ' || StrToStrFormat(
    Left(sParams[i,8], 40), 40, ' ', FALSE) || PutCrLf() ||
    StrToStrFormat('', 68, ' ', FALSE) || ' ' || StrToStrFormat(
    Right(sParams[i,13], 8), 8, ' ', FALSE)|| StrToStrFormat('', 2, ' ', FALSE)
    || ' ' || StrToStrFormat(Left(sParams[i,11], 51), 51, ' ',FALSE) ||
    PutCrLf() || StrToStrFormat('', 68, ' ', FALSE) || ' ' ||
    StrToStrFormat(Left(sParams[i,12], 10), 10, ' ', FALSE) || ' ' ||
    SalStrMidX(sParams[i,11], 51, 51) || PutCrLf() || IifS(
    Len(sParams[i,11])>102, StrToStrFormat('', 80, ' ', FALSE) ||
    SalStrMidX(sParams[i,11], 102, 51) || PutCrLf(), '') || IifS(
    Len(sParams[i,11])>153, StrToStrFormat('', 80, ' ', FALSE) ||
    SalStrMidX(sParams[i,11], 153, Len(sParams[i,11])-154) || PutCrLf(), '')
.head 5 +  Function: PutGroupInfoToFile
.head 6 -  Description: Формирует строки файла для реестра  - или же  - все что связано с БАНКОМ или все что связано с DBF
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 -  Actions
.head 5 +  Function: PrintDocs
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nDocCou
.head 7 -  Long String: sDocsForPrint[*,15]
.head 7 -  File Handle: hFileIn
.head 7 -  File Handle: hFileDebIn
.head 7 -  String: sFileName
.head 7 -  Number: nDebVer
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: i
.head 7 -  Number: nTotalSumNls
.head 7 -  Number: nTotalSumRep
.head 7 -  String: sNlsA
.head 7 -  String: sDebugMsg
.head 7 -  String: sFileTitle
.head 6 +  Actions
.head 7 -  !
.head 7 -  Set i=0
.head 7 -  Set sNlsA = '0'
.head 7 -  Set nTotalSumNls = 0
.head 7 -  Set nTotalSumRep = 0
.head 7 -  !
.head 7 +  While i < nDocCou
.head 8 -  Set sDebugMsg =''
.head 8 -  Set sFileTitle = ConstructFileLine(sDocsForPrint, i+1, i)
.head 8 -  ! счет совпадает с пердидущим
.head 8 -  Set sDebugMsg = sDebugMsg||PutCrLf()||'счет -'||sDocsForPrint[i,3]
.head 8 +  If sNlsA =sDocsForPrint[i,3]
.head 9 -  Set sDebugMsg = sDebugMsg||PutCrLf()||'счет такой же-'||sNlsA
.head 9 -  Set nTotalSumNls = nTotalSumNls + SalStrToNumber(sDocsForPrint[i,5])
.head 9 -  Set sDebugMsg = sDebugMsg||PutCrLf()||'увеличили сумму на '||sDocsForPrint[i,5]||' =>'||SalNumberToStrX(nTotalSumNls,0)
.head 8 -  ! Счет не совпадает с предидущим счетом
.head 8 +  Else
.head 9 -  ! сумма уже была - значит это другой счет - подбить группу по счету
.head 9 +  If nTotalSumNls != 0
.head 10 -  Set sDebugMsg = sDebugMsg||PutCrLf()||'счета неравны nTotalSumNls != 0 => Пишем групповую строку'
.head 10 -  Set sFileTitle = '   -- Всього по ' || sDocsForPrint[i-1,3] || ' ' ||
    SalNumberToStrX(nTotalSumNls/100, 2) || PutCrLf() || PutCrLf() ||
    sFileTitle || PutCrLf()
.head 10 -  Set sDebugMsg = sDebugMsg||PutCrLf()||sFileTitle
.head 10 -  ! сбиваем сумму в ноль для след счета + увеличиваем общую сумму
.head 10 -  Set nTotalSumRep = nTotalSumRep + nTotalSumNls
.head 10 -  Set sDebugMsg = sDebugMsg||PutCrLf()||'Увеличиваем общую сумму => '||SalNumberToStrX(nTotalSumRep,0)
.head 10 -  Set nTotalSumNls = SalStrToNumber(sDocsForPrint[i,5])
.head 10 -  Set sDebugMsg = sDebugMsg||PutCrLf()||'Для нового счета сумма = '||SalNumberToStrX(nTotalSumNls,0)
.head 9 -  ! Самый первый счет
.head 9 +  Else
.head 10 -  Set nTotalSumNls = SalStrToNumber(sDocsForPrint[i,5])
.head 10 -  Set sDebugMsg = sDebugMsg||PutCrLf()||'Самый первый счет nTotalSumNls = '||SalNumberToStrX(nTotalSumNls,0)
.head 9 -  !
.head 8 -  Set sNlsA = sDocsForPrint[i,3]
.head 8 -  !
.head 8 +  If not SalFilePutStr(hFileIn, StrWinToDosX(sFileTitle))
.head 9 -  Call SalMessageBox('Не возможно произвести запись в файл ' || sFileName,
     'Внимание!', 0)
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Return -1
.head 8 +  If nDebVer = 1
.head 9 -  Call SalFilePutStr(hFileDebIn, sDebugMsg)
.head 9 -  !
.head 8 -  Set i = i + 1
.head 8 +  If i=nDocCou
.head 9 -  Set sDebugMsg = sDebugMsg||PutCrLf()||'Последний счет -  '
.head 9 -  Set sFileTitle = '   -- Всього по ' || sDocsForPrint[i-1,3] || ' ' ||
    SalNumberToStrX(nTotalSumNls/100, 2) || PutCrLf() || PutCrLf()
.head 9 -  Set sDebugMsg = sDebugMsg||PutCrLf()||sFileTitle
.head 9 -  ! сбиваем сумму в ноль для след счета + увеличиваем общую сумму
.head 9 -  Set nTotalSumRep = nTotalSumRep + nTotalSumNls
.head 9 +  If not SalFilePutStr(hFileIn, StrWinToDosX(sFileTitle))
.head 10 -  Call SalMessageBox('Невозможно произвести запись в файл ' || sFileName,
     'Внимание!', 0)
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Return -1
.head 7 -  ! поставим общую сумму
.head 7 -  Set sFileTitle = '-----------------------------------------------------------------------------------------------------------------------------------'
    || PutCrLf() || 'ВСЬОГО документів на суму: ' || StrToStrFormat(
    SalNumberToStrX(nTotalSumRep/100, 2), 41, ' ', TRUE) || PutCrLf()
.head 7 +  If not SalFilePutStr(hFileIn, StrWinToDosX(sFileTitle))
.head 8 -  Call SalMessageBox('Невозможно произвести запись в файл ' || sFileName,
     'Внимание!', 0)
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Return -1
.head 5 +  Function: copyArrayFromMx
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: SourceNum
.head 7 -  Number: DestNum
.head 7 -  Receive String: sArraySource[*,15]
.head 7 -  Receive String: sArrayDest[*,15]
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: i
.head 6 +  Actions
.head 7 -  Set i=0
.head 7 +  While i<15
.head 8 -  Set sArrayDest[DestNum, i ] = sArraySource[SourceNum, i]
.head 8 -  Set i=i+1
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton:
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box: cCheckBoxLabeled
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control: cMeter
.head 2 +  Application Actions
.head 3 -  On SAM_AppStartup
.head 1 +  Table Window: T_SQL
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 31334
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set pbDetails.strTip='Выполнить SQL + Commit'
.head 6 +  On SAM_Click
.head 7 -  If SqlPrepareAndExecute( hSql(), T_SQL.TXT )
and SqlCommitEx( hSql(), 'Вып.SQL'||T_SQL.NAME)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 31335
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 31336
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: KODZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Комментарий
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: TXT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: SQL
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Long String
.head 4 -  Justify: Left
.head 4 -  Width:  7.167"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set T_SQL.strSqlPopulate=
"SELECT KODZ,NAME,TXT
 into :T_SQL.KODZ,:T_SQL.NAME, :T_SQL.TXT
 from t_sql order by 1"
.head 4 -  Set T_SQL.strSqlUpdate=
"UPDATE t_sql set name=:T_SQL.NAME, txt=:T_SQL.TXT
 where kodz=:T_SQL.KODZ"
.head 4 -  Set T_SQL.strSqlDelete=
"DELETE from t_sql where kodz=:T_SQL.KODZ"
.head 4 -  Set T_SQL.strSqlInsert=
"INSERT into (KODZ,NAME,TXT) values
  (:T_SQL.KODZ,:T_SQL.NAME, :T_SQL.TXT )"
.head 1 -  !
.head 1 +  Dialog Box: dlg_ImpFil8
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Импорт информации для налогового учета из ОДБ филиала (BARS-3.01 "ОДБ-БАРС 1.98.01" - финансовый учет)
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.15"
.head 4 -  Top:    0.042"
.head 4 -  Width:  12.95"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.643"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Прием документов и оплата документов
из 'старого' БАРСа
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Всего:
.head 4 -  Resource Id: 7964
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.095"
.head 5 -  Width:  1.25"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.31"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 14
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfAll
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.483"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.31"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 14
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  ! Background Text: Выбрано:
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.783"
.head 5 -  Top:    0.095"
.head 5 -  Width:  1.717"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.31"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 14
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.end
.head 3 +  ! Data Field: dfGood
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.683"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.31"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 14
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -    Message Actions
.head 3 -  ! Background Text: Обработано:
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.983"
.head 5 -  Top:    0.095"
.head 5 -  Width:  2.167"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.31"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 14
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.end
.head 3 +  ! Data Field: dfCurrent
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.283"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.31"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 14
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -    Message Actions
.head 3 -  ! Background Text: Нет связи:
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.583"
.head 5 -  Top:    0.119"
.head 5 -  Width:  1.933"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.31"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 14
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Red
.head 4 -  Background Color: Default
.end
.head 3 +  ! Data Field: dfNoLink
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   11.65"
.head 6 -  Top:    0.119"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.31"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 14
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -    Message Actions
.head 3 +  Pushbutton: pbExecute
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Импорт
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    5.738"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If IsBankDayOpen()
.head 7 +  If MessageQuestion(
   'Выполнять импорт документов (КВАРТАЛ - ' ||
   Str(dfKw) || ') с ' || Str(dfDbeg) ||
   '-го месяца по ' || Str(dfDend) || '-й месяц ?') =
   IDNO
.head 8 -  Return FALSE
.head 7 -  Call WaitCursorOn()
.head 7 -  Call SalDisableWindow(pbExecute)
.head 7 -  Call SalDisableWindow(pbExit)
.head 7 -  Set dfDone = ""
.head 7 -  Set dfStart = 'Старт: ' || SalFmtFormatDateTime(
    SalDateCurrent(), 'hhh:mm:ss')
.head 7 -  Call SalUseRegistry(FALSE, '')
.head 7 -  Call SalGetProfileString('Import', 'SbuPath',
     Left(SalFileGetDrive(), 1) ||
     ':\\BARS98\\ODBC\\SBU', sSbuPath,
     GetIniFileName())
.head 7 -  Call SalGetProfileString('Import', 'BalansPath',
     Left(SalFileGetDrive(), 1) ||
     ':\\BARS98\\ODBC\\BALANS', sBalansPath,
     GetIniFileName())
.head 7 -  Call SaveInfoToLog("Импорт документов налогового учета.")
.head 7 +  If File(sBalansPath || '\\Balans.dbf') and
   File(sSbuPath || '\\SBU.dbf')
.head 8 -  Set SqlDatabase = 'dBase_Files'
.head 8 -  Call SalFileSetCurrentDirectory(sBalansPath)
.head 8 +  If SqlConnect(hSqlA)
.head 9 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT count(*)
     FROM balans
     INTO :nRecCount")
.head 9 -  Call SqlFetchNext(hSqlA, nFetchRes)
.head 9 +  If nRecCount < 2
.head 10 -  Call SqlDisconnect(hSqlA)
.head 10 -  Call SalMessageBeep(-1)
.head 10 -  Call WaitCursorOff()
.head 10 -  Call MessageNoWait('Нет информации или файл ' ||
     sBalansPath || '\\Balans.dbf занят.',
     'Сообщение', 7, 1)
.head 10 -  Call SalEnableWindow(pbExit)
.head 10 -  Return FALSE
.head 8 +  Else
.head 9 -  Call MessageAttention(
     'Ошибка подсоединения к Базе данных: ' ||
     SqlDatabase)
.head 8 -  Set SqlDatabase = 'dBase_Files'
.head 8 -  Call SalFileSetCurrentDirectory(sSbuPath)
.head 8 +  If SqlConnect(hSqlA)
.head 9 -  Call SalArraySetUpperBound(sSbuNLS, 1, -1)
.head 9 -  Call SalArraySetUpperBound(sSbuNLS8, 1, -1)
.head 9 -  Call SalArraySetUpperBound(nSbuFLAG, 1, -1)
.head 9 -  Set SqlDatabase = 'dBase_Files'
.head 9 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT nls,nls8,flag
     FROM sbu
     INTO :sNLS,:sNLS8,:nFLAG")
.head 9 -  Set n21 = 0
.head 9 +  While SqlFetchNext(hSqlA, nFetchRes)
.head 10 -  Set sSbuNLS[n21] = SalStrTrimX(sNLS)
.head 10 -  Set sSbuNLS8[n21] = SalStrTrimX(sNLS8)
.head 10 -  Set nSbuFLAG[n21] = IifN(nFLAG=NUMBER_Null, 0,
    nFLAG)
.head 10 -  Set n21 = n21 + 1
.head 9 -  Call SqlDisconnect(hSqlA)
.head 9 -  Set nTimeStart = SalDateHour(
    SalDateCurrent())*3600 + SalDateMinute(
    SalDateCurrent())*60 + SalDateSecond(
    SalDateCurrent())
.head 9 -  Set dfStart = 'Старт: ' || SalFmtFormatDateTime(
    SalDateCurrent(), 'hhh:mm:ss')
.head 9 -  Set dfAll = nRecCount
.head 9 -  Set nPos = 0
.head 9 -  Set nTek = 0
.head 9 -  Set nRecn = 1
.head 9 -  Set nDelta = 100 / nRecCount
.head 9 -  Set SqlDatabase = 'dBase_Files'
.head 9 -  Call SalFileSetCurrentDirectory(sBalansPath)
.head 9 +  If not SqlConnect(hSqlA)
.head 10 -  Call SqlDisconnect(hSqlA)
.head 10 -  Call SalMessageBeep(-1)
.head 10 -  Call WaitCursorOff()
.head 10 -  Call MessageAttention(
     'Ошибка подсоединения к Базе данных: ' ||
     SqlDatabase)
.head 10 -  Call SalEnableWindow(pbExit)
.head 10 -  Return FALSE
.head 9 -  Call SqlSetResultSet(hSqlA, FALSE)
.head 9 -  Call SqlPrepare(hSqlA, "
     SELECT rowid,nls,d01,k01,d02,k02,d03,k03,d04,
            k04,d05,k05,d06,k06,d07,k07,d08,k08,
            d09,k09,d10,k10,d11,k11,d12,k12
     INTO :nRow,:sNls,:nd01,:nk01,:nd02,:nk02,
          :nd03,:nk03,:nd04,:nk04,:nd05,:nk05,
          :nd06,:nk06,:nd07,:nk07,:nd08,:nk08,
          :nd09,:nk09,:nd10,:nk10,:nd11,:nk11,
          :nd12,:nk12
     FROM balans")
.head 9 -  Call SqlOpen(hSqlA, "balans")
.head 9 +  While SqlFetchNext(hSqlA, nFetchRes)
.head 10 -  Set sNls = SalStrTrimX(sNls)
.head 10 -  Set nIndex0 =
    VisArrayFindString(sSbuNLS, sNls)
.head 10 +  If nIndex0 >= 0 !! есть
.head 11 -  ! вставить строку и покрасить в самый ГАЛИМЫЙ
! цвет, какой только может быть в природе
.head 11 -  Set nNewRow = SalTblInsertRow(tbl1,
    TBL_MaxRow)
.head 11 -  Call SalTblSetContext(tbl1, nNewRow)
.head 11 -  Set tbl1.colNPP = nRecn
.head 11 -  Set tbl1.colNls = sNls
.head 11 -  Set tbl1.col01 = (nk01 - nd01) / 100
.head 11 -  Set tbl1.col02 = (nk02 - nd02) / 100
.head 11 -  Set tbl1.col03 = (nk03 - nd03) / 100
.head 11 -  Set tbl1.col04 = (nk04 - nd04) / 100
.head 11 -  Set tbl1.col05 = (nk05 - nd05) / 100
.head 11 -  Set tbl1.col06 = (nk06 - nd06) / 100
.head 11 -  Set tbl1.col07 = (nk07 - nd07) / 100
.head 11 -  Set tbl1.col08 = (nk08 - nd08) / 100
.head 11 -  Set tbl1.col09 = (nk09 - nd09) / 100
.head 11 -  Set tbl1.col10 = (nk10 - nd10) / 100
.head 11 -  Set tbl1.col11 = (nk11 - nd11) / 100
.head 11 -  Set tbl1.col12 = (nk12 - nd12) / 100
.head 11 -  Call SalTblSetFocusRow(tbl1, nNewRow)
.head 11 -  Call SalTblSetRowFlags(tbl1, nNewRow,
     ROW_Edited | ROW_New, FALSE)
.head 11 -  Call SalTblSetCellTextColor(tbl1.colNPP,
     COLOR_Chartreuse, TRUE)
.head 11 -  Call SalTblSetCellTextColor(tbl1.colNls,
     COLOR_Chartreuse, TRUE)
.head 11 -  Call SalTblSetCellTextColor(tbl1.col01,
     COLOR_Chartreuse, TRUE)
.head 11 -  Call SalTblSetCellTextColor(tbl1.col02,
     COLOR_Chartreuse, TRUE)
.head 11 -  Call SalTblSetCellTextColor(tbl1.col03,
     COLOR_Chartreuse, TRUE)
.head 11 -  Call SalTblSetCellTextColor(tbl1.col04,
     COLOR_Chartreuse, TRUE)
.head 11 -  Call SalTblSetCellTextColor(tbl1.col05,
     COLOR_Chartreuse, TRUE)
.head 11 -  Call SalTblSetCellTextColor(tbl1.col06,
     COLOR_Chartreuse, TRUE)
.head 11 -  Call SalTblSetCellTextColor(tbl1.col07,
     COLOR_Chartreuse, TRUE)
.head 11 -  Call SalTblSetCellTextColor(tbl1.col08,
     COLOR_Chartreuse, TRUE)
.head 11 -  Call SalTblSetCellTextColor(tbl1.col09,
     COLOR_Chartreuse, TRUE)
.head 11 -  Call SalTblSetCellTextColor(tbl1.col10,
     COLOR_Chartreuse, TRUE)
.head 11 -  Call SalTblSetCellTextColor(tbl1.col11,
     COLOR_Chartreuse, TRUE)
.head 11 -  Call SalTblSetCellTextColor(tbl1.col12,
     COLOR_Chartreuse, TRUE)
.head 11 -  Set nI = dfDbeg
.head 11 -  Set ntt3 = nSbuFLAG[nIndex0]
.head 11 -  Set sNls8 = sSbuNLS8[nIndex0]
.head 11 +  If Len(sNls8) > 0
.head 12 +  While nI <= dfDend
.head 13 +  Select Case nI
.head 14 +  Case 1
.head 15 -  Set nS = nk01 - nd01
.head 15 -  Break
.head 14 +  Case 2
.head 15 -  Set nS = nk02 - nd02
.head 15 -  Break
.head 14 +  Case 3
.head 15 -  Set nS = nk03 - nd03
.head 15 -  Break
.head 14 +  Case 4
.head 15 -  Set nS = nk04 - nd04
.head 15 -  Break
.head 14 +  Case 5
.head 15 -  Set nS = nk05 - nd05
.head 15 -  Break
.head 14 +  Case 6
.head 15 -  Set nS = nk06 - nd06
.head 15 -  Break
.head 14 +  Case 7
.head 15 -  Set nS = nk07 - nd07
.head 15 -  Break
.head 14 +  Case 8
.head 15 -  Set nS = nk08 - nd08
.head 15 -  Break
.head 14 +  Case 9
.head 15 -  Set nS = nk09 - nd09
.head 15 -  Break
.head 14 +  Case 10
.head 15 -  Set nS = nk10 - nd10
.head 15 -  Break
.head 14 +  Case 11
.head 15 -  Set nS = nk11 - nd11
.head 15 -  Break
.head 14 +  Case 12
.head 15 -  Set nS = nk12 - nd12
.head 15 -  Break
.head 13 +  If Abs(nS) > 0
.head 14 -  Set sNLSA = IifS(nS>0, sNU, sNls8)
.head 14 -  Set sNLSB = IifS(nS>0, sNls8, sNU)
.head 14 -  Set sTT = 'NU' || IifS(nS<0,
    IifS(ntt3=1, '4', '2'),
    IifS(ntt3=1, '3', '1'))
.head 14 -  Set sNazn = 'Импорт проводок НУ филиала -'
    || ' счет ' || sNls
.head 14 -  Set sND = Str(dfGod) || '-' ||
    Right(Str(nI+100), 2)
.head 14 -  Set dFirstNext = SalDateConstruct(dfGod+
    IifN(nI=12, 1, 0),
    IifN(nI=12, 1, nI+1), 1, 0, 0, 0)
.head 14 -  ! dVAL = последний рабочий день месяца nI
.head 14 -  Call SqlPrepareAndExecute(hSql(), T("
     SELECT max(fdat)
     INTO :dVAL
     FROM fdat
     WHERE fdat<:dFirstNext"))
.head 14 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 14 +  If dVAL != dfBD
.head 15 -  Call Pl_dat(dVAL) ! Установить
                  ! банковскую дату
                  ! равной VDATE в MOPER
                  ! (но не совсем)
.head 15 -  Set dfBD = dVAL
.head 14 +  If cbNew
.head 15 -  ! ЗАМОЧИТЬ старую информацию (Ful_Bak)
.head 15 -  Call SqlPrepareAndExecute(hSql(), T("
     SELECT ref
     INTO :nRefBak
     FROM nu_fil
     WHERE yyyy=:dfGod and mm=:nI and
           nls=:sNls"))
.head 15 +  If SqlFetchNext(hSql(), nFetchRes)
.head 16 +  If Ful_Bak(nRefBak)
.head 17 +  If SqlPrepareAndExecute(hSql(), T("
   DELETE
   FROM nu_fil
   WHERE ref=:nRefBak"))
.head 18 -  Call SqlCommit(hSql())
.head 17 +  Else
.head 18 -  Call SqlRollback(hSql())
.head 14 -  Call SqlPrepareAndExecute(hSql(), T("
     SELECT s
     INTO :nSU
     FROM nu_fil
     WHERE yyyy=:dfGod and mm=:nI and
           nls=:sNls"))
.head 14 +  If SqlFetchNext(hSql(), nFetchRes)
.head 15 -  ! УЖЕ БЫЛО значит
.head 15 -  ! покрасить колонку строки в цвет,
! обозначающий что УЖЕ БЫЛО ЭТО и если
! nSU=nS, то ХОРОШИЙ цвет, иначе ПЛОХОЙ
.head 15 +  Select Case nI
.head 16 +  Case 1
.head 17 -  Call SalTblSetCellTextColor(tbl1.col01,
     IifN(nSU=nS, COLOR_Magenta,
     COLOR_Marigold), TRUE)
.head 17 -  Break
.head 16 +  Case 2
.head 17 -  Call SalTblSetCellTextColor(tbl1.col02,
     IifN(nSU=nS, COLOR_Magenta,
     COLOR_Marigold), TRUE)
.head 17 -  Break
.head 16 +  Case 3
.head 17 -  Call SalTblSetCellTextColor(tbl1.col03,
     IifN(nSU=nS, COLOR_Magenta,
     COLOR_Marigold), TRUE)
.head 17 -  Break
.head 16 +  Case 4
.head 17 -  Call SalTblSetCellTextColor(tbl1.col04,
     IifN(nSU=nS, COLOR_Magenta,
     COLOR_Marigold), TRUE)
.head 17 -  Break
.head 16 +  Case 5
.head 17 -  Call SalTblSetCellTextColor(tbl1.col05,
     IifN(nSU=nS, COLOR_Magenta,
     COLOR_Marigold), TRUE)
.head 17 -  Break
.head 16 +  Case 6
.head 17 -  Call SalTblSetCellTextColor(tbl1.col06,
     IifN(nSU=nS, COLOR_Magenta,
     COLOR_Marigold), TRUE)
.head 17 -  Break
.head 16 +  Case 7
.head 17 -  Call SalTblSetCellTextColor(tbl1.col07,
     IifN(nSU=nS, COLOR_Magenta,
     COLOR_Marigold), TRUE)
.head 17 -  Break
.head 16 +  Case 8
.head 17 -  Call SalTblSetCellTextColor(tbl1.col08,
     IifN(nSU=nS, COLOR_Magenta,
     COLOR_Marigold), TRUE)
.head 17 -  Break
.head 16 +  Case 9
.head 17 -  Call SalTblSetCellTextColor(tbl1.col09,
     IifN(nSU=nS, COLOR_Magenta,
     COLOR_Marigold), TRUE)
.head 17 -  Break
.head 16 +  Case 10
.head 17 -  Call SalTblSetCellTextColor(tbl1.col10,
     IifN(nSU=nS, COLOR_Magenta,
     COLOR_Marigold), TRUE)
.head 17 -  Break
.head 16 +  Case 11
.head 17 -  Call SalTblSetCellTextColor(tbl1.col11,
     IifN(nSU=nS, COLOR_Magenta,
     COLOR_Marigold), TRUE)
.head 17 -  Break
.head 16 +  Case 12
.head 17 -  Call SalTblSetCellTextColor(tbl1.col12,
     IifN(nSU=nS, COLOR_Magenta,
     COLOR_Marigold), TRUE)
.head 17 -  Break
.head 14 +  Else
.head 15 -  ! можно МОЧИТЬ проводку
.head 15 -  Set nRef = NUMBER_Null
.head 15 -  Call ccDoc.SetDoc(nRef, sTT, 1, 6, sND,
                  dfBD, dfBD, dVAL,
                  DATETIME_Null, sNLSA,
                  'Счет  налогового ' ||
                  'учета ' || sNLSA,
                  GetBankMfo(), '',
                  GetBaseVal(), Abs(nS),
                  '', sNLSB, 'Счет ' ||
                  'налогового учета ' ||
                  sNLSB, GetBankMfo(),
                  '', GetBaseVal(),
                  Abs(nS), '', sNazn,
                  '', '', '',
                  NUMBER_Null,
                  NUMBER_Null)
.head 15 +  If ccDoc.oDoc()
.head 16 -  Set nRef = ccDoc.m_nRef
.head 16 +  If SqlPrepareAndExecute(hSql(), T("
   INSERT
   INTO nu_fil (kf,yyyy,mm,nls,s,tt,
                datp,ref)
   VALUES (1,:dfGod,:nI,:sNls,:nS,:sTT,
           :dfBD,:nRef)"))
.head 17 -  ! покрасить ячейку в самый КРАСИВЫЙ
! (зеленый) цвет
.head 17 +  Select Case nI
.head 18 +  Case 1
.head 19 -  Call SalTblSetCellTextColor(
     tbl1.col01, COLOR_DarkGreen,
     TRUE)
.head 19 -  Break
.head 18 +  Case 2
.head 19 -  Call SalTblSetCellTextColor(
     tbl1.col02, COLOR_DarkGreen,
     TRUE)
.head 19 -  Break
.head 18 +  Case 3
.head 19 -  Call SalTblSetCellTextColor(
     tbl1.col03,
     COLOR_DarkGreen, TRUE)
.head 19 -  Break
.head 18 +  Case 4
.head 19 -  Call SalTblSetCellTextColor(
     tbl1.col04,
     COLOR_DarkGreen, TRUE)
.head 19 -  Break
.head 18 +  Case 5
.head 19 -  Call SalTblSetCellTextColor(
     tbl1.col05,
     COLOR_DarkGreen, TRUE)
.head 19 -  Break
.head 18 +  Case 6
.head 19 -  Call SalTblSetCellTextColor(
     tbl1.col06,
     COLOR_DarkGreen, TRUE)
.head 19 -  Break
.head 18 +  Case 7
.head 19 -  Call SalTblSetCellTextColor(
     tbl1.col07,
     COLOR_DarkGreen, TRUE)
.head 19 -  Break
.head 18 +  Case 8
.head 19 -  Call SalTblSetCellTextColor(
     tbl1.col08,
     COLOR_DarkGreen, TRUE)
.head 19 -  Break
.head 18 +  Case 9
.head 19 -  Call SalTblSetCellTextColor(
     tbl1.col09,
     COLOR_DarkGreen, TRUE)
.head 19 -  Break
.head 18 +  Case 10
.head 19 -  Call SalTblSetCellTextColor(
     tbl1.col10,
     COLOR_DarkGreen, TRUE)
.head 19 -  Break
.head 18 +  Case 11
.head 19 -  Call SalTblSetCellTextColor(
     tbl1.col11,
     COLOR_DarkGreen, TRUE)
.head 19 -  Break
.head 18 +  Case 12
.head 19 -  Call SalTblSetCellTextColor(
     tbl1.col12,
     COLOR_DarkGreen, TRUE)
.head 19 -  Break
.head 17 -  Call SqlCommit(hSql())
.head 13 -  Set nI = nI + 1
.head 10 -  Set nPos = nPos + nDelta
.head 10 -  Set nRecn = nRecn + 1
.head 10 +  If Int(nPos) != nTek
.head 11 -  Set nTek = Int(nPos)
.head 11 -  Set nTimeCurrent = SalDateHour(
    SalDateCurrent())*3600 + SalDateMinute(
    SalDateCurrent())*60 + SalDateSecond(
    SalDateCurrent())
.head 11 -  Set nTimeEnd = Int(100 *
    (nTimeCurrent-nTimeStart) / nPos +
    nTimeStart)
.head 11 -  Set nHour = Int(nTimeEnd/3600)
.head 11 -  Set nTemp = nTimeEnd - nHour*3600
.head 11 -  Set nMinu = Int(nTemp/60)
.head 11 -  Set dfAll = dfAll
.head 11 -  Set dfStart = dfStart
.head 11 -  Set dfEnd = 'Финиш: ' ||
    Right(Str(100+nHour), 2) || ':' ||
    Right(Str(100+nMinu), 2) || ':' ||
    Right(Str(100+nTemp-nMinu*60), 2) ||
    ' (прогноз)'
.head 10 -  Call ccProgressBar.SetProgress(nPos)
.head 10 -  Call SalUpdateWindow(hWndForm)
.head 9 -  Call ccProgressBar.SetProgress(100)
.head 9 -  Set dfEnd = Left(dfEnd, 15)
.head 9 -  Call SqlDisconnect(hSqlA)
.head 9 -  Call SaveInfoToLog("Прием документов " ||
     "налогового учета ОКОНЧЕН.")
.head 9 -  Set dfDone = "Готово"
.head 9 -  Call SalMessageBeep(-1)
.head 9 -  Call SalSetFocus(tbl1)
.head 9 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 8 +  Else
.head 9 -  Call MessageAttention(
     'Ошибка подсоединения к Базе данных: ' ||
     SqlDatabase)
.head 7 +  Else
.head 8 -  Call MessageAttention('Нет файла: ' || sBalansPath
     || '\\Balans.dbf или ' || sSbuPath ||
     '\\SBU.dbf')
.head 7 -  Call SalEnableWindow(pbExecute)
.head 7 -  Call SalEnableWindow(pbExit)
.head 7 -  Call SalSetFocus(pbExit)
.head 7 -  Call WaitCursorOff()
.head 6 +  Else
.head 7 -  Call MessageNoWait('День закрыт !', 'Предупреждение', 0,
     1)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   10.983"
.head 5 -  Top:    5.738"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 -  Frame
.head 4 -  Resource Id: 7968
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    5.571"
.head 5 -  Width:  12.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 3 +  Data Field: dfDone
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.783"
.head 6 -  Top:    5.845"
.head 6 -  Width:  2.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Magenta
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Custom Control: ccProgressBar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    5.238"
.head 6 -  Width:  12.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Jade
.head 5 -  Background Color: Gray
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.488"
.head 6 -  Width:  12.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.0"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 333333
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colNPP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nпп
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.514"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNls
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 15
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.657"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col01
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 01
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col02
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 02
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col03
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 03
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col04
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 04
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col05
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 05
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col06
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 06
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col07
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 07
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col08
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 08
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col09
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 09
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col10
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 10
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col11
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 11
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: col12
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 12
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.614"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nFocusRow
.head 5 -  Window Handle: hWndCol
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetLockedColumns(tbl1, 2)
.head 5 +  On SAM_Click
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 6 +  If not SalIsWindowEnabled(pbExecute)
.head 7 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 +  On SAM_CornerClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_CornerDoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_RowHeaderClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_EndCellTab
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On WM_LbuttonUp
.head 6 -  ! Узнать текущую строку
.head 6 -  ! Call SalTblQueryFocus(tbl1, nFocusRow, hWndCol)
.head 6 -  ! Set nFocusRow = SalTblQueryContext(tbl1)
.head 6 -  ! Почистить все
.head 6 -  Call SalTblSetFlagsAnyRows(tbl1, ROW_Selected, FALSE, 0,
     0)
.head 6 -  ! Call SalTblSetFocusRow (tbl1, nFocusRow)
.head 6 -  ! Стать на нее (что выше)
.head 6 -  ! Call SalTblSetRowFlags(tbl1, nFocusRow,
     ROW_Selected, FALSE)
.head 6 -  ! Call SalSendMsg(tbl1, SAM_RowHeaderClick, 0,
     Max(TBL_MaxRow, nFocusRow+1))
.head 5 +  On VTM_KeyUp
.head 6 -  Call SalTblSetFlagsAnyRows(tbl1, ROW_Selected, FALSE, 0,
     0)
.head 6 +  If not SalIsWindowEnabled(pbExecute)
.head 7 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 +  On WM_NCMouseMove ! 160
.head 6 +  If not SalIsWindowEnabled(pbExecute)
.head 7 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 3 +  Data Field: dfStart
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    5.679"
.head 6 -  Width:  6.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfEnd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    5.929"
.head 6 -  Width:  6.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Дата отчетного периода
.head 4 -  Resource Id: 7970
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.383"
.head 5 -  Top:    4.595"
.head 5 -  Width:  3.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Charcoal
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfBD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   10.683"
.head 6 -  Top:    4.821"
.head 6 -  Width:  1.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Burgundy
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfBD > dBankDate
.head 7 -  Call MessageNoWait('Локальная дата не может быть' ||
     ' больше текущей даты !', 'ОШИБКА', 30, 1)
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Call SalSendMsg(dfGod, SAM_Create, 0, 0)
.head 6 -  Call SalSendMsg(dfKw, SAM_Create, 0, 0)
.head 6 -  Call SalSendMsg(dfDbeg, SAM_Create, 0, 0)
.head 6 -  Call SalSendMsg(dfDend, SAM_Create, 0, 0)
.head 3 +  Radio Button: rbGodKw
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Год, квартал
.head 4 -  Window Location and Size
.head 5 -  Left:   3.783"
.head 5 -  Top:    4.655"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDisableWindow(dfDbeg)
.head 6 -  Call SalDisableWindow(dfDend)
.head 6 -  Call SalEnableWindow(dfGod)
.head 6 -  Call SalEnableWindow(dfKw)
.head 3 +  Radio Button: rbDates
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Интервал месяцев
.head 4 -  Window Location and Size
.head 5 -  Left:   3.783"
.head 5 -  Top:    4.905"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEnableWindow(dfDbeg)
.head 6 -  Call SalEnableWindow(dfDend)
.head 6 -  Call SalDisableWindow(dfGod)
.head 6 -  Call SalDisableWindow(dfKw)
.head 3 +  Data Field: dfGod
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 4
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.283"
.head 6 -  Top:    4.655"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Set dfGod = SalDateYear(SalDateCurrent()-1)
.head 6 -  Set dfGod = SalDateYear(dfBD-1)
.head 5 +  On SAM_Validate
.head 6 +  If dfGod > SalDateYear(dfBD)
.head 7 -  Call MessageNoWait('Недопустимый номер года', 'ОШИБКА',
     30, 1)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Call SetDbegDend(dfGod, dfKw)
.head 3 +  Data Field: dfKw
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 1
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.683"
.head 6 -  Top:    4.655"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfKw = SalDateQuarter(dfBD)
.head 5 +  On SAM_Validate
.head 6 +  If dfKw < 1 or dfKw > 4
.head 7 -  Call MessageNoWait('Недопустимый номер квартала.',
     'ОШИБКА', 30, 1)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Call SetDbegDend(dfGod, dfKw)
.head 3 +  Data Field: dfDbeg
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.283"
.head 6 -  Top:    4.905"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfDbeg = (SalDateQuarter(dfBD)-1)*3+1
.head 5 +  On SAM_Validate
.head 6 +  If dfGod = SalDateYear(dfBD) and
   dfDbeg > (SalDateQuarter(dfBD)-1)*3+3
.head 7 -  Call MessageNoWait('Месяц не может быть больше, чем в '
     || 'текущем квартале.', 'ОШИБКА', 30, 1)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Set dfKw = Int((dfDbeg-1)/3)+1
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalSetFocus(dfDend)
.head 6 -  Call SalSetFieldEdit(dfDend, TRUE)
.head 3 +  Data Field: dfDend
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.383"
.head 6 -  Top:    4.905"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set dfDend = (SalDateQuarter(dfBD)-1)*3+3
.head 5 +  On SAM_Validate
.head 6 +  If dfGod = SalDateYear(dfBD) and
   dfDend > (SalDateQuarter(dfBD)-1)*3+3
.head 7 -  Call MessageNoWait(IifS(dfDbeg>dfDend,
     'Второй месяц не может быть меньше первого.',
     'Месяц не может быть больше, чем в текущем ' ||
     'квартале.'), 'ОШИБКА', 30, 1)
.head 7 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Set dfKw = Int((dfDbeg-1)/3)+1
.head 3 -  Frame
.head 4 -  Resource Id: 7971
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.683"
.head 5 -  Top:    4.571"
.head 5 -  Width:  4.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 7973
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.183"
.head 5 -  Top:    4.571"
.head 5 -  Width:  3.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Drop-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Dark Gray
.head 4 -  Background Color: Default
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.483"
.head 5 -  Top:    4.821"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: \Bars98\RESOURCE\BMP\Cals.bmp
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Gray
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Check Box: cbNew
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: С обновлением данных
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    4.571"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: GetBankOperIdent
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sMfo
.head 5 -  String: sId
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sSab
.head 4 +  Actions
.head 5 -  Set sSab = GetValueStr("
    SELECT sab
    FROM banks
    WHERE mfo=" || sMfo)
.head 5 -  Return IifS(sSab='', 'xxx', Right(sSab, 3)) || 'O' || sId
.head 3 +  Function: SetDbegDend
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nGod
.head 5 -  Number: nKw
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set dfDbeg = nKw*3-2
.head 5 -  Set dfDend = nKw*3
.head 3 +  ! Function: DisableDates
.head 4 -    Description:
.head 4 -    Returns
.head 4 -    Parameters
.head 4 -    Static Variables
.head 4 -    Local variables
.head 4 +    Actions
.head 5 -    Call SalDisableWindow(dfDbeg)
.head 5 -    Call SalDisableWindow(dfDend)
.head 5 -    Call SalDisableWindow(rbDates)
.head 5 -    Set rbGodKw = TRUE
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: ND
.head 3 -  : ccDoc
.head 4 -  Class: cDoc
.head 3 -  String: NLS
.head 3 -  String: NLSK
.head 3 -  Number: KVS
.head 3 -  Number: SK
.head 3 -  Number: REF
.head 3 -  Number: ISV
.head 3 -  String: NAZN
.head 3 -  String: sTmp
.head 3 -  Number: nCount
.head 3 -  String: sAn
.head 3 -  String: sNbw
.head 3 -  Number: nNls
.head 3 -  String: sMfo
.head 3 -  String: sMfoA
.head 3 -  String: sMdl
.head 3 -  Number: nMfop
.head 3 -  Number: nFetchRes
.head 3 -  String: sBlk
.head 3 -  String: sFv
.head 3 -  String: sFs
.head 3 -  Number: nDocs
.head 3 -  Sql Handle: hSqlA
.head 3 -  Number: nPos
.head 3 -  Number: nDelta
.head 3 -  Number: nRecCount
.head 3 -  String: strMessage
.head 3 -  Number: nNm
.head 3 -  Number: nDk
.head 3 -  Number: nDk2
.head 3 -  Number: nMfo
.head 3 -  String: sNd
.head 3 -  Number: nVob
.head 3 -  String: sNls
.head 3 -  String: sNlsk
.head 3 -  String: sNls8
.head 3 -  Number: nSk
.head 3 -  Number: nS
.head 3 -  ! Date/Time: dDat
.head 3 -  String: sPlat
.head 3 -  String: sPolu
.head 3 -  String: sNaz1
.head 3 -  String: sVspo
.head 3 -  String: sKod
.head 3 -  String: sKisp
.head 3 -  Number: nRow
.head 3 -  Number: nRef
.head 3 -  String: sODBCDir
.head 3 -  Date/Time: dTmp
.head 3 -  Number: n99
.head 3 -  Number: nSos
.head 3 -  Number: nRef99bm
.head 3 -  Date/Time: dVdate
.head 3 -  Date/Time: dVdateOrig
.head 3 -  Date/Time: dVdateU
.head 3 -  Date/Time: dBankDate
.head 3 -  !
.head 3 -  Number: nNewRow
.head 3 -  !
.head 3 -  Number: nTimeStart
.head 3 -  Number: nTimeCurrent
.head 3 -  Number: nTimeEnd
.head 3 -  Number: nHour
.head 3 -  Number: nMinu
.head 3 -  Number: nTemp
.head 3 -  Number: nTek
.head 3 -  Number: nRecn
.head 3 -  !
.head 3 -  Number: nFlag
.head 3 -  Number: n21
.head 3 -  Number: nStep
.head 3 -  !
.head 3 -  String: sNLS
.head 3 -  String: sNLS8
.head 3 -  Number: nFLAG
.head 3 -  String: sSbuNLS[*]
.head 3 -  String: sSbuNLS8[*]
.head 3 -  Number: nSbuFLAG[*]
.head 3 -  Number: nIndex0
.head 3 -  Number: nIndex1
.head 3 -  !
.head 3 -  Date/Time: dDat1
.head 3 -  !
.head 3 -  Boolean: bDalee
.head 3 -  Boolean: bSD
.head 3 -  !
.head 3 -  String: sTp
.head 3 -  !
.head 3 -  String: sNLS1
.head 3 -  String: sNLS2
.head 3 -  Number: n22
.head 3 -  Number: nI
.head 3 -  Boolean: bStop
.head 3 -  !
.head 3 -  Number: nRefO
.head 3 -  !
.head 3 -  Boolean: bMa
.head 3 -  Boolean: bMc
.head 3 -  !
.head 3 -  Boolean: bProdol
.head 3 -  !
.head 3 -  String: sRnk
.head 3 -  !
.head 3 -  Date/Time: dTemp
.head 3 -  !
.head 3 -  String: sCurDir
.head 3 -  String: sOdbkPath
.head 3 -  !
.head 3 -  String: sBalAcc
.head 3 -  String: sBalAccn
.head 3 -  !
.head 3 -  Number: nL0
.head 3 -  Number: nL1
.head 3 -  !
.head 3 -  ! String: sSaldoNLS[*]
.head 3 -  ! String: sSaldoNMS[*]
.head 3 -  String: sNAMS
.head 3 -  !
.head 3 -  Number: nd01
.head 3 -  Number: nk01
.head 3 -  Number: nd02
.head 3 -  Number: nk02
.head 3 -  Number: nd03
.head 3 -  Number: nk03
.head 3 -  Number: nd04
.head 3 -  Number: nk04
.head 3 -  Number: nd05
.head 3 -  Number: nk05
.head 3 -  Number: nd06
.head 3 -  Number: nk06
.head 3 -  Number: nd07
.head 3 -  Number: nk07
.head 3 -  Number: nd08
.head 3 -  Number: nk08
.head 3 -  Number: nd09
.head 3 -  Number: nk09
.head 3 -  Number: nd10
.head 3 -  Number: nk10
.head 3 -  Number: nd11
.head 3 -  Number: nk11
.head 3 -  Number: nd12
.head 3 -  Number: nk12
.head 3 -  String: sSbuPath
.head 3 -  String: sBalansPath
.head 3 -  ! String: sSaldoPath
.head 3 -  Number: ntt3
.head 3 -  String: sNLSA
.head 3 -  String: sNLSB
.head 3 -  String: sTT
.head 3 -  String: sNazn
.head 3 -  String: sND
.head 3 -  String: sNMS
.head 3 -  Number: nSU
.head 3 -  Date/Time: dVAL
.head 3 -  Date/Time: dFirstNext
.head 3 -  String: sNU
.head 3 -  !
.head 3 -  Number: nRefBak
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalFileGetCurrentDirectory(sCurDir)
.head 4 -  Set dBankDate = GetBankDate()
.head 4 -  Set dfBD = dBankDate
.head 4 -  Call SqlPrepareAndExecute(hSql(), T("
     SELECT nlsm
     INTO :sNU
     FROM TTS
     WHERE tt='NU1'"))
.head 4 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalSetFocus(pbExit)
.head 4 -  ! Call DisableDates()
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_Destroy
.head 4 -  Call SalFileSetCurrentDirectory(sCurDir)
.head 4 -  Call Pl_dat(dBankDate)
.head 1 -  !
.head 1 +  Form Window: frm_Acc4EK
.head 2 -  Class: cSplitterWindow
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Счета для отбора в выписки электронным клиентам
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.275"
.head 4 -  Top:    0.229"
.head 4 -  Width:  12.3"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.321"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description: Редактирование списка счетов для отбора в выписку электронным клиентам
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.429"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Перечитать данные"
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(tbl_eCustomer, SAM_Create, 0, 0)
.head 4 -  Line
.head 5 -  Resource Id: 20917
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  0.7"
.head 6 -  Begin Y:  0.024"
.head 6 -  End X:  0.7"
.head 6 -  End Y:  0.429"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbFilter
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.833"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Установить фильтр"
.head 6 +  On SAM_Click
.head 7 +  If SetQueryFilter(cFCust)
.head 8 -  Call SalSendMsg(tbl_eCustomer, SAM_Create, 0, 0)
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSearch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.267"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Поиск строки"
.head 6 +  On SAM_Click
.head 7 -  Call TblFindString(tbl_eCustomer, 1)
.head 4 -  Line
.head 5 -  Resource Id: 20918
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  1.817"
.head 6 -  Begin Y:  0.024"
.head 6 -  End X:  1.817"
.head 6 -  End Y:  0.429"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.95"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Сохранить данные"
.head 6 +  On SAM_Click
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(tbl_Acc, nRow, ROW_Edited, 0)
.head 8 -  Call SalTblSetContext(tbl_Acc, nRow)
.head 8 +  If tbl_Acc.colUse != tbl_Acc.colUsePrev
.head 9 -  Set fIsOk = FALSE
.head 9 +  If tbl_Acc.colUsePrev = 0
.head 10 -  Set fIsOk = SqlPrepareAndExecute(cMisc.hSql(), "
    INSERT
    INTO   acce (acc,pers,high)
    VALUES (:tbl_Acc.colAcc,:tbl_Acc.colPers,:tbl_Acc.colHigh)")
.head 10 -  Set fIsOk = SqlPrepareAndExecute(cMisc.hSql(), "
    UPDATE accounts
    SET    opt=nvl(opt,0)+4
    WHERE  acc=:tbl_Acc.colAcc")
.head 9 +  Else
.head 10 -  Set fIsOk = SqlPrepareAndExecute(cMisc.hSql(), "
    DELETE
    FROM   acce
    WHERE  acc=:tbl_Acc.colAcc")
.head 10 -  Set fIsOk = SqlPrepareAndExecute(cMisc.hSql(), "
    UPDATE accounts
    SET    opt=iif_n(nvl(opt,0)-4,0,null,null,nvl(opt,0)-4)
    WHERE  acc=:tbl_Acc.colAcc")
.head 9 +  If fIsOk
.head 10 -  Call SqlCommitEx(cMisc.hSql(), "Изменен статус выборки счёта " || tbl_Acc.colNLS || "(" || tbl_Acc.colISOKV ||
     ") в выписку эл.клиенту - " || IifS(tbl_Acc.colUsePrev=0, '', 'НЕ') || "доступен")
.head 8 +  Else
.head 9 +  If tbl_Acc.colPers != tbl_Acc.colPersPrev
.head 10 -  Set fIsOk = FALSE
.head 10 +  If tbl_Acc.colUse = 1
.head 11 -  Set fIsOk = SqlPrepareAndExecute(cMisc.hSql(), "
    UPDATE acce
    SET    pers=:tbl_Acc.colPers
    WHERE  acc=:tbl_Acc.colAcc")
.head 10 +  If fIsOk
.head 11 -  Call SqlCommitEx(cMisc.hSql(), "Изменен статус выборки счёта " || tbl_Acc.colNLS || "(" || tbl_Acc.colISOKV ||
     ") в выписку эл.клиенту - " || IifS(tbl_Acc.colPersPrev=0, '', 'НЕ') || "доступен себе")
.head 9 +  If tbl_Acc.colHigh != tbl_Acc.colHighPrev
.head 10 -  Set fIsOk = FALSE
.head 10 +  If tbl_Acc.colUse = 1
.head 11 -  Set fIsOk = SqlPrepareAndExecute(cMisc.hSql(), "
    UPDATE acce
    SET    high=:tbl_Acc.colHigh
    WHERE  acc=:tbl_Acc.colAcc")
.head 10 +  If fIsOk
.head 11 -  Call SqlCommitEx(cMisc.hSql(), "Изменен статус выборки счёта " || tbl_Acc.colNLS || "(" || tbl_Acc.colISOKV ||
     ") в выписку эл.клиенту - " || IifS(tbl_Acc.colHighPrev=0, '', 'НЕ') || "доступен вышестоящим клиентам")
.head 7 -  Call SalSendMsg(tbl_Acc, UM_Populate, tbl_eCustomer.colRNK, 0)
.head 7 -  Call SalWaitCursor(FALSE)
.head 4 -  Line
.head 5 -  Resource Id: 20919
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.5"
.head 6 -  Begin Y:  0.024"
.head 6 -  End X:  2.5"
.head 6 -  End Y:  0.429"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbCancel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.617"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Закончить работу функции"
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 2 +  Contents
.head 3 +  Custom Control: ccSplitter
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cSplitterWindow
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.567"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tbl_eCustomer
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    0.202"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.833"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 22222
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colRNK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рег.
Номер
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSAB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Эл.
код
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 4
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNMK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
клиента
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  9.467"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nLastSortColId
.head 5 -  Number: nCurrSortColId
.head 5 -  Number: nSortDirection
.head 5 -  Window Handle: hCurrSortCol
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set nSortDirection = 1
.head 6 -  Set nLastSortColId = -1
.head 6 -  Call SalTblPopulate(hWndItem, cCust.hSql(), T(cQCust.GetFullSQLString(cFCust)), TBL_FillNormal)
.head 6 -  Call SalTblSetContext(hWndItem, 0)
.head 6 -  Call SalTblSetFocusRow(hWndItem, 0)
.head 6 -  Call SalTblSetRowFlags(hWndItem, 0, ROW_Selected, TRUE)
.head 6 -  Call SalPostMsg(tbl_Acc, UM_Populate, colRNK, 0)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On SAM_TblDoDetails
.head 6 -  Call SalPostMsg(tbl_Acc, UM_Populate, colRNK, 0)
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set hCurrSortCol = SalNumberToWindowHandle(wParam)
.head 6 -  Call SalTblSetColumnFlags(hCurrSortCol, COL_Selected, FALSE)
.head 6 -  Set nCurrSortColId = SalTblQueryColumnID(hCurrSortCol)
.head 6 +  If nCurrSortColId != nLastSortColId
.head 7 -  Set nLastSortColId = nCurrSortColId
.head 7 -  Set nSortDirection = 1
.head 6 +  Else
.head 7 -  Set nSortDirection = 1 - nSortDirection
.head 6 -  Call SalTblSortRows(hWndItem, nCurrSortColId, nSortDirection)
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 +  Child Table: tbl_Acc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.667"
.head 6 -  Top:    0.0"
.head 6 -  Width:  5.133"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2222
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colAcc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Acc
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер счёта
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colISOKV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colUse
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Отби
рать
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.767"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPers
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Себе
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colHigh
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Выше-
стоящ.
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colUsePrev
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Prev.Val
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPersPrev
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Prev.Val
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colHighPrev
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Prev.Val
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nLAcc
.head 5 -  Number: nHigh
.head 5 -  Number: nPers
.head 5 -  !
.head 5 -  Number: nLastSortColId
.head 5 -  Number: nCurrSortColId
.head 5 -  Number: nSortDirection
.head 5 -  Window Handle: hCurrSortCol
.head 4 +  Message Actions
.head 5 +  On UM_Populate
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set nSortDirection = 1
.head 6 -  Set nLastSortColId = -1
.head 6 -  Call SalTblPopulate(hWndItem, cAcc.hSql(), T("
     SELECT a.acc,a.nls,t.lcv
     INTO   :colAcc,:colNLS,:colISOKV
     FROM   accounts a, tabval t, cust_acc c
     WHERE  c.acc=a.acc AND t.kv=a.kv AND c.rnk=:wParam
     ORDER  BY 3,2"), TBL_FillAll)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On SAM_FetchRowDone
.head 6 -  Call SqlPrepareAndExecute(cMisc.hSql(), "
     SELECT acc,nvl(pers,0),nvl(high,0)
     INTO   :nLAcc,:nPers,:nHigh
     FROM   acce
     WHERE  acc=:colAcc")
.head 6 +  If SqlFetchNext(cMisc.hSql(), nFetchRes)
.head 7 -  Set colUse = 1
.head 7 -  Set colUsePrev = 1
.head 7 -  Set colPers = nPers
.head 7 -  Set colPersPrev = nPers
.head 7 -  Set colHigh = nHigh
.head 7 -  Set colHighPrev = nHigh
.head 6 +  Else
.head 7 -  Set colUse = 0
.head 7 -  Set colUsePrev = 0
.head 7 -  Set colPers = 0
.head 7 -  Set colPersPrev = 0
.head 7 -  Set colHigh = 0
.head 7 -  Set colHighPrev = 0
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set hCurrSortCol = SalNumberToWindowHandle(wParam)
.head 6 -  Call SalTblSetColumnFlags(hCurrSortCol, COL_Selected, FALSE)
.head 6 -  Set nCurrSortColId = SalTblQueryColumnID(hCurrSortCol)
.head 6 +  If nCurrSortColId != nLastSortColId
.head 7 -  Set nLastSortColId = nCurrSortColId
.head 7 -  Set nSortDirection = 1
.head 6 +  Else
.head 7 -  Set nSortDirection = 1 - nSortDirection
.head 6 -  Call SalTblSortRows(hWndItem, nCurrSortColId, nSortDirection)
.head 6 -  Call SalWaitCursor(FALSE)
.head 2 +  Functions
.head 3 +  Function: InitStmt
.head 4 -  Description: Инициализация кода выписки эл.клиента
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Set nSTMTValue = GetGlobalOptionEx('EPSTMT')
.head 5 +  ! If nSTMTValue = 0
.head 6 -  Set nSTMTValue = 5 ! тип выписки 'Электронный клиент'
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  : cCust
.head 4 -  Class: cABSConnect
.head 3 -  : cAcc
.head 4 -  Class: cABSConnect
.head 3 -  : cMisc
.head 4 -  Class: cABSConnect
.head 3 -  : cQCust
.head 4 -  Class: cGenQuery
.head 3 -  : cFCust
.head 4 -  Class: cGenFilter
.head 3 -  !
.head 3 -  Number: nListX
.head 3 -  Number: nListY
.head 3 -  !
.head 3 -  Number: nRow
.head 3 -  Boolean: fIsOk
.head 3 -  ! Number: nSTMTValue
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  !
.head 4 -  Call SaveInfoToLog("Начало работы функции 'Счета для отбора в выписки электронным клиентам'")
.head 4 -  !
.head 4 -  Call XConnectGetParams(cCust)
.head 4 +  If NOT cCust.Connect()
.head 5 -  Return FALSE
.head 4 -  Call cAcc.Clone(cCust, TRUE)
.head 4 -  Call cMisc.Clone(cCust, TRUE)
.head 4 -  !
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  !
.head 4 -  Call SalTblSetTableFlags(tbl_eCustomer, TBL_Flag_SelectableCols, TRUE)
.head 4 -  Call SalTblSetTableFlags(tbl_Acc, TBL_Flag_SelectableCols, TRUE)
.head 4 -  ! Инициализация переменной nSTMTValue - тип выписки эл. клиента
.head 4 -  Call InitStmt()
.head 4 -  ! -------------
.head 4 -  Call cFCust.Init('CUSTOMER', 'a')
.head 4 -  ! Call cQCust.Init("
     SELECT a.rnk,a.sab,a.nmk
     INTO :colRNK,:colSAB,:colNMK
     FROM customer a
     WHERE a.sab is not null and (a.stmt=:nSTMTValue or a.stmt=5)
     ORDER BY 2")
.head 4 -  Call SalSendClassMessage(SAM_Create, wParam, lParam)
.head 4 -  ! Call cQCust.Init("
     SELECT a.rnk,a.sab,a.nmk
     INTO :colRNK,:colSAB,:colNMK
     FROM customer2 a
     ORDER BY 2")
.head 4 -  ! Call cQCust.Init("
     SELECT a.rnk,a.sab,a.nmk
     INTO :colRNK,:colSAB,:colNMK
     FROM customer a
     WHERE (a.sab is not null and (a.stmt=5 or a.stmt=6)) or (a.rnkp is not null and
           a.rnkp in (SELECT rnk
                      FROM   customer
                      WHERE  sab is not null and (stmt=5 or stmt=6)))
     ORDER BY 2")
.head 4 -  Call cQCust.Init("
     SELECT a.rnk,a.sab,a.nmk
     INTO :colRNK,:colSAB,:colNMK
     FROM customer a
     WHERE (a.sab is not null and (a.stmt=5 or a.stmt=6)) or (a.rnk in (SELECT rnk
                                                                        FROM   klp_top))
     ORDER BY 2")
.head 3 +  On VTM_Size
.head 4 -  Call SalGetWindowSize(hWndForm, nListX, nListY)
.head 4 -  Call SalSetWindowLoc(ccSplitter, 2*nListX/3, 0)
.head 4 -  Call SalSendClassMessage(VTM_Size, wParam, lParam)
.head 3 +  On SAM_Destroy
.head 4 -  Call SaveInfoToLog("Конец работы функции 'Счета для отбора в выписки электронным клиентам'")
.head 4 -  Call SalSetFocus(SalParentWindow(hWndForm))
.head 1 +  Form Window: frm_Acc4IK
.head 2 -  Class: cSplitterWindow
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Счета электронных клиентов (доступ на дебет)
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.25"
.head 4 -  Top:    1.042"
.head 4 -  Width:  13.317"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.631"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description: Редактирование списка счетов электронных клиентов (доступ на дебет)
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.429"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Перечитать данные"
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(tbl_eCustomer, SAM_Create, 0, 0)
.head 4 -  Line
.head 5 -  Resource Id: 17312
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  0.7"
.head 6 -  Begin Y:  0.024"
.head 6 -  End X:  0.7"
.head 6 -  End Y:  0.429"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbFilter
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.833"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Установить фильтр"
.head 6 +  On SAM_Click
.head 7 +  If SetQueryFilter(cFCust)
.head 8 -  Call SalSendMsg(tbl_eCustomer, SAM_Create, 0, 0)
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSearch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.267"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Поиск строки"
.head 6 +  On SAM_Click
.head 7 -  Call TblFindString(tbl_eCustomer, 1)
.head 4 -  Line
.head 5 -  Resource Id: 17313
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  1.817"
.head 6 -  Begin Y:  0.024"
.head 6 -  End X:  1.817"
.head 6 -  End Y:  0.429"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.95"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Сохранить данные"
.head 6 +  On SAM_Click
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(tbl_Acc, nRow, ROW_Edited, 0)
.head 8 -  Call SalTblSetContext(tbl_Acc, nRow)
.head 8 +  If tbl_Acc.colUse != tbl_Acc.colUsePrev
.head 9 -  Set fIsOk = FALSE
.head 9 +  If tbl_Acc.colUsePrev = 0
.head 10 -  Set fIsOk = SqlPrepareAndExecute(cMisc.hSql(), "
    INSERT
    INTO   acci (acc,high,pers)
    VALUES (:tbl_Acc.colAcc,:tbl_Acc.colHigh,:tbl_Acc.colPers)")
.head 9 +  Else
.head 10 -  Set fIsOk = SqlPrepareAndExecute(cMisc.hSql(), "
    DELETE
    FROM   acci
    WHERE  acc=:tbl_Acc.colAcc")
.head 9 +  If fIsOk
.head 10 -  Call SqlCommitEx(cMisc.hSql(), "Изменен статус счёта (доступ на дебет) " || tbl_Acc.colNLS || "(" ||
     tbl_Acc.colISOKV || ") - " || IifS(tbl_Acc.colUsePrev=0, '', 'НЕ') || "доступен")
.head 8 +  Else
.head 9 +  If tbl_Acc.colHigh != tbl_Acc.colHighPrev
.head 10 -  Set fIsOk = FALSE
.head 10 +  If tbl_Acc.colUse = 1
.head 11 -  Set fIsOk = SqlPrepareAndExecute(cMisc.hSql(), "
    UPDATE acci
    SET    high=:tbl_Acc.colHigh
    WHERE  acc=:tbl_Acc.colAcc")
.head 10 +  If fIsOk
.head 11 -  Call SqlCommitEx(cMisc.hSql(), "Изменен статус счёта (доступ на дебет) " || tbl_Acc.colNLS || "(" ||
     tbl_Acc.colISOKV || ") в выписку эл.клиенту - " || IifS(tbl_Acc.colHighPrev=0, '', 'НЕ') ||
     "доступен вышестоящим клиентам")
.head 9 +  If tbl_Acc.colPers != tbl_Acc.colPersPrev
.head 10 -  Set fIsOk = FALSE
.head 10 +  If tbl_Acc.colUse = 1
.head 11 -  Set fIsOk = SqlPrepareAndExecute(cMisc.hSql(), "
    UPDATE acci
    SET    pers=:tbl_Acc.colPers
    WHERE  acc=:tbl_Acc.colAcc")
.head 10 +  If fIsOk
.head 11 -  Call SqlCommitEx(cMisc.hSql(), "Изменен статус счёта (доступ на дебет) " || tbl_Acc.colNLS || "(" ||
     tbl_Acc.colISOKV || " - " || IifS(tbl_Acc.colPersPrev=0, '', 'НЕ') || "доступен себе")
.head 7 -  Call SalSendMsg(tbl_Acc, UM_Populate, tbl_eCustomer.colRNK, 0)
.head 7 -  Call SalWaitCursor(FALSE)
.head 4 -  Line
.head 5 -  Resource Id: 17314
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.5"
.head 6 -  Begin Y:  0.024"
.head 6 -  End X:  2.5"
.head 6 -  End Y:  0.429"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbCancel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.617"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Закончить работу функции"
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 4 -  !
.head 4 +  ! On SAM_Click
.head 5 -  Call TblFindString(hWndForm, 1)
.head 2 +  Contents
.head 3 +  Custom Control: ccSplitter
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cSplitterWindow
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.567"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tbl_eCustomer
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    0.202"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.833"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 22222
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colRNK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рег.
Номер
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSAB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Эл.
код
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 4
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNMK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
клиента
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  9.967"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nLastSortColId
.head 5 -  Number: nCurrSortColId
.head 5 -  Number: nSortDirection
.head 5 -  Window Handle: hCurrSortCol
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set nSortDirection = 1
.head 6 -  Set nLastSortColId = -1
.head 6 -  Call SalTblPopulate(hWndItem, cCust.hSql(), T(cQCust.GetFullSQLString(cFCust)), TBL_FillNormal)
.head 6 -  Call SalTblSetContext(hWndItem, 0)
.head 6 -  Call SalTblSetFocusRow(hWndItem, 0)
.head 6 -  Call SalTblSetRowFlags(hWndItem, 0, ROW_Selected, TRUE)
.head 6 -  Call SalPostMsg(tbl_Acc, UM_Populate, colRNK, 0)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On SAM_TblDoDetails
.head 6 -  Call SalPostMsg(tbl_Acc, UM_Populate, colRNK, 0)
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set hCurrSortCol = SalNumberToWindowHandle(wParam)
.head 6 -  Call SalTblSetColumnFlags(hCurrSortCol, COL_Selected, FALSE)
.head 6 -  Set nCurrSortColId = SalTblQueryColumnID(hCurrSortCol)
.head 6 +  If nCurrSortColId != nLastSortColId
.head 7 -  Set nLastSortColId = nCurrSortColId
.head 7 -  Set nSortDirection = 1
.head 6 +  Else
.head 7 -  Set nSortDirection = 1 - nSortDirection
.head 6 -  Call SalTblSortRows(hWndItem, nCurrSortColId, nSortDirection)
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 +  Child Table: tbl_Acc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.667"
.head 6 -  Top:    0.0"
.head 6 -  Width:  6.117"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2222
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colAcc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Acc
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер счёта
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colISOKV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colUse
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Разрешение
на дебет
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colUsePrev
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Prev.Val
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPers
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Себе
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPersPrev
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Prev.Val
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colHigh
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Выше-
стоящ.
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colHighPrev
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Prev.Val
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nLAcc
.head 5 -  Number: nHigh
.head 5 -  Number: nPers
.head 5 -  !
.head 5 -  Number: nLastSortColId
.head 5 -  Number: nCurrSortColId
.head 5 -  Number: nSortDirection
.head 5 -  Window Handle: hCurrSortCol
.head 4 +  Message Actions
.head 5 +  On UM_Populate
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set nSortDirection = 1
.head 6 -  Set nLastSortColId = -1
.head 6 -  Call SalTblPopulate(hWndItem, cAcc.hSql(), T("
     SELECT a.acc,a.nls,t.lcv
     INTO   :colAcc,:colNLS,:colISOKV
     FROM   accounts a, tabval t, cust_acc c
     WHERE  c.acc=a.acc AND t.kv=a.kv AND c.rnk=:wParam
     ORDER  BY 3,2"), TBL_FillAll)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On SAM_FetchRowDone
.head 6 -  Call SqlPrepareAndExecute(cMisc.hSql(), "
     SELECT acc,nvl(high,0),nvl(pers,0)
     INTO   :nLAcc,:nHigh,:nPers
     FROM   acci
     WHERE  acc=:colAcc")
.head 6 +  If SqlFetchNext(cMisc.hSql(), nFetchRes)
.head 7 -  Set colUse = 1
.head 7 -  Set colUsePrev = 1
.head 7 -  Set colHigh = nHigh
.head 7 -  Set colHighPrev = nHigh
.head 7 -  Set colPers = nPers
.head 7 -  Set colPersPrev = nPers
.head 6 +  Else
.head 7 -  Set colUse = 0
.head 7 -  Set colUsePrev = 0
.head 7 -  Set colHigh = 0
.head 7 -  Set colHighPrev = 0
.head 7 -  Set colPers = 0
.head 7 -  Set colPersPrev = 0
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set hCurrSortCol = SalNumberToWindowHandle(wParam)
.head 6 -  Call SalTblSetColumnFlags(hCurrSortCol, COL_Selected, FALSE)
.head 6 -  Set nCurrSortColId = SalTblQueryColumnID(hCurrSortCol)
.head 6 +  If nCurrSortColId != nLastSortColId
.head 7 -  Set nLastSortColId = nCurrSortColId
.head 7 -  Set nSortDirection = 1
.head 6 +  Else
.head 7 -  Set nSortDirection = 1 - nSortDirection
.head 6 -  Call SalTblSortRows(hWndItem, nCurrSortColId, nSortDirection)
.head 6 -  Call SalWaitCursor(FALSE)
.head 2 +  Functions
.head 3 +  Function: InitStmt
.head 4 -  Description: Инициализация кода выписки эл.клиента
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set nSTMTValue = GetGlobalOptionEx('EPSTMT')
.head 5 +  If nSTMTValue = 0
.head 6 -  Set nSTMTValue = 5 ! тип выписки 'Электронный клиент'
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  : cCust
.head 4 -  Class: cABSConnect
.head 3 -  : cAcc
.head 4 -  Class: cABSConnect
.head 3 -  : cMisc
.head 4 -  Class: cABSConnect
.head 3 -  : cQCust
.head 4 -  Class: cGenQuery
.head 3 -  : cFCust
.head 4 -  Class: cGenFilter
.head 3 -  !
.head 3 -  Number: nListX
.head 3 -  Number: nListY
.head 3 -  !
.head 3 -  Number: nRow
.head 3 -  Boolean: fIsOk
.head 3 -  Number: nSTMTValue
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  !
.head 4 -  Call SaveInfoToLog("Начало работы функции 'Счета электронных клиентов (доступ на дебет)'")
.head 4 -  !
.head 4 -  Call XConnectGetParams(cCust)
.head 4 +  If NOT cCust.Connect()
.head 5 -  Return FALSE
.head 4 -  Call cAcc.Clone(cCust, TRUE)
.head 4 -  Call cMisc.Clone(cCust, TRUE)
.head 4 -  !
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  !
.head 4 -  Call SalTblSetTableFlags(tbl_eCustomer, TBL_Flag_SelectableCols, TRUE)
.head 4 -  Call SalTblSetTableFlags(tbl_Acc, TBL_Flag_SelectableCols, TRUE)
.head 4 -  ! Инициализация переменной nSTMTValue - тип выписки эл. клиента
.head 4 -  Call InitStmt()
.head 4 -  ! -------------
.head 4 -  Call cFCust.Init('CUSTOMER', 'a')
.head 4 -  Call cQCust.Init("
     SELECT rnk,sab,nmk
     INTO   :colRNK,:colSAB,:colNMK
     FROM   customer
     WHERE  sab is not null and (stmt=:nSTMTValue or stmt=5 or stmt=6)
     UNION ALL
     SELECT c.rnk,c.sab,c.nmk
     FROM   klp_alien k, customer c
     WHERE  k.rnk=c.rnk and c.sab is null
     ORDER BY 2")
.head 4 -  Call SalSendClassMessage(SAM_Create, wParam, lParam)
.head 3 +  On VTM_Size
.head 4 -  Call SalGetWindowSize(hWndForm, nListX, nListY)
.head 4 -  Call SalSetWindowLoc(ccSplitter, 2*nListX/3, 0)
.head 4 -  Call SalSendClassMessage(VTM_Size, wParam, lParam)
.head 3 +  On SAM_Destroy
.head 4 -  !
.head 4 -  Call SaveInfoToLog("Конец работы функции 'Счета электронных клиентов (доступ на дебет)'")
.head 4 -  Call SalSetFocus(SalParentWindow(hWndForm))
.head 4 -  !
.head 1 +  Form Window: frm_AccKB
.head 2 -  Class: cSplitterWindow
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Управление счетами "электронных" клиентов
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   2.388"
.head 4 -  Top:    0.938"
.head 4 -  Width:  18.067"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 7.476"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description: Управление счетами "электронных" клиентов
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.429"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Перечитать данные"
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(tbl_eCustomer, SAM_Create, 0, 0)
.head 4 -  Line
.head 5 -  Resource Id: 62904
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  0.7"
.head 6 -  Begin Y:  0.024"
.head 6 -  End X:  0.7"
.head 6 -  End Y:  0.429"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbFilter
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.833"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Установить фильтр"
.head 6 +  On SAM_Click
.head 7 +  If SetQueryFilter(cFCust)
.head 8 -  Call SalSendMsg(tbl_eCustomer, SAM_Create, 0, 0)
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSearch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.267"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Поиск строки"
.head 6 +  On SAM_Click
.head 7 -  Call TblFindString(tbl_eCustomer, 1)
.head 4 -  Line
.head 5 -  Resource Id: 62905
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  1.817"
.head 6 -  Begin Y:  0.024"
.head 6 -  End X:  1.817"
.head 6 -  End Y:  0.429"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.95"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Сохранить данные"
.head 6 +  On SAM_Click
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(tbl_Acc, nRow, ROW_Edited, 0)
.head 8 -  Call SalTblSetContext(tbl_Acc, nRow)
.head 8 -  !
.head 8 -  Set fIsOk = FALSE
.head 8 +  If tbl_Acc.colToPayPersPrev = 0 and tbl_Acc.colToPayHighPrev = 0
.head 9 +  If tbl_Acc.colToPayPers = 1 or tbl_Acc.colToPayHigh = 1
.head 10 -  Set fIsOk = SqlPrepareAndExecute(cMisc.hSql(), "
    INSERT
    INTO   acci (acc,pers,high)
    VALUES (:tbl_Acc.colAcc,:tbl_Acc.colToPayPers,:tbl_Acc.colToPayHigh)")
.head 10 -  Set fIsOk = SqlPrepareAndExecute(cMisc.hSql(), "
    UPDATE accounts
    SET    opt=nvl(opt,0)+4
    WHERE  acc=:tbl_Acc.colAcc")
.head 8 +  Else
.head 9 +  If tbl_Acc.colToPayPers = 0 and tbl_Acc.colToPayHigh = 0
.head 10 -  Set fIsOk = SqlPrepareAndExecute(cMisc.hSql(), "
    DELETE
    FROM   acci
    WHERE  acc=:tbl_Acc.colAcc")
.head 10 -  Set fIsOk = SqlPrepareAndExecute(cMisc.hSql(), "
    UPDATE accounts
    SET    opt=iif_n(nvl(opt,0)-4,0,null,null,nvl(opt,0)-4)
    WHERE  acc=:tbl_Acc.colAcc")
.head 9 +  Else
.head 10 +  If tbl_Acc.colToPayPers != tbl_Acc.colToPayPersPrev or tbl_Acc.colToPayHigh != tbl_Acc.colToPayHighPrev
.head 11 -  Set fIsOk = SqlPrepareAndExecute(cMisc.hSql(), "
    UPDATE acci
    SET    pers=:tbl_Acc.colToPayPers,high=:tbl_Acc.colToPayHigh
    WHERE  acc=:tbl_Acc.colAcc")
.head 11 -  Set fIsOk = SqlPrepareAndExecute(cMisc.hSql(), "
    UPDATE accounts
    SET    opt=nvl(opt,0)+4
    WHERE  acc=:tbl_Acc.colAcc")
.head 8 +  If fIsOk
.head 9 -  Call SqlCommitEx(cMisc.hSql(), "Изменён статус счёта (доступ на дебет) " || tbl_Acc.colNLS || "(" ||
     tbl_Acc.colISOKV || "): клиенту - " || IifS(tbl_Acc.colToPayPers=1, '', 'НЕ') || "доступен, вышестоящ. - "
     || IifS(tbl_Acc.colToPayHigh=1, '', 'НЕ') || "доступен")
.head 8 -  !
.head 8 -  Set fIsOk = FALSE
.head 8 +  If tbl_Acc.colVipisPersPrev = 0 and tbl_Acc.colVipisHighPrev = 0
.head 9 +  If tbl_Acc.colVipisPers = 1 or tbl_Acc.colVipisHigh = 1
.head 10 -  Set fIsOk = SqlPrepareAndExecute(cMisc.hSql(), "
    INSERT
    INTO   acce (acc,pers,high)
    VALUES (:tbl_Acc.colAcc,:tbl_Acc.colVipisPers,:tbl_Acc.colVipisHigh)")
.head 8 +  Else
.head 9 +  If tbl_Acc.colVipisPers = 0 and tbl_Acc.colVipisHigh = 0
.head 10 -  Set fIsOk = SqlPrepareAndExecute(cMisc.hSql(), "
    DELETE
    FROM   acce
    WHERE  acc=:tbl_Acc.colAcc")
.head 9 +  Else
.head 10 +  If tbl_Acc.colVipisPers != tbl_Acc.colVipisPersPrev or tbl_Acc.colVipisHigh != tbl_Acc.colVipisHighPrev
.head 11 -  Set fIsOk = SqlPrepareAndExecute(cMisc.hSql(), "
    UPDATE acce
    SET    pers=:tbl_Acc.colVipisPers,high=:tbl_Acc.colVipisHigh
    WHERE  acc=:tbl_Acc.colAcc")
.head 8 +  If fIsOk
.head 9 -  Call SqlCommitEx(cMisc.hSql(), "Изменён статус выборки счёта " || tbl_Acc.colNLS || "(" ||
     tbl_Acc.colISOKV || ") в выписки: клиенту - " || IifS(tbl_Acc.colVipisPers=1, '', 'НЕ') ||
     "доступен, вышестоящ. - " || IifS(tbl_Acc.colVipisHigh=1, '', 'НЕ') || "доступен")
.head 8 -  !
.head 8 -  Set fIsOk = FALSE
.head 8 +  If tbl_Acc.colFileCPersPrev = 0 and tbl_Acc.colFileCHighPrev = 0
.head 9 +  If tbl_Acc.colFileCPers = 1 or tbl_Acc.colFileCHigh = 1
.head 10 -  Set fIsOk = SqlPrepareAndExecute(cMisc.hSql(), "
    INSERT
    INTO   accc (acc,pers,high)
    VALUES (:tbl_Acc.colAcc,:tbl_Acc.colFileCPers,:tbl_Acc.colFileCHigh)")
.head 8 +  Else
.head 9 +  If tbl_Acc.colFileCPers = 0 and tbl_Acc.colFileCHigh = 0
.head 10 -  Set fIsOk = SqlPrepareAndExecute(cMisc.hSql(), "
    DELETE
    FROM   accc
    WHERE  acc=:tbl_Acc.colAcc")
.head 9 +  Else
.head 10 +  If tbl_Acc.colFileCPers != tbl_Acc.colFileCPersPrev or tbl_Acc.colFileCHigh != tbl_Acc.colFileCHighPrev
.head 11 -  Set fIsOk = SqlPrepareAndExecute(cMisc.hSql(), "
    UPDATE accc
    SET    pers=:tbl_Acc.colFileCPers,high=:tbl_Acc.colFileCHigh
    WHERE  acc=:tbl_Acc.colAcc")
.head 8 +  If fIsOk
.head 9 -  Call SqlCommitEx(cMisc.hSql(), "Изменён статус выборки счёта " || tbl_Acc.colNLS || "(" ||
     tbl_Acc.colISOKV || ") в файлы C: клиенту - " || IifS(tbl_Acc.colFileCPers=1, '', 'НЕ') ||
     "доступен, вышестоящ. - " || IifS(tbl_Acc.colFileCHigh=1, '', 'НЕ') || "доступен")
.head 7 -  Call SalSendMsg(tbl_Acc, UM_Populate, tbl_eCustomer.colRNK, 0)
.head 7 -  Call SalWaitCursor(FALSE)
.head 4 -  Line
.head 5 -  Resource Id: 62906
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.5"
.head 6 -  Begin Y:  0.024"
.head 6 -  End X:  2.5"
.head 6 -  End Y:  0.429"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbCancel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.617"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Закончить работу функции"
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 2 +  Contents
.head 3 +  Custom Control: ccSplitter
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cSplitterWindow
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.917"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tbl_eCustomer
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  13.717"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 6.488"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 22222
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colRNK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рег.
Номер
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.671"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSAB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Эл.
код
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 4
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.543"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNMK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
клиента
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  5.871"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nLastSortColId
.head 5 -  Number: nCurrSortColId
.head 5 -  Number: nSortDirection
.head 5 -  Window Handle: hCurrSortCol
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set nSortDirection = 1
.head 6 -  Set nLastSortColId = -1
.head 6 -  Call SalTblPopulate(hWndItem, cCust.hSql(), T(cQCust.GetFullSQLString(cFCust)), TBL_FillNormal)
.head 6 -  Call SalTblSetContext(hWndItem, 0)
.head 6 -  Call SalTblSetFocusRow(hWndItem, 0)
.head 6 -  Call SalTblSetRowFlags(hWndItem, 0, ROW_Selected, TRUE)
.head 6 -  Call SalPostMsg(tbl_Acc, UM_Populate, colRNK, 0)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On SAM_CreateComplete
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
.head 5 +  On SAM_TblDoDetails
.head 6 -  Call SalPostMsg(tbl_Acc, UM_Populate, colRNK, 0)
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set hCurrSortCol = SalNumberToWindowHandle(wParam)
.head 6 -  Call SalTblSetColumnFlags(hCurrSortCol, COL_Selected, FALSE)
.head 6 -  Set nCurrSortColId = SalTblQueryColumnID(hCurrSortCol)
.head 6 +  If nCurrSortColId != nLastSortColId
.head 7 -  Set nLastSortColId = nCurrSortColId
.head 7 -  Set nSortDirection = 1
.head 6 +  Else
.head 7 -  Set nSortDirection = 1 - nSortDirection
.head 6 -  Call SalTblSortRows(hWndItem, nCurrSortColId, nSortDirection)
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 +  Child Table: tbl_Acc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   9.067"
.head 6 -  Top:    0.0"
.head 6 -  Width:  10.05"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 6.488"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 100000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colAcc
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Acc
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Номер счёта
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colISOKV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Вал.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.45"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colToPayPers
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Доступ
на дебет
себе
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 +  If tbl_eCustomer.colSAB = STRING_Null
.head 9 -  Set colToPayPers = 0
.head 8 +  If colToPayPers = colToPayPersPrev and colVipisPers = colVipisPersPrev and colFileCPers = colFileCPersPrev and
   colToPayHigh = colToPayHighPrev and colVipisHigh = colVipisHighPrev and colFileCHigh = colFileCHighPrev
.head 9 -  Call SalTblSetRowFlags(tbl_Acc, lParam, ROW_Edited, FALSE)
.head 7 +  On SAM_Validate
.head 8 +  If colToPayPers = colToPayPersPrev and colVipisPers = colVipisPersPrev and colFileCPers = colFileCPersPrev and
   colToPayHigh = colToPayHighPrev and colVipisHigh = colVipisHighPrev and colFileCHigh = colFileCHighPrev
.head 9 -  Call SalTblSetRowFlags(tbl_Acc, lParam, ROW_Edited, FALSE)
.head 5 +  Column: colToPayHigh
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Доступ
на дебет
вышестоящ.
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 +  If colToPayPers = colToPayPersPrev and colVipisPers = colVipisPersPrev and colFileCPers = colFileCPersPrev and
   colToPayHigh = colToPayHighPrev and colVipisHigh = colVipisHighPrev and colFileCHigh = colFileCHighPrev
.head 9 -  Call SalTblSetRowFlags(tbl_Acc, lParam, ROW_Edited, FALSE)
.head 7 +  On SAM_Validate
.head 8 +  If colToPayPers = colToPayPersPrev and colVipisPers = colVipisPersPrev and colFileCPers = colFileCPersPrev and
   colToPayHigh = colToPayHighPrev and colVipisHigh = colVipisHighPrev and colFileCHigh = colFileCHighPrev
.head 9 -  Call SalTblSetRowFlags(tbl_Acc, lParam, ROW_Edited, FALSE)
.head 5 +  Column: colToPayPersPrev
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Prev.Val
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colToPayHighPrev
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Prev.Val
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVipisPers
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: В
выписку
себе
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 +  If tbl_eCustomer.colSAB = STRING_Null
.head 9 -  Set colVipisPers = 0
.head 8 +  If colToPayPers = colToPayPersPrev and colVipisPers = colVipisPersPrev and colFileCPers = colFileCPersPrev and
   colToPayHigh = colToPayHighPrev and colVipisHigh = colVipisHighPrev and colFileCHigh = colFileCHighPrev
.head 9 -  Call SalTblSetRowFlags(tbl_Acc, lParam, ROW_Edited, FALSE)
.head 7 +  On SAM_Validate
.head 8 +  If colToPayPers = colToPayPersPrev and colVipisPers = colVipisPersPrev and colFileCPers = colFileCPersPrev and
   colToPayHigh = colToPayHighPrev and colVipisHigh = colVipisHighPrev and colFileCHigh = colFileCHighPrev
.head 9 -  Call SalTblSetRowFlags(tbl_Acc, lParam, ROW_Edited, FALSE)
.head 5 +  Column: colVipisHigh
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: В
выписку
вышестоящ.
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 +  If colToPayPers = colToPayPersPrev and colVipisPers = colVipisPersPrev and colFileCPers = colFileCPersPrev and
   colToPayHigh = colToPayHighPrev and colVipisHigh = colVipisHighPrev and colFileCHigh = colFileCHighPrev
.head 9 -  Call SalTblSetRowFlags(tbl_Acc, lParam, ROW_Edited, FALSE)
.head 7 +  On SAM_Validate
.head 8 +  If colToPayPers = colToPayPersPrev and colVipisPers = colVipisPersPrev and colFileCPers = colFileCPersPrev and
   colToPayHigh = colToPayHighPrev and colVipisHigh = colVipisHighPrev and colFileCHigh = colFileCHighPrev
.head 9 -  Call SalTblSetRowFlags(tbl_Acc, lParam, ROW_Edited, FALSE)
.head 5 +  Column: colVipisPersPrev
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Prev.Val
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVipisHighPrev
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Prev.Val
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFileCPers
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Статус
себе
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 +  If tbl_eCustomer.colSAB = STRING_Null
.head 9 -  Set colFileCPers = 0
.head 8 +  If colToPayPers = colToPayPersPrev and colVipisPers = colVipisPersPrev and colFileCPers = colFileCPersPrev and
   colToPayHigh = colToPayHighPrev and colVipisHigh = colVipisHighPrev and colFileCHigh = colFileCHighPrev
.head 9 -  Call SalTblSetRowFlags(tbl_Acc, lParam, ROW_Edited, FALSE)
.head 7 +  On SAM_Validate
.head 8 +  If colToPayPers = colToPayPersPrev and colVipisPers = colVipisPersPrev and colFileCPers = colFileCPersPrev and
   colToPayHigh = colToPayHighPrev and colVipisHigh = colVipisHighPrev and colFileCHigh = colFileCHighPrev
.head 9 -  Call SalTblSetRowFlags(tbl_Acc, lParam, ROW_Edited, FALSE)
.head 5 +  Column: colFileCHigh
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Статус
вышестоящ.
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 +  If colToPayPers = colToPayPersPrev and colVipisPers = colVipisPersPrev and colFileCPers = colFileCPersPrev and
   colToPayHigh = colToPayHighPrev and colVipisHigh = colVipisHighPrev and colFileCHigh = colFileCHighPrev
.head 9 -  Call SalTblSetRowFlags(tbl_Acc, lParam, ROW_Edited, FALSE)
.head 7 +  On SAM_Validate
.head 8 +  If colToPayPers = colToPayPersPrev and colVipisPers = colVipisPersPrev and colFileCPers = colFileCPersPrev and
   colToPayHigh = colToPayHighPrev and colVipisHigh = colVipisHighPrev and colFileCHigh = colFileCHighPrev
.head 9 -  Call SalTblSetRowFlags(tbl_Acc, lParam, ROW_Edited, FALSE)
.head 5 +  Column: colFileCPersPrev
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Prev.Val
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFileCHighPrev
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Prev.Val
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nLAcc
.head 5 -  Number: nToPayHigh
.head 5 -  Number: nToPayPers
.head 5 -  Number: nVipisHigh
.head 5 -  Number: nVipisPers
.head 5 -  Number: nFileCHigh
.head 5 -  Number: nFileCPers
.head 5 -  !
.head 5 -  Number: nLastSortColId
.head 5 -  Number: nCurrSortColId
.head 5 -  Number: nSortDirection
.head 5 -  Window Handle: hCurrSortCol
.head 4 +  Message Actions
.head 5 +  On UM_Populate
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set nSortDirection = 1
.head 6 -  Set nLastSortColId = -1
.head 6 -  Call SalTblPopulate(hWndItem, cAcc.hSql(), "
     SELECT a.acc,a.nls,t.lcv
     INTO   :colAcc,:colNLS,:colISOKV
     FROM   accounts a, tabval t
     WHERE  t.kv=a.kv AND a.rnk=:wParam
     ORDER  BY 3,2", TBL_FillAll)
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  !
.head 6 -  ! Call XSalTblSetColumnBackColor(colToPayPers, COLOR_Sky)
.head 6 -  ! Call XSalTblSetColumnBackColor(colToPayHigh, COLOR_Sky)
.head 6 -  ! Call XSalTblSetColumnBackColor(colVipisPers, COLOR_LightGreen)
.head 6 -  ! Call XSalTblSetColumnBackColor(colVipisHigh, COLOR_LightGreen)
.head 6 -  ! Call XSalTblSetColumnBackColor(colFileCPers, COLOR_Gray)
.head 6 -  ! Call XSalTblSetColumnBackColor(colFileCHigh, COLOR_Gray)
.head 5 +  On SAM_CreateComplete
.head 6 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
.head 5 +  On SAM_FetchRowDone
.head 6 -  ! Call XSalTblSetCellBackColor(colToPayPers, COLOR_Sky)
.head 6 -  ! Call XSalTblSetCellBackColor(colToPayHigh, COLOR_Sky)
.head 6 -  ! Call XSalTblSetCellBackColor(colVipisPers, COLOR_LightGreen)
.head 6 -  ! Call XSalTblSetCellBackColor(colVipisHigh, COLOR_LightGreen)
.head 6 -  ! Call XSalTblSetCellBackColor(colFileCPers, COLOR_Gray)
.head 6 -  ! Call XSalTblSetCellBackColor(colFileCHigh, COLOR_Gray)
.head 6 -  !
.head 6 -  ! Call SalTblSetCellTextColor(colNLS, COLOR_Sky, TRUE)
.head 6 -  ! Call SalColorSet(colISOKV, COLOR_IndexCellText, COLOR_Gray)
.head 6 -  ! Call SalColorSet(colToPayPers, COLOR_IndexCellText, COLOR_Gray)
.head 6 -  !
.head 6 -  Call SqlPrepareAndExecute(cMisc.hSql(), "
     SELECT acc,nvl(pers,0),nvl(high,0)
     INTO   :nLAcc,:nToPayPers,:nToPayHigh
     FROM   acci
     WHERE  acc=:colAcc")
.head 6 +  If SqlFetchNext(cMisc.hSql(), nFetchRes)
.head 7 -  Set colToPayPers = nToPayPers
.head 7 -  Set colToPayPersPrev = nToPayPers
.head 7 -  Set colToPayHigh = nToPayHigh
.head 7 -  Set colToPayHighPrev = nToPayHigh
.head 6 +  Else
.head 7 -  Set colToPayPers = 0
.head 7 -  Set colToPayPersPrev = 0
.head 7 -  Set colToPayHigh = 0
.head 7 -  Set colToPayHighPrev = 0
.head 6 -  !
.head 6 -  Call SqlPrepareAndExecute(cMisc.hSql(), "
     SELECT acc,nvl(pers,0),nvl(high,0)
     INTO   :nLAcc,:nVipisPers,:nVipisHigh
     FROM   acce
     WHERE  acc=:colAcc")
.head 6 +  If SqlFetchNext(cMisc.hSql(), nFetchRes)
.head 7 -  Set colVipisPers = nVipisPers
.head 7 -  Set colVipisPersPrev = nVipisPers
.head 7 -  Set colVipisHigh = nVipisHigh
.head 7 -  Set colVipisHighPrev = nVipisHigh
.head 6 +  Else
.head 7 -  Set colVipisPers = 0
.head 7 -  Set colVipisPersPrev = 0
.head 7 -  Set colVipisHigh = 0
.head 7 -  Set colVipisHighPrev = 0
.head 6 -  !
.head 6 -  Call SqlPrepareAndExecute(cMisc.hSql(), "
     SELECT acc,nvl(pers,0),nvl(high,0)
     INTO   :nLAcc,:nFileCPers,:nFileCHigh
     FROM   accc
     WHERE  acc=:colAcc")
.head 6 +  If SqlFetchNext(cMisc.hSql(), nFetchRes)
.head 7 -  Set colFileCPers = nFileCPers
.head 7 -  Set colFileCPersPrev = nFileCPers
.head 7 -  Set colFileCHigh = nFileCHigh
.head 7 -  Set colFileCHighPrev = nFileCHigh
.head 6 +  Else
.head 7 -  Set colFileCPers = 0
.head 7 -  Set colFileCPersPrev = 0
.head 7 -  Set colFileCHigh = 0
.head 7 -  Set colFileCHighPrev = 0
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set hCurrSortCol = SalNumberToWindowHandle(wParam)
.head 6 -  Call SalTblSetColumnFlags(hCurrSortCol, COL_Selected, FALSE)
.head 6 -  Set nCurrSortColId = SalTblQueryColumnID(hCurrSortCol)
.head 6 +  If nCurrSortColId != nLastSortColId
.head 7 -  Set nLastSortColId = nCurrSortColId
.head 7 -  Set nSortDirection = 1
.head 6 +  Else
.head 7 -  Set nSortDirection = 1 - nSortDirection
.head 6 -  Call SalTblSortRows(hWndItem, nCurrSortColId, nSortDirection)
.head 6 -  Call SalWaitCursor(FALSE)
.head 2 +  Functions
.head 3 +  Function: InitStmt
.head 4 -  Description: Инициализация кода выписки эл.клиента
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Set nSTMTValue = GetGlobalOptionEx('EPSTMT')
.head 5 +  ! If nSTMTValue = 0
.head 6 -  Set nSTMTValue = 5 ! тип выписки 'Электронный клиент'
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  : cCust
.head 4 -  Class: cABSConnect
.head 3 -  : cAcc
.head 4 -  Class: cABSConnect
.head 3 -  : cMisc
.head 4 -  Class: cABSConnect
.head 3 -  : cQCust
.head 4 -  Class: cGenQuery
.head 3 -  : cFCust
.head 4 -  Class: cGenFilter
.head 3 -  !
.head 3 -  Number: nListX
.head 3 -  Number: nListY
.head 3 -  !
.head 3 -  Number: nRow
.head 3 -  Boolean: fIsOk
.head 3 -  ! Number: nSTMTValue
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  !
.head 4 -  Call SaveInfoToLog('Начало работы функции Управление счетами "электронных" клиентов')
.head 4 -  !
.head 4 -  Call XConnectGetParams(cCust)
.head 4 +  If NOT cCust.Connect()
.head 5 -  Return FALSE
.head 4 -  Call cAcc.Clone(cCust, TRUE)
.head 4 -  Call cMisc.Clone(cCust, TRUE)
.head 4 -  !
.head 4 -  ! Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  !
.head 4 -  Call SalTblSetTableFlags(tbl_eCustomer, TBL_Flag_SelectableCols, TRUE)
.head 4 -  Call SalTblSetTableFlags(tbl_Acc, TBL_Flag_SelectableCols, TRUE)
.head 4 -  ! Инициализация переменной nSTMTValue - тип выписки эл. клиента
.head 4 -  Call InitStmt()
.head 4 -  ! -------------
.head 4 -  Call cFCust.Init('CUSTOMER', 'a')
.head 4 -  Call SalSendClassMessage(SAM_Create, wParam, lParam)
.head 4 -  Call cQCust.Init("
     SELECT DISTINCT a.rnk,a.sab,a.nmk
     INTO   :colRNK,:colSAB,:colNMK
     FROM   customer a
     WHERE  ((a.sab is not null and (a.stmt=5 or a.stmt=6)) or (a.rnk in (SELECT rnk
                                                                          FROM   klp_top)))
     ORDER BY 2")
.head 4 -  Call SalSendClassMessage(SAM_Create, wParam, lParam)
.head 3 +  ! On VTM_Size
.head 4 -  Call SalGetWindowSize(hWndForm, nListX, nListY)
.head 4 -  Call SalSetWindowLoc(ccSplitter, 2*nListX/3, 0)
.head 4 -  Call SalSendClassMessage(VTM_Size, wParam, lParam)
.head 3 +  On SAM_Destroy
.head 4 -  Call SaveInfoToLog('Конец работы функции Управление счетами "электронных" клиентов')
.head 4 -  Call SalSetFocus(SalParentWindow(hWndForm))
.head 1 +  Form Window: buch_a_b
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Экспорт файлов для внутренней бухгалтерии
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   1.0"
.head 4 -  Top:    1.417"
.head 4 -  Width:  11.05"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.738"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbRun
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbExecute
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   8.283"
.head 5 -  Top:    0.071"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call ccA.SetProgress(0)
.head 6 -  Call ccB.SetProgress(0)
.head 6 +  If cbA or cbB
.head 7 -  Set sFile1a = sBuhPath || sFileA || '.Dbf'
.head 7 -  Set sFile1b = sBuhPath || sFileB || '.Dbf'
.head 7 +  If SalMessageBox('Выполнять формирование файлов ' ||
   'Buch_A.Dbf (Saldo) и Buch_B.Dbf (Oper) за ' ||
   SalFmtFormatDateTime(dYes, 'dd-MM-yyyy') || ' ?',
   'ВНИМАНИЕ !!!', MB_YesNo | MB_IconQuestion) = IDNO
.head 8 -  Return 0
.head 7 +  If cbA
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 -  Set nKwo = 0
.head 8 -  Set bOk = FALSE
.head 8 +  If SqlPrepareAndExecute(hSql(), T("
   SELECT count(*)
   INTO :nKwo
   FROM buch_a
   WHERE fdat=:dYes"))
.head 9 +  If SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Set bOk = nKwo>0
.head 8 +  If bOk
.head 9 -  Set nTimeStart = SalDateHour(
    SalDateCurrent())*3600 + SalDateMinute(
    SalDateCurrent())*60 + SalDateSecond(
    SalDateCurrent())
.head 9 -  Set dfStart = 'Старт: ' || SalFmtFormatDateTime(
    SalDateCurrent(), 'hhh:mm:ss')
.head 9 +  If File(sFile1a)
.head 10 -  Set nI = 0
.head 10 +  While not SalFileOpen(hF, sFile1a, OF_Delete)
.head 11 -  Set nI = nI + 1
.head 11 +  If nI < 5
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  Call MessageNoWait('Невозможно сформировать '
     || 'файл ' || sFile1a || ', возможно он '
     || 'занят другим приложением.',
     'ВНИМАНИЕ !!!', 0, 1)
.head 12 -  Set bOk = FALSE
.head 10 +  If not File(sFile1a)
.head 11 -  Set bOk = TRUE
.head 9 +  If bOk
.head 10 -  Call SalFileGetCurrentDirectory(sOdir)
.head 10 -  Call SalFileSetCurrentDirectory(
     Left(sBuhPath, Len(sBuhPath)-1))
.head 10 -  Set SqlDatabase = 'dBase_Files'
.head 10 -  ! родить Buch_A.Dbf
.head 10 +  If SqlConnect(hSqlA)
.head 11 -  Set nPos = 0
.head 11 -  Set nDelta = 100 / nKwo
.head 11 -  Set dMaxFdat = dYes - 1
.head 11 +  If SqlPrepareAndExecute(hSql(), T("
   SELECT max(fdat)
   INTO :dMaxFdat
   FROM fdat
   WHERE fdat<:dYes"))
.head 12 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 11 -  Set nMaxFdat = Val(SalFmtFormatDateTime(dMaxFdat,
    'ddMMyy'))
.head 11 -  Set bFL = SqlPrepareAndExecute(hSqlA, "
    CREATE
    TABLE " || sFileA || " (ISP     NUMBER(3),
                            PAP     NUMBER(2),
                            NLS     CHAR(14),
                            PLIS    NUMBER(16),
                            DOS     NUMBER(16),
                            KOS     NUMBER(16),
                            DAPP    NUMBER(6),
                            DAOS    DATE,
                            NAMS    CHAR(38))")
    and SqlPrepareAndExecute(hSql(), "
    SELECT isp,pap,nls,plis,dos,kos,dapp,daos,
           nms
    INTO :nISP,:nPAP,:sNLS,:nPLIS,:nDOS,:nKOS,
         :nDAPP,:dDAOS,:sNAMS
    FROM buch_a
    WHERE fdat=:dYes")
.head 11 +  If bFL
.head 12 -  Set nPLIS = Val(
    SalFmtFormatDateTime(dYes, 'ddMMyy'))
.head 12 +  If SqlPrepareAndExecute(hSqlA, "
   INSERT
   INTO " || sFileA || " (isp,pap,nls,plis,dos,
                          kos,dapp,daos,nams)
   VALUES (null,null,'',:nPLIS,null,null,
           :nMaxFdat,null,'')")
.head 13 +  While SqlFetchNext(hSql(), nFetchRes)
.head 14 -  Set sNAMS = StrWinToDosX(sNAMS)
.head 14 -  Set bFL = SqlPrepareAndExecute(hSqlA, "
    INSERT
    INTO " || sFileA || " (isp,pap,nls,
                           plis,dos,kos,
                           dapp,daos,nams)
    VALUES (:nISP,:nPAP,:sNLS,:nPLIS,
            :nDOS,:nKOS,:nDAPP,:dDAOS,
            :sNAMS)")
.head 14 +  If not bFL
.head 15 -  Break
.head 14 -  Set nPos = nPos + nDelta
.head 14 -  Call ccA.SetProgress(nPos)
.head 14 +  If Int(nPos) != nTek
.head 15 -  Set nTek = Int(nPos)
.head 15 -  Set nTimeCurrent = SalDateHour(
    SalDateCurrent())*3600 +
    SalDateMinute(SalDateCurrent())*60 +
    SalDateSecond(SalDateCurrent())
.head 15 -  Set nTimeEnd = Int(100 *
    (nTimeCurrent-nTimeStart) / nPos +
    nTimeStart)
.head 15 -  Set nHour = Int(nTimeEnd/3600)
.head 15 -  Set nTemp = nTimeEnd - nHour*3600
.head 15 -  Set nMinu = Int(nTemp/60)
.head 15 -  Set dfEnd = 'Финиш: ' || Right(
    Str(100+nHour), 2) || ':' || Right(
    Str(100+nMinu), 2) || ':' || Right(
    Str(100+nTemp-nMinu*60), 2) ||
    ' (прогноз)'
.head 14 -  Call SalUpdateWindow(hWndForm)
.head 12 +  Else
.head 13 -  Set bFL = FALSE
.head 12 +  If bFL
.head 13 -  Call SqlCommit(hSqlA)
.head 13 -  Set cbA = FALSE
.head 13 -  Call cc1.SpecialDate(SPECIAL_OneTime, dYes,
     DAY_Unset, SEQ_Unset, COLOR_Blue,
     COLOR_Yellow, TRUE)
.head 12 +  Else
.head 13 -  Call SqlRollback(hSqlA)
.head 13 -  Call SalWaitCursor(FALSE)
.head 13 -  Call MessageNoWait('Невозможно сформировать'
     || ' файл ' || sFile1a ||
     ': INSERT error.', 'ВНИМАНИЕ !!!', 0,
     1)
.head 11 -  Call SqlDisconnect(hSqlA)
.head 11 -  Call ccA.SetProgress(100)
.head 10 -  Call SalFileSetCurrentDirectory(sOdir)
.head 8 +  Else
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Set cbA = FALSE
.head 9 -  Call MessageNoWait('Нет информации для формирования'
     || ' Buch_A.Dbf.', 'ВНИМАНИЕ !!!', 0, 1)
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Set dfStart = ''
.head 8 -  Set dfEnd = ''
.head 7 +  If cbB
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 -  Set nKwo = 0
.head 8 -  Set bOk = FALSE
.head 8 +  If SqlPrepareAndExecute(hSql(), T("
   SELECT count(*)
   INTO :nKwo
   FROM buch_b
   WHERE vdate=:dYes"))
.head 9 +  If SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Set bOk = nKwo>0
.head 8 +  If bOk
.head 9 -  Set nTimeStart = SalDateHour(
    SalDateCurrent())*3600 + SalDateMinute(
    SalDateCurrent())*60 + SalDateSecond(
    SalDateCurrent())
.head 9 -  Set dfStart = 'Старт: ' || SalFmtFormatDateTime(
    SalDateCurrent(), 'hhh:mm:ss')
.head 9 +  If File(sFile1b)
.head 10 -  Set nI = 0
.head 10 +  While not SalFileOpen(hF, sFile1b, OF_Delete)
.head 11 -  Set nI = nI + 1
.head 11 +  If nI < 5
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  Call MessageNoWait('Невозможно сформировать '
     || 'файл ' || sFile1b || ', возможно он '
     || 'занят другим приложением.',
     'ВНИМАНИЕ !!!', 0, 1)
.head 12 -  Set bOk = FALSE
.head 10 +  If not File(sFile1b)
.head 11 -  Set bOk = TRUE
.head 9 +  If bOk
.head 10 -  Call SalFileGetCurrentDirectory(sOdir)
.head 10 -  Call SalFileSetCurrentDirectory(
     Left(sBuhPath, Len(sBuhPath)-1))
.head 10 -  Set SqlDatabase = 'dBase_Files'
.head 10 -  ! родить Buch_B.Dbf
.head 10 +  If SqlConnect(hSqlB)
.head 11 -  Set nPos = 0
.head 11 -  Set nDelta = 100 / nKwo
.head 11 -  Set bFL = SqlPrepareAndExecute(hSqlB, "
    CREATE
    TABLE " || sFileB || " (NM    NUMBER(2),
                            DK    NUMBER(1),
                            REF   NUMBER(8),
                            MFO   NUMBER(9),
                            ND    CHAR(10),
                            NLS   CHAR(14),
                            NLSK  CHAR(14),
                            SK    NUMBER(2),
                            S     NUMBER(16),
                            VDATE DATE,
                            DATD  DATE,
                            PLAT  CHAR(38),
                            POLU  CHAR(38),
                            NAZ1  CHAR(160),
                            VOB   NUMBER(2),
                            TP    CHAR(2),
                            KOD   CHAR(14))")
    and SqlPrepareAndExecute(hSql(), "
    SELECT nm,dk,ref,mfo,nd,nls,nlsk,sk,s,
           vdate,datd,plat,polu,naz1,vob,tp,kod
    INTO :nNM,:nDK,:nREF,:nMFO,:sND,:sNLS,
         :sNLSK,:nSK,:nS,:dVDATE,:dDATD,:sPLAT,
         :sPOLU,:sNAZ1,:nVOB,:sTP,:sKOD
    FROM buch_b
    WHERE vdate=:dYes")
.head 11 +  If bFL
.head 12 +  If SqlPrepareAndExecute(hSqlB, "
   INSERT
   INTO " || sFileB || " (nm,dk,ref,mfo,nd,
                          nls,nlsk,sk,s,vdate,
                          datd,plat,polu,naz1,
                          vob,tp,kod)
   VALUES (null,null,null,null,'','','',null,
           null,:dYes,null,'','','',null,'',
           '')")
.head 13 +  While SqlFetchNext(hSql(), nFetchRes)
.head 14 -  Set sND = StrWinToDosX(sND)
.head 14 -  Set sPLAT = StrWinToDosX(sPLAT)
.head 14 -  Set sPOLU = StrWinToDosX(sPOLU)
.head 14 -  Set sNAZ1 = StrWinToDosX(sNAZ1)
.head 14 -  Set bFL = SqlPrepareAndExecute(hSqlB, "
    INSERT
    INTO " || sFileB || " (nm,dk,ref,mfo,
                           nd,nls,nlsk,sk,
                           s,vdate,datd,
                           plat,polu,naz1,
                           vob,tp,kod)
    VALUES (:nNM,:nDK,:nREF,:nMFO,:sND,
            :sNLS,:sNLSK,:nSK,:nS,:dVDATE,
            :dDATD,:sPLAT,:sPOLU,:sNAZ1,
            :nVOB,:sTP,:sKOD)")
.head 14 +  If not bFL
.head 15 -  Break
.head 14 -  Set nPos = nPos + nDelta
.head 14 -  Call ccB.SetProgress(nPos)
.head 14 +  If Int(nPos) != nTek
.head 15 -  Set nTek = Int(nPos)
.head 15 -  Set nTimeCurrent = SalDateHour(
    SalDateCurrent())*3600 +
    SalDateMinute(SalDateCurrent())*60 +
    SalDateSecond(SalDateCurrent())
.head 15 -  Set nTimeEnd = Int(100 *
    (nTimeCurrent-nTimeStart) / nPos +
    nTimeStart)
.head 15 -  Set nHour = Int(nTimeEnd/3600)
.head 15 -  Set nTemp = nTimeEnd - nHour*3600
.head 15 -  Set nMinu = Int(nTemp/60)
.head 15 -  Set dfEnd = 'Финиш: ' || Right(
    Str(100+nHour), 2) || ':' || Right(
    Str(100+nMinu), 2) || ':' || Right(
    Str(100+nTemp-nMinu*60), 2) ||
    ' (прогноз)'
.head 14 -  Call SalUpdateWindow(hWndForm)
.head 12 +  Else
.head 13 -  Set bFL = FALSE
.head 12 +  If bFL
.head 13 -  Call SqlCommit(hSqlB)
.head 13 -  Set cbB = FALSE
.head 13 -  Call cc1.SpecialDate(SPECIAL_OneTime, dYes,
     DAY_Unset, SEQ_Unset, COLOR_Blue,
     COLOR_Green, TRUE)
.head 12 +  Else
.head 13 -  Call SqlRollback(hSqlB)
.head 13 -  Call SalWaitCursor(FALSE)
.head 13 -  Call MessageNoWait('Невозможно сформировать'
     || ' файл ' || sFile1b ||
     ': INSERT error.', 'ВНИМАНИЕ !!!', 0,
      1)
.head 11 -  Call SqlDisconnect(hSqlB)
.head 11 -  Call ccB.SetProgress(100)
.head 10 -  Call SalFileSetCurrentDirectory(sOdir)
.head 8 +  Else
.head 9 -  Call SalWaitCursor(FALSE)
.head 9 -  Call MessageNoWait('Нет информации для формирования'
     || ' Buch_B.Dbf.', 'ВНИМАНИЕ !!!', 0, 1)
.head 9 -  Set cbB = FALSE
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Set dfStart = ''
.head 8 -  Set dfEnd = ''
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   9.583"
.head 5 -  Top:    0.071"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.5"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 3 +  Custom Control: ccA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.383"
.head 6 -  Top:    1.071"
.head 6 -  Width:  7.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Marigold
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Custom Control: ccB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.383"
.head 6 -  Top:    1.821"
.head 6 -  Width:  7.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.417"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Dark Green
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Check Box: cbA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.383"
.head 5 -  Top:    0.821"
.head 5 -  Width:  0.35"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.383"
.head 5 -  Top:    1.571"
.head 5 -  Width:  0.35"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Custom Control: cc1
.data CLASSPROPSSIZE
0000: 3400
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 6461720025000100 0000000100010000 0200000001000001
0020: 0101010000000A31 352F30362F313935 36000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCalendar
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  3.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 2.167"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 +  Message Actions
.head 5 +  On SAM_CustControlCmd
.head 6 -  Call cc1.GetFocusDate(dDada)
.head 6 +  If cc1.IsSpecialDate(SPECIAL_OneTime, dDada, DAY_Unset,
   SEQ_Unset)
.head 7 -  Call cc1.SpecialDate(SPECIAL_OneTime, dYes, DAY_Unset,
     SEQ_Unset, COLOR_Blue, COLOR_Cyan, TRUE)
.head 7 +  If dYes != dDada
.head 8 -  Set cbA = TRUE
.head 8 -  Set cbB = TRUE
.head 8 -  Call ccA.SetProgress(0)
.head 8 -  Call ccB.SetProgress(0)
.head 7 -  Set dYes = dDada
.head 7 -  Call cc1.SpecialDate(SPECIAL_OneTime, dYes, DAY_Unset,
     SEQ_Unset, COLOR_Blue, COLOR_Marigold, TRUE)
.head 5 +  On SAM_Create
.head 6 -  Call cc1.WeekStartSet(2)
.head 3 +  Data Field: dfStart
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.383"
.head 6 -  Top:    0.095"
.head 6 -  Width:  4.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfEnd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.383"
.head 6 -  Top:    0.345"
.head 6 -  Width:  4.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.883"
.head 6 -  Top:    0.845"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Black
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.883"
.head 6 -  Top:    1.595"
.head 6 -  Width:  6.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Black
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: sFileA
.head 3 -  String: sFileB
.head 3 -  String: sFile1a
.head 3 -  String: sFile1b
.head 3 -  Number: nKwo
.head 3 -  Boolean: bOk
.head 3 -  Number: nI
.head 3 -  File Handle: hF
.head 3 -  String: sOdir
.head 3 -  String: sBuhPath
.head 3 -  Sql Handle: hSqlA
.head 3 -  Sql Handle: hSqlB
.head 3 -  Number: nPos
.head 3 -  Number: nDelta
.head 3 -  Boolean: bFL
.head 3 -  !
.head 3 -  Number: nISP
.head 3 -  Number: nPAP
.head 3 -  Number: nPLIS
.head 3 -  Number: nDOS
.head 3 -  Number: nKOS
.head 3 -  Number: nDAPP
.head 3 -  Number: nNM
.head 3 -  Number: nDK
.head 3 -  Number: nREF
.head 3 -  Number: nMFO
.head 3 -  Number: nSK
.head 3 -  Number: nS
.head 3 -  Number: nVOB
.head 3 -  String: sNAMS
.head 3 -  String: sND
.head 3 -  String: sPLAT
.head 3 -  String: sPOLU
.head 3 -  String: sNAZ1
.head 3 -  String: sNLS
.head 3 -  String: sNLSK
.head 3 -  String: sTP
.head 3 -  String: sKOD
.head 3 -  Date/Time: dDAOS
.head 3 -  Date/Time: dVDATE
.head 3 -  Date/Time: dDATD
.head 3 -  !
.head 3 -  Date/Time: dDada
.head 3 -  Date/Time: dYes
.head 3 -  !
.head 3 -  String: smMonth[*]
.head 3 -  String: smWeek[*]
.head 3 -  Date/Time: dSelect
.head 3 -  !
.head 3 -  Number: nTimeStart
.head 3 -  Number: nTek
.head 3 -  Number: nTimeCurrent
.head 3 -  Number: nTimeEnd
.head 3 -  Number: nHour
.head 3 -  Number: nTemp
.head 3 -  Number: nMinu
.head 3 -  !
.head 3 -  Date/Time: dMaxFdat
.head 3 -  Number: nMaxFdat
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Set cbA = TRUE
.head 4 -  Set cbB = TRUE
.head 4 -  Set dYes = GetBankDate()
.head 4 -  Call cc1.ClearSpecials()
.head 4 -  Call SalSetFocus(cc1)
.head 4 -  Call GetMonthArrayRus(smMonth)
.head 4 -  Call GetWeekDayArray(smWeek)
.head 4 -  Call cc1.SetMonthText(smMonth)
.head 4 -  Call cc1.SetWeekDayText(smWeek)
.head 4 -  Call cc1.SpecialDate(SPECIAL_Weekly, DATETIME_Null,
     DAY_Sunday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 4 -  Call cc1.SpecialDate(SPECIAL_Weekly, DATETIME_Null,
     DAY_Monday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 4 -  Call cc1.SpecialDate(SPECIAL_Weekly, DATETIME_Null,
     DAY_Tuesday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 4 -  Call cc1.SpecialDate(SPECIAL_Weekly, DATETIME_Null,
     DAY_Wednesday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 4 -  Call cc1.SpecialDate(SPECIAL_Weekly, DATETIME_Null,
     DAY_Thursday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 4 -  Call cc1.SpecialDate(SPECIAL_Weekly, DATETIME_Null,
     DAY_Friday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 4 -  Call cc1.SpecialDate(SPECIAL_Weekly, DATETIME_Null,
     DAY_Saturday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
.head 4 -  Call SqlPrepareAndExecute(hSql(), T("
     SELECT fdat
     INTO :dSelect
     FROM fdat"))
.head 4 -  Set nI = 0
.head 4 +  While SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Call cc1.SpecialDate(SPECIAL_OneTime, dSelect, DAY_Unset,
     SEQ_Unset, COLOR_Blue, COLOR_Cyan, TRUE)
.head 5 -  Set nI = nI + 1
.head 4 +  If nI = 0
.head 5 -  Call SalHideWindow(cc1)
.head 5 -  Call SalHideWindow(pbRun)
.head 5 -  Call SalSetFocus(pbExit)
.head 4 +  Else
.head 5 -  Call cc1.SetFocusDate(dYes)
.head 4 -  Set sFileA = 'Buch_A'
.head 4 -  Set sFileB = 'Buch_B'
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Export', 'BuhPath', GetPrnDir(),
     sBuhPath, GetIniFileName())
.head 4 -  Set sBuhPath = IifS(Right(sBuhPath, 1)='\\', sBuhPath,
    sBuhPath || '\\')
.head 4 -  Set dfA = sBuhPath || 'Buch_A.Dbf (Saldo)'
.head 4 -  Set dfB = sBuhPath || 'Buch_B.Dbf (Oper)'
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Table Window: abonKB
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Карточки (параметры) абонентов КЛИЕНТ-БАНК
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.825"
.head 4 -  Top:    0.854"
.head 4 -  Width:  9.671"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.071"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Bold
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 2048
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 382
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Создание инсталляционных пакетов'
.head 6 +  On SAM_Click
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Call MakeA(abonKB.colSab, abonKB.colRnk)
.head 7 -  Call MakeI(abonKB.colSab, abonKB.colKod, abonKB.colIdb, abonKB.colIdd)
.head 7 -  Call MakeM(abonKB.colSab)
.head 7 -  Call MakeW(abonKB.colSab)
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call MessageNoWait('Инсталляционные пакеты (A,I,M,W) для' || Repl(PutCrLf(), 2) || Spac(24) || abonKB.colNmk || ' ('
     || abonKB.colSab || ')' || Repl(PutCrLf(), 2) || 'созданы !', 'СООБЩЕНИЕ', 17, 0)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 383
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 384
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: colSab
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNmk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 38
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.586"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRnk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рег.номер
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 38
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  3.586"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKod
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код ОКПО
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 38
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.586"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTip
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ЭЦП
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 10
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colIdb
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Идентификатор
бухгалтера
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 8
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colIdd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Идентификатор
директора
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 8
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colIdo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Идентификатор
оператора
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 8
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.517"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colIds
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Идентификатор
(шифрование)
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 8
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBlk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Блоки-
ровка
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.683"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 0
.head 6 -  Uncheck Value: 1
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRowid
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Rowid
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.683"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 0
.head 6 -  Uncheck Value: 1
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: Suffix
.head 4 -  Description: возвращает суффикс по типу файла и SAB
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sSab
.head 5 -  String: sTip
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nSuf
.head 5 -  Number: nRnk
.head 5 -  String: sTemp
.head 4 +  Actions
.head 5 -  Call SqlPrepareAndExecute(hSqlAux2(), T('
     SELECT k.count,k.rnk
     INTO :nSuf,:nRnk
     FROM custcount k, customer c
     WHERE k.tip=:sTip and c.sab=:sSab and k.rnk=c.rnk'))
.head 5 +  If SqlFetchNext(hSqlAux2(), nFetchRes)
.head 6 +  ! If nSuf = 99
.head 7 -    Set nSuf = 0
.head 6 +  ! Else
.head 7 -    Set nSuf = nSuf + 1
.head 6 -  Set nSuf = IifN(nSuf=99, 0, nSuf+1)
.head 6 -  Call SqlPrepareAndExecute(hSqlAux2(), T('
     UPDATE custcount
     SET count=:nSuf
     WHERE rnk=:nRnk and tip=:sTip'))
.head 5 +  Else
.head 6 -  Call SqlPrepareAndExecute(hSqlAux2(), T('
     SELECT rnk
     INTO :nRnk
     FROM customer
     WHERE sab=:sSab'))
.head 6 -  Call SqlFetchNext(hSqlAux2(), nFetchRes)
.head 6 -  Call SqlPrepareAndExecute(hSqlAux2(), T('
     SELECT tip
     INTO :sTemp
     FROM tipcount
     WHERE tip=:sTip'))
.head 6 +  If not SqlFetchNext(hSqlAux2(), nFetchRes)
.head 7 -  Call SqlPrepareAndExecute(hSqlAux2(), T("
     INSERT
     INTO tipcount (tip, name)
     VALUES (:sTip,'')"))
.head 6 -  Call SqlPrepareAndExecute(hSqlAux2(), T('
     INSERT
     INTO custcount (rnk,tip,count)
     VALUES (:nRnk,:sTip,:nSuf)'))
.head 5 -  Return Right(Str(nSuf+1000), 3)
.head 3 +  Function: MakeA
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sSab
.head 5 -  Number: nRnk
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set bFl = TRUE
.head 5 -  ! Set nBaseVal = GetBaseVal()
.head 5 -  ! Call SqlPrepareAndExecute(hSqlAux3(), T("
     SELECT a.nls,a.kv,a.blkk,a.blkd,a.pap,a.nms,a.daos,a.dazs,a.ostc,a.dos,a.kos,a.acc
     INTO   :sNls,:nKv,:nBlkk,:nBlkd,:nPap,:sNms,:dDaos,:dDazs,:nOstc,:nDos,:nKos,:nAcc
     FROM   accounts a, customer c
     WHERE  c.rnk=:nRnk and c.rnk=a.rnk and a.acc in (SELECT acc
                                                      FROM   acce)
     UNION ALL
     SELECT a.nls,a.kv,a.blkk,a.blkd,a.pap,a.nms,a.daos,a.dazs,a.ostc,a.dos,a.kos,a.acc
     FROM   accounts a, klp_top c, customer r
     WHERE  r.rnk=:nRnk and c.rnkp=r.rnk and c.rnk=a.rnk and a.acc in (SELECT acc
                                                                       FROM   acce
                                                                       WHERE  high=1)"))
.head 5 -  Call SqlPrepareAndExecute(hSqlAux3(), "
     SELECT nls,kv,blkk,blkd,pap,nms,daos,dazs,fost(acc,:dBankDateM1),fdos(acc,:dBankDate,:dBankDate),
            fkos(acc,:dBankDate,:dBankDate),fost(acc,:dBankDate),acc
     INTO   :sNls,:nKv,:nBlkk,:nBlkd,:nPap,:sNms,:dDaos,:dDazs,:nOsti,:nDos,:nKos,:nOstc,:nAcc
     FROM   accounts
     WHERE  rnk=:nRnk and acc in (SELECT acc
                                  FROM   acce
                                  WHERE  nvl(pers,0)=1)
     UNION ALL
     SELECT a.nls,a.kv,a.blkk,a.blkd,a.pap,a.nms,a.daos,a.dazs,fost(a.acc,:dBankDateM1),
            fdos(a.acc,:dBankDate,:dBankDate),fkos(a.acc,:dBankDate,:dBankDate),fost(a.acc,:dBankDate),a.acc
     FROM   accounts a, klp_top c, customer r
     WHERE  r.rnk=:nRnk and c.rnkp=r.rnk and c.rnk=a.rnk and a.acc in (SELECT acc
                                                                       FROM   acce
                                                                       WHERE  high=1)")
.head 5 +  While SqlFetchNext(hSqlAux3(), nFetchRes)
.head 6 -  ! Call SqlPrepareAndExecute(hSqlAux2(), T("
     SELECT max(fdat)
     INTO :dDaep
     FROM opldok
     WHERE acc=:nAcc"))
.head 6 -  Call SqlPrepareAndExecute(hSqlAux2(), T("
     SELECT max(fdat)
     INTO :dDaep
     FROM saldoa
     WHERE acc=:nAcc"))
.head 6 -  Call SqlFetchNext(hSqlAux2(), nFetchRes)
.head 6 +  If bFl
.head 7 -  Set bFl = FALSE
.head 7 -  Set sFile = sTempPath || 'A' || ddd(dBankDate) || Suffix(sSab, 'A') || Left(sSab, 1) || '.' || Right(sSab, 3)
.head 7 +  If File(sFile)
.head 8 -  Call VisFileDelete(sFile)
.head 7 -  Call VisFileOpen(hF, sFile, OF_Create)
.head 6 -  Set sString = PadL(sNls, 14) || PadL(Str(nKv), 3) || Str(Min(nBlkk+nBlkd, 1)) || PadL(Str(IifN(nPap=3, 0, nPap)), 2)
    || PadR(StrWinToDosX(sNms), 38) || SalFmtFormatDateTime(dDaos, 'yyyyMMdd') || PadL(
    SalFmtFormatDateTime(dDazs, 'yyyyMMdd'), 8) || PadL(Str(nOsti), 16) || PadL(Str(nDos), 16) || PadL(Str(nKos), 16)
    || PadL(Str(nOstc), 16) || PadL(SalFmtFormatDateTime(dDaep, 'yyyyMMdd'), 8) || PutCrLf()
.head 6 -  Call VisFileWrite(hF, sString, Len(sString))
.head 5 -  Call SqlCommit(hSqlAux2())
.head 5 +  If not bFl
.head 6 -  Call VisFileClose(hF)
.head 6 -  Call VisFileCopy(sFile, sDiskKataOUTI || Right(sFile, 12))
.head 6 -  Set syyyyMMddPath = sArchPath || 'BCK\\' || SalFmtFormatDateTime(dBankDate, 'yyyyMMdd') || '\\'
.head 6 -  Call SalFileCreateDirectory(syyyyMMddPath)
.head 6 -  Call SalFileCopy(sFile, syyyyMMddPath || Right(sFile, 12), TRUE)
.head 6 +  If File(sDiskKataOUTI || Right(sFile, 12))
.head 7 -  Call VisFileDelete(sFile)
.head 7 -  Return TRUE
.head 6 -  Return FALSE
.head 5 -  Return FALSE
.head 3 +  Function: MakeI
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sSab
.head 5 -  String: sKod
.head 5 -  String: sIdb
.head 5 -  String: sIdd
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set sFile = sTempPath || 'I' || ddd(dBankDate) || Suffix(sSab, 'I') || Left(sSab, 1) || '.' || Right(sSab, 3)
.head 5 -  Call SqlCommit(hSqlAux2())
.head 5 +  If File(sFile)
.head 6 -  Call VisFileDelete(sFile)
.head 5 -  Call VisFileOpen(hF, sFile, OF_Create)
.head 5 -  Set sString = PadR(sSab, 4) || PadR(sKod, 14) || PadR(sIdb, 8) || PadR(sIdd, 8) ||
    PadL(sBankMFO, 9) || PadR(sIdOBRAB, 8) || PutCrLf()
.head 5 -  Call VisFileWrite(hF, sString, Len(sString))
.head 5 -  Call VisFileClose(hF)
.head 5 -  Call VisFileCopy(sFile, sDiskKataOUTI || Right(sFile, 12))
.head 5 -  Set syyyyMMddPath = sArchPath || 'BCK\\' || SalFmtFormatDateTime(dBankDate, 'yyyyMMdd') || '\\'
.head 5 -  Call SalFileCreateDirectory(syyyyMMddPath)
.head 5 -  Call SalFileCopy(sFile, syyyyMMddPath || Right(sFile, 12), TRUE)
.head 5 +  If File(sDiskKataOUTI || Right(sFile, 12))
.head 6 -  Call VisFileDelete(sFile)
.head 6 -  Return TRUE
.head 5 -  Return FALSE
.head 3 +  Function: MakeM
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sSab
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set bFl = TRUE
.head 5 -  Call SqlPrepareAndExecute(hSqlAux3(), T("
     SELECT mfo,nb,blk
     INTO :sMfo,:sNb,:nBlk
     FROM banks
     WHERE blk<>4"))
.head 5 +  While SqlFetchNext(hSqlAux3(), nFetchRes)
.head 6 +  If bFl
.head 7 -  Set bFl = FALSE
.head 7 -  Set sFile = sTempPath || 'M' || ddd(dBankDate) || Suffix(sSab, 'M') || Left(sSab, 1) || '.' || Right(sSab, 3)
.head 7 +  If File(sFile)
.head 8 -  Call VisFileDelete(sFile)
.head 7 -  Call VisFileOpen(hF, sFile, OF_Create)
.head 6 -  Set sString = PadL(sMfo, 9) || PadR(StrWinToDosX(sNb), 38) || IifS(nBlk=0, '0', '1') || PutCrLf()
.head 6 -  Call VisFileWrite(hF, sString, Len(sString))
.head 5 -  Call SqlCommit(hSqlAux2())
.head 5 +  If not bFl
.head 6 -  Call VisFileClose(hF)
.head 6 -  Call VisFileCopy(sFile, sDiskKataOUTI || Right(sFile, 12))
.head 6 -  Set syyyyMMddPath = sArchPath || 'BCK\\' || SalFmtFormatDateTime(dBankDate, 'yyyyMMdd') || '\\'
.head 6 -  Call SalFileCreateDirectory(syyyyMMddPath)
.head 6 -  Call SalFileCopy(sFile, syyyyMMddPath || Right(sFile, 12), TRUE)
.head 6 +  If File(sDiskKataOUTI || Right(sFile, 12))
.head 7 -  Call VisFileDelete(sFile)
.head 7 -  Return TRUE
.head 6 -  Return FALSE
.head 5 -  Return FALSE
.head 3 +  Function: MakeW
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sSab
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set bFl = TRUE
.head 5 -  Call SqlPrepareAndExecute(hSqlAux3(), T("
     SELECT kv,name,lcv
     INTO :nKv,:sName,:sLcv
     FROM tabval"))
.head 5 +  While SqlFetchNext(hSqlAux3(), nFetchRes)
.head 6 +  If bFl
.head 7 -  Set bFl = FALSE
.head 7 -  Set sFile = sTempPath || 'W' || ddd(dBankDate) || Suffix(sSab, 'W') || Left(sSab, 1) || '.' || Right(sSab, 3)
.head 7 +  If File(sFile)
.head 8 -  Call VisFileDelete(sFile)
.head 7 -  Call VisFileOpen(hF, sFile, OF_Create)
.head 6 -  Set sString = PadL(Str(nKv), 3) || PadR(StrWinToDosX(sName), 38) || PadR(sLcv, 3) || PutCrLf()
.head 6 -  Call VisFileWrite(hF, sString, Len(sString))
.head 5 -  Call SqlCommit(hSqlAux2())
.head 5 +  If not bFl
.head 6 -  Call VisFileClose(hF)
.head 6 -  Call VisFileCopy(sFile, sDiskKataOUTI || Right(sFile, 12))
.head 6 -  Set syyyyMMddPath = sArchPath || 'BCK\\' || SalFmtFormatDateTime(dBankDate, 'yyyyMMdd') || '\\'
.head 6 -  Call SalFileCreateDirectory(syyyyMMddPath)
.head 6 -  Call SalFileCopy(sFile, syyyyMMddPath || Right(sFile, 12), TRUE)
.head 6 +  If File(sDiskKataOUTI || Right(sFile, 12))
.head 7 -  Call VisFileDelete(sFile)
.head 7 -  Return TRUE
.head 6 -  Return FALSE
.head 5 -  Return FALSE
.head 3 +  ! Function: InitStmt
.head 4 -  Description: Инициализация кода выписки эл.клиента
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set nSTMTValue = GetGlobalOptionEx('EPSTMT')
.head 5 +  If nSTMTValue = 0
.head 6 -  Set nSTMTValue = 5 ! тип выписки 'Электронный клиент'
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: sSAB
.head 3 -  String: sNMK
.head 3 -  String: smSAB[*]
.head 3 -  String: smNMK[*]
.head 3 -  Number: nI
.head 3 -  Number: nK
.head 3 -  String: sDiskKataOUT
.head 3 -  String: sDiskKataOUTI
.head 3 -  String: sTempPath
.head 3 -  String: sArchPath
.head 3 -  String: sIdOBRAB
.head 3 -  Boolean: bFl
.head 3 -  ! Number: nBaseVal
.head 3 -  String: sFile
.head 3 -  File Handle: hF
.head 3 -  String: sString
.head 3 -  String: sNls
.head 3 -  Number: nKv
.head 3 -  Number: nBlkk
.head 3 -  Number: nBlkd
.head 3 -  Number: nPap
.head 3 -  String: sNms
.head 3 -  Date/Time: dDaos
.head 3 -  Date/Time: dDazs
.head 3 -  Number: nOsti
.head 3 -  Number: nOstc
.head 3 -  Number: nDos
.head 3 -  Number: nKos
.head 3 -  Date/Time: dDaep
.head 3 -  Number: nAcc
.head 3 -  Date/Time: dBankDate
.head 3 -  Date/Time: dBankDateM1
.head 3 -  String: sBankMFO
.head 3 -  String: sMfo
.head 3 -  String: sNb
.head 3 -  Number: nBlk
.head 3 -  String: sName
.head 3 -  String: sLcv
.head 3 -  !
.head 3 -  String: syyyyMMddPath
.head 3 -  ! Number: nSTMTValue
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Set dBankDate = GetBankDate()
.head 4 -  Set dBankDateM1 = dBankDate - 1
.head 4 -  Set sBankMFO = GetBankMfo()
.head 4 -  Set sDiskKataOUT = GetElKDirOUT() ! получить путь к OUT электронных клиентов
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('ElektroKlients', 'SBB_OUTI', sDiskKataOUT, sDiskKataOUTI, GetIniFileName())
.head 4 +  If SalStrRightX(sDiskKataOUTI, 1) != '\\' ! путь к OUTI электронных клиентов (каталог инсталл. НЕшифрованных файлов)
.head 5 -  Set sDiskKataOUTI = sDiskKataOUTI || '\\'
.head 4 -  Set sTempPath = GetTempKPath()    ! получить путь временных файлов КЛИЕНТ-БАНК
.head 4 -  Set sArchPath = GetArchiv_KB()    ! получить путь к архиву файлов электронных клиентов
.head 4 -  Call SalGetProfileString('ElektroKlients', 'IdOBRAB', '', sIdOBRAB, GetIniFileName())
.head 4 -  ! Инициализация переменной nSTMTValue - тип выписки эл. клиента
.head 4 -  ! Call InitStmt()
.head 4 -  !
.head 4 -  ! Call SqlPrepareAndExecute(hSql(), T("
     SELECT sab,nmk
     INTO :sSAB,:sNMK
     FROM customer
     WHERE sab is not null and stmt=:nSTMTValue"))
.head 4 -  Call SqlPrepareAndExecute(hSql(), T("
     SELECT sab,nmk
     INTO :sSAB,:sNMK
     FROM customer
     WHERE sab is not null and (stmt=5 or stmt=6)"))
.head 4 -  Set nI = 0
.head 4 -  Call SalArraySetUpperBound(smSAB, 1, -1)
.head 4 -  Call SalArraySetUpperBound(smNMK, 1, -1)
.head 4 +  While SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Set smSAB[nI] = sSAB
.head 5 -  Set smNMK[nI] = sNMK
.head 5 -  Set nI = nI + 1
.head 4 +  If nI > 0
.head 5 -  Call SqlPrepareAndExecute(hSql(), T("
     UPDATE klpsbb
     SET flag='0'"))
.head 5 -  Set nK = nI - 1
.head 5 -  Set nI = 0
.head 5 +  While nI <= nK
.head 6 -  Set sSAB = smSAB[nI]
.head 6 -  Call SqlPrepareAndExecute(hSql(), T("
   SELECT sab
   INTO :sSAB
   FROM klpsbb
   WHERE sab=:sSAB"))
.head 6 +  If SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SqlPrepareAndExecute(hSql(), T("
     UPDATE klpsbb
     SET flag='1'
     WHERE sab=:sSAB"))
.head 6 +  Else
.head 7 -  Call SqlPrepareAndExecute(hSql(), T("
     INSERT
     INTO klpsbb (sab,flag)
     VALUES (:sSAB,'1')"))
.head 6 -  Set nI = nI + 1
.head 5 +  If SqlPrepareAndExecute(hSql(), T("
   DELETE
   FROM klpsbb
   WHERE flag='0'"))
.head 6 -  Call SqlCommit(hSql())
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Set nFlags = GT_NoIns | GT_NoDel
.head 4 -  Set abonKB.strSqlPopulate = "
    SELECT klpsbb.sab,c.nmk,c.rnk,c.okpo,klpsbb.tip,klpsbb.idb,klpsbb.idd,klpsbb.ido,klpsbb.ids,klpsbb.blk,klpsbb.rowid
    INTO :abonKB.colSab,:abonKB.colNmk,:abonKB.colRnk,:abonKB.colKod,:abonKB.colTip,:abonKB.colIdb,:abonKB.colIdd,
         :abonKB.colIdo,:abonKB.colIds,:abonKB.colBlk,:abonKB.colRowid
    FROM klpsbb, customer c
    WHERE klpsbb.sab=c.sab
    ORDER BY 1"
.head 4 -  Set abonKB.strSqlUpdate = "
    UPDATE klpsbb
    SET tip=:abonKB.colTip,idb=:abonKB.colIdb,idd=:abonKB.colIdd,ids=:abonKB.colIds,blk=:abonKB.colBlk
    WHERE rowid=:abonKB.colRowid"
.head 4 -  Set strPrintFileName = 'abonKB'
.head 4 -  Set strFilterTblName = 'klpsbb'
.head 4 -  Set fFilterAtStart = FALSE
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On UM_Populate
.head 4 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 4 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 4 -  Set nRow = TBL_MinRow
.head 4 -  Call SalTblFindNextRow(hWndForm, nRow, 0, 0)
.head 4 -  Call SalTblSetFocusRow(hWndForm, nRow)
.head 4 -  Call SalTblSetContext(hWndForm, nRow)
.head 3 +  ! On SAM_Destroy
.head 4 -  ! Disactivation of function's role, which activated for calling window
.head 4 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 5 -  Call XRoleUnset(hSql(), 'Sel000(hWndMDI,7,0,"","")')
.head 3 +  On WM_NCMouseMove
.head 4 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 1 +  Table Window: UPDEK
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Установка параметров для эл.клиентов НБУ (автомат)
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.55"
.head 4 -  Top:    0.458"
.head 4 -  Width:  9.15"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Bold
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description: Установка параметров для эл.клиентов НБУ
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.55"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 46350
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(UPDEK, nRow, 0, 0)
.head 8 -  Call SalTblFetchRow(UPDEK, nRow)
.head 8 +  If MakeOne(UPDEK.colSab,UPDEK.colNmk,UPDEK.colRnk)
.head 9 -  ! Call Debug(UPDEK.colSab)
.head 9 -  Set UPDEK.colYN = 1
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 46351
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.017"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 46352
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: colSab
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.557"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRnk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рег.номер
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNmk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 38
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  6.643"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colYN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отм.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.514"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: MakeOne
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sSab
.head 5 -  String: sNmk
.head 5 -  Number: nRnk
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute(hSql(), T("
   DELETE
   FROM bank_acc
   WHERE mfo=:nRnk"))
.head 6 +  If SqlPrepareAndExecute(hSql(), T("
   DELETE
   FROM custbank
   WHERE mfo=:nRnk"))
.head 7 +  If SqlPrepareAndExecute(hSql(), T("
   DELETE
   FROM lkl_rrp
   WHERE mfo=:nRnk"))
.head 8 +  If SqlPrepareAndExecute(hSql(), T("
   DELETE
   FROM banks
   WHERE mfo=:nRnk"))
.head 9 +  If SqlPrepareAndExecute(hSql(), T("
   INSERT
   INTO banks (mfo,sab,nb,fmi,fmo,pm,kodn,blk,mfop)
   VALUES (:nRnk,:sSab,:sNmk,'$A','$B',0,4,0,:sBankMFO)"))
.head 10 +  If SqlPrepareAndExecute(hSql(), T("
   INSERT
   INTO lkl_rrp (mfo,dat,ostf,lim,lno,kn,bn)
   VALUES (:nRnk,:dBankDate,0,0,0,0,0)"))
.head 11 +  If SqlPrepareAndExecute(hSql(), T("
   INSERT
   INTO custbank (rnk,mfo,kod_b)
   VALUES (:nRnk,:nRnk,1)"))
.head 12 +  If SqlPrepareAndExecute(hSql(), T("
   INSERT
   INTO bank_acc SELECT c.acc,:nRnk
                 FROM cust_acc c,accounts a
                 WHERE c.rnk=:nRnk and a.acc=c.acc")) ! and a.kv=980 ???
.head 13 -  Call SqlCommit(hSql())
.head 13 -  Return TRUE
.head 12 +  Else
.head 13 -  Call SqlRollback(hSql())
.head 13 -  Return FALSE
.head 11 +  Else
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Return FALSE
.head 10 +  Else
.head 11 -  Call SqlRollback(hSql())
.head 11 -  Return FALSE
.head 9 +  Else
.head 10 -  Call SqlRollback(hSql())
.head 10 -  Return FALSE
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Return FALSE
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Return FALSE
.head 5 +  Else
.head 6 -  Call SqlRollback(hSql())
.head 6 -  Return FALSE
.head 3 +  Function: InitStmt
.head 4 -  Description: Инициализация кода выписки эл.клиента
.head 4 +  Returns
.head 5 -  Number:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nTemp
.head 4 +  Actions
.head 5 -  Set nTemp = GetGlobalOptionEx('EPSTMT')
.head 5 -  Return IifN(nTemp=0 or nTemp=NUMBER_Null, 5, nTemp)
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Date/Time: dBankDate
.head 3 -  String: sBankMFO
.head 3 -  Number: nRow
.head 3 -  Number: nSTMT
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Set dBankDate = GetBankDate()
.head 4 -  Set sBankMFO = GetBankMfo()
.head 4 -  ! Инициализация переменной nSTMTValue - тип выписки эл. клиента
.head 4 -  Set nSTMT = InitStmt()
.head 4 -  Set nFlags = GT_ReadOnly
.head 4 -  ! or a.stmt=6
.head 4 -  Set UPDEK.strSqlPopulate = "
    SELECT sab,nmk,rnk
    INTO :UPDEK.colSab,:UPDEK.colNmk,:UPDEK.colRnk
    FROM customer
    WHERE sab is not null and (stmt=5 or stmt=6)
    ORDER BY 1"
.head 4 -  ! Set UPDEK.strSqlPopulate = "
    SELECT sab,nmk,rnk
    INTO :UPDEK.colSab,:UPDEK.colNmk,:UPDEK.colRnk
    FROM customer
    WHERE sab is not null and stmt=:nSTMT
    ORDER BY 1"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
.head 4 -  Call SalPostMsg(pbDetails,SAM_Click, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On UM_Populate
.head 4 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 4 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 3 +  On WM_NCMouseMove
.head 4 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 1 +  Table Window: JN
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Документарный состав проц.(ФАЙЛОВОГО) счета
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.225"
.head 4 -  Top:    0.219"
.head 4 -  Width:  17.267"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 7.44"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 40000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.833"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.617"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 15231
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.117"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.583"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.15"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 15232
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.55"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 15233
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: KV
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.183"
.head 7 -  Top:    0.071"
.head 7 -  Width:  0.633"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Валюта' )
.head 4 +  Data Field: NLS
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.817"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.983"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Рахунок процесінга' )
.head 4 +  Data Field: NMS
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.8"
.head 7 -  Top:    0.071"
.head 7 -  Width:  5.217"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Назва рахунку процесінга' )
.head 4 +  Data Field: OST1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.183"
.head 7 -  Top:    0.405"
.head 7 -  Width:  2.617"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Вхідний залишок' )
.head 4 +  Data Field: DOS
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.8"
.head 7 -  Top:    0.405"
.head 7 -  Width:  2.617"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Дебет' )
.head 4 +  Data Field: KOS
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   5.417"
.head 7 -  Top:    0.405"
.head 7 -  Width:  2.617"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Кредит' )
.head 4 +  Data Field: OST
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   8.033"
.head 7 -  Top:    0.405"
.head 7 -  Width:  2.55"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Вихідний залишок' )
.head 4 +  Data Field: DAT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   10.583"
.head 7 -  Top:    0.405"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'на дату' )
.head 6 +  On SAM_Validate
.head 7 -  Return F_DAT()
.head 4 +  Check Box: cb_Kw
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cCheckBoxLabeled
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Время квитовки
.head 5 -  Window Location and Size
.head 6 -  Left:   11.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  2.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: JM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ж
М
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.35"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Док
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.65"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: MFOA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО-А
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: MFOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО-Б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLSN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наш
счет
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAMN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наш
Клиент
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SKR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дебет
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.633"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SDE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кредит
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PRTY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ССП
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.567"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAZN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назнач
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 160
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: FN_A
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Файл
входа
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAT_A
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата вх
файла
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: DateTime
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: TIMA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сквитован
вход
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: dd-MM hhhh:mm
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: FN_B
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Файл
выхода
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAT_B
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата исх
файла
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: DateTime
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: TIMB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сквитован
выход
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.15"
.head 4 -  Width Editable? Yes
.head 4 -  Format: dd-MM hhhh:mm
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: SOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сост
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: REC
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DIK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дикарь
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ДK
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 2 +  Functions
.head 3 +  Function: F_DAT
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Set DAT_V = DAT - 1
.head 5 -  Set DAT_Z = DAT + 1
.head 5 +  If SqlPrepareAndExecute( hSql(),
  "SELECT kv,nls,nms,dos/100,kos/100, ost/100, (ost+dos-kos)/100 ,tip
   INTO :KV,:NLS,:NMS,:DOS,:KOS, :OST,:OST1, :TIP
   FROM sal where acc=:ACC and fdat=:DAT ")
and NOT SqlFetchNext( hSql(), nFetchRes )
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  Call SalColorSet( OST1, 8, IifN( OST1 >0, COLOR_DarkBlue, COLOR_DarkRed) )
.head 5 -  Call SalColorSet( OST , 8, IifN( OST >0, COLOR_DarkBlue, COLOR_DarkRed) )
.head 5 -  Set OST1 = SalNumberAbs( OST1)
.head 5 -  Set OST = SalNumberAbs( OST)
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Number: ACC
.head 2 +  Window Variables
.head 3 -  !
.head 3 -  Number: iKol
.head 3 -  Number: iSKR
.head 3 -  Number: iSDE
.head 3 -  Number: nRow
.head 3 -  !
.head 3 -  String: m300465
.head 3 -  String: aMFO
.head 3 -  String: sFilter
.head 3 -  String: TIP
.head 3 -  String: S00
.head 3 -  String: S01
.head 3 -  String: YYYY
.head 3 -  String: SAB
.head 3 -  String: MFO
.head 3 -  ! Date/Time: DAT_V ! Вчера
.head 3 -  Date/Time: DAT_Z ! Завтра
.head 3 -  String: sLike
.head 3 -  String: SOS_vx
.head 3 -  String: SOS_isx
.head 3 -  String: sSEL
.head 3 -  String: sSql
.head 3 -  !
.head 3 -  ! Window Handle: hColumn
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set m300465 = '300465'
.head 4 -  ! Set m300465 = '300175'
.head 4 -  Call PrepareWindow( hWndForm )
.head 4 -  Call SetWindowFullSize( hWndForm )
.head 4 -  Set JN.nTabInstance = 1
.head 4 -  Set YYYY = Str(SalDateYear( GetBankDate() ) )
.head 4 -  Set JN.strPrintFileName = 'JN'
.head 4 -  Set JN.strFilterTblName ='ARC_RRP'
.head 4 -  Set JN.nTabInstance = 1
.head 4 -  Set JN.fFilterAtStart = TRUE
.head 4 -  !
.head 4 -  Set aMFO = GetBankMfo()
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_CreateComplete
.head 4 -  Set DAT = GetBankDate()
.head 4 +  If NOT F_DAT( )
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 5 -  Return FALSE
.head 4 -  !
.head 4 +  If GetGlobalOption('NUMMODEL')='3'
.head 5 +  If TIP != 'L00' and TIP != 'TUD' and TIP != 'TUR'
and TIP !='N00' and TIP != 'N99' and TIP != 'TNB'
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  Set cb_Kw = FALSE
.head 5 -  Set sSEL =
"ARC_RRP.nd,   ARC_RRP.mfoa, ARC_RRP.mfob, ARC_RRP.nazn,
 ARC_RRP.sos,  ARC_RRP.rec,  ARC_RRP.ref , ARC_RRP.dk,  ARC_RRP.prty,
 ARC_RRP.fn_a, ARC_RRP.fn_b, ARC_RRP.dat_a,ARC_RRP.dat_b,"
.head 5 +  If TIP = 'N00' OR TIP = 'N99' OR TIP = 'TNB'
.head 6 -  Set SAB = GetBankSab()
.head 6 +  If TIP = 'N00'
.head 7 -  ! Вх и Исх
.head 7 -  Set SOS_vx = ' >=3 '
.head 7 -  Set SOS_isx= ' > 3 '
.head 6 +  Else If TIP = 'N99'
.head 7 -  ! Вх
.head 7 -  Set SOS_vx = ' < 3 '
.head 7 -  Set SOS_isx= STRING_Null
.head 6 +  Else If TIP = 'TNB'
.head 7 -  ! Исх
.head 7 -  Set SOS_vx = STRING_Null
.head 7 -  Set SOS_isx= ' = 3 '
.head 5 +  Else If TIP = 'L00' OR TIP = 'TUD' OR TIP = 'TUR'
.head 6 +  If SqlPrepareAndExecute( hSql(),
  "SELECT b.sab INTO :SAB from banks b, bank_acc a
   where a.acc=:ACC and a.mfo=b.mfo" )
and NOT SqlFetchNext( hSql(), nFetchRes )
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 7 -  Return FALSE
.head 6 -  !
.head 6 +  If TIP = 'L00'
.head 7 -  ! Вх и Исх
.head 7 -  Set SOS_vx = ' >=3 '
.head 7 -  Set SOS_isx= ' > 3 '
.head 6 +  Else If TIP = 'TUD' OR TIP = 'TUR'
.head 7 -  ! Исх
.head 7 -  Set SOS_vx = STRING_Null
.head 7 -  Set SOS_isx= ' = 3 '
.head 5 -  Set sLike = '__'||SAB||'%'
.head 4 +  Else
.head 5 -  Call SalHideWindow( cb_Kw )
.head 5 +  If TIP='T00'
.head 6 -  Set S00="(o.dk=arc_rrp.dk   AND o.txt=arc_rrp.fn_a AND arc_rrp.dat_a>=o.fdat AND arc_rrp.dat_a<o.fdat+1
       OR o.dk=1-arc_rrp.dk AND o.txt=arc_rrp.fn_b AND arc_rrp.dat_b>=o.fdat AND arc_rrp.dat_b<o.fdat+1)"
.head 6 -  Set S01="o.dk=arc_rrp.dk AND arc_rrp.dat_a>=o.fdat and arc_rrp.dat_a<o.fdat+1 AND o.txt=arc_rrp.fa_name"
.head 5 +  Else
.head 6 -  Set S00="(o.dk=1-arc_rrp.dk AND o.txt=arc_rrp.fn_a AND arc_rrp.dat_a>=o.fdat AND arc_rrp.dat_a<o.fdat+1
       OR o.dk=arc_rrp.dk   AND o.txt=arc_rrp.fn_b AND arc_rrp.dat_b>=o.fdat AND arc_rrp.dat_b<o.fdat+1)"
.head 6 -  Set S01="o.dk=1-arc_rrp.dk AND arc_rrp.dat_a>=o.fdat and arc_rrp.dat_a<o.fdat+1 AND o.txt=arc_rrp.fa_name"
.head 4 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On UM_Populate
.head 4 +  If JN.fFilterAtStart
.head 5 +  If SetQueryFilter( cF )
.head 6 -  Set JN.fFilterAtStart = NOT JN.fFilterAtStart
.head 4 -  Set sFilter = ""
.head 4 -  Set sFilter = cF.GetFilterWhereClause( FALSE )
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  !
.head 4 -  !
.head 4 +  If GetGlobalOption('NUMMODEL')='3'
.head 5 -  Set sSql = ""
.head 5 +  If cb_Kw = 1
.head 6 -  Call SalShowWindow( TIMA )
.head 6 -  Call SalShowWindow( TIMB )
.head 5 +  Else
.head 6 -  Call SalHideWindow( TIMA )
.head 6 -  Call SalHideWindow( TIMB )
.head 5 -  ! -----------------------
.head 5 -  ! 1 - ВХодящие
.head 5 +  If TIP = 'N00' OR TIP = 'N99' OR TIP = 'L00'
.head 6 -  ! N) из НБУ файлы и ССП
.head 6 +  If TIP = 'N00' OR TIP = 'N99'
.head 7 -  Set sSql = sSql || " SELECT
decode(ARC_RRP.dk,0,ARC_RRP.s,0)/100, decode(ARC_RRP.dk,1,ARC_RRP.s,0)/100,
 " || sSEL || "
ARC_RRP.nlsB, ARC_RRP.nam_B "
.head 6 -  ! L) из Дирекции файлы и ССП
.head 6 +  Else If TIP = 'L00'
.head 7 -  Set sSql = sSql || " SELECT
decode(ARC_RRP.dk,0,ARC_RRP.s,0)/100,decode(ARC_RRP.dk,1,ARC_RRP.s,0)/100,
 " || sSEL || "
decode(ARC_RRP.mfob,:aMFO,ARC_RRP.nlsB, ARC_RRP.nlsA),
decode(ARC_RRP.mfob,:aMFO,ARC_RRP.nam_B,ARC_RRP.nam_A) "
.head 6 -  ! ---
.head 6 -  Set sSql =  sSql || " FROM arc_rrp
  WHERE ARC_RRP.fn_A like :sLike and ARC_RRP.sos "|| SOS_vx || "
    and ARC_RRP.dat_A >= :DAT and ARC_RRP.dat_A < :DAT_Z
    and arc_rrp.s>0 and arc_rrp.dk<2 and arc_rrp.kv=:KV " ||
  IifS( sFilter = "", "", " and "||sFilter)
.head 5 -  ! ----------------------
.head 5 -  ! 2 - ИСХодящие
.head 5 +  If TIP = 'N00' OR TIP = 'TNB'
OR TIP = 'L00' OR TIP = 'TUR' OR TIP = 'TUD'
.head 6 +  If TIP = 'N00' OR TIP = 'L00'
.head 7 -  Set sSql =  sSql || " UNION ALL "
.head 6 -  ! N) на НБУ файлы ССП
.head 6 +  If TIP = 'N00' OR TIP = 'TNB'
.head 7 -  Set sSql = sSql || " SELECT
decode(ARC_RRP.dk,1,ARC_RRP.s,0)/100, decode(ARC_RRP.dk,0,ARC_RRP.s,0)/100,
" || sSEL || "
ARC_RRP.nlsA, ARC_RRP.nam_A"
.head 6 -  ! L) на Дирекцию файлы ССП
.head 6 +  Else If TIP = 'L00' OR TIP = 'TUR' OR TIP = 'TUD'
.head 7 -  Set sSql = sSql || " SELECT
decode(ARC_RRP.dk,1,ARC_RRP.s,0)/100, decode(ARC_RRP.dk,0,ARC_RRP.s,0)/100,
" || sSEL || "
 decode(ARC_RRP.mfoa,:aMFO,ARC_RRP.nlsA, ARC_RRP.nlsB),
 decode(ARC_RRP.mfoa,:aMFO,ARC_RRP.nam_A,ARC_RRP.nam_B)"
.head 6 -  ! ---
.head 6 -  Set sSql = sSql || " FROM  arc_rrp
WHERE ARC_RRP.fn_B like :sLike and ARC_RRP.sos"||SOS_isx|| "
  and ARC_RRP.dat_B >=:DAT and ARC_RRP.dat_B <:DAT_Z
  and arc_rrp.s>0 and arc_rrp.dk<2 and arc_rrp.kv=:KV " ||
IifS (sFilter = "", "", " and "||sFilter)
.head 5 -  ! ---------------------
.head 5 -  ! Общее
.head 5 -  Set sSql =  sSql|| " INTO
:JN.SDE, :JN.SKR, :JN.ND, :JN.MFOA, :JN.MFOB, :JN.NAZN, :JN.SOS,
:JN.REC, :DIK,    :JN.DK, :JN.PRTY,
:JN.FN_A,:JN.FN_B,:JN.DAT_A, :JN.DAT_B, :JN.NLSN,:JN.NAMN
ORDER BY 1 desc,2 desc "
.head 5 -  ! -------------------
.head 4 +  Else
.head 5 -  Set sSql =  "
select distinct S1,S0,NLSA,NAMA,ND,MFOA,MFOB,NAZN,SOS,REC,REF,DATKA,DATKB,FN_A,FN_B,DK,PRTY 
from (SELECT decode(o.dk,1,arc_rrp.s,0)/100 S1, decode(o.dk,0,arc_rrp.s,0)/100 S0,
           decode(:aMFO,arc_rrp.mfoa,arc_rrp.nlsa, arc_rrp.mfob,arc_rrp.nlsb ,'') NLSA,
           decode(:aMFO,arc_rrp.mfoa,arc_rrp.nam_a,arc_rrp.mfob,arc_rrp.nam_b,'') NAMA,
	   arc_rrp.ND, arc_rrp.MFOA, arc_rrp.MFOB, arc_rrp.NAZN, arc_rrp.SOS, arc_rrp.REC, t.REF, 
           za.datk DATKA, zb.datk DATKB, arc_rrp.FN_A, arc_rrp.FN_B, arc_rrp.DK, arc_rrp.PRTY 
    FROM  opldok o, arc_rrp, t902 t, zag_a za, zag_b zb
    WHERE (arc_rrp.blk is null or arc_rrp.blk>=0)
	  and arc_rrp.fn_a  = za.fn(+)  and arc_rrp.fn_b  = zb.fn(+)
	  and arc_rrp.dat_a = za.dat(+) and arc_rrp.dat_b = zb.dat(+)
          and arc_rrp.ref=t.ref(+) and arc_rrp.s>0 and arc_rrp.dk<2 and o.fdat=:DAT
          and o.acc=" || Str(ACC) || " and " || S00 ||
IifS (sFilter = "", "", " and "||sFilter) || "
    UNION ALL
    SELECT decode (o.dk,1,arc_rrp.s,0)/100,decode(o.dk,0,arc_rrp.s,0)/100,
           decode(:aMFO,arc_rrp.mfoa,arc_rrp.nlsa, arc_rrp.mfob,arc_rrp.nlsb,''),
           decode(:aMFO,arc_rrp.mfoa,arc_rrp.nam_a,arc_rrp.mfob,arc_rrp.nam_b,''),
	   arc_rrp.nd,arc_rrp.mfoa,
           arc_rrp.mfob,arc_rrp.nazn,arc_rrp.sos,arc_rrp.rec,t.ref,za.datk,zb.datk,arc_rrp.fn_a,arc_rrp.fn_b,
           arc_rrp.dk,arc_rrp.prty
    FROM  opldok o, arc_rrp, t902 t, zag_a za, zag_b zb
    WHERE (arc_rrp.blk is null or arc_rrp.blk>=0)
	  and arc_rrp.fn_a  = za.fn(+)  and arc_rrp.fn_b  = zb.fn(+)
	  and arc_rrp.dat_a = za.dat(+) and arc_rrp.dat_b = zb.dat(+)
          and arc_rrp.ref=t.ref(+)  and arc_rrp.s>0 and arc_rrp.dk<2  and o.fdat=:DAT
          and o.acc=" || Str(ACC) || " and " || S01 ||
IifS (sFilter = "", "", " and "||sFilter) || " ) 
    ORDER BY 1 desc,2 desc
    INTO :JN.SDE,:JN.SKR,:JN.NLSN,:JN.NAMN,:JN.ND,:JN.MFOA,:JN.MFOB,:JN.NAZN,:JN.SOS,:JN.REC,:JN.DIK,:JN.TIMA,
         :JN.TIMB,:JN.FN_A,:JN.FN_B,:JN.DK,:JN.PRTY "
.head 4 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 4 -  ! ! Всього
.head 4 -  Set iKol = 0 
.head 4 -  Set iSKR = 0
.head 4 -  Set iSDE = 0
.head 4 -  Call SalTblPopulate(hWndForm, hSql(), sSql , TBL_FillAll)
.head 4 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 4 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, FALSE)
.head 4 -  Call SalTblSetContext(hWndForm, nRow)
.head 4 -  Set NAMN = 'Разом : ' || Str(iKol)
.head 4 -  Set SKR = iSKR 
.head 4 -  Set SDE = iSDE 
.head 4 -  !
.head 4 -  Call SalTblSetContext(hWndForm, 0)
.head 4 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If cb_Kw = 1 and TIP = 'N00' OR TIP = 'L00'
.head 5 +  If FN_A != STRING_Null
.head 6 -  If SqlPrepareAndExecute( hSqlAux2(),
"SELECT datk INTO :TIMA FROM zag_A WHERE fn=:FN_A and dat=:DAT_A")
and SqlFetchNext( hSqlAux2(), nFetchRes )
.head 5 +  If FN_B != STRING_Null
.head 6 -  If SqlPrepareAndExecute( hSqlAux2(),
"SELECT datk INTO :TIMB FROM zag_B WHERE fn=:FN_B and dat=:DAT_B")
and SqlFetchNext( hSqlAux2(), nFetchRes )
.head 4 -  !
.head 4 +  If DK=0
.head 5 -  Call SalTblSetCellTextColor( SDE,  COLOR_Red, FALSE )
.head 5 -  Call SalTblSetCellTextColor( SKR,  COLOR_Red, FALSE )
.head 4 -  !
.head 4 -  Set iKol = iKol + 1
.head 4 -  Set iSKR = iSKR + SKR 
.head 4 -  Set iSDE = iSDE + SDE
.head 4 -  !
.head 4 +  If SOS < 5
.head 5 -  ! Call SalTblSetCellTextColor( SDE,  COLOR_DarkBlue, FALSE )
.head 5 -  ! Call SalTblSetCellTextColor( SKR,  COLOR_DarkBlue, FALSE )
.head 5 -  Call SalTblSetCellTextColor( NLSN, COLOR_DarkBlue, FALSE )
.head 5 -  Call SalTblSetCellTextColor( NAMN, COLOR_DarkBlue, FALSE )
.head 5 -  Call SalTblSetCellTextColor( ND,   COLOR_DarkBlue, FALSE )
.head 5 -  Call SalTblSetCellTextColor( MFOA, COLOR_DarkBlue, FALSE )
.head 5 -  Call SalTblSetCellTextColor( MFOB, COLOR_DarkBlue, FALSE )
.head 5 -  Call SalTblSetCellTextColor( NAZN, COLOR_DarkBlue, FALSE )
.head 5 -  Call SalTblSetCellTextColor( TIMA, COLOR_DarkBlue, FALSE )
.head 5 -  Call SalTblSetCellTextColor( TIMB, COLOR_DarkBlue, FALSE )
.head 4 +  If Subs(FN_A,2,1)='B' or Subs(FN_B,2,1)='A' or Subs(FN_A,2,1)='V' or Subs(FN_A,2,1)='C'
.head 5 -  Set JM='Ж'
.head 4 -  ! Else
.head 3 +  On SAM_DoubleClick
.head 4 -  Call DocViewContents(hWndForm,JN.REC)
.head 1 +  Form Window: frmPolKB
.data CLASSPROPSSIZE
0000: 3C00
.enddata
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 0000000000009DB9 C800CEDCE3005580
0020: 9700020000000000 0000010000000100 0000010000000001 00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 2 -  Class: cSplitterWindow
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Передача и возврат полномочий пользователей по КЛИЕНТ-БАНК
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.575"
.head 4 -  Top:    0.219"
.head 4 -  Width:  11.467"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.464"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description: полномочия пользователей по КЛИЕНТ-БАНК
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.429"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbCheckIn
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.05"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Arr1tor.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Передача полномочий'
.head 6 +  On SAM_Click
.head 7 -  !
.head 7 -  ! при передаче
1) анализировать не переданы ли УЖЕ пользователя OTW (if mrk=1 or mrk=0 where otw=in) - неважно кому
при возврате
1) анализировать переданы ли полномочия пользователя OTW пользователю TOW (if tow=откого and otwo=кому and mrk=1)
в JOBе
1) если dti<=sysdate, to передать полномочия и присвоить mrk=1, dti=null
2) если dto<=sysdate, то возвратить полномочия и удалить запись
.head 7 -  !
.head 7 +  If SalTblAnyRows(tbl2, ROW_Selected, 0) and SalTblAnyRows(tbl1, ROW_Selected, 0) and tbl1.id != tbl2.id
.head 8 +  If SqlPrepareAndExecute(hSql(), "
   SELECT tow
   INTO   :nTOW
   FROM   klp_plpo
   WHERE  otw=:tbl1.id")
.head 9 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Set nTOW = -3711
.head 8 +  If nTOW = -3711
.head 9 -  Call VisMessageSetBkgdColor(COLOR_Salmon)
.head 9 -  Set hBtns[0] = hBtnYes | MBF_DefButton
.head 9 -  Set hBtns[1] = hBtnNo
.head 9 +  ! If VisMessageBox('ПЕРЕДАТЬ полномочия по обработке' || ' документов КЛИЕНТ-БАНК
   исполнителя ' || Str(tbl1.id) || ' (' || tbl1.name || ')
   исполнителю ' || Str(tbl2.id) || ' (' || tbl2.name || ') ?', 'ЗАПРОС', MBF_IconQuestion, hBtns, 2) = ID_Yes
.head 10 -  Call SalWaitCursor(TRUE)
.head 10 -  ! запросить даты
.head 10 -  ! затем INSERT otw tow dti dto mrk INTO klp_plpo
.head 10 -  ! !            1id 2id dI  dO  0
.head 10 +  ! If SqlPLSQLCommand(hSql(), "PKBup(tbl1.id,tbl2.id)")
.head 11 -  Call SqlCommit(hSql())
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Call MessageNoWait('ПЕРЕДАНЫ полномочия по ' ||
     'обработке документов КЛИЕНТ-БАНК
     исполнителя ' || Str(tbl1.id) || ' (' ||
     tbl1.name || ')
     исполнителю ' || Str(tbl2.id) || ' (' ||
     tbl2.name || ')', 'СООБЩЕНИЕ', 17, 0)
.head 10 +  ! Else
.head 11 -  Call SqlRollback(hSql())
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Call MessageNoWait('Ошибка при передаче полномочий.', 'ВНИМАНИЕ', 17, 1)
.head 9 +  If SalModalDialog(dlgPolKB, hWndForm, Str(tbl1.id) || ' (' || tbl1.name || ')', Str(tbl2.id) || ' (' ||
   tbl2.name || ') ?') = 0
.head 10 -  ! запросить даты
.head 10 -  ! затем INSERT otw tow dti dto mrk INTO klp_plpo
.head 10 -  ! !            1id 2id dI  dO  0
.head 10 +  ! If SqlPLSQLCommand(hSql(), "PKBup(tbl1.id,tbl2.id)")
.head 11 -  Call SqlCommit(hSql())
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Call MessageNoWait('ПЕРЕДАНЫ полномочия по ' ||
     'обработке документов КЛИЕНТ-БАНК
     исполнителя ' || Str(tbl1.id) || ' (' ||
     tbl1.name || ')
     исполнителю ' || Str(tbl2.id) || ' (' ||
     tbl2.name || ')', 'СООБЩЕНИЕ', 17, 0)
.head 10 +  ! Else
.head 11 -  Call SqlRollback(hSql())
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Call MessageNoWait('Ошибка при передаче полномочий.', 'ВНИМАНИЕ', 17, 1)
.head 10 +  If dOt = DATETIME_Null
.head 11 -  Set dOt = SalDateCurrent()
.head 10 +  If SqlPrepareAndExecute(hSql(), '
   INSERT
   INTO klp_plpo (otw,tow,dti,dto,mrk)
   VALUES (:tbl1.id,:tbl2.id,:dOt,:dDo,0)')
.head 11 -  Call SqlCommit(hSql())
.head 11 -  Call MessageNoWait('Будут ПЕРЕДАНЫ полномочия по обработке документов КЛИЕНТ-БАНК
     исполнителя ' || Str(tbl1.id) || ' (' || tbl1.name || ')
     исполнителю ' || Str(tbl2.id) || ' (' || tbl2.name || ')', 'СООБЩЕНИЕ', 17, 0)
.head 10 +  Else
.head 11 -  Set hBtns[0] = hBtnOk | MBF_DefButton
.head 11 -  Call VisMessageBox('Ошибка при передаче полномочий исполнителя ' || Str(tbl1.id) || ' (' || tbl1.name ||
     ') исполнителю ' || Str(nTOW) || ' (' || sTOW || ')', 'ВНИМАНИЕ', MBF_IconHand, hBtns, 1)
.head 8 +  Else
.head 9 -  Call VisMessageSetBkgdColor(COLOR_Marigold)
.head 9 -  Set hBtns[0] = hBtnOk | MBF_DefButton
.head 9 -  Set sTOW = GetValueStr("
    SELECT fio
    FROM   staff
    WHERE  id=" || Str(nTOW))
.head 9 -  Call VisMessageBox('Полномочия исполнителя ' || Str(tbl1.id) || ' (' || tbl1.name ||
     ') уже переданы исполнителю ' || Str(nTOW) || ' (' || sTOW || ')', 'ВНИМАНИЕ', MBF_IconHand, hBtns, 1)
.head 7 +  Else
.head 8 -  Set hBtns[0] = hBtnOk | MBF_DefButton
.head 8 -  Call VisMessageBox(
     'НЕ выбраны пользователи для передачи полномочий или попытка передать полномочия САМОМУ СЕБЕ.', 'ВНИМАНИЕ',
     MBF_IconHand, hBtns, 1)
.head 4 +  Pushbutton: pbCheckOut
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.783"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Arr1tol.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Возврат полномочий'
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows(tbl1, ROW_Selected, 0) and SalTblAnyRows(tbl2, ROW_Selected, 0) and tbl1.id != tbl2.id
.head 8 +  If SqlPrepareAndExecute(hSql(), '
   SELECT tow
   INTO   :nTOW
   FROM   klp_plpo
   WHERE  otw=:tbl1.id and mrk=1') and SqlFetchNext(hSql(), nFetchRes)
.head 9 +  If nTOW = tbl2.id
.head 10 -  Call VisMessageSetBkgdColor(COLOR_Maize)
.head 10 -  Set hBtns[0] = hBtnYes | MBF_DefButton
.head 10 -  Set hBtns[1] = hBtnNo
.head 10 +  If VisMessageBox('ВОЗВРАТИТЬ полномочия по обработке документов КЛИЕНТ-БАНК
   исполнителю ' || Str(tbl1.id) || ' (' || tbl1.name || ')
от исполнителя ' || Str(tbl2.id) || ' (' || tbl2.name || ') ?', 'ЗАПРОС', MBF_IconQuestion, hBtns, 2) =
   ID_Yes
.head 11 -  Call SalWaitCursor(TRUE)
.head 11 +  If SqlPLSQLCommand(hSql(), "PKBdn(tbl2.id,tbl1.id)")
.head 12 +  If SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM   klp_plpo
   WHERE  otw=:tbl1.id and tow=:tbl2.id and mrk=1')
.head 13 -  Call SqlCommit(hSql())
.head 13 -  Call SalWaitCursor(FALSE)
.head 13 -  Call MessageNoWait('ВОЗВРАЩЕНЫ полномочия по обработке документов КЛИЕНТ-БАНК
     исполнителю ' || Str(tbl1.id) || ' (' || tbl1.name || ')
  от исполнителя ' || Str(tbl2.id) || ' (' || tbl2.name || ')', 'СООБЩЕНИЕ', 17, 0)
.head 12 +  Else
.head 13 -  Call SqlRollback(hSql())
.head 13 -  Call SalWaitCursor(FALSE)
.head 13 -  Call MessageNoWait('Ошибка при возврате полномочий.', 'ВНИМАНИЕ', 17, 1)
.head 11 +  Else
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  Call MessageNoWait('Ошибка при возврате полномочий.', 'ВНИМАНИЕ', 17, 1)
.head 9 +  Else
.head 10 -  Set sTOW = GetValueStr("
    SELECT fio
    FROM   staff
    WHERE  id=" || Str(nTOW))
.head 10 -  Set hBtns[0] = hBtnOk | MBF_DefButton
.head 10 -  Call VisMessageBox('Полномочия исполнителя ' || Str(tbl1.id) || ' (' || tbl1.name ||
     ') были переданы исполнителю ' || Str(nTOW) || ' (' || sTOW || ')', 'ВНИМАНИЕ', MBF_IconHand, hBtns, 1)
.head 8 +  Else
.head 9 -  Set hBtns[0] = hBtnOk | MBF_DefButton
.head 9 -  Call VisMessageBox('Полномочия исполнителя ' || Str(tbl1.id) || ' (' || tbl1.name ||
     ') не были переданы исполнителю ' || Str(tbl2.id) || ' (' || tbl2.name || ')', 'ВНИМАНИЕ', MBF_IconHand,
     hBtns, 1)
.head 7 +  Else
.head 8 -  Call VisMessageSetBkgdColor(COLOR_Marigold)
.head 8 -  Set hBtns[0] = hBtnOk | MBF_DefButton
.head 8 -  Call VisMessageBox(
     'НЕ выбраны пользователи для возврата полномочий или попытка возвратить полномочия САМОМУ СЕБЕ.',
     'ВНИМАНИЕ', MBF_IconHand, hBtns, 1)
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Фильтр...'
.head 6 +  On SAM_Click
.head 7 +  If SetQueryFilter(cF)
.head 8 -  Set sf = cF.GetFilterWhereClause(FALSE)
.head 8 -  Call SalSendMsg(tbl1, UM_Populate, 0, 0)
.head 8 -  Call SalSendMsg(tbl2, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.533"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Перечитать'
.head 6 +  On SAM_Click
.head 7 -  Set sf = ''
.head 7 -  Call SalSendMsg(tbl1, UM_Populate, 0, 0)
.head 7 -  Call SalSendMsg(tbl2, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.933"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Закончить работу функции'
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 2 +  Contents
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  5.567"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.655"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 4096
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: id
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: login
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рабочее
имя
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: name
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Пользователь
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: InitStmt
.head 6 -  Description: Инициализация кода выписки эл.клиента
.head 6 -  Returns
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Set nSTMTValue = GetGlobalOptionEx('EPSTMT')
.head 7 +  If nSTMTValue = 0
.head 8 -  Set nSTMTValue = 5 ! тип выписки 'Электронный клиент'
.head 4 +  Window Variables
.head 5 -  Number: nOrderBy1
.head 5 -  Window Handle: hColumn1
.head 5 -  Number: nSTMTValue
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_SelectableCols, TRUE)
.head 6 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_SingleSelection, TRUE)
.head 6 -  Call SalSendMsg(hWndItem, UM_Populate, 0, 0)
.head 5 +  On UM_Populate
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  ! Инициализация переменной nSTMTValue - тип выписки эл. клиента
.head 6 -  Call InitStmt()
.head 6 -  !
.head 6 -  ! Call SalTblPopulate(tbl1, ListIn.hSql(), "
     SELECT DISTINCT s.id,s.logname,s.fio
     INTO :tbl1.id,:tbl1.login,:tbl1.name
     FROM staff s, customer c, accounts a, cust_acc u
     WHERE c.sab is not null and (c.stmt=:nSTMTValue or c.stmt=5) and c.rnk=u.rnk and
           u.acc=a.acc and a.acc in (select acc from acci) and a.isp=s.id and
           a.kv=980
     ORDER BY 1",
     TBL_FillAll)
.head 6 -  ! + валютные счета (убрано - and a.kv=980)
.head 6 -  Call SalTblPopulate(tbl1, ListIn.hSql(), "
     SELECT DISTINCT id,logname,fio
     INTO   :tbl1.id,:tbl1.login,:tbl1.name
     FROM   (SELECT s.id,s.logname,s.fio
             FROM   staff s, customer c, accounts a
             WHERE  (c.sab is not null and (c.stmt=6 or c.stmt=5) and c.rnk=a.rnk and
                     a.acc in (SELECT acc
                               FROM   acci
                               WHERE nvl(pers,0)=1 or nvl(high,0)=1) and a.isp=s.id)
             union all
             select s.id,s.logname,s.fio
             FROM   staff s, klp_plpo k
             where  s.id=k.tow and k.dti<sysdate and (k.dto>sysdate or k.dto is null) and k.mrk=1)
     ORDER BY 1", TBL_FillAll)
.head 6 -  ! Call SalTblPopulate(tbl1, ListIn.hSql(), "
     SELECT DISTINCT s.id,s.logname,s.fio
     INTO :tbl1.id,:tbl1.login,:tbl1.name
     FROM staff s, customer c, accounts a, cust_acc u
     WHERE c.sab is not null and (c.stmt=:nSTMTValue or c.stmt=5) and c.rnk=u.rnk and
           u.acc=a.acc and a.acc in (select acc from acci) and a.isp=s.id
     ORDER BY 1",
     TBL_FillAll)
.head 6 -  Call SalTblSetLockedColumns(tbl1, 2)
.head 6 -  ! Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set hColumn1 = SalNumberToWindowHandle(wParam)
.head 6 -  Set nOrderBy1 = not nOrderBy1
.head 6 -  Call SalTblSortRows(tbl1, SalTblQueryColumnID(hColumn1), nOrderBy1)
.head 6 -  Call SalTblSetColumnFlags(hColumn1, COL_Selected, FALSE)
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 +  Custom Control: ccSplitter
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cSplitterWindow
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.567"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tbl2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.667"
.head 6 -  Top:    0.0"
.head 6 -  Width:  5.667"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.655"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 4096
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: id
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: login
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рабочее
имя
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: name
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Пользователь
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nOrderBy2
.head 5 -  Window Handle: hColumn2
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags(tbl2, TBL_Flag_SelectableCols, TRUE)
.head 6 -  Call SalTblSetTableFlags(tbl2, TBL_Flag_SingleSelection, TRUE)
.head 6 -  Call SalSendMsg(hWndItem, UM_Populate, 0, 0)
.head 5 +  On UM_Populate
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  ! Call SalTblPopulate(tbl2, ListOut.hSql(), "
     SELECT DISTINCT s.id,s.logname,s.fio
     INTO :tbl2.id,:tbl2.login,:tbl2.name
     FROM staff s, accounts a
     WHERE a.isp=s.id and a.kv=980
     ORDER BY 1", TBL_FillAll)
.head 6 -  Call SalTblPopulate(tbl2, ListOut.hSql(), "
     SELECT DISTINCT s.id,s.logname,s.fio
     INTO   :tbl2.id,:tbl2.login,:tbl2.name
     FROM   staff s
     ORDER BY 1", TBL_FillAll)
.head 6 -  Call SalTblSetLockedColumns(tbl2, 2)
.head 6 -  ! Call VisTblAutoSizeColumn(tbl2, hWndNULL)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set hColumn2 = SalNumberToWindowHandle(wParam)
.head 6 -  Set nOrderBy2 = not nOrderBy2
.head 6 -  Call SalTblSortRows(tbl2, SalTblQueryColumnID(hColumn2), nOrderBy2)
.head 6 -  Call SalTblSetColumnFlags(hColumn2, COL_Selected, FALSE)
.head 6 -  Call SalWaitCursor(FALSE)
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  : ListIn
.head 4 -  Class: cABSConnect
.head 3 -  : ListOut
.head 4 -  Class: cABSConnect
.head 3 -  : cF
.head 4 -  Class: cGenFilter
.head 3 -  !
.head 3 -  String: strQuery
.head 3 -  String: sf
.head 3 -  String: strWinTitle
.head 3 -  String: strCurUser
.head 3 -  !
.head 3 -  Number: nX
.head 3 -  Number: nY
.head 3 -  !
.head 3 -  Number: hBtnOk
.head 3 -  Number: hBtnYes
.head 3 -  Number: hBtnNo
.head 3 -  Number: hBtns[*]
.head 3 -  !
.head 3 -  Number: nTOW
.head 3 -  String: sTOW
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  ! Call SetWindowFullSize(hWndForm)
.head 4 -  Call XConnectGetParams(ListIn)
.head 4 +  If not ListIn.Connect()
.head 5 -  Call SalDestroyWindow(hWndItem)
.head 4 -  Call ListOut.Clone(ListIn, TRUE)
.head 4 +  If SqlPrepareAndExecute(ListIn.hSql(), T('
   SELECT fio
   FROM   staff
   INTO   :strCurUser
   WHERE  logname=user'))
.head 5 -  Call SqlFetchNext(ListIn.hSql(), nFetchRes)
.head 4 -  ! Call SalGetWindowText(hWndForm, strWinTitle, 254)
.head 4 -  ! Call SalSetWindowText(hWndForm, strWinTitle || ': ' ||
     strCurUser)
.head 4 -  Call cF.Init('Staff', 'a')
.head 4 -  Call XSalTooltipSetUserDefault()
.head 3 +  On SAM_CreateComplete
.head 4 -  ! Call SalSendClassMessage(SAM_CreateComplete, wParam, lParam)
.head 4 -  Set hBtnYes = VisMessageLoadButton('&Да', ID_Yes)
.head 4 -  Set hBtnNo = VisMessageLoadButton('&Нет', ID_No)
.head 4 -  Set hBtnOk = VisMessageLoadButton('&Не буду так делать', ID_Ok)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On VTM_Size
.head 4 -  Call SalGetWindowSize(hWndForm, nX, nY)
.head 4 -  Call SalSetWindowLoc(ccSplitter, nX/2, 0)
.head 4 -  Call SalSendClassMessage(VTM_Size, wParam, lParam)
.head 3 +  On SAM_Destroy
.head 4 -  Call ListIn.Disconnect()
.head 4 -  Call ListOut.Disconnect()
.head 1 -  ! Доввод доп. реквизитов
.head 1 +  Table Window: frm_AuxReenter
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Доввод дополнительных реквизитов документов
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  14.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.31"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 30000
.head 3 -  Discardable? Class Default
.head 2 -  Description: Форма доввода доп. реквизитов
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.383"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 32443
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.917"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Enter
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.35"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 32444
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 32445
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbDoc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.7"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Doc.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Просмотреть документ'
.head 6 +  On SAM_Click
.head 7 +  If colRef
.head 8 -  Call DocViewContentsEx(hWndForm, colRef)
.head 4 -  Line
.head 5 -  Resource Id: 32446
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  5.267"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  5.267"
.head 6 -  End Y:  0.464"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 2 +  Contents
.head 3 +  Column: colRef
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Референс
документа
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
ОП
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colUserId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: User
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.717"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNlsA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет - А
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.717"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сума
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.25"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colLcvA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал
юта
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.617"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colVDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
валютирования
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: dd/MM/yyyy
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма в
валюте - Б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colLcvB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал
Б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colMfoB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО - Б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.95"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNlsB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет - Б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дб
Кр
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.517"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: СКП
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
документа
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.117"
.head 4 -  Width Editable? Yes
.head 4 -  Format: dd/MM/yyyy
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDig1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
документа
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDig2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
документа
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  ! Доп. условие для списка документов
.head 3 -  String: sDocCondition
.head 3 -  ! Доп. условие для списка реквизитов
.head 3 -  String: sAttrCondition
.head 2 +  Window Variables
.head 3 -  : cAux
.head 4 -  Class: cABSConnect
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set hWndForm.frm_AuxReenter.nFlags = GT_ReadOnly
.head 4 -  Set hWndForm.frm_AuxReenter.strFilterTblName = 'OPER'
.head 4 -  Set hWndForm.frm_AuxReenter.fFilterAtStart = TRUE
.head 4 -  Set hWndForm.frm_AuxReenter.strSqlPopulate =
"SELECT oper.ref, oper.tt, oper.userid, oper.nlsa, oper.s, v1.lcv,
        oper.vdat, oper.s2, v2.lcv,oper.mfob, oper.nlsb, oper.dk,
        oper.sk, oper.datd, v1.dig, v2.dig
   INTO :hWndForm.frm_AuxReenter.colRef,   :hWndForm.frm_AuxReenter.colTt,
        :hWndForm.frm_AuxReenter.colUserId,:hWndForm.frm_AuxReenter.colNlsA,
        :hWndForm.frm_AuxReenter.colS1,    :hWndForm.frm_AuxReenter.colLcvA,
        :hWndForm.frm_AuxReenter.colVDate, :hWndForm.frm_AuxReenter.colS2,
        :hWndForm.frm_AuxReenter.colLcvB,  :hWndForm.frm_AuxReenter.colMfoB,
        :hWndForm.frm_AuxReenter.colNlsB,  :hWndForm.frm_AuxReenter.colDk,
        :hWndForm.frm_AuxReenter.colSk,    :hWndForm.frm_AuxReenter.colDDate,
        :hWndForm.frm_AuxReenter.colDig1,  :hWndForm.frm_AuxReenter.colDig2
   FROM oper, tabval v1, tabval v2
  WHERE oper.kv=v1.kv AND oper.kv2=v2.kv " ||
        IifS(sDocCondition=STRING_Null, "", " AND " || sDocCondition) ||
" ORDER BY oper.ref desc"
.head 4 -  !
.head 4 -  Call XConnectGetParams(cAux)
.head 4 +  If NOT cAux.Connect()
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 4 -  Call SalSendClassMessage( UM_Create, 0, 0 )
.head 3 +  On UM_DoubleClick
.head 4 -  Call Sel000(hWndMDI, 111, colRef, sAttrCondition, '')
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set colS1 = colS1/SalNumberPower(10, colDig1)
.head 4 -  Set colS2 = colS2/SalNumberPower(10, colDig2)
.head 1 +  Table Window: frm_AuxEnter
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Ввод дополнительных реквизитов
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? No
.head 3 -  Minimizable? No
.head 3 -  System Menu? Yes
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  10.85"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.381"
.head 4 -  Height Editable? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  View: Table
.head 3 -  Allow Row Sizing? No
.head 3 -  Lines Per Row: Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Default
.head 3 -  Discardable? No
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.56"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cpbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Сохранить
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Enter
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If CheckValue()
.head 8 -  Call SalSendMsg(hWndForm, UM_Update, 0, 0)
.head 8 -  Call SalDestroyWindow(hWndForm)
.head 4 +  Pushbutton: pbCancel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cpbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.383"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 2 +  Contents
.head 3 +  Column: colTAG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.967"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование доп. реквизита
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  5.567"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colVALUE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Значение
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 200
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  4.4"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  ! Лезем в справочник
.head 6 +  If colSELECT
.head 7 -  Set strExpression = ChangeSELECT(colSELECT)
.head 7 -  Set nType = SalCompileAndEvaluate(strExpression,
    nError, nPos, nTmp, sTmp, dTmp, hTmp, TRUE, SalContextCurrent())
.head 7 +  If nError = 0
.head 8 +  If nType = EVAL_Number
.head 9 -  Set sTmp = SalNumberToStrX(nTmp, 0)
.head 8 +  Else If nType = EVAL_String
.head 9 -  ! Set dfValue = sBrowserRet
.head 8 +  Else If nType = EVAL_Date
.head 9 -  Call SalDateToStr(dTmp, sTmp)
.head 8 -  ! Если редактировалось
.head 8 +  If sTmp
.head 9 -  Set colVALUE = sTmp
.head 9 -  Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited , TRUE)
.head 7 +  Else
.head 8 -  Call SalMessageBox('Невозможно вызвать ' || strExpression, 'Информация', MB_IconInformation)
.head 8 -  Return FALSE
.head 5 +  On VTM_KeyDown
.head 6 +  If wParam = VK_F6
.head 7 -  Call SalTblQueryFocus(hWndForm, nCurRow, hCurCol)
.head 7 -  Set lsTmp = colVALUE
.head 7 -  Set lsTmp = ShowMemoEditor('Редактирование реквизита', TRUE, SalGetMaxDataLength(hCurCol), lsTmp)
.head 7 +  If colVALUE != lsTmp
.head 8 -  Set colVALUE = lsTmp
.head 8 -  Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE)
.head 3 +  Column: colSELECT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 250
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCheckFunction
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 250
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNlsA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colMfoA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNlsB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colMfoB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKv2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNazn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 160
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: CheckValue
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRow
.head 5 -  Number: nRet
.head 5 -  String: sS
.head 5 -  String: S
.head 5 -  String: S2
.head 5 -  String: KvA
.head 5 -  String: KvB
.head 4 +  Actions
.head 5 +  If not bCheckValue
.head 6 -  Return TRUE
.head 5 -  Set S   = SalNumberToStrX(colS, 0)   ! Сумма платежа
.head 5 -  Set S2  = SalNumberToStrX(colS2, 0)  ! Сумма платежа
.head 5 -  Set KvA = SalNumberToStrX(colKv, 0)  ! Код валюты А
.head 5 -  Set KvB = SalNumberToStrX(colKv2, 0) ! Код валюты B
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 +  If colCheckFunction
.head 7 -  Set sS = SalStrUpperX(' ' || colCheckFunction)
.head 7 +  While SalStrScan(sS,'#(TAG)') > 0
.head 8 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(TAG)'),6,"'"|| colTAG ||"'")
.head 7 +  While SalStrScan(sS,'#(VAL)') > 0
.head 8 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(VAL)'),6,"'"|| colVALUE ||"'")
.head 7 +  While SalStrScan(sS,'#(S)') > 0
.head 8 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(S)'),4,S)
.head 7 +  While SalStrScan(sS,'#(S2)') > 0
.head 8 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(S2)'),5,S2)
.head 7 +  While SalStrScan(sS,'#(NLSA)') > 0
.head 8 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(NLSA)'),7,colNlsA)
.head 7 +  While SalStrScan(sS,'#(NLSB)') > 0
.head 8 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(NLSB)'),7,colNlsB)
.head 7 +  While SalStrScan(sS,'#(MFOA)') > 0
.head 8 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(MFOA)'),7,colMfoA)
.head 7 +  While SalStrScan(sS,'#(MFOB)') > 0
.head 8 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(MFOB)'),7,colMfoB)
.head 7 +  While SalStrScan(sS,'#(KVA)') > 0
.head 8 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(KVA)'),6,KvA)
.head 7 +  While SalStrScan(sS,'#(KVB)') > 0
.head 8 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(KVB)'),6,KvB)
.head 7 +  While SalStrScan(sS,'#(TT)') > 0
.head 8 -  Set sS = SalStrReplaceX(sS,SalStrScan(sS,'#(TT)'),5,"'"|| colTT ||"'")
.head 7 +  If not SqlPrepareAndExecute(hSql(), "SELECT " || sS || " INTO :nRet FROM dual")
or not SqlFetchNext(hSql(),nFetchRes)
or nRet = 0
.head 8 -  Call SalMessageBox('Недопустимое значение <<' || colNAME || '>>', 'Ошибка!', MB_IconExclamation)
.head 8 -  Call SalSetFocus(hWndForm)
.head 8 -  Call SalTblSetFocusRow(hWndForm, nRow)
.head 8 -  Call SalTblSetFocusCell(hWndForm, nRow, colVALUE, 0, 0)
.head 8 -  Return FALSE
.head 5 -  Return TRUE
.head 3 +  Function: ChangeTblFlags
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRow
.head 5 -  Number: nCount
.head 4 +  Actions
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 +  If SqlPrepareAndExecute(hSql(), "SELECT COUNT(*) INTO :nCount FROM operw WHERE ref=:nRef AND tag=:colTAG")
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 -  ! Не существует и есть значение
.head 6 +  If nCount = 0 AND colVALUE
.head 7 -  ! Удаляем редактирование
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, FALSE)
.head 7 -  ! Добавляем вставку
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_New, TRUE)
.head 6 -  ! Не существует и нет значения
.head 6 +  Else If nCount = 0 AND NOT colVALUE
.head 7 -  ! Удаляем редактирование
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, FALSE)
.head 6 -  ! Существует и нет значения
.head 6 +  Else If nCount > 0 and not colVALUE
.head 7 -  ! Удаляем редактирование
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_Edited, FALSE)
.head 7 -  ! Добавляем удаление
.head 7 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_MarkDeleted, TRUE)
.head 5 -  Return TRUE
.head 3 +  Function: ChangeSELECT
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sPar
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sSelect
.head 4 +  Actions
.head 5 -  Set sSelect = sPar
.head 5 +  While SalStrScan(sSelect,'dfNlsA') > 0
.head 6 -  Set sSelect = SalStrReplaceX(sSelect,SalStrScan(sSelect,'dfNlsA'),6,'colNlsA')
.head 5 +  While SalStrScan(sSelect,'dfNlsB') > 0
.head 6 -  Set sSelect = SalStrReplaceX(sSelect,SalStrScan(sSelect,'dfNlsB'),6,'colNlsB')
.head 5 +  While SalStrScan(sSelect,'dfNazn') > 0
.head 6 -  Set sSelect = SalStrReplaceX(sSelect,SalStrScan(sSelect,'dfNazn'),6,'colNazn')
.head 5 -  Return sSelect
.head 2 +  Window Parameters
.head 3 -  Number: nRef
.head 3 -  String: sAddCondition
.head 2 +  Window Variables
.head 3 -  Boolean: bCheckValue
.head 3 -  String: strExpression
.head 3 -  Number: nType
.head 3 -  Number: nError
.head 3 -  Number: nPos
.head 3 -  Number: nTmp
.head 3 -  String: sTmp
.head 3 -  Window Handle: hTmp
.head 3 -  Date/Time: dTmp
.head 3 -  Boolean: fModResult
.head 3 -  !
.head 3 -  Window Handle: hCurCol
.head 3 -  Number: nCurRow
.head 3 -  String: lsTmp
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowText(hWndForm, 'Ввод дополнительных реквизитов по документу реф. ' || SalNumberToStrX(nRef, 0))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set bCheckValue = FALSE
.head 4 -  Call SalTblPopulate(hWndForm, hSql(),
"select tag, name,
   (select nvl(value,'') from operw where ref = t.ref and tag = t.tag) as value,  
   browser, chkr, t.tt, t.nlsa, t.mfoa, t.kv, t.s, t.nlsb,t.mfob, t.kv2, t.s2, t.nazn
   INTO :hWndForm.frm_AuxEnter.colTAG,   :hWndForm.frm_AuxEnter.colNAME,
        :hWndForm.frm_AuxEnter.colVALUE, :hWndForm.frm_AuxEnter.colSELECT,
        :hWndForm.frm_AuxEnter.colCheckFunction, :hWndForm.frm_AuxEnter.colTT,
        :hWndForm.frm_AuxEnter.colNlsA, :hWndForm.frm_AuxEnter.colMfoA,
        :hWndForm.frm_AuxEnter.colKv,   :hWndForm.frm_AuxEnter.colS,
        :hWndForm.frm_AuxEnter.colNlsB, :hWndForm.frm_AuxEnter.colMfoB,
        :hWndForm.frm_AuxEnter.colKv2,  :hWndForm.frm_AuxEnter.colS2, :hWndForm.frm_AuxEnter.colNazn
   from( select o.ref, r.tag, f.name, f.browser, trim(f.chkr) chkr,  o.tt, o.nlsa, o.mfoa, o.kv, o.s, o.nlsb, o.mfob, o.kv2, o.s2, o.nazn
                               from oper o, op_rules r, op_field f
                              where o.ref = :nRef  
                                and r.tt = o.tt
                                and r.tag = f.tag
                                and nvl(f.nomodify,0)=0               
                              union 
                             select w.ref, w.tag, f.name, f.browser, trim(f.chkr) chkr,  o.tt, o.nlsa, o.mfoa, o.kv, o.s, o.nlsb, o.mfob, o.kv2, o.s2, o.nazn
                               from operw w, op_field f, oper o
                              where w.ref = :nRef  
                                and o.ref = w.ref
                                and w.tag = f.tag
                                and nvl(f.nomodify,0)=0 " || IifS(sAddCondition=STRING_Null, "", " AND " || sAddCondition) ||
" )t ", TBL_FillAll)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If colCheckFunction
.head 5 -  Set bCheckValue = TRUE
.head 4 +  If colSELECT
.head 5 -  Call XSalTblSetCellBackColor(colVALUE, SalColorFromRGB(230, 255, 255))
.head 3 +  On UM_Update
.head 4 -  ! Меняем флаги
.head 4 -  Call ChangeTblFlags()
.head 4 -  ! Сохраняем доп. реквизиты
.head 4 -  Set fModResult = TRUE
.head 4 +  If fModResult
.head 5 -  Call SqlPrepare(hSql(),
"DELETE FROM OPERW
  WHERE ref=:nRef and tag=:colTAG")
.head 5 -  Set fModResult = SalTblDoDeletes(hWndForm, hSql(), ROW_MarkDeleted)
.head 4 +  If fModResult
.head 5 -  Call SqlPrepare(hSql(),
"INSERT INTO OPERW (ref, tag, value)
 VALUES (:nRef, :colTAG, :colVALUE)")
.head 5 -  Set fModResult = SalTblDoInserts(hWndForm, hSql(), ROW_New) AND fModResult
.head 4 +  If fModResult
.head 5 -  Call SqlPrepare(hSql(),
"UPDATE OPERW
    SET value = :colVALUE
  WHERE ref=:nRef and tag=:colTAG")
.head 5 -  Set fModResult = SalTblDoUpdates(hWndForm, hSql(), ROW_Edited) AND fModResult
.head 4 -  !
.head 4 +  If fModResult
.head 5 -  Call SqlCommitEx(hSql(), 'Доп.реквизиты для документа #' || SalNumberToStrX( nRef, 0 ) || ' вставлены/изменены!' )
.head 4 +  Else
.head 5 -  Call SqlRollback(hSql())
.head 1 -  !
.head 1 +  ! Dialog Box: IbisZN
.winattr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Импорт ВИСНОВКІВ в КАРТОТЕКУ-2
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.138"
.head 4 -  Top:    0.094"
.head 4 -  Width:  12.983"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 7.071"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.end
.head 2 -  Description: Импорт виновків IBIS
.head 2 +  Tool Bar
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Всего:
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.119"
.head 5 -  Width:  1.317"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfReccount
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions
.head 3 -  Background Text: Выбрано:
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.783"
.head 5 -  Top:    0.095"
.head 5 -  Width:  1.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfAll
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions
.head 3 -  Background Text: Обработано:
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.083"
.head 5 -  Top:    0.095"
.head 5 -  Width:  2.267"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfCurrent
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   11.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbExecute
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   11.183"
.head 5 -  Top:    5.738"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If IsBankDayOpen()
.head 7 +  If dfOKPO_KEY = ''
.head 8 -  Return FALSE
.head 7 +  If not cbAll
.head 8 +  If MessageQuestion('Прием/Оплата ВИСНОВКІВ (файл ' || dfFile || ') ?') = IDNO
.head 9 -  Return FALSE
.head 7 -  Call SalUseRegistry(FALSE, '')
.head 7 -  Call SalGetProfileString('Import', 'IbisZN_Path', Left(SalFileGetDrive(), 1) ||
     ':\\BARS98\\ODBC.DSN\\IBIS_ZN', sODBCDir, GetIniFileName())
.head 7 +  If File(sODBCDir || '\\ArchivOK\\' || dfFile)
.head 8 +  If MessageQuestion('Файл ' || dfFile ||
   ' уже принимался ранее. Обрабатывать ПОВТОРНО ???') = IDNO
.head 9 -  Return FALSE
.head 7 -  Call WaitCursorOn()
.head 7 -  Call SalDisableWindow(pbExecute)
.head 7 -  Call SalDisableWindow(pbExit)
.head 7 -  Set dfDone = ""
.head 7 -  Call SaveInfoToLog("Импорт ВИСНОВКІВ в КАРТОТЕКУ-2.")
.head 7 -  Call SalFileGetCurrentDirectory(sTemp)
.head 7 +  If SalFileSetCurrentDirectory(sODBCDir)
.head 8 -  Call SalFileSetCurrentDirectory(sTemp)
.head 8 +  If File(sODBCDir || '\\' || dfFile)
.head 9 -  Set sTempName = VisFileCreateTemp('ZN')
.head 9 -  Call VisFileDelete(sTempName)
.head 9 -  Call SalLoadAppAndWait("Crp.Exe " || sODBCDir || '\\' || dfFile || " " ||
     sTempName || " /d /B /" || dfOKPO_KEY, Window_NotVisible, n99)
.head 9 -  ! Call Debug(sTempName)
.head 9 +  If File(sTempName)
.head 10 -  ! Здесь будем читать и писать в массивы файл sTempName
.head 10 -  Call SalLoadAppAndWait("Del1A.Exe " || sTempName, Window_NotVisible, n99)
.head 10 -  Call VisFileOpen(hF, sTempName, OF_Read)
.head 10 -  Call SalArraySetUpperBound(smND, 1, -1)
.head 10 -  Call SalArraySetUpperBound(dmDATP, 1, -1)
.head 10 -  Call SalArraySetUpperBound(smNAMA, 1, -1)
.head 10 -  Call SalArraySetUpperBound(smSIMBOL, 1, -1)
.head 10 -  Call SalArraySetUpperBound(smKEKD_F, 1, -1)
.head 10 -  Call SalArraySetUpperBound(smNLSA, 1, -1)
.head 10 -  Call SalArraySetUpperBound(nmSumma, 1, -1)
.head 10 -  Call SalArraySetUpperBound(smNLSB, 1, -1)
.head 10 -  Call SalArraySetUpperBound(nmMFOB, 1, -1)
.head 10 -  Call SalArraySetUpperBound(smOKPO_D, 1, -1)
.head 10 -  Call SalArraySetUpperBound(smNOMVIS_E, 1, -1)
.head 10 -  Call SalArraySetUpperBound(smOKPO_A, 1, -1)
.head 10 -  Call SalArraySetUpperBound(smNAMB, 1, -1)
.head 10 -  Call SalArraySetUpperBound(smKEKD_B, 1, -1)
.head 10 -  Set nC = 0
.head 10 +  While VisFileReadString(hF, sText) = VTERR_Ok ! TRUE
.head 11 -  ! Set nI = VisFileReadString(hF, sText)
.head 11 -  ! Call DebugN(nI)
.head 11 +  ! If nI != VTERR_Ok
.head 12 -    Break
.head 11 -  Set nI = At(Chr(250), sText)
.head 11 -  Set sND = Left(sText, nI-1)
.head 11 -  ! Call Debug('sND = ' || StrDosToWinX(sND))
.head 11 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 11 -  Set nI = At(Chr(250), sText)
.head 11 -  Set sTemp = Left(sText, nI-1)
.head 11 -  Set dDATP = SalDateConstruct(Val(Left(sTemp, 4)),
    Val(Subs(sTemp, 5, 2)), Val(Right(sTemp, 2)), 0, 0, 0)
.head 11 -  ! Call Debug('dDATP = ' || StrDosToWinX(sTemp))
.head 11 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 11 -  Set nI = At(Chr(250), sText)
.head 11 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 11 -  Set nI = At(Chr(250), sText)
.head 11 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 11 -  Set nI = At(Chr(250), sText)
.head 11 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 11 -  Set nI = At(Chr(250), sText)
.head 11 -  Set sNAMA = Left(sText, nI-1)
.head 11 -  ! Call Debug('sNAMA = ' || StrDosToWinX(sNAMA))
.head 11 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 11 -  Set nI = At(Chr(250), sText)
.head 11 -  Set sSIMBOL = Left(sText, nI-1)
.head 11 -  ! Call Debug('sSIMBOL = ' || StrDosToWinX(sSIMBOL))
.head 11 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 11 -  Set nI = At(Chr(250), sText)
.head 11 -  Set sKEKD_F = Left(sText, nI-1)
.head 11 -  ! Call Debug('sKEKD_F = ' || StrDosToWinX(sKEKD_F))
.head 11 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 11 -  Set nI = At(Chr(250), sText)
.head 11 -  Set sNLSA = Left(sText, nI-1)
.head 11 -  ! Call Debug('sNLSA = ' || StrDosToWinX(sNLSA))
.head 11 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 11 -  Set nI = At(Chr(250), sText)
.head 11 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 11 -  Set nI = At(Chr(250), sText)
.head 11 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 11 -  Set nI = At(Chr(250), sText)
.head 11 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 11 -  Set nI = At(Chr(250), sText)
.head 11 -  Set nSumma = Val(Left(sText, nI-1))
.head 11 -  ! Call Debug('nSumma = ' || StrDosToWinX(Str(nSumma)))
.head 11 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 11 -  Set nI = At(Chr(250), sText)
.head 11 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 11 -  Set nI = At(Chr(250), sText)
.head 11 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 11 -  Set nI = At(Chr(250), sText)
.head 11 -  Set sNLSB = Left(sText, nI-1)
.head 11 -  ! Call Debug('sNLSB = ' || StrDosToWinX(sNLSB))
.head 11 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 11 -  Set nI = At(Chr(250), sText)
.head 11 -  Set nMFOB = Val(Left(sText, nI-1))
.head 11 -  ! Call Debug('nMFOB = ' || StrDosToWinX(Str(nMFOB)))
.head 11 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 11 -  Set nI = At(Chr(250), sText)
.head 11 -  Set sOKPO_D = Left(sText, nI-1)
.head 11 -  ! Call Debug('sOKPO_D = ' || StrDosToWinX(sOKPO_D))
.head 11 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 11 -  !
.head 11 +  If Subs(dfFile, 7, 1) = '0'
.head 12 -  Set nI = At(Chr(250), sText)
.head 12 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 12 -  Set nI = At(Chr(250), sText)
.head 12 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 12 -  Set nI = At(Chr(250), sText)
.head 12 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 12 -  Set nI = At(Chr(253), sText)
.head 12 -  Set sNOMVIS_E = Left(sText, nI-1)
.head 12 -  ! Call Debug('sNOMVIS_E = ' || StrDosToWinX(sNOMVIS_E))
.head 12 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 12 -  Set nI = At(Chr(253), sText)
.head 12 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 12 -  Set nI = At(Chr(253), sText)
.head 12 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 12 -  Set nI = At(Chr(253), sText)
.head 12 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 12 -  Set nI = At(Chr(253), sText)
.head 12 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 12 -  Set nI = At(Chr(253), sText)
.head 12 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 12 -  Set nI = At(Chr(253), sText)
.head 12 -  Set sOKPO_A = Left(sText, nI-1)
.head 12 -  ! Call Debug('sOKPO_A = ' || StrDosToWinX(sOKPO_A))
.head 12 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 12 -  Set nI = At(Chr(253), sText)
.head 12 -  Set sNAMB = Left(sText, nI-1)
.head 12 -  ! Call Debug('sNAMB = ' || StrDosToWinX(sNAMB))
.head 12 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 12 -  Set nI = At(Chr(253) || Chr(250), sText)
.head 12 -  Set sKEKD_B = Left(sText, nI-1)
.head 11 +  Else
.head 12 -  Set nI = At(Chr(250), sText)
.head 12 -  Set sNAMB = Left(sText, nI-1)
.head 12 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 12 -  Set nI = At(Chr(250), sText)
.head 12 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 12 -  Set nI = At(Chr(250), sText)
.head 12 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 12 -  Set nI = At(Chr(253), sText)
.head 12 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 12 -  Set nI = At(Chr(253), sText)
.head 12 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 12 -  Set nI = At(Chr(253), sText)
.head 12 -  Set sOKPO_C = Left(sText, nI-1)
.head 12 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 12 -  Set nI = At(Chr(253), sText)
.head 12 -  Set sWOZW_B = Left(sText, nI-1)
.head 12 -  Set sText = Subs(sText, nI+1, Len(sText)-nI)
.head 12 -  ! Для застави ставим ОКПО района.
.head 12 -  Set sOKPO_A = dfOKPO_KEY
.head 11 -  ! Call Debug('sKEKD_B = ' || StrDosToWinX(sKEKD_B) || ' --- ' || sText)
.head 11 -  Set smND[nC] = sND
.head 11 -  Set dmDATP[nC] = dDATP
.head 11 -  Set smNAMA[nC] = sNAMA
.head 11 -  Set smSIMBOL[nC] = sSIMBOL
.head 11 -  Set smKEKD_F[nC] = sKEKD_F
.head 11 -  Set smNLSA[nC] = sNLSA
.head 11 -  Set nmSumma[nC] = nSumma
.head 11 -  Set smNLSB[nC] = sNLSB
.head 11 -  Set nmMFOB[nC] = nMFOB
.head 11 -  Set smOKPO_D[nC] = sOKPO_D
.head 11 -  Set smNOMVIS_E[nC] = sNOMVIS_E
.head 11 -  Set smOKPO_A[nC] = sOKPO_A
.head 11 -  Set smNAMB[nC] = sNAMB
.head 11 -  Set smKEKD_B[nC] = sKEKD_B
.head 11 -  Set smOKPO_C[nC] = sOKPO_C
.head 11 -  Set smWOZW_B[nC] = sWOZW_B
.head 11 -  Set nC = nC + 1
.head 10 -  Call VisFileClose(hF)
.head 10 -  Call VisFileDelete(sTempName)
.head 10 -  Call SalShowWindow(dfStart)
.head 10 -  Call SalShowWindow(dfEnd)
.head 10 -  Set nTimeStart = SalDateHour(SalDateCurrent())*3600 + SalDateMinute(
    SalDateCurrent())*60 + SalDateSecond(SalDateCurrent())
.head 10 -  Set dfStart = 'Старт: ' || SalFmtFormatDateTime(SalDateCurrent(), 'hhh:mm:ss')
.head 10 -  Set dfReccount = nC
.head 10 -  Set dfCurrent = 0
.head 10 -  Set dfAll = 0
.head 10 -  Set nPos = 0
.head 10 -  Set nTek = 0
.head 10 -  Set nRecn = 1
.head 10 -  Set nDelta = 100 / nC
.head 10 -  Set nK = 0
.head 10 -  Set bCommit = TRUE
.head 10 +  While nK < nC
.head 11 -  Set sNls = SalStrTrimX(smNLSA[nK])
.head 11 -  Set sMfo = IifS(nmMFOB[nK]=0 or nmMFOB[nK]=NUMBER_Null, GetBankMfo(),
    Str(nmMFOB[nK]))
.head 11 -  Set sNlsk = SalStrTrimX(smNLSB[nK])
.head 11 -  Set sNd = SalStrTrimX(StrDosToWinX(smND[nK]))
.head 11 -  Set sPlat = SalStrTrimX(StrDosToWinX(smNAMA[nK]))
.head 11 -  Set sPolu = SalStrTrimX(StrDosToWinX(smNAMB[nK]))
.head 11 +  If Subs(dfFile, 7, 1) = '0'
.head 12 -  Set sNaz1 = SalStrTrimX('*;' || smOKPO_A[nK] || ';' || smKEKD_B[nK] || ';'
    || smSIMBOL[nK] || '<' || smOKPO_D[nK] || ';' || smNOMVIS_E[nK] || ';'
    || smKEKD_F[nK] || '>;перерахування коштiв зайво внесеного податку, ' ||
    'згiдно висновку № ' || smNOMVIS_E[nK] || ' вiд ' || DtoC(dmDATP[nK]) ||
    ' р.')
.head 12 -  Set sKod = SalStrTrimX(smOKPO_A[nK])
.head 11 +  Else
.head 12 -  ! Set sNaz1 = SalStrTrimX('*;' || smKEKD_B[nK] || ';' || smKEKD_F[nK] ||
    ';01;перерахування коштiв від реалізації податкової застави, згідно ' ||
    'довідки № ' || sNd || ' за ' || DtoC(dmDATP[nK]) || IifS(
     Len(smWOZW_B[nK])+Len(smOKPO_C[nK])=0, '', ' (' || IifS(
     Len(smWOZW_B[nK])=0, '', StrDosToWinX(smWOZW_B[nK])) || IifS(
     Len(smOKPO_C[nK])=0, ')', ' ОКПО ' || smOKPO_C[nK]) || ')'))
.head 12 -  Set sNaz1 = SalStrTrimX('*;' || smOKPO_A[nK] || ';' || smKEKD_F[nK] ||
    ';01;перерахування коштiв від реалізації податкової застави, згідно ' ||
    'довідки № ' || sNd || ' за ' || DtoC(dmDATP[nK]) || IifS(
     Len(smWOZW_B[nK])+Len(smOKPO_C[nK])=0, '', ' (' || IifS(
     Len(smWOZW_B[nK])=0, '', StrDosToWinX(smWOZW_B[nK])) || IifS(
     Len(smOKPO_C[nK])=0, ')', ' ОКПО ' || smOKPO_C[nK]) || ')'))
.head 12 -  Set sKod = SalStrTrimX(smOKPO_D[nK])
.head 11 -  ! Set dDat = dmDATP[nK]
.head 11 -  Set nS = nmSumma[nK]
.head 11 -  Set nVob = IifN(sMfo = GetBankMfo(), 6, 1)
.head 11 -  Set sKodk = Str(IifN(sMfo = GetBankMfo(), 2, 1) + IifN(
    Left(smNLSA[nK], 4)='3412', 3, 0))
.head 11 -  !
.head 11 -  Set nNewRow = SalTblInsertRow(tbl2, TBL_MaxRow)
.head 11 -  Call SalTblSetContext(tbl2, nNewRow)
.head 11 -  Set tbl2.colNPP = nRecn
.head 11 -  Set tbl2.colND = sNd
.head 11 -  Set tbl2.colMFOA = IifS(Val(sNls)=0, '', GetBankMfo())
.head 11 -  Set tbl2.colNLSA = sNls
.head 11 -  Set tbl2.colMFOB = IifS(Val(sNls)=0, '', sMfo)
.head 11 -  Set tbl2.colNLSB = sNlsk
.head 11 -  Set tbl2.colS = nS / 100
.head 11 -  Set tbl2.colVDATE = dDat
.head 11 -  Set tbl2.colREF98 = nRef99bm
.head 11 -  Call SalTblSetFocusRow(tbl2, nNewRow)
.head 11 -  Call SalTblSetRowFlags(tbl2, nNewRow, ROW_Edited | ROW_New, FALSE)
.head 11 +  If Val(sNls) = 0
.head 12 -  Call VisTblSetRowColor(tbl2, nNewRow, COLOR_Gray)
.head 11 -  Call SalTblSetCellTextColor(tbl2.colNPP, COLOR_Teal, TRUE)
.head 11 +  If dDat != DATETIME_Null and Abs(nS) > 0 and (nRef99bm = 0 or
   nRef99bm = NUMBER_Null)
.head 12 -  Call VisTblSetRowColor(tbl2, nNewRow, COLOR_Blue)
.head 12 -  Call SalTblSetCellTextColor(tbl2.colNPP, COLOR_Teal, TRUE)
.head 12 -  Call ccDoc.SetDoc(0, 'K2A', 1, nVob, sNd, dDat, dDat, dDat, dDat,
     sNls,  sPlat, GetBankMfo(), '', 980, nS, sKodSvoj,
     sNlsk, sPolu, sMfo,     '', 980, nS, sKod,
     sNaz1, '', sAn, '', 0, 0)
.head 12 -  Set dfAll = dfAll + 1
.head 12 +  If ccDoc.oDoc() and sKod=V_Okpo(sKod)
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     UPDATE oper
     SET userid=:nUid
     WHERE ref=:ccDoc.m_nRef")
.head 13 -  ! Set sKodk = IifS(nKod=0 or
    NUMBER_Null, '99', Str(nKod))
.head 13 -  Call SqlPrepareAndExecute(hSql(),
     "
     INSERT
     INTO operw (ref,tag,value)
     VALUES (:ccDoc.m_nRef,'VIDPL',:sKodk)")
.head 13 -  ! Call SqlCommit(hSql())
.head 13 -  Set tbl2.colREF98 = ccDoc.m_nRef
.head 13 -  Call VisTblSetRowColor(tbl2, nNewRow, COLOR_DarkGreen)
.head 13 -  Call SalTblSetCellTextColor(tbl2.colNPP, COLOR_Teal, TRUE)
.head 13 -  Set dfCurrent = dfCurrent + 1
.head 12 +  Else
.head 13 -  Set bCommit = FALSE
.head 11 -  Set nPos = nPos + nDelta
.head 11 -  Set nRecn = nRecn + 1
.head 11 -  Set nK = nK + 1
.head 11 +  If Int(nPos) != nTek
.head 12 -  Set nTek = Int(nPos)
.head 12 -  Set nTimeCurrent = SalDateHour(SalDateCurrent())*3600 + SalDateMinute(
    SalDateCurrent())*60 + SalDateSecond(SalDateCurrent())
.head 12 -  Set nTimeEnd = Int(100 * (nTimeCurrent-nTimeStart) / nPos + nTimeStart)
.head 12 -  Set nHour = Int(nTimeEnd/3600)
.head 12 -  Set nTemp = nTimeEnd - nHour*3600
.head 12 -  Set nMinu = Int(nTemp/60)
.head 12 -  Set dfStart = dfStart
.head 12 -  Set dfEnd = 'Финиш: ' || Right(Str(100+nHour), 2) || ':' || Right(
    Str(100+nMinu), 2) || ':' || Right(Str(100+nTemp-nMinu*60), 2) ||
    ' (прогноз)'
.head 12 -  Set dfReccount = dfReccount
.head 12 -  Set dfCurrent = dfCurrent
.head 12 -  Set dfAll = dfAll
.head 11 -  Call ccProgressBar.SetProgress(nPos)
.head 11 -  Call SalUpdateWindow(hWndForm)
.head 10 -  Call ccProgressBar.SetProgress(100)
.head 10 -  Call SaveInfoToLog("Прием документов из " || dfFile || " ОКОНЧЕН")
.head 10 +  If bCommit
.head 11 -  ! скопировать файл оригинала в АРХИВ (создав каталог архива)
.head 11 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivOK')
.head 11 -  ! Call Debug(sODBCDir || '\\' || dfFile)
.head 11 -  ! Call Debug(sODBCDir || '\\ArchivOK')
.head 11 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivOK\\' ||
     dfFile)
.head 11 +  If File(sODBCDir || '\\ArchivOK\\' || dfFile)
.head 12 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 12 -  Call SqlCommitEx(hSql(), 'OK')
.head 12 -  Call FileZNListBox()
.head 11 +  Else
.head 12 -  Call SqlRollbackEx(hSql(), 'Error - no file copy')
.head 12 -  Call MessageNoWait('ВНИМАНИЕ ! Обработаны ВСЕ выбранные документы, однако '
     || 'не удалось сделать КОПИЮ обработанного файла. Произведен ПОЛНЫЙ '
     || 'ОТКАТ всех выполненных операций. Примите меры для исправления ' ||
     'ошибок.', 'Строгое предупреждение', 0, 1)
.head 12 -  Call SalTblSetCellTextColor(tbl2.colND, COLOR_Red, TRUE)
.head 12 -  Call SalTblSetCellTextColor(tbl2.colMFOA, COLOR_Red, TRUE)
.head 12 -  Call SalTblSetCellTextColor(tbl2.colNLSA, COLOR_Red, TRUE)
.head 12 -  Call SalTblSetCellTextColor(tbl2.colMFOB, COLOR_Red, TRUE)
.head 12 -  Call SalTblSetCellTextColor(tbl2.colNLSB, COLOR_Red, TRUE)
.head 12 -  Call SalTblSetCellTextColor(tbl2.colS, COLOR_Red, TRUE)
.head 12 -  Call SalTblSetCellTextColor(tbl2.colVDATE, COLOR_Red, TRUE)
.head 12 -  Call SalTblSetCellTextColor(tbl2.colREF98, COLOR_Red, TRUE)
.head 10 +  Else
.head 11 -  Call SqlRollbackEx(hSql(), 'Error')
.head 11 -  Call MessageNoWait('ВНИМАНИЕ ! Обработаны не ВСЕ выбранные документы. ' ||
     'Примите меры для исправления ошибок.', 'Строгое предупреждение', 0, 1)
.head 10 -  Set dfDone = "Готово"
.head 10 -  Set dfEnd = Left(dfEnd, 15)
.head 10 -  Call SalMessageBeep(-1)
.head 10 -  Call SalSetFocus(tbl2)
.head 10 -  Call VisTblAutoSizeColumn(tbl2, hWndNULL)
.head 10 -  Call SalEnableWindow(pbExecute)
.head 9 +  Else
.head 10 -  Call MessageAttention('Не удалось расшифровать файл ' || dfFile)
.head 8 +  Else
.head 9 -  Call MessageAttention('Нет файла: ' || sODBCDir || dfFile ||
     ' или он занят другим пользователем.')
.head 9 -  Call SalEnableWindow(pbExecute)
.head 7 +  Else
.head 8 -  Call MessageAttention('Нет каталога: ' || sODBCDir)
.head 7 -  Call SalEnableWindow(pbExit)
.head 7 -  Call SalSetFocus(pbExit)
.head 7 -  Call WaitCursorOff()
.head 6 +  Else
.head 7 -  Call Debug("День закрыт !")
.head 3 +  Pushbutton: pbExit
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   11.483"
.head 5 -  Top:    6.155"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 -  Frame
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    5.655"
.head 5 -  Width:  12.733"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.083"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Drop-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfStart
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.083"
.head 6 -  Top:    6.095"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions
.head 3 +  Data Field: dfEnd
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.083"
.head 6 -  Top:    6.345"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions
.head 3 +  Data Field: dfDone
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.283"
.head 6 -  Top:    6.179"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Purple
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions
.head 3 +  Custom Control: ccProgressBar
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name: vti11.dll
.head 5 -  MS Windows Class Name: VT:cMeter:10
.head 5 -  Style:  0x00000000
.head 5 -  ExStyle:  0x00000000
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    5.321"
.head 6 -  Width:  12.733"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Etched Border? Yes
.head 5 -  Hollow? No
.head 5 -  Vertical Scroll? No
.head 5 -  Horizontal Scroll? No
.head 5 -  Tab Stop? None
.head 5 -  Tile To Parent? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Teal
.head 5 -  Background Color: System Window Color
.head 5 -  DLL Settings
.end
.head 4 -  Message Actions
.head 3 +  Child Table: tbl2
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.405"
.head 6 -  Width:  12.733"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.833"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 333333
.head 5 -  Discardable? Yes
.end
.head 4 +  Contents
.head 5 +  Column: colNPP
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nпп
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.514"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colND
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер док.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.229"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMFOA
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО-А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.743"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLSA
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет-А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.657"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMFOB
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.743"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLSB
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.657"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.714"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVDATE
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата вал.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.014"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colREF98
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Референс
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.971"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nFocusRow
.head 5 -  Window Handle: hWndCol
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalTblSetRowFlags(tbl2, lParam, ROW_Selected, FALSE)
.head 6 -  Call VisTblAutoSizeColumn(tbl2, hWndNULL)
.head 5 +  On SAM_CornerClick
.head 6 -  Call SalTblSetRowFlags(tbl2, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_CornerDoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl2, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl2, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_RowHeaderClick
.head 6 -  Call SalTblSetRowFlags(tbl2, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl2, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_EndCellTab
.head 6 -  Call SalTblSetRowFlags(tbl2, lParam, ROW_Selected, FALSE)
.head 5 +  On WM_LbuttonUp
.head 6 -  ! Узнать текущую строку
.head 6 -  ! Call SalTblQueryFocus(tbl2, nFocusRow, hWndCol)
.head 6 -  ! Set nFocusRow = SalTblQueryContext(tbl2)
.head 6 -  ! Почистить все
.head 6 -  Call SalTblSetFlagsAnyRows(tbl2, ROW_Selected, FALSE, 0, 0)
.head 6 -  ! Call SalTblSetFocusRow (tbl2, nFocusRow)
.head 6 -  ! Стать на нее (что выше)
.head 6 -  ! Call SalTblSetRowFlags(tbl2, nFocusRow,
     ROW_Selected, FALSE)
.head 6 -  ! Call SalSendMsg(tbl2, SAM_RowHeaderClick, 0,
     Max(TBL_MaxRow, nFocusRow+1))
.head 5 +  On VTM_KeyUp
.head 6 -  Call SalTblSetFlagsAnyRows(tbl2, ROW_Selected, FALSE, 0, 0)
.head 6 -  Call VisTblAutoSizeColumn(tbl2, hWndNULL)
.head 5 +  On WM_NCMouseMove ! 160
.head 6 -  Call VisTblAutoSizeColumn(tbl2, hWndNULL)
.head 3 -  Background Text: Имя файла импорта
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    5.762"
.head 5 -  Width:  3.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.31"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 -  Background Text: Код ОКПО
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.283"
.head 5 -  Top:    5.762"
.head 5 -  Width:  1.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.31"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfOKPO_KEY
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.283"
.head 6 -  Top:    5.738"
.head 6 -  Width:  2.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.31"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions
.head 3 +  Combo Box: dfFile
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.483"
.head 5 -  Top:    5.738"
.head 5 -  Width:  2.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.869"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: 12
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.end
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If File(sODBCDir || '\\' || dfFile)
.head 7 -  Set nTrulala = Val(Subs(dfFile, 2, 4))
.head 7 +  If SqlPrepareAndExecute(hSql(), T("
     SELECT okpo
     INTO :dfOKPO_KEY
     FROM customer
     WHERE rnk=:nTrulala"))
.head 8 +  If NOT SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set dfOKPO_KEY = ''
.head 3 +  Check Box: cbAll
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Принять ВСЕ файлы
.head 4 -  Window Location and Size
.head 5 -  Left:   0.383"
.head 5 -  Top:    6.155"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Teal
.head 4 -  Background Color: Default
.end
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: FileZNListBox
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: smFiles[*]
.head 5 -  Number: nI
.head 5 -  Number: nFiles
.head 4 +  Actions
.head 5 -  Call SalUseRegistry(FALSE, '')
.head 5 -  Call SalGetProfileString('Import', 'IbisZN_Path', Left(SalFileGetDrive(), 1) ||
     ':\\BARS98\\ODBC.DSN\\IBIS_ZN', sODBCDir, GetIniFileName())
.head 5 -  Set nFiles = VisDosEnumFiles(sODBCDir || '\\*.*', FA_Standard, smFiles)
.head 5 -  Set nI = 0
.head 5 -  Call SalListClear(dfFile)
.head 5 -  Set dfOKPO_KEY = ''
.head 5 +  While nI < nFiles
.head 6 -  Call SalListAdd(dfFile, smFiles[nI])
.head 6 -  Set nI = nI + 1
.head 5 -  Call SalListSetSelect(dfFile, 0)
.head 5 -  Call SalSendMsg(dfFile, SAM_Click, 0, 0)
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  : ccDoc
.winattr class
.head 4 -  Class: cDoc
.end
.head 3 -  String: sAn
.head 3 -  String: sMfo
.head 3 -  String: sBankDay
.head 3 -  Number: nPos
.head 3 -  Number: nDelta
.head 3 -  Number: nC
.head 3 -  Number: nMfo
.head 3 -  String: sNd
.head 3 -  String: sNls
.head 3 -  String: sNlsk
.head 3 -  Number: nS
.head 3 -  Date/Time: dDat
.head 3 -  String: sPlat
.head 3 -  String: sPolu
.head 3 -  String: sNaz1
.head 3 -  String: sKod
.head 3 -  String: sKodk
.head 3 -  Number: nRow
.head 3 -  String: sODBCDir
.head 3 -  Number: n99
.head 3 -  !
.head 3 -  Number: nRef99bm
.head 3 -  !
.head 3 -  Number: nNewRow
.head 3 -  !
.head 3 -  Number: nTimeStart
.head 3 -  Number: nTimeCurrent
.head 3 -  Number: nTimeEnd
.head 3 -  Number: nHour
.head 3 -  Number: nMinu
.head 3 -  Number: nTemp
.head 3 -  Number: nRecn
.head 3 -  Number: nTek
.head 3 -  !
.head 3 -  Boolean: bSFN
.head 3 -  !
.head 3 -  Number: nVob
.head 3 -  String: sKodSvoj
.head 3 -  !
.head 3 -  String: sND
.head 3 -  Date/Time: dDATP
.head 3 -  String: sNAMA
.head 3 -  String: sSIMBOL
.head 3 -  String: sKEKD_F
.head 3 -  String: sNLSA
.head 3 -  Number: nSumma
.head 3 -  String: sNLSB
.head 3 -  Number: nMFOB
.head 3 -  String: sOKPO_D
.head 3 -  String: sNOMVIS_E
.head 3 -  String: sOKPO_A
.head 3 -  String: sNAMB
.head 3 -  String: sKEKD_B
.head 3 -  String: sOKPO_C
.head 3 -  String: sWOZW_B
.head 3 -  !
.head 3 -  String: smND[*]
.head 3 -  Date/Time: dmDATP[*]
.head 3 -  String: smNAMA[*]
.head 3 -  String: smSIMBOL[*]
.head 3 -  String: smKEKD_F[*]
.head 3 -  String: smNLSA[*]
.head 3 -  Number: nmSumma[*]
.head 3 -  String: smNLSB[*]
.head 3 -  Number: nmMFOB[*]
.head 3 -  String: smOKPO_D[*]
.head 3 -  String: smNOMVIS_E[*]
.head 3 -  String: smOKPO_A[*]
.head 3 -  String: smNAMB[*]
.head 3 -  String: smKEKD_B[*]
.head 3 -  String: smOKPO_C[*]
.head 3 -  String: smWOZW_B[*]
.head 3 -  !
.head 3 -  String: sTemp
.head 3 -  String: sTempName
.head 3 -  File Handle: hF
.head 3 -  Number: nI
.head 3 -  Number: nK
.head 3 -  Boolean: bCommit
.head 3 -  String: sText
.head 3 -  Number: nTrulala
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Call Debug(SalFmtFormatDateTime(SalDateCurrent(), 'DDMMYYYYhhhmmss'))
.head 4 -  Call WaitCursorOn()
.head 4 -  Call ConPara('PUSH')
.head 4 -  Set dDat =  GetBankDate()
.head 4 -  Set sBankDay = GetBankDateEx()
.head 4 -  Set sKodSvoj = Right('00000000' || Str(GetBankOkpo()), 8)
.head 4 -  Set sAn = GetIdOper()
.head 4 -  Call FileZNListBox()
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalSetFocus(pbExit)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call WaitCursorOff()
.head 3 +  On SAM_Destroy
.head 4 -  Call ConPara('POP')
.head 4 -  Call WaitCursorOff()
.head 4 -  ! Disactivation of function's role, which activated for
  calling window
.head 4 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 5 -  Call XRoleUnset(hSql(), 'Sel000(hWndMDI,12,0,"","")')
.head 1 -  !
.head 1 +  Table Window: Zo8
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Выполнение конвертации проводок по ЗО для налогового учета
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.275"
.head 4 -  Top:    0.229"
.head 4 -  Width:  14.6"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 7.0"
.head 4 -  Height Editable? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  View: Table
.head 3 -  Allow Row Sizing? No
.head 3 -  Lines Per Row: Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Default
.head 3 -  Discardable? No
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.427"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.514"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.517"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.383"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 55719
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  4.557"
.head 6 -  Begin Y:  -0.01"
.head 6 -  End X:  4.557"
.head 6 -  End Y:  0.448"
.head 5 -  Visible? No
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.043"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\search.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.017"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call DocViewContentsEx(hWndForm,Zo8.REF)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.517"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 55720
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  3.886"
.head 6 -  Begin Y:  -0.01"
.head 6 -  End X:  3.886"
.head 6 -  End Y:  0.448"
.head 5 -  Visible? No
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.517"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 55721
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  2.367"
.head 6 -  Begin Y:  0.024"
.head 6 -  End X:  2.367"
.head 6 -  End Y:  0.488"
.head 5 -  Visible? No
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pb_Nal
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.017"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Execute.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 -  On SAM_Create
.head 6 +  On SAM_Click
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 7 -  Set nRow = TBL_MinRow
.head 7 -  Set FL=TRUE
.head 7 +  While SalTblFindNextRow(hWndForm, nRow, 0, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nRow)
.head 8 -  ! Снять в FDAT
.head 8 -  Call Pl_dat(FDAT)
.head 8 -  Set FL = FL
and cDoc.PayV(1, REF, FDAT, 'PO3', DK, KV, Str(NLS8), S*100, KV, Str(nKonrt), S*100)
.head 8 +  If Left(GetValueStr('SELECT tt FROM oper WHERE ref=' || Str(REF)), 2) != 'ZG'
.head 9 -  ! Допровести в VDAT
.head 9 -  Call Pl_dat(Dat_Zo)
.head 9 -  Set FL = FL
and cDoc.PayV(1, REF, Dat_Zo, 'PO3', 1-DK, KV, Str(NLS8), S*100, KV, Str(nKonrt), S*100)
.head 7 +  If FL
.head 8 -  Call SqlCommit(hSql())
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 7 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 7 -  Call SalWaitCursor(FALSE)
.head 4 +  Data Field: Dat_Opl
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.883"
.head 7 -  Top:    0.107"
.head 7 -  Width:  1.533"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call SalSendMsg(Dat_Opl, SAM_Validate, 0, 0)
.head 6 +  On SAM_Validate
.head 7 +  If Dat_Opl > GetBankDate()
.head 8 -  Return VALIDATE_Cancel
.head 7 -  Set Dat_Zo = Dat_Opl - SalDateDay(Dat_Opl)
.head 7 +  If SalDateMonth(Dat_Zo) = 12 and SalDateYear(Dat_Zo) = 2002
.head 8 -  Set Dat_Zo = SalDateConstruct(2002, 12, 30, 0, 0, 0)
.head 7 -  If SqlPrepareAndExecute(hSql(),
"SELECT max(fdat) INTO :Zo8.Dat_Zo FROM fdat where fdat<=:Zo8.Dat_Zo")
and SqlFetchNext(hSql(), nFetchRes)
.head 7 +  If SalDateMonth(Dat_Opl) = 1
.head 8 -  Call SalEnableWindow(Dat_Zo)
.head 7 +  Else
.head 8 -  Call SalDisableWindow(Dat_Zo)
.head 7 -  Return VALIDATE_Ok
.head 4 +  Data Field: Dat_Zo
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.317"
.head 7 -  Top:    0.107"
.head 7 -  Width:  1.533"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Validate
.head 7 +  If SalIsNull(Dat_Zo)
.head 8 -  Set Dat_Zo = Dat_Opl - SalDateDay(Dat_Opl)
.head 8 -  If SqlPrepareAndExecute(hSql(),
"SELECT max(fdat) INTO :Zo8.Dat_Zo FROM fdat where fdat<=:Zo8.Dat_Zo")
and SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Return VALIDATE_Ok
.head 2 +  Contents
.head 3 +  Column: VDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
закл.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sVDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
закл.
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.017"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Реф
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: FDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
оплаты
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sFDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
оплаты
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ДK
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.4"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLSF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
 Фин.уч
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLS8
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
 Нал.уч
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMS8
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование сч
Нал.учета
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  4.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nKonrt
.head 2 +  Window Variables
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  !
.head 3 -  String: sDat
.head 3 -  Date/Time: bDat
.head 3 -  !
.head 3 -  Number: n980
.head 3 -  Number: nRow
.head 3 -  Boolean: FL
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set bDat    = GetBankDate()
.head 4 -  Set Dat_Opl = GetBankDate()
.head 4 -  Set n980    = GetBaseVal()
.head 4 -  Set Zo8.strPrintFileName = 'Zo8'
.head 4 -  !
.head 4 +  If SalDateMonth(Dat_Opl) = 1
.head 5 -  Call SalEnableWindow(Dat_Zo)
.head 4 +  Else
.head 5 -  Call SalDisableWindow(Dat_Zo)
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  ! Ускорение население формы "Конвертация ЗО в НУ" при помощи создания промежуточной таблицы
.head 4 -  If SqlPrepareAndExecute( hSql(), "delete from ref_kor" ) and
SqlPrepareAndExecute( hSql(),
"insert into ref_kor (ref,vdat,vob)
 select ref, vdat, vob from oper
 where vdat>=:Zo8.Dat_Zo AND vdat<=:Zo8.Dat_Opl and vob=96 AND sos=5 " )
.head 4 -  ! !
.head 4 -  Set Zo8.strSqlPopulate =
"SELECT distinct
        :Zo8.Dat_Zo, p.fdat, p.dk, a.nls, b.nls, p.s/100, p.ref, a.kv,
        to_char(:Zo8.Dat_Zo, 'MM-DD-YYYY'), to_char(p.fdat, 'MM-DD-YYYY'), b.nms
   INTO :Zo8.VDAT, :Zo8.FDAT, :Zo8.DK, :Zo8.NLSF, :Zo8.NLS8, :Zo8.S, :Zo8.REF, :Zo8.KV,
        :Zo8.sVDAT, :Zo8.sFDAT, :Zo8.NMS8
   FROM opldok p, accounts a, accounts b,nal_dec8 n, ref_kor k
  WHERE k.ref=p.ref
    AND p.fdat>:Zo8.Dat_Zo AND p.fdat<=:Zo8.Dat_Opl
    AND p.acc=a.acc AND b.nls not like '88%' AND a.accc=b.acc
    AND (b.nls=n.nls8 or (b.nls=n.nls and substr(b.nls,1,1)='8'))
    AND A.KV=:n980 AND B.KV=:n980
    AND p.ref not in (SELECT ref
                        FROM opldok
                       WHERE tt in ('PO3','ZG0','ZG1','ZG2','ZG3','ZG4','ZG5','ZG6','ZG7')
                         AND fdat>:Zo8.Dat_Zo
                         AND fdat<=:Zo8.Dat_Opl)
  ORDER BY p.ref"
.head 4 -  Call SalTblPopulate(hWndForm, hSql(), Zo8.strSqlPopulate, TBL_FillAll)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_Destroy
.head 4 -  Call Pl_dat(bDat)
.head 1 +  Table Window: frm_ViewRisk
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Риски кредитных операций
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.1"
.head 4 -  Top:    0.917"
.head 4 -  Width:  15.6"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 19135
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 19136
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 19137
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbForm
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRelation
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.686"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If not IsWindow(hWndFormReserv)
.head 8 -  Set hWndFormReserv = SalCreateWindow(frm_FormReserv, hWndMDI, hSql,nPayNLS,strStandNLS,strNonStandNLS)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(hWndFormReserv)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Формирование резерва"
.head 2 +  Contents
.head 3 +  Column: colClientName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование заемщика
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colClientId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Регистрационный номер клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDocName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: №
КД
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.533"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDocId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Идентиф
КД
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCreditSumCur
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.517"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCreditSum
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма КД
в ном
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.543"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPawnSum
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Расчетный
Залог в вал КД
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.429"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCreditSumInEq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма КД
в экв
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPawnSumInEq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Расчетный
Залог в экв
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRiskSum
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма риска
в вал КД
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.357"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRezervSum
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма резерва
в вал КД
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.357"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRisk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Риск
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.614"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Sql Handle: hSql
.head 3 -  Number: nPayNLS
.head 3 -  String: strStandNLS
.head 3 -  String: strNonStandNLS
.head 2 +  Window Variables
.head 3 -  Window Handle: hWndFormReserv
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Set nFlags = GT_ReadOnly
.head 4 -  Set frm_ViewRisk.strSqlPopulate=
"SELECT  cc_rez.NMK            ,cc_rez.RNK                    ,cc_rez.ND                 ,
         cc_rez.CC_ID          ,cc_rez.KV                     ,cc_rez.SS/100             ,
         cc_rez.SZ/100         ,cc_rez.SSQ/100                ,cc_rez.SZQ/100            ,
         cc_rez.SRISK/100      ,cc_rez.SREZ/100
 INTO :frm_ViewRisk.colClientName,:frm_ViewRisk.colClientId     ,:frm_ViewRisk.colDocName  ,
      :frm_ViewRisk.colDocId     ,:frm_ViewRisk.colCreditSumCur ,:frm_ViewRisk.colCreditSum,
      :frm_ViewRisk.colPawnSum   ,:frm_ViewRisk.colCreditSumInEq,:frm_ViewRisk.colPawnSumInEq,
      :frm_ViewRisk.colRiskSum   ,:frm_ViewRisk.colRezervSum
 FROM cc_rez ORDER BY cc_rez.RNK, cc_rez.CC_ID "
.head 4 -  Set frm_ViewRisk.strFilterTblName='cc_rez'
.head 4 -  Set frm_ViewRisk.strPrintFileName='cc_rez'
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 1 +  Table Window: frm_FormReserv
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Формирование резерва
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 19141
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 19142
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.986"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 19143
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbRun
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.7"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Выполнить проводки'
.head 6 +  On SAM_Click
.head 7 -  Set bOk=TRUE
.head 7 -  ! Set dDat = GetBankDate()
.head 7 -  Call SqlPrepareAndExecute(hSql, "
     SELECT val
     INTO :frm_FormReserv.dDat
     FROM params
     WHERE par='BANKDATE'")
.head 7 -  Call SqlFetchNext(hSql, nCheck)
.head 7 -  ! Set dDat = SalStrToDate(strTmp)
.head 7 -  Set strMfo = GetBankMfo()
.head 7 -  Set strOkpo = GetBankOkpoS()
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(frm_FormReserv, nRow, 0, 0)
.head 8 -  Call SalTblSetContext(frm_FormReserv, nRow)
.head 8 -  Set strNLS_A = Str(nPayNLS)
.head 8 -  Call SqlPrepareAndExecute(hSql, "
     SELECT val
     INTO :frm_FormReserv.strTmp
     FROM params
     WHERE par='BASEVAL'")
.head 8 -  Call SqlFetchNext(hSql, nCheck)
.head 8 -  Set nKV_A = SalStrToNumber(strTmp)
.head 8 -  ! Set nKV_A = GetBaseVal()
.head 8 -  Set strNLS_B = colRezAccount
.head 8 -  Set strNMS_B = colRezName
.head 8 -  Set nKV_B = colRezCur
.head 8 -  Set nSum = colRezDiffCoin
.head 8 -  Call SqlPrepareAndExecute(hSql, "
     SELECT nms
     INTO :strNMS_A
     FROM accounts
     WHERE nls=" || strNLS_A || " and kv=:nKV_A")
.head 8 -  Call SqlFetchNext(hSql, nCheck)
.head 8 +  If bOk and strNLS_B and nKV_B and strNLS_A and nKV_A and nSum
.head 9 +  If nRow > 980
.head 10 -  Call SalMessageBox('Переполнение таблицы. Часть данных не обработана.',
     'Внимание', MB_IconExclamation)
.head 10 -  Break
.head 9 +  ! If nSum > 0
.head 10 -    Set nDK = 1
.head 9 +  ! Else
.head 10 -    Set nDK = 0
.head 9 -  Set nDK = IifN(nSum>0, 1, 0)
.head 9 -  Set nSum = Abs(nSum)
.head 9 -  Call cDoc.SetDoc(NUMBER_Null, 'ARE', 1-nDK, 16, '', dDat, dDat, dDat, dDat,
     strNLS_B, strNMS_B, strMfo, '', nKV_B, nSum, strOkpo, strNLS_A, strNMS_A,
     strMfo, '', nKV_A, 0, strOkpo, 'Формирование резерва', '', GetIdOper(), '',
     NUMBER_Null, 0)
.head 9 +  If NOT cDoc.oDoc()
.head 10 -  Call SqlRollback(hSql)
.head 10 -  Set bOk = FALSE
.head 10 -  Set strError = "Ошибка оплаты:" || Str(cDoc.m_nErr) || "."
.head 9 +  Else
.head 10 -  Call SqlCommit(hSql)
.head 7 +  If bOk
.head 8 -  Call MessageInfoEx('Готово.')
.head 7 +  Else
.head 8 -  Call MessageInfoEx('Ошибка.' || strError)
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 7 -  Call SalWaitCursor(FALSE)
.head 2 +  Contents
.head 3 +  Column: colRezName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование группы риска
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.686"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRezCur
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Валюта
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.886"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRezAccount
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.886"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRezCurrent
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.729"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRezCurrentCoin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.729"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRezCounted
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Расчетная сумма
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.929"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRezCountedCoin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Расчетная сумма
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.929"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRezDiff
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Разница
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.271"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRezDiffCoin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Разница
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.271"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Sql Handle: hSql
.head 3 -  Number: nPayNLS
.head 3 -  String: strStandNLS
.head 3 -  String: strNonStandNLS
.head 2 +  Window Variables
.head 3 -  : cF
.head 4 -  Class: cGenFilter
.head 3 -  String: sFilt
.head 3 -  String: strNLS_A
.head 3 -  String: strNMS_A
.head 3 -  String: strNLS_B
.head 3 -  String: strNMS_B
.head 3 -  Number: nKV_A
.head 3 -  Number: nKV_B
.head 3 -  Number: nSum
.head 3 -  Number: nDK
.head 3 -  Number: nRow
.head 3 -  String: strMfo
.head 3 -  String: strOkpo
.head 3 -  : cDoc
.head 4 -  Class: cDoc
.head 3 -  Date/Time: dDat
.head 3 -  Number: nFetchRes
.head 3 -  Number: nRowLast
.head 3 -  Boolean: bOk
.head 3 -  String: strError
.head 3 -  Number: nCheck
.head 3 -  String: strTmp
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Set nFlags = GT_ReadOnly
.head 4 -  Set strSqlPopulate = "
    SELECT a.kv,a.nls,a.ostb/power(10,t.dig),a.ostb,a.nms,
           SUM(ROUND(z.SREZ,0)/power(10,t.dig)),SUM(ROUND(z.SREZ,0)),
           SUM(ROUND(z.SREZ,0)/power(10,t.dig))-a.ostb/power(10,t.dig),
           SUM(ROUND(z.SREZ,0))-a.ostb
    INTO :frm_FormReserv.colRezCur,:frm_FormReserv.colRezAccount,
         :frm_FormReserv.colRezCurrent,:frm_FormReserv.colRezCurrentCoin,
         :frm_FormReserv.colRezName,:frm_FormReserv.colRezCounted,
         :frm_FormReserv.colRezCountedCoin,:frm_FormReserv.colRezDiff,
         :frm_FormReserv.colRezDiffCoin
    FROM cc_rez z, tabval t, accounts a
    WHERE a.kv=z.kv and t.kv=z.kv and a.nls=DECODE(z.RISK,1," || strStandNLS || "," ||
          strNonStandNLS || ")" || "
    GROUP BY a.kv,a.nls,a.ostb/power(10,t.dig),a.ostb,a.nms"
.head 4 -  Set strPrintFileName = 'rezerv'
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 1 +  Form Window: frm_Reestr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Анализ реестра от
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  13.533"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.94"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.452"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Combo Box: cmbMenu
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.333"
.head 6 -  Top:    0.095"
.head 6 -  Width:  6.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.738"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Editable? Yes
.head 5 -  String Type: String
.head 5 -  Maximum Data Length: Default
.head 5 -  Sorted? Yes
.head 5 -  Always Show List? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Call SalListAdd(hWndItem, '1. Полный реестр' )
.head 7 -  Call SalListAdd(hWndItem, '1.Повний реєстр БАНКУ')
.head 7 -  Call SalListAdd(hWndItem, '2.Повний реєстр внутрішніх док. БАНКУ')
.head 7 -  Call SalListAdd(hWndItem, '3.Повний реєстр початкових док. БАНКУ')
.head 7 -  Call SalListAdd(hWndItem, '4.Док-ти, що є в БАНКУ, але   відсутні  у клієнта')
.head 7 -  Call SalListAdd(hWndItem, '5.Док-ти, що є у клієнта, але   відсутні  в  БАНКУ ')
.head 7 -  Call SalListAdd(hWndItem, '6.Заключний реєстр КЛІЄНТА')
.head 7 -  Call SalSetWindowText(  hWndItem,  '1.Повний реєстр БАНКУ' )
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(pbRunAnalyse, SAM_Click, 0,0)
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.683"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 7 -  Call SalBringWindowToTop(tbl_Reestr)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Выход"
.head 4 +  Pushbutton: pbSaveToFile
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbFilter
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.033"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\SAVE.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Сохранить в файл"
.head 6 +  On SAM_Click
.head 7 -  Call SalWaitCursor (TRUE )
.head 7 -  Set i = SalTblQueryContext(tbl_Reestr)
.head 7 -  Call tbl_Reestr.Klik[i].SaveToFile(tbl_Reestr.cmbDate, SalStrToNumber(SalStrLeftX(cmbMenu,1)), TRUE)
.head 4 +  Pushbutton: pbRunAnalyse
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.983"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set i = SalTblQueryContext ( tbl_Reestr )
.head 7 -  Call PrintInfo( tbl_Reestr.cmbDate, tbl_Reestr.Klik[i] )
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Показать информацию"
.head 4 -  Line
.head 5 -  Resource Id: 1069
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  1.183"
.head 6 -  Begin Y:  0.024"
.head 6 -  End X:  1.183"
.head 6 -  End Y:  0.381"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 -  Line
.head 5 -  Resource Id: 1070
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  0.6"
.head 6 -  Begin Y:  0.036"
.head 6 -  End X:  0.6"
.head 6 -  End Y:  0.393"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 2 +  Contents
.head 3 +  Custom Control: cSpltMain
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalVSplitterInvisible
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.483"
.head 6 -  Top:    2.667"
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.964"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Yes
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tblRep
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.024"
.head 6 -  Width:  10.85"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.571"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 3000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: №
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.75"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNd
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер док.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.367"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNlsB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNlsA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMfoB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.05"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSum
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.683"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата док.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.15"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDatV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата/время получ.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.883"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOkpo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Окпо контр.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.283"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNameK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование клиента
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.85"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNazn
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назначение
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: Long String
.head 6 -  Justify: Left
.head 6 -  Width:  17.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblDefineSplitWindow ( tblRep, 5, TRUE )


.head 2 +  Functions
.head 3 +  Function: PrintInfo
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  ! String: strRefArc  [*, 15]
.head 5 -  ! String: strModyPond [*, 15]         !! -  номер док-та из dbf (поле "pond") -  но уже приведенные к ref_a
.head 5 -  ! String: strBankName                  !! -  имя клиента + его ОКПО
.head 5 -  String: strDate                               !! -  дата файла
.head 5 -  ! Number: nArcCou
.head 5 -  ! Number: nPondCou
.head 5 -  : Klient
.head 6 -  Class: cElKlient
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: i
.head 5 -  Number: nCou
.head 5 -  Number: nNewLine
.head 4 +  Actions
.head 5 -  Call SalWaitCursor (TRUE )
.head 5 -  Call SalTblReset( tblRep)

.head 5 -  ! ========================================================
.head 5 -  ! - - - В зависимисти от того, какой пункт меню выбрали  ...
.head 5 -  ! ========================================================
.head 5 -  Set nSel = SalStrToNumber(SalStrLeftX(cmbMenu,1))
.head 5 -  Set i = 0
.head 5 -  Set nSum = 0
.head 5 -  Set nCou = 0
.head 5 -  ! - - - Klient.strA[i,1] = '1' -  первоначальное значение ключа - это значение остается в длинном массиве, чтоб не заполнять его '3' ( '3'  эквивалентно  '1')
.head 5 -  ! - - - Klient.strA[i,1] = '2' -  плптежи есть там и там
.head 5 -  ! - - - Klient.strA[i,1] = '3' -  платеж есть в arc_rrp , но нету в dbf
.head 5 -  ! - - - Klient.strA[i,1] > '4' -  плптежи есть там и там. но реквизиты  не совпдают
.head 5 -  !
.head 5 +  Select Case nSel
.head 6 -  ! - - - - - - Все документі банка- - - - - - - - - - - -
.head 6 +  Case 1
.head 7 -  !
.head 7 +  While i  <Klient.nACou
.head 8 -  Set nCou =  nCou + 1
.head 8 +  If SalStrToNumber(Klient.strA[i,1]) >4
.head 9 -  Call AddInfoToTable(Klient.strA, i, '?'||SalNumberToStrX(nCou,0))
.head 8 +  Else
.head 9 +  If SalStrToNumber(Klient.strA[i,1]) = 3
.head 10 -  Call AddInfoToTable(Klient.strA, i, '-'||SalNumberToStrX(nCou,0))
.head 9 +  Else
.head 10 -  Call AddInfoToTable(Klient.strA, i, SalNumberToStrX(nCou,0))
.head 8 -  Set nSum = nSum + SalStrToNumber(Klient.strA[ i , 5])
.head 8 -  Set i=i +1
.head 7 -  Break
.head 6 -  ! - - - - - - Внутрение  документы - - - - - - - - - - - - - - - - -
.head 6 +  Case 2
.head 7 -  !
.head 7 +  While i  < Klient.nACou
.head 8 +  If ( SalStrTrimX (Klient.strA[ i , 4]) = GetBankMfo() )
.head 9 -  Set nCou =  nCou + 1
.head 9 +  If SalStrToNumber(Klient.strA[i,1]) >4
.head 10 -  Call AddInfoToTable(Klient.strA, i, '?'||SalNumberToStrX(nCou,0))
.head 9 +  Else
.head 10 +  If SalStrToNumber(Klient.strA[i,1]) = 3
.head 11 -  Call AddInfoToTable(Klient.strA, i, '-'||SalNumberToStrX(nCou,0))
.head 10 +  Else
.head 11 -  Call AddInfoToTable(Klient.strA, i, SalNumberToStrX(nCou,0))
.head 9 -  Set nSum = nSum + SalStrToNumber(Klient.strA[ i , 5])
.head 8 -  Set i=i +1
.head 7 -  Break
.head 6 -  ! - - - - - - Межбанковские  документы - - - - - - - - - - - -
.head 6 +  Case 3
.head 7 -  !
.head 7 +  While i  < Klient.nACou
.head 8 +  If ( SalStrTrimX (Klient.strA[ i , 4]) != GetBankMfo()  )
.head 9 +  ! If SalStrToNumber(Klient.strA[i,1]) >4
.head 10 -  Call AddInfoToTable(Klient.strA, i, '???')
.head 9 +  ! Else
.head 10 -  Set nCou = nCou + 1
.head 10 -  Set nSum = nSum + SalStrToNumber(Klient.strA[ i , 5])
.head 10 -  Call AddInfoToTable(Klient.strA, i, SalNumberToStrX(nCou,0))
.head 9 -  Set nCou =  nCou + 1
.head 9 +  If SalStrToNumber(Klient.strA[i,1]) >4
.head 10 -  Call AddInfoToTable(Klient.strA, i, '?'||SalNumberToStrX(nCou,0))
.head 9 +  Else
.head 10 +  If SalStrToNumber(Klient.strA[i,1]) = 3
.head 11 -  Call AddInfoToTable(Klient.strA, i, '-'||SalNumberToStrX(nCou,0))
.head 10 +  Else
.head 11 -  Call AddInfoToTable(Klient.strA, i, SalNumberToStrX(nCou,0))
.head 9 -  Set nSum = nSum + SalStrToNumber(Klient.strA[ i , 5])
.head 8 -  Set i=i +1
.head 7 -  Break
.head 6 -  ! - - - - - - Док-ты ненайденые   в файле dbf - но присутствующие в базе - - - - - - -
.head 6 +  Case 4
.head 7 -  !
.head 7 +  While i  <Klient.nACou
.head 8 +  If (Klient.strA[i,1] = '3' or Klient.strA[i,1] = '1' or SalStrToNumber(Klient.strA[i,1]) > 4)
.head 9 -  Set nCou =  nCou + 1
.head 9 +  If SalStrToNumber(Klient.strA[i,1]) >4
.head 10 -  Call AddInfoToTable(Klient.strA, i, '?'||SalNumberToStrX(nCou,0))
.head 9 +  Else
.head 10 -  Call AddInfoToTable(Klient.strA, i, '-'||SalNumberToStrX(nCou,0))
.head 9 -  Set nSum = nSum + SalStrToNumber(Klient.strA[ i , 5])
.head 8 -  Set i=i +1
.head 7 -  Break
.head 6 -  ! - - - - - - Док-ты ненайденые   в базе - - но присутствующие в dbf- - - - - - - - - - - -
.head 6 +  Case 5
.head 7 -  !
.head 7 +  While i  <Klient.nBCou
.head 8 +  If ( Klient.strB[i,1] = '3' or Klient.strB[i,1] = '1' or SalStrToNumber(Klient.strB[i,1]) > 4)
.head 9 -  ! Set nCou =  nCou + 1
.head 9 -  ! Call AddInfoToTable(Klient.strB, i, SalNumberToStrX(nCou,0))
.head 9 -  ! Set nSum = nSum + SalStrToNumber(Klient.strB[ i , 5])
.head 9 -  Set nCou =  nCou + 1
.head 9 +  If SalStrToNumber(Klient.strB[i,1]) >4
.head 10 -  Call AddInfoToTable(Klient.strB, i, '?'||SalNumberToStrX(nCou,0))
.head 9 +  Else
.head 10 -  Call AddInfoToTable(Klient.strB, i, '-'||SalNumberToStrX(nCou,0))
.head 9 -  Set nSum = nSum + SalStrToNumber(Klient.strB[ i , 5])
.head 8 -  Set i=i +1
.head 7 -  Break
.head 6 -  ! - - - - - - Заключительный реестр - это все документы из  dbf- - - - - - - - - - - -
.head 6 +  Case 6
.head 7 -  !
.head 7 +  While i  <Klient.nBCou
.head 8 -  ! Set nCou =  nCou + 1
.head 8 -  ! Call AddInfoToTable(Klient.strB, i, SalNumberToStrX(nCou,0))
.head 8 -  ! Set nSum = nSum + SalStrToNumber(Klient.strB[ i , 5])
.head 8 -  Set nCou =  nCou + 1
.head 8 +  If SalStrToNumber(Klient.strB[i,1]) >4
.head 9 -  Call AddInfoToTable(Klient.strB, i, '?'||SalNumberToStrX(nCou,0))
.head 8 +  Else
.head 9 +  If SalStrToNumber(Klient.strB[i,1]) = 3
.head 10 -  Call AddInfoToTable(Klient.strB, i, '-'||SalNumberToStrX(nCou,0))
.head 9 +  Else
.head 10 -  Call AddInfoToTable(Klient.strB, i, SalNumberToStrX(nCou,0))
.head 8 -  Set nSum = nSum + SalStrToNumber(Klient.strB[ i , 5])
.head 8 -  Set i=i +1
.head 7 -  Break
.head 5 -  !
.head 5 -  Set nNewLine = SalTblInsertRow ( tblRep, TBL_MinRow )
.head 5 -  Call SalTblSetContext ( tblRep,  nNewLine)
.head 5 -  Call SalTblSetRowFlags( tblRep, nNewLine,ROW_New, FALSE)
.head 5 -  Set tblRep.colSum =nSum/100
.head 5 -  Set tblRep.colN = SalNumberToStrX(nCou,0)
.head 5 -  Set tblRep.colNlsB = 'Итого:'
.head 5 -  Set strCou =SalNumberToStrX(nCou,0)
.head 5 -  !
.head 5 -  Call SalWaitCursor (FALSE )
.head 3 +  Function: StrToStrFormat
.head 4 -  Description: !! Превращает строку в строку заданной длины (nLen) - дополняя впереди символом
.head 4 +  Returns
.head 5 -  String: strVal
.head 4 +  Parameters
.head 5 -  String: sVal
.head 5 -  Number: nLen
.head 5 -  String: strChar
.head 5 -  Boolean: bAlign ! - -  true = right,   false = left
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: i
.head 5 -  String: strRet
.head 4 +  Actions
.head 5 -  Set i=SalStrLength(sVal)
.head 5 -  Set strRet = sVal
.head 5 +  While i < nLen
.head 6 +  If bAlign
.head 7 -  Set strRet = strChar||strRet
.head 6 +  Else
.head 7 -  Set strRet =strRet|| strChar
.head 6 -  Set i=i+1
.head 5 -  Return strRet
.head 3 +  Function: AddInfoToTable
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: strArr [*, 15]
.head 5 -  Number: nLine
.head 5 -  String: nCou
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: i
.head 5 -  Window Handle: hColumn
.head 4 +  Actions
.head 5 -  Set i= SalTblInsertRow ( tblRep, TBL_MaxRow )
.head 5 -  Call SalTblSetRowFlags( tblRep, i ,ROW_New, FALSE)
.head 5 -  Call SalTblSetContext ( tblRep, i )
.head 5 +  If SalStrLeftX(nCou,1)='?'
.head 6 -  Call XSalTblSetRowBackColor(tblRep, i, COLOR_Sky )
.head 6 -  ! -- Найдем, колонку реквизита платежа, который не соовпадает
.head 6 -  ! -- так как ОКПО не проверяется - закомментарила
.head 6 -  ! Call Debug('Rekvisit - '||strArr[ nLine,1 ] ||' column='|| SalNumberToStrX(SalStrToNumber(strArr[ nLine,1 ])- 5,0) )
.head 6 -  Set hColumn = SalTblGetColumnWindow(
        tblRep,  SalStrToNumber(strArr[ nLine,1 ])- 4 , COL_GetID)
.head 6 -  Call XSalTblSetCellBackColor( hColumn,COLOR_LightGreen	)
.head 6 -  Set nCou = SalStrRightX(nCou, SalStrLength(nCou)-1)
.head 5 -  ! ================================================
.head 5 -  ! --- Платежа нету в банке или в файле реестра
.head 5 -  ! ================================================
.head 5 +  If SalStrLeftX(nCou,1)='-'
.head 6 -  Call XSalTblSetRowBackColor(tblRep, i, COLOR_LightPeriwinkle)
.head 6 -  Set nCou = SalStrRightX(nCou, SalStrLength(nCou)-1)
.head 5 -  Set tblRep.colN = nCou
.head 5 -  Set tblRep.colNd = strArr[ nLine, 6 ]
.head 5 -  Set tblRep.colNlsA = strArr[ nLine, 3]
.head 5 -  Set tblRep.colMfoB = strArr[ nLine,4 ]
.head 5 -  Set tblRep.colNlsB = strArr[ nLine,2 ]
.head 5 -  Set tblRep.colSum = SalStrToNumber( strArr[ nLine,5 ] )/100
.head 5 -  Set tblRep.colDatD = strArr[ nLine,12 ]
.head 5 -  Set tblRep.colDatV = strArr[ nLine,13 ]
.head 5 -  Set tblRep.colNameK = strArr[ nLine,8 ]
.head 5 -  Set tblRep.colNazn = strArr[ nLine,11 ]
.head 5 -  Set tblRep.colOkpo = strArr[ nLine,7 ]
.head 5 -  !
.head 2 +  Window Parameters
.head 3 -  String: strTitle
.head 2 +  Window Variables
.head 3 -  Number: i
.head 3 -  Number: nSel
.head 3 -  Number: nSum
.head 3 -  String: strCou
.head 3 -  Number: nNewLine
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call cSpltMain.setLeftFrame( tblRep)
.head 4 -  Call cSpltMain.setBarPosition( 1000 )
.head 4 -  Call SalSetWindowText(  hWndForm,  strTitle )
.head 4 -  Call SalSetWindowText(  hWndForm,  strTitle )
.head 3 +  On SAM_Destroy
.head 4 -  Set tbl_Reestr.hWndReestr =hWndNULL
.head 4 -  Call SalBringWindowToTop(tbl_Reestr)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSendMsg(pbRunAnalyse, SAM_Click, 0,0)
.head 1 +  Table Window: tbl_Reestr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Обработка заключительных реестров
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  13.533"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 7.286"
.head 4 -  Height Editable? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  View: Table
.head 3 -  Allow Row Sizing? No
.head 3 -  Lines Per Row: Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Default
.head 3 -  Discardable? Yes
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.464"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Combo Box: cmbDate
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.683"
.head 6 -  Top:    0.095"
.head 6 -  Width:  3.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Editable? Yes
.head 5 -  String Type: String
.head 5 -  Maximum Data Length: Default
.head 5 -  Sorted? Yes
.head 5 -  Always Show List? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set nCurRow=TBL_MinRow
.head 7 +  While SalTblFindNextRow (  hWndForm, nCurRow, 0, 0 )
.head 8 -  Call SalTblSetContext(hWndForm,nCurRow)
.head 8 -  Set cIsExist = 0
.head 8 -  Set cIsDiffer = 0
.head 8 -  Set cIsBank = 0
.head 7 -  Set nCurRow=TBL_MinRow
.head 7 +  While SalTblFindNextRow (  hWndForm, nCurRow, ROW_Selected, 0 )
.head 8 -  Call SalTblSetContext(hWndForm,nCurRow)
.head 7 -  Call SalDisableWindow(pbSaveToFileAll)
.head 4 +  Data Field: dfReeDir
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.933"
.head 7 -  Top:    0.095"
.head 7 -  Width:  4.65"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Перечитать данные"
.head 6 +  On SAM_Click
.head 7 -  Call SalTblPopulate( hWndForm, hSql,
"SELECT n.sab, nb, okpo
  INTO :colSab, :colKliName, :colOkpo
  FROM banks n, custbank b, customer s
  WHERE fmi='$A' AND fmo='$B'  AND  n.mfo = b.mfo AND b.rnk=s.rnk
  ORDER BY sab", TBL_FillAll )
.head 4 +  Pushbutton: pbRun
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.533"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\REP_SOLO.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If cmbDate != ''
.head 8 -  Set i=SalTblQueryContext(hWndForm)
.head 8 -  ! - - если не делали сличение ВСЕХ
.head 8 +  If cIsExist = 0
.head 9 +  If Klik[i].NestInfo(cmbDate)>=0
.head 10 -  Call Klik[i].Compare()
.head 10 +  If hWndReestr = hWndNULL
.head 11 -  Set hWndReestr = SalCreateWindow( frm_Reestr, hWndForm, 'Анализ реесстра от '|| colKliName ||' за '|| cmbDate)
.head 10 +  Else
.head 11 -  Call SalBringWindowToTop(frm_Reestr)
.head 9 +  Else
.head 10 -  Call SalMessageBox('Функция NestRefs()  возвратила <=0' , 'Внимание!',0)
.head 8 -  ! - - если делали сличение ВСЕХ  не выполнять функу NestRef и Compare
.head 8 +  Else
.head 9 +  If hWndReestr = hWndNULL
.head 10 -  Set hWndReestr = SalCreateWindow( frm_Reestr, hWndForm, 'Анализ реесстра от '|| colKliName ||' за '|| cmbDate)
.head 9 +  Else
.head 10 -  Call SalBringWindowToTop(frm_Reestr)
.head 7 +  Else
.head 8 -  Call SalMessageBox('Не выбрана дата  ', 'Внимание!',0)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Выполнить анализ реестра для выбранного клиента"
.head 4 +  Pushbutton: pbRunAll
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\REP_JOIN.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set nCurRow=TBL_MinRow
.head 7 -  Set i = 0
.head 7 +  While SalTblFindNextRow (  hWndForm, nCurRow, 0, 0 )
.head 8 -  Call SalTblSetContext( hWndForm, nCurRow)
.head 8 -  ! ==========================================================================
.head 8 -  ! === Проверим есть ли для текущего клиента за данную дату файл
.head 8 -  ! ==========================================================================
.head 8 -  Set nFiles=VisDosEnumFiles( strReeDir || '\\' || colSab|| SalStrLeftX(cmbDate,2)|| SalStrMidX(cmbDate,3,2) ||'.zee', FA_Standard, strFileList)
.head 8 +  If nFiles > 0
.head 9 -  Set cIsExist = 1
.head 8 +  Else
.head 9 -  Set cIsExist = 0
.head 8 +  If Klik[i].NestInfo(cmbDate) >= 0
.head 9 +  If Klik[i].Compare() >=  0
.head 10 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 10 -  ! - - - Проверим есть ли расхождения  - - - - - - - - -
.head 10 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 10 +  If Klik[i].IsDiffer()
.head 11 -  Set cIsDiffer = 1
.head 10 +  Else
.head 11 -  Set cIsDiffer = 0
.head 10 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 10 -  ! - - - Есть ли данные из базы(докум. банка)  - - - - - - - - -
.head 10 -  ! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
.head 10 -  Set cIsBank = IifN(Klik[i].nACou=0, 0, 1)
.head 8 -  Set i = i + 1
.head 7 -  Call SalEnableWindow(pbSaveToFileAll)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Выполнить анализ реестра для всех"
.head 4 +  Pushbutton: pbSaveToFileAll
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.433"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\PRINT_X.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set nCurRow = TBL_MinRow
.head 7 -  Set i=0
.head 7 -  !
.head 7 +  While SalTblFindNextRow ( hWndForm, nCurRow, 0, 0 )
.head 8 -  Call SalTblSetContext( hWndForm, nCurRow)
.head 8 -  Set strFileName = Klik[i].sSab|| SalStrLeftX(cmbDate,2)|| SalStrMidX(cmbDate,3,2)
.head 8 +  If cIsExist = 1
.head 9 -  ! - - - - -  Печатаем внутрение документы
.head 9 -  ! - - - - -  Печатаем начальные документы - - - -  -
.head 9 -  ! - - - - -  Печатаем расхождения - - -- - - - -
.head 9 +  If (Klik[i].SaveToFile(cmbDate, 2, FALSE)<0) or
   (Klik[i].SaveToFile(cmbDate, 3, FALSE)<0) or
   (Klik[i].SaveToFile(cmbDate, 7, FALSE)<0)
.head 10 -  Call SalMessageBox(' Информация для '||Klik[i].sSab||' не сохранена', 'Внимание!',0)
.head 8 +  Else
.head 9 +  If (Klik[i].SaveToFile(cmbDate, 2, FALSE)<0) or
   (Klik[i].SaveToFile(cmbDate, 3, FALSE)<0)

.head 10 -  Call SalMessageBox(' Информация для '||Klik[i].sSab||' не сохранена', 'Внимание!',0)
.head 8 -  Set i = i+1
.head 7 -  !
.head 7 -  !
.head 7 -  Call SalUseRegistry(FALSE, '')
.head 7 -  Call SalGetProfileString('Kliks', 'ReestrRepDir', '', sRepDir, GetIniFileName())
.head 7 +  If sRepDir=''
.head 8 -  Call SalMessageBox(' Информация сохранена в директорию '||strReeDir, '',0)
.head 7 +  Else
.head 8 -  Call SalMessageBox(' Информация сохранена в директорию '||sRepDir, '',0)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Сохранить информацию для ВСЕХ клиентов в файлы"
.head 7 -  Call SalDisableWindow(hWndItem)
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.133"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Выход"
.head 4 -  Line
.head 5 -  Resource Id: 1071
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.683"
.head 6 -  Begin Y:  0.417"
.head 6 -  End X:  2.683"
.head 6 -  End Y:  0.024"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 -  Line
.head 5 -  Resource Id: 1072
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.0"
.head 6 -  Begin Y:  0.429"
.head 6 -  End X:  2.0"
.head 6 -  End Y:  0.036"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  ! ctb_pbOk: pbReeDeb
.winattr class Pushbutton:
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.833"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set nDebVer = GetGlobalOptionEx('REEDEB')
.head 7 +  If nDebVer=0
.head 8 -  Call SalHideWindow( pbReeDeb )
.head 6 +  On SAM_Click
.head 7 +  If SalIsWindowEnabled  ( pbSaveToFileAll )
.head 8 -  Set i=SalTblQueryContext(hWndForm)
.head 2 +  Contents
.head 3 +  Column: colSab
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Эл. идент.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKliName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование клиента (прямой участник)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  7.017"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOkpo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cIsExist
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Есть файл
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.3"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cIsBank
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Есть банк
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cIsDiffer
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отлич.
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.183"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Check Box
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: strReeDir
.head 3 -  String: strReeDate
.head 3 -  Number: nRet
.head 3 -  Date/Time: dtFile
.head 3 -  !
.head 3 -  String: strFileName
.head 3 -  String: sRepDir
.head 3 -  Sql Handle: hSql
.head 3 -  : Klik[*]
.head 4 -  Class: cElKlient
.head 3 -  Number: nKlik
.head 3 -  Number: nCurRow
.head 3 -  Window Handle: hWndReestr
.head 3 -  String: strFileList [*]
.head 3 -  Number: nFiles
.head 3 -  Number: i
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set hWndReestr =hWndNULL
.head 4 -  Set hSql=hSqlAux()
.head 4 -  Call SalTblPopulate( hWndForm, hSql,
"SELECT n.sab, nb, okpo, 0,0
  INTO :colSab, :colKliName, :colOkpo, :cIsExist, :cIsDiffer
  FROM banks n, custbank b, customer s
  WHERE fmi='$A' AND fmo='$B'  AND  n.mfo = b.mfo AND b.rnk=s.rnk
  ORDER BY sab", TBL_FillAll )
.head 4 -  Call SalTblSetContext ( hWndForm, 0 )
.head 4 -  Call SalTblSetRowFlags ( hWndForm, 0, ROW_Selected, TRUE )
.head 4 -  ! =================================
.head 4 -  ! - - - Віичитаем параметр 'ReestrDir'
.head 4 -  ! =================================
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Kliks', 'ReestrDir', '', strReeDir, GetIniFileName())
.head 4 +  If strReeDir=''
.head 5 -  Call SalMessageBox('В файле конфигурации отсутствует параметр "ReestrDir"', 'Внимание!',0)
.head 5 -  Return -1
.head 4 -  Set dfReeDir = strReeDir
.head 4 -  ! =================================
.head 4 -  ! - - - Населим список доступных дат
.head 4 -  ! =================================
.head 4 -  Set nFiles=0
.head 4 -  Set i = 0
.head 4 -  Set strReeDate=''
.head 4 -  Set nFiles=VisDosEnumFiles( strReeDir || '\\' ||  '*.zee', FA_Standard, strFileList)
.head 4 +  While i < nFiles
.head 5 -  Set strReeDate = SalStrMidX(strFileList[ i ],4,2) ||'/'|| SalStrMidX(strFileList[ i ],6,2)|| '/'

.head 5 +  If not  SalFileGetDateTime ( strReeDir || '\\' ||strFileList[ i ], dtFile )
.head 6 -  Call SalMessageBox('Не прочитали дату создания для  '||strFileList[ i ],'Внимание!',0)
.head 6 -  Return -1
.head 5 -  Set strReeDate = strReeDate || SalStrRightX(SalFmtFormatDateTime ( dtFile, 'dd-MM-yyyy' ),4)
.head 5 -  Call SalListAdd ( cmbDate, strReeDate )
.head 5 -  Set i = i + 1
.head 4 -  Set cmbDate = strReeDate
.head 4 -  ! =================================
.head 4 -  ! - - -Уберем дублирующие даты
.head 4 -  ! =================================
.head 4 -  Set i = 0
.head 4 +  While i<SalListQueryCount ( cmbDate ) -1
.head 5 +  If SalListQueryTextX (cmbDate, i)  =  SalListQueryTextX (cmbDate, i + 1)
.head 6 -  Call SalListDelete(cmbDate, i)
.head 5 -  Set i = i+1
.head 4 -  ! =================================
.head 4 -  ! - - -Проинициализируем массив клиентов
.head 4 -  ! =================================
.head 4 -  Set i = 0
.head 4 -  Set nCurRow = TBL_MinRow
.head 4 +  While SalTblFindNextRow (  hWndForm, nCurRow, 0, 0 )
.head 5 -  Call SalTblSetContext(hWndForm,nCurRow)
.head 5 -  Call Klik[i].Init(colKliName, colOkpo, colSab)
.head 5 -  Set i = i + 1
.head 4 -  Set nKlik = i
.head 4 -  Call SalTblSetContext(hWndForm,0)
.head 4 -  !
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalSendMsg(pbRun, SAM_Click,0,0)
.head 1 +  Form Window: frm_ImpMoperi
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Прием документов из DBF-файлов в структуре MOPER
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.038"
.head 4 -  Top:    0.031"
.head 4 -  Width:  14.9"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 7.452"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Bold
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Приём и оплата документов из MOPERов
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Всего:
.head 4 -  Resource Id: 49991
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.119"
.head 5 -  Width:  1.317"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfReccount
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Выбрано:
.head 4 -  Resource Id: 49992
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.783"
.head 5 -  Top:    0.095"
.head 5 -  Width:  1.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfAll
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Обработано:
.head 4 -  Resource Id: 49993
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.083"
.head 5 -  Top:    0.095"
.head 5 -  Width:  2.267"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfCurrent
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   11.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbExecute
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   0.367"
.head 5 -  Top:    6.238"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If dfFile ! есть ли входные файлы
.head 7 -  Call SalDisableWindow(dfBD)
.head 7 +  If IsBankDayOpen()
.head 8 +  If MessageQuestion('Прием/Оплата ' || IifS(cbAll, 'MOPERов', dfFile) || ' ?') = IDNO
.head 9 -  Return FALSE
.head 8 -  ! Для проверки на недопустимые символы
.head 8 -  Set i = 0
.head 8 +  While i <= 31
.head 9 -  Set msSimv[i] = SalNumberToChar(i)
.head 9 -  Set i = i + 1
.head 8 -  Set msSimv[i] = SalNumberToChar(255)
.head 8 -  !
.head 8 -  Set nJur = TBL_MinRow
.head 8 -  ! организация цикла по COMBOboxУ
.head 8 +  While Len(dfFile) > 0
.head 9 -  Call SalArraySetUpperBound(nmREF, 1, -1)
.head 9 -  Call SalArraySetUpperBound(smTAG, 1, -1)
.head 9 -  Call SalArraySetUpperBound(smVALUE, 1, -1)
.head 9 -  Call SalWaitCursor(TRUE)
.head 9 -  ! Call SalDisableWindow(pbExecute)
.head 9 -  Call SalDisableWindow(pbExit)
.head 9 -  Set dfDone = ""
.head 9 -  Call SalUseRegistry(FALSE, '')
.head 9 -  Call SaveInfoToLog('Прием документов из ' || IifS(cbAll, 'MOPERов', dfFile))
.head 9 -  Call SalFileCreateDirectory(sODBCDir || '\\TempODBC.Dir')
.head 9 +  If SalFileSetCurrentDirectory(sODBCDir)
.head 10 -  Call SalFileCreateDirectory(sODBCDir || '\\TempODBC.Dir')
.head 10 -  Call SalFileSetCurrentDirectory(sODBCDir || '\\TempODBC.Dir')
.head 10 -  Set sTempDbf = 'Db' || Left(SalFmtFormatDateTime(SalDateCurrent(), 'mmmmmm'), 2) || SalFmtFormatDateTime(
    SalDateCurrent(), 'ssmm') || '.Dbf'
.head 10 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 10 -  Set SqlDatabase = 'dBase_Files'
.head 10 +  If SalFileGetDateTime(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf, dTmp)
.head 11 -  ! проверить, есть ли поле ref99bm в operxx, если нет, то добавить его
.head 11 -  Set n99 = -1
.head 11 -  Set dfDone = "Подождите ..."
.head 11 -  ! Call SalLoadAppAndWait("FindVar2 " || sODBCDir || '\\TempODBC.Dir\\' || sTempDbf || " ref99bm",
     Window_NotVisible, n99)
.head 11 -  !
.head 11 -  ! Call Debug(sODBCDir || 'TempODBC.Dir\\' || sTempDbf)
.head 11 -  ! Call Debug('ref99bm')
.head 11 -  !
.head 11 -  Set n99 = FindVar2(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf, 'ref99bm')
.head 11 -  ! Call DebugN(n99)
.head 11 +  If n99 = 1
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  ! удалить в NOT, но запросить сначала
.head 12 +  If VisMessageBox('Файл ' || dfFile || ' возможно занят другим пользователем. Удалить в NOT ?', 'ЗАПРОС',
   MBF_IconQuestion, hBtns, 2) = 1 ! ID_Yes
.head 13 -  Call SalWaitCursor(TRUE)
.head 13 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 13 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 13 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 14 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 14 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 12 -  Call FileZNListBox()
.head 12 -  Call SalEnableWindow(pbExecute)
.head 12 -  Call SalEnableWindow(pbExit)
.head 12 -  Break
.head 11 +  If n99 = 2
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  ! удалить без запроса в NOT, но написать об этом
.head 12 -  Call MessageNoWait('Файл ' || dfFile || ' не DBF-структуры, удаляется в NOT !', 'ВНИМАНИЕ !', 37, 1)
.head 12 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 12 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 12 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 12 -  Call FileZNListBox()
.head 12 -  Call SalEnableWindow(pbExecute)
.head 12 -  Call SalEnableWindow(pbExit)
.head 12 -  Break
.head 11 +  If n99 = 3
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  ! удалить без запроса в NOT, но написать об этом
.head 12 -  Call MessageNoWait('Файл ' || dfFile || ' имеет структуру не MOPER, удаляется в NOT !', 'ВНИМАНИЕ !', 37,
     1)
.head 12 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 12 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 12 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 12 -  Call FileZNListBox()
.head 12 -  Call SalEnableWindow(pbExecute)
.head 12 -  Call SalEnableWindow(pbExit)
.head 12 -  Break
.head 11 +  If n99 = 4
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  ! удалить без запроса в NOT, но написать об этом
.head 12 -  Call MessageNoWait('Файл ' || dfFile || ' имеет расширение не .DBF, удаляется в NOT !', 'ВНИМАНИЕ !', 37,
     1)
.head 12 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 12 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 12 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 12 -  Call FileZNListBox()
.head 12 -  Call SalEnableWindow(pbExecute)
.head 12 -  Call SalEnableWindow(pbExit)
.head 12 -  Break
.head 11 -  Set dfDone = ""
.head 11 +  If SqlConnect(hSqlA) and SqlConnect(hSqlB)
.head 12 -  Set mustProcess = TRUE
.head 12 -  ! проверка ЭЦП если включен режим DBFSIGN=1
.head 12 +  If GetGlobalOptionEx('DBFSIGN') = 1 and GetSignOn() = 1
.head 13 +  If GetSignType() = 'UNI' ! пока только для UNI
.head 14 -  ! Call Debug('Включен режим проверки ЭЦП на DBF')
.head 14 -  ! Call Debug('Key ID = ' || GetIdOper())
.head 14 -  Set nErrMsgSize = 4096
.head 14 -  Call SalStrSetBufferLength(szErrMsg, nErrMsgSize)
.head 14 -  Set nSignRes = SignProc('CHECK', sODBCDir || '\\' ||dfFile, GetIdOper(), szErrMsg, nErrMsgSize)
.head 14 +  If 0 != nSignRes
.head 15 +  If -999 = nSignRes ! собственно ЭЦП неверна
.head 16 -  Call SalWaitCursor(FALSE)
.head 16 -  ! удалить без запроса в NOT, но написать об этом
.head 16 -  ! || 'Оригинал: '||sODBCDir || '\\' || dfFile || PutCrLf()
  || 'Копия: '||sODBCDir || '\\TempODBC.Dir\\' ||sTempDbf || PutCrLf()
.head 16 -  Call MessageNoWait('ЭЦП на файл ' || dfFile || ' неверна! Удаляется в NOT!' || PutCrLf() ||
     PutCrLf() || szErrMsg || PutCrLf(), 'ВНИМАНИЕ !', 51, 1)
.head 16 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 16 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 16 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 17 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 17 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 16 -  Call FileZNListBox()
.head 16 -  Call SalEnableWindow(pbExecute)
.head 16 -  Call SalEnableWindow(pbExit)
.head 16 -  ! -------
.head 16 -  Set mustProcess = FALSE
.head 15 +  Else ! другие некритические ошибки
.head 16 +  If IDNO = MessageQuestion('Проверка ЭЦП НБУ на файл ' || dfFile || PutCrLf() || szErrMsg ||
   PutCrLf() || 'Продолжить прием данного файла?')
.head 17 -  Call SalWaitCursor(FALSE)
.head 17 -  ! удалить без запроса в NOT, но написать об этом
.head 17 -  Call MessageNoWait('Файл ' || dfFile || ' удаляется в NOT !', 'ВНИМАНИЕ !', 37, 1)
.head 17 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 17 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 17 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 18 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 18 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 17 -  Call FileZNListBox()
.head 17 -  Call SalEnableWindow(pbExecute)
.head 17 -  Call SalEnableWindow(pbExit)
.head 17 -  ! -------
.head 17 -  Set mustProcess = FALSE
.head 14 +  Else
.head 15 -  ! || 'Оригинал: '||sODBCDir || '\\' || dfFile || PutCrLf()
! || 'Копия: '||sODBCDir || '\\TempODBC.Dir\\' ||sTempDbf || PutCrLf()
.head 15 -  Call SaveInfoToLog('Проверка ЭЦП НБУ на файле ' || dfFile || PutCrLf() || szErrMsg)
.head 12 +  If mustProcess
.head 13 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT DA
     FROM   " || Left(sTempDbf, Len(sTempDbf)-4) || "
     INTO   :dTempDate")
.head 13 -  Call SqlFetchNext(hSqlA, nFetchRes)
.head 13 +  If dTempDate != dfBD
.head 14 -  Call SqlDisconnect(hSqlA)
.head 14 -  Call SqlDisconnect(hSqlB)
.head 14 -  Call SalWaitCursor(FALSE)
.head 14 -  Call MessageNoWait('Файл ' || dfFile || ' не за требуемую (' ||
     SalFmtFormatDateTime(dfBD, 'dd/MM/yyyy') || ') дату, удаляется в NOT !', 'ВНИМАНИЕ !', 37, 1)
.head 14 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 14 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 14 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 15 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 15 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 14 -  Call SalEnableWindow(pbExit)
.head 14 -  Call SalEnableWindow(pbExecute)
.head 14 -  Call FileZNListBox()
.head 14 -  ! удалить без запроса в NOT, но написать об этом
.head 14 -  Return FALSE
.head 13 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT count(*)
     FROM   " || Left(sTempDbf, Len(sTempDbf)-4) || "
     INTO   :nRecCount")
.head 13 -  Call SqlFetchNext(hSqlA, nFetchRes)
.head 13 -  Call SalShowWindow(dfStart)
.head 13 -  Call SalShowWindow(dfEnd)
.head 13 -  Set nTimeStart = SalDateHour(SalDateCurrent())*3600 + SalDateMinute(SalDateCurrent())*60 +
    SalDateSecond(SalDateCurrent())
.head 13 -  Set dfStart = 'Старт: ' || SalFmtFormatDateTime(SalDateCurrent(), 'hhh:mm:ss')
.head 13 -  Set dfReccount = nRecCount
.head 13 -  Set dfCurrent = 0
.head 13 -  Set dfAll = 0
.head 13 -  Set nPos = 0
.head 13 -  Set nTek = 0
.head 13 -  Set nRecn = 1
.head 13 -  Set nDelta = 100 / nRecCount
.head 13 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT fdat
     FROM   fdat
     WHERE  fdat=:dfBD")
.head 13 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 14 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   fdat (fdat)
     VALUES (:dfBD)")
.head 13 +  If dfBD != dBat
.head 14 -  ! Call Pl_dat(dfBD) ! Установить банковскую дату равной dfBD (но не совсем)
.head 13 -  Call SqlSetResultSet(hSqlA, FALSE)
.head 13 -  Set sKASFIO = ''
.head 13 -  Set sKASDOKsn = ''
.head 13 -  Set sKASVID = ''
.head 13 -  Set sSelectOper = "
    SELECT " || IifS(Mod(n99, 10)=7, "ref,", "") || "nm,dk,mfo,nd,vob,nls,nlsk,sk,s,datd,da,plat,polu,
           naz1,vspo,kod,kodb,kisp,sign,ns,np,sos,ref99bm,vdate,kw" || IifS(n99>9, ",kasfio,kasdok,
           kasser,kasndok,kasvid", "") || "
    INTO   " || IifS(Mod(n99, 10)=7, ":nRefOper,", "") || ":nNm,:nDk,:nMfo,:sNd,:nVob,:sNls,:sNlsk,:nSk,
           :nS,:dDat,:dPat,:sPlat,:sPolu,:sNaz1,:sVspo,:sKod,:sKodB,:sKisp,:sSign,:NS,:nNp,:nSos,
           :nRef99bm,:dVdate,:nKw" || IifS(n99>9, ",:sKASFIO,:sKASDOK,:sKASSER,:sKASNDOK,:sKASVID", "")
           || "
    FROM   " || Left(sTempDbf, Len(sTempDbf)-4) || "
    FOR UPDATE OF sos"
.head 13 -  ! Call Debug('sSelectOper = ' || sSelectOper)
.head 13 +  If not SqlPrepare(hSqlA, sSelectOper)
.head 14 -  Call SqlDisconnect(hSqlA)
.head 14 -  Call SqlDisconnect(hSqlB)
.head 14 -  Call SalEnableWindow(pbExit)
.head 14 -  Call SalSetFocus(pbExit)
.head 14 -  Break
.head 13 -  Call SqlOpen(hSqlA, Left(sTempDbf, Len(sTempDbf)-4))
.head 13 -  Set nRec = 0
.head 13 +  While SqlFetchNext(hSqlA, nFetchRes)
.head 14 -  Set nSos = IifN(nSos=NUMBER_Null, 0, nSos)
.head 14 -  Set nRec = nRec + 1
.head 14 -  Set sNls = SalStrTrimX(sNls)
.head 14 -  Set sNlsk = SalStrTrimX(sNlsk)
.head 14 -  ! Перекодировка
.head 14 -  Set sNd = SalStrTrimX(StrDosToWinX(sNd))
.head 14 -  Set sPlat = SalStrTrimX(StrDosToWinX(sPlat))
.head 14 -  Set sPolu = SalStrTrimX(StrDosToWinX(sPolu))
.head 14 -  Set sNaz1 = SalStrTrimX(StrDosToWinX(sNaz1))
.head 14 -  Set sVspo = DelRightSpace(StrDosToWinX(sVspo))
.head 14 -  Set sKASFIO = SalStrTrimX(StrDosToWinX(sKASFIO))
.head 14 -  Set sKASDOKsn = SalStrTrimX(StrDosToWinX(SalStrTrimX(sKASDOK) || ' ' || SalStrTrimX(sKASSER) || ' ' ||
    SalStrTrimX(sKASNDOK)))
.head 14 -  Set sKASVID = SalStrTrimX(StrDosToWinX(sKASVID))
.head 14 -  !
.head 14 -  Set sMfo = Str(nMfo)
.head 14 -  !
.head 14 +  If dDat = DATETIME_Null
.head 15 -  Set dDat = dBat
.head 14 +  If dPat = DATETIME_Null
.head 15 -  Set dPat = dBat
.head 14 +  If dVdate = DATETIME_Null
.head 15 -  Set dVdate = dBat
.head 14 -  !
.head 14 -  Set dValu = dVdate
.head 14 -  Set sKod = SalStrTrimX(sKod)
.head 14 -  Set sKodB = SalStrTrimX(sKodB)
.head 14 -  ! Set lsSign = sSign
.head 14 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 14 -  Call SalTblSetFocusRow(tbl1, nNewRow)
.head 14 -  Set tbl1.colNPP = nRecn
.head 14 -  Set tbl1.colND = sNd
.head 14 -  Set tbl1.colVOB = nVob
.head 14 -  Set tbl1.colMFOA = IifS(Val(sNls)=0, '', sBankMfo)
.head 14 -  Set tbl1.colNLSA = sNls
.head 14 -  Set tbl1.colNAMA = sPlat
.head 14 +  If Val(sNls) = 0
.head 15 -  Set tbl1.colVALA = NUMBER_Null
.head 14 +  Else
.head 15 -  Set tbl1.colVALA = 980
.head 14 -  Set tbl1.colMFOB = IifS(Val(sNls)=0, '', IifS(nMfo=0, sBankMfo, sMfo))
.head 14 -  Set tbl1.colNLSB = sNlsk
.head 14 -  Set tbl1.colNAMB = sPolu
.head 14 +  If Val(sNls) = 0
.head 15 -  Set tbl1.colVALB = NUMBER_Null
.head 14 +  Else
.head 15 -  Set tbl1.colVALB = 980
.head 14 -  Set tbl1.colS = nS/100
.head 14 -  Set tbl1.colVDATE = dVdate
.head 14 -  Set tbl1.colNAZN = sNaz1
.head 14 -  Set tbl1.colREF98 = nRef99bm
.head 14 -  Call SalTblSetRowFlags(tbl1, nNewRow, ROW_Edited | ROW_New, FALSE)
.head 14 -  Set tbl1.colKomm = 'Уже БЫЛ'
.head 14 +  If Val(sNls) = 0
.head 15 +  If nRec = 1 and Len(sVspo) > 0 and Left(sVspo, 1) != '#'
.head 16 -  ! это служебная запись
.head 16 -  ! Call SalFileSetCurrentDirectory(sODBCDir)
.head 16 -  ! Call Debug(IifS(bEE, 'Ok', 'Bad') || ' ' || sODBCDir)
.head 16 -  Set sVspoAdd = ''
.head 16 +  If File(sODBCDir || '\\' || sVspo)
.head 17 -  Call VisFileCopy(sODBCDir || '\\' || sVspo, sODBCDir || '\\TempODBC.Dir\\' || sVspo)
.head 17 +  If SqlConnect(hSqlC)
.head 18 -  ! вычитать в массивы файл (sVspo)
.head 18 +  If not SqlPrepare(hSqlC, "
   SELECT ref,tag,value
   FROM   " || sVspo || "
   INTO   :nREF,:sTAG,:sVALUE")
.head 19 -  Call SqlDisconnect(hSqlA)
.head 19 -  Call SqlDisconnect(hSqlB)
.head 19 -  Call SqlDisconnect(hSqlC)
.head 19 -  Call SalEnableWindow(pbExit)
.head 19 -  Call SalSetFocus(pbExit)
.head 19 -  Break
.head 18 -  Call SqlOpen(hSqlC, sVspo)
.head 18 -  Set nII = 0
.head 18 +  While SqlFetchNext(hSqlC, nFetchRes)
.head 19 -  Set nmREF[nII] = nREF
.head 19 -  Set smTAG[nII] = StrDosToWinX(sTAG)
.head 19 -  Set smVALUE[nII] = StrDosToWinX(SalStrTrimX(sVALUE))
.head 19 -  Set nII = nII + 1
.head 18 -  Call SalFileSetCurrentDirectory(sODBCDir || '\\TempODBC.Dir')
.head 18 -  Call SqlDisconnect(hSqlC)
.head 18 -  Set sVspoAdd = sVspo
.head 18 -  ! Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sVspo)
.head 16 +  Else
.head 17 -  ! не принимаем файл вообще
.head 17 -  Call SalWaitCursor(FALSE)
.head 17 -  ! удалить в NOT, но запросить сначала
.head 17 +  If VisMessageBox('Файл ' || dfFile ||
   ' связан с ОТСУТСТВУЮЩИМ файлом дополнительных реквизитов (' || sVspo ||
   '). Удалить в NOT ?', 'ЗАПРОС', MBF_IconQuestion, hBtns, 2) = 1 ! ID_Yes
.head 18 -  Call SalWaitCursor(TRUE)
.head 18 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 18 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 18 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 19 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 19 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 17 -  ! Call FileZNListBox()
.head 17 -  Call SalEnableWindow(pbExecute)
.head 17 -  Call SalEnableWindow(pbExit)
.head 17 -  ! Call SqlDisconnect(hSqlA)
.head 17 -  ! Call SqlDisconnect(hSqlB)
.head 17 -  Break
.head 15 -  ! (COLOR_Gray) не берется в обработку
.head 15 -  Set tbl1.colKomm = ''
.head 15 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Gray)
.head 14 -  Set sTTS = ''
.head 14 -  !
.head 14 +  ! If Len(sVspo) > 0
.head 15 -  Set nIt = At('#C', sVspo)
.head 15 +  If nIt > 0 and Left(sVspo, 2) != '#d'
.head 16 -  Set sTemp = Subs(sVspo, nIt+2, Len(sVspo)-1-nIt)
.head 16 -  Set nIt = At('#', sTemp)
.head 16 -  Set sTTS = IifS(nIt=0, sTemp, Left(sTemp, nIt-1))
.head 16 -  ! Set sVspo = IifS(Len(sVspo)>nIt, Right(sVspo, Len(sVspo)-nIt+1), '')
.head 16 -  ! Set sVspo = SalStrTrimX(VisStrSubstitute(sVspo, '#C' || sTTS, ''))
.head 16 -  ! Set sVspo = IifS(Len(sVspo)=1, '', sVspo)
.head 14 +  ! If Len(sTTS) > 0
.head 15 -  Set sTTS = Left(sTTS || '  ', 3)
.head 15 -  Set nTemp = 0
.head 15 +  If not SqlPrepareAndExecute(hSqlAux(), T("
   SELECT count(1)
   INTO   :nTemp
   FROM   tts
   WHERE tt=:sTTS")) or not SqlFetchNext(hSqlAux(), nFetchRes)
.head 16 -  Set sTTS = ''
.head 15 +  Else 
.head 16 -  ! Call DebugN(nTemp)
.head 16 -  Set sTTS = IifS(nTemp=0, '', sTTS)
.head 14 +  ! If Len(sTTS) > 0
.head 15 -  Set sVspo = VisStrSubstitute(VisStrSubstitute(sVspo, '#C' || sTTS, '#C'), '#C#', '#')
.head 15 -  Set sVspo = IifS(sVspo='#', '', sVspo)
.head 14 -  !
.head 14 -  ! Call Debug('1 - ' || sVspo)
.head 14 -  !
.head 14 -  Set sTTS = ''
.head 14 -  Set sVspoD = '' 
.head 14 +  If Len(sVspo) > 0
.head 15 -  Set nD = At('#d', sVspo)
.head 15 +  If nD > 0
.head 16 -  Set sVspoD = Subs(sVspo, nD, 53)
.head 16 -  Set sVspo = VisStrSubstitute(sVspo, sVspoD, '#')
.head 16 +  If Len(sVspo) = 1
.head 17 -  Set sVspo = ''
.head 15 -  Set nIt = At('#C', sVspo)
.head 15 +  If nIt > 0
.head 16 -  Set sTemp = Subs(sVspo, nIt+2, Len(sVspo)-1-nIt)
.head 16 -  Set nIt = At('#', sTemp)
.head 16 -  Set sTTS = IifS(nIt=0, sTemp, Left(sTemp, nIt-1))
.head 15 +  If Len(sVspo) > 0 and Len(sVspoD) > 0
.head 16 -  Set sVspo = Left(sVspo, Len(sVspo)-1) || sVspoD
.head 15 +  Else
.head 16 -  Set sVspo = IifS(Len(sVspo)=0, sVspoD, sVspo)
.head 14 -  !
.head 14 -  ! Call Debug('2 - ' || sVspo)
.head 14 -  !
.head 14 +  If Len(sTTS) > 0
.head 15 -  Set sTTS = Left(sTTS || '  ', 3)
.head 15 -  Set nTemp = 0
.head 15 +  If not SqlPrepareAndExecute(hSqlAux(), T("
   SELECT count(1)
   INTO   :nTemp
   FROM   tts
   WHERE  tt=:sTTS")) or not SqlFetchNext(hSqlAux(), nFetchRes)
.head 16 -  Set sTTS = ''
.head 15 +  Else
.head 16 -  ! Call DebugN(nTemp)
.head 16 -  Set sTTS = IifS(nTemp=0, '', sTTS)
.head 14 +  If Len(sTTS) > 0
.head 15 -  Set sVspo = VisStrSubstitute(VisStrRightTrim(VisStrSubstitute(sVspo, '#C' || sTTS, '#C')), '#C#',
    '#')
.head 15 -  Set sVspo = IifS(sVspo='#', '', sVspo)
.head 14 -  ! Call Debug('sTTS =' || sTTS || '
' || 'sVspo=' || sVspo)
.head 14 +  If (nNm = 1 or nNm = 2) and nSos = 0 and nS > 0 and (not (nNp = 380 and nNm = 1 and
   (Left(sNls,4) = '3801' or Left(sNlsk,4) = '3801')) and not (nNp = 991 and nNm = 1 and
   (Left(sNls,4) = '1200' or Left(sNlsk,4) = '1200')))
.head 15 +  If nNm = 1
.head 16 -  Set sMfo = sBankMfo
.head 15 +  If sMfo = sBankMfo
.head 16 -  Set nNm = 1
.head 15 -  ! Проверка реквизитов
.head 15 -  Set bErr = FALSE
.head 15 -  Set bErrNLS = FALSE
.head 15 -  Set sErrMes = ''
.head 15 +  If not (((Len(sKod) = 8 and sKod = V_Okpo(sKod)) or (Len(sKod) = 9 or Len(sKod) = 10) or
   (Len(sKod) = 3) or (sKod = '99999')) and ((Len(sKodB) = 8 and sKodB = V_Okpo(sKodB)) or
   (Len(sKodB) = 9 or Len(sKodB) = 10) or (Len(sKodB) = 3) or (sKodB = '99999')))
.head 16 -  Set sErrMes = sErrMes || '   Отсутствует(ош) ОКРО А или ОКРО Б
'
.head 16 -  Set bErr = TRUE
.head 15 +  If not SqlPrepareAndExecute(hSqlAux(), "
   SELECT sab
   INTO   :sSAB
   FROM   banks
   WHERE  mfo=:sMfo") or not SqlFetchNext(hSqlAux(), nFetchRes)
.head 16 -  Set sErrMes = sErrMes || '   Ошибка МФО
'
.head 16 -  Set bErr = TRUE
.head 15 +  Else
.head 16 +  If Len(sNls) < 5 or sNls != Vkrz2(sBankMfo, sNls)
.head 17 -  Set sErrMes = sErrMes || '   Ошибка Счет-А
'
.head 17 -  Set bErr = TRUE
.head 17 -  Set bErrNLS = TRUE
.head 16 +  If Len(sNlsk) < 5 or sNlsk != Vkrz2(sMfo, sNlsk) or Str(Val(sNlsk)) != sNlsk
.head 17 -  Set sErrMes = sErrMes || '   Ошибка Счет-Б
'
.head 17 -  Set bErr = TRUE
.head 17 -  Set bErrNLS = TRUE
.head 16 +  Else If nNm != 1
.head 17 -  Call SqlPrepareAndExecute(hSqlAux(), "
     SELECT nbs
     FROM   nosep
     WHERE  kod=decode(Substr(:sMfo,1,1),'8',3,decode(Substr(:sSAB,3,1),'H',1,2)) and
            :sNlsk like nbs || '%'")
.head 17 +  If SqlFetchNext(hSqlAux(), nFetchRes)
.head 18 -  Set sErrMes = sErrMes || '   Недопустимый балансовый счет
'
.head 18 -  Set bErr = TRUE
.head 18 -  Set bErrNLS = TRUE
.head 15 +  If Len(sPlat) = 0
.head 16 -  Set sPlat = GetValueStr("
    SELECT substr(NMS,1,38)
    FROM   accounts
    WHERE  nls='" || sNls || "' and kv=980")
.head 15 +  If Len(sPlat) < 3 or SalStrMidX(sPlat, 0, 1) = ' ' or not FScan(StrWinToDosX(sPlat))
.head 16 -  Set sErrMes = sErrMes || '   Ошибка в реквизите ПЛАТЕЛЬЩИК
'
.head 16 -  Set bErr = TRUE
.head 15 +  If Len(sPolu) = 0 and sMfo = sBankMfo
.head 16 -  Set sPolu = GetValueStr("
    SELECT substr(NMS,1,38)
    FROM   accounts
    WHERE  nls='" || sNlsk || "' and kv=980")
.head 15 +  If Len(sPolu) < 3 or SalStrMidX(sPolu, 0, 1) = ' ' or not FScan(StrWinToDosX(sPolu))
.head 16 -  Set sErrMes = sErrMes || '   Ошибка в реквизите ПОЛУЧАТЕЛЬ
'
.head 16 -  Set bErr = TRUE
.head 15 +  If Len(sNaz1) < 3 or SalStrMidX(sNaz1, 0, 1) = ' ' or not FScan(StrWinToDosX(sNaz1))
.head 16 -  Set sErrMes = sErrMes || '   Ошибка в реквизите НАЗНАЧЕНИЕ
'
.head 16 -  Set bErr = TRUE
.head 15 +  If dValu < dfBD
.head 16 -  Set sErrMes = sErrMes || '   Неверна дата валютирования (vdate)
'
.head 16 -  Set bErr = TRUE
.head 15 -  !
.head 15 -  Set sTT = ''
.head 15 +  If nSk > 0
.head 16 -  Set sTmp = sNls
.head 16 -  Set sNls = sNlsk
.head 16 -  Set sNlsk = sTmp
.head 16 -  ! переворот кассы (сальТо)
.head 16 -  Set sTmp = sPolu
.head 16 -  Set sPolu = sPlat
.head 16 -  Set sPlat = sTmp
.head 16 +  If nDk = 1
.head 17 -  Set nDk = 0
.head 16 +  Else If nDk = 0
.head 17 -  Set nDk = 1
.head 16 -  Set nNm = nDk + 1085 ! добавлено для UPB и для всех остальных
.head 16 -  ! свежак
.head 16 +  If Len(sNLSKASSA) > 0
.head 17 -  Call SalArrayGetUpperBound(smNLSKASSA, 1, nI)
.head 17 -  Set nC = 0
.head 17 +  While nC <= nI
.head 18 +  If SalStrScan(sNlsk, smNLSKASSA[nC]) >= 0 and Len(smDK0KASSA[nC]) = 3 and
   Len(smDK1KASSA[nC]) = 3
.head 19 -  Set sTT = IifS(nDk=1, smDK0KASSA[nC], smDK1KASSA[nC])
.head 19 -  Break
.head 18 -  Set nC = nC + 1
.head 15 +  Else
.head 16 -  Set nSk = NUMBER_Null
.head 16 +  If nDk = nKw
.head 17 -  Set nDk = nDk + 2
.head 15 +  If nNm = 2 and NS = 8
.head 16 -  Call SqlPrepareAndExecute(hSqlAux(), T("
     SELECT nls
     INTO   :sNls
     FROM   accounts
     WHERE  tip='90D'"))
.head 16 -  Call SqlFetchNext(hSqlAux(), nFetchRes)
.head 15 -  Set nRef = NUMBER_Null
.head 15 -  ! (COLOR_Blue) претендент
.head 15 -  Set tbl1.colKomm = 'НЕ принят'
.head 15 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Blue)
.head 15 +  If (Len(sTT) = 0 and Len(sNLSKASSA) > 0) or Len(sNLSKASSA) = 0
.head 16 -  ! Set sTT = Right('NM' || IifS(nDk=0 and nNm=2, 'D', IifS(nDk>1 and nNm=2, 'I', Str(nNm))), 3)
.head 16 -  Set sTT = Right('NM' || IifS(nDk=0 and nNm=2, 'D', IifS(nDk>1, IifS(nNm=2, 'I', 'U'), Str(nNm))),
    3)
.head 15 -  ! Проверка на доступ к счетам
.head 15 +  If not bErrNLS
.head 16 -  ! sNls
.head 16 -  ! Call Debug('sNls = ' || sNls || '
sNlsk = ' || sNlsk || '
nDk = ' || Str(nDk) || '
nNm = ' || Str(nNm) || '
sMfo = ' || sMfo || '
sBankMfo = ' || sBankMfo)
.head 16 -  !
.head 16 +  If nDk = 0 and not (SqlPrepareAndExecute(hSqlAux(), "
   SELECT nls
   INTO   :sTmpNls
   FROM   saldok
   WHERE nls=:sNls and kv=980") and SqlFetchNext(hSqlAux(), nFetchRes))
.head 17 -  Set sErrMes = sErrMes || '   Счет ' || sNls ||
' не доступен для Кредита (0k)
'
.head 17 -  Set bErr = TRUE
.head 16 +  Else If nDk = 1 and not (SqlPrepareAndExecute(hSqlAux(), "
     SELECT nls
     INTO   :sTmpNls
     FROM   saldod
     WHERE  nls=:sNls and kv=980") and SqlFetchNext(hSqlAux(), nFetchRes))
.head 17 -  Set sErrMes = sErrMes || '   Счет ' || sNls ||
' не доступен для Дебета (1d)
'
.head 17 -  Set bErr = TRUE
.head 16 +  Else If nDk > 1 and not (SqlPrepareAndExecute(hSqlAux(), "
     SELECT nls
     INTO   :sTmpNls
     FROM   saldo
     WHERE  nls=:sNls and kv=980 and dazs is null") and SqlFetchNext(hSqlAux(), nFetchRes))
.head 17 -  Set sErrMes = sErrMes || '   Счет ' || sNls ||
' не доступен (закрыт)
'
.head 17 -  Set bErr = TRUE
.head 16 -  ! sNlsk
.head 16 +  If nNm = 1 or nNm > 1000
.head 17 +  If nDk = 0 and sMfo=sBankMfo and not (SqlPrepareAndExecute(hSqlAux(), "
   SELECT nls
   INTO   :sTmpNls
   FROM   saldod
   WHERE nls=:sNlsk and kv=980") and SqlFetchNext(hSqlAux(), nFetchRes))
.head 18 -  Set sErrMes = sErrMes || '   Счет ' || sNlsk ||
' не доступен для Дебета (0d)
'
.head 18 -  Set bErr = TRUE
.head 17 +  Else If nDk = 1 and sMfo=sBankMfo and not (SqlPrepareAndExecute(hSqlAux(), "
     SELECT nls
     INTO   :sTmpNls
     FROM   saldok
     WHERE  nls=:sNlsk and kv=980") and SqlFetchNext(hSqlAux(), nFetchRes))
.head 18 -  Set sErrMes = sErrMes || '   Счет ' || sNlsk ||
' не доступен для Кредита (1k)
'
.head 18 -  Set bErr = TRUE
.head 17 +  Else If nDk > 1 and not (SqlPrepareAndExecute(hSqlAux(), "
     SELECT nls
     INTO   :sTmpNls
     FROM   saldo
     WHERE  nls=:sNlsk and kv=980 and dazs is null") and SqlFetchNext(hSqlAux(), nFetchRes))
.head 18 -  Set sErrMes = sErrMes || '   Счет ' || sNlsk ||
' не доступен (закрыт)
'
.head 18 -  Set bErr = TRUE
.head 15 +  If bErr
.head 16 -  Call SalMessageBox('Документ на сумму ' || Str(nS/100) || ' не принят.
' || sErrMes, 'Внимание !', MB_Ok | MB_IconExclamation)
.head 15 -  ! Modify by ANNY 18-10-2001
.head 15 +  Else
.head 16 +  If nVob = 96 or nVob = 99
.head 17 +  ! If nVob = 96
.head 18 -  Set dTemp = SalDateMonthBegin(dfBD)-1
.head 17 +  ! Else
.head 18 -  Set dTemp = SalDateYearBegin(dfBD)-1
.head 17 -  Set dTemp = IifD(nVob=96, SalDateMonthBegin(dfBD), SalDateYearBegin(dfBD)) - 1
.head 17 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT max(fdat)
     INTO   :dValu
     FROM   fdat
     WHERE  fdat<=:dTemp")
.head 17 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 18 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   fdat (fdat)
     VALUES (:dTemp)")
.head 18 -  Set dValu = dTemp
.head 16 +  Else
.head 17 -  ! Set dValu = dfBD
.head 17 -  !
.head 17 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT fdat
     FROM   fdat
     WHERE  fdat=:dValu")
.head 17 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 18 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   fdat (fdat)
     VALUES (:dValu)")
.head 16 +  If dValu != dfBD
.head 17 -  ! Call Pl_dat(dValu) ! Установить банковскую дату
.head 16 +  ! If bNBU and (sTT = '085' or sTT = '086' or VisArrayFindString(smDK0KASSA, sTT) >= 0 or
   VisArrayFindString(smDK1KASSA, sTT) >= 0) and SqlPrepareAndExecute(hSqlAux(), T("
   SELECT vob
   INTO   :nVOBtts
   FROM   tts_vob
   WHERE  tt=:sTT")) and SqlFetchNext(hSqlAux(), nFetchRes)
.head 17 -  Set nVob = nVOBtts
.head 17 -  Set tbl1.colVOB = nVob
.head 16 -  Set sTT = IifS(Len(sTTS)=3, sTTS, sTT)
.head 16 -  If SqlPrepareAndExecute(hSqlAux(), T("
   SELECT substr(flags,13,1)
   INTO   :sSTP
   FROM   tts
   WHERE  tt=:sTT")) and SqlFetchNext(hSqlAux(), nFetchRes)
.head 16 +  Else
.head 17 -  Set sSTP = '0'
.head 16 -  Set tbl1.colSTP = Max(Val(sSTP)-1, 0)
.head 16 +  If bNBU and nSk>0 and bVOBfromTTSforKASSA and SqlPrepareAndExecute(hSqlAux(), T("
   SELECT vob
   INTO   :nVOBtts
   FROM   tts_vob
   WHERE  tt=:sTT")) and SqlFetchNext(hSqlAux(), nFetchRes)
.head 17 -  Set nVob = nVOBtts
.head 17 -  Set tbl1.colVOB = nVob
.head 16 +  If not bPDP
.head 17 -  Set sSign = ''
.head 17 -  Set sKisp = GetIdOper()
.head 16 -  ! Call Debug('nDk='   || Str(nDk) || PutCrLf() ||
           'sMfo='  || sMfo     || PutCrLf() ||
           'sNls='  || sNls     || PutCrLf() ||
           'sNlsk=' || sNlsk)
.head 16 -  Call Ref(nRef)
.head 16 -  ! Call ccDoc.SetDoc(nRef, sTT, nDk, nVob, sNd, dDat, dPat, dValu, dValu, sNls, sPlat, sBankMfo, '',
     980, nS, sKod, sNlsk, sPolu, sMfo, '', 980, nS, sKodB, sNaz1, sVspo, sKisp, sSign, nSk, 0)
.head 16 -  Call ccDoc.SetDoc(nRef, sTT, nDk, nVob, sNd, dDat, dValu, dValu, dValu, sNls, sPlat, sBankMfo, '',
     980, nS, sKod, sNlsk, sPolu, sMfo, '', 980, nS, sKodB, sNaz1, sVspo, sKisp, sSign, nSk, 0)
.head 16 -  Set ccDoc.m_sDrec = sVspo
.head 16 +  If bPDP
.head 17 -  Set ccDoc.m_sRef_A = Str(nRefOper)
.head 16 -  Set dfAll = dfAll + 1
.head 16 -  ! Call Debug('iDoc-')
.head 16 -  Set b0 = ccDoc.iDoc()
.head 16 -  ! Call Debug('iDoc+')
.head 16 -  Set b1 = TRUE
.head 16 -  Set b2 = b1
.head 16 -  Set b3 = b1
.head 16 -  Set b4 = b1
.head 16 +  If b0
.head 17 +  If Len(sKASVID) > 0
.head 18 -  Set b1 = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO   operw (ref,tag,value)
    VALUES (:nRef,'ATRT',:sKASVID)")) !! ccDoc.m_nRef
.head 17 +  If Len(sKASDOKsn) > 0
.head 18 -  Set b2 = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO   operw (ref,tag,value)
    VALUES (:nRef,'PASP',:sKASDOKsn)"))
.head 17 +  If Len(sKASFIO) > 0
.head 18 -  Set b3 = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO   operw (ref,tag,value)
    VALUES (:nRef,'FIO',:sKASFIO)"))
.head 17 +  If b1 and b2 and b3
.head 18 -  ! вставка TAGов из файла дополнительных реквизитов
.head 18 -  Set b4 = TRUE
.head 18 -  Call VisArrayCopy(nmREF, nmREFrab, DT_Number)
.head 18 -  Call VisArrayCopy(smTAG, smTAGrab, DT_String)
.head 18 -  Call VisArrayCopy(smVALUE, smVALUErab, DT_String)
.head 18 -  Set bEE = TRUE
.head 18 +  While bEE
.head 19 -  Call SalArrayDimCount(nmREFrab, nII)
.head 19 +  If nII > 0
.head 20 -  Set nII = VisArrayFindNumber(nmREFrab, nRefOper)
.head 20 +  If nII >= 0 ! found !!!
.head 21 -  Set sTAG = smTAGrab[nII]
.head 21 -  Set sVALUE = smVALUErab[nII]
.head 21 -  Set b4 = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO   operw (ref,tag,value)
    VALUES (:nRef,:sTAG,:sVALUE)"))
.head 21 -  Call VisArrayDeleteItem(nmREFrab, nII, DT_Number)
.head 21 -  Call VisArrayDeleteItem(smTAGrab, nII, DT_String)
.head 21 -  Call VisArrayDeleteItem(smVALUErab, nII, DT_String)
.head 21 -  Set bEE = b4
.head 20 +  Else
.head 21 -  Set bEE = FALSE
.head 19 +  Else
.head 20 -  Set bEE = FALSE
.head 17 +  Else
.head 18 -  Call SaveErrorToLog('ош. вставки в OPERw док №'|| sNd || ': ' || sNls || '(980) ' || Str(nS)
     || ' -> ' || sMfo || ' ' || sNlsk || '(980) ' || Str(nS) || '[' || sPolu || '],[' ||
     sNaz1 || '] ' || GetIdOper())
.head 18 -  Call SqlRollback(hSql())
.head 16 +  If b0 and b1 and b2 and b3 and b4
.head 17 +  If ccDoc.oDoc()
.head 18 -  ! Call Debug('oDoc+?')
.head 18 +  If SqlPrepareAndExecute(hSqlB, "
   UPDATE " || Left(sTempDbf, Len(sTempDbf)-4) || "
   SET    sos=9
   WHERE  CURRENT OF " || Left(sTempDbf, Len(sTempDbf)-4))
.head 19 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE oper
     SET    prty=:tbl1.colSTP
     WHERE  ref=:nRef")
.head 19 -  Call SqlCommit(hSql())
.head 19 -  Call SaveInfoToLog('принят док. REF=' || Str(nRef) || ': ' || sNls || '(980) ' || Str(nS) ||
     ' -> ' || sMfo || ' ' || sNlsk || '(980) ' || Str(nS) || '[' || sPolu || '],[' ||
     sNaz1 || '] ' || GetIdOper())
.head 19 -  ! Call Pl_dat(dfBD) ! Возвратить банковскую дату
.head 19 -  Set tbl1.colREF98 = nRef
.head 19 -  Set tbl1.colTT = sTT
.head 19 -  ! (COLOR_DarkGreen) оплачен
.head 19 -  Set tbl1.colKomm = 'ПРИНЯТ'
.head 19 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_DarkGreen)
.head 19 -  Set dfCurrent = dfCurrent + 1
.head 19 +  If Mod(n99, 10) = 0 Or Mod(n99, 10) = 7
.head 20 -  Call SqlPrepareAndExecute(hSqlB, "
     UPDATE " || Left(sTempDbf, Len(sTempDbf)-4) || "
     SET    sos=9,ref99bm=:nRef
     WHERE  CURRENT OF " || Left(sTempDbf, Len(sTempDbf)-4))
.head 18 +  Else
.head 19 -  Call SaveErrorToLog('ош. UPDATE ' || Left(sTempDbf, Len(sTempDbf)-4) || ' SET sos=9 док №'
     || sNd || ': ' || sNls || '(980) ' || Str(nS) || ' -> ' || sMfo || ' ' || sNlsk ||
     '(980) ' || Str(nS) || '[' || sPolu || '],[' || sNaz1 || '] ' || GetIdOper())
.head 19 -  Call SqlRollback(hSql())
.head 17 +  Else
.head 18 -  Call SaveErrorToLog('ош. при оплате док №' || sNd || ': ' || sNls || '(980) ' || Str(nS) ||
     ' -> ' || sMfo || ' ' || sNlsk || '(980) ' || Str(nS) || '[' || sPolu || '],[' || sNaz1 ||
     '] ' || GetIdOper())
.head 18 -  Call SqlRollback(hSql())
.head 18 +  If bPDP and not g_bSignInited ! ccDoc.m_bEscPin
.head 19 -  Call SaveInfoToLog('Прием документов из ' || dfFile || ' ПРЕРВАН')
.head 19 -  ! Call DebugN(ccDoc.m_nTim)
.head 19 -  Call SalEnableWindow(pbExit)
.head 19 -  Call SalEnableWindow(pbExecute)
.head 19 -  Break
.head 16 +  Else
.head 17 +  If not b4
.head 18 -  Call MessageNoWait('ош. вставки в OPERw (доп. реквизит ' || SalStrTrimX(sTAG) || ') док №' ||
     sNd || ':' || PutCrLf() || sNls || '(980) ' || Str(nS) || ' ->' || PutCrLf() || sMfo ||
     ' ' || sNlsk || '(980) ' || Str(nS) || PutCrLf() || '[' || sPolu || ']' || PutCrLf() ||
     '[' || sNaz1 || '] ' || PutCrLf() || GetIdOper(), 'ОШИБКА !!!', 17, 1)
.head 18 -  Call SqlRollback(hSql())
.head 16 -  ! Call Pl_dat(dfBD) ! Возвратить банковскую дату
.head 14 -  Call SalTblSetCellTextColor(tbl1.colNPP, COLOR_Charcoal, TRUE)
.head 14 -  Set nPos = nPos + nDelta
.head 14 -  Set nRecn = nRecn + 1
.head 14 +  If Int(nPos) != nTek
.head 15 -  Set nTek = Int(nPos)
.head 15 -  Set nTimeCurrent = SalDateHour(SalDateCurrent())*3600 + SalDateMinute(SalDateCurrent())*60 +
    SalDateSecond(SalDateCurrent())
.head 15 -  Set nTimeEnd = Int(100 * (nTimeCurrent-nTimeStart) / nPos + nTimeStart)
.head 15 -  Set nHour = Int(nTimeEnd/3600)
.head 15 -  Set nTemp = nTimeEnd - nHour*3600
.head 15 -  Set nMinu = Int(nTemp/60)
.head 15 -  Set dfStart = dfStart
.head 15 -  Set dfEnd = 'Финиш: ' || Right(Str(100+nHour), 2) || ':' || Right(Str(100+nMinu), 2) || ':' ||
    Right(Str(100+nTemp-nMinu*60), 2) || ' (прогноз)'
.head 15 -  Set dfReccount = dfReccount
.head 15 -  Set dfCurrent = dfCurrent
.head 15 -  Set dfAll = dfAll
.head 14 -  Call ccProgressBar.SetProgress(nPos)
.head 14 -  Call SalUpdateWindow(hWndForm)
.head 13 -  Call ccProgressBar.SetProgress(100)
.head 13 -  Call SqlCommitEx(hSql(), 'OK')
.head 13 -  Call SqlCommit(hSqlB)
.head 13 -  Call SqlDisconnect(hSqlA)
.head 13 -  Call SqlDisconnect(hSqlB)
.head 13 -  Call SaveInfoToLog('Прием документов из ' || dfFile || ' ОКОНЧЕН')
.head 13 -  Set dfDone = "Готово"
.head 13 -  Set dfEnd = Left(dfEnd, 15)
.head 13 +  If dfCurrent > 0
.head 14 -  ! сформировать файл оплаченных документов
.head 14 -  Set nCurrentRow = nJur
.head 14 -  Set nP = 1
.head 14 -  Set nItog = 0
.head 14 -  Set sFr = GetPrnDir() || '\\M' || Right(Str(SalDateMonth(dBat)+100), 2) || Right(Str(
    SalDateDay(dBat)+100), 2) || Right(Str(SalDateHour(SalDateCurrent())+100), 2) || Subs(Str(
    SalDateMinute(SalDateCurrent())+100), 2, 1) || '.' || Right(Str(SalDateMinute(
    SalDateCurrent())), 1) || Right(Str(SalDateSecond(SalDateCurrent())+100), 2)
.head 14 -  Call SalFileOpen(hF, sFr, OF_Create | OF_Write)
.head 14 -  Set sBuff = StrWinToDosX(SalStrTrimX(GetBankName()) || ' ' || SalStrTrimX(sBankMfo) || PutCrLf() ||
    'Дата и время формирования ' || SalFmtFormatDateTime(SalDateCurrent(), 'dd/MM/yyyy ') ||
    Right('0' || SalFmtFormatDateTime(SalDateCurrent(), 'hhhh:mm:ss'), 8) || PutCrLf() || PutCrLf() ||
    Spac(15) || 'Реестр оплаченных платежных документов' || PutCrLf() || Spac(15) || '(' || dfFile ||
    ') сеанс (с ' || Right(dfStart, 8) || ' по ') || Right(dfEnd, 8) || ')' || PutCrLf() ||
    Repl('-', 69) || PutCrLf()
.head 14 -  Call SalFileWrite(hF, sBuff, Len(sBuff))
.head 14 +  While SalTblFindNextRow(tbl1, nCurrentRow, 0, 0)
.head 15 -  Call SalTblSetFocusRow(tbl1, nCurrentRow)
.head 15 -  Set nColor = SalColorGet(tbl1.colNLSA, COLOR_IndexCellText)
.head 15 +  If nColor = COLOR_DarkGreen
.head 16 -  Set sLev = tbl1.colTT || ' реф.' || Str(tbl1.colREF98) || ', док.' || SalStrTrimX(tbl1.colND) ||
    ', оп.' || Str(tbl1.colVOB)
.head 16 -  Set sBuff = PadR(Str(nP) || '.', 4) || sBankMfo || ' ' || PadR(tbl1.colNLSA || '(' || Right(
    Str(tbl1.colVALA+1000), 3) || ')', 20) || StrWinToDosX(SalStrTrimX(tbl1.colNAMA) || PutCrLf()
    || '    ' || IifS(Val(tbl1.colMFOB)=0, sBankMfo, tbl1.colMFOB) || ' ' ||
    PadR(tbl1.colNLSB || '(' || Right(Str(tbl1.colVALB+1000), 3) || ')', 20) ||
    SalStrTrimX(tbl1.colNAMB) || PutCrLf() || sLev || PadL('сумма ' ||
    SalNumberToStrX(tbl1.colS, 2), 69-Len(sLev)) || PutCrLf() || Perenos(tbl1.colNAZN, 65, 4)) ||
    PutCrLf()
.head 16 -  Call SalFileWrite(hF, sBuff, Len(sBuff))
.head 16 -  Set nP = nP + 1
.head 16 -  Set nItog = nItog + tbl1.colS
.head 14 -  Set sBuff = Repl('-', 69) || PutCrLf() || StrWinToDosX('    Итого: ' || PadR(Str(nP-1), 20) ||
    'На сумму:') || PadL(SalNumberToStrX(nItog, 2), 29) || PutCrLf() || Repl('-', 69) || Repl(
    PutCrLf(), 3)
.head 14 -  Call SalFileWrite(hF, sBuff, Len(sBuff))
.head 14 -  Call SalFileClose(hF)
.head 13 -  Call SalMessageBeep(-1)
.head 13 +  If dfAll > dfCurrent
.head 14 -  ! удалить файл в NOT (по запросу)
.head 14 +  If VisMessageBox('ВНИМАНИЕ ! Файл ' || dfFile || '. Обработаны не ВСЕ выбранные документы. Примите' ||
   ' меры для исправления ошибок. Переместить в NOT ?', 'ЗАПРОС', MBF_IconQuestion, hBtns, 2) = 1
                                                                                              ! ID_Yes
.head 15 -  Call SalWaitCursor(FALSE)
.head 15 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 15 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 15 +  If File(sODBCDir || '\\TempODBC.Dir\\' || sVspoAdd)
.head 16 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || sVspoAdd, sODBCDir || '\\ArchivNO\\' ||
     sVspoAdd)
.head 16 +  If File(sODBCDir || '\\ArchivNO\\' || sVspoAdd)
.head 17 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sVspoAdd)
.head 15 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 16 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 16 +  If File(sODBCDir || '\\' || sVspoAdd)
.head 17 -  Call VisFileDelete(sODBCDir || '\\' || sVspoAdd)
.head 16 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 16 -  Call FileZNListBox()
.head 14 +  Else
.head 15 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf, sODBCDir || '\\' || dfFile)
.head 15 +  If File(sODBCDir || '\\' || dfFile)
.head 16 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 15 +  If File(sODBCDir || '\\ArchivNO\\' || sVspoAdd)
.head 16 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sVspoAdd)
.head 14 -  Call SalEnableWindow(pbExit)
.head 14 -  Call SalEnableWindow(pbExecute)
.head 14 -  Break
.head 13 +  Else
.head 14 +  If File(sODBCDir || '\\' || dfFile)
.head 15 -  Call SalWaitCursor(FALSE)
.head 15 -  ! записать в архив OK и удалить
.head 15 +  If VisMessageBox('ВНИМАНИЕ ! Файл ' || dfFile || ' обработан. Записать в АРХИВ(Ok) ?', 'ЗАПРОС',
   MBF_IconQuestion, hBtns, 2) = 1 ! ID_Yes
.head 16 -  Call SalWaitCursor(TRUE)
.head 16 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivOK')
.head 16 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf, sODBCDir || '\\ArchivOK\\' || dfFile)
.head 16 +  If File(sODBCDir || '\\ArchivOK\\' || dfFile)
.head 17 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 17 +  If File(sODBCDir || '\\' || sVspoAdd)
.head 18 -  Call VisFileDelete(sODBCDir || '\\' || sVspoAdd)
.head 17 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 17 -  Call FileZNListBox()
.head 16 +  If File(sODBCDir || '\\TempODBC.Dir\\' || sVspoAdd)
.head 17 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || sVspoAdd, sODBCDir || '\\ArchivOK\\' ||
     sVspoAdd)
.head 17 +  If File(sODBCDir || '\\ArchivOK\\' || sVspoAdd)
.head 18 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sVspoAdd)
.head 15 +  Else
.head 16 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf, sODBCDir || '\\' || dfFile)
.head 16 +  If File(sODBCDir || '\\' || dfFile)
.head 17 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 16 +  If File(sODBCDir || '\\TempODBC.Dir\\' || sVspoAdd)
.head 17 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sVspoAdd)
.head 16 -  Call SalEnableWindow(pbExit)
.head 16 -  Call SalEnableWindow(pbExecute)
.head 16 -  Break
.head 15 -  Call SalWaitCursor(TRUE)
.head 14 +  If File(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 15 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 13 -  Call SalSetFocus(tbl1)
.head 13 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 13 -  Call FileZNListBox()
.head 13 -  Set nJur = nNewRow
.head 13 -  ! Call SalDisableWindow(pbExecute)
.head 11 +  Else
.head 12 -  Call MessageAttention('Ошибка подсоединения к Базе данных: ' || SqlDatabase)
.head 10 +  Else
.head 11 -  ! Call MessageAttention('Нет файла: ' || sODBCDir || dfFile || ' или он занят другим пользователем.')
.head 11 +  If VisMessageBox('Файл ' || dfFile || ' возможно занят другим пользователем. Удалить в NOT ?', 'ЗАПРОС',
   MBF_IconQuestion, hBtns, 2) = 1 ! ID_Yes
.head 12 -  Call SalWaitCursor(TRUE)
.head 12 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 12 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 12 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 11 -  Break
.head 9 +  Else
.head 10 -  Call MessageAttention('Нет каталога: ' || sODBCDir)
.head 9 -  ! Call SalEnableWindow(pbExecute)
.head 9 -  Call SalEnableWindow(pbExit)
.head 9 -  Call SalSetFocus(pbExit)
.head 9 +  If not cbAll
.head 10 -  Break
.head 8 -  Call SalWaitCursor(FALSE)
.head 7 +  Else
.head 8 -  Call Debug("День закрыт !")
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход (F10)
.head 4 -  Window Location and Size
.head 5 -  Left:   1.867"
.head 5 -  Top:    6.238"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: F10
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Call SalEndDialog(hWndForm, FALSE)
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 3 -  Frame
.head 4 -  Resource Id: 49994
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    5.571"
.head 5 -  Width:  14.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.31"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Drop-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 3 -  Background Text: Имя файла импорта
.head 4 -  Resource Id: 49995
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    5.917"
.head 5 -  Width:  3.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Combo Box: dfFile
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.367"
.head 5 -  Top:    5.905"
.head 5 -  Width:  4.033"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.06"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: 12
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 +  Check Box: cbAll
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Принять ВСЕ файлы
.head 4 -  Window Location and Size
.head 5 -  Left:   0.367"
.head 5 -  Top:    6.571"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Teal
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfStart
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.683"
.head 6 -  Top:    6.095"
.head 6 -  Width:  6.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfEnd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.683"
.head 6 -  Top:    6.345"
.head 6 -  Width:  6.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfDone
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.683"
.head 6 -  Top:    5.679"
.head 6 -  Width:  6.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Purple
.head 5 -  Background Color: Gray
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.405"
.head 6 -  Width:  14.333"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.667"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 333333
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colNPP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: N
пп
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.314"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colND
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер
док.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.114"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вид оп.
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMFOA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО-А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.743"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLSA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет-А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.529"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAMA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.А
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.714"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVALA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.414"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMFOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.743"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLSB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.529"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAMB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.Б
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.714"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVALB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.386"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVDATE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата вал.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAZN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назначение пл.
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.357"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colREF98
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Реф.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.857"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Оп.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSTP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Признак
СТП
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.843"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If tbl1.colREF98 = 0 or tbl1.colREF98 = NUMBER_Null
.head 9 -  Set tbl1.colSTP = NUMBER_Null
.head 9 -  Return VALIDATE_Ok
.head 8 +  Else
.head 9 +  If tbl1.colSTP != NUMBER_Null and (tbl1.colSTP < 0 or tbl1.colSTP > 1)
.head 10 -  Call MessageNoWait('Val Признак СТП может быть только 0 или 1 ...', 'ВНИМАНИЕ!', 7, 1)
.head 10 -  Set tbl1.colSTP = nSTP
.head 10 -  Return VALIDATE_Cancel
.head 9 +  Else
.head 10 -  Return VALIDATE_Ok
.head 7 +  ! On SAM_AnyEdit
.head 8 +  If tbl1.colREF98 = 0 or tbl1.colREF98 = NUMBER_Null
.head 9 -  Set tbl1.colSTP = NUMBER_Null
.head 8 +  If tbl1.colSTP != NUMBER_Null and (tbl1.colSTP < 0 or tbl1.colSTP > 1)
.head 9 -  Call MessageNoWait('Any Признак СТП может быть только 0 или 1 ...', 'ВНИМАНИЕ!', 7, 1)
.head 9 -  Return FALSE
.head 7 +  On SAM_Click
.head 8 -  Set nSTP = tbl1.colSTP
.head 5 +  Column: colKomm
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Коммент.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nFocusRow
.head 5 -  Window Handle: hWndCol
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_SingleSelection, TRUE)
.head 5 +  On SAM_Click
.head 6 -  ! Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 6 -  ! Call SalTblSetFocusRow(tbl1, lParam)
.head 6 -  ! Call SalTblSetContext(tbl1, lParam)
.head 6 -  !
.head 6 -  ! Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  ! On SAM_CornerClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  ! On SAM_CornerDoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 6 -  ! Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 6 -  Call SalTblSetContext(tbl1, lParam)
.head 6 -  Call SalTblSetFocusRow(tbl1, lParam)
.head 6 +  If tbl1.colREF98
.head 7 -  Call DocView(hWndMDI, tbl1.colREF98, 2, 0, '')
.head 5 +  ! On SAM_RowHeaderClick
.head 6 -  ! Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 6 -  Call SalSendMsg(tbl1, SAM_Click, 0, 0)
.head 5 +  ! On SAM_RowHeaderDoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  ! On SAM_EndCellTab
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  ! On WM_LbuttonUp
.head 6 -  ! Узнать текущую строку
.head 6 -  ! Call SalTblQueryFocus(tbl1, nFocusRow, hWndCol)
.head 6 -  ! Set nFocusRow = SalTblQueryContext(tbl1)
.head 6 -  ! Почистить все
.head 6 -  Call SalTblSetFlagsAnyRows(tbl1, ROW_Selected, FALSE, 0, 0)
.head 6 -  ! Call SalTblSetFocusRow (tbl1, nFocusRow)
.head 6 -  ! Стать на нее (что выше)
.head 6 -  ! Call SalTblSetRowFlags(tbl1, nFocusRow, ROW_Selected, FALSE)
.head 6 -  ! Call SalSendMsg(tbl1, SAM_RowHeaderClick, 0, Max(TBL_MaxRow, nFocusRow+1))
.head 5 +  On VTM_KeyUp
.head 6 -  ! Call SalTblSetFlagsAnyRows(tbl1, ROW_Selected, FALSE, 0, 0)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 +  On WM_NCMouseMove ! 160
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 3 +  Pushbutton: pbBD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.783"
.head 5 -  Top:    5.321"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: F12
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalIsWindowEnabled(dfBD)
.head 7 -  Call SalDisableWindow(dfBD)
.head 6 +  Else
.head 7 -  Call SalEnableWindow(dfBD)
.head 7 -  Call SalSetFocus(dfBD)
.head 3 +  Custom Control: ccProgressBar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.117"
.head 6 -  Top:    5.119"
.head 6 -  Width:  12.567"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Gray
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Data Field: dfBD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   12.717"
.head 6 -  Top:    5.119"
.head 6 -  Width:  1.667"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfBD > dBat
.head 7 -  Call MessageNoWait('Локальная дата не может быть больше текущей банковской даты !', 'ОШИБКА', 30, 1)
.head 7 -  Return VALIDATE_Cancel
.head 3 +  ! ctb_pbDetail: pbDetail
.winattr class Pushbutton:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDetail
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   13.883"
.head 5 -  Top:    0.071"
.head 5 -  Width:  0.43"
.head 5 -  Width Editable? No
.head 5 -  Height: 0.317"
.head 5 -  Height Editable? No
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If tbl1.colREF98
.head 7 -  Call DocView(hWndMDI, tbl1.colREF98, 2, 0, '')
.head 3 +  Data Field: dfDir
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.35"
.head 6 -  Top:    5.607"
.head 6 -  Width:  4.067"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.286"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Каталог импорта
.head 4 -  Resource Id: 18716
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    5.607"
.head 5 -  Width:  3.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   13.743"
.head 5 -  Top:    0.06"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SaveSTP()
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, IifS(GetLang()='RUS', 'Сохранить призак СТП',
       IifS(GetLang()='UKR', 'Зберегти признак СТП', 'Save STP')))
.head 2 +  Functions
.head 3 +  Function: FileZNListBox
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: smFiles[*]
.head 5 -  Number: nI
.head 5 -  Number: nFiles
.head 4 +  Actions
.head 5 -  Set nFiles = VisDosEnumFiles(sODBCDir || '\\*.*', FA_Standard, smFiles)
.head 5 -  Set nI = 0
.head 5 -  Call SalListClear(dfFile)
.head 5 +  While nI < nFiles
.head 6 -  Call SalListAdd(dfFile, smFiles[nI])
.head 6 -  Set nI = nI + 1
.head 5 -  Call SalListSetSelect(dfFile, 0)
.head 5 -  Call SalSendMsg(dfFile, SAM_Click, 0, 0)
.head 3 +  Function: Perenos
.head 4 -  Description: Разбиение назначения платежа
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sTxt	! текст
.head 5 -  Number: nLen	! длина
.head 5 -  Number: nSpaces ! количество пробелов слева
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sNana[*]
.head 5 -  Number: nL
.head 5 -  String: sI
.head 5 -  Number: nJ
.head 5 -  Number: nC
.head 5 -  String: sRes
.head 4 +  Actions
.head 5 -  Set nL = 0
.head 5 -  Set sI = SalStrTrimX(sTxt)
.head 5 +  Loop
.head 6 +  If Len(sI) = 0
.head 7 -  Break
.head 6 +  If Len(sI) < nLen+1
.head 7 -  Set sNana[nL] = sI
.head 7 -  Break
.head 6 -  Set nJ = nLen + 1
.head 6 -  Set sNana[nL] = Left(sI, nJ)
.head 6 +  While nJ > 0
.head 7 +  If Subs(sNana[nL], nJ, 1) = ' ' or Subs(sNana[nL], nJ, 1) = ',' or Subs(sNana[nL], nJ, 1) = '.' or
   Subs(sNana[nL], nJ, 1) = ';' or Subs(sNana[nL], nJ, 1) = ':' or Subs(sNana[nL], nJ, 1) = '-'
.head 8 -  Set sNana[nL] = SalStrTrimX(Left(sNana[nL], nJ))
.head 8 -  Set sI = SalStrTrimX(Subs(sI, nJ+1, Len(sI)-nJ))
.head 8 -  Break
.head 7 -  Set nJ = nJ - 1
.head 7 +  If nJ = 0
.head 8 -  Set sI = SalStrTrimX(Subs(sI, nLen+1, Len(sI)-nLen))
.head 6 -  Set nL = nL + 1
.head 5 -  Set nC = 0
.head 5 -  Set sRes = ''
.head 5 +  While nC <= nL
.head 6 -  Set sRes = sRes || Spac(nSpaces) || sNana[nC] || PutCrLf()
.head 6 -  Set nC = nC + 1
.head 5 -  Return sRes
.head 3 +  Function: FScan
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sPar
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sStr
.head 5 -  Number: nNum
.head 5 -  Boolean: bRet
.head 4 +  Actions
.head 5 -  Set sStr = sPar
.head 5 -  Set bRet = TRUE
.head 5 +  Loop
.head 6 +  If sStr
.head 7 -  Call SalStrFirstC(sStr, nNum)
.head 7 -  ! Call DebugN(nNum)
.head 7 -  Set i = 0
.head 7 +  While i <= 32
.head 8 +  If SalNumberToChar(nNum) = msSimv[i]
.head 9 -  ! Call DebugN(i)
.head 9 -  Set bRet = FALSE
.head 9 -  Break
.head 8 -  Set i = i + 1
.head 6 +  Else
.head 7 -  Break
.head 6 +  If not bRet
.head 7 -  Break
.head 5 -  Return bRet
.head 3 +  Function: SaveSTP
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRow
.head 4 +  Actions
.head 5 -  ! идти по таблице + UPDATE oper WHERE ref=tbl1.colREF98
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(tbl1, nRow, 0, 0)
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 +  If not (tbl1.colREF98 = 0 or tbl1.colREF98 = NUMBER_Null)
.head 7 +  If SqlPrepareAndExecute(hSql(), "
   UPDATE oper
   SET    prty=:tbl1.colSTP
   WHERE  ref=:tbl1.colREF98")
.head 8 -  Call SqlCommit(hSql())
.head 6 -  Call SalTblSetRowFlags(tbl1, nRow, ROW_Edited, FALSE)
.head 5 -  Return TRUE
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  : ccDoc
.head 4 -  Class: cDoc
.head 3 -  String: ND
.head 3 -  String: NLS
.head 3 -  String: NLSK
.head 3 -  ! Number: KVS
.head 3 -  Number: SK
.head 3 -  Number: REF
.head 3 -  Number: ISV
.head 3 -  String: NAZN
.head 3 -  String: sTmp
.head 3 -  Number: nCount
.head 3 -  Number: NS
.head 3 -  String: sAn
.head 3 -  String: sNbw
.head 3 -  Number: nNls
.head 3 -  String: sMfo
.head 3 -  String: sMdl
.head 3 -  Number: nMfop
.head 3 -  Number: nFetchRes
.head 3 -  String: sBlk
.head 3 -  String: sFv
.head 3 -  String: sFs
.head 3 -  String: sBankDay
.head 3 -  Number: nDocs
.head 3 -  Sql Handle: hSqlA
.head 3 -  Sql Handle: hSqlB
.head 3 -  Sql Handle: hSqlC
.head 3 -  Number: nPos
.head 3 -  Number: nDelta
.head 3 -  Number: nRecCount
.head 3 -  String: strMessage
.head 3 -  Number: nNm
.head 3 -  Number: nDk
.head 3 -  Number: nMfo
.head 3 -  String: sNd
.head 3 -  Number: nVob
.head 3 -  String: sNls
.head 3 -  String: sNlsk
.head 3 -  Number: nSk
.head 3 -  Number: nS
.head 3 -  Date/Time: dDat
.head 3 -  Date/Time: dPat
.head 3 -  Date/Time: dBat
.head 3 -  String: sPlat
.head 3 -  String: sPolu
.head 3 -  String: sNaz1
.head 3 -  String: sVspo
.head 3 -  String: sKod
.head 3 -  String: sKodB
.head 3 -  String: sKisp
.head 3 -  String: sSign
.head 3 -  ! Long String: lsSign
.head 3 -  ! Number: nRow
.head 3 -  Number: nRef
.head 3 -  String: sODBCDir
.head 3 -  Date/Time: dTmp
.head 3 -  Number: nNp
.head 3 -  Number: n99
.head 3 -  Number: nSos
.head 3 -  !
.head 3 -  Number: nRef99bm
.head 3 -  Date/Time: dVdate
.head 3 -  !
.head 3 -  Number: nNewRow
.head 3 -  !
.head 3 -  Number: nTimeStart
.head 3 -  Number: nTimeCurrent
.head 3 -  Number: nTimeEnd
.head 3 -  Number: nHour
.head 3 -  Number: nMinu
.head 3 -  Number: nTemp
.head 3 -  Number: nTek
.head 3 -  Number: nRecn
.head 3 -  !
.head 3 -  Number: nCurrentRow
.head 3 -  Number: nP
.head 3 -  Number: nItog
.head 3 -  File Handle: hF
.head 3 -  Number: nColor
.head 3 -  String: sBuff
.head 3 -  String: sFr
.head 3 -  String: sTT
.head 3 -  String: sLev
.head 3 -  !
.head 3 -  Date/Time: dTemp
.head 3 -  Date/Time: dValu
.head 3 -  !
.head 3 -  Boolean: bNBU
.head 3 -  Number: nVOBtts
.head 3 -  !
.head 3 -  Date/Time: dTempDate
.head 3 -  !
.head 3 -  Number: hBtnYes
.head 3 -  Number: hBtnNo
.head 3 -  Number: hBtns[*]
.head 3 -  Number: nJur
.head 3 -  String: sTempDbf
.head 3 -  !
.head 3 -  String: sKASFIO
.head 3 -  String: sKASDOKsn
.head 3 -  String: sKASVID
.head 3 -  String: sKASDOK
.head 3 -  String: sKASSER
.head 3 -  String: sKASNDOK
.head 3 -  Boolean: b1
.head 3 -  Boolean: b2
.head 3 -  Boolean: b3
.head 3 -  !
.head 3 -  String: sSelectOper
.head 3 -  ! переменные для проверки реквизитов
.head 3 -  Boolean: bErr
.head 3 -  Boolean: bErrNLS
.head 3 -  String: sErrMes
.head 3 -  Number: i
.head 3 -  String: msSimv[33]
.head 3 -  String: sSAB
.head 3 -  String: sTmpNls
.head 3 -  !
.head 3 -  Number: nKw
.head 3 -  !
.head 3 -  File Handle: hF_
.head 3 -  String: sS
.head 3 -  !
.head 3 -  String: sTemp
.head 3 -  Number: n3
.head 3 -  Number: nC
.head 3 -  Number: nI
.head 3 -  String: sNLSKASSA
.head 3 -  String: smNLSKASSA[*]
.head 3 -  String: smDK0KASSA[*]
.head 3 -  String: smDK1KASSA[*]
.head 3 -  !
.head 3 -  Number: nmREF[*]
.head 3 -  Number: nREF
.head 3 -  String: smTAG[*]
.head 3 -  String: sTAG
.head 3 -  String: smVALUE[*]
.head 3 -  Number: nmREFrab[*]
.head 3 -  String: smTAGrab[*]
.head 3 -  String: smVALUErab[*]
.head 3 -  String: sVALUE
.head 3 -  Number: nII
.head 3 -  Number: nRefOper
.head 3 -  Boolean: b4
.head 3 -  Boolean: bEE
.head 3 -  Number: nRec
.head 3 -  !
.head 3 -  String: sTTS
.head 3 -  Number: nIt
.head 3 -  !
.head 3 -  String: sVspoAdd
.head 3 -  !
.head 3 -  String: sVOBfromTTSforKASSA
.head 3 -  Boolean: bVOBfromTTSforKASSA
.head 3 -  !
.head 3 -  String: sPDPmoper
.head 3 -  Boolean: bPDP
.head 3 -  ! переменные для проверки ЭЦП на файл
.head 3 -  Number: nErrMsgSize
.head 3 -  String: szErrMsg
.head 3 -  Number: nSignRes
.head 3 -  File Handle: hFileData
.head 3 -  Boolean: mustProcess
.head 3 -  !
.head 3 -  String: sSTP
.head 3 -  Number: nSTP
.head 3 -  String: sBankMfo
.head 3 -  !
.head 3 -  Number: nD
.head 3 -  String: sVspoD
.head 3 -  !
.head 3 -  Boolean: b0
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call ConPara('PUSH')
.head 4 -  Set hBtnYes = VisMessageLoadButton('&Да', 1)
.head 4 -  Set hBtnNo = VisMessageLoadButton('&Нет', 2)
.head 4 -  Call VisMessageSetBkgdColor(COLOR_Salmon)
.head 4 -  Set hBtns[0] = hBtnYes | MBF_DefButton
.head 4 -  Set hBtns[1] = hBtnNo
.head 4 -  Set sBankDay = GetBankDateEx()
.head 4 -  Set sBankMfo = GetBankMfo()
.head 4 -  Set bNBU = GetGlobalOption('NBUBANK')='1'
.head 4 -  Set dBat = GetBankDate()
.head 4 -  Set dfBD = dBat
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'MoperPath', Left(SalFileGetDrive(), 1) || ':\\BARS98\\ODBC.DSN\\Moper', sODBCDir,
     GetIniFileName())
.head 4 -  Set sODBCDir = IifS(Right(sODBCDir, 1)='\\', Left(sODBCDir, Len(sODBCDir)-1), sODBCDir)
.head 4 -  Call SalGetProfileString('Import', 'NLSKASSA', '', sNLSKASSA, GetIniFileName())
.head 4 -  Call SalGetProfileString('Import', 'VOBfromTTSforKASSA', '1', sVOBfromTTSforKASSA, GetIniFileName())
.head 4 -  Call SalGetProfileString('Import', 'SignOper', '0', sPDPmoper, GetIniFileName())
.head 4 -  Set bPDP = not bNBU and Val(sPDPmoper)=1
.head 4 -  Set bVOBfromTTSforKASSA = Min(Max(Val(sVOBfromTTSforKASSA), 0), 1)=1
.head 4 -  Set dfDir = sODBCDir
.head 4 -  Call SalArraySetUpperBound(smNLSKASSA, 1, -1)
.head 4 -  Call SalArraySetUpperBound(smDK0KASSA, 1, -1)
.head 4 -  Call SalArraySetUpperBound(smDK1KASSA, 1, -1)
.head 4 -  Set sTemp = sNLSKASSA
.head 4 +  If Len(sTemp) > 0
.head 5 -  Set n3 = 0
.head 5 -  Set nC = 0
.head 5 +  Loop
.head 6 -  Set nI = At(',', sTemp)
.head 6 +  If nI = 0
.head 7 +  If Len(sTemp) > 0
.head 8 +  If n3 = 0
.head 9 -  Set smNLSKASSA[nC] = SalStrTrimX(sTemp)
.head 9 -  Set smDK0KASSA[nC] = ''
.head 9 -  Set smDK1KASSA[nC] = ''
.head 8 +  Else If n3 = 1
.head 9 -  Set smDK0KASSA[nC] = SalStrTrimX(sTemp)
.head 9 -  Set smDK1KASSA[nC] = ''
.head 8 +  Else
.head 9 -  Set smDK1KASSA[nC] = SalStrTrimX(sTemp)
.head 7 -  Break
.head 6 +  If n3 = 0
.head 7 -  Set smNLSKASSA[nC] = SalStrTrimX(Left(sTemp, nI-1))
.head 6 +  Else If n3 = 1
.head 7 -  Set smDK0KASSA[nC] = SalStrTrimX(Left(sTemp, nI-1))
.head 6 +  Else
.head 7 -  Set smDK1KASSA[nC] = SalStrTrimX(Left(sTemp, nI-1))
.head 6 -  Set n3 = n3 + 1
.head 6 +  If n3 = 3
.head 7 -  Set nC = nC + 1
.head 7 -  Set n3 = 0
.head 6 -  Set sTemp = Right(sTemp, Len(sTemp)-nI)
.head 4 -  Call FileZNListBox()
.head 4 -  Call SalDisableWindow(dfBD)
.head 4 -  ! Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SalHideWindow(dfStart)
.head 4 -  Call SalHideWindow(dfEnd)
.head 4 -  Call SalSetFocus(pbExit)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_Destroy
.head 4 -  Call ConPara('POP')
.head 4 -  ! Call Pl_dat(dBat)
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  ! Dialog Box: dlg_ImpMoper3
.winattr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Прием документов из R3 в структуре MOPER
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.675"
.head 4 -  Top:    0.552"
.head 4 -  Width:  12.983"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.679"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.end
.head 2 -  Description: Прием документов и оплата документов из MOPERов 'старого' БАРСа (от R3)
.head 2 +  Tool Bar
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Всего:
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.119"
.head 5 -  Width:  1.317"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfReccount
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions
.head 3 -  Background Text: Выбрано:
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.783"
.head 5 -  Top:    0.095"
.head 5 -  Width:  1.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfAll
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions
.head 3 -  Background Text: Обработано:
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.083"
.head 5 -  Top:    0.095"
.head 5 -  Width:  2.267"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfCurrent
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   11.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbExecute
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   4.283"
.head 5 -  Top:    5.988"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If dfFile ! есть ли входные файлы
.head 7 -  Call SalDisableWindow(dfBD)
.head 7 +  If IsBankDayOpen()
.head 8 +  If MessageQuestion('Прием/Оплата ' || IifS(cbAll, 'MOPERов от R3', dfFile) || ' ?') = IDNO
.head 9 -  Return FALSE
.head 8 -  ! Для проверки на недопустимые символы
.head 8 -  Set i = 0
.head 8 +  While i <= 31
.head 9 -  Set msSimv[i] = SalNumberToChar(i)
.head 9 -  Set i = i + 1
.head 8 -  Set msSimv[i] = SalNumberToChar(255)
.head 8 -  !
.head 8 -  Set nJur = TBL_MinRow
.head 8 -  ! организация цикла по COMBOboxУ
.head 8 +  While Len(dfFile) > 0
.head 9 -  Call SalWaitCursor(TRUE)
.head 9 -  Call SalDisableWindow(pbExecute)
.head 9 -  Call SalDisableWindow(pbExit)
.head 9 -  Set dfDone = ""
.head 9 -  Call SalUseRegistry(FALSE, '')
.head 9 -  Call SaveInfoToLog('Прием документов из ' || IifS(cbAll, 'MOPERов от R3', dfFile))
.head 9 -  Call SalFileCreateDirectory(sODBCDir || '\\TempODBC.Dir')
.head 9 -  Set nYear = SalDateYear(dfBD)
.head 9 +  If SqlPrepareAndExecute(hSql(), "
   SELECT count(*)
   INTO :nFi
   FROM zag_r3
   WHERE fn=:dfFile and god=:nYear") and SqlFetchNext(hSql(), nFetchRes) and nFi = 0
.head 10 -  Call SalFileSetCurrentDirectory(sODBCDir)
.head 10 -  Call SalFileCreateDirectory(sODBCDir || '\\TempODBC.Dir')
.head 10 -  Call SalFileSetCurrentDirectory(sODBCDir || '\\TempODBC.Dir')
.head 10 -  Set sTempDbf = 'Db' || Left(SalFmtFormatDateTime(SalDateCurrent(), 'mmmmmm'), 2) || SalFmtFormatDateTime(
    SalDateCurrent(), 'ssmm') || '.Dbf'
.head 10 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 10 -  Set SqlDatabase = 'dBase_Files'
.head 10 +  If SalFileGetDateTime(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf, dTmp)
.head 11 -  ! скопировать в каталог копии
.head 11 -  Call VisDosEnumFileInfo(sODBCDir || '\\' || dfFile, FA_Standard, smFiles, nmSizes, dmDateTimes,
     nmAttributes)
.head 11 -  ! Call VisDosMakeAllDir(sODBCDirCopy)
.head 11 -  Call SalFileCreateDirectory(sODBCDirCopy)
.head 11 +  If not File(sODBCDirCopy || '\\' || dfFile)
.head 12 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDirCopy || '\\' || dfFile)
.head 12 -  Call VisFileSetDateTime(sODBCDirCopy || '\\' || dfFile, dmDateTimes[0])
.head 12 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, TRUE)
.head 11 -  ! проверить, есть ли поле ref99bm в operxx, если нет, то добавить его
.head 11 -  Set n99 = -1
.head 11 -  Set dfDone = "Подождите ..."
.head 11 -  Call SalLoadAppAndWait("FindVar2 " || sODBCDir || '\\TempODBC.Dir\\' || sTempDbf || " ref99bm",
     Window_NotVisible, n99)
.head 11 -  ! Call DebugN(n99)
.head 11 +  If n99 = 1
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  ! удалить в NOT, но запросить сначала
.head 12 +  If VisMessageBox('Файл ' || dfFile || ' возможно занят другим пользователем. Удалить в NOT ?', 'ЗАПРОС',
   MBF_IconQuestion, hBtns, 2) = 1 ! ID_Yes
.head 13 -  Call SalWaitCursor(TRUE)
.head 13 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 13 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 13 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 14 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 14 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 14 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 14 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 12 -  Call FileZNListBox()
.head 12 -  Call SalEnableWindow(pbExecute)
.head 12 -  Call SalEnableWindow(pbExit)
.head 12 -  Break
.head 11 +  If n99 = 2
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  ! удалить без запроса в NOT, но написать об этом
.head 12 -  Call MessageNoWait('Файл ' || dfFile || ' не DBF-структуры, удаляется в NOT !', 'ВНИМАНИЕ !', 37, 1)
.head 12 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 12 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 12 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 13 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 13 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 12 -  Call FileZNListBox()
.head 12 -  Call SalEnableWindow(pbExecute)
.head 12 -  Call SalEnableWindow(pbExit)
.head 12 -  Break
.head 11 +  If n99 = 3
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  ! удалить без запроса в NOT, но написать об этом
.head 12 -  Call MessageNoWait('Файл ' || dfFile || ' имеет структуру не MOPER, удаляется в NOT !', 'ВНИМАНИЕ !', 37,
     1)
.head 12 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 12 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 12 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 13 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 13 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 12 -  Call FileZNListBox()
.head 12 -  Call SalEnableWindow(pbExecute)
.head 12 -  Call SalEnableWindow(pbExit)
.head 12 -  Break
.head 11 +  ! If n99 = 4 ! в данной версии не бывает
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  ! удалить без запроса в NOT, но написать об этом
.head 12 -  Call MessageNoWait('Файл ' || dfFile || ' имеет расширение не .DBF, удаляется в NOT !', 'ВНИМАНИЕ !', 37,
     1)
.head 12 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 12 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 12 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 12 -  Call FileZNListBox()
.head 12 -  Call SalEnableWindow(pbExecute)
.head 12 -  Call SalEnableWindow(pbExit)
.head 12 -  Break
.head 11 -  Set dfDone = ""
.head 11 -  Call SalArraySetUpperBound(smFilesRD, 1, -1)
.head 11 +  If SqlConnect(hSqlA) and SqlConnect(hSqlB)
.head 12 -  Set mustProcess = TRUE
.head 12 -  ! проверка ЭЦП если включен режим DBFSIGN=1
.head 12 +  If GetGlobalOptionEx('DBFSIGN') = 1 and GetSignOn() = 1
.head 13 +  If GetSignType() = 'UNI'  ! пока только для UNI
.head 14 -  ! Call Debug( 'Включен режим проверки ЭЦП на DBF' )
.head 14 -  ! Call Debug( 'Key ID = '||GetIdOper() )
.head 14 -  Set nErrMsgSize = 4096
.head 14 -  Call SalStrSetBufferLength(szErrMsg, nErrMsgSize)
.head 14 -  Set nSignRes = SignProc('CHECK', sODBCDir || '\\' || dfFile, GetIdOper(), szErrMsg, nErrMsgSize)
.head 14 +  If 0 != nSignRes
.head 15 +  If -999 = nSignRes  ! собственно ЭЦП неверна
.head 16 -  Call SalWaitCursor(FALSE)
.head 16 -  ! удалить без запроса в NOT, но написать об этом
.head 16 -  ! || 'Оригинал: '||sODBCDir || '\\' || dfFile || PutCrLf()
  || 'Копия: '||sODBCDir || '\\TempODBC.Dir\\' ||sTempDbf || PutCrLf()
.head 16 -  Call MessageNoWait('ЭЦП на файл ' || dfFile || ' неверна! Удаляется в NOT!' || Repl(PutCrLf(), 2)
     || szErrMsg || PutCrLf(), 'ВНИМАНИЕ !', 51, 1)
.head 16 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 16 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 16 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 17 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 17 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 17 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 17 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 16 -  Call FileZNListBox()
.head 16 -  Call SalEnableWindow(pbExecute)
.head 16 -  Call SalEnableWindow(pbExit)
.head 16 -  ! -------
.head 16 -  Set mustProcess = FALSE
.head 15 +  Else ! другие некритические ошибки
.head 16 +  If IDNO = MessageQuestion('Проверка ЭЦП НБУ на файл ' || dfFile || PutCrLf() || szErrMsg ||
   PutCrLf() || 'Продолжить прием данного файла?')
.head 17 -  Call SalWaitCursor(FALSE)
.head 17 -  ! удалить без запроса в NOT, но написать об этом
.head 17 -  Call MessageNoWait('Файл ' || dfFile || ' удаляется в NOT !', 'ВНИМАНИЕ !', 37, 1)
.head 17 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 17 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 17 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 18 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 18 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 18 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 18 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 17 -  Call FileZNListBox()
.head 17 -  Call SalEnableWindow(pbExecute)
.head 17 -  Call SalEnableWindow(pbExit)
.head 17 -  ! -------
.head 17 -  Set mustProcess = FALSE
.head 14 +  Else
.head 15 -  Call SaveInfoToLog( 'Проверка ЭЦП НБУ на файле ' || dfFile || PutCrLf() || szErrMsg)
.head 12 +  If mustProcess
.head 13 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT DA
     FROM " || Left(sTempDbf, Len(sTempDbf)-4) || "
     INTO :dTempDate")
.head 13 -  Call SqlFetchNext(hSqlA, nFetchRes)
.head 13 +  If dTempDate != dfBD
.head 14 -  Call SqlDisconnect(hSqlA)
.head 14 -  Call SqlDisconnect(hSqlB)
.head 14 -  Call SalWaitCursor(FALSE)
.head 14 -  Call MessageNoWait('Файл ' || dfFile || ' не за требуемую (' ||
     SalFmtFormatDateTime(dfBD, 'dd/MM/yyyy') || ') дату, удаляется в NOT !', 'ВНИМАНИЕ !', 37, 1)
.head 14 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 14 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 14 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 15 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 15 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 15 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 15 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 14 -  Call SalEnableWindow(pbExit)
.head 14 -  Call SalEnableWindow(pbExecute)
.head 14 -  Call FileZNListBox()
.head 14 -  ! удалить без запроса в NOT, но написать об этом
.head 14 -  Return FALSE
.head 13 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT count(*)
     FROM " || Left(sTempDbf, Len(sTempDbf)-4) || "
     INTO :nRecCount")
.head 13 -  Call SqlFetchNext(hSqlA, nFetchRes)
.head 13 -  Call SalShowWindow(dfStart)
.head 13 -  Call SalShowWindow(dfEnd)
.head 13 -  Set nTimeStart = SalDateHour(SalDateCurrent())*3600 + SalDateMinute(SalDateCurrent())*60 +
    SalDateSecond(SalDateCurrent())
.head 13 -  Set dfStart = 'Старт: ' || SalFmtFormatDateTime(SalDateCurrent(), 'hhh:mm:ss')
.head 13 -  Set dfReccount = nRecCount
.head 13 -  Set dfCurrent = 0
.head 13 -  Set dfAll = 0
.head 13 -  Set nPos = 0
.head 13 -  Set nTek = 0
.head 13 -  Set nRecn = 1
.head 13 -  Set nDelta = 100 / nRecCount
.head 13 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT fdat
     FROM fdat
     WHERE fdat=:dfBD")
.head 13 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 14 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO fdat (fdat)
     VALUES (:dfBD)")
.head 13 +  If dfBD != dBat
.head 14 -  Call Pl_dat(dfBD) ! Установить банковскую дату равной dfBD (но не совсем)
.head 13 -  Call SqlSetResultSet(hSqlA, FALSE)
.head 13 -  ! проверить наличие полей KASFIO,KASDOK,KASSER,KASNDOK,KASVID в mOPERе
.head 13 -  ! для проверки использовать код возврата модуля FindVar2.Exe
.head 13 +  ! If n99 > 9 ! поля есть
.head 14 -  Set sSelectOper = "
   SELECT rowid,nm,dk,mfo,nd,vob,nls,nlsk,sk,s,datd,da,plat,polu,naz1,
          vspo,kod,kodb,kisp,sign,ns,np,sos,ref99bm,vdate,kasfio,
          kasdok,kasser,kasndok,kasvid
   INTO :nRow,:nNm,:nDk,:nMfo,:sNd,:nVob,:sNls,:sNlsk,:nSk,:nS,:dDat,
        :dPat,:sPlat,:sPolu,:sNaz1,:sVspo,:sKod,:sKodB,:sKisp,:sSign,
        :NS,:nNp,:nSos,:nRef99bm,:dVdate,:sKASFIO,:sKASDOK,:sKASSER,
        :sKASNDOK,:sKASVID
   FROM " || Left(sTempDbf, Len(sTempDbf)-4) || "
   FOR UPDATE OF sos"
.head 13 +  ! Else
.head 14 -  Set sSelectOper = "
   SELECT rowid,nm,dk,mfo,nd,vob,nls,nlsk,sk,s,datd,da,plat,polu,naz1,
          vspo,kod,kodb,kisp,sign,ns,np,sos,ref99bm,vdate
   INTO :nRow,:nNm,:nDk,:nMfo,:sNd,:nVob,:sNls,:sNlsk,:nSk,:nS,:dDat,
        :dPat,:sPlat,:sPolu,:sNaz1,:sVspo,:sKod,:sKodB,:sKisp,:sSign,
        :NS,:nNp,:nSos,:nRef99bm,:dVdate
   FROM " || Left(sTempDbf, Len(sTempDbf)-4) || "
   FOR UPDATE OF sos"
.head 13 -  Set sKASFIO = ''
.head 13 -  Set sKASDOKsn = ''
.head 13 -  Set sKASVID = ''
.head 13 -  Set sSelectOper = "
    SELECT nm,dk,mfo,nd,vob,nls,nlsk,sk,s,datd,da,plat,polu,naz1,vspo,kod,kodb,sign,ns,np,sos,ref99bm,
           vdate,kw,r3,ndr3" || IifS(n99>9, ",kasfio,kasdok,kasser,kasndok,kasvid", "") || "
    INTO :nNm,:nDk,:nMfo,:sNd,:nVob,:sNls,:sNlsk,:nSk,:nS,:dDat,:dPat,:sPlat,:sPolu,:sNaz1,:sVspo,
         :sKod,:sKodB,:sSign,:NS,:nNp,:nSos,:nRef99bm,:dVdate,:nKw,:nR3,:sNDR3" || IifS(n99>9, ",
         :sKASFIO,:sKASDOK,:sKASSER,:sKASNDOK,:sKASVID", "") || "
    FROM " || Left(sTempDbf, Len(sTempDbf)-4) || "
    FOR UPDATE OF sos"
.head 13 +  If not SqlPrepare(hSqlA, sSelectOper)
.head 14 -  Call SqlDisconnect(hSqlA)
.head 14 -  Call SqlDisconnect(hSqlB)
.head 14 -  Call SalEnableWindow(pbExit)
.head 14 -  Call SalSetFocus(pbExit)
.head 14 -  Break
.head 13 -  Call SqlOpen(hSqlA, Left(sTempDbf, Len(sTempDbf)-4))
.head 13 -  Set bF = TRUE
.head 13 -  Set sVspoUGE = ''
.head 13 +  While SqlFetchNext(hSqlA, nFetchRes)
.head 14 -  Set nSos = IifN(nSos=NUMBER_Null, 0, nSos)
.head 14 -  Set sNls = SalStrTrimX(sNls)
.head 14 -  Set sNlsk = SalStrTrimX(sNlsk)
.head 14 -  ! Перекодировка
.head 14 -  Set sNd = SalStrTrimX(StrDosToWinX(sNd))
.head 14 -  Set sPlat = SalStrTrimX(StrDosToWinX(sPlat))
.head 14 -  Set sPolu = SalStrTrimX(StrDosToWinX(sPolu))
.head 14 -  Set sNaz1 = SalStrTrimX(StrDosToWinX(sNaz1))
.head 14 -  Set sVspo = SalStrTrimX(StrDosToWinX(sVspo))
.head 14 -  Set sKASFIO = SalStrTrimX(StrDosToWinX(sKASFIO))
.head 14 -  Set sKASDOKsn = SalStrTrimX(StrDosToWinX(SalStrTrimX(sKASDOK) || ' ' || SalStrTrimX(sKASSER) || ' '
    || SalStrTrimX(sKASNDOK)))
.head 14 -  Set sKASVID = SalStrTrimX(StrDosToWinX(sKASVID))
.head 14 -  !
.head 14 -  Set sMfo = Str(nMfo)
.head 14 +  If dDat = DATETIME_Null
.head 15 -  Set dDat = dBat
.head 14 +  If dPat = DATETIME_Null
.head 15 -  Set dPat = dBat
.head 14 -  Set sKod  = SalStrTrimX(sKod)
.head 14 -  Set sKodB = SalStrTrimX(sKodB)
.head 14 -  Set lsSign = sSign
.head 14 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 14 -  Call SalTblSetFocusRow(tbl1, nNewRow)
.head 14 -  Set tbl1.colNPP = nRecn
.head 14 -  Set tbl1.colND = sNd
.head 14 -  Set tbl1.colVOB = nVob
.head 14 -  Set tbl1.colMFOA = IifS(Val(sNls)=0, '', GetBankMfo())
.head 14 -  Set tbl1.colNLSA = sNls
.head 14 -  Set tbl1.colNAMA = sPlat
.head 14 +  If Val(sNls) = 0
.head 15 -  Set tbl1.colVALA = NUMBER_Null
.head 14 +  Else
.head 15 -  Set tbl1.colVALA = 980
.head 14 -  Set tbl1.colMFOB = IifS(Val(sNls)=0, '', IifS(nMfo=0, GetBankMfo(), sMfo))
.head 14 -  Set tbl1.colNLSB = sNlsk
.head 14 -  Set tbl1.colNAMB = sPolu
.head 14 +  If Val(sNls) = 0
.head 15 -  Set tbl1.colVALB = NUMBER_Null
.head 14 +  Else
.head 15 -  Set tbl1.colVALB = 980
.head 14 -  Set tbl1.colS = nS/100
.head 14 -  Set tbl1.colVDATE = dVdate
.head 14 -  Set tbl1.colNAZN = sNaz1
.head 14 -  !
.head 14 -  Set sR3 = Str(nR3)
.head 14 -  Set sNDR3 = SalStrTrimX(StrDosToWinX(sNDR3))
.head 14 -  !
.head 14 -  Set tbl1.colREF98 = nRef99bm
.head 14 -  Call SalTblSetRowFlags(tbl1, nNewRow, ROW_Edited | ROW_New, FALSE)
.head 14 +  If Val(sNls) = 0
.head 15 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Gray)
.head 14 +  If (nNm = 1 or nNm = 2) and nSos = 0 and nS > 0 and (not (nNp = 380 and nNm = 1 and
   (Left(sNls,4) = '3801' or Left(sNlsk,4) = '3801')) and not (nNp = 991 and nNm = 1 and
   (Left(sNls,4) = '1200' or Left(sNlsk,4) = '1200')))
.head 15 +  If nNm = 1
.head 16 -  Set sMfo = GetBankMfo()
.head 15 +  If sMfo = GetBankMfo()
.head 16 -  Set nNm = 1
.head 15 -  ! Проверка реквизитов
.head 15 -  Set bErr = FALSE
.head 15 -  Set bErrNLS = FALSE
.head 15 -  Set sErrMes = ''
.head 15 +  If not (((Len(sKod) = 8 and sKod = V_Okpo(sKod)) or (Len(sKod) = 9 or Len(sKod) = 10) or
   (Len(sKod) = 3) or (sKod = '99999')) and ((Len(sKodB) = 8 and sKodB = V_Okpo(sKodB)) or
   (Len(sKodB) = 9 or Len(sKodB) = 10) or (Len(sKodB) = 3) or (sKodB = '99999')))
.head 16 -  Set sErrMes = sErrMes || ' Отсутствует(ош) ОКРО А или ОКРО Б
'
.head 16 -  Set bErr = TRUE
.head 15 +  If not SqlPrepareAndExecute( hSqlAux(), "
   SELECT sab
   INTO :sSAB
   FROM banks
   WHERE mfo=:sMfo") or not SqlFetchNext(hSqlAux(), nFetchRes)
.head 16 -  Set sErrMes = sErrMes || '
Ошибка МФО'
.head 16 -  Set bErr = TRUE
.head 15 +  Else
.head 16 +  If Len(sNls) < 5 or sNls != Vkrz2(GetBankMfo(), sNls)
.head 17 -  Set sErrMes = sErrMes || '
Ошибка Счет-А'
.head 17 -  Set bErr = TRUE
.head 17 -  Set bErrNLS = TRUE
.head 16 +  If Len(sNlsk) < 5 or sNlsk != Vkrz2(sMfo, sNlsk)
.head 17 -  Set sErrMes = sErrMes || '
Ошибка Счет-Б'
.head 17 -  Set bErr = TRUE
.head 17 -  Set bErrNLS = TRUE
.head 16 +  Else If nNm != 1
.head 17 -  Call SqlPrepareAndExecute(hSqlAux(), "
     SELECT nbs
     FROM nosep
     WHERE kod=decode(Substr(:sMfo,1,1),'8',3,decode(Substr(:sSAB,3,1),'H',1,2)) and
           :sNlsk like nbs || '%'")
.head 17 +  If SqlFetchNext(hSqlAux(), nFetchRes)
.head 18 -  Set sErrMes = sErrMes || '
Недопустимый балансовый счет'
.head 18 -  Set bErr = TRUE
.head 18 -  Set bErrNLS = TRUE
.head 15 +  If Len(sPlat) < 3 or SalStrMidX(sPlat, 0, 1) = ' ' or not FScan(StrWinToDosX(sPlat))
.head 16 -  Set sErrMes = sErrMes || '
Ошибка в реквизите ПЛАТЕЛЬЩИК'
.head 16 -  Set bErr = TRUE
.head 15 +  If Len(sPolu) < 3 or SalStrMidX(sPolu, 0, 1) = ' ' or not FScan(StrWinToDosX(sPolu))
.head 16 -  Set sErrMes = sErrMes || '
Ошибка в реквизите ПОЛУЧАТЕЛЬ'
.head 16 -  Set bErr = TRUE
.head 15 +  If Len(sNaz1) < 3 or SalStrMidX(sNaz1, 0, 1) = ' ' or not FScan(StrWinToDosX(sNaz1))
.head 16 -  Set sErrMes = sErrMes || '
Ошибка в реквизите НАЗНАЧЕНИЕ'
.head 16 -  Set bErr = TRUE
.head 15 -  ! Проверка реквизитов (end)
.head 15 +  If nSk > 0
.head 16 -  Set sTmp = sNls
.head 16 -  Set sNls = sNlsk
.head 16 -  Set sNlsk = sTmp
.head 16 +  ! If not cbRevPP
.head 17 -  Set sTmp = sPolu
.head 17 -  Set sPolu = sPlat
.head 17 -  Set sPlat = sTmp
.head 17 -  !
.head 16 -  ! переворот кассы (сальТо)
.head 16 -  Set sTmp = sPolu
.head 16 -  Set sPolu = sPlat
.head 16 -  Set sPlat = sTmp
.head 16 +  ! Прием информационных документов
.head 17 -  ! Set nDk = 1 - nDk
.head 16 +  If nDk = 1
.head 17 -  Set nDk = 0
.head 16 +  Else If nDk = 0
.head 17 -  Set nDk = 1
.head 16 -  ! Set nNm = nDk + 1005 ! добавлено МБГ
.head 16 -  Set nNm = nDk + 1085 ! добавлено для UPB и для всех остальных
.head 15 +  Else
.head 16 -  Set nSk = NUMBER_Null
.head 16 +  If nDk = nKw
.head 17 -  Set nDk = nDk + 2
.head 15 +  If nNm = 2 and NS = 8
.head 16 -  Call SqlPrepareAndExecute(hSqlAux(), T("
     SELECT nls
     INTO :sNls
     FROM accounts
     WHERE tip='90D'"))
.head 16 -  Call SqlFetchNext(hSqlAux(), nFetchRes)
.head 15 -  Set nRef = NUMBER_Null
.head 15 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Blue)
.head 15 -  ! Set sTT = Right('NM' || IifS(nDk=0 and nNm=2, 'D', IifS(nDk>1 and nNm=2, 'I', Str(nNm))), 3)
.head 15 -  Set sTT = Right('R3' || IifS(nDk=0 and nNm=2, 'D', IifS(nDk>1, IifS(nNm=2, 'I', 'U'), Str(nNm))),
    3)
.head 15 +  If bNBU and (sTT = '085' or sTT = '086') and
   SqlPrepareAndExecute(hSqlAux(), T("
   SELECT vob
   INTO :nVOBtts
   FROM tts_vob
   WHERE tt=:sTT")) and SqlFetchNext(hSqlAux(), nFetchRes)
.head 16 -  Set nVob = nVOBtts
.head 16 -  Set tbl1.colVOB = nVob
.head 15 -  ! Проверка на доступ к счетам
.head 15 +  If not bErrNLS
.head 16 -  ! sNls
.head 16 +  If nDk = 0 and not (SqlPrepareAndExecute(hSqlAux(), "
   SELECT nls
   INTO :sTmpNls
   FROM saldok
   WHERE nls=:sNls and kv=980") and SqlFetchNext(hSqlAux(), nFetchRes))
.head 17 -  Set sErrMes = sErrMes || '   Счет ' || sNls ||
' не доступен для Кредита
'
.head 17 -  Set bErr = TRUE
.head 16 +  Else If nDk = 1 and not (SqlPrepareAndExecute(hSqlAux(), "
     SELECT nls
     INTO :sTmpNls
     FROM saldod
     WHERE nls=:sNls and kv=980") and SqlFetchNext(hSqlAux(), nFetchRes))
.head 17 -  Set sErrMes = sErrMes || '   Счет ' || sNls ||
' не доступен для Дебета
'
.head 17 -  Set bErr = TRUE
.head 16 +  Else If nDk > 1 and SqlPrepareAndExecute(hSqlAux(), "
     SELECT nls
     INTO :sTmpNls
     FROM accounts
     WHERE nls=:sNls and kv=980 and dazs is not null") and SqlFetchNext(hSqlAux(), nFetchRes)
.head 17 -  Set sErrMes = sErrMes || '   Счет ' || sNls ||
' не доступен (ЗАКРЫТ)
'
.head 17 -  Set bErr = TRUE
.head 16 -  ! sNlsk
.head 16 +  If nNm = 1 or nNm > 1000
.head 17 +  If nDk = 0 and sMfo=sBankMfo and not (SqlPrepareAndExecute(hSqlAux(), "
   SELECT nls
   INTO :sTmpNls
   FROM saldod
   WHERE nls=:sNlsk and kv=980") and SqlFetchNext(hSqlAux(), nFetchRes))
.head 18 -  Set sErrMes = sErrMes || '   Счет ' || sNlsk ||
' не доступен для Дебета
'
.head 18 -  Set bErr = TRUE
.head 17 +  Else If nDk = 1 and sMfo=sBankMfo and not (SqlPrepareAndExecute(hSqlAux(), "
     SELECT nls
     INTO :sTmpNls
     FROM saldok
     WHERE nls=:sNlsk and kv=980") and SqlFetchNext(hSqlAux(), nFetchRes))
.head 18 -  Set sErrMes = sErrMes || '   Счет ' || sNlsk ||
' не доступен для Кредита
'
.head 18 -  Set bErr = TRUE
.head 17 +  Else If nDk > 1 and SqlPrepareAndExecute(hSqlAux(), "
     SELECT nls
     INTO :sTmpNls
     FROM accounts
     WHERE nls=:sNlsk and kv=980 and dazs is not null") and SqlFetchNext(hSqlAux(), nFetchRes)
.head 18 -  Set sErrMes = sErrMes || '   Счет ' || sNlsk ||
' не доступен (ЗАКРЫТ)
'
.head 18 -  Set bErr = TRUE
.head 15 -  !
.head 15 +  If bErr
.head 16 -  Call SalMessageBox('Документ на сумму ' || Str(nS/100) ||
' не принят.
' || sErrMes, 'Внимание!', MB_Ok | MB_IconExclamation)
.head 15 -  ! Modify by ANNY 18-10-2001
.head 15 +  Else
.head 16 +  ! If nVob = 96
.head 17 -  Set dTemp = SalDateMonthBegin(dfBD)-1
.head 17 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT max(fdat)
     INTO :dValu
     FROM fdat
     WHERE fdat<=:dTemp")
.head 17 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 18 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO fdat (fdat)
     VALUES (:dTemp)")
.head 18 -  Set dValu = dTemp
.head 17 +  If dValu != dfBD
.head 18 -  Call Pl_dat(dValu) ! Установить банковскую дату
.head 16 +  If nVob = 96 or nVob = 99
.head 17 -  Set dTemp = IifD(nVob=96, SalDateMonthBegin(dfBD), SalDateYearBegin(dfBD)) - 1
.head 17 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT max(fdat)
     INTO :dValu
     FROM fdat
     WHERE fdat<=:dTemp")
.head 17 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 18 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO fdat (fdat)
     VALUES (:dTemp)")
.head 18 -  Set dValu = dTemp
.head 17 +  If dValu != dfBD
.head 18 -  Call Pl_dat(dValu) ! Установить банковскую дату
.head 16 +  Else
.head 17 -  Set dValu = dfBD
.head 16 -  Set sVspoDop = ''
.head 16 -  Set nFileVspo = 0
.head 16 +  If Len(sVspo) > 0
.head 17 +  ! If File(sODBCDir || '\\' || sVspo)
.head 18 -  Set nFileVspo = 1
.head 17 +  ! Else
.head 18 -  Set nFileVspo = 2
.head 17 -  Set nFileVspo = IifN(File(sODBCDir || '\\' || sVspo), 1, 2)
.head 17 -  Set sVspoDop = sVspo
.head 17 -  Set sVspo = ''
.head 16 -  ! Call DebugN(nFileVspo)
.head 16 -  Call ccDoc.SetDoc(0, sTT, nDk, nVob, sNd, dDat, dValu, dValu, dValu, sNls, sPlat, GetBankMfo(),
     '', 980, nS, sKod, sNlsk, sPolu, sMfo, '', 980, nS, sKodB, sNaz1, sVspo, GetIdOper(), '',
     nSk, 0)
.head 16 -  Set dfAll = dfAll + 1
.head 16 +  If ccDoc.oDoc()
.head 17 -  Set br31 = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO operw (ref,tag,value)
    VALUES (:ccDoc.m_nRef,'KS_R3',:sR3)"))
.head 17 -  Set br32 = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO operw (ref,tag,value)
    VALUES (:ccDoc.m_nRef,'KS_ND',:sNDR3)"))
.head 17 -  Set br3R = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO operw (ref,tag,value)
    VALUES (:ccDoc.m_nRef,'KS_FI',:dfFile)"))
.head 17 -  ! Set nYear = SalDateYear(dfBD)
.head 17 -  Set nYear = SalDateYear(dValu)
.head 17 -  Set bn3 = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO r3_ndr3 (ndr3,god)
    VALUES (:sNDR3,:nYear)"))
.head 17 +  If not bn3
.head 18 -  Call MessageNoWait('Документ от R3 с номером ' || sNDR3 || ' ранее УЖЕ принимался !',
     'ВНИМАНИЕ !!!', 0, 1)
.head 17 -  Set b1 = TRUE
.head 17 -  Set b2 = b1
.head 17 -  Set b3 = b1
.head 17 +  If Len(sKASVID) > 0
.head 18 -  Set b1 = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO operw (ref,tag,value)
    VALUES (:ccDoc.m_nRef,'ATRT',:sKASVID)"))
.head 17 +  If Len(sKASDOKsn) > 0
.head 18 -  Set b2 = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO operw (ref,tag,value)
    VALUES (:ccDoc.m_nRef,'PASP',:sKASDOKsn)"))
.head 17 +  If Len(sKASFIO) > 0
.head 18 -  Set b3 = SqlPrepareAndExecute(hSql(), T("
   INSERT
   INTO operw (ref,tag,value)
   VALUES (:ccDoc.m_nRef,'FIO',:sKASFIO)"))
.head 17 -  Set bD = TRUE
.head 17 +  If nFileVspo = 1
!! Len(sVspoDop) > 0 and File(sODBCDir || '\\' || sVspoDop)
.head 18 -  ! есть файл доп.реквизитов !!!
.head 18 -  ! вычитываем их в массив и лепим в маленьком цикле в OPERW
.head 18 -  ! накапливаем массив с именами файлов доп.реквизитов для
  дальнейшего их удаления
.head 18 -  ! Call Debug('Copy' || PutCrLf() ||
           sODBCDir || '\\' || sVspoDop || PutCrLf() ||
           sODBCDir || '\\TempODBC.Dir\\' || sVspoDop)
.head 18 -  Call VisDosEnumFileInfo(sODBCDir || '\\' || sVspoDop, FA_Standard, smFiles, nmSizes,
     dmDateTimes, nmAttributes)
.head 18 +  If not File(sODBCDirCopy || '\\' || sVspoDop)
.head 19 -  Call VisFileCopy(sODBCDir || '\\' || sVspoDop, sODBCDirCopy || '\\' || sVspoDop)
.head 19 -  Call VisFileSetDateTime(sODBCDirCopy || '\\' || sVspoDop, dmDateTimes[0])
.head 19 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || sVspoDop, FA_ReadOnly, TRUE)
.head 18 -  !
.head 18 -  ! Call VisFileCopy(sODBCDir || '\\' || sVspoDop, sODBCDirCopy || '\\' || sVspoDop)
.head 18 -  Call VisFileCopy(sODBCDir || '\\' || sVspoDop, sODBCDir || '\\TempODBC.Dir\\' || sVspoDop)
.head 18 -  Set SqlDatabase = 'dBase_Files'
.head 18 +  If SqlConnect(hSqlD)
.head 19 -  ! Call DebugN(nIvs)
.head 19 -  ! Call Debug(sVspoUGE)
.head 19 -  ! Call Debug(sVspoDop)
.head 19 +  If sVspoUGE != sVspoDop
.head 20 +  If not SqlPrepareAndExecute(hSqlD, "
       SELECT REF,TAG,VALUE
       INTO :sREFd,:sTAGd,:sVALUEd
       FROM " || sVspoDop)
.head 21 -  Set bD = FALSE
.head 21 -  Call MessageNoWait('Невозможно открыть файл дополнительных реквизитов ' || sVspoDop ||
     ' !', 'ВНИМАНИЕ !!!', 7, 1)
.head 21 -  ! Call SalFileGetCurrentDirectory(sFr)
.head 21 -  ! Call Debug('sVspoDop=' || sVspoDop || PutCrLf() ||
           'sFr='      || sFr      || PutCrLf() ||
           'sREFd='    || sREFd    || PutCrLf() ||
           'sTAGd='    || sTAGd    || PutCrLf() ||
           'sVALUEd='  || sVALUEd)
.head 20 -  Call SalArraySetUpperBound(smREFd, 1, -1)
.head 20 -  Call SalArraySetUpperBound(smTAGd, 1, -1)
.head 20 -  Call SalArraySetUpperBound(smVALUEd, 1, -1)
.head 20 -  Set nIvs = 0
.head 20 +  While SqlFetchNext(hSqlD, nFetchRes)
.head 21 -  ! Call DebugN(nIvs)
.head 21 -  Set smREFd[nIvs] = SalStrTrimX(sREFd)
.head 21 -  Set smTAGd[nIvs] = Left(SalStrTrimX(sTAGd) || Spac(5), 5)
.head 21 -  Set smVALUEd[nIvs] = StrDosToWinX(SalStrTrimX(sVALUEd))
.head 21 -  Set nIvs = nIvs + 1
.head 19 -  Call SqlDisconnect(hSqlD)
.head 19 -  Set nK = 0
.head 19 -  Set sVspoUGE = sVspoDop
.head 19 +  While nK < nIvs
.head 20 -  Set sREFd = smREFd[nK]
.head 20 -  Set sTAGd = smTAGd[nK]
.head 20 -  Set sVALUEd = smVALUEd[nK]
.head 20 +  If sREFd = sNDR3
.head 21 -  Set bD = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO operw (ref,tag,value)
    VALUES (:ccDoc.m_nRef,:sTAGd,:sVALUEd)"))
.head 20 +  If bD
.head 21 -  ! Call Debug('istina')
.head 21 -  Set nK = nK + 1
.head 20 +  Else
.head 21 -  Set nK = nIvs
.head 21 -  Call MessageNoWait('Ошибка вставки доп. реквизита ' || sTAGd, 'ВНИМАНИЕ !!!', 0, 1)
.head 19 -  Call SalArrayGetUpperBound(smFilesRD, 1, nBound)
.head 19 -  ! Call DebugN(nBound+1)
.head 19 -  ! Call Debug(sVspoDop)
.head 19 -  Set smFilesRD[nBound+1] = sVspoDop
.head 17 +  Else If nFileVspo = 2
.head 18 -  Set bD = FALSE
.head 18 -  Call MessageNoWait('Отсутствует файл дополнительных реквизитов ' || sVspoDop || ' !',
     'ВНИМАНИЕ !!!', 7, 1)
.head 17 -  ! Call Debug(
     IifS(b1,   'b1   - TRUE', 'b1   - FALSE') || PutCrLf() ||
     IifS(b2,   'b2   - TRUE', 'b2   - FALSE') || PutCrLf() ||
     IifS(b3,   'b3   - TRUE', 'b3   - FALSE') || PutCrLf() ||
     IifS(br31, 'br31 - TRUE', 'br31 - FALSE') || PutCrLf() ||
     IifS(br32, 'br32 - TRUE', 'br32 - FALSE') || PutCrLf() ||
     IifS(br3R, 'br3R - TRUE', 'br3R - FALSE') || PutCrLf() ||
     IifS(bn3,  'bn3  - TRUE', 'bn3  - FALSE') || PutCrLf() ||
     IifS(bD,   'bD   - TRUE', 'bD   - FALSE'))
.head 17 +  If b1 and b2 and b3 and br31 and br32 and br3R and bn3 and bD
.head 18 -  ! Анализ на доп.реквизиты
.head 18 +  If SqlPrepareAndExecute(hSqlB, "
   UPDATE " || Left(sTempDbf, Len(sTempDbf)-4) || "
   SET sos=9,ref99bm=:ccDoc.m_nRef
   WHERE CURRENT OF " || Left(sTempDbf, Len(sTempDbf)-4))
.head 19 -  Call SqlCommit(hSql())
.head 19 -  Call SaveInfoToLog('принят док Ref' || Str(ccDoc.m_nRef) || ': ' || sNls || '(980) ' ||
     Str(nS) || ' -> ' || sMfo || ' ' || sNlsk|| '(980) ' || Str(nS) || '[' || sPolu ||
     '],[' || sNaz1 || '] ' || GetIdOper())
.head 19 -  Call Pl_dat(dfBD) ! Возвратить банковскую дату
.head 19 -  Set tbl1.colREF98 = ccDoc.m_nRef
.head 19 -  Set tbl1.colTT = sTT
.head 19 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_DarkGreen)
.head 19 -  Set dfCurrent = dfCurrent + 1
.head 19 +  If Mod(n99, 10) = 0
.head 20 -  Call SqlPrepareAndExecute(hSqlB, "
     UPDATE " || Left(sTempDbf, Len(sTempDbf)-4) || "
     SET sos=9,ref99bm=:ccDoc.m_nRef
     WHERE CURRENT OF " || Left(sTempDbf, Len(sTempDbf)-4))
.head 18 +  Else
.head 19 -  Call SaveInfoToLog('ошибка UPDATE ' || Left(sTempDbf, Len(sTempDbf)-4) || ' SET sos=9' ||
     ' док №' || sNd || ': ' || sNls || '(980) ' || Str(nS) || ' -> ' || sMfo || ' ' ||
      sNlsk || '(980) ' || Str(nS) || '[' || sPolu || '],[' || sNaz1 || '] ' ||
      GetIdOper())
.head 19 -  Call SqlRollback(hSql())
.head 17 +  Else
.head 18 -  Call SaveInfoToLog('ошибка вставки в operw док №' || sNd || ': ' || sNls || '(980) ' ||
     Str(nS) || ' -> ' || sMfo || ' ' || sNlsk || '(980) ' || Str(nS) || '[' || sPolu ||
     '],[' || sNaz1 || '] ' || GetIdOper())
.head 18 -  Call SqlRollback(hSql())
.head 18 -  Set bF = b1 and b2 and b3 and br31 and br32 and br3R and bn3 and bD and bF
.head 16 +  Else
.head 17 -  Call SaveInfoToLog('ошибка при оплате док №' || sNd || ': ' || sNls || '(980) ' || Str(nS) ||
     ' -> ' || sMfo || ' ' || sNlsk || '(980) ' || Str(nS) || '[' || sPolu || '],[' || sNaz1 ||
     '] ' || GetIdOper())
.head 17 -  Call SqlRollback(hSql())
.head 17 -  Set bF = FALSE
.head 17 +  If not g_bSignInited ! ccDoc.m_bEscPin
.head 18 -  Call SaveInfoToLog('Прием документов из ' || dfFile || ' ПРЕРВАН')
.head 18 -  ! Call DebugN(ccDoc.m_nTim)
.head 18 -  Call SalEnableWindow(pbExit)
.head 18 -  Call SalEnableWindow(pbExecute)
.head 18 -  Break
.head 14 -  Call SalTblSetCellTextColor(tbl1.colNPP, COLOR_Charcoal, TRUE)
.head 14 -  Set nPos = nPos + nDelta
.head 14 -  Set nRecn = nRecn + 1
.head 14 +  If Int(nPos) != nTek
.head 15 -  Set nTek = Int(nPos)
.head 15 -  Set nTimeCurrent = SalDateHour(SalDateCurrent())*3600 + SalDateMinute(SalDateCurrent())*60 +
     SalDateSecond(SalDateCurrent())
.head 15 -  Set nTimeEnd = Int(100 * (nTimeCurrent-nTimeStart) / nPos + nTimeStart)
.head 15 -  Set nHour = Int(nTimeEnd/3600)
.head 15 -  Set nTemp = nTimeEnd - nHour*3600
.head 15 -  Set nMinu = Int(nTemp/60)
.head 15 -  Set dfStart = dfStart
.head 15 -  Set dfEnd = 'Финиш: ' || Right(Str(100+nHour), 2) || ':' || Right(Str(100+nMinu), 2) || ':' ||
    Right(Str(100+nTemp-nMinu*60), 2) || ' (прогноз)'
.head 15 -  Set dfReccount = dfReccount
.head 15 -  Set dfCurrent = dfCurrent
.head 15 -  Set dfAll = dfAll
.head 14 -  Call ccProgressBar.SetProgress(nPos)
.head 14 -  Call SalUpdateWindow(hWndForm)
.head 13 -  Call ccProgressBar.SetProgress(100)
.head 13 -  Call SqlCommitEx(hSql(), 'OK')
.head 13 -  Call SqlCommit(hSqlB)
.head 13 -  Call SqlDisconnect(hSqlA)
.head 13 -  Call SqlDisconnect(hSqlB)
.head 13 -  Call SaveInfoToLog('Прием документов из ' || dfFile || ' ОКОНЧЕН')
.head 13 -  Set dfDone = "Готово"
.head 13 -  Set dfEnd = Left(dfEnd, 15)
.head 13 +  If dfCurrent > 0
.head 14 -  ! сформировать файл оплаченных документов
.head 14 -  Set nCurrentRow = nJur
.head 14 -  Set nP = 1
.head 14 -  Set nItog = 0
.head 14 -  Set sFr = GetPrnDir() || '\\M' || Right(Str(SalDateMonth(dBat)+100), 2) || Right(Str(
    SalDateDay(dBat)+100), 2) || Right(Str(SalDateHour(SalDateCurrent())+100), 2) || Subs(Str(
    SalDateMinute(SalDateCurrent())+100), 2, 1) || '.' || Right(Str(SalDateMinute(
    SalDateCurrent())), 1) || Right(Str(SalDateSecond(SalDateCurrent())+100), 2)
.head 14 -  Call SalFileOpen(hF, sFr, OF_Create | OF_Write)
.head 14 -  Set sBuff = StrWinToDosX(SalStrTrimX(GetBankName()) || ' ' || SalStrTrimX(GetBankMfo()) || PutCrLf()
    || 'Дата и время формирования ' || SalFmtFormatDateTime(SalDateCurrent(), 'dd/MM/yyyy ') ||
    Right('0' || SalFmtFormatDateTime(SalDateCurrent(), 'hhhh:mm:ss'), 8) || PutCrLf() || PutCrLf()
    || Spac(15) || 'Реестр оплаченных платежных документов' || PutCrLf() || Spac(15) || '(' || dfFile
    || ') сеанс (с ' || Right(dfStart, 8) || ' по ') || Right(dfEnd, 8) || ')' || PutCrLf() ||
    Repl('-', 69) || PutCrLf()
.head 14 -  Call SalFileWrite(hF, sBuff, Len(sBuff))
.head 14 +  While SalTblFindNextRow(tbl1, nCurrentRow, 0, 0)
.head 15 -  Call SalTblSetFocusRow(tbl1, nCurrentRow)
.head 15 -  Set nColor = SalColorGet(tbl1.colNLSA,
    COLOR_IndexCellText)
.head 15 +  If nColor = COLOR_DarkGreen
.head 16 -  Set sLev = tbl1.colTT || ' реф.' || Str(tbl1.colREF98) || ', док.' || SalStrTrimX(tbl1.colND) ||
    ', оп.' || Str(tbl1.colVOB)
.head 16 -  Set sBuff = PadR(Str(nP) || '.', 4) || GetBankMfo() || ' ' || PadR(tbl1.colNLSA || '(' || Right(
    Str(tbl1.colVALA+1000), 3) || ')', 20) || StrWinToDosX(SalStrTrimX(tbl1.colNAMA) || PutCrLf()
    || '    ' || IifS(Val(tbl1.colMFOB)=0, GetBankMfo(), tbl1.colMFOB) || ' ' ||
    PadR(tbl1.colNLSB || '(' || Right(Str(tbl1.colVALB+1000), 3) || ')', 20) ||
    SalStrTrimX(tbl1.colNAMB) || PutCrLf() || sLev || PadL('сумма ' ||
    SalNumberToStrX(tbl1.colS, 2), 69-Len(sLev)) || PutCrLf() || Perenos(tbl1.colNAZN, 65, 4)) ||
    PutCrLf()
.head 16 -  Call SalFileWrite(hF, sBuff, Len(sBuff))
.head 16 -  Set nP = nP + 1
.head 16 -  Set nItog = nItog + tbl1.colS
.head 14 -  Set sBuff = Repl('-', 69) || PutCrLf() || StrWinToDosX('    Итого: ' || PadR(Str(nP-1), 20) ||
    'На сумму:') || PadL(SalNumberToStrX(nItog, 2), 29) || PutCrLf() || Repl('-', 69) || Repl(
    PutCrLf(), 3)
.head 14 -  Call SalFileWrite(hF, sBuff, Len(sBuff))
.head 14 -  Call SalFileClose(hF)
.head 13 -  Call SalMessageBeep(-1)
.head 13 +  If dfAll > dfCurrent and not bF
.head 14 -  ! удалить файл в NOT (по запросу)
.head 14 +  If VisMessageBox('ВНИМАНИЕ ! Файл ' || dfFile ||
   '. Обработаны не ВСЕ выбранные документы. Примите меры для исправления ошибок. ' ||
   'Переместить в NOT ?', 'ЗАПРОС', MBF_IconQuestion, hBtns, 2) = 1
 ! ID_Yes
.head 15 -  Call SalWaitCursor(FALSE)
.head 15 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 15 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 15 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 16 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 16 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 16 -  Call SalArrayGetUpperBound(smFilesRD, 1, nBound)
.head 16 +  If nBound > 0
.head 17 -  Set nI = 1
.head 17 +  While nI <= nBound
.head 18 -  ! Call Debug(smFilesRD[nI])
.head 18 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || smFilesRD[nI], sODBCDir || '\\ArchivNO\\'
     || smFilesRD[nI])
.head 18 +  If File(sODBCDir || '\\ArchivNO\\' || smFilesRD[nI])
.head 19 -  Call VisFileDelete(sODBCDir || '\\' || smFilesRD[nI])
.head 18 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || smFilesRD[nI])
.head 18 -  Set nI = nI + 1
.head 16 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 16 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 16 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || sVspoDop, FA_ReadOnly, FALSE)
.head 16 -  Call VisFileDelete(sODBCDirCopy || '\\' || sVspoDop)
.head 16 -  Call FileZNListBox()
.head 14 +  Else
.head 15 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf, sODBCDir || '\\' || dfFile)
.head 15 +  If File(sODBCDir || '\\' || dfFile)
.head 16 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 14 -  Call SalEnableWindow(pbExit)
.head 14 -  Call SalEnableWindow(pbExecute)
.head 14 -  Break
.head 13 +  Else
.head 14 -  Call SalWaitCursor(FALSE)
.head 14 -  ! записать в архив OK и удалить
.head 14 +  If VisMessageBox('ВНИМАНИЕ ! Файл ' || dfFile || ' обработан. Записать в АРХИВ(Ok) ?', 'ЗАПРОС',
   MBF_IconQuestion, hBtns, 2) = 1 ! ID_Yes
.head 15 -  Call SalWaitCursor(TRUE)
.head 15 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivOK')
.head 15 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf, sODBCDir || '\\ArchivOK\\' || dfFile)
.head 15 +  If File(sODBCDir || '\\ArchivOK\\' || dfFile)
.head 16 -  Set nYear = SalDateYear(dfBD)
.head 16 +  If SqlPrepareAndExecute(hSql(), "
   INSERT
   INTO zag_r3 (fn,god)
   VALUES (:dfFile,:nYear)")
.head 17 -  Call SqlCommit(hSql())
.head 16 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 16 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 16 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 16 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 16 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || sVspoDop, FA_ReadOnly, FALSE)
.head 16 -  Call VisFileDelete(sODBCDirCopy || '\\' || sVspoDop)
.head 16 +  If bD
.head 17 -  Call SalArrayGetUpperBound(smFilesRD, 1, nBound)
.head 17 -  ! Call DebugN(nBound)
.head 17 +  If nBound > 0
.head 18 -  Set nI = 1
.head 18 +  While nI <= nBound
.head 19 -  ! Call Debug(smFilesRD[nI])
.head 19 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || smFilesRD[nI], sODBCDir ||
     '\\ArchivOK\\' || smFilesRD[nI])
.head 19 +  If File(sODBCDir || '\\ArchivOK\\' || smFilesRD[nI])
.head 20 -  Call VisFileDelete(sODBCDir || '\\' || smFilesRD[nI])
.head 19 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || smFilesRD[nI])
.head 19 -  Set nI = nI + 1
.head 16 -  Call FileZNListBox()
.head 14 +  Else
.head 15 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf, sODBCDir || '\\' || dfFile)
.head 15 +  If File(sODBCDir || '\\' || dfFile)
.head 16 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 15 -  Call SalEnableWindow(pbExit)
.head 15 -  Call SalEnableWindow(pbExecute)
.head 15 -  Break
.head 14 -  Call SalWaitCursor(TRUE)
.head 13 -  Call SalSetFocus(tbl1)
.head 13 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 13 -  Set nJur = nNewRow
.head 13 -  Call SalDisableWindow(pbExecute)
.head 11 +  Else
.head 12 -  Call MessageAttention('Ошибка подсоединения к Базе данных: ' || SqlDatabase)
.head 10 +  Else
.head 11 -  ! Call MessageAttention('Нет файла: ' || sODBCDir || dfFile || ' или он занят другим пользователем.')
.head 11 +  If VisMessageBox('Файл ' || dfFile || ' возможно занят другим пользователем. Удалить в NOT ?', 'ЗАПРОС',
   MBF_IconQuestion, hBtns, 2) = 1 ! ID_Yes
.head 12 -  Call SalWaitCursor(TRUE)
.head 12 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 12 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 12 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 13 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 13 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 11 -  Break
.head 9 +  Else
.head 10 -  ! удалить файл в NOT
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call MessageNoWait('Файл ' || dfFile || ' уже принимался ранее, ' || PutCrLf() || 'удаляется в NOT !',
     'ВНИМАНИЕ !', 37, 1)
.head 10 -  Call SalWaitCursor(TRUE)
.head 10 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 10 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 10 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 11 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 11 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 11 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 10 -  Call FileZNListBox()
.head 9 -  ! Call SalEnableWindow(pbExecute)
.head 9 -  Call SalEnableWindow(pbExit)
.head 9 -  Call SalSetFocus(pbExit)
.head 9 +  If not cbAll
.head 10 -  Break
.head 8 -  Call SalWaitCursor(FALSE)
.head 7 +  Else
.head 8 -  Call Debug("День закрыт !")
.head 3 +  Pushbutton: pbExit
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   5.883"
.head 5 -  Top:    5.988"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, FALSE)
.head 3 -  Frame
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    5.238"
.head 5 -  Width:  12.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.083"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Drop-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.end
.head 3 -  Background Text: Имя файла импорта
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    5.595"
.head 5 -  Width:  3.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Combo Box: dfFile
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.383"
.head 5 -  Top:    5.571"
.head 5 -  Width:  4.033"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.869"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: 12
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.end
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 +  Check Box: cbAll
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Принять ВСЕ файлы
.head 4 -  Window Location and Size
.head 5 -  Left:   0.383"
.head 5 -  Top:    5.988"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Teal
.head 4 -  Background Color: Default
.end
.head 4 -  Message Actions
.head 3 +  Data Field: dfStart
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.683"
.head 6 -  Top:    5.762"
.head 6 -  Width:  4.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions
.head 3 +  Data Field: dfEnd
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.683"
.head 6 -  Top:    6.012"
.head 6 -  Width:  4.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions
.head 3 +  Data Field: dfDone
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.683"
.head 6 -  Top:    5.345"
.head 6 -  Width:  4.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Purple
.head 5 -  Background Color: Gray
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions
.head 3 +  Child Table: tbl1
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.405"
.head 6 -  Width:  12.733"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 333333
.head 5 -  Discardable? Yes
.end
.head 4 +  Contents
.head 5 +  Column: colNPP
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Nпп
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.471"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colND
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер док.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.114"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVOB
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вид оп.
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMFOA
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО-А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.743"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLSA
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет-А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.529"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAMA
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.А
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.714"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVALA
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMFOB
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.743"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLSB
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.529"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAMB
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.Б
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.714"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVALB
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.386"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVDATE
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата вал.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAZN
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назначение пл.
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.357"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colREF98
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Референс
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.943"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTT
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Транзакция
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.943"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nFocusRow
.head 5 -  Window Handle: hWndCol
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 +  On SAM_CornerClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_CornerDoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_RowHeaderClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_EndCellTab
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On WM_LbuttonUp
.head 6 -  ! Узнать текущую строку
.head 6 -  ! Call SalTblQueryFocus(tbl1, nFocusRow, hWndCol)
.head 6 -  ! Set nFocusRow = SalTblQueryContext(tbl1)
.head 6 -  ! Почистить все
.head 6 -  Call SalTblSetFlagsAnyRows(tbl1, ROW_Selected, FALSE, 0, 0)
.head 6 -  ! Call SalTblSetFocusRow (tbl1, nFocusRow)
.head 6 -  ! Стать на нее (что выше)
.head 6 -  ! Call SalTblSetRowFlags(tbl1, nFocusRow, ROW_Selected, FALSE)
.head 6 -  ! Call SalSendMsg(tbl1, SAM_RowHeaderClick, 0, Max(TBL_MaxRow, nFocusRow+1))
.head 5 +  On VTM_KeyUp
.head 6 -  Call SalTblSetFlagsAnyRows(tbl1, ROW_Selected, FALSE, 0, 0)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 +  On WM_NCMouseMove ! 160
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 3 +  Pushbutton: pbBD
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.783"
.head 5 -  Top:    5.321"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: F12
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalIsWindowEnabled(dfBD)
.head 7 -  Call SalDisableWindow(dfBD)
.head 6 +  Else
.head 7 -  Call SalEnableWindow(dfBD)
.head 7 -  Call SalSetFocus(dfBD)
.head 3 +  Custom Control: ccProgressBar
.winattr class
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name: vti11.dll
.head 5 -  MS Windows Class Name: VT:cMeter:10
.head 5 -  Style:  0x00000000
.head 5 -  ExStyle:  0x00000000
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.117"
.head 6 -  Top:    4.786"
.head 6 -  Width:  10.867"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Etched Border? Yes
.head 5 -  Hollow? No
.head 5 -  Vertical Scroll? No
.head 5 -  Horizontal Scroll? No
.head 5 -  Tab Stop? None
.head 5 -  Tile To Parent? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Gray
.head 5 -  DLL Settings
.end
.head 4 -  Message Actions
.head 3 +  Data Field: dfBD
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   11.117"
.head 6 -  Top:    4.786"
.head 6 -  Width:  1.733"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfBD > dBat
.head 7 -  Call MessageNoWait('Локальная дата не может быть больше текущей банковской даты !',
     'ОШИБКА', 30, 1)
.head 7 -  Return VALIDATE_Cancel
.head 3 -  Background Text: Каталог импорта:
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    5.262"
.head 5 -  Width:  3.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Data Field: dfTekKat
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.383"
.head 6 -  Top:    5.262"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: FileZNListBox
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: smFiles[*]
.head 5 -  Number: nI
.head 5 -  Number: nFiles
.head 4 +  Actions
.head 5 -  Set nFiles = VisDosEnumFiles(sODBCDir || '\\RB????' || Sep98md(dfBD) || '.*', FA_Standard, smFiles)
.head 5 -  Set nI = 0
.head 5 -  Call SalListClear(dfFile)
.head 5 +  While nI < nFiles
.head 6 -  Call SalListAdd(dfFile, smFiles[nI])
.head 6 -  Set nI = nI + 1
.head 5 -  Call SalListSetSelect(dfFile, 0)
.head 5 -  Call SalSendMsg(dfFile, SAM_Click, 0, 0)
.head 3 +  Function: Perenos
.head 4 -  Description: Разбиение назначения платежа
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sTxt	! текст
.head 5 -  Number: nLen	! длина
.head 5 -  Number: nSpaces ! количество пробелов слева
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sNana[*]
.head 5 -  Number: nL
.head 5 -  String: sI
.head 5 -  Number: nJ
.head 5 -  Number: nC
.head 5 -  String: sRes
.head 4 +  Actions
.head 5 -  Set nL = 0
.head 5 -  Set sI = SalStrTrimX(sTxt)
.head 5 +  Loop
.head 6 +  If Len(sI) = 0
.head 7 -  Break
.head 6 +  If Len(sI) < nLen+1
.head 7 -  Set sNana[nL] = sI
.head 7 -  Break
.head 6 -  Set nJ = nLen + 1
.head 6 -  Set sNana[nL] = Left(sI, nJ)
.head 6 +  While nJ > 0
.head 7 +  If Subs(sNana[nL], nJ, 1) = ' ' or Subs(sNana[nL], nJ, 1) = ',' or
   Subs(sNana[nL], nJ, 1) = '.' or Subs(sNana[nL], nJ, 1) = ';' or
   Subs(sNana[nL], nJ, 1) = ':' or Subs(sNana[nL], nJ, 1) = '-'
.head 8 -  Set sNana[nL] = SalStrTrimX(Left(sNana[nL], nJ))
.head 8 -  Set sI = SalStrTrimX(Subs(sI, nJ+1, Len(sI)-nJ))
.head 8 -  Break
.head 7 -  Set nJ = nJ - 1
.head 7 +  If nJ = 0
.head 8 -  Set sI = SalStrTrimX(Subs(sI, nLen+1, Len(sI)-nLen))
.head 6 -  Set nL = nL + 1
.head 5 -  Set nC = 0
.head 5 -  Set sRes = ''
.head 5 +  While nC <= nL
.head 6 -  Set sRes = sRes || Spac(nSpaces) || sNana[nC] || PutCrLf()
.head 6 -  Set nC = nC + 1
.head 5 -  Return sRes
.head 3 +  Function: FScan
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sPar
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sStr
.head 5 -  Number: nNum
.head 5 -  Boolean: bRet
.head 4 +  Actions
.head 5 -  Set sStr = sPar
.head 5 -  Set bRet = TRUE
.head 5 +  Loop
.head 6 +  If sStr
.head 7 -  Call SalStrFirstC(sStr, nNum)
.head 7 -  ! Call DebugN(nNum)
.head 7 -  Set i = 0
.head 7 +  While i <= 32
.head 8 +  If SalNumberToChar(nNum) = msSimv[i]
.head 9 -  ! Call DebugN(i)
.head 9 -  Set bRet = FALSE
.head 9 -  Break
.head 8 -  Set i = i + 1
.head 6 +  Else
.head 7 -  Break
.head 6 +  If not bRet
.head 7 -  Break
.head 5 -  Return bRet
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  : ccDoc
.winattr class
.head 4 -  Class: cDoc
.end
.head 3 -  ! String: ND
.head 3 -  ! String: NLS
.head 3 -  ! String: NLSK
.head 3 -  ! Number: KVS
.head 3 -  ! Number: SK
.head 3 -  ! Number: REF
.head 3 -  ! Number: ISV
.head 3 -  ! String: NAZN
.head 3 -  String: sTmp
.head 3 -  ! Number: nCount
.head 3 -  Number: NS
.head 3 -  ! String: sAn
.head 3 -  ! String: sNbw
.head 3 -  ! Number: nNls
.head 3 -  String: sMfo
.head 3 -  ! String: sMdl
.head 3 -  ! Number: nMfop
.head 3 -  ! Number: nFetchRes
.head 3 -  ! String: sBlk
.head 3 -  ! String: sFv
.head 3 -  ! String: sFs
.head 3 -  String: sBankDay
.head 3 -  ! Number: nDocs
.head 3 -  Sql Handle: hSqlA
.head 3 -  Sql Handle: hSqlB
.head 3 -  Number: nPos
.head 3 -  Number: nDelta
.head 3 -  Number: nRecCount
.head 3 -  ! String: strMessage
.head 3 -  Number: nNm
.head 3 -  Number: nDk
.head 3 -  Number: nMfo
.head 3 -  String: sNd
.head 3 -  Number: nVob
.head 3 -  String: sNls
.head 3 -  String: sNlsk
.head 3 -  Number: nSk
.head 3 -  Number: nS
.head 3 -  Date/Time: dDat
.head 3 -  Date/Time: dPat
.head 3 -  Date/Time: dBat
.head 3 -  String: sPlat
.head 3 -  String: sPolu
.head 3 -  String: sNaz1
.head 3 -  String: sVspo
.head 3 -  String: sVspoDop
.head 3 -  String: sKod
.head 3 -  String: sKodB
.head 3 -  ! String: sKisp
.head 3 -  String: sSign
.head 3 -  Long String: lsSign
.head 3 -  ! Number: nRow
.head 3 -  Number: nRef
.head 3 -  String: sODBCDir
.head 3 -  String: sODBCDirCopy
.head 3 -  Date/Time: dTmp
.head 3 -  Number: nNp
.head 3 -  Number: n99
.head 3 -  Number: nSos
.head 3 -  Number: nKw
.head 3 -  !
.head 3 -  Number: nRef99bm
.head 3 -  Date/Time: dVdate
.head 3 -  !
.head 3 -  Number: nNewRow
.head 3 -  !
.head 3 -  Number: nTimeStart
.head 3 -  Number: nTimeCurrent
.head 3 -  Number: nTimeEnd
.head 3 -  Number: nHour
.head 3 -  Number: nMinu
.head 3 -  Number: nTemp
.head 3 -  Number: nTek
.head 3 -  Number: nRecn
.head 3 -  !
.head 3 -  Number: nCurrentRow
.head 3 -  Number: nP
.head 3 -  Number: nItog
.head 3 -  File Handle: hF
.head 3 -  Number: nColor
.head 3 -  String: sBuff
.head 3 -  String: sFr
.head 3 -  String: sTT
.head 3 -  String: sLev
.head 3 -  !
.head 3 -  Date/Time: dTemp
.head 3 -  Date/Time: dValu
.head 3 -  !
.head 3 -  Boolean: bNBU
.head 3 -  Number: nVOBtts
.head 3 -  !
.head 3 -  Date/Time: dTempDate
.head 3 -  !
.head 3 -  Number: hBtnYes
.head 3 -  Number: hBtnNo
.head 3 -  Number: hBtns[*]
.head 3 -  Number: nJur
.head 3 -  String: sTempDbf
.head 3 -  !
.head 3 -  String: sKASFIO
.head 3 -  String: sKASDOKsn
.head 3 -  String: sKASVID
.head 3 -  String: sKASDOK
.head 3 -  String: sKASSER
.head 3 -  String: sKASNDOK
.head 3 -  Boolean: b1
.head 3 -  Boolean: b2
.head 3 -  Boolean: b3
.head 3 -  !
.head 3 -  String: sSelectOper
.head 3 -  ! переменные для проверки реквизитов
.head 3 -  Boolean: bErr
.head 3 -  Boolean: bErrNLS
.head 3 -  String: sErrMes
.head 3 -  Number: i
.head 3 -  String: msSimv[33]
.head 3 -  String: sSAB
.head 3 -  String: sTmpNls
.head 3 -  !
.head 3 -  String: sR3
.head 3 -  Number: nR3
.head 3 -  String: sNDR3
.head 3 -  Boolean: br31
.head 3 -  Boolean: br32
.head 3 -  !
.head 3 -  Number: nFi
.head 3 -  Number: nYear
.head 3 -  Boolean: br3R
.head 3 -  Boolean: bn3
.head 3 -  Boolean: bF
.head 3 -  !
.head 3 -  String: smFilesRD[*]
.head 3 -  Boolean: bD
.head 3 -  Sql Handle: hSqlD
.head 3 -  String: smTAGd[*]
.head 3 -  String: smVALUEd[*]
.head 3 -  Number: nI
.head 3 -  Number: nK
.head 3 -  String: sTAGd
.head 3 -  String: sVALUEd
.head 3 -  Number: nBound
.head 3 -  !
.head 3 -  String: sVspoUGE
.head 3 -  Number: nIvs
.head 3 -  String: smREFd[*]
.head 3 -  String: sREFd
.head 3 -  Number: nFileVspo
.head 3 -  Boolean: mustProcess
.head 3 -  Number: nErrMsgSize
.head 3 -  Number: nSignRes
.head 3 -  String: szErrMsg
.head 3 -  !
.head 3 -  String: smFiles[*]
.head 3 -  Number: nmSizes[*]
.head 3 -  Date/Time: dmDateTimes[*]
.head 3 -  Number: nmAttributes[*]
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call ConPara('PUSH')
.head 4 -  Set hBtnYes = VisMessageLoadButton('&Да', 1)
.head 4 -  Set hBtnNo = VisMessageLoadButton('&Нет', 2)
.head 4 -  Call VisMessageSetBkgdColor(COLOR_Salmon)
.head 4 -  Set hBtns[0] = hBtnYes | MBF_DefButton
.head 4 -  Set hBtns[1] = hBtnNo
.head 4 -  Set sBankDay = GetBankDateEx()
.head 4 -  Set bNBU = GetGlobalOption('NBUBANK')='1'
.head 4 -  Set dBat = GetBankDate()
.head 4 -  Set dfBD = dBat
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'MoperR3Path', Left(SalFileGetDrive(), 1) ||
     ':\\BARS98\\ODBC.DSN\\MoperR3', sODBCDir, GetIniFileName())
.head 4 -  Call SalGetProfileString('Import', 'MoperR3PathCopy', Left(SalFileGetDrive(), 1) ||
     ':\\BARS98\\ODBC.DSN\\MoperR3Copy', sODBCDirCopy, GetIniFileName())
.head 4 -  Set dfTekKat = sODBCDir
.head 4 -  Set dfTekKat = sODBCDir
.head 4 -  Call FileZNListBox()
.head 4 -  Call SalDisableWindow(dfBD)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalHideWindow(dfStart)
.head 4 -  Call SalHideWindow(dfEnd)
.head 4 -  Call SalSetFocus(pbExit)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_Destroy
.head 4 -  Call ConPara('POP')
.head 4 -  Call Pl_dat(dBat)
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Form Window: frm_ImpMoper3
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Прием документов из R3 в структуре MOPER
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   1.1"
.head 4 -  Top:    0.917"
.head 4 -  Width:  17.433"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 7.917"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Прием документов и оплата документов из MOPERов 'старого' БАРСа (от R3)
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Всего:
.head 4 -  Resource Id: 15790
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.119"
.head 5 -  Width:  1.317"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfReccount
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Выбрано:
.head 4 -  Resource Id: 15791
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.783"
.head 5 -  Top:    0.095"
.head 5 -  Width:  1.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfAll
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Обработано:
.head 4 -  Resource Id: 15792
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.817"
.head 5 -  Top:    0.095"
.head 5 -  Width:  2.267"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfCurrent
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   12.317"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbExecute
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   4.25"
.head 5 -  Top:    6.964"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If dfFile ! есть ли входные файлы
.head 7 -  Call SalDisableWindow(dfBD)
.head 7 +  If IsBankDayOpen()
.head 8 +  If MessageQuestion('Прием/Оплата ' || IifS(cbAll, 'MOPERов от R3', dfFile) || ' ?') = IDNO
.head 9 -  Return FALSE
.head 8 -  ! Для проверки на недопустимые символы
.head 8 -  Set i = 0
.head 8 +  While i <= 31
.head 9 -  Set msSimv[i] = SalNumberToChar(i)
.head 9 -  Set i = i + 1
.head 8 -  Set msSimv[i] = SalNumberToChar(255)
.head 8 -  !
.head 8 -  Set nJur = TBL_MinRow
.head 8 -  ! организация цикла по COMBOboxУ
.head 8 -  Set bD = FALSE
.head 8 +  While Len(dfFile) > 0
.head 9 -  Set bOpl = FALSE
.head 9 -  ! Call SalArraySetUpperBound(nmREF, 1, -1)
.head 9 -  Call SalArraySetUpperBound(smREF, 1, -1)
.head 9 -  Call SalArraySetUpperBound(smTAG, 1, -1)
.head 9 -  Call SalArraySetUpperBound(smVALUE, 1, -1)
.head 9 -  Call SalWaitCursor(TRUE)
.head 9 -  ! Call SalDisableWindow(pbExecute)
.head 9 -  Call SalDisableWindow(pbExit)
.head 9 -  Set dfDone = ""
.head 9 -  Call SalUseRegistry(FALSE, '')
.head 9 -  Call SaveInfoToLog('Прием документов из ' || IifS(cbAll, 'MOPERов от R3', dfFile))
.head 9 -  Call SalFileCreateDirectory(sODBCDir || '\\TempODBC.Dir')
.head 9 -  Set nYear = SalDateYear(dfBD)
.head 9 -  !
.head 9 -  ! If SqlPrepareAndExecute(hSql(), "
   SELECT count(*)
   INTO   :nFi
   FROM   zag_r3
   WHERE  fn=:dfFile and god=:nYear") and SqlFetchNext(hSql(), nFetchRes) and nFi = 0
.head 9 -  !
.head 9 -  ! Убираем контроль на ПОВТОРНЫЙ приём файла от R3 (остаётся только контроль ДУБЛЕЙ документов)
.head 9 -  !
.head 9 +  ! If SqlPrepareAndExecute(hSql(), "
   SELECT count(*)
   INTO   :nFi
   FROM   r3_ndr3
   WHERE  filer3=:dfFile and god=:nYear") and SqlFetchNext(hSql(), nFetchRes) and nFi = 0
.head 10 -  Call SalFileSetCurrentDirectory(sODBCDir)
.head 10 -  Call SalFileCreateDirectory(sODBCDir || '\\TempODBC.Dir')
.head 10 -  Call SalFileSetCurrentDirectory(sODBCDir || '\\TempODBC.Dir')
.head 10 -  Set sTempDbf = 'Db' || Left(SalFmtFormatDateTime(SalDateCurrent(), 'mmmmmm'), 2) || SalFmtFormatDateTime(
    SalDateCurrent(), 'ssmm') || '.Dbf'
.head 10 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 10 -  Set SqlDatabase = 'dBase_Files'
.head 10 +  If SalFileGetDateTime(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf, dTmp)
.head 11 -  ! скопировать в каталог копии
.head 11 -  Call VisDosEnumFileInfo(sODBCDir || '\\' || dfFile, FA_Standard, smFiles, nmSizes, dmDateTimes,
     nmAttributes)
.head 11 +  If Subs(dfFile, 2, 1) = 'V'
.head 12 -  Call VisDosEnumFileInfo(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_Standard, smFiles2,
     nmSizes2, dmDateTimes2, nmAttributes2)
.head 11 +  Else 
.head 12 -  Call VisDosEnumFileInfo(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_Standard, smFiles2,
     nmSizes2, dmDateTimes2, nmAttributes2)
.head 11 -  ! Call VisDosMakeAllDir(sODBCDirCopy)
.head 11 -  Call SalFileCreateDirectory(sODBCDirCopy)
.head 11 +  If not File(sODBCDirCopy || '\\' || dfFile)
.head 12 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDirCopy || '\\' || dfFile)
.head 12 +  If Subs(dfFile, 2, 1) = 'V'
.head 13 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), sODBCDirCopy || '\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 12 +  Else 
.head 13 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), sODBCDirCopy || '\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 12 -  Call VisFileSetDateTime(sODBCDirCopy || '\\' || dfFile, dmDateTimes[0])
.head 12 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, TRUE)
.head 12 +  If Subs(dfFile, 2, 1) = 'V'
.head 13 -  Call VisFileSetDateTime(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), dmDateTimes2[0])
.head 13 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly, TRUE)
.head 12 +  Else 
.head 13 -  Call VisFileSetDateTime(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), dmDateTimes2[0])
.head 13 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly, TRUE)
.head 11 -  ! проверить, есть ли поле ref99bm в operxx, если нет, то добавить его
.head 11 -  Set n99 = -1
.head 11 -  Set dfDone = "Подождите ..."
.head 11 -  Call SalLoadAppAndWait("FindVar2 " || sODBCDir || '\\TempODBC.Dir\\' || sTempDbf || " ref99bm",
     Window_NotVisible, n99)
.head 11 -  ! Call DebugN(n99)
.head 11 +  If n99 = 1
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  ! удалить в NOT, но запросить сначала
.head 12 +  If VisMessageBox('Файл ' || dfFile || ' возможно занят другим пользователем. Удалить в NOT ?', 'ЗАПРОС',
   MBF_IconQuestion, hBtns, 2) = 1 ! ID_Yes
.head 13 -  Call SalWaitCursor(TRUE)
.head 13 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 13 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 13 +  If Subs(dfFile, 2, 1) = 'V'
.head 14 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), sODBCDir || '\\ArchivNO\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 13 +  Else 
.head 14 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), sODBCDir || '\\ArchivNO\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 13 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 14 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 14 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 14 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 14 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 14 +  If Subs(dfFile, 2, 1) = 'V'
.head 15 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly, FALSE)
.head 15 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 15 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly,
     FALSE)
.head 15 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 14 +  Else 
.head 15 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly, FALSE)
.head 15 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 15 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly,
     FALSE)
.head 15 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 12 -  Call FileZNListBox()
.head 12 -  Call SalEnableWindow(pbExecute)
.head 12 -  Call SalEnableWindow(pbExit)
.head 12 -  Break 
.head 11 +  If n99 = 2
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  ! удалить без запроса в NOT, но написать об этом
.head 12 -  Call MessageNoWait('Файл ' || dfFile || ' не DBF-структуры, удаляется в NOT !', 'ВНИМАНИЕ !', 37, 1)
.head 12 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 12 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 12 +  If Subs(dfFile, 2, 1) = 'V'
.head 13 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), sODBCDir || '\\ArchivNO\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 12 +  Else 
.head 13 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), sODBCDir || '\\ArchivNO\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 12 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 13 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 13 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 13 +  If Subs(dfFile, 2, 1) = 'V'
.head 14 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly, FALSE)
.head 14 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 14 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly,
     FALSE)
.head 14 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 13 +  Else 
.head 14 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly, FALSE)
.head 14 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 14 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly,
     FALSE)
.head 14 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 12 -  Call FileZNListBox()
.head 12 -  Call SalEnableWindow(pbExecute)
.head 12 -  Call SalEnableWindow(pbExit)
.head 12 -  Break 
.head 11 +  If n99 = 3
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  ! удалить без запроса в NOT, но написать об этом
.head 12 -  Call MessageNoWait('Файл ' || dfFile || ' имеет структуру не MOPER, удаляется в NOT !', 'ВНИМАНИЕ !', 37,
     1)
.head 12 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 12 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 12 +  If Subs(dfFile, 2, 1) = 'V'
.head 13 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), sODBCDir || '\\ArchivNO\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 12 +  Else 
.head 13 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), sODBCDir || '\\ArchivNO\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 12 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 13 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 13 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 13 +  If Subs(dfFile, 2, 1) = 'V'
.head 14 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly, FALSE)
.head 14 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 14 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly,
     FALSE)
.head 14 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 13 +  Else 
.head 14 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly, FALSE)
.head 14 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 14 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly,
     FALSE)
.head 14 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 12 -  Call FileZNListBox()
.head 12 -  Call SalEnableWindow(pbExecute)
.head 12 -  Call SalEnableWindow(pbExit)
.head 12 -  Break 
.head 11 -  Set dfDone = ""
.head 11 -  Call SalArraySetUpperBound(smFilesRD, 1, -1)
.head 11 +  If SqlConnect(hSqlA) and SqlConnect(hSqlB)
.head 12 -  Set mustProcess = TRUE
.head 12 -  ! проверка ЭЦП если включен режим DBFSIGN=1
.head 12 +  If GetGlobalOptionEx('DBFSIGN') = 1 and GetSignOn() = 1
.head 13 +  If GetSignType() = 'UNI'  ! пока только для UNI
.head 14 -  ! Call Debug( 'Включен режим проверки ЭЦП на DBF' )
.head 14 -  ! Call Debug( 'Key ID = '||GetIdOper() )
.head 14 -  Set nErrMsgSize = 4096
.head 14 -  ! Call SalStrSetBufferLength(szErrMsg, nErrMsgSize)
.head 14 -  Set szErrMsg = Spac(nErrMsgSize)
.head 14 -  Set nSignRes = SignProc('CHECK', sODBCDir || '\\' || dfFile, GetIdOper(), szErrMsg, nErrMsgSize)
.head 14 +  If nSignRes != 0
.head 15 +  If nSignRes = -999 ! собственно ЭЦП неверна
.head 16 -  Call SalWaitCursor(FALSE)
.head 16 -  ! удалить без запроса в NOT, но написать об этом
.head 16 -  ! || 'Оригинал: '||sODBCDir || '\\' || dfFile || PutCrLf()
  || 'Копия: '||sODBCDir || '\\TempODBC.Dir\\' ||sTempDbf || PutCrLf()
.head 16 -  Call MessageNoWait('ЭЦП на файл ' || dfFile || ' неверна! Удаляется в NOT!' || Repl(PutCrLf(), 2)
     || szErrMsg || PutCrLf(), 'ВНИМАНИЕ !', 51, 1)
.head 16 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 16 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 16 +  If Subs(dfFile, 2, 1) = 'V'
.head 17 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), sODBCDir ||
     '\\ArchivNO\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 16 +  Else 
.head 17 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), sODBCDir ||
     '\\ArchivNO\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 16 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 17 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 17 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 17 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 17 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 17 +  If Subs(dfFile, 2, 1) = 'V'
.head 18 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly,
     FALSE)
.head 18 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 18 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'),
     FA_ReadOnly, FALSE)
.head 18 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 17 +  Else 
.head 18 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly,
     FALSE)
.head 18 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 18 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'),
     FA_ReadOnly, FALSE)
.head 18 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 16 -  Call FileZNListBox()
.head 16 -  Call SalEnableWindow(pbExecute)
.head 16 -  Call SalEnableWindow(pbExit)
.head 16 -  !
.head 16 -  Set mustProcess = FALSE
.head 15 +  Else ! другие некритические ошибки
.head 16 +  If MessageQuestion('Проверка ЭЦП НБУ на файл ' || dfFile || PutCrLf() || szErrMsg ||
   PutCrLf() || 'Продолжить прием данного файла?') = IDNO
.head 17 -  Call SalWaitCursor(FALSE)
.head 17 -  ! удалить без запроса в NOT, но написать об этом
.head 17 -  Call MessageNoWait('Файл ' || dfFile || ' удаляется в NOT !', 'ВНИМАНИЕ !', 37, 1)
.head 17 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 17 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 17 +  If Subs(dfFile, 2, 1) = 'V'
.head 18 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), sODBCDir ||
     '\\ArchivNO\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 17 +  Else 
.head 18 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), sODBCDir ||
     '\\ArchivNO\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 17 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 18 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 18 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 18 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 18 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 18 +  If Subs(dfFile, 2, 1) = 'V'
.head 19 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly,
     FALSE)
.head 19 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 19 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'),
     FA_ReadOnly, FALSE)
.head 19 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 18 +  Else 
.head 19 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly,
     FALSE)
.head 19 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 19 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'),
     FA_ReadOnly, FALSE)
.head 19 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 17 -  Call FileZNListBox()
.head 17 -  Call SalEnableWindow(pbExecute)
.head 17 -  Call SalEnableWindow(pbExit)
.head 17 -  !
.head 17 -  Set mustProcess = FALSE
.head 14 +  Else 
.head 15 -  Call SaveInfoToLog('Проверка ЭЦП НБУ на файле ' || dfFile || PutCrLf() || szErrMsg)
.head 12 +  If mustProcess
.head 13 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT DA
     FROM   " || Left(sTempDbf, Len(sTempDbf)-4) || "
     INTO   :dTempDate")
.head 13 -  Call SqlFetchNext(hSqlA, nFetchRes)
.head 13 +  If dTempDate != dfBD
.head 14 -  Call SqlDisconnect(hSqlA)
.head 14 -  Call SqlDisconnect(hSqlB)
.head 14 -  Call SalWaitCursor(FALSE)
.head 14 -  Call MessageNoWait('Файл ' || dfFile || ' не за требуемую (' ||
     SalFmtFormatDateTime(dfBD, 'dd/MM/yyyy') || ') дату, удаляется в NOT !', 'ВНИМАНИЕ !', 37, 1)
.head 14 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 14 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 14 +  If Subs(dfFile, 2, 1) = 'V'
.head 15 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), sODBCDir || '\\ArchivNO\\'
     || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 14 +  Else 
.head 15 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), sODBCDir || '\\ArchivNO\\'
     || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 14 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 15 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 15 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 15 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 15 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 15 +  If Subs(dfFile, 2, 1) = 'V'
.head 16 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly,
     FALSE)
.head 16 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 16 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly,
     FALSE)
.head 16 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 15 +  Else 
.head 16 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly,
     FALSE)
.head 16 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 16 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly,
     FALSE)
.head 16 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 14 -  Call SalEnableWindow(pbExit)
.head 14 -  Call SalEnableWindow(pbExecute)
.head 14 -  Call FileZNListBox()
.head 14 -  ! удалить без запроса в NOT, но написать об этом
.head 14 -  Return FALSE
.head 13 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT count(*)
     FROM   " || Left(sTempDbf, Len(sTempDbf)-4) || "
     INTO   :nRecCount")
.head 13 -  Call SqlFetchNext(hSqlA, nFetchRes)
.head 13 -  Call SalShowWindow(dfStart)
.head 13 -  Call SalShowWindow(dfEnd)
.head 13 -  Set nTimeStart = SalDateHour(SalDateCurrent())*3600 + SalDateMinute(SalDateCurrent())*60 +
    SalDateSecond(SalDateCurrent())
.head 13 -  Set dfStart = 'Старт: ' || SalFmtFormatDateTime(SalDateCurrent(), 'hhh:mm:ss')
.head 13 -  Set dfReccount = nRecCount
.head 13 -  Set dfCurrent = 0
.head 13 -  Set dfAll = 0
.head 13 -  Set nPos = 0
.head 13 -  Set nTek = 0
.head 13 -  Set nRecn = 1
.head 13 -  Set nDelta = 100 / nRecCount
.head 13 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT fdat
     FROM   fdat
     WHERE  fdat=:dfBD")
.head 13 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 14 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   fdat (fdat)
     VALUES (:dfBD)")
.head 13 +  If dfBD != dBat
.head 14 -  ! Call Pl_dat(dfBD) ! Установить банковскую дату равной dfBD (но не совсем)
.head 13 -  Call SqlSetResultSet(hSqlA, FALSE)
.head 13 -  !
.head 13 -  Set sKASFIO = ''
.head 13 -  Set sKASDOKsn = ''
.head 13 -  Set sKASVID = ''
.head 13 -  Set sSelectOper = "
    SELECT nm,dk,mfo,nd,vob,nls,nlsk,sk,s,datd,da,plat,polu,naz1,vspo,kod,kodb,sign,ns,np,sos,ref99bm,
           vdate,kw,r3,ndr3" || IifS(n99>9, ",kasfio,kasdok,kasser,kasndok,kasvid", "") || "
    INTO   :nNm,:nDk,:nMfo,:sNd,:nVob,:sNls,:sNlsk,:nSk,:nS,:dDat,:dPat,:sPlat,:sPolu,:sNaz1,:sVspo,
           :sKod,:sKodB,:sSign,:NS,:nNp,:nSos,:nRef99bm,:dVdate,:nKw,:nR3,:sNDR3" || IifS(n99>9, ",
           :sKASFIO,:sKASDOK,:sKASSER,:sKASNDOK,:sKASVID", "") || "
    FROM   " || Left(sTempDbf, Len(sTempDbf)-4) || "
    FOR UPDATE OF sos"
.head 13 +  If not SqlPrepare(hSqlA, sSelectOper)
.head 14 -  Call SqlDisconnect(hSqlA)
.head 14 -  Call SqlDisconnect(hSqlB)
.head 14 -  Call SalEnableWindow(pbExit)
.head 14 -  Call SalSetFocus(pbExit)
.head 14 -  Break 
.head 13 -  Call SqlOpen(hSqlA, Left(sTempDbf, Len(sTempDbf)-4))
.head 13 -  Set bF = TRUE
.head 13 -  Set sVspoUGE = ''
.head 13 +  While SqlFetchNext(hSqlA, nFetchRes)
.head 14 -  Set nSos = IifN(nSos=NUMBER_Null, 0, nSos)
.head 14 -  Set sNls = SalStrTrimX(sNls)
.head 14 -  Set sNlsk = SalStrTrimX(sNlsk)
.head 14 -  ! Перекодировка
.head 14 -  Set sNd = SalStrTrimX(StrDosToWinX(sNd))
.head 14 -  Set sPlat = SalStrTrimX(StrDosToWinX(sPlat))
.head 14 -  Set sPolu = SalStrTrimX(StrDosToWinX(sPolu))
.head 14 -  Set sNaz1 = SalStrTrimX(StrDosToWinX(sNaz1))
.head 14 -  Set sVspo = DelRightSpace(StrDosToWinX(sVspo))
.head 14 -  Set sKASFIO = SalStrTrimX(StrDosToWinX(sKASFIO))
.head 14 -  Set sKASDOKsn = SalStrTrimX(StrDosToWinX(SalStrTrimX(sKASDOK) || ' ' || SalStrTrimX(sKASSER) || ' ' ||
    SalStrTrimX(sKASNDOK)))
.head 14 -  Set sKASVID = SalStrTrimX(StrDosToWinX(sKASVID))
.head 14 -  !
.head 14 -  Set sMfo = Str(nMfo)
.head 14 +  If dDat = DATETIME_Null
.head 15 -  Set dDat = dBat
.head 14 +  If dPat = DATETIME_Null
.head 15 -  Set dPat = dBat
.head 14 -  Set sKod  = SalStrTrimX(sKod)
.head 14 -  Set sKodB = SalStrTrimX(sKodB)
.head 14 -  Set lsSign = sSign
.head 14 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 14 -  Call SalTblSetFocusRow(tbl1, nNewRow)
.head 14 -  Set tbl1.colNPP = nRecn
.head 14 -  Set tbl1.colND = sNd
.head 14 -  Set tbl1.colVOB = nVob
.head 14 -  Set tbl1.colMFOA = IifS(Val(sNls)=0, '', sBankMfo)
.head 14 -  Set tbl1.colNLSA = sNls
.head 14 -  Set tbl1.colNAMA = sPlat
.head 14 +  If Val(sNls) = 0
.head 15 -  Set tbl1.colVALA = NUMBER_Null
.head 14 +  Else 
.head 15 -  Set tbl1.colVALA = 980
.head 14 -  Set tbl1.colMFOB = IifS(Val(sNls)=0, '', IifS(nMfo=0, sBankMfo, sMfo))
.head 14 -  Set tbl1.colNLSB = sNlsk
.head 14 -  Set tbl1.colNAMB = sPolu
.head 14 +  If Val(sNls) = 0
.head 15 -  Set tbl1.colVALB = NUMBER_Null
.head 14 +  Else 
.head 15 -  Set tbl1.colVALB = 980
.head 14 -  Set tbl1.colS = nS/100
.head 14 -  Set tbl1.colVDATE = dVdate
.head 14 -  Set tbl1.colNAZN = sNaz1
.head 14 -  !
.head 14 -  Set sR3 = Str(nR3)
.head 14 -  Set sNDR3 = SalStrTrimX(StrDosToWinX(sNDR3))
.head 14 -  !
.head 14 -  Set tbl1.colREF98 = nRef99bm
.head 14 -  Call SalTblSetRowFlags(tbl1, nNewRow, ROW_Edited | ROW_New, FALSE)
.head 14 +  If Val(sNls) = 0
.head 15 +  If nRecn = 1 and Len(sVspo) > 0 and Left(sVspo, 1) != '#'
.head 16 -  ! это служебная запись
.head 16 -  Set sVspoAdd = ''
.head 16 +  If File(sODBCDir || '\\' || sVspo)
.head 17 -  Call VisFileCopy(sODBCDir || '\\' || sVspo, sODBCDir || '\\TempODBC.Dir\\' || sVspo)
.head 17 -  Call VisFileCopy(sODBCDir || '\\' || sVspo, sODBCDir || '\\TempODBC.Dir\\GUNDOREN.DBF')
.head 17 -  Call SalArraySetUpperBound(smFilesRD, 1, -1)
.head 17 -  Set smFilesRD[0] = sVspo
.head 17 -  Set bD = TRUE
.head 17 +  If SqlConnect(hSqlC)
.head 18 -  ! вычитать в массивы файл (sVspo)
.head 18 -  ! If not SqlPrepare(hSqlC, "
   SELECT ref,tag,value
   FROM   " || sVspo || "
   INTO   :nREF,:sTAG,:sVALUE")
.head 18 +  If not SqlPrepare(hSqlC, '
   SELECT ref,tag,value
   FROM   GUNDOREN
   INTO   :sREF,:sTAG,:sVALUE')
.head 19 -  Call SqlDisconnect(hSqlA)
.head 19 -  Call SqlDisconnect(hSqlB)
.head 19 -  Call SqlDisconnect(hSqlC)
.head 19 -  Call SalEnableWindow(pbExit)
.head 19 -  Call SalSetFocus(pbExit)
.head 19 -  Break 
.head 18 -  Call SqlOpen(hSqlC, sVspo)
.head 18 -  Set nII = 0
.head 18 +  While SqlFetchNext(hSqlC, nFetchRes)
.head 19 -  ! Set nmREF[nII] = nREF
.head 19 -  Set smREF[nII] = SalStrTrimX(sREF)
.head 19 -  Set smTAG[nII] = StrDosToWinX(sTAG)
.head 19 -  Set smVALUE[nII] = StrDosToWinX(SalStrTrimX(sVALUE))
.head 19 -  Set nII = nII + 1
.head 18 -  Call SalFileSetCurrentDirectory(sODBCDir || '\\TempODBC.Dir')
.head 18 -  Call SqlDisconnect(hSqlC)
.head 18 -  Set sVspoAdd = sVspo
.head 18 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\GUNDOREN.DBF')
.head 16 +  Else 
.head 17 -  ! не принимаем файл вообще
.head 17 -  Call SalWaitCursor(FALSE)
.head 17 -  ! удалить в NOT, но запросить сначала
.head 17 +  If VisMessageBox('Файл ' || dfFile ||
   ' связан с ОТСУТСТВУЮЩИМ файлом дополнительных реквизитов (' || sVspo ||
   '). Удалить в NOT ?', 'ЗАПРОС', MBF_IconQuestion, hBtns, 2) = 1 ! ID_Yes
.head 18 -  Call SalWaitCursor(TRUE)
.head 18 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 18 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 18 +  If Subs(dfFile, 2, 1) = 'V'
.head 19 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), sODBCDir ||
     '\\ArchivNO\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 18 +  Else 
.head 19 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), sODBCDir ||
     '\\ArchivNO\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 18 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 19 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 19 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 19 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 19 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 19 +  If Subs(dfFile, 2, 1) = 'V'
.head 20 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'),
     FA_ReadOnly, FALSE)
.head 20 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 20 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'),
     FA_ReadOnly, FALSE)
.head 20 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 19 +  Else 
.head 20 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'),
     FA_ReadOnly, FALSE)
.head 20 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 20 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'),
     FA_ReadOnly, FALSE)
.head 20 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 17 -  ! Call FileZNListBox()
.head 17 -  Call SalEnableWindow(pbExecute)
.head 17 -  Call SalEnableWindow(pbExit)
.head 17 -  ! Call SqlDisconnect(hSqlA)
.head 17 -  ! Call SqlDisconnect(hSqlB)
.head 17 -  Break 
.head 16 -  ! Call Debug('sVspoAdd=' || sVspoAdd)
.head 15 -  !
.head 15 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Gray)
.head 14 -  Set sTTS = ''
.head 14 -  Set sVspoD = '' 
.head 14 +  If Len(sVspo) > 0
.head 15 -  Set nD = At('#d', sVspo)
.head 15 +  If nD > 0
.head 16 -  Set sVspoD = Subs(sVspo, nD, 53)
.head 16 -  Set sVspo = VisStrSubstitute(sVspo, sVspoD, '#')
.head 16 +  If Len(sVspo) = 1
.head 17 -  Set sVspo = ''
.head 15 -  Set nIt = At('#C', sVspo)
.head 15 +  If nIt > 0
.head 16 -  Set sTemp = Subs(sVspo, nIt+2, Len(sVspo)-1-nIt)
.head 16 -  Set nIt = At('#', sTemp)
.head 16 -  Set sTTS = IifS(nIt=0, sTemp, Left(sTemp, nIt-1))
.head 15 +  If Len(sVspo) > 0 and Len(sVspoD) > 0
.head 16 -  Set sVspo = Left(sVspo, Len(sVspo)-1) || sVspoD
.head 15 +  Else 
.head 16 -  Set sVspo = IifS(Len(sVspo)=0, sVspoD, sVspo)
.head 14 +  If Len(sTTS) > 0
.head 15 -  Set sTTS = Left(sTTS || '  ', 3)
.head 15 -  Set nTemp = 0
.head 15 +  If not SqlPrepareAndExecute(hSqlAux(), T("
   SELECT count(1)
   INTO   :nTemp
   FROM   tts
   WHERE  tt=:sTTS")) or not SqlFetchNext(hSqlAux(), nFetchRes)
.head 16 -  Set sTTS = ''
.head 15 +  Else 
.head 16 -  ! Call DebugN(nTemp)
.head 16 -  Set sTTS = IifS(nTemp=0, '', sTTS)
.head 14 +  If Len(sTTS) > 0
.head 15 -  Set sVspo = VisStrSubstitute(VisStrRightTrim(VisStrSubstitute(sVspo, '#C' || sTTS, '#C')), '#C#',
    '#')
.head 15 -  Set sVspo = IifS(sVspo='#', '', sVspo)
.head 14 +  If (nNm = 1 or nNm = 2) and nSos = 0 and nS > 0 and (not (nNp = 380 and nNm = 1 and
   (Left(sNls,4) = '3801' or Left(sNlsk,4) = '3801')) and not (nNp = 991 and nNm = 1 and
   (Left(sNls,4) = '1200' or Left(sNlsk,4) = '1200')))
.head 15 +  If nNm = 1
.head 16 -  Set sMfo = sBankMfo
.head 15 +  If sMfo = sBankMfo
.head 16 -  Set nNm = 1
.head 15 -  ! Проверка реквизитов
.head 15 -  Set bErr = FALSE
.head 15 -  Set bErrNLS = FALSE
.head 15 -  Set sErrMes = ''
.head 15 +  If not (((Len(sKod) = 8 and sKod = V_Okpo(sKod)) or (Len(sKod) = 9 or Len(sKod) = 10) or
   (Len(sKod) = 3) or (sKod = '99999')) and ((Len(sKodB) = 8 and sKodB = V_Okpo(sKodB)) or
   (Len(sKodB) = 9 or Len(sKodB) = 10) or (Len(sKodB) = 3) or (sKodB = '99999')))
.head 16 -  Set sErrMes = sErrMes || ' Отсутствует(ош) ОКРО А или ОКРО Б
'
.head 16 -  Set bErr = TRUE
.head 15 +  If not SqlPrepareAndExecute(hSqlAux(), "
   SELECT sab
   INTO   :sSAB
   FROM   banks
   WHERE  mfo=:sMfo") or not SqlFetchNext(hSqlAux(), nFetchRes)
.head 16 -  Set sErrMes = sErrMes || '
Ошибка МФО'
.head 16 -  Set bErr = TRUE
.head 15 +  Else 
.head 16 +  If Len(sNls) < 5 or sNls != Vkrz2(sBankMfo, sNls)
.head 17 -  Set sErrMes = sErrMes || '
Ошибка Счёт-А'
.head 17 -  Set bErr = TRUE
.head 17 -  Set bErrNLS = TRUE
.head 16 +  If Len(sNlsk) < 5 or sNlsk != Vkrz2(sMfo, sNlsk)
.head 17 -  Set sErrMes = sErrMes || '
Ошибка Счёт-Б'
.head 17 -  Set bErr = TRUE
.head 17 -  Set bErrNLS = TRUE
.head 16 +  Else If nNm != 1
.head 17 -  Call SqlPrepareAndExecute(hSqlAux(), "
     SELECT nbs
     FROM   nosep
     WHERE  kod=decode(Substr(:sMfo,1,1),'8',3,decode(Substr(:sSAB,3,1),'H',1,2)) and
            :sNlsk like nbs || '%'")
.head 17 +  If SqlFetchNext(hSqlAux(), nFetchRes)
.head 18 -  Set sErrMes = sErrMes || '
Недопустимый балансовый счёт'
.head 18 -  Set bErr = TRUE
.head 18 -  Set bErrNLS = TRUE
.head 15 +  If Len(sPlat) = 0
.head 16 -  Set sPlat = GetValueStr("
    SELECT trim(substr(NMS,1,38))
    FROM   accounts
    WHERE  nls='" || sNls || "' and kv=980")
.head 15 +  If Len(sPlat) < 3 or SalStrMidX(sPlat, 0, 1) = ' ' or not FScan(StrWinToDosX(sPlat))
.head 16 -  Set sErrMes = sErrMes || '
Ошибка в реквизите ПЛАТЕЛЬЩИК'
.head 16 -  Set bErr = TRUE
.head 15 +  If Len(sPolu) = 0 and sMfo = sBankMfo
.head 16 -  Set sPolu = GetValueStr("
    SELECT trim(substr(NMS,1,38))
    FROM   accounts
    WHERE  nls='" || sNlsk || "' and kv=980")
.head 15 +  If Len(sPolu) < 3 or SalStrMidX(sPolu, 0, 1) = ' ' or not FScan(StrWinToDosX(sPolu))
.head 16 -  Set sErrMes = sErrMes || '
Ошибка в реквизите ПОЛУЧАТЕЛЬ'
.head 16 -  Set bErr = TRUE
.head 15 +  If Len(sNaz1) < 3 or SalStrMidX(sNaz1, 0, 1) = ' ' or not FScan(StrWinToDosX(sNaz1))
.head 16 -  Set sErrMes = sErrMes || '
Ошибка в реквизите НАЗНАЧЕНИЕ'
.head 16 -  Set bErr = TRUE
.head 15 -  !
.head 15 -  Set sTT = ''
.head 15 -  ! Проверка реквизитов (end)
.head 15 +  If nSk > 0
.head 16 -  Set sTmp = sNls
.head 16 -  Set sNls = sNlsk
.head 16 -  Set sNlsk = sTmp
.head 16 +  ! If not cbRevPP
.head 17 -  Set sTmp = sPolu
.head 17 -  Set sPolu = sPlat
.head 17 -  Set sPlat = sTmp
.head 17 -  !
.head 16 -  ! переворот кассы (сальТо)
.head 16 -  Set sTmp = sPolu
.head 16 -  Set sPolu = sPlat
.head 16 -  Set sPlat = sTmp
.head 16 +  ! Прием информационных документов
.head 17 -  ! Set nDk = 1 - nDk
.head 16 +  If nDk = 1
.head 17 -  Set nDk = 0
.head 16 +  Else If nDk = 0
.head 17 -  Set nDk = 1
.head 16 -  ! Set nNm = nDk + 1005 ! добавлено МБГ
.head 16 -  Set nNm = nDk + 1085 ! добавлено для UPB и для всех остальных
.head 16 -  ! ! свежак
.head 16 +  If Len(sNLSKASSA) > 0
.head 17 -  Call SalArrayGetUpperBound(smNLSKASSA, 1, nI)
.head 17 -  Set nC = 0
.head 17 +  While nC <= nI
.head 18 +  If SalStrScan(sNlsk, smNLSKASSA[nC]) >= 0 and Len(smDK0KASSA[nC]) = 3 and
   Len(smDK1KASSA[nC]) = 3
.head 19 -  Set sTT = IifS(nDk=1, smDK0KASSA[nC], smDK1KASSA[nC])
.head 19 -  Break 
.head 18 -  Set nC = nC + 1
.head 15 +  Else 
.head 16 -  Set nSk = NUMBER_Null
.head 16 +  If nDk = nKw
.head 17 -  Set nDk = nDk + 2
.head 15 +  If nNm = 2 and NS = 8
.head 16 -  Call SqlPrepareAndExecute(hSqlAux(), T("
     SELECT nls
     INTO   :sNls
     FROM   accounts
     WHERE  tip='90D'"))
.head 16 -  Call SqlFetchNext(hSqlAux(), nFetchRes)
.head 15 -  Set nRef = NUMBER_Null
.head 15 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Blue)
.head 15 +  If (Len(sTT) = 0 and Len(sNLSKASSA) > 0) or Len(sNLSKASSA) = 0
.head 16 -  ! Set sTT = Right('NM' || IifS(nDk=0 and nNm=2, 'D', IifS(nDk>1 and nNm=2, 'I', Str(nNm))), 3)
.head 16 -  Set sTT = Right('R3' || IifS(nDk=0 and nNm=2, 'D', IifS(nDk>1, IifS(nNm=2, 'I', 'U'),
    Str(nNm))), 3)
.head 15 -  If SqlPrepareAndExecute(hSqlAux(), T("
   SELECT substr(flags,13,1)
   INTO   :sSTP
   FROM   tts
   WHERE  tt=:sTT")) and SqlFetchNext(hSqlAux(), nFetchRes)
.head 15 +  Else 
.head 16 -  Set sSTP = '0'
.head 15 -  Set tbl1.colSTP = Max(Val(sSTP)-1, 0)
.head 15 +  If bNBU and (sTT = '085' or sTT = '086') and
   SqlPrepareAndExecute(hSqlAux(), T("
   SELECT vob
   INTO   :nVOBtts
   FROM   tts_vob
   WHERE  tt=:sTT")) and SqlFetchNext(hSqlAux(), nFetchRes)
.head 16 -  Set nVob = nVOBtts
.head 16 -  Set tbl1.colVOB = nVob
.head 15 -  ! Проверка на доступ к счетам
.head 15 +  If not bErrNLS
.head 16 -  ! sNls
.head 16 +  If nDk = 0 and not (SqlPrepareAndExecute(hSqlAux(), "
   SELECT nls
   INTO   :sTmpNls
   FROM   saldok
   WHERE  nls=:sNls and kv=980") and SqlFetchNext(hSqlAux(), nFetchRes))
.head 17 -  Set sErrMes = sErrMes || '   Счет ' || sNls ||
' не доступен для Кредита
'
.head 17 -  Set bErr = TRUE
.head 16 +  Else If nDk = 1 and not (SqlPrepareAndExecute(hSqlAux(), "
     SELECT nls
     INTO   :sTmpNls
     FROM   saldod
     WHERE  nls=:sNls and kv=980") and SqlFetchNext(hSqlAux(), nFetchRes))
.head 17 -  Set sErrMes = sErrMes || '   Счет ' || sNls ||
' не доступен для Дебета
'
.head 17 -  Set bErr = TRUE
.head 16 +  Else If nDk > 1 and SqlPrepareAndExecute(hSqlAux(), "
     SELECT nls
     INTO   :sTmpNls
     FROM   accounts
     WHERE  nls=:sNls and kv=980 and dazs is not null") and SqlFetchNext(hSqlAux(), nFetchRes)
.head 17 -  Set sErrMes = sErrMes || '   Счет ' || sNls ||
' не доступен (ЗАКРЫТ)
'
.head 17 -  Set bErr = TRUE
.head 16 -  ! sNlsk
.head 16 +  If nNm = 1 or nNm > 1000
.head 17 +  If nDk = 0 and sMfo=sBankMfo and not (SqlPrepareAndExecute(hSqlAux(), "
   SELECT nls
   INTO   :sTmpNls
   FROM   saldod
   WHERE  nls=:sNlsk and kv=980") and SqlFetchNext(hSqlAux(), nFetchRes))
.head 18 -  Set sErrMes = sErrMes || '   Счет ' || sNlsk ||
' не доступен для Дебета
'
.head 18 -  Set bErr = TRUE
.head 17 +  Else If nDk = 1 and sMfo=sBankMfo and not (SqlPrepareAndExecute(hSqlAux(), "
     SELECT nls
     INTO   :sTmpNls
     FROM   saldok
     WHERE  nls=:sNlsk and kv=980") and SqlFetchNext(hSqlAux(), nFetchRes))
.head 18 -  Set sErrMes = sErrMes || '   Счет ' || sNlsk ||
' не доступен для Кредита
'
.head 18 -  Set bErr = TRUE
.head 17 +  Else If nDk > 1 and SqlPrepareAndExecute(hSqlAux(), "
     SELECT nls
     INTO   :sTmpNls
     FROM   accounts
     WHERE  nls=:sNlsk and kv=980 and dazs is not null") and SqlFetchNext(hSqlAux(), nFetchRes)
.head 18 -  Set sErrMes = sErrMes || '   Счет ' || sNlsk ||
' не доступен (ЗАКРЫТ)
'
.head 18 -  Set bErr = TRUE
.head 15 -  !
.head 15 +  If bErr
.head 16 -  Call SalMessageBox('Документ на сумму ' || Str(nS/100) ||
' не принят.
' || sErrMes, 'Внимание!', MB_Ok | MB_IconExclamation)
.head 16 -  Set tbl1.colComm = sErrMes
.head 16 -  Set tbl1.colREF98 = NUMBER_Null
.head 16 -  Set tbl1.colSTP = NUMBER_Null
.head 16 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Red)
.head 15 -  ! Modify by ANNY 18-10-2001
.head 15 +  Else 
.head 16 +  If nVob = 96 or nVob = 99
.head 17 -  Set dTemp = IifD(nVob=96, SalDateMonthBegin(dfBD), SalDateYearBegin(dfBD)) - 1
.head 17 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT max(fdat)
     INTO   :dValu
     FROM   fdat
     WHERE  fdat<=:dTemp")
.head 17 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 18 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   fdat (fdat)
     VALUES (:dTemp)")
.head 18 -  Set dValu = dTemp
.head 17 +  If dValu != dfBD
.head 18 -  ! Call Pl_dat(dValu) ! Установить банковскую дату
.head 16 +  Else 
.head 17 -  Set dValu = dfBD
.head 16 -  ! Set sVspoDop = ''
.head 16 -  ! Set nFileVspo = 0
.head 16 +  ! If Len(sVspo) > 0
.head 17 +  ! If File(sODBCDir || '\\' || sVspo)
.head 18 -  Set nFileVspo = 1
.head 17 +  ! Else
.head 18 -  Set nFileVspo = 2
.head 17 -  Set nFileVspo = IifN(File(sODBCDir || '\\' || sVspo), 1, 2)
.head 17 -  Set sVspoDop = sVspo
.head 17 -  Set sVspo = ''
.head 16 -  ! Call DebugN(nFileVspo)
.head 16 -  !
.head 16 -  Set sTT = IifS(Len(sTTS)=3, sTTS, sTT)
.head 16 -  If SqlPrepareAndExecute(hSqlAux(), T("
   SELECT substr(flags,13,1)
   INTO   :sSTP
   FROM   tts
   WHERE  tt=:sTT")) and SqlFetchNext(hSqlAux(), nFetchRes)
.head 16 +  Else 
.head 17 -  Set sSTP = '0'
.head 16 -  Set tbl1.colSTP = Max(Val(sSTP)-1, 0)
.head 16 -  Call ccDoc.SetDoc(0, sTT, nDk, nVob, sNd, dDat, dValu, dValu, dValu, sNls, sPlat, sBankMfo, '',
     980, nS, sKod, sNlsk, sPolu, sMfo, '', 980, nS, sKodB, sNaz1, sVspo, GetIdOper(), '', nSk, 0)
.head 16 -  Set ccDoc.m_sDrec = sVspo
.head 16 -  Set dfAll = dfAll + 1
.head 16 -  ! Call Debug('до ccDoc.oDoc')
.head 16 +  If ccDoc.oDoc()
.head 17 -  Set br31 = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO   operw (ref,tag,value)
    VALUES (:ccDoc.m_nRef,'KS_R3',:sR3)"))
.head 17 -  Set br32 = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO   operw (ref,tag,value)
    VALUES (:ccDoc.m_nRef,'KS_ND',:sNDR3)"))
.head 17 -  Set br3R = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO   operw (ref,tag,value)
    VALUES (:ccDoc.m_nRef,'KS_FI',:dfFile)"))
.head 17 -  ! Set nYear = SalDateYear(dfBD)
.head 17 -  Set nYear = SalDateYear(dValu)
.head 17 -  Set bn3 = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO   r3_ndr3 (filer3,ndr3,god,ref)
    VALUES (:dfFile,:sNDR3,:nYear,:ccDoc.m_nRef)"))
.head 17 +  If not bn3
.head 18 -  Set tbl1.colComm = 'Документ № ' || sNDR3 || ' ранее УЖЕ принимался!'
.head 18 -  Set tbl1.colREF98 = NUMBER_Null
.head 18 -  Set tbl1.colSTP = NUMBER_Null
.head 18 -  Call MessageNoWait(tbl1.colComm , 'ВНИМАНИЕ !!!', 0, 1)
.head 18 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Red)
.head 18 -  Call SqlRollback(hSql())
.head 18 -  Set bF = FALSE
.head 17 +  Else 
.head 18 -  Set b1 = TRUE
.head 18 -  Set b2 = b1
.head 18 -  Set b3 = b1
.head 18 +  If Len(sKASVID) > 0
.head 19 -  Set b1 = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO   operw (ref,tag,value)
    VALUES (:ccDoc.m_nRef,'ATRT',:sKASVID)"))
.head 18 +  If Len(sKASDOKsn) > 0
.head 19 -  Set b2 = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO   operw (ref,tag,value)
    VALUES (:ccDoc.m_nRef,'PASP',:sKASDOKsn)"))
.head 18 +  If Len(sKASFIO) > 0
.head 19 -  Set b3 = SqlPrepareAndExecute(hSql(), T("
   INSERT
   INTO   operw (ref,tag,value)
   VALUES (:ccDoc.m_nRef,'FIO',:sKASFIO)"))
.head 18 +  If b1 and b2 and b3
.head 19 -  ! вставка TAGов из файла дополнительных реквизитов
.head 19 -  Set b4 = TRUE
.head 19 -  ! Call VisArrayCopy(nmREF, nmREFrab, DT_Number)
.head 19 -  Call VisArrayCopy(smREF, smREFrab, DT_String)
.head 19 -  Call VisArrayCopy(smTAG, smTAGrab, DT_String)
.head 19 -  Call VisArrayCopy(smVALUE, smVALUErab, DT_String)
.head 19 -  Set bEE = TRUE
.head 19 +  While bEE
.head 20 -  Call SalArrayDimCount(smREFrab, nII)
.head 20 +  If nII > 0
.head 21 -  ! Set nII = VisArrayFindNumber(nmREFrab, Val(sNDR3))
.head 21 -  Set nII = VisArrayFindString(smREFrab, sNDR3)
.head 21 +  If nII >= 0 ! found !!!
.head 22 -  Set sTAG = SalStrTrimX(smTAGrab[nII])
.head 22 -  Set sVALUE = SalStrTrimX(smVALUErab[nII])
.head 22 -  Set b4 = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO   operw (ref,tag,value)
    VALUES (:ccDoc.m_nRef,:sTAG,:sVALUE)"))
.head 22 -  ! Call VisArrayDeleteItem(nmREFrab, nII, DT_Number)
.head 22 -  Call VisArrayDeleteItem(smREFrab, nII, DT_String)
.head 22 -  Call VisArrayDeleteItem(smTAGrab, nII, DT_String)
.head 22 -  Call VisArrayDeleteItem(smVALUErab, nII, DT_String)
.head 22 -  Set bEE = b4
.head 21 +  Else 
.head 22 -  Set bEE = FALSE
.head 20 +  Else 
.head 21 -  Set bEE = FALSE
.head 19 +  If b4
.head 20 +  If SqlPrepareAndExecute(hSqlB, "
   UPDATE " || Left(sTempDbf, Len(sTempDbf)-4) || "
   SET    sos=9
   WHERE  CURRENT OF " || Left(sTempDbf, Len(sTempDbf)-4))
.head 21 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE oper
     SET    prty=:tbl1.colSTP
     WHERE  ref=:ccDoc.m_nRef")
.head 21 -  Call SqlCommit(hSql())
.head 21 -  Call SaveInfoToLog('принят док Ref' || Str(ccDoc.m_nRef) || ': ' || sNls || '(980) ' ||
     Str(nS) || ' -> ' || sMfo || ' ' || sNlsk || '(980) ' || Str(nS) || '[' || sPolu ||
     '],[' || sNaz1 || '] ' || GetIdOper())
.head 21 -  Set bOpl = TRUE
.head 21 -  ! Call Pl_dat(dfBD) ! Возвратить банковскую дату
.head 21 -  Set tbl1.colREF98 = ccDoc.m_nRef
.head 21 -  Set tbl1.colComm = 'Документ принят'
.head 21 -  Set tbl1.colTT = sTT
.head 21 -  ! (COLOR_DarkGreen) оплачен
.head 21 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_DarkGreen)
.head 21 -  Set dfCurrent = dfCurrent + 1
.head 21 +  If Mod(n99, 10) = 0 Or Mod(n99, 10) = 7
.head 22 -  Call SqlPrepareAndExecute(hSqlB, "
     UPDATE " || Left(sTempDbf, Len(sTempDbf)-4) || "
     SET    sos=9,ref99bm=:ccDoc.m_nRef
     WHERE  CURRENT OF " || Left(sTempDbf, Len(sTempDbf)-4))
.head 20 +  Else 
.head 21 -  Call SaveErrorToLog('ош. UPDATE ' || Left(sTempDbf, Len(sTempDbf)-4) ||
     ' SET sos=9 док №' || sNd || ': ' || sNls || '(980) ' || Str(nS) || ' -> ' || sMfo
     || ' ' || sNlsk || '(980) ' || Str(nS) || '[' || sPolu || '],[' || sNaz1 || '] ' ||
     GetIdOper())
.head 21 -  Set tbl1.colComm = 'ош. UPDATE SET sos=9'
.head 21 -  Set tbl1.colREF98 = NUMBER_Null
.head 21 -  Set tbl1.colSTP = NUMBER_Null
.head 21 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Red)
.head 21 -  Call SqlRollback(hSql())
.head 21 -  Set bF = FALSE
.head 19 +  Else 
.head 20 -  Call MessageNoWait('ош. вставки в OPERw (доп. реквизит ' || SalStrTrimX(sTAG) || ') док №'
     || sNd || ':' || PutCrLf() || sNls || '(980) ' || Str(nS) || ' ->' || PutCrLf() ||
     sMfo || ' ' || sNlsk || '(980) ' || Str(nS) || PutCrLf() || '[' || sPolu || ']' ||
     PutCrLf() || '[' || sNaz1 || '] ' || PutCrLf() || GetIdOper(), 'ОШИБКА !!!', 17, 1)
.head 20 -  Set tbl1.colComm = 'ош. вставки в OPERw (доп. реквизит ' || SalStrTrimX(sTAG) || ')'
.head 20 -  Set tbl1.colREF98 = NUMBER_Null
.head 20 -  Set tbl1.colSTP = NUMBER_Null
.head 20 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Red)
.head 20 -  Call SqlRollback(hSql())
.head 20 -  Set bF = FALSE
.head 18 +  Else 
.head 19 -  Call SaveErrorToLog('ош. вставки в OPERw док №'|| sNd || ': ' || sNls || '(980) ' || Str(nS)
     || ' -> ' || sMfo || ' ' || sNlsk || '(980) ' || Str(nS) || '[' || sPolu || '],[' ||
     sNaz1 || '] ' || GetIdOper())
.head 19 -  Set tbl1.colComm = 'ош. вставки в OPERw'
.head 19 -  Set tbl1.colREF98 = NUMBER_Null
.head 19 -  Set tbl1.colSTP = NUMBER_Null
.head 19 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Red)
.head 19 -  Call SqlRollback(hSql())
.head 19 -  Set bF = FALSE
.head 16 +  Else 
.head 17 -  Call SaveInfoToLog('ошибка при оплате док №' || sNd || ': ' || sNls || '(980) ' || Str(nS) ||
     ' -> ' || sMfo || ' ' || sNlsk || '(980) ' || Str(nS) || '[' || sPolu || '],[' || sNaz1 ||
     '] ' || GetIdOper())
.head 17 -  Set tbl1.colComm = 'ошибка при оплате док.'
.head 17 -  Set tbl1.colREF98 = NUMBER_Null
.head 17 -  Set tbl1.colSTP = NUMBER_Null
.head 17 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Red)
.head 17 -  Call SqlRollback(hSql())
.head 17 -  Set bF = FALSE
.head 17 +  ! If not g_bSignInited ! ccDoc.m_bEscPin
.head 18 -  Call SaveInfoToLog('Прием документов из ' || dfFile || ' ПРЕРВАН')
.head 18 -  ! Call DebugN(ccDoc.m_nTim)
.head 18 -  Call SalEnableWindow(pbExit)
.head 18 -  Call SalEnableWindow(pbExecute)
.head 18 -  Break 
.head 16 -  ! Call Pl_dat(dfBD) ! Возвратить банковскую дату
.head 14 -  Call SalTblSetCellTextColor(tbl1.colNPP, COLOR_Charcoal, TRUE)
.head 14 -  Set nPos = nPos + nDelta
.head 14 -  Set nRecn = nRecn + 1
.head 14 +  If Int(nPos) != nTek
.head 15 -  Set nTek = Int(nPos)
.head 15 -  Set nTimeCurrent = SalDateHour(SalDateCurrent())*3600 + SalDateMinute(SalDateCurrent())*60 +
     SalDateSecond(SalDateCurrent())
.head 15 -  Set nTimeEnd = Int(100 * (nTimeCurrent-nTimeStart) / nPos + nTimeStart)
.head 15 -  Set nHour = Int(nTimeEnd/3600)
.head 15 -  Set nTemp = nTimeEnd - nHour*3600
.head 15 -  Set nMinu = Int(nTemp/60)
.head 15 -  Set dfStart = dfStart
.head 15 -  Set dfEnd = 'Финиш: ' || Right(Str(100+nHour), 2) || ':' || Right(Str(100+nMinu), 2) || ':' ||
    Right(Str(100+nTemp-nMinu*60), 2) || ' (прогноз)'
.head 15 -  Set dfReccount = dfReccount
.head 15 -  Set dfCurrent = dfCurrent
.head 15 -  Set dfAll = dfAll
.head 14 -  Call ccProgressBar.SetProgress(nPos)
.head 14 -  Call SalUpdateWindow(hWndForm)
.head 13 -  Call ccProgressBar.SetProgress(100)
.head 13 -  Call SqlCommitEx(hSql(), 'OK')
.head 13 -  Call SqlCommit(hSqlB)
.head 13 -  Call SqlDisconnect(hSqlA)
.head 13 -  Call SqlDisconnect(hSqlB)
.head 13 -  Call SaveInfoToLog('Прием документов из ' || dfFile || ' ОКОНЧЕН')
.head 13 -  Set dfDone = "Готово"
.head 13 -  Set dfEnd = Left(dfEnd, 15)
.head 13 +  If dfCurrent > 0
.head 14 -  ! сформировать файл оплаченных документов
.head 14 -  Set nCurrentRow = nJur
.head 14 -  Set nP = 1
.head 14 -  Set nItog = 0
.head 14 -  Set sFr = GetPrnDir() || '\\M' || Right(Str(SalDateMonth(dBat)+100), 2) || Right(Str(
    SalDateDay(dBat)+100), 2) || Right(Str(SalDateHour(SalDateCurrent())+100), 2) || Subs(Str(
    SalDateMinute(SalDateCurrent())+100), 2, 1) || '.' || Right(Str(SalDateMinute(
    SalDateCurrent())), 1) || Right(Str(SalDateSecond(SalDateCurrent())+100), 2)
.head 14 -  Call SalFileOpen(hF, sFr, OF_Create | OF_Write)
.head 14 -  Set sBuff = StrWinToDosX(SalStrTrimX(GetBankName()) || ' ' || SalStrTrimX(sBankMfo) || PutCrLf() ||
    'Дата и время формирования ' || SalFmtFormatDateTime(SalDateCurrent(), 'dd/MM/yyyy ') ||
    Right('0' || SalFmtFormatDateTime(SalDateCurrent(), 'hhhh:mm:ss'), 8) || PutCrLf() || PutCrLf() ||
    Spac(15) || 'Реестр оплаченных платежных документов' || PutCrLf() || Spac(15) || '(' || dfFile ||
    ') сеанс (с ' || Right(dfStart, 8) || ' по ') || Right(dfEnd, 8) || ')' || PutCrLf() ||
    Repl('-', 69) || PutCrLf()
.head 14 -  Call SalFileWrite(hF, sBuff, Len(sBuff))
.head 14 +  While SalTblFindNextRow(tbl1, nCurrentRow, 0, 0)
.head 15 -  Call SalTblSetFocusRow(tbl1, nCurrentRow)
.head 15 -  Set nColor = SalColorGet(tbl1.colNLSA,
    COLOR_IndexCellText)
.head 15 +  If nColor = COLOR_DarkGreen
.head 16 -  Set sLev = tbl1.colTT || ' реф.' || Str(tbl1.colREF98) || ', док.' || SalStrTrimX(tbl1.colND) ||
    ', оп.' || Str(tbl1.colVOB)
.head 16 -  Set sBuff = PadR(Str(nP) || '.', 4) || sBankMfo || ' ' || PadR(tbl1.colNLSA || '(' || Right(
    Str(tbl1.colVALA+1000), 3) || ')', 20) || StrWinToDosX(SalStrTrimX(tbl1.colNAMA) || PutCrLf()
    || '    ' || IifS(Val(tbl1.colMFOB)=0, sBankMfo, tbl1.colMFOB) || ' ' || PadR(tbl1.colNLSB ||
    '(' || Right(Str(tbl1.colVALB+1000), 3) || ')', 20) || SalStrTrimX(tbl1.colNAMB) || PutCrLf()
    || sLev || PadL('сумма ' || SalNumberToStrX(tbl1.colS, 2), 69-Len(sLev)) || PutCrLf() ||
    Perenos(tbl1.colNAZN, 65, 4)) || PutCrLf()
.head 16 -  Call SalFileWrite(hF, sBuff, Len(sBuff))
.head 16 -  Set nP = nP + 1
.head 16 -  Set nItog = nItog + tbl1.colS
.head 14 -  Set sBuff = Repl('-', 69) || PutCrLf() || StrWinToDosX('    Итого: ' || PadR(Str(nP-1), 20) ||
    'На сумму:') || PadL(SalNumberToStrX(nItog, 2), 29) || PutCrLf() || Repl('-', 69) || Repl(
    PutCrLf(), 3)
.head 14 -  Call SalFileWrite(hF, sBuff, Len(sBuff))
.head 14 -  Call SalFileClose(hF)
.head 13 -  Call SalMessageBeep(-1)
.head 13 +  If dfAll > dfCurrent and not bF
.head 14 -  ! удалить файл в NOT (по запросу)
.head 14 +  If VisMessageBox('ВНИМАНИЕ ! Файл ' || dfFile ||
   '. Обработаны не ВСЕ выбранные документы. Примите меры для исправления ошибок. ' ||
   'Переместить в NOT ?', 'ЗАПРОС', MBF_IconQuestion, hBtns, 2) = 1
 ! ID_Yes
.head 15 -  Call SalWaitCursor(FALSE)
.head 15 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 15 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 15 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 16 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 16 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 16 -  Call SalArrayGetUpperBound(smFilesRD, 1, nBound)
.head 16 +  If nBound >= 0
.head 17 -  Set nI = 0
.head 17 +  While nI <= nBound
.head 18 -  ! Call Debug(smFilesRD[nI])
.head 18 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || smFilesRD[nI], sODBCDir || '\\ArchivNO\\'
     || smFilesRD[nI])
.head 18 +  If File(sODBCDir || '\\ArchivNO\\' || smFilesRD[nI])
.head 19 -  Call VisFileDelete(sODBCDir || '\\' || smFilesRD[nI])
.head 18 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || smFilesRD[nI])
.head 18 -  Set nI = nI + 1
.head 16 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 16 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 16 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || sVspoAdd, FA_ReadOnly, FALSE)
.head 16 -  Call VisFileDelete(sODBCDirCopy || '\\' || sVspoAdd)
.head 16 -  Call FileZNListBox()
.head 14 +  Else 
.head 15 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf, sODBCDir || '\\' || dfFile)
.head 15 +  If File(sODBCDir || '\\' || dfFile)
.head 16 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 14 -  Call SalEnableWindow(pbExit)
.head 14 -  Call SalEnableWindow(pbExecute)
.head 14 -  Break 
.head 13 +  Else 
.head 14 -  Call SalWaitCursor(FALSE)
.head 14 -  ! записать в архив OK и удалить
.head 14 +  If VisMessageBox('ВНИМАНИЕ ! Файл ' || dfFile || ' обработан. Записать в АРХИВ(Ok) ?', 'ЗАПРОС',
   MBF_IconQuestion, hBtns, 2) = 1 ! ID_Yes
.head 15 -  Call SalWaitCursor(TRUE)
.head 15 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivOK')
.head 15 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf, sODBCDir || '\\ArchivOK\\' || dfFile)
.head 15 +  If File(sODBCDir || '\\ArchivOK\\' || dfFile)
.head 16 -  Set nYear = SalDateYear(dfBD)
.head 16 +  If bOpl
.head 17 +  If SqlPrepareAndExecute(hSql(), "
   UPDATE zag_r3
   set    fn=:dfFile,god=:nYear
   where  fn=:dfFile and god=:nYear")   
.head 18 +  If SqlGetModifiedRows(hSql(), nCount)
.head 19 +  If nCount = 0
.head 20 +  If SqlPrepareAndExecute(hSql(), "
   INSERT
   INTO   zag_r3 (fn,god)
   VALUES (:dfFile,:nYear)")
.head 21 -  Call SqlCommit(hSql())
.head 20 +  Else 
.head 21 -  Call SqlRollback(hSql())
.head 19 +  Else 
.head 20 -  Call SqlCommit(hSql())
.head 17 +  Else 
.head 18 -  Call SqlRollback(hSql())
.head 16 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 16 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 16 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 16 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 16 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || sVspoAdd, FA_ReadOnly, FALSE)
.head 16 -  Call VisFileDelete(sODBCDirCopy || '\\' || sVspoAdd)
.head 16 +  If bD
.head 17 -  Call SalArrayGetUpperBound(smFilesRD, 1, nBound)
.head 17 -  ! Call DebugN(nBound)
.head 17 +  If nBound >= 0
.head 18 -  Set nI = 0
.head 18 +  While nI <= nBound
.head 19 -  ! Call Debug(smFilesRD[nI])
.head 19 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || smFilesRD[nI], sODBCDir || '\\ArchivOK\\'
     || smFilesRD[nI])
.head 19 +  If File(sODBCDir || '\\ArchivOK\\' || smFilesRD[nI])
.head 20 -  Call VisFileDelete(sODBCDir || '\\' || smFilesRD[nI])
.head 19 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || smFilesRD[nI])
.head 19 -  Set nI = nI + 1
.head 16 -  Call FileZNListBox()
.head 14 +  Else 
.head 15 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf, sODBCDir || '\\' || dfFile)
.head 15 +  If File(sODBCDir || '\\' || dfFile)
.head 16 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 15 -  Call SalEnableWindow(pbExit)
.head 15 -  Call SalEnableWindow(pbExecute)
.head 15 -  Break 
.head 14 -  Call SalWaitCursor(TRUE)
.head 13 -  Call SalSetFocus(tbl1)
.head 13 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 13 -  Call FileZNListBox()
.head 13 -  Set nJur = nNewRow
.head 13 -  ! Call SalDisableWindow(pbExecute)
.head 11 +  Else 
.head 12 -  Call MessageAttention('Ошибка подсоединения к Базе данных: ' || SqlDatabase)
.head 10 +  Else 
.head 11 -  ! Call MessageAttention('Нет файла: ' || sODBCDir || dfFile || ' или он занят другим пользователем.')
.head 11 +  If VisMessageBox('Файл ' || dfFile || ' возможно занят другим пользователем. Удалить в NOT ?', 'ЗАПРОС',
   MBF_IconQuestion, hBtns, 2) = 1 ! ID_Yes
.head 12 -  Call SalWaitCursor(TRUE)
.head 12 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 12 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 12 +  If Subs(dfFile, 2, 1) = 'V'
.head 13 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), sODBCDir || '\\ArchivNO\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 12 +  Else 
.head 13 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), sODBCDir || '\\ArchivNO\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 12 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 13 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 13 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 13 +  If Subs(dfFile, 2, 1) = 'V'
.head 14 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly, FALSE)
.head 14 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 14 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly,
     FALSE)
.head 14 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 13 +  Else 
.head 14 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly, FALSE)
.head 14 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 14 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly,
     FALSE)
.head 14 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 11 -  Break 
.head 9 +  ! Else
.head 10 -  ! удалить файл в NOT
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call MessageNoWait('Файл ' || dfFile || ' уже принимался ранее, ' || PutCrLf() || 'удаляется в NOT !',
     'ВНИМАНИЕ !', 37, 1)
.head 10 -  Call SalWaitCursor(TRUE)
.head 10 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 10 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 10 +  If Subs(dfFile, 2, 1) = 'V'
.head 11 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), sODBCDir || '\\ArchivNO\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 10 +  Else 
.head 11 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), sODBCDir || '\\ArchivNO\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 10 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 11 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 11 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 11 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 11 +  If Subs(dfFile, 2, 1) = 'V'
.head 12 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly, FALSE)
.head 12 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 12 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly, FALSE)
.head 12 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 11 +  Else 
.head 12 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly, FALSE)
.head 12 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 12 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly, FALSE)
.head 12 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 11 -  !
.head 10 -  Call FileZNListBox()
.head 9 -  !
.head 9 -  Call SalFileSetCurrentDirectory(sODBCDir)
.head 9 -  Call SalFileCreateDirectory(sODBCDir || '\\TempODBC.Dir')
.head 9 -  Call SalFileSetCurrentDirectory(sODBCDir || '\\TempODBC.Dir')
.head 9 -  Set sTempDbf = 'Db' || Left(SalFmtFormatDateTime(SalDateCurrent(), 'mmmmmm'), 2) || SalFmtFormatDateTime(
    SalDateCurrent(), 'ssmm') || '.Dbf'
.head 9 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 9 -  Set SqlDatabase = 'dBase_Files'
.head 9 +  If SalFileGetDateTime(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf, dTmp)
.head 10 -  ! скопировать в каталог копии
.head 10 -  Call VisDosEnumFileInfo(sODBCDir || '\\' || dfFile, FA_Standard, smFiles, nmSizes, dmDateTimes, nmAttributes)
.head 10 +  If Subs(dfFile, 2, 1) = 'V'
.head 11 -  Call VisDosEnumFileInfo(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_Standard, smFiles2,
     nmSizes2, dmDateTimes2, nmAttributes2)
.head 10 +  Else
.head 11 -  Call VisDosEnumFileInfo(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_Standard, smFiles2,
     nmSizes2, dmDateTimes2, nmAttributes2)
.head 10 -  ! Call VisDosMakeAllDir(sODBCDirCopy)
.head 10 -  Call SalFileCreateDirectory(sODBCDirCopy)
.head 10 +  If not File(sODBCDirCopy || '\\' || dfFile)
.head 11 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDirCopy || '\\' || dfFile)
.head 11 +  If Subs(dfFile, 2, 1) = 'V'
.head 12 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), sODBCDirCopy || '\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 11 +  Else
.head 12 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), sODBCDirCopy || '\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 11 -  Call VisFileSetDateTime(sODBCDirCopy || '\\' || dfFile, dmDateTimes[0])
.head 11 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, TRUE)
.head 11 +  If Subs(dfFile, 2, 1) = 'V'
.head 12 -  Call VisFileSetDateTime(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), dmDateTimes2[0])
.head 12 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly, TRUE)
.head 11 +  Else
.head 12 -  Call VisFileSetDateTime(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), dmDateTimes2[0])
.head 12 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly, TRUE)
.head 10 -  ! проверить, есть ли поле ref99bm в operxx, если нет, то добавить его
.head 10 -  Set n99 = -1
.head 10 -  Set dfDone = "Подождите ..."
.head 10 -  ! Call SalLoadAppAndWait("FindVar2 " || sODBCDir || '\\TempODBC.Dir\\' || sTempDbf || " ref99bm",
     Window_NotVisible, n99)
.head 10 -  Set n99 = FindVar2(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf, 'ref99bm')
.head 10 -  ! Call DebugN(n99)
.head 10 +  If n99 = 1
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  ! удалить в NOT, но запросить сначала
.head 11 +  If VisMessageBox('Файл ' || dfFile || ' возможно занят другим пользователем. Удалить в NOT ?', 'ЗАПРОС',
   MBF_IconQuestion, hBtns, 2) = 1 ! ID_Yes
.head 12 -  Call SalWaitCursor(TRUE)
.head 12 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 12 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 12 +  If Subs(dfFile, 2, 1) = 'V'
.head 13 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), sODBCDir || '\\ArchivNO\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 12 +  Else
.head 13 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), sODBCDir || '\\ArchivNO\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 12 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 13 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 13 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 13 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 13 +  If Subs(dfFile, 2, 1) = 'V'
.head 14 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly, FALSE)
.head 14 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 14 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly,
     FALSE)
.head 14 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 13 +  Else
.head 14 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly, FALSE)
.head 14 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 14 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly,
     FALSE)
.head 14 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 11 -  Call FileZNListBox()
.head 11 -  Call SalEnableWindow(pbExecute)
.head 11 -  Call SalEnableWindow(pbExit)
.head 11 -  Break
.head 10 +  If n99 = 2
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  ! удалить без запроса в NOT, но написать об этом
.head 11 -  Call MessageNoWait('Файл ' || dfFile || ' не DBF-структуры, удаляется в NOT !', 'ВНИМАНИЕ !', 37, 1)
.head 11 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 11 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 11 +  If Subs(dfFile, 2, 1) = 'V'
.head 12 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), sODBCDir || '\\ArchivNO\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 11 +  Else
.head 12 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), sODBCDir || '\\ArchivNO\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 11 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 12 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 12 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 12 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 12 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 12 +  If Subs(dfFile, 2, 1) = 'V'
.head 13 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly, FALSE)
.head 13 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 13 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly, FALSE)
.head 13 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 12 +  Else
.head 13 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly, FALSE)
.head 13 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 13 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly, FALSE)
.head 13 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 11 -  Call FileZNListBox()
.head 11 -  Call SalEnableWindow(pbExecute)
.head 11 -  Call SalEnableWindow(pbExit)
.head 11 -  Break
.head 10 +  If n99 = 3
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  ! удалить без запроса в NOT, но написать об этом
.head 11 -  Call MessageNoWait('Файл ' || dfFile || ' имеет структуру не MOPER, удаляется в NOT !', 'ВНИМАНИЕ !', 37, 1)
.head 11 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 11 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 11 +  If Subs(dfFile, 2, 1) = 'V'
.head 12 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), sODBCDir || '\\ArchivNO\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 11 +  Else
.head 12 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), sODBCDir || '\\ArchivNO\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 11 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 12 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 12 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 12 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 12 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 12 +  If Subs(dfFile, 2, 1) = 'V'
.head 13 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly, FALSE)
.head 13 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 13 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly, FALSE)
.head 13 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 12 +  Else
.head 13 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly, FALSE)
.head 13 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 13 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly, FALSE)
.head 13 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 11 -  Call FileZNListBox()
.head 11 -  Call SalEnableWindow(pbExecute)
.head 11 -  Call SalEnableWindow(pbExit)
.head 11 -  Break
.head 10 -  Set dfDone = ""
.head 10 -  Call SalArraySetUpperBound(smFilesRD, 1, -1)
.head 10 +  If SqlConnect(hSqlA) and SqlConnect(hSqlB)
.head 11 -  Set mustProcess = TRUE
.head 11 -  ! проверка ЭЦП если включен режим DBFSIGN=1
.head 11 +  If GetGlobalOptionEx('DBFSIGN') = 1 and GetSignOn() = 1
.head 12 +  If GetSignType() = 'UNI'  ! пока только для UNI
.head 13 -  ! Call Debug( 'Включен режим проверки ЭЦП на DBF' )
.head 13 -  ! Call Debug( 'Key ID = '||GetIdOper() )
.head 13 -  Set nErrMsgSize = 4096
.head 13 -  ! Call SalStrSetBufferLength(szErrMsg, nErrMsgSize)
.head 13 -  Set szErrMsg = Spac(nErrMsgSize)
.head 13 -  Set nSignRes = SignProc('CHECK', sODBCDir || '\\' || dfFile, GetIdOper(), szErrMsg, nErrMsgSize)
.head 13 +  If nSignRes != 0
.head 14 +  If nSignRes = -999 ! собственно ЭЦП неверна
.head 15 -  Call SalWaitCursor(FALSE)
.head 15 -  ! удалить без запроса в NOT, но написать об этом
.head 15 -  ! || 'Оригинал: '||sODBCDir || '\\' || dfFile || PutCrLf()
  || 'Копия: '||sODBCDir || '\\TempODBC.Dir\\' ||sTempDbf || PutCrLf()
.head 15 -  Call MessageNoWait('ЭЦП на файл ' || dfFile || ' неверна! Удаляется в NOT!' || Repl(PutCrLf(), 2) ||
     szErrMsg || PutCrLf(), 'ВНИМАНИЕ !', 51, 1)
.head 15 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 15 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 15 +  If Subs(dfFile, 2, 1) = 'V'
.head 16 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), sODBCDir || '\\ArchivNO\\'
     || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 15 +  Else
.head 16 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), sODBCDir || '\\ArchivNO\\'
     || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 15 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 16 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 16 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 16 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 16 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 16 +  If Subs(dfFile, 2, 1) = 'V'
.head 17 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly,
     FALSE)
.head 17 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 17 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly,
     FALSE)
.head 17 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 16 +  Else
.head 17 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly,
     FALSE)
.head 17 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 17 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly,
     FALSE)
.head 17 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 15 -  Call FileZNListBox()
.head 15 -  Call SalEnableWindow(pbExecute)
.head 15 -  Call SalEnableWindow(pbExit)
.head 15 -  !
.head 15 -  Set mustProcess = FALSE
.head 14 +  Else ! другие некритические ошибки
.head 15 +  If MessageQuestion('Проверка ЭЦП НБУ на файл ' || dfFile || PutCrLf() || szErrMsg || PutCrLf() ||
   'Продолжить прием данного файла?') = IDNO
.head 16 -  Call SalWaitCursor(FALSE)
.head 16 -  ! удалить без запроса в NOT, но написать об этом
.head 16 -  Call MessageNoWait('Файл ' || dfFile || ' удаляется в NOT !', 'ВНИМАНИЕ !', 37, 1)
.head 16 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 16 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 16 +  If Subs(dfFile, 2, 1) = 'V'
.head 17 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), sODBCDir ||
     '\\ArchivNO\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 16 +  Else
.head 17 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), sODBCDir ||
     '\\ArchivNO\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 16 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 17 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 17 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 17 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 17 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 17 +  If Subs(dfFile, 2, 1) = 'V'
.head 18 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly,
     FALSE)
.head 18 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 18 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'),
     FA_ReadOnly, FALSE)
.head 18 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 17 +  Else
.head 18 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly,
     FALSE)
.head 18 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 18 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'),
     FA_ReadOnly, FALSE)
.head 18 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 16 -  Call FileZNListBox()
.head 16 -  Call SalEnableWindow(pbExecute)
.head 16 -  Call SalEnableWindow(pbExit)
.head 16 -  !
.head 16 -  Set mustProcess = FALSE
.head 13 +  Else
.head 14 -  Call SaveInfoToLog('Проверка ЭЦП НБУ на файле ' || dfFile || PutCrLf() || szErrMsg)
.head 11 +  If mustProcess
.head 12 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT DA
     FROM   " || Left(sTempDbf, Len(sTempDbf)-4) || "
     INTO   :dTempDate")
.head 12 -  Call SqlFetchNext(hSqlA, nFetchRes)
.head 12 +  If dTempDate != dfBD
.head 13 -  Call SqlDisconnect(hSqlA)
.head 13 -  Call SqlDisconnect(hSqlB)
.head 13 -  Call SalWaitCursor(FALSE)
.head 13 -  Call MessageNoWait('Файл ' || dfFile || ' не за требуемую (' || SalFmtFormatDateTime(dfBD, 'dd/MM/yyyy')
     || ') дату, удаляется в NOT !', 'ВНИМАНИЕ !', 37, 1)
.head 13 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 13 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 13 +  If Subs(dfFile, 2, 1) = 'V'
.head 14 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), sODBCDir || '\\ArchivNO\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 13 +  Else
.head 14 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), sODBCDir || '\\ArchivNO\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 13 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 14 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 14 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 14 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 14 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 14 +  If Subs(dfFile, 2, 1) = 'V'
.head 15 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly, FALSE)
.head 15 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 15 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly,
     FALSE)
.head 15 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 14 +  Else
.head 15 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly, FALSE)
.head 15 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 15 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly,
     FALSE)
.head 15 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 13 -  Call SalEnableWindow(pbExit)
.head 13 -  Call SalEnableWindow(pbExecute)
.head 13 -  Call FileZNListBox()
.head 13 -  ! удалить без запроса в NOT, но написать об этом
.head 13 -  Return FALSE
.head 12 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT count(*)
     FROM   " || Left(sTempDbf, Len(sTempDbf)-4) || "
     INTO   :nRecCount")
.head 12 -  Call SqlFetchNext(hSqlA, nFetchRes)
.head 12 -  Call SalShowWindow(dfStart)
.head 12 -  Call SalShowWindow(dfEnd)
.head 12 -  Set nTimeStart = SalDateHour(SalDateCurrent())*3600 + SalDateMinute(SalDateCurrent())*60 + SalDateSecond(
    SalDateCurrent())
.head 12 -  Set dfStart = 'Старт: ' || SalFmtFormatDateTime(SalDateCurrent(), 'hhh:mm:ss')
.head 12 -  Set dfReccount = nRecCount
.head 12 -  Set dfCurrent = 0
.head 12 -  Set dfAll = 0
.head 12 -  Set nPos = 0
.head 12 -  Set nTek = 0
.head 12 -  Set nRecn = 1
.head 12 -  Set nDelta = 100 / nRecCount
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT fdat
     FROM   fdat
     WHERE  fdat=:dfBD")
.head 12 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 13 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   fdat (fdat)
     VALUES (:dfBD)")
.head 12 +  If dfBD != dBat
.head 13 -  ! Call Pl_dat(dfBD) ! Установить банковскую дату равной dfBD (но не совсем)
.head 12 -  Call SqlSetResultSet(hSqlA, FALSE)
.head 12 -  !
.head 12 -  Set sKASFIO = ''
.head 12 -  Set sKASDOKsn = ''
.head 12 -  Set sKASVID = ''
.head 12 -  Set sSelectOper = "
    SELECT nm,dk,mfo,nd,vob,nls,nlsk,sk,s,datd,da,plat,polu,naz1,vspo,kod,kodb,sign,ns,np,sos,ref99bm,
           vdate,kw,r3,ndr3" || IifS(n99>9, ",kasfio,kasdok,kasser,kasndok,kasvid", "") || "
    INTO   :nNm,:nDk,:nMfo,:sNd,:nVob,:sNls,:sNlsk,:nSk,:nS,:dDat,:dPat,:sPlat,:sPolu,:sNaz1,:sVspo,:sKod,
           :sKodB,:sSign,:NS,:nNp,:nSos,:nRef99bm,:dVdate,:nKw,:nR3,:sNDR3" || IifS(n99>9, ",:sKASFIO,
           :sKASDOK,:sKASSER,:sKASNDOK,:sKASVID", "") || "
    FROM   " || Left(sTempDbf, Len(sTempDbf)-4) || "
    FOR UPDATE OF sos"
.head 12 +  If not SqlPrepare(hSqlA, sSelectOper)
.head 13 -  Call SqlDisconnect(hSqlA)
.head 13 -  Call SqlDisconnect(hSqlB)
.head 13 -  Call SalEnableWindow(pbExit)
.head 13 -  Call SalSetFocus(pbExit)
.head 13 -  Break
.head 12 -  Call SqlOpen(hSqlA, Left(sTempDbf, Len(sTempDbf)-4))
.head 12 -  Set bF = TRUE
.head 12 -  Set sVspoUGE = ''
.head 12 +  While SqlFetchNext(hSqlA, nFetchRes)
.head 13 -  Set nSos = IifN(nSos=NUMBER_Null, 0, nSos)
.head 13 -  Set sNls = SalStrTrimX(sNls)
.head 13 -  Set sNlsk = SalStrTrimX(sNlsk)
.head 13 -  ! Перекодировка
.head 13 -  Set sNd = SalStrTrimX(StrDosToWinX(sNd))
.head 13 -  Set sPlat = SalStrTrimX(StrDosToWinX(sPlat))
.head 13 -  Set sPolu = SalStrTrimX(StrDosToWinX(sPolu))
.head 13 -  Set sNaz1 = SalStrTrimX(StrDosToWinX(sNaz1))
.head 13 -  Set sVspo = DelRightSpace(StrDosToWinX(sVspo))
.head 13 -  Set sKASFIO = SalStrTrimX(StrDosToWinX(sKASFIO))
.head 13 -  Set sKASDOKsn = SalStrTrimX(StrDosToWinX(SalStrTrimX(sKASDOK) || ' ' || SalStrTrimX(sKASSER) || ' ' ||
    SalStrTrimX(sKASNDOK)))
.head 13 -  Set sKASVID = SalStrTrimX(StrDosToWinX(sKASVID))
.head 13 -  !
.head 13 -  Set sMfo = Str(nMfo)
.head 13 +  If dDat = DATETIME_Null
.head 14 -  Set dDat = dBat
.head 13 +  If dPat = DATETIME_Null
.head 14 -  Set dPat = dBat
.head 13 -  Set sKod  = SalStrTrimX(sKod)
.head 13 -  Set sKodB = SalStrTrimX(sKodB)
.head 13 -  Set lsSign = sSign
.head 13 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 13 -  Call SalTblSetFocusRow(tbl1, nNewRow)
.head 13 -  Set tbl1.colNPP = nRecn
.head 13 -  Set tbl1.colND = sNd
.head 13 -  Set tbl1.colVOB = nVob
.head 13 -  Set tbl1.colMFOA = IifS(Val(sNls)=0, '', sBankMfo)
.head 13 -  Set tbl1.colNLSA = sNls
.head 13 -  Set tbl1.colNAMA = sPlat
.head 13 +  If Val(sNls) = 0
.head 14 -  Set tbl1.colVALA = NUMBER_Null
.head 13 +  Else
.head 14 -  Set tbl1.colVALA = 980
.head 13 -  Set tbl1.colMFOB = IifS(Val(sNls)=0, '', IifS(nMfo=0, sBankMfo, sMfo))
.head 13 -  Set tbl1.colNLSB = sNlsk
.head 13 -  Set tbl1.colNAMB = sPolu
.head 13 +  If Val(sNls) = 0
.head 14 -  Set tbl1.colVALB = NUMBER_Null
.head 13 +  Else
.head 14 -  Set tbl1.colVALB = 980
.head 13 -  Set tbl1.colS = nS/100
.head 13 -  Set tbl1.colVDATE = dVdate
.head 13 -  Set tbl1.colNAZN = sNaz1
.head 13 -  !
.head 13 -  Set sR3 = Str(nR3)
.head 13 -  Set sNDR3 = SalStrTrimX(StrDosToWinX(sNDR3))
.head 13 -  !
.head 13 -  Set tbl1.colREF98 = nRef99bm
.head 13 -  Call SalTblSetRowFlags(tbl1, nNewRow, ROW_Edited | ROW_New, FALSE)
.head 13 +  If Val(sNls) = 0
.head 14 +  If nRecn = 1 and Len(sVspo) > 0 and Left(sVspo, 1) != '#'
.head 15 -  ! это служебная запись
.head 15 -  Set sVspoAdd = ''
.head 15 +  If File(sODBCDir || '\\' || sVspo)
.head 16 -  Call VisFileCopy(sODBCDir || '\\' || sVspo, sODBCDir || '\\TempODBC.Dir\\' || sVspo)
.head 16 -  Call VisFileCopy(sODBCDir || '\\' || sVspo, sODBCDir || '\\TempODBC.Dir\\GUNDOREN.DBF')
.head 16 -  Call SalArraySetUpperBound(smFilesRD, 1, -1)
.head 16 -  Set smFilesRD[0] = sVspo
.head 16 -  Set bD = TRUE
.head 16 +  If SqlConnect(hSqlC)
.head 17 -  ! вычитать в массивы файл (sVspo)
.head 17 -  ! If not SqlPrepare(hSqlC, "
   SELECT ref,tag,value
   FROM   " || sVspo || "
   INTO   :nREF,:sTAG,:sVALUE")
.head 17 +  If not SqlPrepare(hSqlC, '
   SELECT ref,tag,value
   FROM   GUNDOREN
   INTO   :sREF,:sTAG,:sVALUE')
.head 18 -  Call SqlDisconnect(hSqlA)
.head 18 -  Call SqlDisconnect(hSqlB)
.head 18 -  Call SqlDisconnect(hSqlC)
.head 18 -  Call SalEnableWindow(pbExit)
.head 18 -  Call SalSetFocus(pbExit)
.head 18 -  Break
.head 17 -  Call SqlOpen(hSqlC, sVspo)
.head 17 -  Set nII = 0
.head 17 +  While SqlFetchNext(hSqlC, nFetchRes)
.head 18 -  ! Set nmREF[nII] = nREF
.head 18 -  Set smREF[nII] = SalStrTrimX(sREF)
.head 18 -  Set smTAG[nII] = StrDosToWinX(sTAG)
.head 18 -  Set smVALUE[nII] = StrDosToWinX(SalStrTrimX(sVALUE))
.head 18 -  Set nII = nII + 1
.head 17 -  Call SalFileSetCurrentDirectory(sODBCDir || '\\TempODBC.Dir')
.head 17 -  Call SqlDisconnect(hSqlC)
.head 17 -  Set sVspoAdd = sVspo
.head 17 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\GUNDOREN.DBF')
.head 15 +  Else
.head 16 -  ! не принимаем файл вообще
.head 16 -  Call SalWaitCursor(FALSE)
.head 16 -  ! удалить в NOT, но запросить сначала
.head 16 +  If VisMessageBox('Файл ' || dfFile || ' связан с ОТСУТСТВУЮЩИМ файлом дополнительных реквизитов ('
   || sVspo || '). Удалить в NOT ?', 'ЗАПРОС', MBF_IconQuestion, hBtns, 2) = 1 ! ID_Yes
.head 17 -  Call SalWaitCursor(TRUE)
.head 17 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 17 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 17 +  If Subs(dfFile, 2, 1) = 'V'
.head 18 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), sODBCDir ||
     '\\ArchivNO\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 17 +  Else
.head 18 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), sODBCDir ||
     '\\ArchivNO\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 17 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 18 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 18 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 18 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 18 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 18 +  If Subs(dfFile, 2, 1) = 'V'
.head 19 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly,
     FALSE)
.head 19 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 19 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'),
     FA_ReadOnly, FALSE)
.head 19 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 18 +  Else
.head 19 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly,
     FALSE)
.head 19 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 19 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'),
     FA_ReadOnly, FALSE)
.head 19 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 16 -  ! Call FileZNListBox()
.head 16 -  Call SalEnableWindow(pbExecute)
.head 16 -  Call SalEnableWindow(pbExit)
.head 16 -  ! Call SqlDisconnect(hSqlA)
.head 16 -  ! Call SqlDisconnect(hSqlB)
.head 16 -  Break
.head 15 -  ! Call Debug('sVspoAdd=' || sVspoAdd)
.head 14 -  !
.head 14 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Gray)
.head 13 -  Set sTTS = ''
.head 13 -  Set sVspoD = '' 
.head 13 +  If Len(sVspo) > 0
.head 14 -  Set nD = At('#d', sVspo)
.head 14 +  If nD > 0
.head 15 -  Set sVspoD = Subs(sVspo, nD, 53)
.head 15 -  Set sVspo = VisStrSubstitute(sVspo, sVspoD, '#')
.head 15 +  If Len(sVspo) = 1
.head 16 -  Set sVspo = ''
.head 14 -  Set nIt = At('#C', sVspo)
.head 14 +  If nIt > 0
.head 15 -  Set sTemp = Subs(sVspo, nIt+2, Len(sVspo)-1-nIt)
.head 15 -  Set nIt = At('#', sTemp)
.head 15 -  Set sTTS = IifS(nIt=0, sTemp, Left(sTemp, nIt-1))
.head 14 +  If Len(sVspo) > 0 and Len(sVspoD) > 0
.head 15 -  Set sVspo = Left(sVspo, Len(sVspo)-1) || sVspoD
.head 14 +  Else
.head 15 -  Set sVspo = IifS(Len(sVspo)=0, sVspoD, sVspo)
.head 13 +  If Len(sTTS) > 0
.head 14 -  Set sTTS = Left(sTTS || '  ', 3)
.head 14 -  Set nTemp = 0
.head 14 +  If not SqlPrepareAndExecute(hSqlAux(), T("
   SELECT count(1)
   INTO   :nTemp
   FROM   tts
   WHERE  tt=:sTTS")) or not SqlFetchNext(hSqlAux(), nFetchRes)
.head 15 -  Set sTTS = ''
.head 14 +  Else
.head 15 -  ! Call DebugN(nTemp)
.head 15 -  Set sTTS = IifS(nTemp=0, '', sTTS)
.head 13 +  If Len(sTTS) > 0
.head 14 -  Set sVspo = VisStrSubstitute(VisStrRightTrim(VisStrSubstitute(sVspo, '#C' || sTTS, '#C')), '#C#', '#')
.head 14 -  Set sVspo = IifS(sVspo='#', '', sVspo)
.head 13 +  If (nNm = 1 or nNm = 2) and nSos = 0 and nS > 0 and (not (nNp = 380 and nNm = 1 and
   (Left(sNls,4) = '3801' or Left(sNlsk,4) = '3801')) and not (nNp = 991 and nNm = 1 and
   (Left(sNls,4) = '1200' or Left(sNlsk,4) = '1200')))
.head 14 +  If nNm = 1
.head 15 -  Set sMfo = sBankMfo
.head 14 +  If sMfo = sBankMfo
.head 15 -  Set nNm = 1
.head 14 -  ! Проверка реквизитов
.head 14 -  Set bErr = FALSE
.head 14 -  Set bErrNLS = FALSE
.head 14 -  Set sErrMes = ''
.head 14 +  If not (((Len(sKod) = 8 and sKod = V_Okpo(sKod)) or (Len(sKod) = 9 or Len(sKod) = 10) or
   (Len(sKod) = 3) or (sKod = '99999')) and ((Len(sKodB) = 8 and sKodB = V_Okpo(sKodB)) or
   (Len(sKodB) = 9 or Len(sKodB) = 10) or (Len(sKodB) = 3) or (sKodB = '99999')))
.head 15 -  Set sErrMes = sErrMes || ' Отсутствует(ош) ОКРО А или ОКРО Б
'
.head 15 -  Set bErr = TRUE
.head 14 +  If not SqlPrepareAndExecute(hSqlAux(), "
   SELECT sab
   INTO   :sSAB
   FROM   banks
   WHERE  mfo=:sMfo") or not SqlFetchNext(hSqlAux(), nFetchRes)
.head 15 -  Set sErrMes = sErrMes || '
Ошибка МФО'
.head 15 -  Set bErr = TRUE
.head 14 +  Else
.head 15 +  If Len(sNls) < 5 or sNls != Vkrz2(sBankMfo, sNls)
.head 16 -  Set sErrMes = sErrMes || '
Ошибка Счёт-А'
.head 16 -  Set bErr = TRUE
.head 16 -  Set bErrNLS = TRUE
.head 15 +  If Len(sNlsk) < 5 or sNlsk != Vkrz2(sMfo, sNlsk)
.head 16 -  Set sErrMes = sErrMes || '
Ошибка Счёт-Б'
.head 16 -  Set bErr = TRUE
.head 16 -  Set bErrNLS = TRUE
.head 15 +  Else If nNm != 1
.head 16 -  Call SqlPrepareAndExecute(hSqlAux(), "
     SELECT nbs
     FROM   nosep
     WHERE  kod=decode(Substr(:sMfo,1,1),'8',3,decode(Substr(:sSAB,3,1),'H',1,2)) and
            :sNlsk like nbs || '%'")
.head 16 +  If SqlFetchNext(hSqlAux(), nFetchRes)
.head 17 -  Set sErrMes = sErrMes || '
Недопустимый балансовый счёт'
.head 17 -  Set bErr = TRUE
.head 17 -  Set bErrNLS = TRUE
.head 14 +  If Len(sPlat) = 0
.head 15 -  Set sPlat = GetValueStr("
    SELECT trim(substr(NMS,1,38))
    FROM   accounts
    WHERE  nls='" || sNls || "' and kv=980")
.head 14 +  If Len(sPlat) < 3 or SalStrMidX(sPlat, 0, 1) = ' ' or not FScan(StrWinToDosX(sPlat))
.head 15 -  Set sErrMes = sErrMes || '
Ошибка в реквизите ПЛАТЕЛЬЩИК'
.head 15 -  Set bErr = TRUE
.head 14 +  If Len(sPolu) = 0 and sMfo = sBankMfo
.head 15 -  Set sPolu = GetValueStr("
    SELECT trim(substr(NMS,1,38))
    FROM   accounts
    WHERE  nls='" || sNlsk || "' and kv=980")
.head 14 +  If Len(sPolu) < 3 or SalStrMidX(sPolu, 0, 1) = ' ' or not FScan(StrWinToDosX(sPolu))
.head 15 -  Set sErrMes = sErrMes || '
Ошибка в реквизите ПОЛУЧАТЕЛЬ'
.head 15 -  Set bErr = TRUE
.head 14 +  If Len(sNaz1) < 3 or SalStrMidX(sNaz1, 0, 1) = ' ' or not FScan(StrWinToDosX(sNaz1))
.head 15 -  Set sErrMes = sErrMes || '
Ошибка в реквизите НАЗНАЧЕНИЕ'
.head 15 -  Set bErr = TRUE
.head 14 -  !
.head 14 -  Set sTT = ''
.head 14 -  ! Проверка реквизитов (end)
.head 14 +  If nSk > 0
.head 15 -  Set sTmp = sNls
.head 15 -  Set sNls = sNlsk
.head 15 -  Set sNlsk = sTmp
.head 15 +  ! If not cbRevPP
.head 16 -  Set sTmp = sPolu
.head 16 -  Set sPolu = sPlat
.head 16 -  Set sPlat = sTmp
.head 16 -  !
.head 15 -  ! переворот кассы (сальТо)
.head 15 -  Set sTmp = sPolu
.head 15 -  Set sPolu = sPlat
.head 15 -  Set sPlat = sTmp
.head 15 +  ! Прием информационных документов
.head 16 -  ! Set nDk = 1 - nDk
.head 15 +  If nDk = 1
.head 16 -  Set nDk = 0
.head 15 +  Else If nDk = 0
.head 16 -  Set nDk = 1
.head 15 -  ! Set nNm = nDk + 1005 ! добавлено МБГ
.head 15 -  Set nNm = nDk + 1085 ! добавлено для UPB и для всех остальных
.head 15 -  ! ! свежак
.head 15 +  If Len(sNLSKASSA) > 0
.head 16 -  Call SalArrayGetUpperBound(smNLSKASSA, 1, nI)
.head 16 -  Set nC = 0
.head 16 +  While nC <= nI
.head 17 +  If SalStrScan(sNlsk, smNLSKASSA[nC]) >= 0 and Len(smDK0KASSA[nC]) = 3 and
   Len(smDK1KASSA[nC]) = 3
.head 18 -  Set sTT = IifS(nDk=1, smDK0KASSA[nC], smDK1KASSA[nC])
.head 18 -  Break
.head 17 -  Set nC = nC + 1
.head 14 +  Else
.head 15 -  Set nSk = NUMBER_Null
.head 15 +  If nDk = nKw
.head 16 -  Set nDk = nDk + 2
.head 14 +  If nNm = 2 and NS = 8
.head 15 -  Call SqlPrepareAndExecute(hSqlAux(), T("
     SELECT nls
     INTO   :sNls
     FROM   accounts
     WHERE  tip='90D'"))
.head 15 -  Call SqlFetchNext(hSqlAux(), nFetchRes)
.head 14 -  Set nRef = NUMBER_Null
.head 14 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Blue)
.head 14 +  If (Len(sTT) = 0 and Len(sNLSKASSA) > 0) or Len(sNLSKASSA) = 0
.head 15 -  ! Set sTT = Right('NM' || IifS(nDk=0 and nNm=2, 'D', IifS(nDk>1 and nNm=2, 'I', Str(nNm))), 3)
.head 15 -  Set sTT = Right('R3' || IifS(nDk=0 and nNm=2, 'D', IifS(nDk>1, IifS(nNm=2, 'I', 'U'), Str(nNm))), 3)
.head 14 -  If SqlPrepareAndExecute(hSqlAux(), T("
   SELECT substr(flags,13,1)
   INTO   :sSTP
   FROM   tts
   WHERE  tt=:sTT")) and SqlFetchNext(hSqlAux(), nFetchRes)
.head 14 +  Else
.head 15 -  Set sSTP = '0'
.head 14 -  Set tbl1.colSTP = Max(Val(sSTP)-1, 0)
.head 14 +  If bNBU and (sTT = '085' or sTT = '086') and SqlPrepareAndExecute(hSqlAux(), T("
   SELECT vob
   INTO   :nVOBtts
   FROM   tts_vob
   WHERE  tt=:sTT")) and SqlFetchNext(hSqlAux(), nFetchRes)
.head 15 -  Set nVob = nVOBtts
.head 15 -  Set tbl1.colVOB = nVob
.head 14 -  ! Проверка на доступ к счетам
.head 14 +  If not bErrNLS
.head 15 -  ! sNls
.head 15 +  If nDk = 0 and not (SqlPrepareAndExecute(hSqlAux(), "
   SELECT nls
   INTO   :sTmpNls
   FROM   saldok
   WHERE  nls=:sNls and kv=980") and SqlFetchNext(hSqlAux(), nFetchRes))
.head 16 -  Set sErrMes = sErrMes || '   Счёт ' || sNls || ' не доступен для Кредита
'
.head 16 -  Set bErr = TRUE
.head 15 +  Else If nDk = 1 and not (SqlPrepareAndExecute(hSqlAux(), "
     SELECT nls
     INTO   :sTmpNls
     FROM   saldod
     WHERE  nls=:sNls and kv=980") and SqlFetchNext(hSqlAux(), nFetchRes))
.head 16 -  Set sErrMes = sErrMes || '   Счёт ' || sNls || ' не доступен для Дебета
'
.head 16 -  Set bErr = TRUE
.head 15 +  Else If nDk > 1 and SqlPrepareAndExecute(hSqlAux(), "
     SELECT nls
     INTO   :sTmpNls
     FROM   accounts
     WHERE  nls=:sNls and kv=980 and dazs is not null") and SqlFetchNext(hSqlAux(), nFetchRes)
.head 16 -  Set sErrMes = sErrMes || '   Счёт ' || sNls || ' не доступен (ЗАКРЫТ)
'
.head 16 -  Set bErr = TRUE
.head 15 -  ! sNlsk
.head 15 +  If nNm = 1 or nNm > 1000
.head 16 +  If nDk = 0 and sMfo=sBankMfo and not (SqlPrepareAndExecute(hSqlAux(), "
   SELECT nls
   INTO   :sTmpNls
   FROM   saldod
   WHERE  nls=:sNlsk and kv=980") and SqlFetchNext(hSqlAux(), nFetchRes))
.head 17 -  Set sErrMes = sErrMes || '   Счёт ' || sNlsk || ' не доступен для Дебета
'
.head 17 -  Set bErr = TRUE
.head 16 +  Else If nDk = 1 and sMfo=sBankMfo and not (SqlPrepareAndExecute(hSqlAux(), "
     SELECT nls
     INTO   :sTmpNls
     FROM   saldok
     WHERE  nls=:sNlsk and kv=980") and SqlFetchNext(hSqlAux(), nFetchRes))
.head 17 -  Set sErrMes = sErrMes || '   Счёт ' || sNlsk || ' не доступен для Кредита
'
.head 17 -  Set bErr = TRUE
.head 16 +  Else If nDk > 1 and SqlPrepareAndExecute(hSqlAux(), "
     SELECT nls
     INTO   :sTmpNls
     FROM   accounts
     WHERE  nls=:sNlsk and kv=980 and dazs is not null") and SqlFetchNext(hSqlAux(), nFetchRes)
.head 17 -  Set sErrMes = sErrMes || '   Счёт ' || sNlsk || ' не доступен (ЗАКРЫТ)
'
.head 17 -  Set bErr = TRUE
.head 14 -  !
.head 14 +  If bErr
.head 15 -  Call SalMessageBox('Документ на сумму ' || Str(nS/100) || ' не принят.
' || sErrMes, 'Внимание!', MB_Ok | MB_IconExclamation)
.head 15 -  Set tbl1.colComm = sErrMes
.head 15 -  Set tbl1.colREF98 = NUMBER_Null
.head 15 -  Set tbl1.colSTP = NUMBER_Null
.head 15 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Red)
.head 14 -  ! Modify by ANNY 18-10-2001
.head 14 +  Else
.head 15 +  If nVob = 96 or nVob = 99
.head 16 -  Set dTemp = IifD(nVob=96, SalDateMonthBegin(dfBD), SalDateYearBegin(dfBD)) - 1
.head 16 -  Call SqlPrepareAndExecute(hSql(), "
     SELECT max(fdat)
     INTO   :dValu
     FROM   fdat
     WHERE  fdat<=:dTemp")
.head 16 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 17 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   fdat (fdat)
     VALUES (:dTemp)")
.head 17 -  Set dValu = dTemp
.head 16 +  If dValu != dfBD
.head 17 -  ! Call Pl_dat(dValu) ! Установить банковскую дату
.head 15 +  Else
.head 16 -  Set dValu = dfBD
.head 15 -  ! Set sVspoDop = ''
.head 15 -  ! Set nFileVspo = 0
.head 15 +  ! If Len(sVspo) > 0
.head 16 +  ! If File(sODBCDir || '\\' || sVspo)
.head 17 -  Set nFileVspo = 1
.head 16 +  ! Else
.head 17 -  Set nFileVspo = 2
.head 16 -  Set nFileVspo = IifN(File(sODBCDir || '\\' || sVspo), 1, 2)
.head 16 -  Set sVspoDop = sVspo
.head 16 -  Set sVspo = ''
.head 15 -  ! Call DebugN(nFileVspo)
.head 15 -  !
.head 15 -  Set sTT = IifS(Len(sTTS)=3, sTTS, sTT)
.head 15 -  If SqlPrepareAndExecute(hSqlAux(), T("
   SELECT substr(flags,13,1)
   INTO   :sSTP
   FROM   tts
   WHERE  tt=:sTT")) and SqlFetchNext(hSqlAux(), nFetchRes)
.head 15 +  Else
.head 16 -  Set sSTP = '0'
.head 15 -  Set tbl1.colSTP = Max(Val(sSTP)-1, 0)
.head 15 -  Call ccDoc.SetDoc(0, sTT, nDk, nVob, sNd, dDat, dValu, dValu, dValu, sNls, sPlat, sBankMfo, '', 980,
     nS, sKod, sNlsk, sPolu, sMfo, '', 980, nS, sKodB, sNaz1, sVspo, GetIdOper(), '', nSk, 0)
.head 15 -  Set ccDoc.m_sDrec = sVspo
.head 15 -  Set dfAll = dfAll + 1
.head 15 -  ! Call Debug('до ccDoc.oDoc')
.head 15 +  If ccDoc.oDoc()
.head 16 -  Set br31 = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO   operw (ref,tag,value)
    VALUES (:ccDoc.m_nRef,'KS_R3',:sR3)"))
.head 16 -  Set br32 = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO   operw (ref,tag,value)
    VALUES (:ccDoc.m_nRef,'KS_ND',:sNDR3)"))
.head 16 -  Set br3R = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO   operw (ref,tag,value)
    VALUES (:ccDoc.m_nRef,'KS_FI',:dfFile)"))
.head 16 -  ! Set nYear = SalDateYear(dfBD)
.head 16 -  Set nYear = SalDateYear(dValu)
.head 16 -  Set sFiler3 = GetValueStr("
    select filer3||'~'||to_char(ref)
    from   r3_ndr3
    where  ndr3='" || sNDR3 || "' and god=" || Str(nYear))
.head 16 +  If Len(sFiler3) > 0
.head 17 -  Set bn3 = FALSE 
.head 17 -  Set n3 = At('~', sFiler3)
.head 17 -  Set sRef3 = Subs(sFiler3, n3+1, Len(sFiler3)-n3)
.head 17 -  Set sFiler3 = Left(sFiler3, n3-1)
.head 16 +  Else
.head 17 -  Set bn3 = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO   r3_ndr3 (filer3,ndr3,god,ref)
    VALUES (:dfFile,:sNDR3,:nYear,:ccDoc.m_nRef)"))
.head 16 +  If not bn3
.head 17 -  Set tbl1.colComm = 'Документ № ' || sNDR3 || ' ранее УЖЕ принимался (файл ' || sFiler3 ||
    '), референс в АБС = ' || sRef3 || ' !'
.head 17 -  Set tbl1.colREF98 = NUMBER_Null
.head 17 -  Set tbl1.colSTP = NUMBER_Null
.head 17 -  Call MessageNoWait(tbl1.colComm , 'ВНИМАНИЕ !!!', 1, 1)
.head 17 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Red)
.head 17 -  Call SqlRollback(hSql())
.head 17 -  Set bF = FALSE
.head 16 +  Else
.head 17 -  Set b1 = TRUE
.head 17 -  Set b2 = b1
.head 17 -  Set b3 = b1
.head 17 +  If Len(sKASVID) > 0
.head 18 -  Set b1 = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO   operw (ref,tag,value)
    VALUES (:ccDoc.m_nRef,'ATRT',:sKASVID)"))
.head 17 +  If Len(sKASDOKsn) > 0
.head 18 -  Set b2 = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO   operw (ref,tag,value)
    VALUES (:ccDoc.m_nRef,'PASP',:sKASDOKsn)"))
.head 17 +  If Len(sKASFIO) > 0
.head 18 -  Set b3 = SqlPrepareAndExecute(hSql(), T("
   INSERT
   INTO   operw (ref,tag,value)
   VALUES (:ccDoc.m_nRef,'FIO',:sKASFIO)"))
.head 17 +  If b1 and b2 and b3
.head 18 -  ! вставка TAGов из файла дополнительных реквизитов
.head 18 -  Set b4 = TRUE
.head 18 -  ! Call VisArrayCopy(nmREF, nmREFrab, DT_Number)
.head 18 -  Call VisArrayCopy(smREF, smREFrab, DT_String)
.head 18 -  Call VisArrayCopy(smTAG, smTAGrab, DT_String)
.head 18 -  Call VisArrayCopy(smVALUE, smVALUErab, DT_String)
.head 18 -  Set bEE = TRUE
.head 18 +  While bEE
.head 19 -  Call SalArrayDimCount(smREFrab, nII)
.head 19 +  If nII > 0
.head 20 -  ! Set nII = VisArrayFindNumber(nmREFrab, Val(sNDR3))
.head 20 -  Set nII = VisArrayFindString(smREFrab, sNDR3)
.head 20 +  If nII >= 0 ! found !!!
.head 21 -  Set sTAG = SalStrTrimX(smTAGrab[nII])
.head 21 -  Set sVALUE = SalStrTrimX(smVALUErab[nII])
.head 21 -  Set b4 = SqlPrepareAndExecute(hSql(), T("
    INSERT
    INTO   operw (ref,tag,value)
    VALUES (:ccDoc.m_nRef,:sTAG,:sVALUE)"))
.head 21 -  ! Call VisArrayDeleteItem(nmREFrab, nII, DT_Number)
.head 21 -  Call VisArrayDeleteItem(smREFrab, nII, DT_String)
.head 21 -  Call VisArrayDeleteItem(smTAGrab, nII, DT_String)
.head 21 -  Call VisArrayDeleteItem(smVALUErab, nII, DT_String)
.head 21 -  Set bEE = b4
.head 20 +  Else
.head 21 -  Set bEE = FALSE
.head 19 +  Else
.head 20 -  Set bEE = FALSE
.head 18 +  If b4
.head 19 +  If SqlPrepareAndExecute(hSqlB, "
   UPDATE " || Left(sTempDbf, Len(sTempDbf)-4) || "
   SET    sos=9
   WHERE  CURRENT OF " || Left(sTempDbf, Len(sTempDbf)-4))
.head 20 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE oper
     SET    prty=:tbl1.colSTP
     WHERE  ref=:ccDoc.m_nRef")
.head 20 -  Call SqlCommit(hSql())
.head 20 -  Call SaveInfoToLog('принят док Ref' || Str(ccDoc.m_nRef) || ': ' || sNls || '(980) ' ||
     Str(nS) || ' -> ' || sMfo || ' ' || sNlsk || '(980) ' || Str(nS) || '[' || sPolu ||
     '],[' || sNaz1 || '] ' || GetIdOper())
.head 20 -  Set bOpl = TRUE
.head 20 -  ! Call Pl_dat(dfBD) ! Возвратить банковскую дату
.head 20 -  Set tbl1.colREF98 = ccDoc.m_nRef
.head 20 -  Set tbl1.colComm = 'Документ принят'
.head 20 -  Set tbl1.colTT = sTT
.head 20 -  ! (COLOR_DarkGreen) оплачен
.head 20 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_DarkGreen)
.head 20 -  Set dfCurrent = dfCurrent + 1
.head 20 +  If Mod(n99, 10) = 0 Or Mod(n99, 10) = 7
.head 21 -  Call SqlPrepareAndExecute(hSqlB, "
     UPDATE " || Left(sTempDbf, Len(sTempDbf)-4) || "
     SET    sos=9,ref99bm=:ccDoc.m_nRef
     WHERE  CURRENT OF " || Left(sTempDbf, Len(sTempDbf)-4))
.head 19 +  Else
.head 20 -  Call SaveErrorToLog('ош. UPDATE ' || Left(sTempDbf, Len(sTempDbf)-4) || ' SET sos=9 док №'
     || sNd || ': ' || sNls || '(980) ' || Str(nS) || ' -> ' || sMfo || ' ' || sNlsk ||
     '(980) ' || Str(nS) || '[' || sPolu || '],[' || sNaz1 || '] ' || GetIdOper())
.head 20 -  Set tbl1.colComm = 'ош. UPDATE SET sos=9'
.head 20 -  Set tbl1.colREF98 = NUMBER_Null
.head 20 -  Set tbl1.colSTP = NUMBER_Null
.head 20 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Red)
.head 20 -  Call SqlRollback(hSql())
.head 20 -  Set bF = FALSE
.head 18 +  Else
.head 19 -  Call MessageNoWait('ош. вставки в OPERw (доп. реквизит ' || SalStrTrimX(sTAG) || ') док №'
     || sNd || ':' || PutCrLf() || sNls || '(980) ' || Str(nS) || ' ->' || PutCrLf() || sMfo
     || ' ' || sNlsk || '(980) ' || Str(nS) || PutCrLf() || '[' || sPolu || ']' || PutCrLf()
     || '[' || sNaz1 || '] ' || PutCrLf() || GetIdOper(), 'ОШИБКА !!!', 17, 1)
.head 19 -  Set tbl1.colComm = 'ош. вставки в OPERw (доп. реквизит ' || SalStrTrimX(sTAG) || ')'
.head 19 -  Set tbl1.colREF98 = NUMBER_Null
.head 19 -  Set tbl1.colSTP = NUMBER_Null
.head 19 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Red)
.head 19 -  Call SqlRollback(hSql())
.head 19 -  Set bF = FALSE
.head 17 +  Else
.head 18 -  Call SaveErrorToLog('ош. вставки в OPERw док №'|| sNd || ': ' || sNls || '(980) ' || Str(nS)
     || ' -> ' || sMfo || ' ' || sNlsk || '(980) ' || Str(nS) || '[' || sPolu || '],[' ||
     sNaz1 || '] ' || GetIdOper())
.head 18 -  Set tbl1.colComm = 'ош. вставки в OPERw'
.head 18 -  Set tbl1.colREF98 = NUMBER_Null
.head 18 -  Set tbl1.colSTP = NUMBER_Null
.head 18 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Red)
.head 18 -  Call SqlRollback(hSql())
.head 18 -  Set bF = FALSE
.head 15 +  Else
.head 16 -  Call SaveInfoToLog('ошибка при оплате док №' || sNd || ': ' || sNls || '(980) ' || Str(nS) ||
     ' -> ' || sMfo || ' ' || sNlsk || '(980) ' || Str(nS) || '[' || sPolu || '],[' || sNaz1 ||
     '] ' || GetIdOper())
.head 16 -  Set tbl1.colComm = 'ошибка при оплате док.'
.head 16 -  Set tbl1.colREF98 = NUMBER_Null
.head 16 -  Set tbl1.colSTP = NUMBER_Null
.head 16 -  Call VisTblSetRowColor(tbl1, nNewRow, COLOR_Red)
.head 16 -  Call SqlRollback(hSql())
.head 16 -  Set bF = FALSE
.head 16 +  ! If not g_bSignInited ! ccDoc.m_bEscPin
.head 17 -  Call SaveInfoToLog('Прием документов из ' || dfFile || ' ПРЕРВАН')
.head 17 -  ! Call DebugN(ccDoc.m_nTim)
.head 17 -  Call SalEnableWindow(pbExit)
.head 17 -  Call SalEnableWindow(pbExecute)
.head 17 -  Break 
.head 15 -  ! Call Pl_dat(dfBD) ! Возвратить банковскую дату
.head 13 -  Call SalTblSetCellTextColor(tbl1.colNPP, COLOR_Charcoal, TRUE)
.head 13 -  Set nPos = nPos + nDelta
.head 13 -  Set nRecn = nRecn + 1
.head 13 +  If Int(nPos) != nTek
.head 14 -  Set nTek = Int(nPos)
.head 14 -  Set nTimeCurrent = SalDateHour(SalDateCurrent())*3600 + SalDateMinute(SalDateCurrent())*60 +
     SalDateSecond(SalDateCurrent())
.head 14 -  Set nTimeEnd = Int(100 * (nTimeCurrent-nTimeStart) / nPos + nTimeStart)
.head 14 -  Set nHour = Int(nTimeEnd/3600)
.head 14 -  Set nTemp = nTimeEnd - nHour*3600
.head 14 -  Set nMinu = Int(nTemp/60)
.head 14 -  Set dfStart = dfStart
.head 14 -  Set dfEnd = 'Финиш: ' || Right(Str(100+nHour), 2) || ':' || Right(Str(100+nMinu), 2) || ':' || Right(
    Str(100+nTemp-nMinu*60), 2) || ' (прогноз)'
.head 14 -  Set dfReccount = dfReccount
.head 14 -  Set dfCurrent = dfCurrent
.head 14 -  Set dfAll = dfAll
.head 13 -  Call ccProgressBar.SetProgress(nPos)
.head 13 -  Call SalUpdateWindow(hWndForm)
.head 12 -  Call ccProgressBar.SetProgress(100)
.head 12 -  Call SqlCommitEx(hSql(), 'OK')
.head 12 -  Call SqlCommit(hSqlB)
.head 12 -  Call SqlDisconnect(hSqlA)
.head 12 -  Call SqlDisconnect(hSqlB)
.head 12 -  Call SaveInfoToLog('Прием документов из ' || dfFile || ' ОКОНЧЕН')
.head 12 -  Set dfDone = "Готово"
.head 12 -  Set dfEnd = Left(dfEnd, 15)
.head 12 +  If dfCurrent > 0
.head 13 -  ! сформировать файл оплаченных документов
.head 13 -  Set nCurrentRow = nJur
.head 13 -  Set nP = 1
.head 13 -  Set nItog = 0
.head 13 -  Set sFr = GetPrnDir() || '\\M' || Right(Str(SalDateMonth(dBat)+100), 2) || Right(Str(
    SalDateDay(dBat)+100), 2) || Right(Str(SalDateHour(SalDateCurrent())+100), 2) || Subs(Str(
    SalDateMinute(SalDateCurrent())+100), 2, 1) || '.' || Right(Str(SalDateMinute(SalDateCurrent())), 1)
    || Right(Str(SalDateSecond(SalDateCurrent())+100), 2)
.head 13 -  Call SalFileOpen(hF, sFr, OF_Create | OF_Write)
.head 13 -  Set sBuff = StrWinToDosX(SalStrTrimX(GetBankName()) || ' ' || SalStrTrimX(sBankMfo) || PutCrLf() ||
    'Дата и время формирования ' || SalFmtFormatDateTime(SalDateCurrent(), 'dd/MM/yyyy ') ||
    Right('0' || SalFmtFormatDateTime(SalDateCurrent(), 'hhhh:mm:ss'), 8) || PutCrLf() || PutCrLf() ||
    Spac(15) || 'Реестр оплаченных платежных документов' || PutCrLf() || Spac(15) || '(' || dfFile ||
    ') сеанс (с ' || Right(dfStart, 8) || ' по ') || Right(dfEnd, 8) || ')' || PutCrLf() ||
    Repl('-', 69) || PutCrLf()
.head 13 -  Call SalFileWrite(hF, sBuff, Len(sBuff))
.head 13 +  While SalTblFindNextRow(tbl1, nCurrentRow, 0, 0)
.head 14 -  Call SalTblSetFocusRow(tbl1, nCurrentRow)
.head 14 -  Set nColor = SalColorGet(tbl1.colNLSA, COLOR_IndexCellText)
.head 14 +  If nColor = COLOR_DarkGreen
.head 15 -  Set sLev = tbl1.colTT || ' реф.' || Str(tbl1.colREF98) || ', док.' || SalStrTrimX(tbl1.colND) ||
    ', оп.' || Str(tbl1.colVOB)
.head 15 -  Set sBuff = PadR(Str(nP) || '.', 4) || sBankMfo || ' ' || PadR(tbl1.colNLSA || '(' || Right(
    Str(tbl1.colVALA+1000), 3) || ')', 20) || StrWinToDosX(SalStrTrimX(tbl1.colNAMA) || PutCrLf() ||
    '    ' || IifS(Val(tbl1.colMFOB)=0, sBankMfo, tbl1.colMFOB) || ' ' || PadR(tbl1.colNLSB || '('
    || Right(Str(tbl1.colVALB+1000), 3) || ')', 20) || SalStrTrimX(tbl1.colNAMB) || PutCrLf() ||
    sLev || PadL('сумма ' || SalNumberToStrX(tbl1.colS, 2), 69-Len(sLev)) || PutCrLf() ||
    Perenos(tbl1.colNAZN, 65, 4)) || PutCrLf()
.head 15 -  Call SalFileWrite(hF, sBuff, Len(sBuff))
.head 15 -  Set nP = nP + 1
.head 15 -  Set nItog = nItog + tbl1.colS
.head 13 -  Set sBuff = Repl('-', 69) || PutCrLf() || StrWinToDosX('    Итого: ' || PadR(Str(nP-1), 20) ||
    'На сумму:') || PadL(SalNumberToStrX(nItog, 2), 29) || PutCrLf() || Repl('-', 69) || Repl(
    PutCrLf(), 3)
.head 13 -  Call SalFileWrite(hF, sBuff, Len(sBuff))
.head 13 -  Call SalFileClose(hF)
.head 12 -  Call SalMessageBeep(-1)
.head 12 +  If dfAll > dfCurrent and not bF
.head 13 -  ! удалить файл в NOT (по запросу)
.head 13 +  If VisMessageBox('ВНИМАНИЕ ! Файл ' || dfFile ||
   '. Обработаны не ВСЕ выбранные документы. Примите меры для исправления ошибок. ' ||
   'Переместить в NOT ?', 'ЗАПРОС', MBF_IconQuestion, hBtns, 2) = 1
 ! ID_Yes
.head 14 -  Call SalWaitCursor(FALSE)
.head 14 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 14 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 14 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 15 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 15 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 15 -  Call SalArrayGetUpperBound(smFilesRD, 1, nBound)
.head 15 +  If nBound >= 0
.head 16 -  Set nI = 0
.head 16 +  While nI <= nBound
.head 17 -  ! Call Debug(smFilesRD[nI])
.head 17 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || smFilesRD[nI], sODBCDir || '\\ArchivNO\\' ||
     smFilesRD[nI])
.head 17 +  If File(sODBCDir || '\\ArchivNO\\' || smFilesRD[nI])
.head 18 -  Call VisFileDelete(sODBCDir || '\\' || smFilesRD[nI])
.head 17 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || smFilesRD[nI])
.head 17 -  Set nI = nI + 1
.head 15 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 15 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 15 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || sVspoAdd, FA_ReadOnly, FALSE)
.head 15 -  Call VisFileDelete(sODBCDirCopy || '\\' || sVspoAdd)
.head 15 -  Call FileZNListBox()
.head 13 +  Else
.head 14 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf, sODBCDir || '\\' || dfFile)
.head 14 +  If File(sODBCDir || '\\' || dfFile)
.head 15 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 13 -  Call SalEnableWindow(pbExit)
.head 13 -  Call SalEnableWindow(pbExecute)
.head 13 -  Break
.head 12 +  Else
.head 13 -  Call SalWaitCursor(FALSE)
.head 13 -  ! записать в архив OK и удалить
.head 13 +  If VisMessageBox('ВНИМАНИЕ ! Файл ' || dfFile || ' обработан. Записать в АРХИВ(Ok) ?', 'ЗАПРОС',
   MBF_IconQuestion, hBtns, 2) = 1 ! ID_Yes
.head 14 -  Call SalWaitCursor(TRUE)
.head 14 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivOK')
.head 14 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf, sODBCDir || '\\ArchivOK\\' || dfFile)
.head 14 +  If File(sODBCDir || '\\ArchivOK\\' || dfFile)
.head 15 -  Set nYear = SalDateYear(dfBD)
.head 15 +  If bOpl
.head 16 +  If SqlPrepareAndExecute(hSql(), "
   UPDATE zag_r3
   set    fn=:dfFile,god=:nYear
   where  fn=:dfFile and god=:nYear")   
.head 17 +  If SqlGetModifiedRows(hSql(), nCount)
.head 18 +  If nCount = 0
.head 19 +  If SqlPrepareAndExecute(hSql(), "
   INSERT
   INTO   zag_r3 (fn,god)
   VALUES (:dfFile,:nYear)")
.head 20 -  Call SqlCommit(hSql())
.head 19 +  Else
.head 20 -  Call SqlRollback(hSql())
.head 18 +  Else
.head 19 -  Call SqlCommit(hSql())
.head 16 +  Else
.head 17 -  Call SqlRollback(hSql())
.head 15 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 15 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 15 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 15 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 15 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || sVspoAdd, FA_ReadOnly, FALSE)
.head 15 -  Call VisFileDelete(sODBCDirCopy || '\\' || sVspoAdd)
.head 15 +  If bD
.head 16 -  Call SalArrayGetUpperBound(smFilesRD, 1, nBound)
.head 16 -  ! Call DebugN(nBound)
.head 16 +  If nBound >= 0
.head 17 -  Set nI = 0
.head 17 +  While nI <= nBound
.head 18 -  ! Call Debug(smFilesRD[nI])
.head 18 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || smFilesRD[nI], sODBCDir || '\\ArchivOK\\'
    || smFilesRD[nI])
.head 18 +  If File(sODBCDir || '\\ArchivOK\\' || smFilesRD[nI])
.head 19 -  Call VisFileDelete(sODBCDir || '\\' || smFilesRD[nI])
.head 18 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || smFilesRD[nI])
.head 18 -  Set nI = nI + 1
.head 15 -  Call FileZNListBox()
.head 13 +  Else
.head 14 -  Call VisFileCopy(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf, sODBCDir || '\\' || dfFile)
.head 14 +  If File(sODBCDir || '\\' || dfFile)
.head 15 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 14 -  Call SalEnableWindow(pbExit)
.head 14 -  Call SalEnableWindow(pbExecute)
.head 14 -  Break
.head 13 -  Call SalWaitCursor(TRUE)
.head 12 -  Call SalSetFocus(tbl1)
.head 12 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 12 -  Call FileZNListBox()
.head 12 -  Set nJur = nNewRow
.head 12 -  ! Call SalDisableWindow(pbExecute)
.head 10 +  Else
.head 11 -  Call MessageAttention('Ошибка подсоединения к Базе данных: ' || SqlDatabase)
.head 9 +  Else
.head 10 -  ! Call MessageAttention('Нет файла: ' || sODBCDir || dfFile || ' или он занят другим пользователем.')
.head 10 +  If VisMessageBox('Файл ' || dfFile || ' возможно занят другим пользователем. Удалить в NOT ?', 'ЗАПРОС',
   MBF_IconQuestion, hBtns, 2) = 1 ! ID_Yes
.head 11 -  Call SalWaitCursor(TRUE)
.head 11 -  Call SalFileCreateDirectory(sODBCDir || '\\ArchivNO')
.head 11 -  Call VisFileCopy(sODBCDir || '\\' || dfFile, sODBCDir || '\\ArchivNO\\' || dfFile)
.head 11 +  If Subs(dfFile, 2, 1) = 'V'
.head 12 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), sODBCDir || '\\ArchivNO\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 11 +  Else
.head 12 -  Call VisFileCopy(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), sODBCDir || '\\ArchivNO\\' ||
     SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 11 +  If File(sODBCDir || '\\ArchivNO\\' || dfFile)
.head 12 -  Call VisFileDelete(sODBCDir || '\\' || dfFile)
.head 12 -  Call VisFileDelete(sODBCDir || '\\TempODBC.Dir\\' || sTempDbf)
.head 12 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || dfFile, FA_ReadOnly, FALSE)
.head 12 -  Call VisFileDelete(sODBCDirCopy || '\\' || dfFile)
.head 12 +  If Subs(dfFile, 2, 1) = 'V'
.head 13 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly, FALSE)
.head 13 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 13 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'), FA_ReadOnly, FALSE)
.head 13 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'W'))
.head 12 +  Else
.head 13 -  Call VisFileSetAttribute(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly, FALSE)
.head 13 -  Call VisFileDelete(sODBCDir || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 13 -  Call VisFileSetAttribute(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'), FA_ReadOnly, FALSE)
.head 13 -  Call VisFileDelete(sODBCDirCopy || '\\' || SalStrReplaceX(dfFile, 1, 1, 'D'))
.head 10 -  Break
.head 9 -  !
.head 9 -  ! Call SalEnableWindow(pbExecute)
.head 9 -  Call SalEnableWindow(pbExit)
.head 9 -  Call SalSetFocus(pbExit)
.head 9 +  If not cbAll
.head 10 -  Break
.head 8 -  Call SalWaitCursor(FALSE)
.head 7 +  Else
.head 8 -  Call Debug("День закрыт !")
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   5.85"
.head 5 -  Top:    6.964"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Call SalEndDialog(hWndForm, FALSE)
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 3 -  Frame
.head 4 -  Resource Id: 15793
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.05"
.head 5 -  Top:    6.214"
.head 5 -  Width:  16.867"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.083"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Drop-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 3 -  Background Text: Имя файла импорта
.head 4 -  Resource Id: 15794
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    6.571"
.head 5 -  Width:  3.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Combo Box: dfFile
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.35"
.head 5 -  Top:    6.548"
.head 5 -  Width:  4.033"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.06"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: 12
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 +  Check Box: cbAll
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Принять ВСЕ файлы
.head 4 -  Window Location and Size
.head 5 -  Left:   0.35"
.head 5 -  Top:    6.964"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Teal
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfStart
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.667"
.head 6 -  Top:    6.738"
.head 6 -  Width:  9.15"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfEnd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.667"
.head 6 -  Top:    6.988"
.head 6 -  Width:  9.15"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfDone
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.667"
.head 6 -  Top:    6.321"
.head 6 -  Width:  9.15"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Purple
.head 5 -  Background Color: Gray
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.405"
.head 6 -  Width:  16.883"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 5.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 333333
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colNPP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: N
пп
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.471"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colND
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер
док.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.114"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вид оп.
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMFOA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО-А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.743"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLSA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет-А
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.529"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAMA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.А
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.714"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVALA
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMFOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.743"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNLSB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Счет-Б
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.529"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAMB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наим.Б
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.714"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVALB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Сумма
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.386"
.head 6 -  Width Editable? Yes
.head 6 -  Format: ###000
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colVDATE
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
вал.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Left
.head 6 -  Width:  1.017"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNAZN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назначение пл.
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.357"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colREF98
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Референс
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.943"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSTP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Признак
СТП
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If tbl1.colREF98 = 0 or tbl1.colREF98 = NUMBER_Null
.head 9 -  Set tbl1.colSTP = NUMBER_Null
.head 9 -  Return VALIDATE_Ok
.head 8 +  Else
.head 9 +  If tbl1.colSTP != NUMBER_Null and (tbl1.colSTP < 0 or tbl1.colSTP > 1)
.head 10 -  Call MessageNoWait('Val Признак СТП может быть только 0 или 1 ...', 'ВНИМАНИЕ!', 7, 1)
.head 10 -  Set tbl1.colSTP = nSTP
.head 10 -  Return VALIDATE_Cancel
.head 9 +  Else
.head 10 -  Return VALIDATE_Ok
.head 7 +  ! On SAM_AnyEdit
.head 8 +  If tbl1.colREF98 = 0 or tbl1.colREF98 = NUMBER_Null
.head 9 -  Set tbl1.colSTP = NUMBER_Null
.head 8 +  If tbl1.colSTP != NUMBER_Null and (tbl1.colSTP < 0 or tbl1.colSTP > 1)
.head 9 -  Call MessageNoWait('Any Признак СТП может быть только 0 или 1 ...', 'ВНИМАНИЕ!', 7, 1)
.head 9 -  Return FALSE
.head 7 +  On SAM_Click
.head 8 -  Set nSTP = tbl1.colSTP
.head 5 +  Column: colComm
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Комментарий
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.471"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Транзакция
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.943"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nFocusRow
.head 5 -  Window Handle: hWndCol
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetTableFlags(tbl1, TBL_Flag_SingleSelection, TRUE)
.head 5 +  ! On SAM_Click
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 +  ! On SAM_CornerClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  ! On SAM_CornerDoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  ! On SAM_RowHeaderClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  ! On SAM_RowHeaderDoubleClick
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  ! On SAM_EndCellTab
.head 6 -  Call SalTblSetRowFlags(tbl1, lParam, ROW_Selected, FALSE)
.head 5 +  ! On WM_LbuttonUp
.head 6 -  ! Узнать текущую строку
.head 6 -  ! Call SalTblQueryFocus(tbl1, nFocusRow, hWndCol)
.head 6 -  ! Set nFocusRow = SalTblQueryContext(tbl1)
.head 6 -  ! Почистить все
.head 6 -  Call SalTblSetFlagsAnyRows(tbl1, ROW_Selected, FALSE, 0, 0)
.head 6 -  ! Call SalTblSetFocusRow (tbl1, nFocusRow)
.head 6 -  ! Стать на нее (что выше)
.head 6 -  ! Call SalTblSetRowFlags(tbl1, nFocusRow, ROW_Selected, FALSE)
.head 6 -  ! Call SalSendMsg(tbl1, SAM_RowHeaderClick, 0, Max(TBL_MaxRow, nFocusRow+1))
.head 5 +  On VTM_KeyUp
.head 6 -  Call SalTblSetFlagsAnyRows(tbl1, ROW_Selected, FALSE, 0, 0)
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 5 +  On WM_NCMouseMove ! 160
.head 6 -  Call VisTblAutoSizeColumn(tbl1, hWndNULL)
.head 3 +  Pushbutton: pbBD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.783"
.head 5 -  Top:    5.321"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: F12
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalIsWindowEnabled(dfBD)
.head 7 -  Call SalDisableWindow(dfBD)
.head 6 +  Else
.head 7 -  Call SalEnableWindow(dfBD)
.head 7 -  Call SalSetFocus(dfBD)
.head 3 +  Custom Control: ccProgressBar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    5.762"
.head 6 -  Width:  15.017"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Gray
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Data Field: dfBD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   15.167"
.head 6 -  Top:    5.762"
.head 6 -  Width:  1.733"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If dfBD > dBat
.head 7 -  Call MessageNoWait('Локальная дата не может быть больше текущей банковской даты !', 'ОШИБКА', 30, 1)
.head 7 -  Return VALIDATE_Cancel
.head 3 -  Background Text: Каталог импорта:
.head 4 -  Resource Id: 15795
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    6.238"
.head 5 -  Width:  3.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTekKat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.35"
.head 6 -  Top:    6.238"
.head 6 -  Width:  4.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   16.433"
.head 5 -  Top:    0.06"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SaveSTP()
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, IifS(GetLang()='RUS', 'Сохранить призак СТП', IifS(GetLang()='UKR',
       'Зберегти признак СТП', 'Save STP')))
.head 2 +  Functions
.head 3 +  Function: FileZNListBox
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: smFiles[*]
.head 5 -  Number: nI
.head 5 -  Number: nFiles
.head 4 +  Actions
.head 5 -  Set nFiles = VisDosEnumFiles(sODBCDir || '\\RB????' || Sep98md(dfBD) || '.*', FA_Standard, smFiles)
.head 5 -  Set nI = 0
.head 5 -  Call SalListClear(dfFile)
.head 5 +  While nI < nFiles
.head 6 -  Call SalListAdd(dfFile, smFiles[nI])
.head 6 -  Set nI = nI + 1
.head 5 -  !
.head 5 -  Set nFiles = VisDosEnumFiles(sODBCDir || '\\RV????' || Sep98md(dfBD) || '.*', FA_Standard, smFiles)
.head 5 -  Set nI = 0
.head 5 -  ! Call SalListClear(dfFile)
.head 5 +  While nI < nFiles
.head 6 -  Call SalListAdd(dfFile, smFiles[nI])
.head 6 -  Set nI = nI + 1
.head 5 -  Call SalListSetSelect(dfFile, 0)
.head 5 -  Call SalSendMsg(dfFile, SAM_Click, 0, 0)
.head 3 +  Function: Perenos
.head 4 -  Description: Разбиение назначения платежа
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sTxt	! текст
.head 5 -  Number: nLen	! длина
.head 5 -  Number: nSpaces ! количество пробелов слева
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sNana[*]
.head 5 -  Number: nL
.head 5 -  String: sI
.head 5 -  Number: nJ
.head 5 -  Number: nC
.head 5 -  String: sRes
.head 4 +  Actions
.head 5 -  Set nL = 0
.head 5 -  Set sI = SalStrTrimX(sTxt)
.head 5 +  Loop
.head 6 +  If Len(sI) = 0
.head 7 -  Break
.head 6 +  If Len(sI) < nLen+1
.head 7 -  Set sNana[nL] = sI
.head 7 -  Break
.head 6 -  Set nJ = nLen + 1
.head 6 -  Set sNana[nL] = Left(sI, nJ)
.head 6 +  While nJ > 0
.head 7 +  If Subs(sNana[nL], nJ, 1) = ' ' or Subs(sNana[nL], nJ, 1) = ',' or Subs(sNana[nL], nJ, 1) = '.' or
   Subs(sNana[nL], nJ, 1) = ';' or Subs(sNana[nL], nJ, 1) = ':' or Subs(sNana[nL], nJ, 1) = '-'
.head 8 -  Set sNana[nL] = SalStrTrimX(Left(sNana[nL], nJ))
.head 8 -  Set sI = SalStrTrimX(Subs(sI, nJ+1, Len(sI)-nJ))
.head 8 -  Break
.head 7 -  Set nJ = nJ - 1
.head 7 +  If nJ = 0
.head 8 -  Set sI = SalStrTrimX(Subs(sI, nLen+1, Len(sI)-nLen))
.head 6 -  Set nL = nL + 1
.head 5 -  Set nC = 0
.head 5 -  Set sRes = ''
.head 5 +  While nC <= nL
.head 6 -  Set sRes = sRes || Spac(nSpaces) || sNana[nC] || PutCrLf()
.head 6 -  Set nC = nC + 1
.head 5 -  Return sRes
.head 3 +  Function: FScan
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sPar
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sStr
.head 5 -  Number: nNum
.head 5 -  Boolean: bRet
.head 4 +  Actions
.head 5 -  Set sStr = sPar
.head 5 -  Set bRet = TRUE
.head 5 +  Loop
.head 6 +  If sStr
.head 7 -  Call SalStrFirstC(sStr, nNum)
.head 7 -  ! Call DebugN(nNum)
.head 7 -  Set i = 0
.head 7 +  While i <= 32
.head 8 +  If SalNumberToChar(nNum) = msSimv[i]
.head 9 -  ! Call DebugN(i)
.head 9 -  Set bRet = FALSE
.head 9 -  Break
.head 8 -  Set i = i + 1
.head 6 +  Else
.head 7 -  Break
.head 6 +  If not bRet
.head 7 -  Break
.head 5 -  Return bRet
.head 3 +  Function: SaveSTP
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRow
.head 4 +  Actions
.head 5 -  ! идти по таблице + UPDATE oper WHERE ref=tbl1.colREF98
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(tbl1, nRow, 0, 0)
.head 6 -  Call SalTblSetFocusRow(tbl1, nRow)
.head 6 -  Call SalTblSetContext(tbl1, nRow)
.head 6 +  If not (tbl1.colREF98 = 0 or tbl1.colREF98 = NUMBER_Null)
.head 7 +  If SqlPrepareAndExecute(hSql(), "
   UPDATE oper
   SET    prty=:tbl1.colSTP
   WHERE  ref=:tbl1.colREF98")
.head 8 -  Call SqlCommit(hSql())
.head 6 -  Call SalTblSetRowFlags(tbl1, nRow, ROW_Edited, FALSE)
.head 5 -  Return TRUE
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  : ccDoc
.head 4 -  Class: cDoc
.head 3 -  ! String: ND
.head 3 -  ! String: NLS
.head 3 -  ! String: NLSK
.head 3 -  ! Number: KVS
.head 3 -  ! Number: SK
.head 3 -  ! Number: REF
.head 3 -  ! Number: ISV
.head 3 -  ! String: NAZN
.head 3 -  String: sTmp
.head 3 -  Number: nCount
.head 3 -  Number: NS
.head 3 -  ! String: sAn
.head 3 -  ! String: sNbw
.head 3 -  ! Number: nNls
.head 3 -  String: sMfo
.head 3 -  ! String: sMdl
.head 3 -  ! Number: nMfop
.head 3 -  ! Number: nFetchRes
.head 3 -  ! String: sBlk
.head 3 -  ! String: sFv
.head 3 -  ! String: sFs
.head 3 -  String: sBankDay
.head 3 -  ! Number: nDocs
.head 3 -  Sql Handle: hSqlA
.head 3 -  Sql Handle: hSqlB
.head 3 -  Number: nPos
.head 3 -  Number: nDelta
.head 3 -  Number: nRecCount
.head 3 -  ! String: strMessage
.head 3 -  Number: nNm
.head 3 -  Number: nDk
.head 3 -  Number: nMfo
.head 3 -  String: sNd
.head 3 -  Number: nVob
.head 3 -  String: sNls
.head 3 -  String: sNlsk
.head 3 -  Number: nSk
.head 3 -  Number: nS
.head 3 -  Date/Time: dDat
.head 3 -  Date/Time: dPat
.head 3 -  Date/Time: dBat
.head 3 -  String: sPlat
.head 3 -  String: sPolu
.head 3 -  String: sNaz1
.head 3 -  String: sVspo
.head 3 -  ! String: sVspoDop
.head 3 -  String: sKod
.head 3 -  String: sKodB
.head 3 -  ! String: sKisp
.head 3 -  String: sSign
.head 3 -  Long String: lsSign
.head 3 -  ! Number: nRow
.head 3 -  Number: nRef
.head 3 -  String: sODBCDir
.head 3 -  String: sODBCDirCopy
.head 3 -  Date/Time: dTmp
.head 3 -  Number: nNp
.head 3 -  Number: n99
.head 3 -  Number: nSos
.head 3 -  Number: nKw
.head 3 -  !
.head 3 -  Number: nRef99bm
.head 3 -  Date/Time: dVdate
.head 3 -  !
.head 3 -  Number: nNewRow
.head 3 -  !
.head 3 -  Number: nTimeStart
.head 3 -  Number: nTimeCurrent
.head 3 -  Number: nTimeEnd
.head 3 -  Number: nHour
.head 3 -  Number: nMinu
.head 3 -  Number: nTemp
.head 3 -  Number: nTek
.head 3 -  Number: nRecn
.head 3 -  !
.head 3 -  Number: nCurrentRow
.head 3 -  Number: nP
.head 3 -  Number: nItog
.head 3 -  File Handle: hF
.head 3 -  Number: nColor
.head 3 -  String: sBuff
.head 3 -  String: sFr
.head 3 -  String: sTT
.head 3 -  String: sLev
.head 3 -  !
.head 3 -  Date/Time: dTemp
.head 3 -  Date/Time: dValu
.head 3 -  !
.head 3 -  Boolean: bNBU
.head 3 -  Number: nVOBtts
.head 3 -  !
.head 3 -  Date/Time: dTempDate
.head 3 -  !
.head 3 -  Number: hBtnYes
.head 3 -  Number: hBtnNo
.head 3 -  Number: hBtns[*]
.head 3 -  Number: nJur
.head 3 -  String: sTempDbf
.head 3 -  !
.head 3 -  String: sKASFIO
.head 3 -  String: sKASDOKsn
.head 3 -  String: sKASVID
.head 3 -  String: sKASDOK
.head 3 -  String: sKASSER
.head 3 -  String: sKASNDOK
.head 3 -  Boolean: b1
.head 3 -  Boolean: b2
.head 3 -  Boolean: b3
.head 3 -  !
.head 3 -  String: sSelectOper
.head 3 -  ! переменные для проверки реквизитов
.head 3 -  Boolean: bErr
.head 3 -  Boolean: bErrNLS
.head 3 -  String: sErrMes
.head 3 -  Number: i
.head 3 -  String: msSimv[33]
.head 3 -  String: sSAB
.head 3 -  String: sTmpNls
.head 3 -  !
.head 3 -  String: sR3
.head 3 -  Number: nR3
.head 3 -  String: sNDR3
.head 3 -  Boolean: br31
.head 3 -  Boolean: br32
.head 3 -  !
.head 3 -  Number: nFi
.head 3 -  Number: nYear
.head 3 -  Boolean: br3R
.head 3 -  Boolean: bn3
.head 3 -  Boolean: bF
.head 3 -  !
.head 3 -  String: smFilesRD[*]
.head 3 -  Boolean: bD
.head 3 -  Sql Handle: hSqlD
.head 3 -  String: smTAGd[*]
.head 3 -  String: smVALUEd[*]
.head 3 -  Number: nI
.head 3 -  Number: nK
.head 3 -  String: sTAGd
.head 3 -  String: sVALUEd
.head 3 -  Number: nBound
.head 3 -  !
.head 3 -  String: sVspoUGE
.head 3 -  Number: nIvs
.head 3 -  String: smREFd[*]
.head 3 -  String: sREFd
.head 3 -  Number: nFileVspo
.head 3 -  Boolean: mustProcess
.head 3 -  Number: nErrMsgSize
.head 3 -  Number: nSignRes
.head 3 -  String: szErrMsg
.head 3 -  !
.head 3 -  String: smFiles[*]
.head 3 -  Number: nmSizes[*]
.head 3 -  Date/Time: dmDateTimes[*]
.head 3 -  Number: nmAttributes[*]
.head 3 -  !
.head 3 -  String: smFiles2[*]
.head 3 -  Number: nmSizes2[*]
.head 3 -  Date/Time: dmDateTimes2[*]
.head 3 -  Number: nmAttributes2[*]
.head 3 -  !
.head 3 -  String: sSTP
.head 3 -  Number: nSTP
.head 3 -  !
.head 3 -  ! Number: nmREF[*]
.head 3 -  ! Number: nREF
.head 3 -  String: smREF[*]
.head 3 -  String: sREF
.head 3 -  String: smTAG[*]
.head 3 -  String: sTAG
.head 3 -  String: smVALUE[*]
.head 3 -  String: sVALUE
.head 3 -  ! Number: nRec
.head 3 -  String: sVspoAdd
.head 3 -  Sql Handle: hSqlC
.head 3 -  Number: nII
.head 3 -  String: sTemp
.head 3 -  String: sTTS
.head 3 -  String: sNLSKASSA
.head 3 -  String: smNLSKASSA[*]
.head 3 -  Number: nC
.head 3 -  Boolean: b4
.head 3 -  Boolean: bEE
.head 3 -  ! Number: nmREFrab[*]
.head 3 -  String: smREFrab[*]
.head 3 -  String: smTAGrab[*]
.head 3 -  String: smVALUErab[*]
.head 3 -  Number: nIt
.head 3 -  ! Number: nRefOper
.head 3 -  String: smDK0KASSA[*]
.head 3 -  String: smDK1KASSA[*]
.head 3 -  String: sBankMfo
.head 3 -  !
.head 3 -  Number: nD
.head 3 -  String: sVspoD
.head 3 -  !
.head 3 -  Boolean: bOpl
.head 3 -  !
.head 3 -  String: sFiler3
.head 3 -  String: sRef3
.head 3 -  Number: n3
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call ConPara('PUSH')
.head 4 -  Set hBtnYes = VisMessageLoadButton('&Да', 1)
.head 4 -  Set hBtnNo = VisMessageLoadButton('&Нет', 2)
.head 4 -  Call VisMessageSetBkgdColor(COLOR_Salmon)
.head 4 -  Set hBtns[0] = hBtnYes | MBF_DefButton
.head 4 -  Set hBtns[1] = hBtnNo
.head 4 -  Set sBankDay = GetBankDateEx()
.head 4 -  Set sBankMfo = GetBankMfo()
.head 4 -  Set bNBU = GetGlobalOption('NBUBANK')='1'
.head 4 -  Set dBat = GetBankDate()
.head 4 -  Set dfBD = dBat
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'MoperR3Path', Left(SalFileGetDrive(), 1) || ':\\BARS98\\ODBC.DSN\\MoperR3', sODBCDir,
     GetIniFileName())
.head 4 -  Set sODBCDir = IifS(Right(sODBCDir, 1)='\\', Left(sODBCDir, Len(sODBCDir)-1), sODBCDir)
.head 4 -  Call SalGetProfileString('Import', 'MoperR3PathCopy', Left(SalFileGetDrive(), 1) || ':\\BARS98\\ODBC.DSN\\MoperR3Copy',
     sODBCDirCopy, GetIniFileName())
.head 4 -  Set sODBCDirCopy = IifS(Right(sODBCDirCopy, 1)='\\', Left(sODBCDirCopy, Len(sODBCDirCopy)-1), sODBCDirCopy)
.head 4 -  Set dfTekKat = sODBCDir
.head 4 -  Call FileZNListBox()
.head 4 -  Call SalDisableWindow(dfBD)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalHideWindow(dfStart)
.head 4 -  Call SalHideWindow(dfEnd)
.head 4 -  Call SalSetFocus(pbExit)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_Destroy
.head 4 -  Call ConPara('POP')
.head 4 -  ! Call Pl_dat(dBat)
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Dialog Box: otborS_UCH
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Формирование файла списка участников СЭП эл.клиентам (районы)
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   2.713"
.head 4 -  Top:    0.979"
.head 4 -  Width:  7.55"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.071"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Формирование файла списка участников СЭП (клиенты, районы)
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Multiline Field: mlText
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 1024
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? No
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   4.283"
.head 6 -  Top:    4.988"
.head 6 -  Width:  3.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalSetFocus(tbl1)
.head 3 +  Pushbutton: pbRun
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить (F5)
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    4.988"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: F5
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Dark Green
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set sFile = VisDosGetEnvString('TEMP') || '\\' || sFile3
.head 6 -  Call SalHideWindow(ccMeter)
.head 6 +  If SalMessageBox('Выполнять формирование списка участников СЭП ?', 'ВНИМАНИЕ !!!',
   MB_YesNo | MB_IconQuestion) = IDNO
.head 7 -  Return 0
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set mlText = 'Формирование списка участников СЭП ...'
.head 6 +  If SqlPrepareAndExecute(hSql(), T("
   DELETE
   FROM tmp_sab"))
.head 7 -  Call SqlCommit(hSql())
.head 6 -  Set nRow = TBL_MinRow
.head 6 -  Set nInd = 0
.head 6 -  Set sSABall = ''
.head 6 -  Call SalArraySetUpperBound(sSelectSAB, 1, -1)
.head 6 +  While SalTblFindNextRow(tbl1, nRow, 0, 0)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 +  If tbl1.colOTM = '1'
.head 8 -  Call SqlPrepareAndExecute(hSql(), T("
     INSERT
     INTO tmp_sab (sab)
     VALUES (:tbl1.colSAB)"))
.head 8 -  Set sSelectSAB[nInd] = tbl1.colSAB
.head 8 -  Set sSABall = sSABall || tbl1.colSAB
.head 8 -  Set nInd = nInd + 1
.head 6 -  Set sSABall = PadL(Str(nInd), 4) || sSABall || PutLf()
.head 6 -  Call SqlCommit(hSql())
.head 6 -  ! вариант по всем SABам
.head 6 -  Set nKwo = 0
.head 6 -  Set bFL = TRUE
.head 6 +  If SqlPrepareAndExecute(hSql(), "
   SELECT count(*)
   INTO :nKwo
   FROM banks b
   WHERE b.mfop=(SELECT mfo
                 FROM banks
                 WHERE fmi='$B' and fmo='$A' and mfop=(SELECT val
                                                       FROM params
                                                       WHERE par='MFO')) or
                       (fmi='$B' and fmo='$A' and mfop=(SELECT val
                                                        FROM params
                                                        WHERE par='MFO'))")
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 +  Else
.head 7 -  Set bFL = FALSE
.head 6 +  If bFL
.head 7 -  Set nPos = 0
.head 7 -  Set nDelta = 100 / nKwo
.head 7 +  If File(sFile)
.head 8 -  Set nI = 0
.head 8 +  While not SalFileOpen(hF, sFile, OF_Delete)
.head 9 -  Set nI = nI + 1
.head 9 +  If nI > 5
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call MessageNoWait('Невозможно сформировать файл ' || sFile ||
     ', возможно он занят другим приложением.', 'ВНИМАНИЕ !!!', 0, 1)
.head 10 -  Set mlText = ''
.head 10 -  Return 0
.head 7 +  If SalFileOpen(hF, sFile, OF_Create | OF_Write)
.head 8 -  Set bFL = TRUE
.head 8 -  Call SaveInfoToLog('Open File: ' || sFile)
.head 8 +  If bFL
.head 9 -  Set bFL = SqlPrepareAndExecute(hSql(), "
    SELECT b.nb,b.mfo,b.sab,b.blk
    INTO :sNB,:sMFO,:sNCKS,:nBLK
    FROM banks b
    WHERE b.mfop=(SELECT mfo
                  FROM banks
                  WHERE fmi='$B' and fmo='$A' and mfop=(SELECT val
                                                        FROM params
                                                        WHERE par='MFO')) or
                        (fmi='$B' and fmo='$A' and mfop=(SELECT val
                                                         FROM params
                                                         WHERE par='MFO'))
 UNION ALL
    SELECT b.nb,b.mfo,b.sab,b.blk
    FROM banks b
    WHERE b.mfo=f_ourmfo
    ORDER BY 1,3")
.head 8 +  If bFL
.head 9 -  Call SalShowWindow(ccMeter)
.head 9 -  Set sBuffer = sSABall
.head 9 +  While SqlFetchNext(hSql(), nFetchRes)
.head 10 -  Call ccMeter.SetProgress(nPos)
.head 10 -  Call SalUpdateWindow(hWndForm)
.head 10 -  Set sBuffer = sBuffer || PadL(SalStrTrimX(sMFO), 9) || PadR(sNCKS, 4) ||
    Str(Mod(IifN(nBLK = NUMBER_Null, 0, nBLK), 10)) || StrWinToDosX(
    SalStrTrimX(sNB)) || PutLf() ! PutCrLf()
.head 10 +  If Len(sBuffer) > 64000
.head 11 -  Set bFL = SalFileWrite(hF, sBuffer, Len(sBuffer)) = Len(sBuffer)
.head 11 -  Call SaveInfoToLog('Write File: ' || Str(Len(sBuffer)))
.head 11 -  Set sBuffer = ''
.head 10 +  Else
.head 11 -  Set bFL = TRUE
.head 10 +  If not bFL
.head 11 -  Break
.head 10 -  Set nPos = nPos + nDelta
.head 9 +  If bFL
.head 10 -  ! Call SqlCommit(hSqlA)
.head 10 +  If Len(sBuffer) > 0
.head 11 -  Set bFL = SalFileWrite(hF, sBuffer, Len(sBuffer)) = Len(sBuffer)
.head 11 -  Call SaveInfoToLog('Write File: ' || Str(Len(sBuffer)) || ' - end')
.head 10 -  Call SalFileClose(hF)
.head 10 -  Call SaveInfoToLog('Close File: ' || sFile)
.head 10 -  Call ccMeter.SetProgress(100)
.head 10 +  ! If bFL
.head 11 -  Set mlText = 'Выписки за ' || Str(SalDateDay(dYes)) || ' ' ||
    GetMonthNameRus(SalDateMonth(dYes), TRUE) || ' ' || Str(
    SalDateYear(dYes)) || ' г. отобраны.'
.head 10 +  ! Else
.head 11 -  Set mlText = 'Ошибка 3 (запись файла) отбора выписок за ' || Str(
    SalDateDay(dYes)) || ' ' || GetMonthNameRus(
    SalDateMonth(dYes), TRUE) || ' ' || Str(SalDateYear(dYes)) ||
    ' г.'
.head 9 +  Else
.head 10 -  Call SalFileClose(hF)
.head 10 -  Call SaveInfoToLog('Close File (error 2): ' || sFile)
.head 10 -  Call VisFileDelete(sFile)
.head 10 -  Set mlText = 'Ошибка 2 (запись строки) отбора списка участников СЭП.'
.head 8 +  If bFL
.head 9 +  If File(sFile)
.head 10 -  Call SalFileCopy(sFile, sBackDocPath || sFile4, TRUE)
.head 10 -  Call SaveInfoToLog('Copy File: ' || sFile || ' to ' || sBackDocPath || sFile4)
.head 10 -  Set mlText = 'Отбор списка участников СЭП закончен.'
.head 8 +  Else
.head 9 +  If File(sFile)
.head 10 -  Call VisFileDelete(sFile)
.head 10 -  Call SaveInfoToLog('Delete File: ' || sFile)
.head 10 -  Set mlText = 'Ошибка 3 (запись файла) отбора списка участников СЭП.'
.head 6 +  Else
.head 7 -  Set mlText = 'Ошибка 1 (нет информации) отбора списка участников СЭП.'
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход (Esc)
.head 4 -  Window Location and Size
.head 5 -  Left:   2.183"
.head 5 -  Top:    4.988"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, 0)
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  7.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.917"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colOTM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Отм.
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.483"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSAB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 4
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNMK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 38
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  5.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colMFOSAB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call WaitCursorOn()
.head 6 -  Call SalTblPopulate(tbl1, hSql(), T("
     SELECT '1',sab,nb,mfo
     FROM banks
     INTO :tbl1.colOTM,:tbl1.colSAB,:tbl1.colNMK,:tbl1.colMFOSAB
     WHERE kodn=4 and blk<>2 and blk<>3 and blk<>9 and fmi='$A' and fmo='$B'
     ORDER BY sab"), TBL_FillAll)
.head 6 -  Call WaitCursorOff()
.head 3 +  Custom Control: ccMeter
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.283"
.head 6 -  Top:    5.405"
.head 6 -  Width:  3.1"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Dark Gray
.head 5 -  Background Color: Light Gray
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbMinus
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Снять пометки
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    5.405"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Red
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(tbl1, nRow, 0, 0)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colOTM = '0'
.head 3 +  Pushbutton: pbInvert
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Инверсия пометок
.head 4 -  Window Location and Size
.head 5 -  Left:   2.183"
.head 5 -  Top:    5.405"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(tbl1, nRow, 0, 0)
.head 7 -  Call SalTblSetContext(tbl1, nRow)
.head 7 -  Set tbl1.colOTM = Str(1-Val(tbl1.colOTM))
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nI
.head 3 -  Number: nKwo
.head 3 -  ! Boolean: bOk
.head 3 -  Boolean: bFL
.head 3 -  String: sBackDocPath
.head 3 -  String: sFile
.head 3 -  String: sFile3
.head 3 -  String: sFile4
.head 3 -  File Handle: hF
.head 3 -  !
.head 3 -  Number: nRow
.head 3 -  !
.head 3 -  Number: nPos
.head 3 -  Number: nDelta
.head 3 -  !
.head 3 -  String: sSelectSAB[*]
.head 3 -  String: sSAB_tmp
.head 3 -  Number: nInd
.head 3 -  !
.head 3 -  String: sBuffer
.head 3 -  !
.head 3 -  String: sNB
.head 3 -  String: sMFO
.head 3 -  String: sNCKS
.head 3 -  Number: nBLK
.head 3 -  !
.head 3 -  String: sSABall
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Set sFile3 = 'SUCH_.Txt'
.head 4 -  Set sFile4 = 'S_UCH.Txt'
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalHideWindow(ccMeter)
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('ElektroKlients', 'BackDocPath', GetPrnDir(), sBackDocPath,
     GetIniFileName())
.head 4 -  Set sBackDocPath = IifS(Right(sBackDocPath, 1)='\\', sBackDocPath, sBackDocPath || '\\')
.head 4 -  Set nI = 0
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSetFocus(tbl1)
.head 4 -  Call SalTblSetFocusCell(tbl1, 0, tbl1.colOTM, 0, 1)
.head 1 +  Dialog Box: dlgRODOon
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Просмотр реквизитов вклада РОДОВИД
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   1.225"
.head 4 -  Top:    0.354"
.head 4 -  Width:  14.467"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.917"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Просмотр реквизитов вклада РОДОВИД
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход (Esc)
.head 4 -  Window Location and Size
.head 5 -  Left:   12.767"
.head 5 -  Top:    6.143"
.head 5 -  Width:  1.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.488"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name: \Bars98\RESOURCE\BMP\DISCARD.BMP
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, 0)
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  14.283"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 6.119"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Courier New
.head 5 -  Font Size: 9
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование реквизита
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.267"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOld
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: В базе
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNew
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: В файле изменений
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  5.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 -  Call WaitCursorOn()
.head 6 -  Call WaitCursorOff()
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: smL[*]
.head 3 -  Number: nmL[*]
.head 3 -  String: smM[*]
.head 3 -  Number: nmM[*]
.head 2 +  Window Variables
.head 3 -  String: sStateCode_n
.head 3 -  String: sClientName_n
.head 3 -  String: sBirthday_n
.head 3 -  String: sBirthPlace_n
.head 3 -  String: sResident_n
.head 3 -  String: sWorkPlace_n
.head 3 -  String: sADDRESS_INDEX_n
.head 3 -  String: sADDRESS_OBL_n
.head 3 -  String: sADDRESS_REG_n
.head 3 -  String: sADDRESS_CITY_n
.head 3 -  String: sADDRESS_STR_n
.head 3 -  String: sADDRESS_HS_n
.head 3 -  String: sADDRESS_APP_n
.head 3 -  String: sK040_n
.head 3 -  String: sPhoneContact_n
.head 3 -  String: sPhoneHome_n
.head 3 -  String: sMOBILE_PHONE_n
.head 3 -  String: sPassport_Type_n
.head 3 -  String: sPassport_S_n
.head 3 -  String: sPassport_Num_n
.head 3 -  String: sPassport_Place_n
.head 3 -  String: sPassport_Date_n
.head 3 -  String: sK013_n
.head 3 -  String: sK015_n
.head 3 -  String: sLast_Ident_n
.head 3 -  String: sEmail_n
.head 3 -  String: sK080_n
.head 3 -  String: sK050_n
.head 3 -  String: sK070_n
.head 3 -  String: sMarital_Status_n
.head 3 -  String: sBranchCode_n
.head 3 -  String: sBranchName_n
.head 3 -  String: sBranchAddress_n
.head 3 -  String: sCode_n
.head 3 -  String: sOrgDate_n
.head 3 -  String: sEndDate_n
.head 3 -  String: sPercentBreak_n
.head 3 -  String: sProductCode_n
.head 3 -  String: sProductName_n
.head 3 -  String: sCurrencyTag_n
.head 3 -  String: sMainAccCode_n
.head 3 -  String: sMainAccR013_n
.head 3 -  String: sMainAccR011_n
.head 3 -  String: sPercAccCode_n
.head 3 -  String: sPercAccR013_n
.head 3 -  String: sPercAccR011_n
.head 3 -  String: sCapAccCode_n
.head 3 -  String: sCalcDateInto_n
.head 3 -  String: sBRANCHKODOBL_n
.head 3 -  String: sTYPEDOCDKFM_n
.head 3 -  String: sNAMEDOCDKFM_n
.head 3 -  String: sCODEUPB_n
.head 3 -  String: sMAINACCCODEUPB_n
.head 3 -  String: sStateCode_o
.head 3 -  String: sClientName_o
.head 3 -  String: sBirthday_o
.head 3 -  String: sBirthPlace_o
.head 3 -  String: sResident_o
.head 3 -  String: sWorkPlace_o
.head 3 -  String: sADDRESS_INDEX_o
.head 3 -  String: sADDRESS_OBL_o
.head 3 -  String: sADDRESS_REG_o
.head 3 -  String: sADDRESS_CITY_o
.head 3 -  String: sADDRESS_STR_o
.head 3 -  String: sADDRESS_HS_o
.head 3 -  String: sADDRESS_APP_o
.head 3 -  String: sK040_o
.head 3 -  String: sPhoneContact_o
.head 3 -  String: sPhoneHome_o
.head 3 -  String: sMOBILE_PHONE_o
.head 3 -  String: sPassport_Type_o
.head 3 -  String: sPassport_S_o
.head 3 -  String: sPassport_Num_o
.head 3 -  String: sPassport_Place_o
.head 3 -  String: sPassport_Date_o
.head 3 -  String: sK013_o
.head 3 -  String: sK015_o
.head 3 -  String: sLast_Ident_o
.head 3 -  String: sEmail_o
.head 3 -  String: sK080_o
.head 3 -  String: sK050_o
.head 3 -  String: sK070_o
.head 3 -  String: sMarital_Status_o
.head 3 -  String: sBranchCode_o
.head 3 -  String: sBranchName_o
.head 3 -  String: sBranchAddress_o
.head 3 -  String: sCode_o
.head 3 -  String: sOrgDate_o
.head 3 -  String: sEndDate_o
.head 3 -  String: sPercentBreak_o
.head 3 -  String: sProductCode_o
.head 3 -  String: sProductName_o
.head 3 -  String: sCurrencyTag_o
.head 3 -  String: sMainAccCode_o
.head 3 -  String: sMainAccR013_o
.head 3 -  String: sMainAccR011_o
.head 3 -  String: sPercAccCode_o
.head 3 -  String: sPercAccR013_o
.head 3 -  String: sPercAccR011_o
.head 3 -  String: sCapAccCode_o
.head 3 -  String: sCalcDateInto_o
.head 3 -  String: sBRANCHKODOBL_o
.head 3 -  String: sTYPEDOCDKFM_o
.head 3 -  String: sNAMEDOCDKFM_o
.head 3 -  String: sCODEUPB_o
.head 3 -  String: sMAINACCCODEUPB_o
.head 3 -  Number: nId_n
.head 3 -  Number: nDataId_n
.head 3 -  Number: nClientId_n
.head 3 -  Number: nKodObl_n
.head 3 -  Number: nChildrenCount_n
.head 3 -  Number: nTreatyId_n
.head 3 -  Number: nPercentCur_n
.head 3 -  Number: nCrncyAmount_n
.head 3 -  Number: nMainAccId_n
.head 3 -  Number: nMainAccRest_n
.head 3 -  Number: nPercAccId_n
.head 3 -  Number: nPercAccRest_n
.head 3 -  Number: nPercentPay_n
.head 3 -  Number: nPercentCap_n
.head 3 -  Number: nId_o
.head 3 -  Number: nDataId_o
.head 3 -  Number: nClientId_o
.head 3 -  Number: nKodObl_o
.head 3 -  Number: nChildrenCount_o
.head 3 -  Number: nTreatyId_o
.head 3 -  Number: nPercentCur_o
.head 3 -  Number: nCrncyAmount_o
.head 3 -  Number: nMainAccId_o
.head 3 -  Number: nMainAccRest_o
.head 3 -  Number: nPercAccId_o
.head 3 -  Number: nPercAccRest_o
.head 3 -  Number: nPercentPay_o
.head 3 -  Number: nPercentCap_o
.head 3 -  Number: nNewRow
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set sStateCode_n      = smL[0]
.head 4 -  Set sClientName_n     = smL[1]
.head 4 -  Set sBirthday_n       = smL[2]
.head 4 -  Set sBirthPlace_n     = smL[3]
.head 4 -  Set sResident_n       = smL[4]
.head 4 -  Set sWorkPlace_n      = smL[5]
.head 4 -  Set sADDRESS_INDEX_n  = smL[6]
.head 4 -  Set sADDRESS_OBL_n    = smL[7]
.head 4 -  Set sADDRESS_REG_n    = smL[8]
.head 4 -  Set sADDRESS_CITY_n   = smL[9]
.head 4 -  Set sADDRESS_STR_n    = smL[10]
.head 4 -  Set sADDRESS_HS_n     = smL[11]
.head 4 -  Set sADDRESS_APP_n    = smL[12]
.head 4 -  Set sK040_n           = smL[13]
.head 4 -  Set sPhoneContact_n   = smL[14]
.head 4 -  Set sPhoneHome_n      = smL[15]
.head 4 -  Set sMOBILE_PHONE_n   = smL[16]
.head 4 -  Set sPassport_Type_n  = smL[17]
.head 4 -  Set sPassport_S_n     = smL[18]
.head 4 -  Set sPassport_Num_n   = smL[19]
.head 4 -  Set sPassport_Place_n = smL[20]
.head 4 -  Set sPassport_Date_n  = smL[21]
.head 4 -  Set sK013_n           = smL[22]
.head 4 -  Set sK015_n           = smL[23]
.head 4 -  Set sLast_Ident_n     = smL[24]
.head 4 -  Set sEmail_n          = smL[25]
.head 4 -  Set sK080_n           = smL[26]
.head 4 -  Set sK050_n           = smL[27]
.head 4 -  Set sK070_n           = smL[28]
.head 4 -  Set sMarital_Status_n = smL[29]
.head 4 -  Set sBranchCode_n     = smL[30]
.head 4 -  Set sBranchName_n     = smL[31]
.head 4 -  Set sBranchAddress_n  = smL[32]
.head 4 -  Set sCode_n           = smL[33]
.head 4 -  Set sOrgDate_n        = smL[34]
.head 4 -  Set sEndDate_n        = smL[35]
.head 4 -  Set sPercentBreak_n   = smL[36]
.head 4 -  Set sProductCode_n    = smL[37]
.head 4 -  Set sProductName_n    = smL[38]
.head 4 -  Set sCurrencyTag_n    = smL[39]
.head 4 -  Set sMainAccCode_n    = smL[40]
.head 4 -  Set sMainAccR013_n    = smL[41]
.head 4 -  Set sMainAccR011_n    = smL[42]
.head 4 -  Set sPercAccCode_n    = smL[43]
.head 4 -  Set sPercAccR013_n    = smL[44]
.head 4 -  Set sPercAccR011_n    = smL[45]
.head 4 -  Set sCapAccCode_n     = smL[46]
.head 4 -  Set sCalcDateInto_n   = smL[47]
.head 4 -  Set sBRANCHKODOBL_n   = smL[48]
.head 4 -  Set sTYPEDOCDKFM_n    = smL[49]
.head 4 -  Set sNAMEDOCDKFM_n    = smL[50]
.head 4 -  Set sCODEUPB_n        = smL[51]
.head 4 -  Set sMAINACCCODEUPB_n = smL[52]
.head 4 -  Set nId_n             = nmL[0]
.head 4 -  Set nDataId_n         = nmL[1]
.head 4 -  Set nClientId_n       = nmL[2]
.head 4 -  Set nKodObl_n         = nmL[3]
.head 4 -  Set nChildrenCount_n  = nmL[4]
.head 4 -  Set nTreatyId_n       = nmL[5]
.head 4 -  Set nPercentCur_n     = nmL[6]
.head 4 -  Set nCrncyAmount_n    = nmL[7]
.head 4 -  Set nMainAccId_n      = nmL[8]
.head 4 -  Set nMainAccRest_n    = nmL[9]
.head 4 -  Set nPercAccId_n      = nmL[10]
.head 4 -  Set nPercAccRest_n    = nmL[11]
.head 4 -  Set nPercentPay_n     = nmL[12]
.head 4 -  Set nPercentCap_n     = nmL[13]
.head 4 -  Set sStateCode_o      = smM[0]
.head 4 -  Set sClientName_o     = smM[1]
.head 4 -  Set sBirthday_o       = smM[2]
.head 4 -  Set sBirthPlace_o     = smM[3]
.head 4 -  Set sResident_o       = smM[4]
.head 4 -  Set sWorkPlace_o      = smM[5]
.head 4 -  Set sADDRESS_INDEX_o  = smM[6]
.head 4 -  Set sADDRESS_OBL_o    = smM[7]
.head 4 -  Set sADDRESS_REG_o    = smM[8]
.head 4 -  Set sADDRESS_CITY_o   = smM[9]
.head 4 -  Set sADDRESS_STR_o    = smM[10]
.head 4 -  Set sADDRESS_HS_o     = smM[11]
.head 4 -  Set sADDRESS_APP_o    = smM[12]
.head 4 -  Set sK040_o           = smM[13]
.head 4 -  Set sPhoneContact_o   = smM[14]
.head 4 -  Set sPhoneHome_o      = smM[15]
.head 4 -  Set sMOBILE_PHONE_o   = smM[16]
.head 4 -  Set sPassport_Type_o  = smM[17]
.head 4 -  Set sPassport_S_o     = smM[18]
.head 4 -  Set sPassport_Num_o   = smM[19]
.head 4 -  Set sPassport_Place_o = smM[20]
.head 4 -  Set sPassport_Date_o  = smM[21]
.head 4 -  Set sK013_o           = smM[22]
.head 4 -  Set sK015_o           = smM[23]
.head 4 -  Set sLast_Ident_o     = smM[24]
.head 4 -  Set sEmail_o          = smM[25]
.head 4 -  Set sK080_o           = smM[26]
.head 4 -  Set sK050_o           = smM[27]
.head 4 -  Set sK070_o           = smM[28]
.head 4 -  Set sMarital_Status_o = smM[29]
.head 4 -  Set sBranchCode_o     = smM[30]
.head 4 -  Set sBranchName_o     = smM[31]
.head 4 -  Set sBranchAddress_o  = smM[32]
.head 4 -  Set sCode_o           = smM[33]
.head 4 -  Set sOrgDate_o        = smM[34]
.head 4 -  Set sEndDate_o        = smM[35]
.head 4 -  Set sPercentBreak_o   = smM[36]
.head 4 -  Set sProductCode_o    = smM[37]
.head 4 -  Set sProductName_o    = smM[38]
.head 4 -  Set sCurrencyTag_o    = smM[39]
.head 4 -  Set sMainAccCode_o    = smM[40]
.head 4 -  Set sMainAccR013_o    = smM[41]
.head 4 -  Set sMainAccR011_o    = smM[42]
.head 4 -  Set sPercAccCode_o    = smM[43]
.head 4 -  Set sPercAccR013_o    = smM[44]
.head 4 -  Set sPercAccR011_o    = smM[45]
.head 4 -  Set sCapAccCode_o     = smM[46]
.head 4 -  Set sCalcDateInto_o   = smM[47]
.head 4 -  Set sBRANCHKODOBL_o   = smM[48]
.head 4 -  Set sTYPEDOCDKFM_o    = smM[49]
.head 4 -  Set sNAMEDOCDKFM_o    = smM[50]
.head 4 -  Set sCODEUPB_o        = smM[51]
.head 4 -  Set sMAINACCCODEUPB_o = smM[52]
.head 4 -  Set nId_o             = nmM[0]
.head 4 -  Set nDataId_o         = nmM[1]
.head 4 -  Set nClientId_o       = nmM[2]
.head 4 -  Set nKodObl_o         = nmM[3]
.head 4 -  Set nChildrenCount_o  = nmM[4]
.head 4 -  Set nTreatyId_o       = nmM[5]
.head 4 -  Set nPercentCur_o     = nmM[6]
.head 4 -  Set nCrncyAmount_o    = nmM[7]
.head 4 -  Set nMainAccId_o      = nmM[8]
.head 4 -  Set nMainAccRest_o    = nmM[9]
.head 4 -  Set nPercAccId_o      = nmM[10]
.head 4 -  Set nPercAccRest_o    = nmM[11]
.head 4 -  Set nPercentPay_o     = nmM[12]
.head 4 -  Set nPercentCap_o     = nmM[13]
.head 4 -  !
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'Id'
.head 4 -  Set tbl1.colOld = Str(nId_o)
.head 4 -  Set tbl1.colNew = Str(nId_n)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'DataId'
.head 4 -  Set tbl1.colOld = Str(nDataId_o)
.head 4 -  Set tbl1.colNew = Str(nDataId_n)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'ClientId'
.head 4 -  Set tbl1.colOld = Str(nClientId_o)
.head 4 -  Set tbl1.colNew = Str(nClientId_n)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'StateCode'
.head 4 -  Set tbl1.colOld = sStateCode_o
.head 4 -  Set tbl1.colNew = sStateCode_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_Sky)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'ClientName'
.head 4 -  Set tbl1.colOld = sClientName_o
.head 4 -  Set tbl1.colNew = sClientName_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_Sky)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'Birthday'
.head 4 -  Set tbl1.colOld = sBirthday_o
.head 4 -  Set tbl1.colNew = sBirthday_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'BirthPlace'
.head 4 -  Set tbl1.colOld = sBirthPlace_o
.head 4 -  Set tbl1.colNew = sBirthPlace_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'Resident'
.head 4 -  Set tbl1.colOld = sResident_o
.head 4 -  Set tbl1.colNew = sResident_n
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'KodObl'
.head 4 -  Set tbl1.colOld = Str(nKodObl_o)
.head 4 -  Set tbl1.colNew = Str(nKodObl_n)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'WorkPlace'
.head 4 -  Set tbl1.colOld = sWorkPlace_o
.head 4 -  Set tbl1.colNew = sWorkPlace_n
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'ADDRESS_INDEX'
.head 4 -  Set tbl1.colOld = sADDRESS_INDEX_o
.head 4 -  Set tbl1.colNew = sADDRESS_INDEX_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'ADDRESS_OBL'
.head 4 -  Set tbl1.colOld = sADDRESS_OBL_o
.head 4 -  Set tbl1.colNew = sADDRESS_OBL_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'ADDRESS_REG'
.head 4 -  Set tbl1.colOld = sADDRESS_REG_o
.head 4 -  Set tbl1.colNew = sADDRESS_REG_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'ADDRESS_CITY'
.head 4 -  Set tbl1.colOld = sADDRESS_CITY_o
.head 4 -  Set tbl1.colNew = sADDRESS_CITY_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'ADDRESS_STR'
.head 4 -  Set tbl1.colOld = sADDRESS_STR_o
.head 4 -  Set tbl1.colNew = sADDRESS_STR_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'ADDRESS_HS'
.head 4 -  Set tbl1.colOld = sADDRESS_HS_o
.head 4 -  Set tbl1.colNew = sADDRESS_HS_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'ADDRESS_APP'
.head 4 -  Set tbl1.colOld = sADDRESS_APP_o
.head 4 -  Set tbl1.colNew = sADDRESS_APP_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'K040'
.head 4 -  Set tbl1.colOld = sK040_o
.head 4 -  Set tbl1.colNew = sK040_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'PhoneContact'
.head 4 -  Set tbl1.colOld = sPhoneContact_o
.head 4 -  Set tbl1.colNew = sPhoneContact_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'PhoneHome'
.head 4 -  Set tbl1.colOld = sPhoneHome_o
.head 4 -  Set tbl1.colNew = sPhoneHome_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'MOBILE_PHONE'
.head 4 -  Set tbl1.colOld = sMOBILE_PHONE_o
.head 4 -  Set tbl1.colNew = sMOBILE_PHONE_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'Passport_Type'
.head 4 -  Set tbl1.colOld = sPassport_Type_o
.head 4 -  Set tbl1.colNew = sPassport_Type_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'Passport_S'
.head 4 -  Set tbl1.colOld = sPassport_S_o
.head 4 -  Set tbl1.colNew = sPassport_S_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'Passport_Num'
.head 4 -  Set tbl1.colOld = sPassport_Num_o
.head 4 -  Set tbl1.colNew = sPassport_Num_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'Passport_Place'
.head 4 -  Set tbl1.colOld = sPassport_Place_o
.head 4 -  Set tbl1.colNew = sPassport_Place_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'Passport_Date'
.head 4 -  Set tbl1.colOld = sPassport_Date_o
.head 4 -  Set tbl1.colNew = sPassport_Date_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'K013'
.head 4 -  Set tbl1.colOld = sK013_o
.head 4 -  Set tbl1.colNew = sK013_n
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'K015'
.head 4 -  Set tbl1.colOld = sK015_o
.head 4 -  Set tbl1.colNew = sK015_n
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'Last_Ident'
.head 4 -  Set tbl1.colOld = sLast_Ident_o
.head 4 -  Set tbl1.colNew = sLast_Ident_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'Email'
.head 4 -  Set tbl1.colOld = sEmail_o
.head 4 -  Set tbl1.colNew = sEmail_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'K080'
.head 4 -  Set tbl1.colOld = sK080_o
.head 4 -  Set tbl1.colNew = sK080_n
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'K050'
.head 4 -  Set tbl1.colOld = sK050_o
.head 4 -  Set tbl1.colNew = sK050_n
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'K070'
.head 4 -  Set tbl1.colOld = sK070_o
.head 4 -  Set tbl1.colNew = sK070_n
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'Marital_Status'
.head 4 -  Set tbl1.colOld = sMarital_Status_o
.head 4 -  Set tbl1.colNew = sMarital_Status_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'ChildrenCount'
.head 4 -  Set tbl1.colOld = Str(nChildrenCount_o)
.head 4 -  Set tbl1.colNew = Str(nChildrenCount_n)
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'TreatyId'
.head 4 -  Set tbl1.colOld = Str(nTreatyId_o)
.head 4 -  Set tbl1.colNew = Str(nTreatyId_n)
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'BranchCode'
.head 4 -  Set tbl1.colOld = sBranchCode_o
.head 4 -  Set tbl1.colNew = sBranchCode_n
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'BranchName'
.head 4 -  Set tbl1.colOld = sBranchName_o
.head 4 -  Set tbl1.colNew = sBranchName_n
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'BranchAddress'
.head 4 -  Set tbl1.colOld = sBranchAddress_o
.head 4 -  Set tbl1.colNew = sBranchAddress_n
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'Code'
.head 4 -  Set tbl1.colOld = sCode_o
.head 4 -  Set tbl1.colNew = sCode_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'OrgDate'
.head 4 -  Set tbl1.colOld = sOrgDate_o
.head 4 -  Set tbl1.colNew = sOrgDate_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'EndDate'
.head 4 -  Set tbl1.colOld = sEndDate_o
.head 4 -  Set tbl1.colNew = sEndDate_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_Orchid)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'PercentCur'
.head 4 -  Set tbl1.colOld = Str(nPercentCur_o)
.head 4 -  Set tbl1.colNew = Str(nPercentCur_n)
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_Orchid)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'PercentBreak'
.head 4 -  Set tbl1.colOld = sPercentBreak_o
.head 4 -  Set tbl1.colNew = sPercentBreak_n
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'ProductCode'
.head 4 -  Set tbl1.colOld = sProductCode_o
.head 4 -  Set tbl1.colNew = sProductCode_n
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'ProductName'
.head 4 -  Set tbl1.colOld = sProductName_o
.head 4 -  Set tbl1.colNew = sProductName_n
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'CurrencyTag'
.head 4 -  Set tbl1.colOld = sCurrencyTag_o
.head 4 -  Set tbl1.colNew = sCurrencyTag_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_Orchid)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'CrncyAmount'
.head 4 -  Set tbl1.colOld = Str(nCrncyAmount_o)
.head 4 -  Set tbl1.colNew = Str(nCrncyAmount_n)
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_Orchid)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'MainAccId'
.head 4 -  Set tbl1.colOld = Str(nMainAccId_o)
.head 4 -  Set tbl1.colNew = Str(nMainAccId_n)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'MainAccCode'
.head 4 -  Set tbl1.colOld = sMainAccCode_o
.head 4 -  Set tbl1.colNew = sMainAccCode_n
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'MainAccRest'
.head 4 -  Set tbl1.colOld = Str(nMainAccRest_o)
.head 4 -  Set tbl1.colNew = Str(nMainAccRest_n)
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_Orchid)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'MainAccR013'
.head 4 -  Set tbl1.colOld = sMainAccR013_o
.head 4 -  Set tbl1.colNew = sMainAccR013_n
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'MainAccR011'
.head 4 -  Set tbl1.colOld = sMainAccR011_o
.head 4 -  Set tbl1.colNew = sMainAccR011_n
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'PercAccId'
.head 4 -  Set tbl1.colOld = Str(nPercAccId_o)
.head 4 -  Set tbl1.colNew = Str(nPercAccId_n)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'PercAccCode'
.head 4 -  Set tbl1.colOld = sPercAccCode_o
.head 4 -  Set tbl1.colNew = sPercAccCode_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_Orchid)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'PercAccRest'
.head 4 -  Set tbl1.colOld = Str(nPercAccRest_o)
.head 4 -  Set tbl1.colNew = Str(nPercAccRest_n)
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_Orchid)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'PercAccR013'
.head 4 -  Set tbl1.colOld = sPercAccR013_o
.head 4 -  Set tbl1.colNew = sPercAccR013_n
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'PercAccR011'
.head 4 -  Set tbl1.colOld = sPercAccR011_o
.head 4 -  Set tbl1.colNew = sPercAccR011_n
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'PercentPay'
.head 4 -  Set tbl1.colOld = Str(nPercentPay_o)
.head 4 -  Set tbl1.colNew = Str(nPercentPay_n)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'PercentCap'
.head 4 -  Set tbl1.colOld = Str(nPercentCap_o)
.head 4 -  Set tbl1.colNew = Str(nPercentCap_n)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'CapAccCode'
.head 4 -  Set tbl1.colOld = sCapAccCode_o
.head 4 -  Set tbl1.colNew = sCapAccCode_n
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'CalcDateInto'
.head 4 -  Set tbl1.colOld = sCalcDateInto_o
.head 4 -  Set tbl1.colNew = sCalcDateInto_n
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'BRANCHKODOBL'
.head 4 -  Set tbl1.colOld = sBRANCHKODOBL_o
.head 4 -  Set tbl1.colNew = sBRANCHKODOBL_n
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'TYPEDOCDKFM'
.head 4 -  Set tbl1.colOld = sTYPEDOCDKFM_o
.head 4 -  Set tbl1.colNew = sTYPEDOCDKFM_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'NAMEDOCDKFM'
.head 4 -  Set tbl1.colOld = sNAMEDOCDKFM_o
.head 4 -  Set tbl1.colNew = sNAMEDOCDKFM_n
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'CODEUPB'
.head 4 -  Set tbl1.colOld = sCODEUPB_o
.head 4 -  Set tbl1.colNew = sCODEUPB_n
.head 4 -  !
.head 4 -  Set nNewRow = SalTblInsertRow(tbl1, TBL_MaxRow)
.head 4 -  Call SalTblSetContext(tbl1, nNewRow)
.head 4 -  Set tbl1.colName = 'MAINACCCODEUPB'
.head 4 -  Set tbl1.colOld = sMAINACCCODEUPB_o
.head 4 -  Set tbl1.colNew = sMAINACCCODEUPB_n
.head 4 +  If tbl1.colOld != tbl1.colNew
.head 5 -  Call XSalTblSetRowBackColor(tbl1, nNewRow, COLOR_LightGreen)
.head 1 +  Table Window: AKB2
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: АРХИВ валютных документов от КБ
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.113"
.head 4 -  Top:    0.563"
.head 4 -  Width:  14.35"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.619"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 32000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.452"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 5174
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If AKB2.colTIPKB = 3
.head 8 -  Set sDir = GetTemplateDir() || "\\ZAY_KMS.QRP"
.head 8 -  Set sFileName = GetPrnDir() || '\\D' || Str(AKB2.colREF) || '.za3'
.head 8 -  Set sRab = 'NMK,ADRES,OKPO,RUK,BUH,NLS,MFO,NB,KVA,SUMV,KURS,KVB,DATZ,REF,DATD,' ||
    'FIO,TEL'
.head 7 +  Else If AKB2.colTIPKB = 6
.head 8 -  Set sDir = GetTemplateDir() || "\\ZAY_ORD.QRP"
.head 8 -  Set sFileName = GetPrnDir() || '\\D' || Str(AKB2.colREF) || '.za6'
.head 8 -  Set sRab = 'REF,DATZ,RUK,BUH,NB_A,CB_A,NK_A,CK_A,NLS_A,SUM,KV,SUMPR,NO1,NO2,NO3,'
    || 'NO4,NO5,BO1,BO2,BO3,BO4,BP1,BP2,BP3,BP4,NP1,NP2,NP3,NP4,ID_OPER,' ||
    'COUNTRY_B,COST,KV_COST,EXPRESS,ADRES,OKPO'
.head 7 +  Else If AKB2.colTIPKB = 7
.head 8 -  Set sDir = GetTemplateDir() || "\\ZAY_ORDK.QRP"
.head 8 -  Set sFileName = GetPrnDir() || '\\D' || Str(AKB2.colREF) || '.za7'
.head 8 -  Set sRab = 'REF,DATZ,RUK,BUH,NMK,OKPO,ADRES,NLS_V,SUM,SUMPR,KV,NLS_CR,NAZN,N_CR,'
    || 'DAT_CR,KV_COST'
.head 7 -  Set bU = FALSE
.head 7 -  Call SalReportPrintToFile(hWndForm, sDir, sFileName, sRab, sRab, 1, RPT_PrintAll, 1,
     1, FALSE, nInd)
.head 7 -  Call DirectView(sFileName)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 -  On SAM_Create
.head 6 +  On SAM_Click
.head 7 +  If AKB2.colTIPKB = 3
.head 8 -  Set sDir = GetTemplateDir() || "\\ZAY_KMS.QRP"
.head 8 -  Set sFileName = GetPrnDir() || '\\D' || Str(AKB2.colREF) || '.za3'
.head 8 -  ! Set sRab = 'NMK,ADRES,RUK,BUH,NLS,MFO,NB,KVA,SUMV,KURS,KVB,DATZ,REF,DATD'
.head 8 -  Set sRab = 'NMK,ADRES,OKPO,RUK,BUH,NLS,MFO,NB,KVA,SUMV,KURS,KVB,DATZ,REF,DATD,' ||
    'FIO,TEL'
.head 7 +  Else If AKB2.colTIPKB = 6
.head 8 -  Set sDir = GetTemplateDir() || "\\ZAY_ORD.QRP"
.head 8 -  Set sFileName = GetPrnDir() || '\\D' || Str(AKB2.colREF) || '.za6'
.head 8 -  Set sRab = 'REF,DATZ,RUK,BUH,NB_A,CB_A,NK_A,CK_A,NLS_A,SUM,KV,SUMPR,NO1,NO2,NO3,'
    || 'NO4,NO5,BO1,BO2,BO3,BO4,BP1,BP2,BP3,BP4,NP1,NP2,NP3,NP4,ID_OPER,' ||
    'COUNTRY_B,COST,KV_COST,EXPRESS,ADRES,OKPO'
.head 7 +  Else If AKB2.colTIPKB = 7
.head 8 -  Set sDir = GetTemplateDir() || "\\ZAY_ORDK.QRP"
.head 8 -  Set sFileName = GetPrnDir() || '\\D' || Str(AKB2.colREF) || '.za7'
.head 8 -  Set sRab = 'REF,DATZ,RUK,BUH,NMK,OKPO,ADRES,NLS_V,SUM,SUMPR,KV,NLS_CR,NAZN,N_CR,'
    || 'DAT_CR,KV_COST'
.head 7 -  Set bU = FALSE
.head 7 -  Call SalReportPrintToFile(hWndForm, sDir, sFileName, sRab, sRab, 1, RPT_PrintAll, 1,
     1, FALSE, nInd)
.head 7 -  Call zarez12(sFileName, 0, '')
.head 7 -  Call DosDirectPrint(sFileName)
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, 'Печать документа')
.head 4 -  Line
.head 5 -  Resource Id: 5175
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 5176
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Background Text: Конверсия
.head 5 -  Resource Id: 48196
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.683"
.head 6 -  Top:    0.143"
.head 6 -  Width:  1.283"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.214"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Center
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Maize
.head 4 -  Background Text: Загранперевод
.head 5 -  Resource Id: 48198
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.083"
.head 6 -  Top:    0.143"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.214"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Center
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Green
.head 4 -  Background Text: Погашение кредита
.head 5 -  Resource Id: 48197
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.983"
.head 6 -  Top:    0.143"
.head 6 -  Width:  2.283"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.214"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Center
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Gray
.head 4 -  Frame
.head 5 -  Resource Id: 48199
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.65"
.head 6 -  Top:    0.119"
.head 6 -  Width:  1.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.262"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Corners: Square
.head 5 -  Border Style: Solid
.head 5 -  Border Thickness: 1
.head 5 -  Border Color: Default
.head 5 -  Background Color: Default
.head 4 -  Frame
.head 5 -  Resource Id: 48201
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.05"
.head 6 -  Top:    0.119"
.head 6 -  Width:  1.85"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.262"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Corners: Square
.head 5 -  Border Style: Solid
.head 5 -  Border Thickness: 1
.head 5 -  Border Color: Default
.head 5 -  Background Color: Default
.head 4 -  Frame
.head 5 -  Resource Id: 48200
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.933"
.head 6 -  Top:    0.119"
.head 6 -  Width:  2.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.262"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Corners: Square
.head 5 -  Border Style: Solid
.head 5 -  Border Thickness: 1
.head 5 -  Border Color: Default
.head 5 -  Background Color: Default
.head 2 +  Contents
.head 3 +  Column: colSAB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colREF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Референс
док.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.917"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
док.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDATD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
док.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  0.633"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
вал.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKURSKONV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Курс
конверсии
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
док.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.683"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNLSPOG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
погашения
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.983"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKVKOMISS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код вал.
комиссии
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.983"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTIPKB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Тип
док КБ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.714"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFNAMEKB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Имя файла
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colIDENTKB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Идентификатор
док.
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 16
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.4"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  ! novisible
.head 3 +  Column: colID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNEOM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOKPO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNKREDDOG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDKREDDOG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTAG59
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 200
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTAG57A
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 200
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTAG56
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 200
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTAG70
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 200
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTAG72N
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCOUNTRY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKODOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOURBENSHA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colIDCONTRACT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDATEDOKKB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNLSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPRWO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colVOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKOD_B
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKOD_G
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKOD_N
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nI
.head 3 -  ! String: sTitle
.head 3 -  ! String: sTemp
.head 3 -  Boolean: bU
.head 3 -  String: NMK
.head 3 -  String: ADRES
.head 3 -  String: RUK
.head 3 -  String: BUH
.head 3 -  String: NLS
.head 3 -  String: MFO
.head 3 -  String: NB
.head 3 -  String: DATZ
.head 3 -  String: DATD
.head 3 -  String: KVA
.head 3 -  String: KVB
.head 3 -  Number: SUMV
.head 3 -  Number: KURS
.head 3 -  String: sDir
.head 3 -  String: sFileName
.head 3 -  String: sRab
.head 3 -  Number: nInd
.head 3 -  !
.head 3 -  String: NK_A
.head 3 -  String: NB_A
.head 3 -  String: CB_A
.head 3 -  String: CK_A
.head 3 -  String: NLS_A
.head 3 -  String: KV
.head 3 -  String: NLS_B
.head 3 -  String: NB_B
.head 3 -  String: CONTRACT
.head 3 -  String: ID_OPER
.head 3 -  String: COUNTRY_B
.head 3 -  Number: COST
.head 3 -  Number: EXPRESS
.head 3 -  String: NB_C
.head 3 -  String: REF
.head 3 -  String: SUMPR
.head 3 -  String: CK_B
.head 3 -  String: ADD_B
.head 3 -  String: CB_B
.head 3 -  String: SW_B
.head 3 -  String: CB_C
.head 3 -  String: SW_C
.head 3 -  String: ITEM
.head 3 -  String: KV_COST
.head 3 -  String: NK_B
.head 3 -  String: AK_B
.head 3 -  ! !
.head 3 -  String: NO1
.head 3 -  String: NO2
.head 3 -  String: NO3
.head 3 -  String: NO4
.head 3 -  String: NO5
.head 3 -  String: BO1
.head 3 -  String: BO2
.head 3 -  String: BO3
.head 3 -  String: BO4
.head 3 -  String: BP1
.head 3 -  String: BP2
.head 3 -  String: BP3
.head 3 -  String: BP4
.head 3 -  String: NP1
.head 3 -  String: NP2
.head 3 -  String: NP3
.head 3 -  String: NP4
.head 3 -  !
.head 3 -  String: OKPO
.head 3 -  String: NLS_V
.head 3 -  String: NLS_CR
.head 3 -  String: NAZN
.head 3 -  String: N_CR
.head 3 -  Date/Time: DAT_CR
.head 3 -  Number: SUM
.head 3 -  String: smTemp[*]
.head 3 -  !
.head 3 -  ! String: KODOKPO
.head 3 -  String: FIO
.head 3 -  String: TEL
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
.head 4 -  Set AKB2.strFilterTblName = 'KLPV'
.head 4 -  Set AKB2.fFilterAtStart = TRUE
.head 4 -  Set nFlags = GT_NoIns | GT_NoUpd | GT_NoDel
.head 4 -  Set AKB2.strSqlPopulate = "
    SELECT ID,REF,NEOM,SAB,FL,NLS,OKPO,ND,DATD,S/100,KV,NLSPOG,NKREDDOG,DKREDDOG,KVKOMISS,
           TAG59,TAG57A,TAG56,TAG70,TAG72N,COUNTRY,KODOP,OURBENSHA,IDCONTRACT,FNAMEKB,
           IDENTKB,TIPKB,DATEDOKKB,TT,NLSB,PRWO,VOB,KURSKONV,KOD_B,KOD_G,KOD_N
    INTO :AKB2.colID,:AKB2.colREF,:AKB2.colNEOM,:AKB2.colSAB,:AKB2.colFL,:AKB2.colNLS,
         :AKB2.colOKPO,:AKB2.colND,:AKB2.colDATD,:AKB2.colS,:AKB2.colKV,:AKB2.colNLSPOG,
         :AKB2.colNKREDDOG,:AKB2.colDKREDDOG,:AKB2.colKVKOMISS,:AKB2.colTAG59,
         :AKB2.colTAG57A,:AKB2.colTAG56,:AKB2.colTAG70,:AKB2.colTAG72N,:AKB2.colCOUNTRY,
         :AKB2.colKODOP,:AKB2.colOURBENSHA,:AKB2.colIDCONTRACT,:AKB2.colFNAMEKB,
         :AKB2.colIDENTKB,:AKB2.colTIPKB,:AKB2.colDATEDOKKB,:AKB2.colTT,:AKB2.colNLSB,
         :AKB2.colPRWO,:AKB2.colVOB,:AKB2.colKURSKONV,:AKB2.colKOD_B,:AKB2.colKOD_G,
         :AKB2.colKOD_N
    FROM klpv
    WHERE fl=8
    ORDER BY 2"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If AKB2.colTIPKB = 3
.head 5 -  ! Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(230, 255, 255)) ! голубой
.head 5 -  Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_Maize) ! желтый
.head 4 +  Else If AKB2.colTIPKB = 6
.head 5 -  ! Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(230, 255, 255)) ! голубой
.head 5 -  Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_LightGreen) ! голубой
.head 4 +  Else If AKB2.colTIPKB = 7
.head 5 -  ! Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(230, 255, 230)) ! светло-зеленый
.head 5 -  Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_LightGray) ! бледно-серый
.head 3 +  On UM_Populate
.head 4 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 4 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 4 -  Call SalTblSetContext(hWndForm, 0)
.head 4 -  Call SalTblSetFocusRow(hWndForm, 0)
.head 4 -  Call SalTblSetRowFlags(hWndForm, 0, ROW_Selected,TRUE)
.head 3 +  On WM_NCMouseMove
.head 4 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalSendMsg(pbDetails, SAM_Click, 0, 0)
.head 3 +  On SAM_ReportStart
.head 4 -  Return TRUE
.head 3 +  On SAM_ReportFetchInit
.head 4 -  Return TRUE
.head 3 +  On SAM_ReportFetchNext
.head 4 +  If bU
.head 5 -  Return FALSE
.head 4 +  If AKB2.colTIPKB = 3
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT c.nmk,c.adr,o.ruk,o.buh,c.okpo,z.fio,z.tel
   INTO :NMK,:ADRES,:RUK,:BUH,:OKPO,:FIO,:TEL
   FROM customer c, corps o, cust_zay z
   WHERE c.sab=:AKB2.colSAB and c.custtype in (2,3) and (c.stmt=5 or c.stmt=6) and c.rnk=o.rnk(+) and c.rnk=z.rnk(+)') and
   SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Set NMK = ''
.head 6 -  Set ADRES = ''
.head 6 -  Set RUK = ''
.head 6 -  Set BUH = ''
.head 5 -  Set NLS = AKB2.colNLS
.head 5 -  Set MFO = GetBankMfo()
.head 5 -  Set NB = GetBankName()
.head 5 -  Set KVA = GetLcv(AKB2.colKV)
.head 5 -  Set SUMV = AKB2.colS*100
.head 5 -  Set KURS = AKB2.colKURSKONV
.head 5 -  Set KVB = GetLcv(AKB2.colKVKOMISS)
.head 5 -  ! Set DATZ = '"' || SalFmtFormatDateTime(AKB2.colDKREDDOG, 'd') || '" ' ||
    GetMonthUkr(AKB2.colDKREDDOG, 'r') ||  ' ' ||
    SalFmtFormatDateTime(AKB2.colDKREDDOG, 'yyyy') || ' р.'
.head 5 +  If AKB2.colDKREDDOG = DATETIME_Null
.head 6 -  Set DATZ = ''
.head 5 +  Else
.head 6 -  Set DATZ = '"' || SalFmtFormatDateTime(AKB2.colDKREDDOG, 'd') || '" ' ||
    GetMonthUkr(AKB2.colDKREDDOG, 'r') ||  ' ' ||
    SalFmtFormatDateTime(AKB2.colDKREDDOG, 'yyyy') || ' р.'
.head 5 -  Set DATD = '"' || SalFmtFormatDateTime(AKB2.colDATD, 'd') || '" ' ||
    GetMonthUkr(AKB2.colDATD, 'r') ||  ' ' ||
    SalFmtFormatDateTime(AKB2.colDATD, 'yyyy') || ' р.'
.head 5 -  Set REF = AKB2.colND
.head 4 +  Else If AKB2.colTIPKB = 6
.head 5 +  If SqlPrepareAndExecute(hSql(), '
   SELECT c.nmkv,c.nmk,c.adr,o.ruk,o.buh,c.okpo
   INTO :NK_A,:NMK,:ADRES,:RUK,:BUH,:OKPO
   FROM customer c, corps o
   WHERE c.sab=:AKB2.colSAB and c.custtype in (2,3) and (c.stmt=5 or c.stmt=6) and c.rnk=o.rnk(+)') and
   SqlFetchNext(hSql(), nFetchRes)
.head 6 -  ! Set ADRES = SalStrTrimX(ADRES) || ', код ' || SalStrTrimX(KODOKPO)
.head 6 -  ! Call Debug(OKPO)
.head 5 +  Else
.head 6 -  Set NK_A = ''
.head 6 -  Set NMK = ''
.head 6 -  Set ADRES = ''
.head 6 -  Set RUK = ''
.head 6 -  Set BUH = ''
.head 6 -  Set OKPO = ''
.head 5 -  Set REF = AKB2.colND
.head 5 -  Set DATZ = '"' || SalFmtFormatDateTime(AKB2.colDATD, 'd') || '" ' ||
    GetMonthUkr(AKB2.colDATD, 'r') ||  ' ' ||
    SalFmtFormatDateTime(AKB2.colDATD, 'yyyy') || ' р.'
.head 5 -  Set NB_A = GetGlobalOption('KLV_BANK')
  ! 'Akcionernij bank "AZHIO"'
  ! GetBankName()
.head 5 -  Set CB_A = GetGlobalOption('KLV_CITY')
  ! 'm. Kiyiv'
  ! '.Київ, Україна'
.head 5 -  Set CK_A = 'Ukraine, Kiev'
.head 5 -  Set NLS_A = AKB2.colNLS || ' ' || GetLcv(AKB2.colKV)
.head 5 -  Set SUM = AKB2.colS*100
.head 5 -  Set KV = GetLcv(AKB2.colKV)
.head 5 -  Set nInd = SalStrTokenize(AKB2.colTAG59, '', Chr(13) || Chr(10), smTemp)
.head 5 -  Set NO1 = ''
.head 5 -  Set NO2 = ''
.head 5 -  Set NO3 = ''
.head 5 -  Set NO4 = ''
.head 5 -  Set NO5 = ''
.head 5 -  Set nI = 0
.head 5 +  While nI < nInd
.head 6 +  If nI = 0
.head 7 -  Set NO1 = smTemp[0]
.head 6 +  If nI = 1
.head 7 -  Set NO2 = smTemp[1]
.head 6 +  If nI = 2
.head 7 -  Set NO3 = smTemp[2]
.head 6 +  If nI = 3
.head 7 -  Set NO4 = smTemp[3]
.head 6 +  If nI = 4
.head 7 -  Set NO5 = smTemp[4]
.head 6 -  Set nI = nI + 1
.head 5 -  Set nInd = SalStrTokenize(AKB2.colTAG57A, '', Chr(13) || Chr(10), smTemp)
.head 5 -  Set BO1 = ''
.head 5 -  Set BO2 = ''
.head 5 -  Set BO3 = ''
.head 5 -  Set BO4 = ''
.head 5 -  Set nI = 0
.head 5 +  While nI < nInd
.head 6 +  If nI = 0
.head 7 -  Set BO1 = smTemp[0]
.head 6 +  If nI = 1
.head 7 -  Set BO2 = smTemp[1]
.head 6 +  If nI = 2
.head 7 -  Set BO3 = smTemp[2]
.head 6 +  If nI = 3
.head 7 -  Set BO4 = smTemp[3]
.head 6 -  Set nI = nI + 1
.head 5 -  Set nInd = SalStrTokenize(AKB2.colTAG56, '', Chr(13) || Chr(10), smTemp)
.head 5 -  Set BP1 = ''
.head 5 -  Set BP2 = ''
.head 5 -  Set BP3 = ''
.head 5 -  Set BP4 = ''
.head 5 -  Set nI = 0
.head 5 +  While nI < nInd
.head 6 +  If nI = 0
.head 7 -  Set BP1 = smTemp[0]
.head 6 +  If nI = 1
.head 7 -  Set BP2 = smTemp[1]
.head 6 +  If nI = 2
.head 7 -  Set BP3 = smTemp[2]
.head 6 +  If nI = 3
.head 7 -  Set BP4 = smTemp[3]
.head 6 -  Set nI = nI + 1
.head 5 -  Set nInd = SalStrTokenize(AKB2.colTAG70, '', Chr(13) || Chr(10), smTemp)
.head 5 -  Set NP1 = ''
.head 5 -  Set NP2 = ''
.head 5 -  Set NP3 = ''
.head 5 -  Set NP4 = ''
.head 5 -  Set nI = 0
.head 5 +  While nI < nInd
.head 6 +  If nI = 0
.head 7 -  Set NP1 = smTemp[0]
.head 6 +  If nI = 1
.head 7 -  Set NP2 = smTemp[1]
.head 6 +  If nI = 2
.head 7 -  Set NP3 = smTemp[2]
.head 6 +  If nI = 3
.head 7 -  Set NP4 = smTemp[3]
.head 6 -  Set nI = nI + 1
.head 5 -  Set ID_OPER = Str(AKB2.colKODOP)
.head 5 -  Set COUNTRY_B = Str(AKB2.colCOUNTRY)
.head 5 -  Set COST = AKB2.colOURBENSHA
.head 5 -  Set EXPRESS = AKB2.colTAG72N
.head 5 -  ! ! Call Debug(KV)
.head 5 -  If SqlPrepareAndExecute(hSql(), "
   SELECT SUBSTR(f_sumpr(:SUM,to_char(kv),NVL(gender,'M')),1,200)
   INTO :SUMPR
   FROM tabval
   WHERE lcv=:KV") and
   SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  ! Set SUMPR = SumPr(SUM, 'M', KV, '')
.head 6 -  Set SUMPR = ''
.head 5 -  Set KV_COST = GetLcv(AKB2.colKVKOMISS)
.head 5 -  ! ! Call Debug(KV_COST)
.head 5 -  ! !
.head 5 -  Set NK_B = ''
.head 5 -  Set AK_B = ''
.head 5 -  Set CK_B = ''
.head 5 -  Set ADD_B = ''
.head 5 -  Set NB_B = ''
.head 5 -  Set CB_B = ''
.head 5 -  Set SW_B = ''
.head 5 -  Set NB_C = ''
.head 5 -  Set CB_C = ''
.head 5 -  Set SW_C = ''
.head 5 -  Set ITEM = ''
.head 4 +  Else If AKB2.colTIPKB = 7
.head 5 -  If SqlPrepareAndExecute(hSql(), '
   SELECT c.okpo,c.nmk,c.adr,o.ruk,o.buh
   INTO :OKPO,:NMK,:ADRES,:RUK,:BUH
   FROM customer c, corps o
   WHERE c.sab=:AKB2.colSAB and c.custtype in (2,3) and (c.stmt=5 or c.stmt=6) and c.rnk=o.rnk(+)') and
   SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Set OKPO = ''
.head 6 -  Set NMK = ''
.head 6 -  Set ADRES = ''
.head 6 -  Set RUK = ''
.head 6 -  Set BUH = ''
.head 5 -  Set REF = AKB2.colND
.head 5 -  Set DATZ = '"' || SalFmtFormatDateTime(AKB2.colDATD, 'd') || '" ' ||
    GetMonthUkr(AKB2.colDATD, 'r') ||  ' ' || SalFmtFormatDateTime(AKB2.colDATD, 'yyyy')
    || ' р.'
.head 5 -  Set NLS_V = AKB2.colNLS
.head 5 -  Set NLS_CR = AKB2.colNLSPOG
.head 5 -  Set SUM = AKB2.colS*100
.head 5 -  Set KV = GetLcv(AKB2.colKV)
.head 5 -  Set NAZN = AKB2.colTAG70
.head 5 -  Set N_CR = AKB2.colNKREDDOG
.head 5 -  Set DAT_CR = AKB2.colDKREDDOG
.head 5 -  If SqlPrepareAndExecute(hSql(), "
   SELECT SUBSTR(f_sumpr(:SUM,to_char(kv),NVL(gender,'M')),1,200)
   INTO :SUMPR
   FROM tabval
   WHERE lcv=:KV") and
   SqlFetchNext(hSql(), nFetchRes)
.head 5 +  Else
.head 6 -  Set SUMPR = ''
.head 5 -  Set KV_COST = GetLcv(AKB2.colKVKOMISS)
.head 4 -  Set bU = TRUE
.head 4 -  Return TRUE
.head 3 +  On SAM_ReportNotify
.head 4 -  Return TRUE
.head 3 +  On SAM_ReportFinish
.head 4 -  Return TRUE
.head 1 +  Table Window: KLP
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Необработанные документы в нац.валюте от КБ
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.113"
.head 4 -  Top:    0.563"
.head 4 -  Width:  14.35"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.619"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 2048
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.452"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 62323
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \Bars98\RESOURCE\BMP\Open.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows(KLP, ROW_Selected, 0)
.head 8 +  If KLP.colVOB = 1 or KLP.colVOB = 0
.head 9 -  Set df_titles = 'Платіжне доручення'
.head 9 -  Set sKODO = '0410001'
.head 8 +  If KLP.colVOB = 2
.head 9 -  Set df_titles = 'Платіжна вимога-доручення'
.head 9 -  Set sKODO = '0410002'
.head 8 +  If KLP.colVOB = 3
.head 9 -  Set df_titles = 'Платіжна вимога'
.head 9 -  Set sKODO = '0410007'
.head 8 +  If KLP.colVOB = 7
.head 9 -  Set sKODO='0401007'
.head 9 -  Set df_titles = 'Реєстр чеків'
.head 8 -  Set d_MFOAs = AMFO
.head 8 -  Set nckv = 980
.head 8 -  Call SqlPrepareAndExecute(hSql(), T('
     SELECT nmk
     INTO :d_NAMAs
     FROM customer c, cust_acc u, accounts a
     WHERE a.nls=:KLP.colNLS and a.kv=980 and c.rnk=u.rnk and a.acc=u.acc'))
.head 8 -  ! If nFetchRes != 0
.head 8 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set d_NAMAs = 'Плательщик не идентифицирован'
.head 8 -  Set d_BNK_As = GetBankName()
.head 8 -  Call SqlPrepareAndExecute(hSql(), T('
     SELECT nb
     INTO :d_BNK_Bs
     FROM banks
     WHERE mfo=:KLP.colMFO'))
.head 8 -  ! If nFetchRes != 0
.head 8 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set d_BNK_Bs = 'Банк с МФО ' || KLP.colMFO
.head 8 -  Set dfCodeCurrencys = 'UAH'
.head 8 -  Set d_Ss = KLP.colS*100
.head 8 -  Set ml_SumPrs = SumPr(d_Ss, 'F', 'грн', 'коп.')
.head 8 -  Call SalModalDialog(document, hWndForm, df_titles, KLP.colND, KLP.colDATD, d_NAMAs, d_BNK_As, d_MFOAs,
     KLP.colNAIMP, d_BNK_Bs, KLP.colMFO, SalNumberToStrX(KLP.colS, 2), dfCodeCurrencys, KLP.colNLS, KLP.colNLSP,
     ml_SumPrs, KLP.colTEXT1, KLP.colKOKA, KLP.colKOKB, sKODO, KLP.colDAVAL)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call SalDisableWindow(hWndItem)
.head 6 +  ! On SAM_Click
.head 7 +  If AKB2.colTIPKB = 3
.head 8 -  Set sDir = GetTemplateDir() || "\\ZAY_KMS.QRP"
.head 8 -  Set sFileName = GetPrnDir() || '\\D' || Str(AKB2.colREF) || '.za3'
.head 8 -  ! Set sRab = 'NMK,ADRES,RUK,BUH,NLS,MFO,NB,KVA,SUMV,KURS,KVB,DATZ,REF,DATD'
.head 8 -  Set sRab = 'NMK,ADRES,OKPO,RUK,BUH,NLS,MFO,NB,KVA,SUMV,KURS,KVB,DATZ,REF,DATD,FIO,TEL'
.head 7 +  Else If AKB2.colTIPKB = 6
.head 8 -  Set sDir = GetTemplateDir() || "\\ZAY_ORD.QRP"
.head 8 -  Set sFileName = GetPrnDir() || '\\D' || Str(AKB2.colREF) || '.za6'
.head 8 -  Set sRab = 'REF,DATZ,RUK,BUH,NB_A,CB_A,NK_A,CK_A,NLS_A,SUM,KV,SUMPR,NO1,NO2,NO3,NO4,NO5,BO1,BO2,BO3,BO4,BP1,BP2,'
    || 'BP3,BP4,NP1,NP2,NP3,NP4,ID_OPER,COUNTRY_B,COST,KV_COST,EXPRESS,ADRES,OKPO'
.head 7 +  Else If AKB2.colTIPKB = 7
.head 8 -  Set sDir = GetTemplateDir() || "\\ZAY_ORDK.QRP"
.head 8 -  Set sFileName = GetPrnDir() || '\\D' || Str(AKB2.colREF) || '.za7'
.head 8 -  Set sRab = 'REF,DATZ,RUK,BUH,NMK,OKPO,ADRES,NLS_V,SUM,SUMPR,KV,NLS_CR,NAZN,N_CR,DAT_CR,KV_COST'
.head 7 -  Set bU = FALSE
.head 7 -  Call SalReportPrintToFile(hWndForm, sDir, sFileName, sRab, sRab, 1, RPT_PrintAll, 1, 1, FALSE, nInd)
.head 7 -  Call DosDirectPrint(sFileName)
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, IifS(GetLang()='RUS', 'Печать', IifS(GetLang()='UKR', 'Друк', 'Print')))
.head 4 -  Line
.head 5 -  Resource Id: 62324
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.0"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 62325
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbBack
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.367"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \Bars98\RESOURCE\BMP\Doc_out.bmp
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set bFUN = TRUE
.head 7 +  ! If not FunNSIGet('BP_REASON', '', sStornoReasonId, sStornoReason)
.head 8 -  Return TRUE
.head 7 +  ! If not sStornoReasonId
.head 8 -  Return TRUE
.head 7 -  ! Call Debug(sStornoReason)
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(KLP, nRow, ROW_Selected, 0)
.head 8 -  Call SalTblSetContext(KLP, nRow)
.head 8 -  Set sPRWO = ''
.head 8 -  ! If colNOAUTO = STRING_Null
.head 8 +  If colPRWO = STRING_Null
.head 9 +  If bFUN
.head 10 +  If FunNSIGet('BP_REASON', '', sStornoReasonId, sStornoReason)
.head 11 +  If sStornoReasonId
.head 12 -  Set bFUN = FALSE
.head 10 +  If not bFUN
.head 11 -  Set sPRWO = sStornoReason
.head 9 +  Else
.head 10 -  Set sPRWO = sStornoReason
.head 8 +  Else
.head 9 -  Set sPRWO = colPRWO
.head 8 +  If Len(sPRWO) > 0
.head 9 -  Set sOper = Right(Str(10000+colNEOM), 4)
.head 9 -  Set nS = colS*100
.head 9 +  If SqlPrepareAndExecute(hSql(), "
   INSERT
   INTO klpoow (sab,oper,mfoa,nlsa,mfob,nlsb,namb,s,nd,nazn,pond,prwo,nfia,tip)
   VALUES (:colSAB,:sOper,:AMFO,:colNLS,:colMFO,:colNLSP,:colNAIMP,:nS,:colND,:colTEXT1,:colPOND,:sPRWO,
           :colFNAMEKB,'W')")
.head 10 -  ! Call Debug('3')
.head 10 +  If SqlPrepareAndExecute(hSql(), "
   UPDATE klp
   SET fl=9
   WHERE ref=:colREF")
.head 11 -  Call SqlCommit(hSql())
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Call MessageNoWait('Клиент ' || colSAB || ', пакет ' || colFNAMEKB || '(' || colPOND || '):
номер = ' || colND || '
МФОА  = ' || AMFO || '
СчётА = ' || colNLS || '
МФОБ  = ' || colMFO || '
СчётБ = ' || colNLSP || '
сумма = ' || SalNumberToStrX(nS/100, 2) || '
причина возврата - ' || sPRWO, 'ИНФОРМАЦИЯ: возвращён документ', 3, 0)
.head 11 -  Call SalWaitCursor(TRUE)
.head 10 +  Else
.head 11 -  Call SqlRollback(hSql())
.head 7 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 7 -  Call SalWaitCursor(FALSE)
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, IifS(GetLang()='RUS', 'Возврат док.',
       IifS(GetLang()='UKR', 'Повернути док.', 'BackDok')))
.head 4 -  ! Background Text: back
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.75"
.head 6 -  Top:    0.071"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.345"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 4 +  ! Pushbutton: pbTest
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: TECT
.head 5 -  Window Location and Size
.head 6 -  Left:   4.7"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set h1 = SalGetFirstChild(hWndForm, TYPE_FormToolBar)
.head 7 +  If h1 = hWndNULL
.head 8 -  Call Debug('No FormToolBar')
.head 7 -  Set h2 = SalGetFirstChild(h1, TYPE_BkgdText)
.head 7 +  If h2 = hWndNULL
.head 8 -  Call Debug('No First BkgdText')
.head 7 -  Call SalSetWindowText(h2, 'strTitle')
.head 7 -  Call SalFontSet(h2, dfF, 15, FONT_EnhBold | FONT_EnhItalic)
.head 7 -  ! Set h3 = SalGetNextChild(h2, TYPE_BkgdText)
.head 7 +  ! If h3 = hWndNULL
.head 8 -  Call Debug('No Next BkgdText')
.head 7 -  ! Call SalSetWindowText(h3, 'strTitle')
.head 4 +  ! Data Field: dfF
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   11.45"
.head 7 -  Top:    0.083"
.head 7 -  Width:  1.65"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.end
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: colSAB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.45"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
док.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNEOM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Опер.
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDATD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
док.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colMFO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
корресп.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.867"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNLSP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
корресп.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.833"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNAIMP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
корреспондента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.45"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
док.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.683"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDATEDOKKB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
поступления
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.167"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFNAMEKB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Имя
файла
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.733"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPOND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Порядковый
номер док.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.183"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTEXT1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назначение
платежа
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 160
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.117"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKOKA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код ОКПО
клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKOKB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код ОКПО
корреспондента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPRWO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Причина
ошибки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 40
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.867"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colREF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Референс
док.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.967"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNOAUTO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Признак
авто-обработки
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.917"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDAVAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
валютирования
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colVOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вид
док.
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.917"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 2 +  Window Variables
.head 3 -  String: sStornoReasonId
.head 3 -  String: sStornoReason
.head 3 -  String: AMFO
.head 3 -  String: sOper
.head 3 -  Number: nS
.head 3 -  Number: nRow
.head 3 -  String: sKODO
.head 3 -  String: df_titles
.head 3 -  String: d_MFOAs
.head 3 -  String: d_NAMAs
.head 3 -  String: d_BNK_As
.head 3 -  String: d_BNK_Bs
.head 3 -  String: dfCodeCurrencys
.head 3 -  Number: d_Ss
.head 3 -  String: ml_SumPrs
.head 3 -  Number: nckv
.head 3 -  String: sPRWO
.head 3 -  Boolean: bFUN
.head 3 -  Number: nContext
.head 3 -  Window Handle: hWndCol
.head 3 -  Number: nFlags
.head 3 -  !
.head 3 -  ! Window Handle: h1
.head 3 -  ! Window Handle: h2
.head 3 -  ! Window Handle: h3
.head 3 -  !
.head 3 -  Number: nBaseVal
.head 3 -  String: sTOBO
.head 3 -  String: sText
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set AMFO = GetBankMfo()
.head 4 +  If nPar = 1
.head 5 -  Set nBaseVal = GetBaseVal()
.head 5 -  Set sTOBO = GetValueStr("
    SELECT substr(pul.Get_Mas_Ini_Val('KOD_TOBO'),1,20)
    FROM dual")
.head 5 -  Call SalGetWindowText(hWndForm, sText, 254)
.head 5 -  Call SalSetWindowText(hWndForm, sText || ' (отделения)')
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalTimerSet(hWndForm, 1, 60000)
.head 4 -  ! Call Debug('1')
.head 4 -  ! Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
.head 4 -  Set KLP.strFilterTblName = 'KLP'
.head 4 -  ! Set KLP.fFilterAtStart = TRUE
.head 4 -  Set nFlags = GT_NoIns | GT_NoUpd | GT_NoDel
.head 4 -  ! Call Debug('1')
.head 4 -  ! Set KLP.strSqlPopulate = "
    SELECT k.REF,k.ND,k.DATAD,k.NLS,k.MFO,k.NAIMP,k.NLSP,k.S/100,k.TEXT1,k.KOKA,k.KOKB,
           k.DATEDOKKB,k.NAEX,k.POND,c.SAB,c.NMK,k.NOAUTO
    INTO :KLP.colREF,:KLP.colND,:KLP.colDATAD,:KLP.colNLS,:KLP.colMFO,:KLP.colNAIMP,
         :KLP.colNLSP,:KLP.colS,:KLP.colTEXT1,:KLP.colKOKA,:KLP.colKOKB,:KLP.colDATEDOKKB,
         :KLP.colFNAMEKB,:KLP.colPOND,:KLP.colSAB,:KLP.colNMK,:KLP.colNOAUTO
    FROM klp k, customer c
    WHERE k.fl=0 and c.sab=substr(k.naex,3,4) and c.stmt=5
    ORDER BY 1"
.head 4 -  Set KLP.strSqlPopulate = "
    SELECT k.REF,k.ND,k.EOM,k.DATAD,k.NLS,k.MFO,k.NAIMP,k.NLSP,k.S/100,k.TEXT1,k.KOKA,k.KOKB,k.DATEDOKKB,k.NAEX,k.POND,
           c.SAB,c.NMK,k.NOAUTO,k.VOB,k.DAVAL,k.PRWO
    INTO :KLP.colREF,:KLP.colND,:KLP.colNEOM,:KLP.colDATD,:KLP.colNLS,:KLP.colMFO,:KLP.colNAIMP,:KLP.colNLSP,:KLP.colS,
         :KLP.colTEXT1,:KLP.colKOKA,:KLP.colKOKB,:KLP.colDATEDOKKB,:KLP.colFNAMEKB,:KLP.colPOND,:KLP.colSAB,:KLP.colNMK,
         :KLP.colNOAUTO,:KLP.colVOB,:KLP.colDAVAL,:KLP.colPRWO
    FROM klp k, customer c" || IifS(nPar=1, ', accounts a', '') || "
    WHERE k.fl<3 and c.sab=substr(k.naex,3,4) and (c.stmt=5 or c.stmt=6)" || IifS(nPar=1, ' and a.nls=k.nls and
          a.kv=:nBaseVal and a.tobo=:sTOBO', '') || "
    ORDER BY 1"
.head 4 -  ! Call Debug('2')
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  ! Call Debug('3')
.head 3 +  On SAM_FetchRowDone
.head 4 +  ! If KLP.colNOAUTO = STRING_Null
.head 5 -  ! Call Debug('1')
.head 5 -  Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_White)  ! белый
.head 4 +  ! Else
.head 5 -  ! Call Debug('2')
.head 5 -  Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_Orchid) ! розовый
.head 4 -  Call XSalTblSetRowBackColor(hWndForm, lParam, IifN(KLP.colNOAUTO=STRING_Null, COLOR_White, COLOR_Orchid))
.head 3 +  On UM_Populate
.head 4 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 4 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 4 -  Call SalTblSetContext(hWndForm, 0)
.head 4 -  Call SalTblSetFocusRow(hWndForm, 0)
.head 4 -  Call SalTblSetRowFlags(hWndForm, 0, ROW_Selected, TRUE)
.head 3 +  On WM_NCMouseMove
.head 4 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalSendMsg(pbDetails, SAM_Click, 0, 0)
.head 3 +  On SAM_RowHeaderClick
.head 4 -  Call XSalTooltipShow(hWndForm, IifS(KLP.colNOAUTO=STRING_Null, 'Ручн.', 'Авто') || 'обработка')
.head 3 +  On SAM_Timer
.head 4 -  ! Call Debug('2')
.head 4 -  ! получить номер текущей строки + фокус
.head 4 -  Set nContext = SalTblQueryContext(hWndForm)
.head 4 -  Call SalTblQueryFocus(hWndForm, nRow, hWndCol)
.head 4 -  Call SalTblQueryRowFlags(hWndForm, nRow, nFlags)
.head 4 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 4 -  ! встать на текущую строку + фокус
.head 4 -  Call SalTblSetRowFlags(hWndForm, nRow, nFlags, TRUE)
.head 4 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_HideMarks, TRUE)
.head 4 -  Call SalTblSetFocusRow(hWndForm, nRow)
.head 4 -  Call SalTblSetContext(hWndForm, nContext)
.head 3 +  On SAM_Destroy
.head 4 -  Call SalTimerKill(hWndForm, 1)
.head 4 -  Call SalSendClassMessage(SAM_Destroy, 0, 0)
.head 1 +  Table Window: KLPnotSBB
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Необработанные документы от КБ
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.113"
.head 4 -  Top:    0.563"
.head 4 -  Width:  14.35"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.619"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 2048
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.452"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 24995
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \Bars98\RESOURCE\BMP\Open.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows(KLPnotSBB, ROW_Selected, 0)
.head 8 +  If KLPnotSBB.colVOB = 1 or KLPnotSBB.colVOB = 0
.head 9 -  Set df_titles = 'Платіжне доручення'
.head 9 -  Set sKODO = '0410001'
.head 8 +  If KLPnotSBB.colVOB = 2
.head 9 -  Set df_titles = 'Платіжна вимога-доручення'
.head 9 -  Set sKODO = '0410002'
.head 8 +  If KLPnotSBB.colVOB = 3
.head 9 -  Set df_titles = 'Платіжна вимога'
.head 9 -  Set sKODO = '0410007'
.head 8 +  If KLPnotSBB.colVOB = 7
.head 9 -  Set sKODO='0401007'
.head 9 -  Set df_titles = 'Реєстр чеків'
.head 8 -  Set d_MFOAs = AMFO
.head 8 -  Set nckv = 980
.head 8 -  Call SqlPrepareAndExecute(hSql(), T('
     SELECT nmk
     INTO   :d_NAMAs
     FROM   customer c, cust_acc u, accounts a
     WHERE  a.nls=:KLPnotSBB.colNLS and a.kv=980 and c.rnk=u.rnk and a.acc=u.acc'))
.head 8 -  ! If nFetchRes != 0
.head 8 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set d_NAMAs = 'Плательщик не идентифицирован'
.head 8 -  Set d_BNK_As = GetBankName()
.head 8 -  Call SqlPrepareAndExecute(hSql(), T('
     SELECT nb
     INTO   :d_BNK_Bs
     FROM   banks
     WHERE  mfo=:KLPnotSBB.colMFO'))
.head 8 -  ! If nFetchRes != 0
.head 8 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Set d_BNK_Bs = 'Банк с МФО ' || KLPnotSBB.colMFO
.head 8 -  Set dfCodeCurrencys = 'UAH'
.head 8 -  Set d_Ss = KLPnotSBB.colS*100
.head 8 -  Set ml_SumPrs = SumPr(d_Ss, 'F', 'грн', 'коп.')
.head 8 -  Call SalModalDialog(document, hWndForm, df_titles, KLPnotSBB.colND, KLPnotSBB.colDATD, d_NAMAs, d_BNK_As, d_MFOAs,
     KLPnotSBB.colNAIMP, d_BNK_Bs, KLPnotSBB.colMFO, SalNumberToStrX(KLPnotSBB.colS, 2), dfCodeCurrencys,
     KLPnotSBB.colNLS, KLPnotSBB.colNLSP, ml_SumPrs, KLPnotSBB.colTEXT1, KLPnotSBB.colKOKA, KLPnotSBB.colKOKB,
     sKODO, KLPnotSBB.colDAVAL)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call SalDisableWindow(hWndItem)
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, IifS(GetLang()='RUS', 'Печать', IifS(GetLang()='UKR', 'Друк', 'Print')))
.head 4 -  Line
.head 5 -  Resource Id: 24996
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.0"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 24997
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbBack
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.367"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \Bars98\RESOURCE\BMP\Doc_out.bmp
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set bFUN = TRUE
.head 7 -  ! Call Debug(sStornoReason)
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(KLPnotSBB, nRow, ROW_Selected, 0)
.head 8 -  Call SalTblSetContext(KLPnotSBB, nRow)
.head 8 -  Set sPRWO = ''
.head 8 +  If colPRWO = STRING_Null
.head 9 +  If bFUN
.head 10 +  If FunNSIGet('BP_REASON', '', sStornoReasonId, sStornoReason)
.head 11 +  If sStornoReasonId
.head 12 -  Set bFUN = FALSE
.head 10 +  If not bFUN
.head 11 -  Set sPRWO = sStornoReason
.head 9 +  Else
.head 10 -  Set sPRWO = sStornoReason
.head 8 +  Else
.head 9 -  Set sPRWO = colPRWO
.head 8 +  If Len(sPRWO) > 0
.head 9 -  Set sOper = Right(Str(10000+colNEOM), 4)
.head 9 -  Set nS = colS*100
.head 9 +  If SqlPrepareAndExecute(hSql(), "
   INSERT
   INTO   klpoow (sab,oper,mfoa,nlsa,mfob,nlsb,namb,s,nd,nazn,pond,prwo,nfia,tip)
   VALUES (:colSAB,:sOper,:AMFO,:colNLS,:colMFO,:colNLSP,:colNAIMP,:nS,:colND,:colTEXT1,:colPOND,:sPRWO,
           :colFNAMEKB,'W')")
.head 10 -  ! Call Debug('3')
.head 10 +  If SqlPrepareAndExecute(hSql(), "
   UPDATE klp
   SET    fl=9,prwo=:sPRWO
   WHERE  id=:colID")
.head 11 -  Call SqlCommit(hSql())
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Call MessageNoWait('Клиент ' || colSAB || ', пакет ' || colFNAMEKB || '(' || colPOND || '):
номер = ' || colND || '
МФОА  = ' || AMFO || '
СчётА = ' || colNLS || '
МФОБ  = ' || colMFO || '
СчётБ = ' || colNLSP || '
сумма = ' || SalNumberToStrX(nS/100, 2) || '
причина возврата - ' || sPRWO, 'ИНФОРМАЦИЯ: возвращён документ', 3, 0)
.head 11 -  Call SalWaitCursor(TRUE)
.head 10 +  Else
.head 11 -  Call SqlRollback(hSql())
.head 7 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 7 -  Call SalWaitCursor(FALSE)
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, IifS(GetLang()='RUS', 'Возврат док.', IifS(GetLang()='UKR', 'Повернути док.',
       'BackDok')))
.head 2 +  Contents
.head 3 +  Column: colSAB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNEOM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
испол.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.45"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
док.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDATD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
док.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colMFO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
корресп.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.867"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNLSP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
корресп.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.833"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNAIMP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
корреспондента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.45"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
док.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.683"
.head 4 -  Width Editable? Yes
.head 4 -  Format: ###000
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDATEDOKKB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
поступления
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.167"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFNAMEKB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Имя
файла
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.733"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPOND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Порядковый
номер док.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.183"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTEXT1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назначение
платежа
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 160
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.117"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKOKA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код ОКПО
клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKOKB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код ОКПО
корреспондента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.083"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPRWO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Причина
ошибки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 40
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.867"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colREF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Референс
док.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.967"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDAVAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
валютирования
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colVOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вид
док.
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.917"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вид
док.
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.917"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 2 +  Window Variables
.head 3 -  String: sStornoReasonId
.head 3 -  String: sStornoReason
.head 3 -  String: AMFO
.head 3 -  String: sOper
.head 3 -  Number: nS
.head 3 -  Number: nRow
.head 3 -  String: sKODO
.head 3 -  String: df_titles
.head 3 -  String: d_MFOAs
.head 3 -  String: d_NAMAs
.head 3 -  String: d_BNK_As
.head 3 -  String: d_BNK_Bs
.head 3 -  String: dfCodeCurrencys
.head 3 -  Number: d_Ss
.head 3 -  String: ml_SumPrs
.head 3 -  Number: nckv
.head 3 -  String: sPRWO
.head 3 -  Boolean: bFUN
.head 3 -  Number: nContext
.head 3 -  Window Handle: hWndCol
.head 3 -  Number: nFlag
.head 3 -  !
.head 3 -  ! Window Handle: h1
.head 3 -  ! Window Handle: h2
.head 3 -  ! Window Handle: h3
.head 3 -  !
.head 3 -  Number: nBaseVal
.head 3 -  String: sText
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set AMFO = GetBankMfo()
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalTimerSet(hWndForm, 1, 60000)
.head 4 -  ! Call Debug('1')
.head 4 -  ! Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
.head 4 -  Set KLPnotSBB.strFilterTblName = 'KLPnotSBB'
.head 4 -  ! Set KLPnotSBB.fFilterAtStart = TRUE
.head 4 -  Set KLPnotSBB.nFlags = GT_NoIns | GT_NoUpd | GT_NoDel
.head 4 -  ! Call Debug('1')
.head 4 -  ! Set KLPnotSBB.strSqlPopulate = "
    SELECT k.REF,k.ND,k.EOM,k.DATAD,k.NLS,k.MFO,k.NAIMP,k.NLSP,k.S/100,k.TEXT1,k.KOKA,k.KOKB,k.DATEDOKKB,k.NAEX,k.POND,
           c.SAB,c.NMK,k.VOB,k.DAVAL,k.PRWO
    INTO   :KLPnotSBB.colREF,:KLPnotSBB.colND,:KLPnotSBB.colNEOM,:KLPnotSBB.colDATD,:KLPnotSBB.colNLS,:KLPnotSBB.colMFO,
           :KLPnotSBB.colNAIMP,:KLPnotSBB.colNLSP,:KLPnotSBB.colS,:KLPnotSBB.colTEXT1,:KLPnotSBB.colKOKA,
           :KLPnotSBB.colKOKB,:KLPnotSBB.colDATEDOKKB,:KLPnotSBB.colFNAMEKB,:KLPnotSBB.colPOND,:KLPnotSBB.colSAB,
           :KLPnotSBB.colNMK,:KLPnotSBB.colVOB,:KLPnotSBB.colDAVAL,:KLPnotSBB.colPRWO
    FROM   klp k, customer c
    WHERE  k.fl<3 and c.sab=substr(k.naex,8,1)||substr(k.naex,-3) and (c.stmt=5 or c.stmt=6)
    ORDER BY 1"
.head 4 -  Set KLPnotSBB.strSqlPopulate = "
    SELECT k.REF,k.ND,k.EOM,k.DATAD,k.NLS,k.MFO,k.NAIMP,k.NLSP,k.S/100,k.TEXT1,k.KOKA,k.KOKB,k.DATEDOKKB,k.NAEX,k.POND,
           c.SAB,c.NMK,k.VOB,k.DAVAL,k.PRWO,k.id
    INTO   :KLPnotSBB.colREF,:KLPnotSBB.colND,:KLPnotSBB.colNEOM,:KLPnotSBB.colDATD,:KLPnotSBB.colNLS,:KLPnotSBB.colMFO,
           :KLPnotSBB.colNAIMP,:KLPnotSBB.colNLSP,:KLPnotSBB.colS,:KLPnotSBB.colTEXT1,:KLPnotSBB.colKOKA,
           :KLPnotSBB.colKOKB,:KLPnotSBB.colDATEDOKKB,:KLPnotSBB.colFNAMEKB,:KLPnotSBB.colPOND,:KLPnotSBB.colSAB,
           :KLPnotSBB.colNMK,:KLPnotSBB.colVOB,:KLPnotSBB.colDAVAL,:KLPnotSBB.colPRWO,:KLPnotSBB.colID
    FROM   klp k, customer c
    WHERE  k.fl<3 and c.sab=replace(substr(k.naex,8,5),'.','') and (c.stmt=5 or c.stmt=6)
    ORDER BY 1"
.head 4 -  ! Call Debug('2')
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  ! Call Debug('3')
.head 3 +  On SAM_FetchRowDone
.head 4 -  Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_White)
.head 3 +  On UM_Populate
.head 4 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 4 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 4 -  Call SalTblSetContext(hWndForm, 0)
.head 4 -  Call SalTblSetFocusRow(hWndForm, 0)
.head 4 -  Call SalTblSetRowFlags(hWndForm, 0, ROW_Selected, TRUE)
.head 3 +  On WM_NCMouseMove
.head 4 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalSendMsg(pbDetails, SAM_Click, 0, 0)
.head 3 +  ! On SAM_RowHeaderClick
.head 4 -  Call XSalTooltipShow(hWndForm, IifS(KLPnotSBB.colNOAUTO=STRING_Null, 'Ручн.', 'Авто') || 'обр.')
.head 3 +  On SAM_Timer
.head 4 -  ! Call Debug('2')
.head 4 -  ! получить номер текущей строки + фокус
.head 4 -  Set nContext = SalTblQueryContext(hWndForm)
.head 4 -  Call SalTblQueryFocus(hWndForm, nRow, hWndCol)
.head 4 -  Call SalTblQueryRowFlags(hWndForm, nRow, nFlag)
.head 4 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 4 -  ! встать на текущую строку + фокус
.head 4 -  Call SalTblSetRowFlags(hWndForm, nRow, nFlag, TRUE)
.head 4 -  Call SalTblSetRowFlags(hWndForm, nRow, ROW_HideMarks, TRUE)
.head 4 -  Call SalTblSetFocusRow(hWndForm, nRow)
.head 4 -  Call SalTblSetContext(hWndForm, nContext)
.head 3 +  On SAM_Destroy
.head 4 -  Call SalTimerKill(hWndForm, 1)
.head 4 -  Call SalSendClassMessage(SAM_Destroy, 0, 0)
.head 1 +  Table Window: frm_UpdRODO
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Изменения по вкладам РОДОВИД
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   3.388"
.head 4 -  Top:    1.021"
.head 4 -  Width:  14.35"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.619"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Courier New
.head 3 -  Font Size: 9
.head 3 -  Font Enhancement: Bold
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 400000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.452"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.617"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.15"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.683"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 -  On SAM_Click
.head 4 -  Line
.head 5 -  Resource Id: 9003
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  7.0"
.head 6 -  Begin Y:  0.06"
.head 6 -  End X:  7.0"
.head 6 -  End Y:  0.524"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.217"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.75"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.817"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \Bars98\RESOURCE\BMP\Open.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set smL[0]  = frm_UpdRODO.colStateCode
.head 7 -  Set smL[1]  = frm_UpdRODO.colClientName
.head 7 -  Set smL[2]  = frm_UpdRODO.colBirthday
.head 7 -  Set smL[3]  = frm_UpdRODO.colBirthPlace
.head 7 -  Set smL[4]  = frm_UpdRODO.colResident
.head 7 -  Set smL[5]  = frm_UpdRODO.colWorkPlace
.head 7 -  Set smL[6]  = frm_UpdRODO.colADDRESS_INDEX
.head 7 -  Set smL[7]  = frm_UpdRODO.colADDRESS_OBL
.head 7 -  Set smL[8]  = frm_UpdRODO.colADDRESS_REG
.head 7 -  Set smL[9]  = frm_UpdRODO.colADDRESS_CITY
.head 7 -  Set smL[10] = frm_UpdRODO.colADDRESS_STR
.head 7 -  Set smL[11] = frm_UpdRODO.colADDRESS_HS
.head 7 -  Set smL[12] = frm_UpdRODO.colADDRESS_APP
.head 7 -  Set smL[13] = frm_UpdRODO.colK040
.head 7 -  Set smL[14] = frm_UpdRODO.colPhoneContact
.head 7 -  Set smL[15] = frm_UpdRODO.colPhoneHome
.head 7 -  Set smL[16] = frm_UpdRODO.colMOBILE_PHONE
.head 7 -  Set smL[17] = frm_UpdRODO.colPassport_Type
.head 7 -  Set smL[18] = frm_UpdRODO.colPassport_S
.head 7 -  Set smL[19] = frm_UpdRODO.colPassport_Num
.head 7 -  Set smL[20] = frm_UpdRODO.colPassport_Place
.head 7 -  Set smL[21] = frm_UpdRODO.colPassport_Date
.head 7 -  Set smL[22] = frm_UpdRODO.colK013
.head 7 -  Set smL[23] = frm_UpdRODO.colK015
.head 7 -  Set smL[24] = frm_UpdRODO.colLast_Ident
.head 7 -  Set smL[25] = frm_UpdRODO.colEmail
.head 7 -  Set smL[26] = frm_UpdRODO.colK080
.head 7 -  Set smL[27] = frm_UpdRODO.colK050
.head 7 -  Set smL[28] = frm_UpdRODO.colK070
.head 7 -  Set smL[29] = frm_UpdRODO.colMarital_Status
.head 7 -  Set smL[30] = frm_UpdRODO.colBranchCode
.head 7 -  Set smL[31] = frm_UpdRODO.colBranchName
.head 7 -  Set smL[32] = frm_UpdRODO.colBranchAddress
.head 7 -  Set smL[33] = frm_UpdRODO.colCode
.head 7 -  Set smL[34] = frm_UpdRODO.colOrgDate
.head 7 -  Set smL[35] = frm_UpdRODO.colEndDate
.head 7 -  Set smL[36] = frm_UpdRODO.colPercentBreak
.head 7 -  Set smL[37] = frm_UpdRODO.colProductCode
.head 7 -  Set smL[38] = frm_UpdRODO.colProductName
.head 7 -  Set smL[39] = frm_UpdRODO.colCurrencyTag
.head 7 -  Set smL[40] = frm_UpdRODO.colMainAccCode
.head 7 -  Set smL[41] = frm_UpdRODO.colMainAccR013
.head 7 -  Set smL[42] = frm_UpdRODO.colMainAccR011
.head 7 -  Set smL[43] = frm_UpdRODO.colPercAccCode
.head 7 -  Set smL[44] = frm_UpdRODO.colPercAccR013
.head 7 -  Set smL[45] = frm_UpdRODO.colPercAccR011
.head 7 -  Set smL[46] = frm_UpdRODO.colCapAccCode
.head 7 -  Set smL[47] = frm_UpdRODO.colCalcDateInto
.head 7 -  Set smL[48] = frm_UpdRODO.colBRANCHKODOBL
.head 7 -  Set smL[49] = frm_UpdRODO.colTYPEDOCDKFM
.head 7 -  Set smL[50] = frm_UpdRODO.colNAMEDOCDKFM
.head 7 -  Set smL[51] = frm_UpdRODO.colCODEUPB
.head 7 -  Set smL[52] = frm_UpdRODO.colMAINACCCODEUPB
.head 7 -  Set nmL[0]  = frm_UpdRODO.colId
.head 7 -  Set nmL[1]  = frm_UpdRODO.colDataId
.head 7 -  Set nmL[2]  = frm_UpdRODO.colClientId
.head 7 -  Set nmL[3]  = frm_UpdRODO.colKodObl
.head 7 -  Set nmL[4]  = frm_UpdRODO.colChildrenCount
.head 7 -  Set nmL[5]  = frm_UpdRODO.colTreatyId
.head 7 -  Set nmL[6]  = frm_UpdRODO.colPercentCur
.head 7 -  Set nmL[7]  = frm_UpdRODO.colCrncyAmount
.head 7 -  Set nmL[8]  = frm_UpdRODO.colMainAccId
.head 7 -  Set nmL[9]  = frm_UpdRODO.colMainAccRest
.head 7 -  Set nmL[10] = frm_UpdRODO.colPercAccId
.head 7 -  Set nmL[11] = frm_UpdRODO.colPercAccRest
.head 7 -  Set nmL[12] = frm_UpdRODO.colPercentPay
.head 7 -  Set nmL[13] = frm_UpdRODO.colPercentCap
.head 7 -  Set smM[0]  = frm_UpdRODO.comStateCode
.head 7 -  Set smM[1]  = frm_UpdRODO.comClientName
.head 7 -  Set smM[2]  = frm_UpdRODO.comBirthday
.head 7 -  Set smM[3]  = frm_UpdRODO.comBirthPlace
.head 7 -  Set smM[4]  = frm_UpdRODO.comResident
.head 7 -  Set smM[5]  = frm_UpdRODO.comWorkPlace
.head 7 -  Set smM[6]  = frm_UpdRODO.comADDRESS_INDEX
.head 7 -  Set smM[7]  = frm_UpdRODO.comADDRESS_OBL
.head 7 -  Set smM[8]  = frm_UpdRODO.comADDRESS_REG
.head 7 -  Set smM[9]  = frm_UpdRODO.comADDRESS_CITY
.head 7 -  Set smM[10] = frm_UpdRODO.comADDRESS_STR
.head 7 -  Set smM[11] = frm_UpdRODO.comADDRESS_HS
.head 7 -  Set smM[12] = frm_UpdRODO.comADDRESS_APP
.head 7 -  Set smM[13] = frm_UpdRODO.comK040
.head 7 -  Set smM[14] = frm_UpdRODO.comPhoneContact
.head 7 -  Set smM[15] = frm_UpdRODO.comPhoneHome
.head 7 -  Set smM[16] = frm_UpdRODO.comMOBILE_PHONE
.head 7 -  Set smM[17] = frm_UpdRODO.comPassport_Type
.head 7 -  Set smM[18] = frm_UpdRODO.comPassport_S
.head 7 -  Set smM[19] = frm_UpdRODO.comPassport_Num
.head 7 -  Set smM[20] = frm_UpdRODO.comPassport_Place
.head 7 -  Set smM[21] = frm_UpdRODO.comPassport_Date
.head 7 -  Set smM[22] = frm_UpdRODO.comK013
.head 7 -  Set smM[23] = frm_UpdRODO.comK015
.head 7 -  Set smM[24] = frm_UpdRODO.comLast_Ident
.head 7 -  Set smM[25] = frm_UpdRODO.comEmail
.head 7 -  Set smM[26] = frm_UpdRODO.comK080
.head 7 -  Set smM[27] = frm_UpdRODO.comK050
.head 7 -  Set smM[28] = frm_UpdRODO.comK070
.head 7 -  Set smM[29] = frm_UpdRODO.comMarital_Status
.head 7 -  Set smM[30] = frm_UpdRODO.comBranchCode
.head 7 -  Set smM[31] = frm_UpdRODO.comBranchName
.head 7 -  Set smM[32] = frm_UpdRODO.comBranchAddress
.head 7 -  Set smM[33] = frm_UpdRODO.comCode
.head 7 -  Set smM[34] = frm_UpdRODO.comOrgDate
.head 7 -  Set smM[35] = frm_UpdRODO.comEndDate
.head 7 -  Set smM[36] = frm_UpdRODO.comPercentBreak
.head 7 -  Set smM[37] = frm_UpdRODO.comProductCode
.head 7 -  Set smM[38] = frm_UpdRODO.comProductName
.head 7 -  Set smM[39] = frm_UpdRODO.comCurrencyTag
.head 7 -  Set smM[40] = frm_UpdRODO.comMainAccCode
.head 7 -  Set smM[41] = frm_UpdRODO.comMainAccR013
.head 7 -  Set smM[42] = frm_UpdRODO.comMainAccR011
.head 7 -  Set smM[43] = frm_UpdRODO.comPercAccCode
.head 7 -  Set smM[44] = frm_UpdRODO.comPercAccR013
.head 7 -  Set smM[45] = frm_UpdRODO.comPercAccR011
.head 7 -  Set smM[46] = frm_UpdRODO.comCapAccCode
.head 7 -  Set smM[47] = frm_UpdRODO.comCalcDateInto
.head 7 -  Set smM[48] = frm_UpdRODO.comBRANCHKODOBL
.head 7 -  Set smM[49] = frm_UpdRODO.comTYPEDOCDKFM
.head 7 -  Set smM[50] = frm_UpdRODO.comNAMEDOCDKFM
.head 7 -  Set smM[51] = frm_UpdRODO.comCODEUPB
.head 7 -  Set smM[52] = frm_UpdRODO.comMAINACCCODEUPB
.head 7 -  Set nmM[0]  = frm_UpdRODO.comId
.head 7 -  Set nmM[1]  = frm_UpdRODO.comDataId
.head 7 -  Set nmM[2]  = frm_UpdRODO.comClientId
.head 7 -  Set nmM[3]  = frm_UpdRODO.comKodObl
.head 7 -  Set nmM[4]  = frm_UpdRODO.comChildrenCount
.head 7 -  Set nmM[5]  = frm_UpdRODO.comTreatyId
.head 7 -  Set nmM[6]  = frm_UpdRODO.comPercentCur
.head 7 -  Set nmM[7]  = frm_UpdRODO.comCrncyAmount
.head 7 -  Set nmM[8]  = frm_UpdRODO.comMainAccId
.head 7 -  Set nmM[9]  = frm_UpdRODO.comMainAccRest
.head 7 -  Set nmM[10] = frm_UpdRODO.comPercAccId
.head 7 -  Set nmM[11] = frm_UpdRODO.comPercAccRest
.head 7 -  Set nmM[12] = frm_UpdRODO.comPercentPay
.head 7 -  Set nmM[13] = frm_UpdRODO.comPercentCap
.head 7 -  Call SalModalDialog(dlgRODOon, hWndForm, smL, nmL, smM, nmM)
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, IifS(GetLang()='RUS', 'Детальная информация для строки таблицы',
       IifS(GetLang()='UKR', 'Детальна інформація для рядка таблиці',
      'Detailed information for the line of table')))
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.283"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call SalDisableWindow(hWndItem)
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, IifS(GetLang()='RUS', 'Печать', IifS(GetLang()='UKR', 'Друк', 'Print')))
.head 4 -  Line
.head 5 -  Resource Id: 9004
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  7.017"
.head 6 -  Begin Y:  -0.036"
.head 6 -  End X:  7.017"
.head 6 -  End Y:  0.429"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.483"
.head 6 -  Top:    0.083"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, IifS(GetLang()='RUS', 'Выход', IifS(GetLang()='UKR', 'Вихід', 'Exit')))
.head 4 -  Line
.head 5 -  Resource Id: 9005
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  6.817"
.head 6 -  Begin Y:  0.619"
.head 6 -  End X:  6.817"
.head 6 -  End Y:  0.94"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbRunLoader
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.35"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \Bars98\RESOURCE\BMP\FROMDISK.BMP
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SalDlgOpenFile(frm_UpdRODO, IifS(GetLang()='RUS', 'Выбрать файл', IifS(GetLang()='UKR', 'Вибрати файл',
   'Open File')), sFilters, nFilters, nIndex, sFileName, sFilePathName)
.head 8 -  ! Call Debug("sFileName=" || sFileName || ", sFilePathName=" || sFilePathName)
.head 8 -  Set nUgoFile = 0
.head 8 -  If SqlPrepareAndExecute(hSql(), "
   SELECT 1
   INTO   :nUgoFile
   FROM   s6_rodoprot
   WHERE  upper(namefile)=upper(:sFileName) and comments='Информация после изменений' and fl=1 and rownum<2") and
   SqlFetchNext(hSql(), nFetchRes)
.head 8 +  Else
.head 9 -  ! Set nUgoFile = 0
.head 9 -  Call SqlPrepareAndExecute(hSql(), '
     DELETE
     FROM   s6_rodoupd')
.head 9 -  ! Call SqlPrepareAndExecute(hSql(), 'grant insert on s6_rodoupd to ' || SqlUser)
.head 9 -  Call SqlCommit(hSql())
.head 8 -  !
.head 8 +  If nUgoFile = 0
.head 9 -  ! создать файл CTL-файл
.head 9 +  If SalFileOpen(hF, VisDosGetEnvString('TEMP') || '\\rodo.ctl', OF_Create | OF_ReadWrite)
.head 10 -  Set sBuffer = 'LOAD DATA' || PutCrLf() || 'INFILE "' || sFilePathName || '"' || PutCrLf() || 'APPEND' ||
    PutCrLf() || 'INTO TABLE s6_rodoupd' || PutCrLf() ||
    "WHEN CLIENTNAME != 'CLIENTNAME' and CLIENTNAME != " ||
    "'--------------------------------------------------------------------------------'" || PutCrLf() ||
    '(Id             POSITION(0001:0010)  decimal external,' || PutCrLf() ||
    ' DataId         POSITION(0012:0021)  decimal external,' || PutCrLf() ||
    ' ClientId       POSITION(0023:0032)  decimal external,' || PutCrLf() ||
    ' StateCode      POSITION(0034:0043)  char            ,' || PutCrLf() ||
    ' ClientName     POSITION(0045:0124)  char            ,' || PutCrLf() ||
    ' Birthday       POSITION(0126:0135)  char            ,' || PutCrLf() ||
    ' BirthPlace     POSITION(0137:0376)  char            ,' || PutCrLf() ||
    ' Resident       POSITION(0384:0387)  char            ,' || PutCrLf() ||
    ' KodObl         POSITION(0389:0398)  decimal external,' || PutCrLf() ||
    ' WorkPlace      POSITION(0400:0479)  char            ,' || PutCrLf() ||
    ' ADDRESS_INDEX  POSITION(0481:0530)  char            ,' || PutCrLf() ||
    ' ADDRESS_OBL    POSITION(0532:0581)  char            ,' || PutCrLf() ||
    ' ADDRESS_REG    POSITION(0583:0632)  char            ,' || PutCrLf() ||
    ' ADDRESS_CITY   POSITION(0634:0683)  char            ,' || PutCrLf() ||
    ' ADDRESS_STR    POSITION(0685:0804)  char            ,' || PutCrLf() ||
    ' ADDRESS_HS     POSITION(0806:0815)  char            ,' || PutCrLf() ||
    ' ADDRESS_APP    POSITION(0817:0826)  char            ,' || PutCrLf() ||
    ' K040           POSITION(0828:0859)  char            ,' || PutCrLf() ||
    ' PhoneContact   POSITION(0861:0892)  char            ,' || PutCrLf() ||
    ' PhoneHome      POSITION(0894:0925)  char            ,' || PutCrLf() ||
    ' MOBILE_PHONE   POSITION(0927:0958)  char            ,' || PutCrLf() ||
    ' Passport_Type  POSITION(0960:0991)  char            ,' || PutCrLf() ||
    ' Passport_S     POSITION(0993:1024)  char            ,' || PutCrLf() ||
    ' Passport_Num   POSITION(1026:1057)  char            ,' || PutCrLf() ||
    ' Passport_Place POSITION(1059:1218)  char            ,' || PutCrLf() ||
    ' Passport_Date  POSITION(1220:1229)  char            ,' || PutCrLf() ||
    ' K013           POSITION(1231:1262)  char            ,' || PutCrLf() ||
    ' K015           POSITION(1264:1295)  char            ,' || PutCrLf() ||
    ' Last_Ident     POSITION(1297:1306)  char            ,' || PutCrLf() ||
    ' Email          POSITION(1308:1387)  char            ,' || PutCrLf() ||
    ' K080           POSITION(1389:1420)  char            ,' || PutCrLf() ||
    ' K050           POSITION(1422:1453)  char            ,' || PutCrLf() ||
    ' K070           POSITION(1455:1486)  char            ,' || PutCrLf() ||
    ' Marital_Status POSITION(1488:1519)  char            ,' || PutCrLf() ||
    ' ChildrenCount  POSITION(1521:1533)  decimal external,' || PutCrLf() ||
    ' TreatyId       POSITION(1535:1544)  decimal external,' || PutCrLf() ||
    ' BranchCode     POSITION(1546:1577)  char            ,' || PutCrLf() ||
    ' BranchName     POSITION(1579:1658)  char            ,' || PutCrLf() ||
    ' BranchAddress  POSITION(1660:1739)  char            ,' || PutCrLf() ||
    ' Code           POSITION(1741:1772)  char            ,' || PutCrLf() ||
    ' OrgDate        POSITION(1774:1783)  char            ,' || PutCrLf() ||
    ' EndDate        POSITION(1785:1794)  char            ,' || PutCrLf() ||
    ' PercentCur     POSITION(1796:1805)  decimal external,' || PutCrLf() ||
    ' PercentBreak   POSITION(1807:2046)  char            ,' || PutCrLf() ||
    ' ProductCode    POSITION(2048:2079)  char            ,' || PutCrLf() ||
    ' ProductName    POSITION(2081:2112)  char            ,' || PutCrLf() ||
    ' CurrencyTag    POSITION(2114:2117)  char            ,' || PutCrLf() ||
    ' CrncyAmount    POSITION(2119:2129)  decimal external,' || PutCrLf() ||
    ' MainAccId      POSITION(2131:2140)  decimal external,' || PutCrLf() ||
    ' MainAccCode    POSITION(2142:2173)  char            ,' || PutCrLf() ||
    ' MainAccRest    POSITION(2175:2188)  decimal external,' || PutCrLf() ||
    ' MainAccR013    POSITION(2189:2189)  char            ,' || PutCrLf() ||
    ' MainAccR011    POSITION(2189:2189)  char            ,' || PutCrLf() ||
    ' PercAccId      POSITION(2190:2199)  decimal external,' || PutCrLf() ||
    ' PercAccCode    POSITION(2201:2232)  char            ,' || PutCrLf() ||
    ' PercAccRest    POSITION(2234:2247)  decimal external,' || PutCrLf() ||
    ' PercAccR013    POSITION(2248:2248)  char            ,' || PutCrLf() ||
    ' PercAccR011    POSITION(2248:2248)  char            ,' || PutCrLf() ||
    ' PercentPay     POSITION(2249:2258)  decimal external,' || PutCrLf() ||
    ' PercentCap     POSITION(2260:2269)  decimal external,' || PutCrLf() ||
    ' CapAccCode     POSITION(2271:2302)  char            ,' || PutCrLf() ||
    ' CalcDateInto   POSITION(2304:2313)  char            ,' || PutCrLf() ||
    ' BRANCHKODOBL   POSITION(2315:2326)  decimal external,' || PutCrLf() ||
    ' TYPEDOCDKFM    POSITION(2328:2338)  decimal external,' || PutCrLf() ||
    ' NAMEDOCDKFM    POSITION(2340:2579)  char            ,' || PutCrLf() ||
    ' CODEUPB        POSITION(2581:2612)  char            ,' || PutCrLf() ||
    ' MAINACCCODEUPB POSITION(2614:2645)  char            ,' || PutCrLf() ||
    ' COMMENTO       POSITION(2647:2901)  char            ,' || PutCrLf() ||
    ' COMMENTR       POSITION(2903:3157)  char)'             || PutCrLf()
.head 10 -  Call SalFileWrite(hF, sBuffer, Len(sBuffer))
.head 10 -  Call SalFileClose(hF)
.head 9 -  ! создать файл BAT-файл
.head 9 +  If SalFileOpen(hF, VisDosGetEnvString('TEMP') || '\\rodo.bat', OF_Create | OF_ReadWrite)
.head 10 -  Set sBuffer = 'sqlldr userid=' || SqlUser || '/' || SqlPassword || '@' || SqlDatabase || ' control=' ||
    VisDosGetEnvString('TEMP') || '\\rodo.ctl log=' || VisDosGetEnvString('TEMP') || '\\rodo.log'
.head 10 -  Call SalFileWrite(hF, sBuffer, Len(sBuffer))
.head 10 -  Call SalFileClose(hF)
.head 9 -  ! вызвать файл BAT-файл
.head 9 -  Call SalWaitCursor(TRUE)
.head 9 -  Set bOk = SalLoadAppAndWait(VisDosGetEnvString('TEMP') || '\\rodo.bat', Window_NotVisible, nRet)
.head 9 +  If not bOk
.head 10 -  Call MessageNoWait(IifS(GetLang()='RUS', 'Код возврата=' || Str(nRet) ||
     ' при загрузке файла изменений в базу.', 'Код завершення=' || Str(nRet) ||
     ' при загрузці файла змін в базу.'), IifS(GetLang()='RUS', 'ОШИБКА', 'ПОМИЛКА'), 0, 1)
.head 10 -  Call SalDisableWindow(pbRunUpdate)
.head 9 +  Else
.head 10 -  ! Call SalSendClassMessage(SAM_Create, 0, 0)
.head 10 -  ! Call SalSendMsg(hWndForm, SAM_Create, 0, 0)
.head 10 -  Set nAllLines = 0  ! к-во всех строк
.head 10 -  Set nNotDiff  = 0  ! к-во строк без расхождений
.head 10 -  Set nStrFinD  = 0  ! к-во строк c финансовыми расхождениями
.head 10 -  Set nAnkDiff  = 0  ! к-во анкетных расхождений
.head 10 -  Set nUgoPay   = 0  ! к-во вкладов, по которым УЖЕ была выплата
.head 10 -  !
.head 10 -  Call SqlPrepareAndExecute(hSqlAux(), '
     DELETE
     FROM   s6_rodofiles
     WHERE  fl=0 and upper(rodofile)=upper(:sFileName)')
.head 10 -  Call SqlPrepareAndExecute(hSqlAux(), '
     DELETE
     FROM   s6_rodoprot
     WHERE  fl=0 and upper(namefile)=upper(:sFileName)')
.head 10 -  !
.head 10 -  Call SalTblPopulate(frm_UpdRODO, hSql(), sSqlPopulate, TBL_FillAll)
.head 10 -  !
.head 10 -  Call SqlCommit(hSqlAux())
.head 10 -  !
.head 10 -  ! set sFileName = sFileName
.head 10 -  !
.head 10 -  If SqlPrepareAndExecute(hSql(), '
   SELECT trunc(dateupd)
   INTO   :dDatUpd
   FROM   s6_rodofiles
   WHERE  rodofile=:sFileName and fl=0 and rownum<2') and SqlFetchNext(hSql(), nFetchRes)
.head 10 +  Else
.head 11 -  Set dDatUpd = SalDateCurrent()
.head 10 -  !
.head 10 -  Set nUserId = GetUserId()
.head 10 -  If SqlPrepareAndExecute(hSql(), "
   SELECT FIO
   INTO   :sUserName
   FROM   staff
   WHERE  id=:nUserId") and SqlFetchNext(hSql(), nFetchRes)
.head 10 +  Else
.head 11 -  Set sUserName = 'Користувач ' || Str(nUserId)
.head 10 -  !
.head 10 -  If SqlPrepareAndExecute(hSql(), "
   SELECT sum(mainaccrest)+sum(percaccrest)
   INTO   :nSumUAH
   FROM   s6_rodoupd
   WHERE  currencytag='UAH'") and SqlFetchNext(hSql(), nFetchRes)
.head 10 +  Else
.head 11 -  Set nSumUAH = 0
.head 10 -  !
.head 10 -  If SqlPrepareAndExecute(hSql(), "
   SELECT sum(mainaccrest)+sum(percaccrest)
   INTO   :nSumUSD
   FROM   s6_rodoupd
   WHERE  currencytag='USD'") and SqlFetchNext(hSql(), nFetchRes)
.head 10 +  Else
.head 11 -  Set nSumUSD = 0
.head 10 -  !
.head 10 -  If SqlPrepareAndExecute(hSql(), "
   SELECT sum(mainaccrest)+sum(percaccrest)
   INTO   :nSumEUR
   FROM   s6_rodoupd
   WHERE  currencytag='EUR'") and SqlFetchNext(hSql(), nFetchRes)
.head 10 +  Else
.head 11 -  Set nSumEUR = 0
.head 10 -  !
.head 10 -  Set nAllRecc = nAllLines
.head 10 -  !
.head 10 -  Set nAllUpd = nAnkDiff
.head 10 -  !
.head 10 -  Set nNumNotUpd = nNotDiff
.head 10 -  !
.head 10 -  Set nYellow = nUgoPay
.head 10 -  !
.head 10 -  Set nOrchid = 0
.head 10 -  !
.head 10 -  ! Set nnStrFinD = nStrFinD
.head 10 -  !
.head 10 -  Call SqlPrepareAndExecute(hSqlAux(), "
     DELETE
     FROM   s6_rodoprot
     WHERE  upper(namefile)=upper(:sFileName) and comments='Предварительная информация' and fl=0")
.head 10 -  Call SqlPrepareAndExecute(hSqlAux(), "
     INSERT
     INTO   s6_rodoprot (namefile,datupd,username,sumuah,sumusd,sumeur,allrecc,allupd,numnotupd,strfind,
                         yellow,orchid,comments,fl)
     VALUES (:sFileName,:dDatUpd,:sUserName,:nSumUAH,:nSumUSD,:nSumEUR,:nAllRecc,:nAllUpd,:nNumNotUpd,
             :nStrFinD,:nYellow,:nOrchid,'Предварительная информация',0)")
.head 10 -  Call SqlCommit(hSqlAux())
.head 10 -  !
.head 10 -  Call SalFileCreateDirectory(VisStrSubstitute(sFilePathName, sFileName, 'PROT'))
.head 10 -  Call VisFileDelete(VisStrSubstitute(sFilePathName, sFileName, 'PROT') || '\\PROTOKOL_' || sFileName)
.head 10 -  Set nZapr = Val(GetValueStr("
    SELECT to_char(kodz)
    FROM   zapros
    WHERE  pkey='\\BRS\\SBM\\REP\\442'"))
.head 10 +  If nZapr > 0
.head 11 -  Call VisFileDelete(VisStrSubstitute(sFilePathName, sFileName, 'PROT') || '\\PROTOKOL_' || sFileName)
.head 11 -  Call ExportCatQuery(nZapr, VisStrSubstitute(sFilePathName, sFileName, 'PROT') || '\\PROTOKOL_' || sFileName,
     3, ":Param0='" || sFileName || "',:Param1='0'", FALSE)
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 +  If File(VisStrSubstitute(sFilePathName, sFileName, 'PROT') || '\\PROTOKOL_' || sFileName)
.head 12 -  Call MessageNoWait(IifS(GetLang()='RUS', 'Предварительный Протокол загрузки сохранён в файле ',
     'Попередній Протокол завантаження збережений у файлі ') || VisStrSubstitute(sFilePathName, sFileName,
     'PROT') || '\\PROTOKOL_' || sFileName, IifS(GetLang()='RUS', 'СООБЩЕНИЕ', 'ПОВІДОМЛЕННЯ'), 0, 0)
.head 11 +  Else
.head 12 -  Call MessageNoWait(IifS(GetLang()='RUS', 'Ошибка при формировании файла Протокола загрузки ',
     'Помилка при формуванні файлу Протоколу завантаження ') || VisStrSubstitute(sFilePathName, sFileName,
     'PROT') || '\\PROTOKOL_' || sFileName, IifS(GetLang()='RUS', 'ОШИБКА', 'ПОМИЛКА'), 0, 1)
.head 10 +  Else
.head 11 -  Call SalWaitCursor(FALSE)
.head 11 -  Call MessageNoWait(IifS(GetLang()='RUS',
     'Ошибка при формировании Протокола загрузки (отсутствует кат.запрос) ',
     'Помилка при формуванні Протокола завантаження (відсутній кат.запит) ') ||
     VisStrSubstitute(sFilePathName, sFileName, 'PROT') || '\\PROTOKOL_' || sFileName, IifS(GetLang()='RUS',
     'ОШИБКА', 'ПОМИЛКА'), 0, 1)
.head 10 -  Call SalWaitCursor(TRUE)
.head 10 -  !
.head 10 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 10 +  If nStat = 0
.head 11 -  Call SalEnableWindow(pbRunUpdate)
.head 10 +  Else
.head 11 -  Set nRow = TBL_MinRow
.head 11 -  Set bUgoNO = FALSE
.head 11 -  Set nI = 0
.head 11 +  While SalTblFindNextRow(frm_UpdRODO, nRow, 0, 0)
.head 12 -  Set nPusto = 0
.head 12 -  Call SalTblSetContext(frm_UpdRODO, nRow)
.head 12 -  ! записать в S6_RODOFILES информацию об изменениях анкетных данных
.head 12 -  ! ПЛЮС: подготовить информацию для BAD файла
.head 12 +  If frm_UpdRODO.colStateCode      != frm_UpdRODO.comStateCode
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'StateCode',:frm_UpdRODO.comStateCode,
             :frm_UpdRODO.colStateCode,sysdate)")
.head 13 -  Call ToRodofiles(1, 'StateCode', frm_UpdRODO.colStateCode, frm_UpdRODO.comStateCode,
                 'Изменение не выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colClientName     != frm_UpdRODO.comClientName
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ClientName',:frm_UpdRODO.comClientName,
             :frm_UpdRODO.colClientName,sysdate)")
.head 13 -  Call ToRodofiles(1, 'ClientName', frm_UpdRODO.colClientName, frm_UpdRODO.comClientName,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colBirthday       != frm_UpdRODO.comBirthday
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Birthday',:frm_UpdRODO.comBirthday,
             :frm_UpdRODO.colBirthday,sysdate)")
.head 13 -  Call ToRodofiles(1, 'Birthday', frm_UpdRODO.colBirthday, frm_UpdRODO.comBirthday,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colBirthPlace     != frm_UpdRODO.comBirthPlace
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'BirthPlace',:frm_UpdRODO.comBirthPlace,
             :frm_UpdRODO.colBirthPlace,sysdate)")
.head 13 -  Call ToRodofiles(1, 'BirthPlace', frm_UpdRODO.colBirthPlace, frm_UpdRODO.comBirthPlace,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colADDRESS_INDEX  != frm_UpdRODO.comADDRESS_INDEX
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ADDRESS_INDEX',:frm_UpdRODO.comADDRESS_INDEX,
             :frm_UpdRODO.colADDRESS_INDEX,sysdate)")
.head 13 -  Call ToRodofiles(1, 'ADDRESS_INDEX', frm_UpdRODO.colADDRESS_INDEX, frm_UpdRODO.comADDRESS_INDEX,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colADDRESS_OBL    != frm_UpdRODO.comADDRESS_OBL
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ADDRESS_OBL',:frm_UpdRODO.comADDRESS_OBL,
             :frm_UpdRODO.colADDRESS_OBL,sysdate)")
.head 13 -  Call ToRodofiles(1, 'ADDRESS_OBL', frm_UpdRODO.colADDRESS_OBL, frm_UpdRODO.comADDRESS_OBL,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colADDRESS_REG    != frm_UpdRODO.comADDRESS_REG
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ADDRESS_REG',:frm_UpdRODO.comADDRESS_REG,
             :frm_UpdRODO.colADDRESS_REG,sysdate)")
.head 13 -  Call ToRodofiles(1, 'ADDRESS_REG', frm_UpdRODO.colADDRESS_REG, frm_UpdRODO.comADDRESS_REG,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colADDRESS_CITY   != frm_UpdRODO.comADDRESS_CITY
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ADDRESS_CITY',:frm_UpdRODO.comADDRESS_CITY,
             :frm_UpdRODO.colADDRESS_CITY,sysdate)")
.head 13 -  Call ToRodofiles(1, 'ADDRESS_CITY', frm_UpdRODO.colADDRESS_CITY, frm_UpdRODO.comADDRESS_CITY,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colADDRESS_STR    != frm_UpdRODO.comADDRESS_STR
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ADDRESS_STR',:frm_UpdRODO.comADDRESS_STR,
             :frm_UpdRODO.colADDRESS_STR,sysdate)")
.head 13 -  Call ToRodofiles(1, 'ADDRESS_STR', frm_UpdRODO.colADDRESS_STR, frm_UpdRODO.comADDRESS_STR,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colADDRESS_HS     != frm_UpdRODO.comADDRESS_HS
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ADDRESS_HS',:frm_UpdRODO.comADDRESS_HS,
             :frm_UpdRODO.colADDRESS_HS,sysdate)")
.head 13 -  Call ToRodofiles(1, 'ADDRESS_HS', frm_UpdRODO.colADDRESS_HS, frm_UpdRODO.comADDRESS_HS,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colADDRESS_APP    != frm_UpdRODO.comADDRESS_APP
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ADDRESS_APP',:frm_UpdRODO.comADDRESS_APP,
             :frm_UpdRODO.colADDRESS_APP,sysdate)")
.head 13 -  Call ToRodofiles(1, 'ADDRESS_APP', frm_UpdRODO.colADDRESS_APP, frm_UpdRODO.comADDRESS_APP,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colK040           != frm_UpdRODO.comK040
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'K040',:frm_UpdRODO.comK040,
             :frm_UpdRODO.colK040,sysdate)")
.head 13 -  Call ToRodofiles(1, 'K040', frm_UpdRODO.colK040, frm_UpdRODO.comK040,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colPhoneContact   != frm_UpdRODO.comPhoneContact
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'PhoneContact',:frm_UpdRODO.comPhoneContact,
             :frm_UpdRODO.colPhoneContact,sysdate)")
.head 13 -  Call ToRodofiles(1, 'PhoneContact', frm_UpdRODO.colPhoneContact, frm_UpdRODO.comPhoneContact,
                 'Изменение НЕ выполнено')
.head 12 -  !
.head 12 +  If frm_UpdRODO.colPhoneHome      != frm_UpdRODO.comPhoneHome
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'PhoneHome',:frm_UpdRODO.comPhoneHome,
             :frm_UpdRODO.colPhoneHome,sysdate)")
.head 13 -  Call ToRodofiles(1, 'PhoneHome', frm_UpdRODO.colPhoneHome, frm_UpdRODO.comPhoneHome,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colMOBILE_PHONE   != frm_UpdRODO.comMOBILE_PHONE
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'MOBILE_PHONE',:frm_UpdRODO.comMOBILE_PHONE,
             :frm_UpdRODO.colMOBILE_PHONE,sysdate)")
.head 13 -  Call ToRodofiles(1, 'MOBILE_PHONE', frm_UpdRODO.colMOBILE_PHONE, frm_UpdRODO.comMOBILE_PHONE,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colPassport_S     != frm_UpdRODO.comPassport_S
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Passport_S',:frm_UpdRODO.comPassport_S,
             :frm_UpdRODO.colPassport_S,sysdate)")
.head 13 -  Call ToRodofiles(1, 'Passport_S', frm_UpdRODO.colPassport_S, frm_UpdRODO.comPassport_S,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colPassport_Num   != frm_UpdRODO.comPassport_Num
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Passport_Num',:frm_UpdRODO.comPassport_Num,
             :frm_UpdRODO.colPassport_Num,sysdate)")
.head 13 -  Call ToRodofiles(1, 'Passport_Num', frm_UpdRODO.colPassport_Num, frm_UpdRODO.comPassport_Num,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colPassport_Place != frm_UpdRODO.comPassport_Place
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Passport_Place',:frm_UpdRODO.comPassport_Place,
             :frm_UpdRODO.colPassport_Place,sysdate)")
.head 13 -  Call ToRodofiles(1, 'Passport_Place', frm_UpdRODO.colPassport_Place, frm_UpdRODO.comPassport_Place,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colPassport_Date  != frm_UpdRODO.comPassport_Date
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Passport_Date',:frm_UpdRODO.comPassport_Date,
             :frm_UpdRODO.colPassport_Date,sysdate)")
.head 13 -  Call ToRodofiles(1, 'Passport_Date', frm_UpdRODO.colPassport_Date, frm_UpdRODO.comPassport_Date,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colLast_Ident     != frm_UpdRODO.comLast_Ident
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Last_Ident',:frm_UpdRODO.comLast_Ident,
             :frm_UpdRODO.colLast_Ident,sysdate)")
.head 13 -  Call ToRodofiles(1, 'Last_Ident', frm_UpdRODO.colLast_Ident, frm_UpdRODO.comLast_Ident,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colEmail          != frm_UpdRODO.comEmail
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Email',:frm_UpdRODO.comEmail,
             :frm_UpdRODO.colEmail,sysdate)")
.head 13 -  Call ToRodofiles(1, 'Email', frm_UpdRODO.colEmail, frm_UpdRODO.comEmail,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colMarital_Status != frm_UpdRODO.comMarital_Status
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Marital_Status',:frm_UpdRODO.comMarital_Status,
             :frm_UpdRODO.colMarital_Status,sysdate)")
.head 13 -  Call ToRodofiles(1, 'Marital_Status', frm_UpdRODO.colMarital_Status, frm_UpdRODO.comMarital_Status,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colChildrenCount  != frm_UpdRODO.comChildrenCount
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ChildrenCount',:frm_UpdRODO.comChildrenCount,
             :frm_UpdRODO.colChildrenCount,sysdate)")
.head 13 -  Call ToRodofiles(1, 'ChildrenCount', Str(frm_UpdRODO.colChildrenCount),
                 Str(frm_UpdRODO.comChildrenCount), 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colTreatyId       != frm_UpdRODO.comTreatyId
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'TreatyId',:frm_UpdRODO.comTreatyId,
             :frm_UpdRODO.colTreatyId,sysdate)")
.head 13 -  Call ToRodofiles(1, 'TreatyId', Str(frm_UpdRODO.colTreatyId), Str(frm_UpdRODO.comTreatyId),
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colCode           != frm_UpdRODO.comCode
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Code',:frm_UpdRODO.comCode,
             :frm_UpdRODO.colCode,sysdate)")
.head 13 -  Call ToRodofiles(1, 'Code', frm_UpdRODO.colCode, frm_UpdRODO.comCode,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colOrgDate        != frm_UpdRODO.comOrgDate
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'OrgDate',:frm_UpdRODO.comOrgDate,
             :frm_UpdRODO.colOrgDate,sysdate)")
.head 13 -  Call ToRodofiles(1, 'OrgDate', frm_UpdRODO.colOrgDate, frm_UpdRODO.comOrgDate,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colTYPEDOCDKFM    != frm_UpdRODO.comTYPEDOCDKFM
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'TYPEDOCDKFM',:frm_UpdRODO.comTYPEDOCDKFM,
             :frm_UpdRODO.colTYPEDOCDKFM,sysdate)")
.head 13 -  Call ToRodofiles(1, 'TYPEDOCDKFM', frm_UpdRODO.colTYPEDOCDKFM, frm_UpdRODO.comTYPEDOCDKFM,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  !
.head 12 +  If frm_UpdRODO.colMAINACCCODEUPB != frm_UpdRODO.comMAINACCCODEUPB
.head 13 +  If not bUgoNO
.head 14 -  Set nCountNO = nCountNO + 1
.head 14 -  Set bUgoNO = TRUE
.head 13 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'MAINACCCODEUPB',:frm_UpdRODO.comMAINACCCODEUPB,
             :frm_UpdRODO.colMAINACCCODEUPB,sysdate)")
.head 13 -  Call ToRodofiles(1, 'MAINACCCODEUPB', frm_UpdRODO.colMAINACCCODEUPB, frm_UpdRODO.comMAINACCCODEUPB,
                 'Изменение НЕ выполнено')
.head 13 -  Set nPusto = 1
.head 12 -  ! ! 
.head 12 +  If frm_UpdRODO.colEndDate        != frm_UpdRODO.comEndDate
.head 13 -  Set nPusto = 1
.head 12 +  If frm_UpdRODO.colPercentCur     != frm_UpdRODO.comPercentCur
.head 13 -  Set nPusto = 1
.head 12 +  If frm_UpdRODO.colCurrencyTag    != frm_UpdRODO.comCurrencyTag
.head 13 -  Set nPusto = 1
.head 12 +  If frm_UpdRODO.colCrncyAmount    != frm_UpdRODO.comCrncyAmount
.head 13 -  Set nPusto = 1
.head 12 +  If frm_UpdRODO.colMainAccRest    != frm_UpdRODO.comMainAccRest
.head 13 -  Set nPusto = 1
.head 12 +  If frm_UpdRODO.colPercAccCode    != frm_UpdRODO.comPercAccCode
.head 13 -  Set nPusto = 1
.head 12 +  If frm_UpdRODO.colPercAccRest    != frm_UpdRODO.comPercAccRest
.head 13 -  Set nPusto = 1
.head 12 -  ! формирование данных для BAD-файла
.head 12 +  If nPusto = 0
.head 13 -  Set nmId[nI]          = frm_UpdRODO.colId
.head 13 -  Set nmDataId[nI]      = frm_UpdRODO.colDataId
.head 13 -  Set nmClientId[nI]    = frm_UpdRODO.colClientId
.head 13 -  Set smStateCode[nI]   = frm_UpdRODO.colStateCode
.head 13 -  Set smClientName[nI]  = frm_UpdRODO.colClientName
.head 13 -  Set smMainAccCode[nI] = frm_UpdRODO.colMainAccCode
.head 13 -  Set smCommentO[nI]    = 'Змін не виявлено'
.head 13 -  Set nI = nI + 1
.head 12 +  Else
.head 13 +  If frm_UpdRODO.colSOS = 5
.head 14 -  Set nmId[nI]          = frm_UpdRODO.colId
.head 14 -  Set nmDataId[nI]      = frm_UpdRODO.colDataId
.head 14 -  Set nmClientId[nI]    = frm_UpdRODO.colClientId
.head 14 -  Set smStateCode[nI]   = frm_UpdRODO.colStateCode
.head 14 -  Set smClientName[nI]  = frm_UpdRODO.colClientName
.head 14 -  Set smMainAccCode[nI] = frm_UpdRODO.colMainAccCode
.head 14 -  Set smCommentO[nI]    = 'Виплати здійснені'
.head 14 -  Set nI = nI + 1
.head 13 +  Else If frm_UpdRODO.colSOS = 1
.head 14 -  Set nmId[nI]          = frm_UpdRODO.colId
.head 14 -  Set nmDataId[nI]      = frm_UpdRODO.colDataId
.head 14 -  Set nmClientId[nI]    = frm_UpdRODO.colClientId
.head 14 -  Set smStateCode[nI]   = frm_UpdRODO.colStateCode
.head 14 -  Set smClientName[nI]  = frm_UpdRODO.colClientName
.head 14 -  Set smMainAccCode[nI] = frm_UpdRODO.colMainAccCode
.head 14 -  Set smCommentO[nI]    = 'Зміни фінансового характеру'
.head 14 -  Set nI = nI + 1
.head 11 -  Call SqlCommit(hSqlAux())
.head 11 -  ! если есть (т.е.nI>0) - сформировать файл BAD
.head 11 +  If nI > 0
.head 12 -  Call SalFileCreateDirectory(VisStrSubstitute(sFilePathName, sFileName, 'BAD'))
.head 12 -  Call VisFileDelete(VisStrSubstitute(sFilePathName, sFileName, 'BAD\\') ||
     Left(sFileName, Len(sFileName)-4) || '_BAD' || Right(sFileName, 4))
.head 12 -  Call SalFileOpen(hFbad, VisStrSubstitute(sFilePathName, sFileName, 'BAD\\') ||
     Left(sFileName, Len(sFileName)-4) || '_BAD' || Right(sFileName, 4), OF_Create | OF_ReadWrite)
.head 12 -  Set sBuffer = '        ID     DATAID   CLIENTID STATECODE  CLIENTNAME' || Spac(71) || 'MAINACCCODE' ||
    Spac(22) || 'COMMENTO' || Spac(505) || PutCrLf()
.head 12 -  Call SalFileWrite(hFbad, sBuffer, Len(sBuffer))
.head 12 -  Set sBuffer = Repl('---------- ', 4) || Repl('-', 80) || ' ' || Repl('-', 32) || ' ' || Repl('-', 510) ||
    '   ' || PutCrLf()
.head 12 -  Call SalFileWrite(hFbad, sBuffer, Len(sBuffer))
.head 12 -  Set nC = 0
.head 12 +  While nC < nI
.head 13 -  Set sBuffer = PadL(Str(nmId[nC]), 10) || PadL(Str(nmDataId[nC]), 11) || PadL(Str(nmClientId[nC]), 11) ||
    ' ' || PadR(smStateCode[nC], 11) || PadR(smClientName[nC], 81) || PadR(smMainAccCode[nC], 33) ||
    PadR(smCommentO[nC], 513) || PutCrLf()
.head 13 -  Call SalFileWrite(hFbad, sBuffer, Len(sBuffer))
.head 13 -  Set nC = nC + 1
.head 12 -  Call SalFileClose(hFbad)
.head 12 -  Call SalWaitCursor(FALSE)
.head 12 -  Call MessageNoWait(IifS(GetLang()='RUS', 'Cформирован файл ', 'Зформовано файл ') ||
     VisStrSubstitute(sFilePathName, sFileName, 'BAD\\') || Left(sFileName, Len(sFileName)-4) || '_BAD' ||
     Right(sFileName, 4), IifS(GetLang()='RUS', 'ВНИМАНИЕ!!!', 'УВАГА!!!'), 0, 1)
.head 12 -  Call SalWaitCursor(TRUE)
.head 10 -  Call SalEnableWindow(pbDetails)
.head 10 -  Call SalEnableWindow(pbExtProt)
.head 10 -  Call SalEnableWindow(pbView)
.head 10 -  Call SalDisableWindow(pbRunLoader)
.head 10 -  Set n01 = 0
.head 9 -  Call SalWaitCursor(FALSE)
.head 8 +  Else
.head 9 -  Call MessageNoWait(IifS(GetLang()='RUS', 'Информация из файла ' || sFileName || ' ранее УЖЕ принималась!!!',
     'Інформація із файлу ' || sFileName || ' раніше ВЖЕ приймалась!!!'), IifS(GetLang()='RUS', 'Сообщение',
     'Повідомлення'), 17, 1)
.head 7 +  ! Else 
.head 8 -  Call Debug(IifS(GetLang()='RUS', 'Ошибка выбора файла', IifS(GetLang()='UKR', 'Помилка вибору файла',
     'Error of choice of file')))
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, IifS(GetLang()='RUS', 'Загрузить файл изменений в базу',
       IifS(GetLang()='UKR', 'Завантажити файл змін в базу', 'To load the file of amendments in a base')))
.head 4 +  Pushbutton: pbRunUpdate
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.883"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Courier New Cyr
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \Bars98\RESOURCE\BMP\EXECUTE.BMP
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If bNofin
.head 8 +  If SalMessageBox(IifS(GetLang()='RUS', 'Вы уверены, что хотите выполнить ИЗМЕНЕНИЯ?',
   'Ви впевнені, що хочете виконати ЗМІНИ?'), IifS(GetLang()='RUS', 'Подтверждение', 'Підтвердження'),
    MB_IconQuestion | MB_YesNo | MB_DefButton2) = IDYES
.head 9 -  Call SalWaitCursor(TRUE)
.head 9 -  Set nRow = TBL_MinRow
.head 9 -  ! Call SqlPrepareAndExecute(hSql(), '
     begin
       tokf;
     end;')
.head 9 -  Set nCount = 0
.head 9 -  Set nCountNO = 0
.head 9 -  Set nYellow = 0
.head 9 -  !
.head 9 -  Call SqlPrepareAndExecute(hSqlAux(), '
     DELETE
     FROM   s6_rodofiles
     WHERE  fl=0 and upper(rodofile)=upper(:sFileName)')
.head 9 -  Call SqlPrepareAndExecute(hSqlAux(), '
     DELETE
     FROM   s6_rodoprot
     WHERE  fl=0 and upper(namefile)=upper(:sFileName)')
.head 9 +  While SalTblFindNextRow(frm_UpdRODO, nRow, 0, 0)
.head 10 -  Call SalTblSetContext(frm_UpdRODO, nRow)
.head 10 +  If frm_UpdRODO.colSOS != 5 !! не Yellow
.head 11 -  Set bUgo = FALSE
.head 11 -  !
.head 11 +  If frm_UpdRODO.colStateCode      != frm_UpdRODO.comStateCode
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    StateCode=:frm_UpdRODO.colStateCode
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    StateCode=:frm_UpdRODO.colStateCode
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE customer
     SET    OKPO=:frm_UpdRODO.colStateCode
     WHERE  rnk=:frm_UpdRODO.colRNK")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'StateCode',:frm_UpdRODO.comStateCode,
             :frm_UpdRODO.colStateCode,sysdate)")
.head 12 -  Call ToRodofiles(1, 'StateCode', frm_UpdRODO.colStateCode, frm_UpdRODO.comStateCode,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colClientName     != frm_UpdRODO.comClientName
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    ClientName=:frm_UpdRODO.colClientName
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    ClientName=:frm_UpdRODO.colClientName
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE customer
     SET    NMK=trim(substr(:frm_UpdRODO.colClientName,1,70))
     WHERE  rnk=:frm_UpdRODO.colRNK")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ClientName',:frm_UpdRODO.comClientName,
             :frm_UpdRODO.colClientName,sysdate)")
.head 12 -  Call ToRodofiles(1, 'ClientName', frm_UpdRODO.colClientName, frm_UpdRODO.comClientName,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colBirthday       != frm_UpdRODO.comBirthday
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    Birthday=:frm_UpdRODO.colBirthday
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    Birthday=:frm_UpdRODO.colBirthday
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE person
     SET    bday=to_date(:frm_UpdRODO.colBirthday,'DD.MM.YYYY')
     WHERE  rnk=:frm_UpdRODO.colRNK")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Birthday',:frm_UpdRODO.comBirthday,
             :frm_UpdRODO.colBirthday,sysdate)")
.head 12 -  Call ToRodofiles(1, 'Birthday', frm_UpdRODO.colBirthday, frm_UpdRODO.comBirthday,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colBirthPlace     != frm_UpdRODO.comBirthPlace
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    BirthPlace=:frm_UpdRODO.colBirthPlace
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    BirthPlace=:frm_UpdRODO.colBirthPlace
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE person
     SET    bplace=trim(substr(:frm_UpdRODO.colBirthPlace,1,70))
     WHERE  rnk=:frm_UpdRODO.colRNK")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'BirthPlace',:frm_UpdRODO.comBirthPlace,
             :frm_UpdRODO.colBirthPlace,sysdate)")
.head 12 -  Call ToRodofiles(1, 'BirthPlace', frm_UpdRODO.colBirthPlace, frm_UpdRODO.comBirthPlace,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colADDRESS_INDEX  != frm_UpdRODO.comADDRESS_INDEX
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    ADDRESS_INDEX=:frm_UpdRODO.colADDRESS_INDEX
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    ADDRESS_INDEX=:frm_UpdRODO.colADDRESS_INDEX
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE customerw
     SET    value=:frm_UpdRODO.colADDRESS_INDEX
     WHERE  rnk=:frm_UpdRODO.colRNK and tag='FGIDX'")
.head 12 -  Set skvar = frm_UpdRODO.colADDRESS_APP
.head 12 +  If Len(skvar) > 0
.head 13 -  Set skvar = ' кв.' || skvar
.head 12 -  Set sfulladdress = VisStrSubstitute(SalStrTrimX(frm_UpdRODO.colADDRESS_OBL || ' ' ||
    frm_UpdRODO.colADDRESS_REG || ' ' || frm_UpdRODO.colADDRESS_CITY || ' ' || frm_UpdRODO.colADDRESS_STR
    || ',' || frm_UpdRODO.colADDRESS_HS || skvar), '  ', ' ')
.head 12 +  If Len(sfulladdress) > 70
.head 13 -  Set sfulladdress = VisStrSubstitute(SalStrTrimX(frm_UpdRODO.colADDRESS_REG || ' ' ||
    frm_UpdRODO.colADDRESS_CITY || ' ' || frm_UpdRODO.colADDRESS_STR || ',' ||
    frm_UpdRODO.colADDRESS_HS || skvar), '  ', ' ')
.head 13 +  If Len(sfulladdress) > 70
.head 14 -  Set sfulladdress = SalStrTrimX(Subs(VisStrSubstitute(SalStrTrimX(frm_UpdRODO.colADDRESS_CITY || ' ' ||
    frm_UpdRODO.colADDRESS_STR || ',' || frm_UpdRODO.colADDRESS_HS || skvar), '  ', ' '), 1, 70))
.head 12 -  Set saddress = SalStrTrimX(Subs(frm_UpdRODO.colADDRESS_STR || ',' || frm_UpdRODO.colADDRESS_HS || skvar,
    1, 70))
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE customer
     SET    adr=:sfulladdress
     WHERE  rnk=:frm_UpdRODO.colRNK")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE customerw
     SET    value=:saddress
     WHERE  rnk=:frm_UpdRODO.colRNK and tag='FGADR'")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ADDRESS_INDEX',:frm_UpdRODO.comADDRESS_INDEX,
             :frm_UpdRODO.colADDRESS_INDEX,sysdate)")
.head 12 -  Call ToRodofiles(1, 'ADDRESS_INDEX', frm_UpdRODO.colADDRESS_INDEX, frm_UpdRODO.comADDRESS_INDEX,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colADDRESS_OBL    != frm_UpdRODO.comADDRESS_OBL
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    ADDRESS_OBL=:frm_UpdRODO.colADDRESS_OBL
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    ADDRESS_OBL=:frm_UpdRODO.colADDRESS_OBL
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE customerw
     SET    value=:frm_UpdRODO.colADDRESS_OBL
     WHERE  rnk=:frm_UpdRODO.colRNK and tag='FGOBL'")
.head 12 -  Set skvar = frm_UpdRODO.colADDRESS_APP
.head 12 +  If Len(skvar) > 0
.head 13 -  Set skvar = ' кв.' || skvar
.head 12 -  Set sfulladdress = VisStrSubstitute(SalStrTrimX(frm_UpdRODO.colADDRESS_OBL || ' ' ||
    frm_UpdRODO.colADDRESS_REG || ' ' || frm_UpdRODO.colADDRESS_CITY || ' ' || frm_UpdRODO.colADDRESS_STR
    || ',' || frm_UpdRODO.colADDRESS_HS || skvar), '  ', ' ')
.head 12 +  If Len(sfulladdress) > 70
.head 13 -  Set sfulladdress = VisStrSubstitute(SalStrTrimX(frm_UpdRODO.colADDRESS_REG || ' ' ||
    frm_UpdRODO.colADDRESS_CITY || ' ' || frm_UpdRODO.colADDRESS_STR || ',' || frm_UpdRODO.colADDRESS_HS
    || skvar), '  ', ' ')
.head 13 +  If Len(sfulladdress) > 70
.head 14 -  Set sfulladdress = SalStrTrimX(Subs(VisStrSubstitute(SalStrTrimX(frm_UpdRODO.colADDRESS_CITY || ' ' ||
    frm_UpdRODO.colADDRESS_STR || ',' || frm_UpdRODO.colADDRESS_HS || skvar), '  ', ' '), 1, 70))
.head 12 -  Set saddress = SalStrTrimX(Subs(frm_UpdRODO.colADDRESS_STR || ',' || frm_UpdRODO.colADDRESS_HS || skvar,
    1, 70))
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE customer
     SET    adr=:sfulladdress
     WHERE  rnk=:frm_UpdRODO.colRNK")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE customerw
     SET    value=:saddress
     WHERE  rnk=:frm_UpdRODO.colRNK and tag='FGADR'")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ADDRESS_OBL',:frm_UpdRODO.comADDRESS_OBL,
             :frm_UpdRODO.colADDRESS_OBL,sysdate)")
.head 12 -  Call ToRodofiles(1, 'ADDRESS_OBL', frm_UpdRODO.colADDRESS_OBL, frm_UpdRODO.comADDRESS_OBL,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colADDRESS_REG    != frm_UpdRODO.comADDRESS_REG
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    ADDRESS_REG=:frm_UpdRODO.colADDRESS_REG
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    ADDRESS_REG=:frm_UpdRODO.colADDRESS_REG
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE customerw
     SET    value=:frm_UpdRODO.colADDRESS_REG
     WHERE  rnk=:frm_UpdRODO.colRNK and tag='FGOBL'")
.head 12 -  Set skvar = frm_UpdRODO.colADDRESS_APP
.head 12 +  If Len(skvar) > 0
.head 13 -  Set skvar = ' кв.' || skvar
.head 12 -  Set sfulladdress = VisStrSubstitute(SalStrTrimX(frm_UpdRODO.colADDRESS_OBL || ' ' ||
    frm_UpdRODO.colADDRESS_REG || ' ' || frm_UpdRODO.colADDRESS_CITY || ' ' || frm_UpdRODO.colADDRESS_STR
    || ',' || frm_UpdRODO.colADDRESS_HS || skvar), '  ', ' ')
.head 12 +  If Len(sfulladdress) > 70
.head 13 -  Set sfulladdress = VisStrSubstitute(SalStrTrimX(frm_UpdRODO.colADDRESS_REG || ' ' ||
    frm_UpdRODO.colADDRESS_CITY || ' ' || frm_UpdRODO.colADDRESS_STR || ',' ||
    frm_UpdRODO.colADDRESS_HS || skvar), '  ', ' ')
.head 13 +  If Len(sfulladdress) > 70
.head 14 -  Set sfulladdress = SalStrTrimX(Subs(VisStrSubstitute(SalStrTrimX(frm_UpdRODO.colADDRESS_CITY || ' ' ||
    frm_UpdRODO.colADDRESS_STR || ',' || frm_UpdRODO.colADDRESS_HS || skvar), '  ', ' '), 1, 70))
.head 12 -  Set saddress = SalStrTrimX(Subs(frm_UpdRODO.colADDRESS_STR || ',' || frm_UpdRODO.colADDRESS_HS || skvar,
    1, 70))
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE customer
     SET    adr=:sfulladdress
     WHERE  rnk=:frm_UpdRODO.colRNK")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE customerw
     SET    value=:saddress
     WHERE  rnk=:frm_UpdRODO.colRNK and tag='FGADR'")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ADDRESS_REG',:frm_UpdRODO.comADDRESS_REG,
             :frm_UpdRODO.colADDRESS_REG,sysdate)")
.head 12 -  Call ToRodofiles(1, 'ADDRESS_REG', frm_UpdRODO.colADDRESS_REG, frm_UpdRODO.comADDRESS_REG,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colADDRESS_CITY   != frm_UpdRODO.comADDRESS_CITY
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    ADDRESS_CITY=:frm_UpdRODO.colADDRESS_CITY
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    ADDRESS_CITY=:frm_UpdRODO.colADDRESS_CITY
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE customerw
     SET    value=:frm_UpdRODO.colADDRESS_CITY
     WHERE  rnk=:frm_UpdRODO.colRNK and tag='FGTWN'")
.head 12 -  Set skvar = frm_UpdRODO.colADDRESS_APP
.head 12 +  If Len(skvar) > 0
.head 13 -  Set skvar = ' кв.' || skvar
.head 12 -  Set sfulladdress = VisStrSubstitute(SalStrTrimX(frm_UpdRODO.colADDRESS_OBL || ' ' ||
    frm_UpdRODO.colADDRESS_REG || ' ' || frm_UpdRODO.colADDRESS_CITY || ' ' || frm_UpdRODO.colADDRESS_STR
    || ',' || frm_UpdRODO.colADDRESS_HS || skvar), '  ', ' ')
.head 12 +  If Len(sfulladdress) > 70
.head 13 -  Set sfulladdress = VisStrSubstitute(SalStrTrimX(frm_UpdRODO.colADDRESS_REG || ' ' ||
    frm_UpdRODO.colADDRESS_CITY || ' ' || frm_UpdRODO.colADDRESS_STR || ',' || frm_UpdRODO.colADDRESS_HS
    || skvar), '  ', ' ')
.head 13 +  If Len(sfulladdress) > 70
.head 14 -  Set sfulladdress = SalStrTrimX(Subs(VisStrSubstitute(SalStrTrimX(frm_UpdRODO.colADDRESS_CITY || ' ' ||
    frm_UpdRODO.colADDRESS_STR || ',' || frm_UpdRODO.colADDRESS_HS || skvar), '  ', ' '), 1, 70))
.head 12 -  Set saddress = SalStrTrimX(Subs(frm_UpdRODO.colADDRESS_STR || ',' || frm_UpdRODO.colADDRESS_HS || skvar,
    1, 70))
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE customer
     SET    adr=:sfulladdress
     WHERE  rnk=:frm_UpdRODO.colRNK")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE customerw
     SET    value=:saddress
     WHERE  rnk=:frm_UpdRODO.colRNK and tag='FGADR'")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ADDRESS_CITY',:frm_UpdRODO.comADDRESS_CITY,
             :frm_UpdRODO.colADDRESS_CITY,sysdate)")
.head 12 -  Call ToRodofiles(1, 'ADDRESS_CITY', frm_UpdRODO.colADDRESS_CITY, frm_UpdRODO.comADDRESS_CITY,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colADDRESS_STR    != frm_UpdRODO.comADDRESS_STR
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    ADDRESS_STR=:frm_UpdRODO.colADDRESS_STR
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    ADDRESS_STR=:frm_UpdRODO.colADDRESS_STR
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 -  Set skvar = frm_UpdRODO.colADDRESS_APP
.head 12 +  If Len(skvar) > 0
.head 13 -  Set skvar = ' кв.' || skvar
.head 12 -  Set sfulladdress = VisStrSubstitute(SalStrTrimX(frm_UpdRODO.colADDRESS_OBL || ' ' ||
    frm_UpdRODO.colADDRESS_REG || ' ' || frm_UpdRODO.colADDRESS_CITY || ' ' || frm_UpdRODO.colADDRESS_STR
    || ',' || frm_UpdRODO.colADDRESS_HS || skvar), '  ', ' ')
.head 12 +  If Len(sfulladdress) > 70
.head 13 -  Set sfulladdress = VisStrSubstitute(SalStrTrimX(frm_UpdRODO.colADDRESS_REG || ' ' ||
    frm_UpdRODO.colADDRESS_CITY || ' ' || frm_UpdRODO.colADDRESS_STR || ',' || frm_UpdRODO.colADDRESS_HS
    || skvar), '  ', ' ')
.head 13 +  If Len(sfulladdress) > 70
.head 14 -  Set sfulladdress = SalStrTrimX(Subs(VisStrSubstitute(SalStrTrimX(frm_UpdRODO.colADDRESS_CITY || ' ' ||
    frm_UpdRODO.colADDRESS_STR || ',' || frm_UpdRODO.colADDRESS_HS || skvar), '  ', ' '), 1, 70))
.head 12 -  Set saddress = SalStrTrimX(Subs(frm_UpdRODO.colADDRESS_STR || ',' || frm_UpdRODO.colADDRESS_HS || skvar,
    1, 70))
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE customer
     SET    adr=:sfulladdress
     WHERE  rnk=:frm_UpdRODO.colRNK")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE customerw
     SET    value=:saddress
     WHERE  rnk=:frm_UpdRODO.colRNK and tag='FGADR'")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ADDRESS_STR',:frm_UpdRODO.comADDRESS_STR,
             :frm_UpdRODO.colADDRESS_STR,sysdate)")
.head 12 -  Call ToRodofiles(1, 'ADDRESS_STR', frm_UpdRODO.colADDRESS_STR, frm_UpdRODO.comADDRESS_STR,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colADDRESS_HS     != frm_UpdRODO.comADDRESS_HS
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    ADDRESS_HS=:frm_UpdRODO.colADDRESS_HS
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    ADDRESS_HS=:frm_UpdRODO.colADDRESS_HS
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 -  Set skvar = frm_UpdRODO.colADDRESS_APP
.head 12 +  If Len(skvar) > 0
.head 13 -  Set skvar = ' кв.' || skvar
.head 12 -  Set sfulladdress = VisStrSubstitute(SalStrTrimX(frm_UpdRODO.colADDRESS_OBL || ' ' ||
    frm_UpdRODO.colADDRESS_REG || ' ' || frm_UpdRODO.colADDRESS_CITY || ' ' || frm_UpdRODO.colADDRESS_STR
    || ',' || frm_UpdRODO.colADDRESS_HS || skvar), '  ', ' ')
.head 12 +  If Len(sfulladdress) > 70
.head 13 -  Set sfulladdress = VisStrSubstitute(SalStrTrimX(frm_UpdRODO.colADDRESS_REG || ' ' ||
    frm_UpdRODO.colADDRESS_CITY || ' ' || frm_UpdRODO.colADDRESS_STR || ',' || frm_UpdRODO.colADDRESS_HS
    || skvar), '  ', ' ')
.head 13 +  If Len(sfulladdress) > 70
.head 14 -  Set sfulladdress = SalStrTrimX(Subs(VisStrSubstitute(SalStrTrimX(frm_UpdRODO.colADDRESS_CITY || ' ' ||
    frm_UpdRODO.colADDRESS_STR || ',' || frm_UpdRODO.colADDRESS_HS || skvar), '  ', ' '), 1, 70))
.head 12 -  Set saddress = SalStrTrimX(Subs(frm_UpdRODO.colADDRESS_STR || ',' || frm_UpdRODO.colADDRESS_HS || skvar,
    1, 70))
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE customer
     SET    adr=:sfulladdress
     WHERE  rnk=:frm_UpdRODO.colRNK")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE customerw
     SET    value=:saddress
     WHERE  rnk=:frm_UpdRODO.colRNK and tag='FGADR'")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ADDRESS_HS',:frm_UpdRODO.comADDRESS_HS,
             :frm_UpdRODO.colADDRESS_HS,sysdate)")
.head 12 -  Call ToRodofiles(1, 'ADDRESS_HS', frm_UpdRODO.colADDRESS_HS, frm_UpdRODO.comADDRESS_HS,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colADDRESS_APP    != frm_UpdRODO.comADDRESS_APP
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    ADDRESS_APP=:frm_UpdRODO.colADDRESS_APP
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    ADDRESS_APP=:frm_UpdRODO.colADDRESS_APP
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 -  Set skvar = frm_UpdRODO.colADDRESS_APP
.head 12 +  If Len(skvar) > 0
.head 13 -  Set skvar = ' кв.' || skvar
.head 12 -  Set sfulladdress = VisStrSubstitute(SalStrTrimX(frm_UpdRODO.colADDRESS_OBL || ' ' ||
    frm_UpdRODO.colADDRESS_REG || ' ' || frm_UpdRODO.colADDRESS_CITY || ' ' || frm_UpdRODO.colADDRESS_STR
    || ',' || frm_UpdRODO.colADDRESS_HS || skvar), '  ', ' ')
.head 12 +  If Len(sfulladdress) > 70
.head 13 -  Set sfulladdress = VisStrSubstitute(SalStrTrimX(frm_UpdRODO.colADDRESS_REG || ' ' ||
    frm_UpdRODO.colADDRESS_CITY || ' ' || frm_UpdRODO.colADDRESS_STR || ',' || frm_UpdRODO.colADDRESS_HS
    || skvar), '  ', ' ')
.head 13 +  If Len(sfulladdress) > 70
.head 14 -  Set sfulladdress = SalStrTrimX(Subs(VisStrSubstitute(SalStrTrimX(frm_UpdRODO.colADDRESS_CITY || ' ' ||
    frm_UpdRODO.colADDRESS_STR || ',' || frm_UpdRODO.colADDRESS_HS || skvar), '  ', ' '), 1, 70))
.head 12 -  Set saddress = SalStrTrimX(Subs(frm_UpdRODO.colADDRESS_STR || ',' || frm_UpdRODO.colADDRESS_HS || skvar,
    1, 70))
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE customer
     SET    adr=:sfulladdress
     WHERE  rnk=:frm_UpdRODO.colRNK")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE customerw
     SET    value=:saddress
     WHERE  rnk=:frm_UpdRODO.colRNK and tag='FGADR'")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ADDRESS_APP',:frm_UpdRODO.comADDRESS_APP,
             :frm_UpdRODO.colADDRESS_APP,sysdate)")
.head 12 -  Call ToRodofiles(1, 'ADDRESS_APP', frm_UpdRODO.colADDRESS_APP, frm_UpdRODO.comADDRESS_APP,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colK040           != frm_UpdRODO.comK040
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    K040=:frm_UpdRODO.colK040
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    K040=:frm_UpdRODO.colK040
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE customer
     SET    country=:frm_UpdRODO.colK040
     WHERE  rnk=:frm_UpdRODO.colRNK")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'K040',:frm_UpdRODO.comK040,
             :frm_UpdRODO.colK040,sysdate)")
.head 12 -  Call ToRodofiles(1, 'K040', frm_UpdRODO.colK040, frm_UpdRODO.comK040,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colPhoneContact   != frm_UpdRODO.comPhoneContact
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    PhoneContact=:frm_UpdRODO.colPhoneContact
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    PhoneContact=:frm_UpdRODO.colPhoneContact
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE person
     SET    teld=trim(substr(:frm_UpdRODO.colPhoneContact,1,20))
     WHERE  rnk=:frm_UpdRODO.colRNK")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'PhoneContact',:frm_UpdRODO.comPhoneContact,
             :frm_UpdRODO.colPhoneContact,sysdate)")
.head 12 -  Call ToRodofiles(1, 'PhoneContact', frm_UpdRODO.colPhoneContact, frm_UpdRODO.comPhoneContact,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colPhoneHome      != frm_UpdRODO.comPhoneHome
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    PhoneHome=:frm_UpdRODO.colPhoneHome
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    PhoneHome=:frm_UpdRODO.colPhoneHome
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'PhoneHome',:frm_UpdRODO.comPhoneHome,
             :frm_UpdRODO.colPhoneHome,sysdate)")
.head 12 -  Call ToRodofiles(1, 'PhoneHome', frm_UpdRODO.colPhoneHome, frm_UpdRODO.comPhoneHome,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colMOBILE_PHONE   != frm_UpdRODO.comMOBILE_PHONE
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    MOBILE_PHONE=:frm_UpdRODO.colMOBILE_PHONE
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    MOBILE_PHONE=:frm_UpdRODO.colMOBILE_PHONE
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'MOBILE_PHONE',:frm_UpdRODO.comMOBILE_PHONE,
             :frm_UpdRODO.colMOBILE_PHONE,sysdate)")
.head 12 -  Call ToRodofiles(1, 'MOBILE_PHONE', frm_UpdRODO.colMOBILE_PHONE, frm_UpdRODO.comMOBILE_PHONE,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colPassport_S     != frm_UpdRODO.comPassport_S
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    Passport_S=:frm_UpdRODO.colPassport_S
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    Passport_S=:frm_UpdRODO.colPassport_S
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE person
     SET    ser=trim(substr(:frm_UpdRODO.colPassport_S,1,10))
     WHERE  rnk=:frm_UpdRODO.colRNK")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Passport_S',:frm_UpdRODO.comPassport_S,
             :frm_UpdRODO.colPassport_S,sysdate)")
.head 12 -  Call ToRodofiles(1, 'Passport_S', frm_UpdRODO.colPassport_S, frm_UpdRODO.comPassport_S,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colPassport_Num   != frm_UpdRODO.comPassport_Num
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    Passport_Num=:frm_UpdRODO.colPassport_Num
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    Passport_Num=:frm_UpdRODO.colPassport_Num
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE person
     SET    numdoc=trim(substr(:frm_UpdRODO.colPassport_Num,1,20))
     WHERE  rnk=:frm_UpdRODO.colRNK")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Passport_Num',:frm_UpdRODO.comPassport_Num,
             :frm_UpdRODO.colPassport_Num,sysdate)")
.head 12 -  Call ToRodofiles(1, 'Passport_Num', frm_UpdRODO.colPassport_Num, frm_UpdRODO.comPassport_Num,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colPassport_Place != frm_UpdRODO.comPassport_Place
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    Passport_Place=:frm_UpdRODO.colPassport_Place
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    Passport_Place=:frm_UpdRODO.colPassport_Place
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE person
     SET    organ=trim(substr(:frm_UpdRODO.colPassport_Place,1,50))
     WHERE  rnk=:frm_UpdRODO.colRNK")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Passport_Place',:frm_UpdRODO.comPassport_Place,
             :frm_UpdRODO.colPassport_Place,sysdate)")
.head 12 -  Call ToRodofiles(1, 'Passport_Place', frm_UpdRODO.colPassport_Place, frm_UpdRODO.comPassport_Place,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colPassport_Date  != frm_UpdRODO.comPassport_Date
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    Passport_Date=:frm_UpdRODO.colPassport_Date
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    Passport_Date=:frm_UpdRODO.colPassport_Date
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE person
     SET    pdate=to_date(:frm_UpdRODO.colPassport_Date,'DD.MM.YYYY')
     WHERE  rnk=:frm_UpdRODO.colRNK")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Passport_Date',:frm_UpdRODO.comPassport_Date,
             :frm_UpdRODO.colPassport_Date,sysdate)")
.head 12 -  Call ToRodofiles(1, 'Passport_Date', frm_UpdRODO.colPassport_Date, frm_UpdRODO.comPassport_Date,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colLast_Ident     != frm_UpdRODO.comLast_Ident
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    Last_Ident=:frm_UpdRODO.colLast_Ident
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    Last_Ident=:frm_UpdRODO.colLast_Ident
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Last_Ident',:frm_UpdRODO.comLast_Ident,
             :frm_UpdRODO.colLast_Ident,sysdate)")
.head 12 -  Call ToRodofiles(1, 'Last_Ident', frm_UpdRODO.colLast_Ident, frm_UpdRODO.comLast_Ident,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colEmail          != frm_UpdRODO.comEmail
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    Email=:frm_UpdRODO.colEmail
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    Email=:frm_UpdRODO.colEmail
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Email',:frm_UpdRODO.comEmail,
             :frm_UpdRODO.colEmail,sysdate)")
.head 12 -  Call ToRodofiles(1, 'Email', frm_UpdRODO.colEmail, frm_UpdRODO.comEmail,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colMarital_Status != frm_UpdRODO.comMarital_Status
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    Marital_Status=:frm_UpdRODO.colMarital_Status
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    Marital_Status=:frm_UpdRODO.colMarital_Status
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Marital_Status',:frm_UpdRODO.comMarital_Status,
             :frm_UpdRODO.colMarital_Status,sysdate)")
.head 12 -  Call ToRodofiles(1, 'Marital_Status', frm_UpdRODO.colMarital_Status, frm_UpdRODO.comMarital_Status,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colChildrenCount  != frm_UpdRODO.comChildrenCount
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    ChildrenCount=:frm_UpdRODO.colChildrenCount
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    ChildrenCount=:frm_UpdRODO.colChildrenCount
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ChildrenCount',:frm_UpdRODO.comChildrenCount,
             :frm_UpdRODO.colChildrenCount,sysdate)")
.head 12 -  Call ToRodofiles(1, 'ChildrenCount', Str(frm_UpdRODO.colChildrenCount), Str(frm_UpdRODO.comChildrenCount),
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colTreatyId       != frm_UpdRODO.comTreatyId
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    TreatyId=:frm_UpdRODO.colTreatyId
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    TreatyId=:frm_UpdRODO.colTreatyId
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'TreatyId',:frm_UpdRODO.comTreatyId,
             :frm_UpdRODO.colTreatyId,sysdate)")
.head 12 -  Call ToRodofiles(1, 'TreatyId', Str(frm_UpdRODO.colTreatyId), Str(frm_UpdRODO.comTreatyId),
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colCode           != frm_UpdRODO.comCode
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    Code=:frm_UpdRODO.colCode
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    Code=:frm_UpdRODO.colCode
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Code',:frm_UpdRODO.comCode,
             :frm_UpdRODO.colCode,sysdate)")
.head 12 -  Call ToRodofiles(1, 'Code', frm_UpdRODO.colCode, frm_UpdRODO.comCode,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colOrgDate        != frm_UpdRODO.comOrgDate
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    OrgDate=:frm_UpdRODO.colOrgDate
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    OrgDate=:frm_UpdRODO.colOrgDate
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_deposit
     SET    datz=to_date(:frm_UpdRODO.colOrgDate,'DD.MM.YYYY'),
            dat_begin=to_date(:frm_UpdRODO.colOrgDate,'DD.MM.YYYY')
     WHERE  rnk=:frm_UpdRODO.colRNK")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'OrgDate',:frm_UpdRODO.comOrgDate,
             :frm_UpdRODO.colOrgDate,sysdate)")
.head 12 -  Call ToRodofiles(1, 'OrgDate', frm_UpdRODO.colOrgDate, frm_UpdRODO.comOrgDate,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colTYPEDOCDKFM    != frm_UpdRODO.comTYPEDOCDKFM
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    TYPEDOCDKFM=:frm_UpdRODO.colTYPEDOCDKFM
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    TYPEDOCDKFM=:frm_UpdRODO.colTYPEDOCDKFM
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE person
     SET    passp=(case when :frm_UpdRODO.colTYPEDOCDKFM=1 then
                     1
                        when :frm_UpdRODO.colTYPEDOCDKFM=2 then
                     11
                        when :frm_UpdRODO.colTYPEDOCDKFM=3 then
                     15
                        when :frm_UpdRODO.colTYPEDOCDKFM=4 then
                     14
                        when :frm_UpdRODO.colTYPEDOCDKFM=5 then
                     2
                        when :frm_UpdRODO.colTYPEDOCDKFM=6 then
                     12
                        when :frm_UpdRODO.colTYPEDOCDKFM=7 then
                     13
                        when :frm_UpdRODO.colTYPEDOCDKFM=8 then
                     99
                   else
                     99
                   end)
     WHERE  rnk=:frm_UpdRODO.colRNK")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'TYPEDOCDKFM',:frm_UpdRODO.comTYPEDOCDKFM,
             :frm_UpdRODO.colTYPEDOCDKFM,sysdate)")
.head 12 -  Call ToRodofiles(1, 'TYPEDOCDKFM', frm_UpdRODO.colTYPEDOCDKFM, frm_UpdRODO.comTYPEDOCDKFM,
                 'Изменение выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colMAINACCCODEUPB != frm_UpdRODO.comMAINACCCODEUPB
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE dpt_rodovid
     SET    MAINACCCODEUPB=:frm_UpdRODO.colMAINACCCODEUPB
     WHERE  dptid=:frm_UpdRODO.colDPTID")
.head 12 -  Call SqlPrepareAndExecute(hSql(), "
     UPDATE s6_rodovid
     SET    MAINACCCODEUPB=:frm_UpdRODO.colMAINACCCODEUPB
     WHERE  mainacccode=:frm_UpdRODO.colMainAccCode")
.head 12 +  If not bUgo
.head 13 -  Set nCount = nCount + 1
.head 13 -  Set bUgo = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'MAINACCCODEUPB',:frm_UpdRODO.comMAINACCCODEUPB,
             :frm_UpdRODO.colMAINACCCODEUPB,sysdate)")
.head 12 -  Call ToRodofiles(1, 'MAINACCCODEUPB', frm_UpdRODO.colMAINACCCODEUPB, frm_UpdRODO.comMAINACCCODEUPB,
                 'Изменение выполнено')
.head 10 +  Else !! Yellow
.head 11 -  ! просто посчитать изменения и записать в S6_RODOFILES
.head 11 -  Set bUgoNO = FALSE
.head 11 -  Set nYellow = nYellow + 1
.head 11 -  !
.head 11 +  If frm_UpdRODO.colStateCode      != frm_UpdRODO.comStateCode
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'StateCode',:frm_UpdRODO.comStateCode,
             :frm_UpdRODO.colStateCode,sysdate)")
.head 12 -  Call ToRodofiles(1, 'StateCode', frm_UpdRODO.colStateCode, frm_UpdRODO.comStateCode,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colClientName     != frm_UpdRODO.comClientName
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ClientName',:frm_UpdRODO.comClientName,
             :frm_UpdRODO.colClientName,sysdate)")
.head 12 -  Call ToRodofiles(1, 'ClientName', frm_UpdRODO.colClientName, frm_UpdRODO.comClientName,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colBirthday       != frm_UpdRODO.comBirthday
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Birthday',:frm_UpdRODO.comBirthday,
             :frm_UpdRODO.colBirthday,sysdate)")
.head 12 -  Call ToRodofiles(1, 'Birthday', frm_UpdRODO.colBirthday, frm_UpdRODO.comBirthday,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colBirthPlace     != frm_UpdRODO.comBirthPlace
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'BirthPlace',:frm_UpdRODO.comBirthPlace,
             :frm_UpdRODO.colBirthPlace,sysdate)")
.head 12 -  Call ToRodofiles(1, 'BirthPlace', frm_UpdRODO.colBirthPlace, frm_UpdRODO.comBirthPlace,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colADDRESS_INDEX  != frm_UpdRODO.comADDRESS_INDEX
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ADDRESS_INDEX',:frm_UpdRODO.comADDRESS_INDEX,
             :frm_UpdRODO.colADDRESS_INDEX,sysdate)")
.head 12 -  Call ToRodofiles(1, 'ADDRESS_INDEX', frm_UpdRODO.colADDRESS_INDEX, frm_UpdRODO.comADDRESS_INDEX,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colADDRESS_OBL    != frm_UpdRODO.comADDRESS_OBL
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ADDRESS_OBL',:frm_UpdRODO.comADDRESS_OBL,
             :frm_UpdRODO.colADDRESS_OBL,sysdate)")
.head 12 -  Call ToRodofiles(1, 'ADDRESS_OBL', frm_UpdRODO.colADDRESS_OBL, frm_UpdRODO.comADDRESS_OBL,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colADDRESS_REG    != frm_UpdRODO.comADDRESS_REG
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ADDRESS_REG',:frm_UpdRODO.comADDRESS_REG,
             :frm_UpdRODO.colADDRESS_REG,sysdate)")
.head 12 -  Call ToRodofiles(1, 'ADDRESS_REG', frm_UpdRODO.colADDRESS_REG, frm_UpdRODO.comADDRESS_REG,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colADDRESS_CITY   != frm_UpdRODO.comADDRESS_CITY
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ADDRESS_CITY',:frm_UpdRODO.comADDRESS_CITY,
             :frm_UpdRODO.colADDRESS_CITY,sysdate)")
.head 12 -  Call ToRodofiles(1, 'ADDRESS_CITY', frm_UpdRODO.colADDRESS_CITY, frm_UpdRODO.comADDRESS_CITY,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colADDRESS_STR    != frm_UpdRODO.comADDRESS_STR
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ADDRESS_STR',:frm_UpdRODO.comADDRESS_STR,
             :frm_UpdRODO.colADDRESS_STR,sysdate)")
.head 12 -  Call ToRodofiles(1, 'ADDRESS_STR', frm_UpdRODO.colADDRESS_STR, frm_UpdRODO.comADDRESS_STR,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colADDRESS_HS     != frm_UpdRODO.comADDRESS_HS
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ADDRESS_HS',:frm_UpdRODO.comADDRESS_HS,
             :frm_UpdRODO.colADDRESS_HS,sysdate)")
.head 12 -  Call ToRodofiles(1, 'ADDRESS_HS', frm_UpdRODO.colADDRESS_HS, frm_UpdRODO.comADDRESS_HS,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colADDRESS_APP    != frm_UpdRODO.comADDRESS_APP
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ADDRESS_APP',:frm_UpdRODO.comADDRESS_APP,
             :frm_UpdRODO.colADDRESS_APP,sysdate)")
.head 12 -  Call ToRodofiles(1, 'ADDRESS_APP', frm_UpdRODO.colADDRESS_APP, frm_UpdRODO.comADDRESS_APP,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colK040           != frm_UpdRODO.comK040
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'K040',:frm_UpdRODO.comK040,
             :frm_UpdRODO.colK040,sysdate)")
.head 12 -  Call ToRodofiles(1, 'K040', frm_UpdRODO.colK040, frm_UpdRODO.comK040,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colPhoneContact   != frm_UpdRODO.comPhoneContact
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'PhoneContact',:frm_UpdRODO.comPhoneContact,
             :frm_UpdRODO.colPhoneContact,sysdate)")
.head 12 -  Call ToRodofiles(1, 'PhoneContact', frm_UpdRODO.colPhoneContact, frm_UpdRODO.comPhoneContact,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colPhoneHome      != frm_UpdRODO.comPhoneHome
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'PhoneHome',:frm_UpdRODO.comPhoneHome,
             :frm_UpdRODO.colPhoneHome,sysdate)")
.head 12 -  Call ToRodofiles(1, 'PhoneHome', frm_UpdRODO.colPhoneHome, frm_UpdRODO.comPhoneHome,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colMOBILE_PHONE   != frm_UpdRODO.comMOBILE_PHONE
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'MOBILE_PHONE',:frm_UpdRODO.comMOBILE_PHONE,
             :frm_UpdRODO.colMOBILE_PHONE,sysdate)")
.head 12 -  Call ToRodofiles(1, 'MOBILE_PHONE', frm_UpdRODO.colMOBILE_PHONE, frm_UpdRODO.comMOBILE_PHONE,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colPassport_S     != frm_UpdRODO.comPassport_S
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Passport_S',:frm_UpdRODO.comPassport_S,
             :frm_UpdRODO.colPassport_S,sysdate)")
.head 12 -  Call ToRodofiles(1, 'Passport_S', frm_UpdRODO.colPassport_S, frm_UpdRODO.comPassport_S,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colPassport_Num   != frm_UpdRODO.comPassport_Num
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Passport_Num',:frm_UpdRODO.comPassport_Num,
             :frm_UpdRODO.colPassport_Num,sysdate)")
.head 12 -  Call ToRodofiles(1, 'Passport_Num', frm_UpdRODO.colPassport_Num, frm_UpdRODO.comPassport_Num,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colPassport_Place != frm_UpdRODO.comPassport_Place
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Passport_Place',:frm_UpdRODO.comPassport_Place,
             :frm_UpdRODO.colPassport_Place,sysdate)")
.head 12 -  Call ToRodofiles(1, 'Passport_Place', frm_UpdRODO.colPassport_Place, frm_UpdRODO.comPassport_Place,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colPassport_Date  != frm_UpdRODO.comPassport_Date
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Passport_Date',:frm_UpdRODO.comPassport_Date,
             :frm_UpdRODO.colPassport_Date,sysdate)")
.head 12 -  Call ToRodofiles(1, 'Passport_Date', frm_UpdRODO.colPassport_Date, frm_UpdRODO.comPassport_Date,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colLast_Ident     != frm_UpdRODO.comLast_Ident
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Last_Ident',:frm_UpdRODO.comLast_Ident,
             :frm_UpdRODO.colLast_Ident,sysdate)")
.head 12 -  Call ToRodofiles(1, 'Last_Ident', frm_UpdRODO.colLast_Ident, frm_UpdRODO.comLast_Ident,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colEmail          != frm_UpdRODO.comEmail
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Email',:frm_UpdRODO.comEmail,
             :frm_UpdRODO.colEmail,sysdate)")
.head 12 -  Call ToRodofiles(1, 'Email', frm_UpdRODO.colEmail, frm_UpdRODO.comEmail,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colMarital_Status != frm_UpdRODO.comMarital_Status
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Marital_Status',:frm_UpdRODO.comMarital_Status,
             :frm_UpdRODO.colMarital_Status,sysdate)")
.head 12 -  Call ToRodofiles(1, 'Marital_Status', frm_UpdRODO.colMarital_Status, frm_UpdRODO.comMarital_Status,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colChildrenCount  != frm_UpdRODO.comChildrenCount
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'ChildrenCount',:frm_UpdRODO.comChildrenCount,
             :frm_UpdRODO.colChildrenCount,sysdate)")
.head 12 -  Call ToRodofiles(1, 'ChildrenCount', Str(frm_UpdRODO.colChildrenCount), Str(frm_UpdRODO.comChildrenCount),
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colTreatyId       != frm_UpdRODO.comTreatyId
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'TreatyId',:frm_UpdRODO.comTreatyId,
             :frm_UpdRODO.colTreatyId,sysdate)")
.head 12 -  Call ToRodofiles(1, 'TreatyId', Str(frm_UpdRODO.colTreatyId), Str(frm_UpdRODO.comTreatyId),
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colCode           != frm_UpdRODO.comCode
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'Code',:frm_UpdRODO.comCode,
             :frm_UpdRODO.colCode,sysdate)")
.head 12 -  Call ToRodofiles(1, 'Code', frm_UpdRODO.colCode, frm_UpdRODO.comCode,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colOrgDate        != frm_UpdRODO.comOrgDate
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'OrgDate',:frm_UpdRODO.comOrgDate,
             :frm_UpdRODO.colOrgDate,sysdate)")
.head 12 -  Call ToRodofiles(1, 'OrgDate', frm_UpdRODO.colOrgDate, frm_UpdRODO.comOrgDate,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colTYPEDOCDKFM    != frm_UpdRODO.comTYPEDOCDKFM
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'TYPEDOCDKFM',:frm_UpdRODO.comTYPEDOCDKFM,
             :frm_UpdRODO.colTYPEDOCDKFM,sysdate)")
.head 12 -  Call ToRodofiles(1, 'TYPEDOCDKFM', frm_UpdRODO.colTYPEDOCDKFM, frm_UpdRODO.comTYPEDOCDKFM,
                 'Изменение НЕ выполнено')
.head 11 -  !
.head 11 +  If frm_UpdRODO.colMAINACCCODEUPB != frm_UpdRODO.comMAINACCCODEUPB
.head 12 +  If not bUgoNO
.head 13 -  Set nCountNO = nCountNO + 1
.head 13 -  Set bUgoNO = TRUE
.head 12 -  ! Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd)
     VALUES (:sFileName,'Изменение НЕ выполнено',:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,
             :frm_UpdRODO.colCurrencyTag,:frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,
             :frm_UpdRODO.colPercAccRest,'MAINACCCODEUPB',:frm_UpdRODO.comMAINACCCODEUPB,
             :frm_UpdRODO.colMAINACCCODEUPB,sysdate)")
.head 12 -  Call ToRodofiles(1, 'MAINACCCODEUPB', frm_UpdRODO.colMAINACCCODEUPB, frm_UpdRODO.comMAINACCCODEUPB,
                 'Изменение НЕ выполнено')
.head 9 -  !
.head 9 -  Call SqlCommit(hSql())
.head 9 -  Call SqlCommit(hSqlAux())
.head 9 -  !
.head 9 -  ! перенесение принятого файла в архив
.head 9 -  Call SalFileCreateDirectory(VisStrSubstitute(sFilePathName, sFileName, 'ARC'))
.head 9 -  Call VisFileSetAttribute(sFilePathName, FA_ReadOnly, FALSE)
.head 9 -  Call VisFileSetAttribute(sFilePathName, FA_Hidden, FALSE)
.head 9 -  Call VisFileSetAttribute(sFilePathName, FA_System, FALSE)
.head 9 -  Call VisFileRename(sFilePathName, VisStrSubstitute(sFilePathName, sFileName, 'ARC\\') || sFileName)
.head 9 -  ! Call SqlPrepareAndExecute(hSql(), '
     begin
       toroot;
     end;')
.head 9 -  ! Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 9 +  If nCount > 0
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call MessageNoWait('Файл ' || sFileName || IifS(GetLang()='RUS', '. Изменения выполнены, заменено ',
     '. Зміни виконано, оновлено ') || Str(nCount) || ' рекв.', IifS(GetLang()='RUS', 'СООБЩЕНИЕ',
     'ПОВІДОМЛЕННЯ'), 17, 0)
.head 10 -  Call SalWaitCursor(TRUE)
.head 10 -  Call SalDisableWindow(pbRunUpdate)
.head 9 -  ! занесение информации в протокол
.head 9 -  !
.head 9 -  ! set sFileName = sFileName
.head 9 -  !
.head 9 -  If SqlPrepareAndExecute(hSql(), '
   SELECT trunc(dateupd)
   INTO   :dDatUpd
   FROM   s6_rodofiles
   WHERE  rodofile=:sFileName and rownum<2') and SqlFetchNext(hSql(), nFetchRes)
.head 9 +  Else
.head 10 -  Set dDatUpd = SalDateCurrent()
.head 9 -  !
.head 9 -  Set nUserId = GetUserId()
.head 9 -  If SqlPrepareAndExecute(hSql(), "
   SELECT FIO
   INTO   :sUserName
   FROM   staff
   WHERE  id=:nUserId") and SqlFetchNext(hSql(), nFetchRes)
.head 9 +  Else
.head 10 -  Set sUserName = 'Користувач ' || Str(nUserId)
.head 9 -  !
.head 9 -  If SqlPrepareAndExecute(hSql(), "
   SELECT sum(mainaccrest)+sum(percaccrest)
   INTO   :nSumUAH
   FROM   s6_rodoupd
   WHERE  currencytag='UAH'") and SqlFetchNext(hSql(), nFetchRes)
.head 9 +  Else
.head 10 -  Set nSumUAH = 0
.head 9 -  !
.head 9 -  If SqlPrepareAndExecute(hSql(), "
   SELECT sum(mainaccrest)+sum(percaccrest)
   INTO   :nSumUSD
   FROM   s6_rodoupd
   WHERE  currencytag='USD'") and SqlFetchNext(hSql(), nFetchRes)
.head 9 +  Else
.head 10 -  Set nSumUSD = 0
.head 9 -  !
.head 9 -  If SqlPrepareAndExecute(hSql(), "
   SELECT sum(mainaccrest)+sum(percaccrest)
   INTO   :nSumEUR
   FROM   s6_rodoupd
   WHERE  currencytag='EUR'") and SqlFetchNext(hSql(), nFetchRes)
.head 9 +  Else
.head 10 -  Set nSumEUR = 0
.head 9 -  !
.head 9 -  If SqlPrepareAndExecute(hSql(), '
   SELECT count(1)
   INTO   :nAllRecc
   FROM   s6_rodoupd') and SqlFetchNext(hSql(), nFetchRes)
.head 9 +  Else
.head 10 -  Set nAllRecc = 0
.head 9 -  !
.head 9 -  Set nNumNotUpd = nNotDiff
.head 9 -  !
.head 9 -  Set nAllUpd = nCount
.head 9 -  !
.head 9 -  ! set nYellow = nYellow
.head 9 -  !
.head 9 -  Set nOrchid = 0
.head 9 -  !
.head 9 -  Call SqlPrepareAndExecute(hSql(), "
     INSERT
     INTO   s6_rodoprot (namefile,datupd,username,sumuah,sumusd,sumeur,allrecc,allupd,numnotupd,strfind,yellow,
                         orchid,comments,fl)
     VALUES (:sFileName,:dDatUpd,:sUserName,:nSumUAH,:nSumUSD,:nSumEUR,:nAllRecc,:nAllUpd,:nNumNotUpd,:nStrFinD,
             :nYellow,:nOrchid,'Информация после изменений',1)")
.head 9 -  Call SqlCommit(hSql())
.head 9 -  !
.head 9 -  Call SalTblReset(hWndForm)
.head 9 -  Call SalDisableWindow(pbDetails)
.head 9 -  !
.head 9 -  Call SalFileCreateDirectory(VisStrSubstitute(sFilePathName, sFileName, 'PROT'))
.head 9 -  Call VisFileDelete(VisStrSubstitute(sFilePathName, sFileName, 'PROT') || '\\PROTOKOL_' || sFileName)
.head 9 -  Set nZapr = Val(GetValueStr("
    SELECT to_char(kodz)
    FROM   zapros
    WHERE  pkey='\\BRS\\SBM\\REP\\442'"))
.head 9 +  If nZapr > 0
.head 10 -  Call VisFileDelete('c:\\PROTOKOL_' || sFileName)
.head 10 -  Call ExportCatQuery(nZapr, VisStrSubstitute(sFilePathName, sFileName, 'PROT') || '\\PROTOKOL_' || sFileName,
     3, ":Param0='" || sFileName || "',:Param1='1'", FALSE)
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 +  If File(VisStrSubstitute(sFilePathName, sFileName, 'PROT') || '\\PROTOKOL_' || sFileName)
.head 11 -  Call MessageNoWait(IifS(GetLang()='RUS', 'Протокол загрузки сохранён в файле ',
     'Протокол завантаження збережений у файлі ') || VisStrSubstitute(sFilePathName, sFileName, 'PROT') ||
     '\\PROTOKOL_' || sFileName, IifS(GetLang()='RUS', 'СООБЩЕНИЕ', 'ПОВІДОМЛЕННЯ'), 0, 0)
.head 10 +  Else
.head 11 -  Call MessageNoWait(IifS(GetLang()='RUS', 'Ошибка при формировании файла Протокола загрузки ',
     'Помилка при формуванні файлу Протоколу завантаження ') || VisStrSubstitute(sFilePathName, sFileName,
     'PROT') || '\\PROTOKOL_' || sFileName, IifS(GetLang()='RUS', 'ОШИБКА', 'ПОМИЛКА'), 0, 1)
.head 9 +  Else
.head 10 -  Call SalWaitCursor(FALSE)
.head 10 -  Call MessageNoWait(IifS(GetLang()='RUS',
     'Ошибка при формировании Протокола загрузки (отсутствует кат.запрос) ',
     'Помилка при формуванні Протокола завантаження (відсутній кат.запит) ') ||
     VisStrSubstitute(sFilePathName, sFileName, 'PROT') || '\\PROTOKOL_' || sFileName, IifS(GetLang()='RUS',
     'ОШИБКА', 'ПОМИЛКА'), 0, 1)
.head 9 -  ! Call SalEnableWindow(pbView)
.head 9 -  Set n01 = 1
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, IifS(GetLang()='RUS', 'Выполнить изменения',
       IifS(GetLang()='UKR', 'Виконати зміни', 'To execute changes')))
.head 4 +  Pushbutton: pbView
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.417"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \Bars98\RESOURCE\BMP\VIEW.BMP
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalModalDialog(dlgViewTXTfile, hWndForm, VisStrSubstitute(sFilePathName, sFileName, 'PROT') || '\\PROTOKOL_' ||
     sFileName)
.head 7 -  ! Call ExportCatQuery(4735, VisStrSubstitute(sFilePathName, sFileName, 'PROT') || '\\PROTOKOL_' || sFileName, 3,
     ":Param0='" || sFileName || "'", FALSE)
.head 7 +  ! If File(VisStrSubstitute(sFilePathName, sFileName, 'PROT') || '\\PROTOKOL_' || sFileName)
.head 8 -  Call MessageNoWait(IifS(GetLang()='RUS', 'Протокол загрузки сохранён в файле ',
     'Протокол завантаження збережений у файлі ') || VisStrSubstitute(sFilePathName, sFileName, 'PROT') ||
     '\\PROTOKOL_' || sFileName, IifS(GetLang()='RUS', 'СООБЩЕНИЕ', 'ПОВІДОМЛЕННЯ'), 0, 0)
.head 7 +  ! Else
.head 8 -  Call MessageNoWait(IifS(GetLang()='RUS', 'Ошибка при формировании Протокола загрузки ',
     'Помилка при формуванні Протокола завантаження ') || VisStrSubstitute(sFilePathName, sFileName, 'PROT') ||
     '\\PROTOKOL_' || sFileName, IifS(GetLang()='RUS', 'ОШИБКА', 'ПОМИЛКА'), 0, 1)
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, IifS(GetLang()='RUS', 'Просмотр ' || IifS(n01=0, 'предварительного ', '') ||
       'Протокола загрузки', IifS(GetLang()='UKR', 'Перегляд ' || IifS(n01=0, 'попереднього ', '') ||
       'Протоколу завантаження', 'Viewing of Protocol of load')))
.head 4 +  Pushbutton: pbExtProt
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.95"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \Bars98\RESOURCE\BMP\DOCS.BMP
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  ! Call SalModalDialog(dlgViewTXTfile, hWndForm, VisStrSubstitute(sFilePathName, sFileName, 'PROT') || '\\PROTOKOL_' ||
     sFileName)
.head 7 -  Set nExtProt = Val(GetValueStr("
    SELECT to_char(kodz)
    FROM   zapros
    WHERE  pkey='\\BRS\\SBM\\REP\\443'"))
.head 7 +  If nExtProt > 0
.head 8 -  Call SalFileCreateDirectory(VisStrSubstitute(sFilePathName, sFileName, 'PROT'))
.head 8 -  Call VisFileDelete(VisStrSubstitute(sFilePathName, sFileName, 'PROT') || '\\PROTOKOL_EXT_' || sFileName)
.head 8 -  Call ExportCatQuery(nExtProt, VisStrSubstitute(sFilePathName, sFileName, 'PROT') || '\\PROTOKOL_EXT_' ||
     Left(sFileName, Len(sFileName)-3) || 'xls' , 8, ":Param0='" || sFileName || "',:Param1='" || Str(n01) || "'",
     FALSE)
.head 7 +  If File(VisStrSubstitute(sFilePathName, sFileName, 'PROT') || '\\PROTOKOL_EXT_' || Left(sFileName, Len(sFileName)-3)
   || 'xls')
.head 8 -  Call MessageNoWait(IifS(GetLang()='RUS', 'Расширенный Протокол загрузки сохранён в файле ',
     'Розширений Протокол завантаження збережений у файлі ') || VisStrSubstitute(sFilePathName, sFileName, 'PROT')
     || '\\PROTOKOL_EXT_' || sFileName, IifS(GetLang()='RUS', 'СООБЩЕНИЕ', 'ПОВІДОМЛЕННЯ'), 0, 0)
.head 7 +  Else
.head 8 -  Call MessageNoWait(IifS(GetLang()='RUS', 'Ошибка при формировании расширенного Протокола загрузки ',
     'Помилка при формуванні розширеного Протоколу завантаження ') || VisStrSubstitute(sFilePathName, sFileName,
     'PROT') || '\\PROTOKOL_EXT_' || sFileName, IifS(GetLang()='RUS', 'ОШИБКА', 'ПОМИЛКА'), 0, 1)
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, IifS(GetLang()='RUS', 'Формирование расширенного ' || IifS(n01=0,
       'предварительного ', '') || 'Протокола загрузки', IifS(GetLang()='UKR', 'Формування розширеного ' ||
       IifS(n01=0, 'попереднього ', '') || 'Протоколу завантаження', 'Forming of the extended Protocol of load')))
.head 2 +  Contents
.head 3 +  Column: NumDiff
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: К-во
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Id
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDataId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DataId
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colClientId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ClientId
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.914"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colStateCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: StateCode
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colClientName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ClientName
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBirthday
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Birthday
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBirthPlace
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: BirthPlace
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colResident
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Resident
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKodObl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: KodObl
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colWorkPlace
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: WorkPlace
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colADDRESS_INDEX
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ADDRESS_INDEX
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colADDRESS_OBL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ADDRESS_OBL
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colADDRESS_REG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ADDRESS_REG
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colADDRESS_CITY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ADDRESS_CITY
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colADDRESS_STR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ADDRESS_STR
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colADDRESS_HS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ADDRESS_HS
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colADDRESS_APP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ADDRESS_APP
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colK040
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: K040
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPhoneContact
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PhoneContact
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPhoneHome
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PhoneHome
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colMOBILE_PHONE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: MOBILE_PHONE
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPassport_Type
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Passport_Type
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPassport_S
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Passport_S
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPassport_Num
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Passport_Num
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPassport_Place
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Passport_Place
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPassport_Date
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Passport_Date
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colK013
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: K013
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colK015
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: K015
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colLast_Ident
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Last_Ident
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colEmail
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Email
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colK080
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: K080
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colK050
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: K050
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colK070
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: K070
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colMarital_Status
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Marital_Status
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colChildrenCount
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ChildrenCount
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTreatyId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: TreatyId
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBranchCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: BranchCode
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBranchName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: BranchName
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBranchAddress
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: BranchAddress
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Code
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOrgDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: OrgDate
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colEndDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: EndDate
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPercentCur
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PercentCur
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPercentBreak
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PercentBreak
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colProductCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ProductCode
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colProductName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ProductName
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCurrencyTag
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: CurrencyTag
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCrncyAmount
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: CrncyAmount
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colMainAccId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: MainAccId
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colMainAccCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: MainAccCode
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colMainAccRest
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: MainAccRest
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colMainAccR013
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: MainAccR013
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colMainAccR011
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: MainAccR011
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPercAccId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PercAccId
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPercAccCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PercAccCode
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPercAccRest
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PercAccRest
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPercAccR013
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PercAccR013
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPercAccR011
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PercAccR011
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPercentPay
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PercentPay
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPercentCap
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PercentCap
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCapAccCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: CapAccCode
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCalcDateInto
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: CalcDateInto
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBRANCHKODOBL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: BRANCHKODOBL
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTYPEDOCDKFM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: TYPEDOCDKFM
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNAMEDOCDKFM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: NAMEDOCDKFM
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colCODEUPB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: CODEUPB
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colMAINACCCODEUPB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: MAINACCCODEUPB
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Id(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comDataId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DataId(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comClientId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ClientId(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comStateCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: StateCode(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comClientName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ClientName(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comBirthday
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Birthday(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comBirthPlace
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: BirthPlace(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comResident
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Resident(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comKodObl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: KodObl(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comWorkPlace
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: WorkPlace(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comADDRESS_INDEX
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ADDRESS_INDEX(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comADDRESS_OBL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ADDRESS_OBL(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comADDRESS_REG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ADDRESS_REG(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comADDRESS_CITY
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ADDRESS_CITY(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comADDRESS_STR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ADDRESS_STR(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comADDRESS_HS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ADDRESS_HS(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comADDRESS_APP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ADDRESS_APP(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comK040
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: K040(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comPhoneContact
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PhoneContact(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comPhoneHome
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PhoneHome(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comMOBILE_PHONE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: MOBILE_PHONE(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comPassport_Type
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Passport_Type(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comPassport_S
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Passport_S(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comPassport_Num
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Passport_Num(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comPassport_Place
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Passport_Place(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comPassport_Date
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Passport_Date(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comK013
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: K013(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comK015
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: K015(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comLast_Ident
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Last_Ident(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comEmail
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Email(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comK080
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: K080(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comK050
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: K050(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comK070
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: K070(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comMarital_Status
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Marital_Status(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comChildrenCount
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ChildrenCount(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comTreatyId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: TreatyId(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comBranchCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: BranchCode(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comBranchName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: BranchName(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comBranchAddress
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: BranchAddress(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Code(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comOrgDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: OrgDate(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comEndDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: EndDate(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.483"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comPercentCur
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PercentCur(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comPercentBreak
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PercentBreak(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comProductCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ProductCode(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comProductName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ProductName(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comCurrencyTag
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: CurrencyTag(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comCrncyAmount
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: CrncyAmount(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comMainAccId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: MainAccId(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comMainAccCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: MainAccCode(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comMainAccRest
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: MainAccRest(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comMainAccR013
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: MainAccR013(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comMainAccR011
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: MainAccR011(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comPercAccId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PercAccId(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comPercAccCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PercAccCode(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comPercAccRest
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PercAccRest(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comPercAccR013
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PercAccR013(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comPercAccR011
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PercAccR011(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comPercentPay
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PercentPay(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comPercentCap
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: PercentCap(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comCapAccCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: CapAccCode(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comCalcDateInto
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: CalcDateInto(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comBRANCHKODOBL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: BRANCHKODOBL(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comTYPEDOCDKFM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: TYPEDOCDKFM(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comNAMEDOCDKFM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: NAMEDOCDKFM(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comCODEUPB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: CODEUPB(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: comMAINACCCODEUPB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: MAINACCCODEUPB(m)
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colcomments
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: comments
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDPTID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: DPTID
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: SOS
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: RNK
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: ToRodofiles
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nFl
.head 5 -  String: sTag
.head 5 -  String: sCol
.head 5 -  String: sCom
.head 5 -  String: sNote
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SqlPrepareAndExecute(hSqlAux(), "
     INSERT
     INTO   s6_rodofiles (rodofile,note,id,clientname,currencytag,mainacccode,mainaccrest,percaccrest,
                          tag,valueold,valuenew,dateupd,fl)
     VALUES (:sFileName,:sNote,:frm_UpdRODO.colId,:frm_UpdRODO.colClientName,:frm_UpdRODO.colCurrencyTag,
             :frm_UpdRODO.colMainAccCode,:frm_UpdRODO.colMainAccRest,:frm_UpdRODO.colPercAccRest,:sTag,:sCom,:sCol,
             sysdate,:nFl)")
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  Number: nContext
.head 3 -  Number: nFlags
.head 3 -  !
.head 3 -  String: sFilters[*]
.head 3 -  Number: nIndex
.head 3 -  Number: nFilters
.head 3 -  String: sFileName
.head 3 -  String: sFilePathName
.head 3 -  !
.head 3 -  String: sBuffer
.head 3 -  Boolean: bNofin
.head 3 -  !
.head 3 -  File Handle: hF
.head 3 -  Boolean: bOk
.head 3 -  Number: nRet
.head 3 -  Number: nCount
.head 3 -  Boolean: bUgo
.head 3 -  Number: nCountNO
.head 3 -  Boolean: bUgoNO
.head 3 -  String: skvar
.head 3 -  String: sfulladdress
.head 3 -  String: saddress
.head 3 -  !
.head 3 -  String: smL[*]
.head 3 -  String: smM[*]
.head 3 -  Number: nmL[*]
.head 3 -  !
.head 3 -  String: sSqlPopulate
.head 3 -  Number: nmM[*]
.head 3 -  Number: nUgoFile
.head 3 -  Number: nStat
.head 3 -  !
.head 3 -  Number: nYellow
.head 3 -  Number: nOrchid
.head 3 -  Date/Time: dDatUpd
.head 3 -  String: sUserName
.head 3 -  Number: nSumUAH
.head 3 -  Number: nSumUSD
.head 3 -  Number: nSumEUR
.head 3 -  Number: nAllRecc
.head 3 -  Number: nAllUpd
.head 3 -  Number: nUserId
.head 3 -  !
.head 3 -  Number: nZapr
.head 3 -  !
.head 3 -  Number: nAllLines
.head 3 -  Number: nNotDiff
.head 3 -  Number: nAnkDiff
.head 3 -  String: sNote
.head 3 -  Number: nUgoPay
.head 3 -  Number: nNumNotUpd
.head 3 -  !
.head 3 -  Number: nExtProt
.head 3 -  Number: n01
.head 3 -  !
.head 3 -  Number: nStrFinD
.head 3 -  Number: nI
.head 3 -  Number: nC
.head 3 -  Number: nPusto
.head 3 -  !
.head 3 -  Number: nmId[*]
.head 3 -  Number: nmDataId[*]
.head 3 -  Number: nmClientId[*]
.head 3 -  String: smStateCode[*]
.head 3 -  String: smClientName[*]
.head 3 -  String: smMainAccCode[*]
.head 3 -  String: smCommentO[*]
.head 3 -  !
.head 3 -  File Handle: hFbad
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set sFilters[0] = 'TXT files'
.head 4 -  Set sFilters[1] = '*.txt'
.head 4 -  Set sFilters[2] = 'ALL files'
.head 4 -  Set sFilters[3] = '*.*'
.head 4 -  Set nFilters = 4
.head 4 -  Set nIndex = 1
.head 4 -  Set nStat = -1
.head 4 +  If GetLang() = 'UKR'
.head 5 -  Call SalSetWindowText(hWndForm, 'Зміни по вкладах РОДОВІД')
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  ! Set frm_UpdRODO.strFilterTblName = 'S6_RODOUPD'
.head 4 -  Set nFlags = GT_NoRet | GT_NoIns | GT_NoDel | GT_NoUpd
.head 4 -  Call SalHideWindow(pbIns)
.head 4 -  Call SalHideWindow(pbDel)
.head 4 -  Call SalHideWindow(pbRefresh)
.head 4 -  Call SalHideWindow(pbUpdate)
.head 4 -  Call SalHideWindow(pbSearch)
.head 4 -  Call SalHideWindow(pbFilter)
.head 4 -  Call SalHideWindow(pbPrint)
.head 4 -  Call SalDisableWindow(pbDetails)
.head 4 -  Call SalDisableWindow(pbView)
.head 4 -  Call SalDisableWindow(pbExtProt)
.head 4 -  Set n01 = 0
.head 4 -  Set bNofin = TRUE
.head 4 -  Set bSortOrd = TRUE
.head 4 -  Set sSqlPopulate = "
    SELECT l.Id            ,l.DataId        ,l.ClientId      ,
           l.StateCode     ,l.ClientName    ,l.Birthday      ,
           l.BirthPlace    ,l.Resident      ,l.KodObl        ,
           l.WorkPlace     ,l.ADDRESS_INDEX ,l.ADDRESS_OBL   ,
           l.ADDRESS_REG   ,l.ADDRESS_CITY  ,l.ADDRESS_STR   ,
           l.ADDRESS_HS    ,l.ADDRESS_APP   ,l.K040          ,
           l.PhoneContact  ,l.PhoneHome     ,l.MOBILE_PHONE  ,
           l.Passport_Type ,l.Passport_S    ,l.Passport_Num  ,
           l.Passport_Place,l.Passport_Date ,l.K013          ,
           l.K015          ,l.Last_Ident    ,l.Email         ,
           l.K080          ,l.K050          ,l.K070          ,
           l.Marital_Status,l.ChildrenCount ,l.TreatyId      ,
           l.BranchCode    ,l.BranchName    ,l.BranchAddress ,
           l.Code          ,l.OrgDate       ,l.EndDate       ,
           l.PercentCur    ,l.PercentBreak  ,l.ProductCode   ,
           l.ProductName   ,l.CurrencyTag   ,l.CrncyAmount   ,
           l.MainAccId     ,l.MainAccCode   ,l.MainAccRest   ,
           l.MainAccR013   ,l.MainAccR011   ,l.PercAccId     ,
           l.PercAccCode   ,l.PercAccRest   ,l.PercAccR013   ,
           l.PercAccR011   ,l.PercentPay    ,l.PercentCap    ,
           l.CapAccCode    ,l.CalcDateInto  ,l.BRANCHKODOBL  ,
           l.TYPEDOCDKFM   ,l.NAMEDOCDKFM   ,l.CODEUPB       ,
           l.MAINACCCODEUPB,
           m.Id            ,m.DataId        ,m.ClientId      ,
           m.StateCode     ,m.ClientName    ,m.Birthday      ,
           m.BirthPlace    ,m.Resident      ,m.KodObl        ,
           m.WorkPlace     ,m.ADDRESS_INDEX ,m.ADDRESS_OBL   ,
           m.ADDRESS_REG   ,m.ADDRESS_CITY  ,m.ADDRESS_STR   ,
           m.ADDRESS_HS    ,m.ADDRESS_APP   ,m.K040          ,
           m.PhoneContact  ,m.PhoneHome     ,m.MOBILE_PHONE  ,
           m.Passport_Type ,m.Passport_S    ,m.Passport_Num  ,
           m.Passport_Place,m.Passport_Date ,m.K013          ,
           m.K015          ,m.Last_Ident    ,m.Email         ,
           m.K080          ,m.K050          ,m.K070          ,
           m.Marital_Status,m.ChildrenCount ,m.TreatyId      ,
           m.BranchCode    ,m.BranchName    ,m.BranchAddress ,
           m.Code          ,m.OrgDate       ,m.EndDate       ,
           m.PercentCur    ,m.PercentBreak  ,m.ProductCode   ,
           m.ProductName   ,m.CurrencyTag   ,m.CrncyAmount   ,
           m.MainAccId     ,m.MainAccCode   ,m.MainAccRest   ,
           m.MainAccR013   ,m.MainAccR011   ,m.PercAccId     ,
           m.PercAccCode   ,m.PercAccRest   ,m.PercAccR013   ,
           m.PercAccR011   ,m.PercentPay    ,m.PercentCap    ,
           m.CapAccCode    ,m.CalcDateInto  ,m.BRANCHKODOBL  ,
           m.TYPEDOCDKFM   ,m.NAMEDOCDKFM   ,m.CODEUPB       ,
           m.MAINACCCODEUPB
    INTO   :frm_UpdRODO.colId            ,:frm_UpdRODO.colDataId        ,:frm_UpdRODO.colClientId      ,
           :frm_UpdRODO.colStateCode     ,:frm_UpdRODO.colClientName    ,:frm_UpdRODO.colBirthday      ,
           :frm_UpdRODO.colBirthPlace    ,:frm_UpdRODO.colResident      ,:frm_UpdRODO.colKodObl        ,
           :frm_UpdRODO.colWorkPlace     ,:frm_UpdRODO.colADDRESS_INDEX ,:frm_UpdRODO.colADDRESS_OBL   ,
           :frm_UpdRODO.colADDRESS_REG   ,:frm_UpdRODO.colADDRESS_CITY  ,:frm_UpdRODO.colADDRESS_STR   ,
           :frm_UpdRODO.colADDRESS_HS    ,:frm_UpdRODO.colADDRESS_APP   ,:frm_UpdRODO.colK040          ,
           :frm_UpdRODO.colPhoneContact  ,:frm_UpdRODO.colPhoneHome     ,:frm_UpdRODO.colMOBILE_PHONE  ,
           :frm_UpdRODO.colPassport_Type ,:frm_UpdRODO.colPassport_S    ,:frm_UpdRODO.colPassport_Num  ,
           :frm_UpdRODO.colPassport_Place,:frm_UpdRODO.colPassport_Date ,:frm_UpdRODO.colK013          ,
           :frm_UpdRODO.colK015          ,:frm_UpdRODO.colLast_Ident    ,:frm_UpdRODO.colEmail         ,
           :frm_UpdRODO.colK080          ,:frm_UpdRODO.colK050          ,:frm_UpdRODO.colK070          ,
           :frm_UpdRODO.colMarital_Status,:frm_UpdRODO.colChildrenCount ,:frm_UpdRODO.colTreatyId      ,
           :frm_UpdRODO.colBranchCode    ,:frm_UpdRODO.colBranchName    ,:frm_UpdRODO.colBranchAddress ,
           :frm_UpdRODO.colCode          ,:frm_UpdRODO.colOrgDate       ,:frm_UpdRODO.colEndDate       ,
           :frm_UpdRODO.colPercentCur    ,:frm_UpdRODO.colPercentBreak  ,:frm_UpdRODO.colProductCode   ,
           :frm_UpdRODO.colProductName   ,:frm_UpdRODO.colCurrencyTag   ,:frm_UpdRODO.colCrncyAmount   ,
           :frm_UpdRODO.colMainAccId     ,:frm_UpdRODO.colMainAccCode   ,:frm_UpdRODO.colMainAccRest   ,
           :frm_UpdRODO.colMainAccR013   ,:frm_UpdRODO.colMainAccR011   ,:frm_UpdRODO.colPercAccId     ,
           :frm_UpdRODO.colPercAccCode   ,:frm_UpdRODO.colPercAccRest   ,:frm_UpdRODO.colPercAccR013   ,
           :frm_UpdRODO.colPercAccR011   ,:frm_UpdRODO.colPercentPay    ,:frm_UpdRODO.colPercentCap    ,
           :frm_UpdRODO.colCapAccCode    ,:frm_UpdRODO.colCalcDateInto  ,:frm_UpdRODO.colBRANCHKODOBL  ,
           :frm_UpdRODO.colTYPEDOCDKFM   ,:frm_UpdRODO.colNAMEDOCDKFM   ,:frm_UpdRODO.colCODEUPB       ,
           :frm_UpdRODO.colMAINACCCODEUPB,
           :frm_UpdRODO.comId            ,:frm_UpdRODO.comDataId        ,:frm_UpdRODO.comClientId      ,
           :frm_UpdRODO.comStateCode     ,:frm_UpdRODO.comClientName    ,:frm_UpdRODO.comBirthday      ,
           :frm_UpdRODO.comBirthPlace    ,:frm_UpdRODO.comResident      ,:frm_UpdRODO.comKodObl        ,
           :frm_UpdRODO.comWorkPlace     ,:frm_UpdRODO.comADDRESS_INDEX ,:frm_UpdRODO.comADDRESS_OBL   ,
           :frm_UpdRODO.comADDRESS_REG   ,:frm_UpdRODO.comADDRESS_CITY  ,:frm_UpdRODO.comADDRESS_STR   ,
           :frm_UpdRODO.comADDRESS_HS    ,:frm_UpdRODO.comADDRESS_APP   ,:frm_UpdRODO.comK040          ,
           :frm_UpdRODO.comPhoneContact  ,:frm_UpdRODO.comPhoneHome     ,:frm_UpdRODO.comMOBILE_PHONE  ,
           :frm_UpdRODO.comPassport_Type ,:frm_UpdRODO.comPassport_S    ,:frm_UpdRODO.comPassport_Num  ,
           :frm_UpdRODO.comPassport_Place,:frm_UpdRODO.comPassport_Date ,:frm_UpdRODO.comK013          ,
           :frm_UpdRODO.comK015          ,:frm_UpdRODO.comLast_Ident    ,:frm_UpdRODO.comEmail         ,
           :frm_UpdRODO.comK080          ,:frm_UpdRODO.comK050          ,:frm_UpdRODO.comK070          ,
           :frm_UpdRODO.comMarital_Status,:frm_UpdRODO.comChildrenCount ,:frm_UpdRODO.comTreatyId      ,
           :frm_UpdRODO.comBranchCode    ,:frm_UpdRODO.comBranchName    ,:frm_UpdRODO.comBranchAddress ,
           :frm_UpdRODO.comCode          ,:frm_UpdRODO.comOrgDate       ,:frm_UpdRODO.comEndDate       ,
           :frm_UpdRODO.comPercentCur    ,:frm_UpdRODO.comPercentBreak  ,:frm_UpdRODO.comProductCode   ,
           :frm_UpdRODO.comProductName   ,:frm_UpdRODO.comCurrencyTag   ,:frm_UpdRODO.comCrncyAmount   ,
           :frm_UpdRODO.comMainAccId     ,:frm_UpdRODO.comMainAccCode   ,:frm_UpdRODO.comMainAccRest   ,
           :frm_UpdRODO.comMainAccR013   ,:frm_UpdRODO.comMainAccR011   ,:frm_UpdRODO.comPercAccId     ,
           :frm_UpdRODO.comPercAccCode   ,:frm_UpdRODO.comPercAccRest   ,:frm_UpdRODO.comPercAccR013   ,
           :frm_UpdRODO.comPercAccR011   ,:frm_UpdRODO.comPercentPay    ,:frm_UpdRODO.comPercentCap    ,
           :frm_UpdRODO.comCapAccCode    ,:frm_UpdRODO.comCalcDateInto  ,:frm_UpdRODO.comBRANCHKODOBL  ,
           :frm_UpdRODO.comTYPEDOCDKFM   ,:frm_UpdRODO.comNAMEDOCDKFM   ,:frm_UpdRODO.comCODEUPB       ,
           :frm_UpdRODO.comMAINACCCODEUPB
    FROM   s6_rodoupd l, s6_rodovid m
    WHERE  m.mainacccode=l.mainacccode
    ORDER BY 1"
.head 4 -  ! Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call SalDisableWindow(pbRunUpdate)
.head 4 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
.head 4 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set frm_UpdRODO.colSOS = -1
.head 4 +  If frm_UpdRODO.colStateCode      != frm_UpdRODO.comStateCode      or
   frm_UpdRODO.colClientName     != frm_UpdRODO.comClientName     or
   frm_UpdRODO.colBirthday       != frm_UpdRODO.comBirthday       or
   frm_UpdRODO.colBirthPlace     != frm_UpdRODO.comBirthPlace     or
   frm_UpdRODO.colADDRESS_INDEX  != frm_UpdRODO.comADDRESS_INDEX  or
   frm_UpdRODO.colADDRESS_OBL    != frm_UpdRODO.comADDRESS_OBL    or
   frm_UpdRODO.colADDRESS_REG    != frm_UpdRODO.comADDRESS_REG    or
   frm_UpdRODO.colADDRESS_CITY   != frm_UpdRODO.comADDRESS_CITY   or
   frm_UpdRODO.colADDRESS_STR    != frm_UpdRODO.comADDRESS_STR    or
   frm_UpdRODO.colADDRESS_HS     != frm_UpdRODO.comADDRESS_HS     or
   frm_UpdRODO.colADDRESS_APP    != frm_UpdRODO.comADDRESS_APP    or
   frm_UpdRODO.colK040           != frm_UpdRODO.comK040           or
   frm_UpdRODO.colPhoneContact   != frm_UpdRODO.comPhoneContact   or
   frm_UpdRODO.colPhoneHome      != frm_UpdRODO.comPhoneHome      or
   frm_UpdRODO.colMOBILE_PHONE   != frm_UpdRODO.comMOBILE_PHONE   or
   frm_UpdRODO.colPassport_S     != frm_UpdRODO.comPassport_S     or
   frm_UpdRODO.colPassport_Num   != frm_UpdRODO.comPassport_Num   or
   frm_UpdRODO.colPassport_Place != frm_UpdRODO.comPassport_Place or
   frm_UpdRODO.colPassport_Date  != frm_UpdRODO.comPassport_Date  or
   frm_UpdRODO.colLast_Ident     != frm_UpdRODO.comLast_Ident     or
   frm_UpdRODO.colEmail          != frm_UpdRODO.comEmail          or
   frm_UpdRODO.colMarital_Status != frm_UpdRODO.comMarital_Status or
   frm_UpdRODO.colChildrenCount  != frm_UpdRODO.comChildrenCount  or
   frm_UpdRODO.colTreatyId       != frm_UpdRODO.comTreatyId       or
   frm_UpdRODO.colCode           != frm_UpdRODO.comCode           or
   frm_UpdRODO.colOrgDate        != frm_UpdRODO.comOrgDate        or
   frm_UpdRODO.colTYPEDOCDKFM    != frm_UpdRODO.comTYPEDOCDKFM    or
   frm_UpdRODO.colMAINACCCODEUPB != frm_UpdRODO.comMAINACCCODEUPB
.head 5 -  ! покрасить 1 (изменение анкетных данных)
.head 5 +  If frm_UpdRODO.colStateCode  != frm_UpdRODO.comStateCode or frm_UpdRODO.colClientName != frm_UpdRODO.comClientName
.head 6 -  Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_Sky)
.head 5 +  Else
.head 6 -  Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_LightGreen)
.head 5 -  Set frm_UpdRODO.colSOS = 0
.head 5 +  If nStat = -1
.head 6 -  Set nStat = 0
.head 6 -  Set bNofin = TRUE
.head 4 -  !
.head 4 +  If frm_UpdRODO.colEndDate     != frm_UpdRODO.comEndDate     or
   frm_UpdRODO.colPercentCur  != frm_UpdRODO.comPercentCur  or
   frm_UpdRODO.colCurrencyTag != frm_UpdRODO.comCurrencyTag or
   frm_UpdRODO.colCrncyAmount != frm_UpdRODO.comCrncyAmount or
   frm_UpdRODO.colMainAccRest != frm_UpdRODO.comMainAccRest or
   frm_UpdRODO.colPercAccCode != frm_UpdRODO.comPercAccCode or
   frm_UpdRODO.colPercAccRest != frm_UpdRODO.comPercAccRest
.head 5 -  ! покрасить 2 (изменение финансовых реквизитов)
.head 5 -  Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_Orchid)
.head 5 -  Set bNofin = FALSE
.head 5 -  Set nStat = 1
.head 5 -  Set frm_UpdRODO.colSOS = 1
.head 5 -  Set nStrFinD = nStrFinD + 1
.head 5 -  Call SalDisableWindow(pbRunUpdate)
.head 4 -  !
.head 4 +  If frm_UpdRODO.colSOS != 1
.head 5 -  If SqlPrepareAndExecute(hSqlAux(), "
   SELECT o.sos
   INTO   :frm_UpdRODO.colSOS
   FROM   oper o, dpt_payments d, dpt_rodovid r
   WHERE  r.mainacccode=:frm_UpdRODO.comMainAccCode and d.dpt_id=r.dptid and o.ref=d.ref and o.sos>1 and
          o.tt='DPR'") and SqlFetchNext(hSqlAux(), nFetchRes)
.head 5 +  If frm_UpdRODO.colSOS = 5
.head 6 -  ! покрасить 3 (уже была выплата)
.head 6 -  ! Set bNofin = FALSE
.head 6 -  Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_Yellow)
.head 6 -  Set nUgoPay = nUgoPay + 1
.head 4 -  !
.head 4 -  If SqlPrepareAndExecute(hSqlAux(), "
   SELECT r.dptid,d.rnk
   INTO   :frm_UpdRODO.colDPTID,:frm_UpdRODO.colRNK
   FROM   dpt_rodovid r, dpt_deposit d
   WHERE  r.mainacccode=:frm_UpdRODO.comMainAccCode and r.dptid=d.deposit_id") and SqlFetchNext(hSqlAux(), nFetchRes)
.head 4 -  !
.head 4 -  ! сделать преварительный анализ ВСЕВОЗМОЖНЫХ расхождений с записью в необходимые таблицы
.head 4 -  Set nAllLines = nAllLines + 1
.head 4 +  If frm_UpdRODO.colSOS = - 1
.head 5 -  Set nNotDiff = nNotDiff + 1
.head 4 +  Else
.head 5 +  If frm_UpdRODO.colSOS = 0 or frm_UpdRODO.colSOS = 5
.head 6 +  If frm_UpdRODO.colStateCode      != frm_UpdRODO.comStateCode
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'StateCode', frm_UpdRODO.colStateCode, frm_UpdRODO.comStateCode, sNote)
.head 6 +  If frm_UpdRODO.colClientName     != frm_UpdRODO.comClientName
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'ClientName', frm_UpdRODO.colClientName, frm_UpdRODO.comClientName, sNote)
.head 6 +  If frm_UpdRODO.colBirthday       != frm_UpdRODO.comBirthday
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'Birthday', frm_UpdRODO.colBirthday, frm_UpdRODO.comBirthday, sNote)
.head 6 +  If frm_UpdRODO.colBirthPlace     != frm_UpdRODO.comBirthPlace
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'BirthPlace', frm_UpdRODO.colBirthPlace, frm_UpdRODO.comBirthPlace, sNote)
.head 6 +  If frm_UpdRODO.colADDRESS_INDEX  != frm_UpdRODO.comADDRESS_INDEX
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'ADDRESS_INDEX', frm_UpdRODO.colADDRESS_INDEX, frm_UpdRODO.comADDRESS_INDEX, sNote)
.head 6 +  If frm_UpdRODO.colADDRESS_OBL    != frm_UpdRODO.comADDRESS_OBL
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'ADDRESS_OBL', frm_UpdRODO.colADDRESS_OBL, frm_UpdRODO.comADDRESS_OBL, sNote)
.head 6 +  If frm_UpdRODO.colADDRESS_REG    != frm_UpdRODO.comADDRESS_REG
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'ADDRESS_REG', frm_UpdRODO.colADDRESS_REG, frm_UpdRODO.comADDRESS_REG, sNote)
.head 6 +  If frm_UpdRODO.colADDRESS_CITY   != frm_UpdRODO.comADDRESS_CITY
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'ADDRESS_CITY', frm_UpdRODO.colADDRESS_CITY, frm_UpdRODO.comADDRESS_CITY, sNote)
.head 6 +  If frm_UpdRODO.colADDRESS_STR    != frm_UpdRODO.comADDRESS_STR
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'ADDRESS_STR', frm_UpdRODO.colADDRESS_STR, frm_UpdRODO.comADDRESS_STR, sNote)
.head 6 +  If frm_UpdRODO.colADDRESS_HS     != frm_UpdRODO.comADDRESS_HS
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'ADDRESS_HS', frm_UpdRODO.colADDRESS_HS, frm_UpdRODO.comADDRESS_HS, sNote)
.head 6 +  If frm_UpdRODO.colADDRESS_APP    != frm_UpdRODO.comADDRESS_APP
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'ADDRESS_APP', frm_UpdRODO.colADDRESS_APP, frm_UpdRODO.comADDRESS_APP, sNote)
.head 6 +  If frm_UpdRODO.colK040           != frm_UpdRODO.comK040
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'K040', frm_UpdRODO.colK040, frm_UpdRODO.comK040, sNote)
.head 6 +  If frm_UpdRODO.colPhoneContact   != frm_UpdRODO.comPhoneContact
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'PhoneContact', frm_UpdRODO.colPhoneContact, frm_UpdRODO.comPhoneContact, sNote)
.head 6 +  If frm_UpdRODO.colPhoneHome      != frm_UpdRODO.comPhoneHome
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'PhoneHom', frm_UpdRODO.colPhoneHome, frm_UpdRODO.comPhoneHome, sNote)
.head 6 +  If frm_UpdRODO.colMOBILE_PHONE   != frm_UpdRODO.comMOBILE_PHONE
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'MOBILE_PHONE', frm_UpdRODO.colMOBILE_PHONE, frm_UpdRODO.comMOBILE_PHONE, sNote)
.head 6 +  If frm_UpdRODO.colPassport_S     != frm_UpdRODO.comPassport_S
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'Passport_S', frm_UpdRODO.colPassport_S, frm_UpdRODO.comPassport_S, sNote)
.head 6 +  If frm_UpdRODO.colPassport_Num   != frm_UpdRODO.comPassport_Num
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'Passport_Num', frm_UpdRODO.colPassport_Num, frm_UpdRODO.comPassport_Num, sNote)
.head 6 +  If frm_UpdRODO.colPassport_Place != frm_UpdRODO.comPassport_Place
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'Passport_Place', frm_UpdRODO.colPassport_Place, frm_UpdRODO.comPassport_Place, sNote)
.head 6 +  If frm_UpdRODO.colPassport_Date  != frm_UpdRODO.comPassport_Date
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'Passport_Date', frm_UpdRODO.colPassport_Date, frm_UpdRODO.comPassport_Date, sNote)
.head 6 +  If frm_UpdRODO.colLast_Ident     != frm_UpdRODO.comLast_Ident
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'Last_Ident', frm_UpdRODO.colLast_Ident, frm_UpdRODO.comLast_Ident, sNote)
.head 6 +  If frm_UpdRODO.colEmail          != frm_UpdRODO.comEmail
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'Email', frm_UpdRODO.colEmail, frm_UpdRODO.comEmail, sNote)
.head 6 +  If frm_UpdRODO.colMarital_Status != frm_UpdRODO.comMarital_Status
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'Marital_Status', frm_UpdRODO.colMarital_Status, frm_UpdRODO.comMarital_Status, sNote)
.head 6 +  If frm_UpdRODO.colChildrenCount  != frm_UpdRODO.comChildrenCount
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'ChildrenCount', Str(frm_UpdRODO.colChildrenCount), Str(frm_UpdRODO.comChildrenCount), sNote)
.head 6 +  If frm_UpdRODO.colTreatyId       != frm_UpdRODO.comTreatyId
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'TreatyId', Str(frm_UpdRODO.colTreatyId), Str(frm_UpdRODO.comTreatyId), sNote)
.head 6 +  If frm_UpdRODO.colCode           != frm_UpdRODO.comCode
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'Code', frm_UpdRODO.colCode, frm_UpdRODO.comCode, sNote)
.head 6 +  If frm_UpdRODO.colOrgDate        != frm_UpdRODO.comOrgDate
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'OrgDate', frm_UpdRODO.colOrgDate, frm_UpdRODO.comOrgDate, sNote)
.head 6 +  If frm_UpdRODO.colTYPEDOCDKFM    != frm_UpdRODO.comTYPEDOCDKFM
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'TYPEDOCDKFM', frm_UpdRODO.colTYPEDOCDKFM, frm_UpdRODO.comTYPEDOCDKFM, sNote)
.head 6 +  If frm_UpdRODO.colMAINACCCODEUPB != frm_UpdRODO.comMAINACCCODEUPB
.head 7 -  Set nAnkDiff = nAnkDiff + IifN(frm_UpdRODO.colSOS=0, 1, 0)
.head 7 -  Set sNote = 'Изменение ' || IifS(frm_UpdRODO.colSOS=0, 'возможно', 'НЕвозможно (была выплата по вкладу)')
.head 7 -  Call ToRodofiles(0, 'MAINACCCODEUPB', frm_UpdRODO.colMAINACCCODEUPB, frm_UpdRODO.comMAINACCCODEUPB, sNote)
.head 5 +  Else If frm_UpdRODO.colSOS = 1
.head 6 +  If frm_UpdRODO.colStateCode      != frm_UpdRODO.comStateCode
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'StateCode', frm_UpdRODO.colStateCode, frm_UpdRODO.comStateCode, sNote)
.head 6 +  If frm_UpdRODO.colClientName     != frm_UpdRODO.comClientName
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'ClientName', frm_UpdRODO.colClientName, frm_UpdRODO.comClientName, sNote)
.head 6 +  If frm_UpdRODO.colBirthday       != frm_UpdRODO.comBirthday
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'Birthday', frm_UpdRODO.colBirthday, frm_UpdRODO.comBirthday, sNote)
.head 6 +  If frm_UpdRODO.colBirthPlace     != frm_UpdRODO.comBirthPlace
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'BirthPlace', frm_UpdRODO.colBirthPlace, frm_UpdRODO.comBirthPlace, sNote)
.head 6 +  If frm_UpdRODO.colADDRESS_INDEX  != frm_UpdRODO.comADDRESS_INDEX
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'ADDRESS_INDEX', frm_UpdRODO.colADDRESS_INDEX, frm_UpdRODO.comADDRESS_INDEX, sNote)
.head 6 +  If frm_UpdRODO.colADDRESS_OBL    != frm_UpdRODO.comADDRESS_OBL
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'ADDRESS_OBL', frm_UpdRODO.colADDRESS_OBL, frm_UpdRODO.comADDRESS_OBL, sNote)
.head 6 +  If frm_UpdRODO.colADDRESS_REG    != frm_UpdRODO.comADDRESS_REG
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'ADDRESS_REG', frm_UpdRODO.colADDRESS_REG, frm_UpdRODO.comADDRESS_REG, sNote)
.head 6 +  If frm_UpdRODO.colADDRESS_CITY   != frm_UpdRODO.comADDRESS_CITY
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'ADDRESS_CITY', frm_UpdRODO.colADDRESS_CITY, frm_UpdRODO.comADDRESS_CITY, sNote)
.head 6 +  If frm_UpdRODO.colADDRESS_STR    != frm_UpdRODO.comADDRESS_STR
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'ADDRESS_STR', frm_UpdRODO.colADDRESS_STR, frm_UpdRODO.comADDRESS_STR, sNote)
.head 6 +  If frm_UpdRODO.colADDRESS_HS     != frm_UpdRODO.comADDRESS_HS
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'ADDRESS_HS', frm_UpdRODO.colADDRESS_HS, frm_UpdRODO.comADDRESS_HS, sNote)
.head 6 +  If frm_UpdRODO.colADDRESS_APP    != frm_UpdRODO.comADDRESS_APP
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'ADDRESS_APP', frm_UpdRODO.colADDRESS_APP, frm_UpdRODO.comADDRESS_APP, sNote)
.head 6 +  If frm_UpdRODO.colK040           != frm_UpdRODO.comK040
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'K040', frm_UpdRODO.colK040, frm_UpdRODO.comK040, sNote)
.head 6 +  If frm_UpdRODO.colPhoneContact   != frm_UpdRODO.comPhoneContact
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'PhoneContact', frm_UpdRODO.colPhoneContact, frm_UpdRODO.comPhoneContact, sNote)
.head 6 +  If frm_UpdRODO.colPhoneHome      != frm_UpdRODO.comPhoneHome
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'PhoneHom', frm_UpdRODO.colPhoneHome, frm_UpdRODO.comPhoneHome, sNote)
.head 6 +  If frm_UpdRODO.colMOBILE_PHONE   != frm_UpdRODO.comMOBILE_PHONE
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'MOBILE_PHONE', frm_UpdRODO.colMOBILE_PHONE, frm_UpdRODO.comMOBILE_PHONE, sNote)
.head 6 +  If frm_UpdRODO.colPassport_S     != frm_UpdRODO.comPassport_S
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'Passport_S', frm_UpdRODO.colPassport_S, frm_UpdRODO.comPassport_S, sNote)
.head 6 +  If frm_UpdRODO.colPassport_Num   != frm_UpdRODO.comPassport_Num
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'Passport_Num', frm_UpdRODO.colPassport_Num, frm_UpdRODO.comPassport_Num, sNote)
.head 6 +  If frm_UpdRODO.colPassport_Place != frm_UpdRODO.comPassport_Place
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'Passport_Place', frm_UpdRODO.colPassport_Place, frm_UpdRODO.comPassport_Place, sNote)
.head 6 +  If frm_UpdRODO.colPassport_Date  != frm_UpdRODO.comPassport_Date
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'Passport_Date', frm_UpdRODO.colPassport_Date, frm_UpdRODO.comPassport_Date, sNote)
.head 6 +  If frm_UpdRODO.colLast_Ident     != frm_UpdRODO.comLast_Ident
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'Last_Ident', frm_UpdRODO.colLast_Ident, frm_UpdRODO.comLast_Ident, sNote)
.head 6 +  If frm_UpdRODO.colEmail          != frm_UpdRODO.comEmail
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'Email', frm_UpdRODO.colEmail, frm_UpdRODO.comEmail, sNote)
.head 6 +  If frm_UpdRODO.colMarital_Status != frm_UpdRODO.comMarital_Status
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'Marital_Status', frm_UpdRODO.colMarital_Status, frm_UpdRODO.comMarital_Status, sNote)
.head 6 +  If frm_UpdRODO.colChildrenCount  != frm_UpdRODO.comChildrenCount
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'ChildrenCount', Str(frm_UpdRODO.colChildrenCount), Str(frm_UpdRODO.comChildrenCount), sNote)
.head 6 +  If frm_UpdRODO.colTreatyId       != frm_UpdRODO.comTreatyId
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'TreatyId', Str(frm_UpdRODO.colTreatyId), Str(frm_UpdRODO.comTreatyId), sNote)
.head 6 +  If frm_UpdRODO.colCode           != frm_UpdRODO.comCode
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'Code', frm_UpdRODO.colCode, frm_UpdRODO.comCode, sNote)
.head 6 +  If frm_UpdRODO.colOrgDate        != frm_UpdRODO.comOrgDate
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'OrgDate', frm_UpdRODO.colOrgDate, frm_UpdRODO.comOrgDate, sNote)
.head 6 +  If frm_UpdRODO.colTYPEDOCDKFM    != frm_UpdRODO.comTYPEDOCDKFM
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'TYPEDOCDKFM', frm_UpdRODO.colTYPEDOCDKFM, frm_UpdRODO.comTYPEDOCDKFM, sNote)
.head 6 +  If frm_UpdRODO.colMAINACCCODEUPB != frm_UpdRODO.comMAINACCCODEUPB
.head 7 -  Set sNote = 'Изменение НЕвозможно (в строке есть изменение финансовых реквизитов)'
.head 7 -  Call ToRodofiles(0, 'MAINACCCODEUPB', frm_UpdRODO.colMAINACCCODEUPB, frm_UpdRODO.comMAINACCCODEUPB, sNote)
.head 6 +  If frm_UpdRODO.colEndDate        != frm_UpdRODO.comEndDate
.head 7 -  Set sNote = 'Изменение НЕвозможно (финансовый реквизит)'
.head 7 -  Call ToRodofiles(0, 'EndDate', frm_UpdRODO.colEndDate, frm_UpdRODO.comEndDate, sNote)
.head 6 +  If frm_UpdRODO.colPercentCur     != frm_UpdRODO.comPercentCur
.head 7 -  Set sNote = 'Изменение НЕвозможно (финансовый реквизит)'
.head 7 -  Call ToRodofiles(0, 'PercentCur', Str(frm_UpdRODO.colPercentCur), Str(frm_UpdRODO.comPercentCur), sNote)
.head 6 +  If frm_UpdRODO.colCurrencyTag    != frm_UpdRODO.comCurrencyTag
.head 7 -  Set sNote = 'Изменение НЕвозможно (финансовый реквизит)'
.head 7 -  Call ToRodofiles(0, 'CurrencyTag', frm_UpdRODO.colCurrencyTag, frm_UpdRODO.comCurrencyTag, sNote)
.head 6 +  If frm_UpdRODO.colCrncyAmount    != frm_UpdRODO.comCrncyAmount
.head 7 -  Set sNote = 'Изменение НЕвозможно (финансовый реквизит)'
.head 7 -  Call ToRodofiles(0, 'CrncyAmount', Str(frm_UpdRODO.colCrncyAmount), Str(frm_UpdRODO.comCrncyAmount), sNote)
.head 6 +  If frm_UpdRODO.colMainAccRest    != frm_UpdRODO.comMainAccRest
.head 7 -  Set sNote = 'Изменение НЕвозможно (финансовый реквизит)'
.head 7 -  Call ToRodofiles(0, 'MainAccRest', Str(frm_UpdRODO.colMainAccRest), Str(frm_UpdRODO.comMainAccRest), sNote)
.head 6 +  If frm_UpdRODO.colPercAccCode    != frm_UpdRODO.comPercAccCode
.head 7 -  Set sNote = 'Изменение НЕвозможно (финансовый реквизит)'
.head 7 -  Call ToRodofiles(0, 'PercAccCode', frm_UpdRODO.colPercAccCode, frm_UpdRODO.comPercAccCode, sNote)
.head 6 +  If frm_UpdRODO.colPercAccRest    != frm_UpdRODO.comPercAccRest
.head 7 -  Set sNote = 'Изменение НЕвозможно (финансовый реквизит)'
.head 7 -  Call ToRodofiles(0, 'PercAccRest', Str(frm_UpdRODO.colPercAccRest), Str(frm_UpdRODO.comPercAccRest), sNote)
.head 5 -  ! подсчёт ВСЕХ расхождений в строке
.head 5 -  Set frm_UpdRODO.NumDiff = 0
.head 5 +  If frm_UpdRODO.colStateCode      != frm_UpdRODO.comStateCode
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colClientName     != frm_UpdRODO.comClientName
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colBirthday       != frm_UpdRODO.comBirthday
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colBirthPlace     != frm_UpdRODO.comBirthPlace
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colADDRESS_INDEX  != frm_UpdRODO.comADDRESS_INDEX
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colADDRESS_OBL    != frm_UpdRODO.comADDRESS_OBL
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colADDRESS_REG    != frm_UpdRODO.comADDRESS_REG
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colADDRESS_CITY   != frm_UpdRODO.comADDRESS_CITY
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colADDRESS_STR    != frm_UpdRODO.comADDRESS_STR
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colADDRESS_HS     != frm_UpdRODO.comADDRESS_HS
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colADDRESS_APP    != frm_UpdRODO.comADDRESS_APP
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colK040           != frm_UpdRODO.comK040
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colPhoneContact   != frm_UpdRODO.comPhoneContact
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colPhoneHome      != frm_UpdRODO.comPhoneHome
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colMOBILE_PHONE   != frm_UpdRODO.comMOBILE_PHONE
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colPassport_S     != frm_UpdRODO.comPassport_S
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colPassport_Num   != frm_UpdRODO.comPassport_Num
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colPassport_Place != frm_UpdRODO.comPassport_Place
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colPassport_Date  != frm_UpdRODO.comPassport_Date
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colLast_Ident     != frm_UpdRODO.comLast_Ident
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colEmail          != frm_UpdRODO.comEmail
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colMarital_Status != frm_UpdRODO.comMarital_Status
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colChildrenCount  != frm_UpdRODO.comChildrenCount
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colTreatyId       != frm_UpdRODO.comTreatyId
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colCode           != frm_UpdRODO.comCode
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colOrgDate        != frm_UpdRODO.comOrgDate
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colTYPEDOCDKFM    != frm_UpdRODO.comTYPEDOCDKFM
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colMAINACCCODEUPB != frm_UpdRODO.comMAINACCCODEUPB
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colEndDate        != frm_UpdRODO.comEndDate
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colPercentCur     != frm_UpdRODO.comPercentCur
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colCurrencyTag    != frm_UpdRODO.comCurrencyTag
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colCrncyAmount    != frm_UpdRODO.comCrncyAmount
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colMainAccRest    != frm_UpdRODO.comMainAccRest
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colPercAccCode    != frm_UpdRODO.comPercAccCode
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 5 +  If frm_UpdRODO.colPercAccRest    != frm_UpdRODO.comPercAccRest
.head 6 -  Set frm_UpdRODO.NumDiff = frm_UpdRODO.NumDiff + 1
.head 3 +  ! On UM_Populate
.head 4 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 4 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 4 -  Call SalTblSetContext(hWndForm, 0)
.head 4 -  Call SalTblSetFocusRow(hWndForm, 0)
.head 4 -  Call SalTblSetRowFlags(hWndForm, 0, ROW_Selected, TRUE)
.head 3 +  On WM_NCMouseMove
.head 4 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalSendMsg(pbDetails, SAM_Click, 0, 0)
.head 3 +  On SAM_Destroy
.head 4 -  ! Call SalTimerKill(hWndForm, 1)
.head 4 -  Call SalSendClassMessage(SAM_Destroy, 0, 0)
.head 1 +  Dialog Box: document
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Текущий документ
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.513"
.head 4 -  Top:    -0.021"
.head 4 -  Width:  9.343"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.5"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Arial Cyr
.head 3 -  Font Size: 10
.head 3 -  Font Enhancement: Bold-Italic
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: показ документа
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.262"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: dftitle
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.586"
.head 6 -  Top:    0.092"
.head 6 -  Width:  5.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: №
.head 4 -  Resource Id: 53675
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.886"
.head 5 -  Top:    0.092"
.head 5 -  Width:  0.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   6.186"
.head 6 -  Top:    0.092"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfDATA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.586"
.head 6 -  Top:    0.344"
.head 6 -  Width:  1.283"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: dd/MM/yyyy
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Платник -
.head 4 -  Resource Id: 53676
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.086"
.head 5 -  Top:    0.76"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: 3D Face Color
.head 3 +  Data Field: dfNAMA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.286"
.head 6 -  Top:    0.76"
.head 6 -  Width:  4.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Банк платника
.head 4 -  Resource Id: 53677
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.086"
.head 5 -  Top:    1.177"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: 3D Face Color
.head 3 +  Data Field: dfBANKA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    1.344"
.head 6 -  Width:  3.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Код банку
.head 4 -  Resource Id: 53678
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.386"
.head 5 -  Top:    1.177"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: 3D Face Color
.head 3 +  Data Field: dfMFOA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 12
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.286"
.head 6 -  Top:    1.323"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Одержувач -
.head 4 -  Resource Id: 53679
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.086"
.head 5 -  Top:    1.927"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: 3D Face Color
.head 3 +  Data Field: dfNAMB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.286"
.head 6 -  Top:    1.927"
.head 6 -  Width:  4.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Банк одержувача
.head 4 -  Resource Id: 53680
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.086"
.head 5 -  Top:    2.344"
.head 5 -  Width:  2.314"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: 3D Face Color
.head 3 +  Data Field: dfBANKB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    2.51"
.head 6 -  Width:  3.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Код банку
.head 4 -  Resource Id: 53681
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.386"
.head 5 -  Top:    2.344"
.head 5 -  Width:  1.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfMFOB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 12
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.286"
.head 6 -  Top:    2.49"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 13
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.8"
.head 6 -  Top:    1.344"
.head 6 -  Width:  1.386"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.229"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfCodeCurrency
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.486"
.head 6 -  Top:    0.76"
.head 6 -  Width:  0.683"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Uppercase
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: ДЕБЕТ                                  СУМА
.head 4 -  Resource Id: 53682
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.886"
.head 5 -  Top:    1.094"
.head 5 -  Width:  3.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: 3D Face Color
.head 3 +  Data Field: dfNLSA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.886"
.head 6 -  Top:    1.344"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.229"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: КРЕДИТ
.head 4 -  Resource Id: 53683
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.886"
.head 5 -  Top:    2.01"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfNLSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.886"
.head 6 -  Top:    2.26"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.229"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Сума літерами
.head 4 -  Resource Id: 53684
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.086"
.head 5 -  Top:    2.76"
.head 5 -  Width:  2.314"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: 3D Face Color
.head 3 +  Multiline Field: mlSumPr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    2.906"
.head 6 -  Width:  9.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.583"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 -  Background Text: Призначення платежу
.head 4 -  Resource Id: 53685
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.086"
.head 5 -  Top:    3.51"
.head 5 -  Width:  2.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: 3D Face Color
.head 3 +  Multiline Field: mlNAZN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    3.656"
.head 6 -  Width:  9.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.583"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ok
.head 4 -  Window Location and Size
.head 5 -  Left:   4.214"
.head 5 -  Top:    4.99"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: 3D Shadow Color
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(document, 0)
.head 3 +  Pushbutton: pbEsc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ok
.head 4 -  Window Location and Size
.head 5 -  Left:   0.086"
.head 5 -  Top:    3.906"
.head 5 -  Width:  8.657"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Yellow
.head 4 -  Background Color: Dark Gray
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(document, 0)
.head 3 +  Data Field: dfKODDOK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.986"
.head 6 -  Top:    0.094"
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: від
.head 4 -  Resource Id: 53686
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.086"
.head 5 -  Top:    0.344"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Код
.head 4 -  Resource Id: 53687
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.086"
.head 5 -  Top:    0.927"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfKODA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.286"
.head 6 -  Top:    0.927"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.229"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Код
.head 4 -  Resource Id: 53688
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.086"
.head 5 -  Top:    2.094"
.head 5 -  Width:  0.829"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfKODB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 14
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.286"
.head 6 -  Top:    2.094"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Line
.head 4 -  Resource Id: 53689
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.086"
.head 5 -  Begin Y:  1.573"
.head 5 -  End X:  5.286"
.head 5 -  End Y:  1.573"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 3 -  Background Text: Одержано банком
.head 4 -  Resource Id: 53690
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.286"
.head 5 -  Top:    0.344"
.head 5 -  Width:  1.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: "__" _________200__ р.
.head 4 -  Resource Id: 53691
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.986"
.head 5 -  Top:    0.51"
.head 5 -  Width:  2.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Line
.head 4 -  Resource Id: 53692
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.086"
.head 5 -  Begin Y:  2.74"
.head 5 -  End X:  5.286"
.head 5 -  End Y:  2.74"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 53693
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.786"
.head 5 -  Top:    2.49"
.head 5 -  Width:  1.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: рах.N
.head 4 -  Resource Id: 53694
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.286"
.head 5 -  Top:    1.344"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: рах.N
.head 4 -  Resource Id: 53695
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.286"
.head 5 -  Top:    2.26"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: рах.N
.head 4 -  Resource Id: 53696
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.286"
.head 5 -  Top:    2.51"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: р.
.head 4 -  Resource Id: 53697
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.986"
.head 5 -  Top:    0.344"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 53698
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.086"
.head 5 -  Top:    4.74"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: М.П.
.head 4 -  Resource Id: 53699
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.286"
.head 5 -  Top:    4.844"
.head 5 -  Width:  0.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Center
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Підписи платника
.head 4 -  Resource Id: 53700
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.986"
.head 5 -  Top:    4.927"
.head 5 -  Width:  2.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Проведено банком
.head 4 -  Resource Id: 53701
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.186"
.head 5 -  Top:    4.51"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: "__" _________200__ р.
.head 4 -  Resource Id: 53702
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.886"
.head 5 -  Top:    4.677"
.head 5 -  Width:  2.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Підпис банку
.head 4 -  Resource Id: 53703
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.386"
.head 5 -  Top:    4.927"
.head 5 -  Width:  1.829"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Line
.head 4 -  Resource Id: 53704
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  5.786"
.head 5 -  Begin Y:  1.323"
.head 5 -  End X:  5.786"
.head 5 -  End Y:  2.49"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 3 -  Line
.head 4 -  Resource Id: 53705
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  7.686"
.head 5 -  Begin Y:  1.323"
.head 5 -  End X:  7.686"
.head 5 -  End Y:  2.49"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 3 -  Line
.head 4 -  Resource Id: 53706
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  7.686"
.head 5 -  Begin Y:  2.74"
.head 5 -  End X:  9.186"
.head 5 -  End Y:  2.74"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 53707
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.886"
.head 5 -  Top:    0.073"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Line
.head 4 -  Resource Id: 53708
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  5.786"
.head 5 -  Begin Y:  1.573"
.head 5 -  End X:  9.186"
.head 5 -  End Y:  1.573"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 3 -  Line
.head 4 -  Resource Id: 53709
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  5.786"
.head 5 -  Begin Y:  1.323"
.head 5 -  End X:  9.186"
.head 5 -  End Y:  1.323"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 3 -  Line
.head 4 -  Resource Id: 53710
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  5.786"
.head 5 -  Begin Y:  2.24"
.head 5 -  End X:  7.686"
.head 5 -  End Y:  2.24"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Solid
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: Default
.head 3 +  Data Field: dfDaval
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.886"
.head 6 -  Top:    0.51"
.head 6 -  Width:  2.529"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Gray
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfDAVAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.586"
.head 6 -  Top:    0.51"
.head 6 -  Width:  1.286"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: dd/MM/yyyy
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Gray
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.986"
.head 6 -  Top:    0.51"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Gray
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: df_title1
.head 3 -  String: d_ND1
.head 3 -  Date/Time: d_DATA1
.head 3 -  String: d_NAMA1
.head 3 -  String: d_BNK_A1
.head 3 -  String: d_MFOA1
.head 3 -  String: d_NAMB1
.head 3 -  String: d_BNK_B1
.head 3 -  String: d_MFOB1
.head 3 -  String: d_S1
.head 3 -  String: dfCodeCurrency1
.head 3 -  String: d_NLSA1
.head 3 -  String: d_NLSB1
.head 3 -  String: ml_SumPr1
.head 3 -  String: d_NAZN1
.head 3 -  String: d_KOKA
.head 3 -  String: d_KOKB
.head 3 -  String: d_KODO
.head 3 -  Date/Time: d_DAVAL
.head 2 +  Window Variables
.head 3 -  String: sDevice
.head 3 -  String: sDriver
.head 3 -  String: sPort
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndItem)
.head 4 -  Set dftitle = df_title1
.head 4 -  Set dfND = SalStrTrimX(d_ND1)
.head 4 -  Set dfDATA = d_DATA1
.head 4 -  Set dfNAMA = SalStrTrimX(d_NAMA1)
.head 4 -  Set dfBANKA = SalStrTrimX(d_BNK_A1)
.head 4 -  Set dfMFOA = SalStrTrimX(d_MFOA1)
.head 4 -  Set dfNAMB = SalStrTrimX(d_NAMB1)
.head 4 -  Set dfBANKB = SalStrTrimX(d_BNK_B1)
.head 4 -  Set dfMFOB = SalStrTrimX(d_MFOB1)
.head 4 -  Set dfS = d_S1
.head 4 -  ! Call DebugN(d_S1)
.head 4 -  Set dfCodeCurrency = SalStrTrimX(dfCodeCurrency1)
.head 4 -  Set dfNLSA = SalStrTrimX(d_NLSA1)
.head 4 -  Set dfNLSB = SalStrTrimX(d_NLSB1)
.head 4 -  Set mlSumPr = ml_SumPr1
.head 4 -  Set mlNAZN = SalStrTrimX(d_NAZN1)
.head 4 -  Set dfKODA = SalStrTrimX(d_KOKA)
.head 4 -  Set dfKODB = SalStrTrimX(d_KOKB)
.head 4 -  Set dfKODDOK = SalStrTrimX(d_KODO)
.head 4 +  If d_DAVAL = DATETIME_Null
.head 5 -  Call SalHideWindow(dfDaval)
.head 5 -  Call SalHideWindow(dfDAVAL)
.head 5 -  Call SalHideWindow(dfR)
.head 4 +  Else
.head 5 -  Call SalShowWindow(dfDaval)
.head 5 -  Call SalShowWindow(dfDAVAL)
.head 5 -  Call SalShowWindow(dfR)
.head 5 -  Set dfDaval = 'Дата валютування'
.head 5 -  Set dfDAVAL = d_DAVAL
.head 5 -  Set dfR = 'р.'
.head 4 -  Call SalSetFocus(pbOk)
.head 1 +  Dialog Box: dlgViewTXTfile
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Файл
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   2.363"
.head 4 -  Top:    0.938"
.head 4 -  Width:  17.517"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 8.274"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: показ текстового файла (небольшого)
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ok
.head 4 -  Window Location and Size
.head 5 -  Left:   16.533"
.head 5 -  Top:    0.071"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: 3D Shadow Color
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, 0)
.head 3 +  Multiline Field: ml1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 4096
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   0.033"
.head 6 -  Top:    0.024"
.head 6 -  Width:  17.333"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 7.905"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: sFile
.head 2 +  Window Variables
.head 3 -  Window Handle: hF
.head 3 -  String: sBuffer
.head 3 -  Number: nFileSize
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SalSetWindowText(hWndForm, 'Файл ' || sFile)
.head 4 -  Set nFileSize = VisFileGetSize(sFile)
.head 4 +  If SalFileOpen(hF, sFile, OF_Read)
.head 5 +  If SalFileRead(hF, sBuffer, nFileSize) = nFileSize
.head 6 -  Set ml1 = sBuffer
.head 6 -  Call SalFileClose(hF)
.head 5 +  Else
.head 6 -  Call SalFileClose(hF)
.head 6 -  Call MessageNoWait(IifS(GetLang()='RUS', 'Ошибка чтения файла !', 'Помилка читання файлу !'), IifS(GetLang()='RUS',
     'ОШИБКА', 'ПОМИЛКА'), 17, 1)
.head 4 +  Else
.head 5 -  Call MessageNoWait(IifS(GetLang()='RUS', 'Ошибка открытия файла !', 'Помилка відкриття файлу !'), IifS(GetLang()='RUS',
     'ОШИБКА', 'ПОМИЛКА'), 17, 1)
.head 4 -  Call SalSetFocus(pbOk)
.head 1 +  Form Window: otborSWBANKS
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Отбор списка загранбанков (ИКТ)
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   3.425"
.head 4 -  Top:    1.563"
.head 4 -  Width:  9.633"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 1.726"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbRun
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbExecute
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.071"
.head 5 -  Width:  1.35"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call ccA.SetProgress(0)
.head 6 -  Set dCurrent = SalDateCurrent()
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Call SqlPrepareAndExecute(hSql(), T("
   SELECT count(*)
   INTO :nKwo
   FROM sw_banks
   WHERE length(ltrim(rtrim(bic)))>10"))
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If nKwo > 0
.head 7 -  Set dfT = 'Создание файла во временном каталоге ...'
.head 7 -  Set nPos = 0
.head 7 -  Set nDelta = 100 / nKwo
.head 7 -  ! Set nIndex = 0
.head 7 -  Set bZag = TRUE
.head 7 -  Call SqlPrepareAndExecute(hSql(), T("
   SELECT bic,name,city,country
   INTO :sBIC,:sNZB,:sCITY,:sCOUNTRY
   FROM sw_banks
   WHERE length(ltrim(rtrim(bic)))>10"))
.head 7 +  While SqlFetchNext(hSql(), nFetchRes)
.head 8 +  If bZag ! Сформировать часть заголовка файла B
.head 9 -  Set sB = sTempPath || '\\%Bxxxx' || DaySymbol(dCurrent) || MonthSymbol(dCurrent)
    || '.' || YearSymbol(dCurrent) || 'xx'
.head 9 +  If not SalFileOpen(hB, sB, OF_Create | OF_ReadWrite)
.head 10 -  Call SqlRollback(hSqlAux2())
.head 10 -  Call MessageNoWait('Ошибка при создании файла ' || sB, 'Аварийная ситуация',
     17, 1)
.head 10 -  Return FALSE
.head 9 -  Set sDaTi = SalFmtFormatDateTime(dCurrent, 'yyyyMMdd') || Right('0' ||
    SalFmtFormatDateTime(dCurrent, 'hhhhmmss'), 6)
.head 9 +  If SalFileWrite(hB, Right(sB, 12) || sDaTi || PadL(Str(nKwo), 6) || PutCrLf(),
   34) != 34
.head 10 -  Call SalFileClose(hB)
.head 10 -  Call VisFileDelete(sB)
.head 10 -  Call SqlRollback(hSqlAux2())
.head 10 -  Call MessageNoWait('Ошибка при записи в файл ' || sB, 'Аварийная ситуация',
     17, 1)
.head 10 -  Return FALSE
.head 9 -  Set bZag = FALSE
.head 8 -  Set s280 = Spac(280)
.head 8 -  Set s68 = StrWinToDosX(Left(sNZB || Spac(68), 68))
.head 8 -  Set s1 = SalStrTrimX(Left(s68, 34)) || Chr(13)
.head 8 -  Set s2 = SalStrTrimX(Right(s68, 34)) || Chr(13)
.head 8 -  Set s3 = SalStrTrimX(StrWinToDosX(Left(sCITY || ',' || sCOUNTRY || Spac(34), 34)))
    || Chr(13)
.head 8 -  Set s4 = StrWinToDosX(sBIC) || Chr(13)
.head 8 -  Call ConvertBinToHex(s1 || s2 || s3 || s4, s280,
     Len(s1) + Len(s2) + Len(s3) + Len(s4))
.head 8 -  Set s280 = SalStrTrimX(s280) || Repl('0',
    (140 - Len(s1) - Len(s2) - Len(s3) - Len(s4))*2)
.head 8 -  Set s308 = PadR(StrWinToDosX(sBIC), 11) || s280 || 'I' ||
    SalFmtFormatDateTime(dCurrent, 'yyyyMMdd') || Right('0' ||
    SalFmtFormatDateTime(dCurrent, 'hhhhmmss'), 6) || PutCrLf()
.head 8 -  Set sBufout = sBufout || s308
.head 8 +  If Len(sBufout) > 8192
.head 9 +  If SalFileWrite(hB, sBufout, Len(sBufout)) != Len(sBufout)
.head 10 -  Call SalFileClose(hB)
.head 10 -  Call VisFileDelete(sB)
.head 10 -  Call SqlRollback(hSqlAux2())
.head 10 -  Call MessageNoWait('Ошибка при записи в файл ' || sB, 'Аварийная ситуация',
     17, 1)
.head 10 -  Return FALSE
.head 9 +  Else
.head 10 -  Set sBufout = ''
.head 8 -  ! Set nIndex = nIndex + 1
.head 8 -  Set nPos = nPos + nDelta
.head 8 -  Call ccA.SetProgress(nPos)
.head 7 +  If Len(sBufout) > 0
.head 8 +  If SalFileWrite(hB, sBufout, Len(sBufout)) != Len(sBufout)
.head 9 -  Call SalFileClose(hB)
.head 9 -  Call VisFileDelete(sB)
.head 9 -  Call SqlRollback(hSqlAux2())
.head 9 -  Call MessageNoWait('Ошибка при записи в файл ' || sB, 'Аварийная ситуация',
     17, 1)
.head 9 -  Return FALSE
.head 7 -  Call ccA.SetProgress(100)
.head 7 -  Call SalFileClose(hB)
.head 7 -  Set dfT = 'Копирование файла в каталог ' || sKuda || ' ...'
.head 7 +  If SalFileCopy(sB, sKuda || '\\' || Right(sB, 12), TRUE) = 0
.head 8 -  Call VisFileDelete(sB)
.head 8 -  ! Call MessageNoWait('Список загранбанков выгружен в файл' || PutCrLf() || sKuda ||
     '\\' || Right(sB, 12), 'ВНИМАНИЕ !!!', 17, 0)
.head 8 -  Set dfT = 'Список загранбанков выгружен в файл ' || sKuda || '\\' || Right(sB, 12)
    || '. Можно выйти из функции.'
.head 7 +  Else
.head 8 -  Call VisFileDelete(sB)
.head 8 -  Call MessageNoWait('Ошибка при записи в файл ' || sKuda || '\\' || Right(sB, 12),
     'Аварийная ситуация', 17, 1)
.head 7 +  ! Else
.head 8 -  Call SalWaitCursor(FALSE)
.head 8 -  Call MessageNoWait('Список загранбанков пуст.', 'ВНИМАНИЕ !!!', 0, 1)
.head 6 +  Else
.head 7 -  Call SalSendMsg(pbExit, SAM_Click, 0, 0)
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   7.783"
.head 5 -  Top:    0.071"
.head 5 -  Width:  1.35"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 3 +  Custom Control: ccA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.5"
.head 6 -  Top:    0.071"
.head 6 -  Width:  6.233"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.452"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Periwinkle
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Multiline Field: dfT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   0.117"
.head 6 -  Top:    0.524"
.head 6 -  Width:  9.017"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.583"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: DaySymbol
.head 4 -  Description: преобразовывает день в символ
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Date/Time: dDa
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nDa
.head 5 -  String: sDay
.head 4 +  Actions
.head 5 -  Set nDa = SalDateDay(dDa)
.head 5 +  If nDa < 10
.head 6 -  Set sDay = Str(nDa)
.head 5 +  Else
.head 6 -  Set sDay = SalNumberToChar(nDa+55)
.head 5 -  Return sDay
.head 3 +  Function: MonthSymbol
.head 4 -  Description: преобразовывает месяц в символ
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Date/Time: dDa
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nMo
.head 5 -  String: sMonth
.head 4 +  Actions
.head 5 -  Set nMo = SalDateMonth(dDa)
.head 5 +  If nMo<10
.head 6 -  Set sMonth = Str(nMo)
.head 5 +  Else
.head 6 -  Set sMonth = SalNumberToChar(nMo+55)
.head 5 -  Return sMonth
.head 3 +  Function: YearSymbol
.head 4 -  Description: преобразовывает год в символ
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Date/Time: dDa
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nY
.head 5 -  ! String: sYear
.head 4 +  Actions
.head 5 -  Set nY = SalNumberMax(SalDateYear(dDa) - 1998, 0)
.head 5 +  ! If nY < 10
.head 6 -  Set sYear = Str(nY)
.head 5 +  ! Else
.head 6 -  Set sYear = SalNumberToChar(nY+55)
.head 5 -  ! Set sYear = IifS(nY<10, Str(nY), SalNumberToChar(nY+55))
.head 5 -  ! Return sYear
.head 5 -  Return IifS(nY<10, Str(nY), SalNumberToChar(nY+55))
.head 3 +  ! Function: FormFileB
.head 4 -  Description: формирование файла %B
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: smBIC[*]
.head 5 -  String: smNZB[*]
.head 5 -  String: smCITY[*]
.head 5 -  String: smCOUNTRY[*]
.head 5 -  String: sKuda
.head 5 -  String: sTempPath
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nKd
.head 5 -  Number: nLA
.head 5 -  Boolean: bZag
.head 5 -  String: sB
.head 5 -  File Handle: hB
.head 5 -  String: sDaTi
.head 5 -  Number: nKw
.head 5 -  Number: nhB
.head 5 -  Number: nhBc
.head 5 -  String: sBc
.head 5 -  String: s280
.head 5 -  Long String: s308
.head 5 -  Number: nLenArr
.head 5 -  !
.head 5 -  String: s68
.head 5 -  String: s1
.head 5 -  String: s2
.head 5 -  String: s3
.head 5 -  String: s4
.head 5 -  String: sBufout
.head 5 -  !
.head 5 -  Date/Time: dCurrent
.head 4 +  Actions
.head 5 -  Call SalArrayDimCount(smBIC, nKd)
.head 5 -  Call SalArrayGetUpperBound(smBIC, nKd, nLA)
.head 5 -  Set nKd = 0
.head 5 -  Set bZag = TRUE
.head 5 -  Set sBufout = ''
.head 5 -  Set dCurrent = SalDateCurrent()
.head 5 +  While nKd <= nLA
.head 6 +  If bZag ! Сформировать часть заголовка файла B
.head 7 -  Set sB = sTempPath || '\\%Bxxxx' || DaySymbol(dCurrent) || MonthSymbol(dCurrent) ||
    '.' || YearSymbol(dCurrent) || 'xx'
.head 7 +  If not SalFileOpen(hB, sB, OF_Create | OF_ReadWrite)
.head 8 -  Call SqlRollback(hSqlAux2())
.head 8 -  Call MessageNoWait('Ошибка при создании файла ' || sB, 'Аварийная ситуация', 3, 1)
.head 8 -  Return FALSE
.head 7 -  Set sDaTi = SalFmtFormatDateTime(dCurrent, 'yyyyMMdd') || Right('0' ||
    SalFmtFormatDateTime(dCurrent, 'hhhhmmss'), 6)
.head 7 +  If SalFileWrite(hB, Right(sB, 12) || sDaTi || PadL(Str(nLA), 6) || PutCrLf(), 34)
   != 34
.head 8 -  Call SalFileClose(hB)
.head 8 -  Call VisFileDelete(sB)
.head 8 -  Call SqlRollback(hSqlAux2())
.head 8 -  Call MessageNoWait('Ошибка при записи в файл ' || sB, 'Аварийная ситуация', 3, 1)
.head 8 -  Return FALSE
.head 7 -  Set bZag = FALSE
.head 6 -  Set s280 = Spac(280)
.head 6 -  Set s68 = StrWinToDosX(Left(smNZB[nKd] || Spac(68), 68))
.head 6 -  Set s1 = SalStrTrimX(Left(s68, 34)) || Chr(13)
.head 6 -  Set s2 = SalStrTrimX(Right(s68, 34)) || Chr(13)
.head 6 -  Set s3 = SalStrTrimX(StrWinToDosX(
         Left(smCITY[nKd] || ',' || smCOUNTRY[nKd] || Spac(34), 34))) || Chr(13)
.head 6 -  Set s4 = StrWinToDosX(smBIC[nKd]) || Chr(13)
.head 6 -  Call ConvertBinToHex(s1 || s2 || s3 || s4, s280,
     Len(s1) + Len(s2) + Len(s3) + Len(s4))
.head 6 -  Set s280 = SalStrTrimX(s280) || Repl('0',
    (140 - Len(s1) - Len(s2) - Len(s3) - Len(s4))*2)
.head 6 -  Set s308 = PadR(StrWinToDosX(smBIC[nKd]), 11) || s280 || 'I' ||
    SalFmtFormatDateTime(dCurrent, 'yyyyMMdd') || Right('0' ||
    SalFmtFormatDateTime(dCurrent, 'hhhhmmss'), 6) || PutCrLf()
.head 6 -  Set sBufout = sBufout || s308
.head 6 +  If Len(sBufout) > 8192
.head 7 +  If SalFileWrite(hB, sBufout, Len(sBufout)) != Len(sBufout)
.head 8 -  Call SalFileClose(hB)
.head 8 -  Call VisFileDelete(sB)
.head 8 -  Call SqlRollback(hSqlAux2())
.head 8 -  Call MessageNoWait('Ошибка при записи в файл ' || sB, 'Аварийная ситуация', 3, 1)
.head 8 -  Return FALSE
.head 7 +  Else
.head 8 -  Set sBufout = ''
.head 6 -  Set nKd = nKd + 1
.head 5 +  If Len(sBufout) > 0
.head 6 +  If SalFileWrite(hB, sBufout, Len(sBufout)) != Len(sBufout)
.head 7 -  Call SalFileClose(hB)
.head 7 -  Call VisFileDelete(sB)
.head 7 -  Call SqlRollback(hSqlAux2())
.head 7 -  Call MessageNoWait('Ошибка при записи в файл ' || sB, 'Аварийная ситуация', 3, 1)
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 -  Set sBufout = ''
.head 5 -  Call SalFileClose(hB)
.head 5 +  If SalFileCopy(sB, sKuda || '\\' || Right(sB, 12), TRUE) = 0
.head 6 -  Call VisFileDelete(sB)
.head 6 -  Call MessageNoWait('Список загранбанков выгружен в файл' || PutCrLf() || sKuda || '\\'
     || Right(sB, 12), 'ВНИМАНИЕ !!!', 17, 0)
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Call VisFileDelete(sB)
.head 6 -  Call MessageNoWait('Ошибка при записи в файл ' || sKuda || '\\' || Right(sB, 12),
     'Аварийная ситуация', 3, 1)
.head 6 -  Return FALSE
.head 3 +  ! Function: OtborSWBANKS
.head 4 -  Description: инициализация библиотеки
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sPath
.head 5 -  String: sTempPath
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nIndex
.head 5 -  String: sBIC
.head 5 -  String: smBIC[*]
.head 5 -  String: sNZB
.head 5 -  String: smNZB[*]
.head 5 -  String: sCITY
.head 5 -  String: smCITY[*]
.head 5 -  String: sCOUNTRY
.head 5 -  String: smCOUNTRY[*]
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  If SqlPrepareAndExecute(hSql(), T("
   SELECT bic,name,city,country
   INTO :sBIC,:sNZB,:sCITY,:sCOUNTRY
   FROM sw_banks
   WHERE length(ltrim(rtrim(bic)))>4"))
.head 6 -  Set nIndex = 0
.head 6 -  Call Debug('1')
.head 6 +  While SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set smBIC[nIndex] = SalStrTrimX(sBIC)
.head 7 -  Set smNZB[nIndex] = SalStrTrimX(sNZB)
.head 7 -  Set smCITY[nIndex] = SalStrTrimX(sCITY)
.head 7 -  Set smCOUNTRY[nIndex] = SalStrTrimX(sCOUNTRY)
.head 7 -  Set nIndex = nIndex + 1
.head 6 +  If nIndex > 0
.head 7 -  Call Debug('2')
.head 7 -  Call FormFileB(smBIC, smNZB, smCITY, smCOUNTRY, sPath, sTempPath)
.head 6 +  Else
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call MessageNoWait('Список загранбанков пуст.', 'ВНИМАНИЕ !!!', 0, 1)
.head 5 -  Call SalWaitCursor(FALSE)
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: sKuda
.head 3 -  String: sTempPath
.head 3 -  Number: nPos
.head 3 -  Number: nKwo
.head 3 -  Number: nDelta
.head 3 -  String: sBIC
.head 3 -  ! String: smBIC[*]
.head 3 -  String: sNZB
.head 3 -  ! String: smNZB[*]
.head 3 -  String: sCITY
.head 3 -  ! String: smCITY[*]
.head 3 -  String: sCOUNTRY
.head 3 -  ! String: smCOUNTRY[*]
.head 3 -  ! Number: nIndex
.head 3 -  !
.head 3 -  Boolean: bZag
.head 3 -  String: sB
.head 3 -  File Handle: hB
.head 3 -  String: sDaTi
.head 3 -  Number: nKw
.head 3 -  Number: nhB
.head 3 -  Number: nhBc
.head 3 -  String: sBc
.head 3 -  String: s280
.head 3 -  Long String: s308
.head 3 -  Number: nLenArr
.head 3 -  !
.head 3 -  String: s68
.head 3 -  String: s1
.head 3 -  String: s2
.head 3 -  String: s3
.head 3 -  String: s4
.head 3 -  String: sBufout
.head 3 -  Date/Time: dCurrent
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('ElektroKlients', 'SwBanksPath', GetPrnDir(), sKuda,
     GetIniFileName())
.head 4 -  Call SalGetProfileString('ElektroKlients', 'TempKPath', GetPrnDir(), sTempPath,
     GetIniFileName())
.head 4 -  Set sKuda = IifS(Right(sKuda, 1)='\\', Left(sKuda, Len(sKuda)-1), sKuda)
.head 4 -  Set sTempPath = IifS(Right(sTempPath, 1)='\\', Left(sTempPath, Len(sTempPath)-1),
    sTempPath)
.head 1 +  ! cGenericTable: kp_MAJAR
.winattr class Table Window:
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Импорт коммунальные платежи (MAJAR)
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? No
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   1.138"
.head 4 -  Top:    0.979"
.head 4 -  Width:  9.917"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.774"
.head 4 -  Height Editable? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  View: Table
.head 3 -  Allow Row Sizing? No
.head 3 -  Lines Per Row: Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 512000
.head 3 -  Discardable? No
.end
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 1.024"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.winattr
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.19"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.winattr
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.19"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.winattr
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.19"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.winattr
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.19"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions
.head 4 -  Line
.winattr
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  0.767"
.head 6 -  Begin Y:  2.024"
.head 6 -  End X:  0.767"
.head 6 -  End Y:  2.488"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.end
.head 4 +  Pushbutton: pbSearch
.winattr
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.19"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\search.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.winattr
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.19"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.winattr
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.917"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.winattr
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.19"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions
.head 4 -  Line
.winattr
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  0.617"
.head 6 -  Begin Y:  2.214"
.head 6 -  End X:  0.617"
.head 6 -  End Y:  2.679"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.end
.head 4 +  Pushbutton: pbExit
.winattr
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.19"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions
.head 4 -  Line
.winattr
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  0.717"
.head 6 -  Begin Y:  2.548"
.head 6 -  End X:  0.733"
.head 6 -  End Y:  2.917"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.end
.head 4 +  Data Field: dfKat
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.167"
.head 7 -  Top:    0.119"
.head 7 -  Width:  3.983"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.214"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.end
.head 5 -  Message Actions
.head 4 -  Background Text: Каталог импорта
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.7"
.head 6 -  Top:    0.119"
.head 6 -  Width:  2.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.214"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Charcoal
.head 5 -  Background Color: Default
.end
.head 4 +  Custom Control: cc1
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cMeter
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Display Settings
.head 6 -  DLL Name: vti11.dll
.head 6 -  MS Windows Class Name: VT:cMeter:10
.head 6 -  Style:  0x00000000
.head 6 -  ExStyle:  0x00000000
.head 6 -  Title:
.head 6 -  Window Location and Size
.head 7 -  Left:   0.05"
.head 7 -  Top:    0.643"
.head 7 -  Width:  9.7"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.298"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Etched Border? Yes
.head 6 -  Hollow? No
.head 6 -  Vertical Scroll? No
.head 6 -  Horizontal Scroll? No
.head 6 -  Tab Stop? None
.head 6 -  Tile To Parent? No
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Blue
.head 6 -  Background Color: System Window Color
.head 6 -  DLL Settings
.end
.head 5 -  Message Actions
.head 4 -  ! Background Text: Файл импорта
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.7"
.head 6 -  Top:    0.381"
.head 6 -  Width:  2.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.214"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 4 +  Data Field: dfFile
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.167"
.head 7 -  Top:    0.381"
.head 7 -  Width:  3.983"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.214"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.end
.head 5 -  Message Actions
.head 4 +  Data Field: dfRec
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   7.233"
.head 7 -  Top:    0.381"
.head 7 -  Width:  2.517"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.214"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.end
.head 5 -  Message Actions
.head 4 +  Data Field: dfDone
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.0"
.head 7 -  Top:    0.679"
.head 7 -  Width:  3.65"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 12
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Blue
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.end
.head 5 -  Message Actions
.head 4 +  Data Field: dfFIFI
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.7"
.head 7 -  Top:    0.381"
.head 7 -  Width:  2.25"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.214"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Charcoal
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.end
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set dfFIFI = 'Файл импорта'
.head 2 +  Contents
.head 3 +  ! Column: colKODA
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОБЩЕГОРОДСКОЙ
КОД АБОНЕНТА
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: colClientId
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Регистрационный номер клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: colLC
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ЛИЦЕВОЙ
СЧЕТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: colFIO
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
ФИО
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.367"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: colKUL
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: КОД
УЛИЦЫ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: colNDOM
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: НОМЕР
ДОМА
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: colNKV
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: НОМЕР
КВАРТИРЫ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.167"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: colRNP
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
ПОЛУЧАТЕЛЬ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: colNA
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
НАЧИСЛЕНО
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: colSALN
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: САЛЬДО
НАЧАЛЬНОЕ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: colMES
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: НА НАЧАЛО
КАКОГО МЕСЯЦА
ОСТАТКИ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.667"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: colRisk
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Риск
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.614"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFileName
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Файл импорта
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRecc
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: К-во зап.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colProgressDone
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Действие
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nFiles
.head 3 -  String: sCurrentDir
.head 3 -  Number: nI
.head 3 -  Boolean: bU
.head 3 -  String: sFile
.head 3 -  Sql Handle: hSqlA
.head 3 -  String: sFIO
.head 3 -  String: sNDOM
.head 3 -  String: sNKV
.head 3 -  Number: nKODA
.head 3 -  Number: nLC
.head 3 -  Number: nKUL
.head 3 -  Number: nRNP
.head 3 -  Number: nNA
.head 3 -  Number: nSALN
.head 3 -  Number: nMES
.head 3 -  String: smFiles[*]
.head 3 -  Number: nDelta
.head 3 -  Number: nPos
.head 3 -  Number: nCount
.head 3 -  Number: nCountUpd
.head 3 -  Number: nK_USL
.head 3 -  Number: nK
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Call SalHideWindow(dfFIFI)
.head 4 -  ! Call SetWindowFullSize(hWndForm)
.head 4 -  Set nFlags = GT_ReadOnly
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalDisableWindow(pbDel)
.head 4 -  Call SalDisableWindow(pbIns)
.head 4 -  Call SalDisableWindow(pbRefresh)
.head 4 -  Call SalDisableWindow(pbUpdate)
.head 4 -  Call SalDisableWindow(pbSearch)
.head 4 -  Call SalDisableWindow(pbFilter)
.head 4 -  Call SalDisableWindow(pbDetails)
.head 4 -  Call SalDisableWindow(pbPrint)
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'KP_MAJAR', 'C:\\KP_MAJAR', dfKat, GetIniFileName())
.head 4 -  Set dfKat = IifS(Right(dfKat, 1)='\\', Left(dfKat, Len(dfKat)-1), dfKat)
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalHideWindow(cc1)
.head 4 -  Call SalHideWindow(dfDone)
.head 4 -  Set nFiles = VisDosEnumFiles(dfKat || '\\OS???_??.DBF', FA_Standard, smFiles)
.head 4 -  ! вычитываем каталог и обрабатываем файлы OS???_??.DBF
.head 4 +  If nFiles > 0
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set nI = 0
.head 5 +  While nI < nFiles
.head 6 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 -  Set colFileName = smFiles[nI]
.head 6 -  Set nI = nI + 1
.head 5 -  Call SalShowWindow(dfDone)
.head 5 -  Set dfDone = 'Очистка KP_MAJAR'
.head 5 -  ! If SqlPrepareAndExecute(hSql(), '
   TRUNCATE TABLE
   kp_majar')
.head 5 +  If SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM
   kp_majar')
.head 6 -  Call SalShowWindow(dfFIFI)
.head 6 -  Call SalHideWindow(dfDone)
.head 6 -  Set dfDone = ''
.head 6 -  Call SalFileGetCurrentDirectory(sCurrentDir)
.head 6 -  Set nI = 0
.head 6 -  Set bU = TRUE
.head 6 +  While nI < nFiles and bU
.head 7 -  Set sFile = smFiles[nI]
.head 7 -  ! Set nRow = TBL_MinRow
.head 7 -  Call SalFileSetCurrentDirectory(dfKat)
.head 7 -  Set SqlDatabase = 'dBase_Files'
.head 7 +  If SqlConnect(hSqlA)
.head 8 -  Set nK_USL = Val(Subs(sFile,3,3))
.head 8 -  Call SalShowWindow(cc1)
.head 8 -  Call cc1.SetProgress(0)
.head 8 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT count(*)
     INTO :nCount
     FROM " || sFile)
.head 8 -  Call SqlFetchNext(hSqlA, nFetchRes)
.head 8 -  Call SalTblSetContext(hWndForm, nI)
.head 8 -  Set colProgressDone = 'Импорт ...'
.head 8 -  Set nDelta = 100 / nCount
.head 8 -  Set dfFile = sFile || ' (' || Str(nI+1) || ' из ' || Str(nFiles) || ')'
.head 8 -  Set dfRec = Str(nCount) || ' зап.'
.head 8 -  Set nPos = 0
.head 8 -  Call SqlPrepareAndExecute(hSqlA, "
     SELECT KODA,LC,FIO,KUL,NDOM,NKV,RNP,NA,SALN,MES
     INTO :nKODA,:nLC,:sFIO,:nKUL,:sNDOM,:sNKV,:nRNP,:nNA,:nSALN,:nMES
     FROM " || sFile)
.head 8 -  Set nK = 1
.head 8 +  While SqlFetchNext(hSqlA, nFetchRes)
.head 9 -  Set colRecc = nK
.head 9 -  Set sFIO = SalStrTrimX(StrDosToWinX(sFIO))
.head 9 -  Set sNDOM = SalStrTrimX(sNDOM)
.head 9 -  Set sNKV = SalStrTrimX(sNKV)
.head 9 +  If SqlPrepareAndExecute(hSql(), '
   UPDATE kp_majar
   SET KODA=:nKODA,FIO=:sFIO,KUL=:nKUL,NDOM=:sNDOM,NKV=:sNKV,RNP=:nRNP,NA=:nNA,
       SALN=:nSALN,MES=:nMES
   WHERE LC=:nLC and K_USL=:nK_USL')
.head 10 -  Set nCountUpd = 0
.head 10 -  Call SqlGetModifiedRows(hSql(), nCountUpd)
.head 10 +  If nCountUpd = 0
.head 11 +  If not SqlPrepareAndExecute(hSql(), '
   INSERT
   INTO kp_majar (KODA,LC,FIO,KUL,NDOM,NKV,RNP,NA,SALN,MES,K_USL)
   VALUES (:nKODA,:nLC,:sFIO,:nKUL,:sNDOM,:sNKV,:nRNP,:nNA,:nSALN,:nMES,
           :nK_USL)')
.head 12 -  Call MessageNoWait('Импорт MAJAR. Невозможно вставить строку в KP_MAJAR.' ||
     'Никаких изменений в информации не ВЫПОЛНЕНО.', 'ВНИМАНИЕ !!!', 7, 1)
.head 12 -  Set bU = FALSE
.head 12 -  Break
.head 10 -  ! Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 10 -  ! Call SalTblSetContext(hWndForm, nRow)
.head 10 -  ! Set colKODA = nKODA
.head 10 -  ! Set colLC = nLC
.head 10 -  ! Set colFIO = sFIO
.head 10 -  ! Set colKUL = nKUL
.head 10 -  ! Set colNDOM = sNDOM
.head 10 -  ! Set colNKV = sNKV
.head 10 -  ! Set colRNP = nRNP
.head 10 -  ! Set colNA = nNA
.head 10 -  ! Set colSALN = nSALN
.head 10 -  ! Set colMES = nMES
.head 10 -  Set nPos = nPos + nDelta
.head 10 -  Call cc1.SetProgress(nPos)
.head 10 -  Call SalUpdateWindow(hWndForm)
.head 10 -  Set nK = nK + 1
.head 9 +  Else
.head 10 -  Call MessageNoWait('Импорт MAJAR. Невозможно вставить строку в KP_MAJAR. ' ||
     'Никаких изменений в информации не ВЫПОЛНЕНО.', 'ВНИМАНИЕ !!!', 7, 1)
.head 10 -  Set bU = FALSE
.head 10 -  ! Call SqlDisconnect(hSqlA)
.head 10 -  Break
.head 8 -  Call SqlDisconnect(hSqlA)
.head 8 -  Call SalHideWindow(cc1)
.head 8 -  Set dfFile = ''
.head 8 -  Set dfRec = ''
.head 8 -  Set colProgressDone = 'Готово !!!'
.head 8 -  Call SalTblSetRowFlags(hWndForm, nI, ROW_Edited | ROW_New, FALSE)
.head 8 -  Call SalFileCreateDirectory(dfKat || '\\Archiv')
.head 8 -  Call VisFileCopy(dfKat || '\\' || smFiles[nI], dfKat || '\\Archiv\\' ||
     smFiles[nI])
.head 8 +  If File(dfKat || '\\Archiv\\' || smFiles[nI])
.head 9 -  Call VisFileDelete(dfKat || '\\' || smFiles[nI])
.head 8 -  Set nI = nI + 1
.head 6 +  If bU
.head 7 -  Call SqlCommit(hSql())
.head 7 -  Call SalHideWindow(cc1)
.head 7 -  Call SalShowWindow(dfDone)
.head 7 -  Set dfDone = 'Готово'
.head 7 -  Call SalHideWindow(dfFIFI)
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  ! Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 5 +  Else
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Call MessageNoWait('Импорт MAJAR. Невозможно удалить старую информацию из KP_MAJAR. '
     || 'Никаких изменений в информации не ВЫПОЛНЕНО.', 'ВНИМАНИЕ !!!', 7, 1)
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 4 +  Else
.head 5 -  Call MessageNoWait('Импорт MAJAR. Отсутствуют файлы для импорта (' || dfKat ||
     '\\OS???_??.DBF)', 'ВНИМАНИЕ !!!', 7, 1)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 1 +  ! cGenericTable: kp_UTEL
.winattr class Table Window:
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Импорт коммунальные платежи (UTEL)
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? No
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   1.138"
.head 4 -  Top:    0.979"
.head 4 -  Width:  9.917"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.774"
.head 4 -  Height Editable? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  View: Table
.head 3 -  Allow Row Sizing? No
.head 3 -  Lines Per Row: Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 512000
.head 3 -  Discardable? No
.end
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.winattr
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 1.024"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.winattr
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.19"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.winattr
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.19"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Delrec.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.winattr
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.19"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Refresh.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.winattr
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.19"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions
.head 4 -  Line
.winattr
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  0.767"
.head 6 -  Begin Y:  2.024"
.head 6 -  End X:  0.767"
.head 6 -  End Y:  2.488"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.end
.head 4 +  Pushbutton: pbSearch
.winattr
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.19"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\search.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.winattr
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.19"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Filter.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.winattr
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.917"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\open.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.winattr
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.19"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions
.head 4 -  Line
.winattr
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  0.617"
.head 6 -  Begin Y:  2.214"
.head 6 -  End X:  0.617"
.head 6 -  End Y:  2.679"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.end
.head 4 +  Pushbutton: pbExit
.winattr
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    0.19"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 5 -  Message Actions
.head 4 -  Line
.winattr
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  0.717"
.head 6 -  Begin Y:  2.548"
.head 6 -  End X:  0.733"
.head 6 -  End Y:  2.917"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.end
.head 4 +  Data Field: dfKat
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.167"
.head 7 -  Top:    0.119"
.head 7 -  Width:  3.983"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.214"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.end
.head 5 -  Message Actions
.head 4 -  Background Text: Каталог импорта
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.7"
.head 6 -  Top:    0.119"
.head 6 -  Width:  2.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.214"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Charcoal
.head 5 -  Background Color: Default
.end
.head 4 +  Custom Control: cc1
.winattr class
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cMeter
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Display Settings
.head 6 -  DLL Name: vti11.dll
.head 6 -  MS Windows Class Name: VT:cMeter:10
.head 6 -  Style:  0x00000000
.head 6 -  ExStyle:  0x00000000
.head 6 -  Title:
.head 6 -  Window Location and Size
.head 7 -  Left:   0.05"
.head 7 -  Top:    0.643"
.head 7 -  Width:  9.7"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.298"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Etched Border? Yes
.head 6 -  Hollow? No
.head 6 -  Vertical Scroll? No
.head 6 -  Horizontal Scroll? No
.head 6 -  Tab Stop? None
.head 6 -  Tile To Parent? No
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Blue
.head 6 -  Background Color: System Window Color
.head 6 -  DLL Settings
.end
.head 5 -  Message Actions
.head 4 -  ! Background Text: Файл импорта
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.7"
.head 6 -  Top:    0.381"
.head 6 -  Width:  2.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.214"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.end
.head 4 +  Data Field: dfFile
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.167"
.head 7 -  Top:    0.381"
.head 7 -  Width:  3.983"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.214"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.end
.head 5 -  Message Actions
.head 4 +  Data Field: dfDone
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.0"
.head 7 -  Top:    0.679"
.head 7 -  Width:  3.65"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Center
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 12
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Blue
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.end
.head 5 -  Message Actions
.head 4 +  Data Field: dfFIFI
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.7"
.head 7 -  Top:    0.381"
.head 7 -  Width:  2.25"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.214"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Charcoal
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.end
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  ! Column: colKODA
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОБЩЕГОРОДСКОЙ
КОД АБОНЕНТА
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: colClientId
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Регистрационный номер клиента
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: colLC
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ЛИЦЕВОЙ
СЧЕТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: colFIO
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
ФИО
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.367"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: colKUL
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: КОД
УЛИЦЫ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: colNDOM
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: НОМЕР
ДОМА
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: colNKV
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: НОМЕР
КВАРТИРЫ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.167"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: colRNP
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
ПОЛУЧАТЕЛЬ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: colNA
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
НАЧИСЛЕНО
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: colSALN
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: САЛЬДО
НАЧАЛЬНОЕ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: colMES
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: НА НАЧАЛО
КАКОГО МЕСЯЦА
ОСТАТКИ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.667"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: colRisk
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Риск
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.614"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colFileName
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Файл импорта
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRecc
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: К-во зап.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: col4
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colProgressDone
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Действие
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nFiles
.head 3 -  Number: nI
.head 3 -  Boolean: bU
.head 3 -  String: sFile
.head 3 -  String: sFIO
.head 3 -  String: smFiles[*]
.head 3 -  Number: nCountUpd
.head 3 -  Number: nK
.head 3 -  String: sGRUPPA
.head 3 -  String: sSALDO
.head 3 -  String: sSUM_NACH
.head 3 -  String: sSUM_AVANS
.head 3 -  String: sSUM_OPLAT
.head 3 -  String: sPENJA
.head 3 -  String: sPHONE
.head 3 -  String: sLSCHET
.head 3 -  String: sABON_ID
.head 3 -  !
.head 3 -  String: sPUNKT
.head 3 -  String: sSTREET
.head 3 -  String: sNDOM
.head 3 -  String: sKVARTIRA
.head 3 -  ! String: smFIO[*]
.head 3 -  ! String: smLSCHET[*]
.head 3 -  ! String: smABON_ID[*]
.head 3 -  ! String: smPHONE[*]
.head 3 -  ! String: smGRUPPA[*]
.head 3 -  ! String: smSALDO[*]
.head 3 -  ! String: smSUM_NACH[*]
.head 3 -  ! String: smSUM_AVANS[*]
.head 3 -  ! String: smSUM_OPLAT[*]
.head 3 -  ! String: smPENJA[*]
.head 3 -  Number: nT
.head 3 -  Number: nJ
.head 3 -  Number: nInd
.head 3 -  File Handle: hF
.head 3 -  String: sBuffer
.head 3 -  String: smTemp[*]
.head 3 -  Number: nTek
.head 3 -  Number: nFileSize
.head 3 -  String: sType
.head 3 -  String: sSqlUpdate
.head 3 -  String: sSqlInsert
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  ! Call SetWindowFullSize(hWndForm)
.head 4 -  Set nFlags = GT_ReadOnly
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalDisableWindow(pbDel)
.head 4 -  Call SalDisableWindow(pbIns)
.head 4 -  Call SalDisableWindow(pbRefresh)
.head 4 -  Call SalDisableWindow(pbUpdate)
.head 4 -  Call SalDisableWindow(pbSearch)
.head 4 -  Call SalDisableWindow(pbFilter)
.head 4 -  Call SalDisableWindow(pbDetails)
.head 4 -  Call SalDisableWindow(pbPrint)
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'KP_UTEL', 'C:\\KP_UTEL', dfKat, GetIniFileName())
.head 4 -  Set dfKat = IifS(Right(dfKat, 1)='\\', Left(dfKat, Len(dfKat)-1), dfKat)
.head 4 -  Set dfFIFI = 'Файл импорта'
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalHideWindow(dfFIFI)
.head 4 -  Call SalHideWindow(cc1)
.head 4 -  Call SalHideWindow(dfDone)
.head 4 -  Set nFiles = VisDosEnumFiles(dfKat || '\\S??????.UNL', FA_Standard, smFiles)
.head 4 -  ! вычитываем каталог и обрабатываем файлы A??????.UNL
.head 4 +  If nFiles > 0
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set nI = 0
.head 5 +  While nI < 3
.head 6 -  Set nRow = SalTblInsertRow(kp_UTEL, TBL_MaxRow)
.head 6 -  Call SalTblSetContext(kp_UTEL, nRow)
.head 6 -  Set colFileName = IifS(nI=0, 'A', IifS(nI=1, 'R', 'S')) ||
    Right(smFiles[0], Len(smFiles[0])-1)
.head 6 -  Set nI = nI + 1
.head 5 -  Call SalShowWindow(dfDone)
.head 5 -  Set dfDone = 'Очистка KP_UTEL'
.head 5 +  If SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM
   kp_utel') and SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM
   kp_utel_A') and SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM
   kp_utel_R') and SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM
   kp_utel_S')
.head 6 -  Set dfDone = ''
.head 6 -  Call SalHideWindow(dfDone)
.head 6 -  Set bU = TRUE
.head 6 -  Call SalUpdateWindow(kp_UTEL)
.head 6 -  !
.head 6 -  Set sFile = 'A' || Right(smFiles[0], Len(smFiles[0])-1)
.head 6 -  Call SalShowWindow(cc1)
.head 6 -  Call cc1.SetProgress(0)
.head 6 -  Call SalShowWindow(dfFIFI)
.head 6 -  Set dfFile = sFile || ' (1 из 3)'
.head 6 -  Call SalUpdateWindow(kp_UTEL)
.head 6 -  !
.head 6 -  Set nTek = 0
.head 6 -  Call SalTblSetContext(kp_UTEL, 0)
.head 6 -  Set colProgressDone = 'Импорт ...'
.head 6 -  ! Call Debug(sFile)
.head 6 -  Set nFileSize = VisFileGetSize(dfKat || '\\' || sFile)
.head 6 -  Call SalFileOpen(hF, dfKat || '\\' || sFile, OF_Read)
.head 6 -  Set nJ = 0
.head 6 +  Loop
.head 7 -  Set sBuffer = Spac(512)
.head 7 +  If not SalFileGetStr(hF, sBuffer, 512)
.head 8 -  Break
.head 7 -  Set nTek = nTek + Len(sBuffer) + 1
.head 7 -  Call cc1.SetProgress(nTek/nFileSize*100)
.head 7 -  Call SalTblSetContext(kp_UTEL, 0)
.head 7 -  Set colRecc = nJ
.head 7 -  Call SalUpdateWindow(kp_UTEL)
.head 7 -  Set nInd = SalStrTokenize(sBuffer, '', '|', smTemp)
.head 7 +  If nInd > 3
.head 8 -  Set sLSCHET = smTemp[0]
.head 8 -  Set sABON_ID = smTemp[1]
.head 8 -  Set sPHONE = smTemp[2]
.head 8 -  Set sFIO = smTemp[3]
.head 8 -  Call SqlPrepareAndExecute(hSql(), '
     INSERT
     INTO kp_utel_A (LSCHET,ABON_ID,PHONE,FIO)
     VALUES (:sLSCHET,:sABON_ID,:sPHONE,:sFIO)')
.head 7 -  Set nJ = nJ + 1
.head 6 -  Set colProgressDone = 'Готово !!!'
.head 6 -  Call SalFileClose(hF)
.head 6 -  !
.head 6 -  Set nTek = 0
.head 6 -  Set sFile = 'R' || Right(smFiles[0], Len(smFiles[0])-1)
.head 6 -  ! Call Debug(sFile)
.head 6 -  Call SalTblSetContext(kp_UTEL, 1)
.head 6 +  If File(dfKat || '\\' || sFile)
.head 7 -  Set colProgressDone = 'Импорт ...'
.head 7 -  Set nFileSize = VisFileGetSize(dfKat || '\\' || sFile)
.head 7 -  Call SalFileOpen(hF, dfKat || '\\' || sFile, OF_Read)
.head 7 -  Set dfFile = sFile || ' (2 из 3)'
.head 7 -  Set nJ = 0
.head 7 -  Set nTek = 0
.head 7 +  Loop
.head 8 -  Set sBuffer = Spac(512)
.head 8 +  If not SalFileGetStr(hF, sBuffer, 512)
.head 9 -  Break
.head 8 -  Set nTek = nTek + Len(sBuffer) + 1
.head 8 -  Call cc1.SetProgress(nTek/nFileSize*100)
.head 8 -  ! Call SalTblSetContext(kp_UTEL, 1)
.head 8 -  Set colRecc = nJ
.head 8 -  Call SalUpdateWindow(kp_UTEL)
.head 8 -  Set nInd = SalStrTokenize(sBuffer, '', '|', smTemp)
.head 8 +  If nInd > 6
.head 9 -  Set sLSCHET = smTemp[0]
.head 9 -  Set sABON_ID = smTemp[1]
.head 9 -  Set sFIO = smTemp[2]
.head 9 -  Set sPUNKT = smTemp[3]
.head 9 -  Set sSTREET = smTemp[4]
.head 9 -  Set sNDOM = smTemp[5]
.head 9 -  Set sKVARTIRA = smTemp[6]
.head 9 -  Call SqlPrepareAndExecute(hSql(), '
     INSERT
     INTO kp_utel_R (LSCHET,ABON_ID,FIO,PUNKT,STREET,NDOM,KVARTIRA)
     VALUES (:sLSCHET,:sABON_ID,:sFIO,:sPUNKT,:sSTREET,:sNDOM,:sKVARTIRA)')
.head 8 -  Set nJ = nJ + 1
.head 7 -  Set colProgressDone = 'Готово !!!'
.head 7 -  Call SalFileClose(hF)
.head 6 +  Else
.head 7 -  Set colProgressDone = 'Нет ' || sFile
.head 6 -  !
.head 6 -  Set nTek = 0
.head 6 -  Set sFile = 'S' || Right(smFiles[0], Len(smFiles[0])-1)
.head 6 -  Call SalTblSetContext(kp_UTEL, 2)
.head 6 +  If File(dfKat || '\\' || sFile)
.head 7 -  Set colProgressDone = 'Импорт ...'
.head 7 -  Set nFileSize = VisFileGetSize(dfKat || '\\' || sFile)
.head 7 -  Call SalFileOpen(hF, dfKat || '\\' || sFile, OF_Read)
.head 7 -  Set dfFile = sFile || ' (3 из 3)'
.head 7 -  Set nJ = 0
.head 7 -  Set nTek = 0
.head 7 +  Loop
.head 8 -  Set sBuffer = Spac(512)
.head 8 +  If not SalFileGetStr(hF, sBuffer, 512)
.head 9 -  Break
.head 8 -  Set nTek = nTek + Len(sBuffer) + 1
.head 8 -  Call cc1.SetProgress(nTek/nFileSize*100)
.head 8 -  ! Call SalTblSetContext(kp_UTEL, 2)
.head 8 -  Set colRecc = nJ
.head 8 -  Call SalUpdateWindow(kp_UTEL)
.head 8 -  Set nInd = SalStrTokenize(sBuffer, '', '|', smTemp)
.head 8 +  If nInd > 7
.head 9 -  Set sLSCHET = smTemp[0]
.head 9 -  Set sABON_ID = smTemp[1]
.head 9 -  Set sGRUPPA = smTemp[2]
.head 9 -  Set sSALDO = smTemp[3]
.head 9 -  Set sSUM_NACH = smTemp[4]
.head 9 -  Set sSUM_AVANS = smTemp[5]
.head 9 -  Set sSUM_OPLAT = smTemp[6]
.head 9 -  Set sPENJA = smTemp[7]
.head 9 -  Call SqlPrepareAndExecute(hSql(), '
     INSERT
     INTO kp_utel_S (LSCHET,ABON_ID,GRUPPA,SALDO,SUM_NACH,SUM_AVANS,SUM_OPLAT,
                     PENJA)
     VALUES (:sLSCHET,:sABON_ID,:sGRUPPA,:sSALDO,:sSUM_NACH,:sSUM_AVANS,
             :sSUM_OPLAT,:sPENJA)')
.head 8 -  Set nJ = nJ + 1
.head 7 -  Set colProgressDone = 'Готово !!!'
.head 7 -  Call SalFileClose(hF)
.head 6 +  Else
.head 7 -  Set colProgressDone = 'Нет ' || sFile
.head 6 -  !
.head 6 -  Call SalHideWindow(cc1)
.head 6 -  Set dfFile = ''
.head 6 -  Call SalTblSetRowFlags(kp_UTEL, 0, ROW_Edited | ROW_New, FALSE)
.head 6 -  Call SalTblSetRowFlags(kp_UTEL, 1, ROW_Edited | ROW_New, FALSE)
.head 6 -  Call SalTblSetRowFlags(kp_UTEL, 2, ROW_Edited | ROW_New, FALSE)
.head 6 -  Call SalHideWindow(dfFIFI)
.head 6 -  ! вставить в kp_utel
.head 6 -  Set bU = SqlPrepareAndExecute(hSql(), '
    INSERT
    INTO kp_utel (LSCHET,ABON_ID,PHONE,FIO,GRUPPA,SALDO,SUM_NACH,SUM_AVANS,SUM_OPLAT,
                  PENJA)
    (SELECT s.LSCHET,s.ABON_ID,a.PHONE,a.FIO,s.GRUPPA,s.SALDO,s.SUM_NACH,s.SUM_AVANS,
            s.SUM_OPLAT,s.PENJA
     FROM kp_utel_s s, kp_utel_a a
     WHERE s.LSCHET=a.LSCHET and s.ABON_ID=a.ABON_ID)') and
    SqlPrepareAndExecute(hSql(), '
    INSERT
    INTO kp_utel (LSCHET,ABON_ID,FIO,GRUPPA,SALDO,SUM_NACH,SUM_AVANS,SUM_OPLAT,
                  PENJA,PUNKT,STREET,NDOM,KVARTIRA)
    (SELECT r.LSCHET,r.ABON_ID,r.FIO,s.GRUPPA,s.SALDO,s.SUM_NACH,s.SUM_AVANS,
            s.SUM_OPLAT,s.PENJA,r.PUNKT,r.STREET,r.NDOM,r.KVARTIRA
     FROM kp_utel_s s, kp_utel_r r
     WHERE s.LSCHET=r.LSCHET and s.ABON_ID=r.ABON_ID)')
.head 6 +  If bU
.head 7 -  Call SqlCommit(hSql())
.head 7 -  Call SalFileCreateDirectory(dfKat || '\\Archiv')
.head 7 -  Call VisFileCopy(dfKat || '\\A' || Right(sFile, 10), dfKat || '\\Archiv\\A' ||
     Right(sFile, 10))
.head 7 +  If File(dfKat || '\\Archiv\\A' || Right(sFile, 10))
.head 8 -  Call VisFileDelete(dfKat || '\\A' || Right(sFile, 10))
.head 7 -  Call VisFileCopy(dfKat || '\\S' || Right(sFile, 10), dfKat || '\\Archiv\\S' ||
     Right(sFile, 10))
.head 7 +  If File(dfKat || '\\Archiv\\S' || Right(sFile, 10))
.head 8 -  Call VisFileDelete(dfKat || '\\S' || Right(sFile, 10))
.head 7 -  Call VisFileCopy(dfKat || '\\R' || Right(sFile, 10), dfKat || '\\Archiv\\R' ||
     Right(sFile, 10))
.head 7 +  If File(dfKat || '\\Archiv\\R' || Right(sFile, 10))
.head 8 -  Call VisFileDelete(dfKat || '\\R' || Right(sFile, 10))
.head 7 -  Call SalHideWindow(cc1)
.head 7 -  Call SalShowWindow(dfDone)
.head 7 -  Set dfDone = 'Готово'
.head 7 -  Call SalHideWindow(dfFIFI)
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  ! Call SalTblSetFlagsAnyRows(kp_UTEL, ROW_New, FALSE, 0, 0)
.head 6 +  Else
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call SalDestroyWindow(kp_UTEL)
.head 5 +  Else
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Call MessageNoWait('Импорт UTEL. Невозможно удалить старую информацию из KP_UTEL. '
     || 'Никаких изменений в информации не ВЫПОЛНЕНО.', 'ВНИМАНИЕ !!!', 7, 1)
.head 6 -  Call SalDestroyWindow(kp_UTEL)
.head 4 +  Else
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Call MessageNoWait('Импорт UTEL. Отсутствуют файлы для импорта (' || dfKat ||
     '\\A??????.UNL)', 'ВНИМАНИЕ !!!', 7, 1)
.head 5 -  Call SalDestroyWindow(kp_UTEL)
.head 1 +  Dialog Box: dlgExportWH  ! Выгрузка в ХД по заданной дате
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Выгрузка данных в ХД за дату
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   2.838"
.head 4 -  Top:    1.885"
.head 4 -  Width:  4.35"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.167"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Midnight Blue
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Bottom
.head 4 -  Visible? Yes
.head 4 -  Size: 0.143"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  ! Data Field: dfPass
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 16
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.367"
.head 6 -  Top:    0.417"
.head 6 -  Width:  1.317"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Invisible
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.end
.head 4 +                              Message Actions
.head 5 +                              On SAM_Validate
.head 6 +                              If dfPass=STRING_Null
.head 7 -                              Call SalSetFocus( pbExit )
.head 7 -                              Return VALIDATE_OkClearFlag
.head 6 +                              If TRUE ! dfPass=SqlPassword
.head 7 -                              Call SalEnableWindow( pbLoc )
.head 7 -                              Call SalEnableWindow( pbGlb)
.head 7 -                              Call SalEnableWindow( dfLoca)
.head 7 -                              Call SalDisableWindow(hWndItem)
.head 7 -                              Call SalSetFocus( dfLoca )
.head 7 -                              Return VALIDATE_OkClearFlag
.head 6 -                              Return VALIDATE_Cancel
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отменить
.head 4 -  Window Location and Size
.head 5 -  Left:   2.633"
.head 5 -  Top:    1.119"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, IDCANCEL )
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выгрузить
.head 4 -  Window Location and Size
.head 5 -  Left:   0.483"
.head 5 -  Top:    1.119"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.45"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Apply.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SqlPLSQLCommand( hSql(), 'wh_extract.extract_objects2( dfDat )')
.head 7 -  Call SalMessageBox('Выгрузка данных успешно завершена', 'Сообщение', 0)
.head 7 -  Call SqlCommit( hSql() )
.head 6 -  Call SalSetFocus( pbCancel )
.head 3 +  Data Field: dfDat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.733"
.head 6 -  Top:    0.607"
.head 6 -  Width:  2.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If not SalIsValidDateTime( hWndItem )
.head 7 -  ! Call SalMessageBox( 'Ош. формат даты', 'Ошибка.', MB_IconExclamation )
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_SetLocDat.cTErrDateFormat'),
  CurrentLangTable.GetAtomTitle('DlgMSG_Error'), MB_IconExclamation )
.head 7 -  Return VALIDATE_Cancel
.head 6 -  Return VALIDATE_OkClearFlag
.head 3 -  Frame
.head 4 -  Resource Id: 14473
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.071"
.head 5 -  Width:  4.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 2
.head 4 -  Border Color: System Frame Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: Укажите дату выгрузки
.head 4 -  Resource Id: 14474
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.683"
.head 5 -  Top:    0.345"
.head 5 -  Width:  2.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: strPar01
.head 3 -  String: strPar02
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndItem)
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_SetLocDat.cTWndTitle'))
.head 4 -  Call SalSetFocus( pbCancel )
.head 4 -  Set dfDat=GetBankDate()
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Form Window: importANELIKcode
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Импорт справочника кодов пунктов АНЕЛИК
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   3.425"
.head 4 -  Top:    1.563"
.head 4 -  Width:  9.633"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 1.726"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: импорт кодов пунктов АНЕЛИК
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbRun
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbExecute
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.071"
.head 5 -  Width:  1.35"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  If VisDosEnumFiles(sOtkuda || '\\*.*', FA_Standard, smFiles) < 0
.head 7 -  Set dfT = 'Отсутствует файл кодов пунктов ...'
.head 7 -  Return FALSE
.head 6 -  Set sFile = sOtkuda || '\\' || smFiles[0]
.head 6 -  ! Call Debug(smFiles[0])
.head 6 -  ! Call Debug(sFile)
.head 6 -  Set nLength = VisFileGetSize(sFile)
.head 6 -  Set bZag = TRUE
.head 6 -  Set bDir = TRUE
.head 6 -  Set bChr = TRUE
.head 6 +  If not (SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM anelik_tmp_points') and SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM anelik_tmp_direct') and SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM anelik_tmp_charges') and SqlPrepareAndExecute(hSql(), '
   DELETE
   FROM anelik_kod'))
.head 7 -  Set dfT = 'Ошибка при очистке временных таблиц ...'
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Return FALSE
.head 6 +  If not SalFileOpen(fH, sFile, OF_Read)
.head 7 -  Set dfT = 'Ошибка при открытии файла ' || sFile || ' ...'
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Return FALSE
.head 6 -  Set nPos = 0
.head 6 -  Call ccA.SetProgress(0)
.head 6 +  While TRUE
.head 7 -  Set sBuffer = Spac(256)
.head 7 -  Call SalFileGetStr(fH, sBuffer, 256)
.head 7 -  ! Call Debug(sBuffer)
.head 7 -  ! Call DebugN(Len(sBuffer))
.head 7 +  If bZag
.head 8 +  If Len(sBuffer) = 6 and sBuffer = 'POINTS'
.head 9 -  Set nPos = nPos + Len(sBuffer) + 2
.head 9 -  Set bZag = FALSE
.head 9 -  Set dfT = 'Наполнение временной таблицы пунктов ...'
.head 8 +  Else
.head 9 -  Set dfT = 'Неверна структура входного файла ...'
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Call SalFileClose(fH)
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 +  If bDir
.head 9 +  If Len(sBuffer) = 3 and sBuffer = 'END'
.head 10 -  Set nPos = nPos + Len(sBuffer) + 2
.head 9 +  Else If Len(sBuffer) = 10 and sBuffer = 'DIRECTIONS'
.head 10 -  Set nPos = nPos + Len(sBuffer) + 2
.head 10 -  Set bDir = FALSE
.head 10 -  Set dfT = 'Наполнение временной таблицы направлений ...'
.head 9 +  Else
.head 10 -  ! мочим POINTS
.head 10 -  Set nPos = nPos + Len(sBuffer) + 2
.head 10 -  Call SalStrTokenize(sBuffer, '', '=', smTemp)
.head 10 -  Set sKod =  smTemp[0]
.head 10 -  Set sBank = smTemp[1]
.head 10 -  Set sCity = smTemp[2]
.head 10 -  Set sFl   = smTemp[3]
.head 10 -  Set sAdr  = smTemp[4]
.head 10 -  Set sTel  = smTemp[5]
.head 10 -  Set sFill = smTemp[6]
.head 10 -  Set sTim1 = smTemp[7]
.head 10 -  Set sTim2 = smTemp[8]
.head 10 -  Set sTim3 = smTemp[9]
.head 10 -  Set sSum1 = smTemp[10]
.head 10 -  Set sSum2 = smTemp[11]
.head 10 +  If sFl = '1'
.head 11 +  If not SqlPrepareAndExecute(hSql(), '
   INSERT
   INTO anelik_tmp_points (kod,bank,city,fl,adr,tel,fill,tim1,tim2,tim3,sum1,sum2)
   VALUES (:sKod,:sBank,:sCity,:sFl,:sAdr,:sTel,:sFill,:sTim1,:sTim2,:sTim3,:sSum1,:sSum2)')
.head 12 -  Set dfT = 'Ошибка при наполнении anelik_tmp_points ...'
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Call SalFileClose(fH)
.head 12 -  Return FALSE
.head 8 +  Else
.head 9 +  If bChr
.head 10 +  If Len(sBuffer) = 3 and sBuffer = 'END'
.head 11 -  Set nPos = nPos + Len(sBuffer) + 2
.head 10 +  Else If Len(sBuffer) = 7 and sBuffer = 'CHARGES'
.head 11 -  Set nPos = nPos + Len(sBuffer) + 2
.head 11 -  Set bChr = FALSE
.head 11 -  Set dfT = 'Наполнение временной таблицы расходов ...'
.head 10 +  Else
.head 11 -  ! мочим DIRECTIONS
.head 11 -  Set nPos = nPos + Len(sBuffer) + 2
.head 11 -  Call SalStrTokenize(sBuffer, '', '=', smTemp)
.head 11 -  Set sBank = smTemp[0]
.head 11 -  Set sNai1 = smTemp[1]
.head 11 -  Set sNai2 = smTemp[2]
.head 11 -  Set sCntr = smTemp[3]
.head 11 -  Set sFl   = smTemp[4]
.head 11 -  ! Call Debug(sBank)
.head 11 +  If not SqlPrepareAndExecute(hSql(), '
   INSERT
   INTO anelik_tmp_direct (bank,nai1,nai2,cntr,fl)
   VALUES (:sBank,:sNai1,:sNai2,:sCntr,:sFl)')
.head 12 -  Set dfT = 'Ошибка при наполнении anelik_tmp_direct ...'
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Call SalFileClose(fH)
.head 12 -  Return FALSE
.head 9 +  Else
.head 10 +  If Len(sBuffer) = 3 and sBuffer = 'END'
.head 11 -  Set nPos = nPos + Len(sBuffer) + 2
.head 11 -  ! Call DebugN(nPos)
.head 11 -  ! конец фильма
.head 11 -  Break
.head 10 +  Else
.head 11 -  ! мочим CHARGES
.head 11 -  Set nPos = nPos + Len(sBuffer) + 2
.head 11 -  Call SalStrTokenize(sBuffer, '', '=', smTemp)
.head 11 -  Set sKod = smTemp[0]
.head 11 -  Set sP1  = smTemp[1]
.head 11 -  Set sS1  = smTemp[2]
.head 11 -  Set sP2  = smTemp[3]
.head 11 -  Set sS2  = smTemp[4]
.head 11 -  Set sP3  = smTemp[5]
.head 11 -  Set sS3  = smTemp[6]
.head 11 -  ! Call Debug(sBank)
.head 11 +  If not SqlPrepareAndExecute(hSql(), '
   INSERT
   INTO anelik_tmp_charges (kod,p1,s1,p2,s2,p3,s3)
   VALUES (:sKod,:sP1,:sS1,:sP2,:sS2,:sP3,:sS3)')
.head 12 -  Set dfT = 'Ошибка при наполнении anelik_tmp_charges ...'
.head 12 -  Call SqlRollback(hSql())
.head 12 -  Call SalFileClose(fH)
.head 12 -  Return FALSE
.head 7 -  Call ccA.SetProgress(nPos/nLength*100)
.head 6 -  Call SalFileClose(fH)
.head 6 -  Set dfT = 'Наполнение справочника префиксов пунктов переводов АНЕЛИК ...'
.head 6 -  Set bFd = TRUE
.head 6 -  Set sTemp = ', '
.head 6 +  If not SqlPrepareAndExecute(hSql(), '
   INSERT
   INTO
   anelik_kod (SELECT p.kod,d.nai1 || :sTemp || p.city || :sTemp || p.adr,d.cntr,p.city,p.tel,p.tim1,p.tim2,p.tim3,
                      p.sum1,p.sum2,c.p3,c.s3
               FROM anelik_tmp_points p, anelik_tmp_direct d, anelik_tmp_charges c
               WHERE p.bank=d.bank and d.bank=c.kod(+))')
.head 7 -  Set dfT = 'Ошибка при наполнении anelik_kod ...'
.head 7 -  Set bFd = FALSE
.head 7 -  Call SqlRollback(hSql())
.head 7 -  Return FALSE
.head 6 +  Else
.head 7 -  Call SqlCommit(hSql())
.head 6 -  Call ccA.SetProgress(100)
.head 6 +  If bFd
.head 7 -  Call SalFileCreateDirectory(sOtkuda || '\\Ok')
.head 7 -  Call SalFileCopy(sFile, sOtkuda || '\\Ok\\' || smFiles[0], TRUE)
.head 7 -  Call VisFileDelete(sFile)
.head 7 -  Set dfT = 'Наполнение справочника закончено. Жмите ВЫХОД ...'
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   7.783"
.head 5 -  Top:    0.071"
.head 5 -  Width:  1.35"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 3 +  Custom Control: ccA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.5"
.head 6 -  Top:    0.071"
.head 6 -  Width:  6.233"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.452"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Aqua
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Multiline Field: dfT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  String Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Window Location and Size
.head 6 -  Left:   0.117"
.head 6 -  Top:    0.524"
.head 6 -  Width:  9.017"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.583"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  ! Function: DaySymbol
.head 4 -  Description: преобразовывает день в символ
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Date/Time: dDa
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nDa
.head 5 -  String: sDay
.head 4 +  Actions
.head 5 -  Set nDa = SalDateDay(dDa)
.head 5 +  If nDa < 10
.head 6 -  Set sDay = Str(nDa)
.head 5 +  Else
.head 6 -  Set sDay = SalNumberToChar(nDa+55)
.head 5 -  Return sDay
.head 3 +  ! Function: MonthSymbol
.head 4 -  Description: преобразовывает месяц в символ
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Date/Time: dDa
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nMo
.head 5 -  String: sMonth
.head 4 +  Actions
.head 5 -  Set nMo = SalDateMonth(dDa)
.head 5 +  If nMo<10
.head 6 -  Set sMonth = Str(nMo)
.head 5 +  Else
.head 6 -  Set sMonth = SalNumberToChar(nMo+55)
.head 5 -  Return sMonth
.head 3 +  ! Function: YearSymbol
.head 4 -  Description: преобразовывает год в символ
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Date/Time: dDa
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nY
.head 5 -  ! String: sYear
.head 4 +  Actions
.head 5 -  Set nY = SalNumberMax(SalDateYear(dDa) - 1998, 0)
.head 5 +  ! If nY < 10
.head 6 -  Set sYear = Str(nY)
.head 5 +  ! Else
.head 6 -  Set sYear = SalNumberToChar(nY+55)
.head 5 -  ! Set sYear = IifS(nY<10, Str(nY), SalNumberToChar(nY+55))
.head 5 -  ! Return sYear
.head 5 -  Return IifS(nY<10, Str(nY), SalNumberToChar(nY+55))
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: sOtkuda
.head 3 -  Number: nPos
.head 3 -  Number: nDelta
.head 3 -  Boolean: bZag
.head 3 -  Boolean: bDir
.head 3 -  Boolean: bChr
.head 3 -  Boolean: bFd
.head 3 -  File Handle: fH
.head 3 -  Number: nLenArr
.head 3 -  !
.head 3 -  String: sBuffer
.head 3 -  String: smFiles[*]
.head 3 -  String: smTemp[*]
.head 3 -  String: sFile
.head 3 -  Number: nLength
.head 3 -  String: sKod
.head 3 -  String: sBank
.head 3 -  String: sCity
.head 3 -  String: sFl
.head 3 -  String: sAdr
.head 3 -  String: sTel
.head 3 -  String: sFill
.head 3 -  String: sTim1
.head 3 -  String: sTim2
.head 3 -  String: sTim3
.head 3 -  String: sSum1
.head 3 -  String: sSum2
.head 3 -  String: sNai1
.head 3 -  String: sNai2
.head 3 -  String: sCntr
.head 3 -  String: sTemp
.head 3 -  !
.head 3 -  String: sP1
.head 3 -  String: sS1
.head 3 -  String: sP2
.head 3 -  String: sS2
.head 3 -  String: sP3
.head 3 -  String: sS3
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('AnelikTerm', 'FileCode', GetPrnDir(), sOtkuda, GetIniFileName())
.head 4 -  Set sOtkuda = IifS(Right(sOtkuda, 1)='\\', Left(sOtkuda, Len(sOtkuda)-1), sOtkuda)
.head 1 +  Table Window: frm_WHHistory
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: История выполнения выгрузки данных
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 65000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 18126
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  5.25"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  5.25"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 18127
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.683"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 18128
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 18129
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  4.55"
.head 6 -  Begin Y:  -0.071"
.head 6 -  End X:  4.55"
.head 6 -  End Y:  0.393"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbChkResult
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\resource\bmp\VIEW.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call ShowChkDetails(colExecID)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_WHHistory.cBTipChkResult')
.head 7 -  ! Call SalSendClassMessage(SAM_Create, 0, 0)
.head 2 +  Contents
.head 3 +  Column: colExecID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ид.
сеанса
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colExtrStart
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
выполнения выгрузки
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.983"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: DateTime
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colExtrDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
выгрузки
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.3"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Date
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colExtrType
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Тип
выгрузки
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Center
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colExtrObj
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Объект
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colExecChk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Результат
проверки данных
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.65"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colExtrStat
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Состояние
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colExtrErr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сообщение процедуры выгрузки
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.717"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: ShowChkDetails
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nExecID
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nChkID
.head 5 -  String: strChkText
.head 4 +  Actions
.head 5 +  While TRUE
.head 6 +  If not SqlPLSQLCommand(hSql(), "wh_extr_utl.get_check_info(nExecID, nChkID, strChkText)")
.head 7 -  Break
.head 6 +  If nChkID = NUMBER_Null
.head 7 -  Call SalMessageBox(strChkText, "Просмотр результатов проверки", MB_Ok)
.head 6 +  Else
.head 7 +  If not IsWindow(hWinLog)
.head 8 -  Set hWinLog = SalCreateWindow(frm_WHChkLog, hWndForm, nChkID)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop(frm_WHChkLog)
.head 6 -  Break
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Window Handle: hWinLog
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_WHHistory.cTWndTitle'))
.head 4 -  Set nFlags = GT_ReadOnly
.head 4 -  Call SalDisableWindow(pbDetails)
.head 4 -  Set strFilterTblName='V_WH_EXTR_EXECUTIONS'
.head 4 -  Set strPrintFileName = 'whhist.txt'
.head 4 -  Set fFilterAtStart=TRUE
.head 4 -  Set strSqlPopulate = "
    select exec_id, extract_start, extract_date, extract_type, extract_object, exec_check, extract_status, extract_error2
      into :colExecID, :colExtrStart, :colExtrDate, :colExtrType, :colExtrObj, :colExecChk, :colExtrStat, :colExtrErr
      from v_wh_extr_executions
    order by exec_id"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 4 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Table Window: frm_WHChkLog
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Протокол проверки
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 65000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 53328
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 53329
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 53330
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: colChkMsgID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ид.
сообщения
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colChkMsgType
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Тип
сообщения
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colChkMsgText
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Текст
сообщения
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Long String
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colChkSrcCol
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Столбец
исх. таблицы
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colChkSrcID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ид. строки
исх. таблицы
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colWHObj
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Объект
хранилища
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nPar01
.head 2 +  Window Variables
.head 3 -  Number: nChkID
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_WHChkLog.cTWndTitle'))
.head 4 -  Set nFlags = GT_ReadOnly
.head 4 -  Call SalDisableWindow(pbDetails)
.head 4 -  ! Заполняем локальные переменные
.head 4 -  Set nChkID = nPar01
.head 4 -  Set strFilterTblName='V_WH_EXTR_CHKERRORDATA'
.head 4 -  Set strPrintFileName = 'whchklog.txt'
.head 4 -  Set nTabInstance = 1
.head 4 -  Set strSqlPopulate = "
    select chkmsgid, chkmsgtype, chkmsgtext, chksrccol, chksrcid, chkwhobj
      into :colChkMsgID, :colChkMsgType, :colChkMsgText, :colChkSrcCol, :colChkSrcID, :colWHObj
      from v_wh_extr_chkerrordata
    where chk_id = :nChkID
    order by chkmsgid"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 4 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Table Window: frm_WHChkList
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Выгруженные данные с ошибками
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 65000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 53331
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call ShowChkLog(colChkID)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 53332
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 53333
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: colChkID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ид.
протокола
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colChkDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
проверки
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Date
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colChkCreated
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата и время
выполнения проверки
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  2.1"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Date
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colChkRows
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кол-во строк
протокола
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: ShowChkLog
.head 4 -  Description: Вызывает форму показа протокола проверки
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nChkID
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nChkID != NUMBER_Null
.head 6 +  If not IsWindow(hWinLog)
.head 7 -  Set hWinLog = SalCreateWindow(frm_WHChkLog, hWndForm, nChkID)
.head 6 +  Else
.head 7 -  Call SalBringWindowToTop(frm_WHChkLog)
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Window Handle: hWinLog
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_WHChkList.cTWndTitle'))
.head 4 -  Set nFlags = GT_ReadOnly
.head 4 -  Set strFilterTblName='V_WH_EXTR_CHKERRORS'
.head 4 -  Set strPrintFileName = 'whchklist.txt'
.head 4 -  Set strSqlPopulate = "
    select chk_id, chk_date, chk_created, chk_rows
      into :colChkID, :colChkDate, :colChkCreated, :colChkRows
      from v_wh_extr_chkerrors
    order by chk_id"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 4 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_DoubleClick
.head 4 -  Call ShowChkLog(colChkID)
.head 1 +  Table Window: R3XML
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Импорт файлов от R3 в формате XML
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   2.388"
.head 4 -  Top:    0.927"
.head 4 -  Width:  10.417"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.321"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description: Импорт файлов от R3 в формате XML
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.738"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.933"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 8448
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbOne
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.533"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\rep_solo.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndForm, SAM_DoubleClick, 0, 0)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = IifS(GetLang()='RUS', 'Принять файл', IifS(GetLang()='UKR', 'Прийняти файл', 'To accept the file'))
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 8449
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.383"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 8450
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  ! ! ! Background Text: Файл импорта
.head 4 +  Data Field: dfKatIn
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.783"
.head 7 -  Top:    0.44"
.head 7 -  Width:  7.25"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.214"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbAll
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\list.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set nCurrentRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(hWndForm, nCurrentRow, ROW_New, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nCurrentRow)
.head 8 -  Call SalTblSetFocusRow(hWndForm, nCurrentRow)
.head 8 -  Call Import_Dok(colFileName, nCurrentRow)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = IifS(GetLang()='RUS', 'Принять ВСЕ файлы',
    IifS(GetLang()='UKR', 'Прийняти ВСІ файли', 'To accept ALL files'))
.head 4 +  Data Field: dfKI
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.083"
.head 7 -  Top:    0.44"
.head 7 -  Width:  2.65"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: colFileName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Файл импорта
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  5.033"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  ! Column: colStatus
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Состояние
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  3.233"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.end
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colProgressDone
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Действие
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  4.433"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: Import_Dok
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sNameFile
.head 5 -  Number: nCurrentR
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set colProgressDone = IifS(GetLang()='RUS', 'Импорт', IifS(GetLang()='UKR', 'Імпорт', 'Import')) || ' ...'
.head 5 -  Set bU = FALSE
.head 5 -  !
.head 5 -  ! обработка
.head 5 +  If SqlPrepareAndExecute(hSql(), '
   begin
      p_trunc_tmp_sgi;
   end;')
.head 6 +  If PutFileToClob(hSql(), dfKatIn || '\\' || sNameFile, 'tmp_sgi', 'id', 'txt_data', 0, '', '', 1)
.head 7 +  If SqlPrepareAndExecute(hSql(), '
   begin
      bars_r3.import_xml;
   end;' )
.head 8 -  Set sTEXT = GetStringFromClob(hSql(), 'r3_ticket_xml', 'id', 'txt_data', NUMBER_Null, 'ticket', '')
.head 8 +  If sTEXT
.head 9 -  ! записать sTEXT в файл тикета
.head 9 -  Set nT = At('.', sNameFile)
.head 9 -  Set sTemp = Right(sNameFile, Len(sNameFile)-nT)
.head 9 -  Set nT2 = At('.', sTemp)
.head 9 +  While nT2 > 0
.head 10 -  Set nT = nT + nT2
.head 10 -  Set sTemp = Right(sTemp, Len(sTemp)-nT2)
.head 10 -  Set nT2 = At('.', sTemp)
.head 9 -  ! Call DebugN(nT)
.head 9 -  Set sTicName = Left(sNameFile, nT) || 'ticket.' || Right(sTemp, Len(sNameFile)-nT)
.head 9 -  Call SalFileOpen(fH, sKatTemp || '\\' || sTicName, OF_Create | OF_Write)
.head 9 -  ! Call Debug(sTEXT)
.head 9 -  Call SalFileWrite(fH, sTEXT, Len(sTEXT))
.head 9 -  Call SalFileClose(fH)
.head 9 -  Call SalFileCopy(sKatTemp || '\\' || sTicName, sKatOut || '\\' || sTicName, TRUE)
.head 9 -  Call VisFileDelete(sKatTemp || '\\' || sTicName)
.head 9 -  Set colProgressDone = IifS(GetLang()='RUS' or GetLang()='UKR', 'Готово', 'It is prepared') || ' !!!'
.head 9 -  Set bU = TRUE
.head 8 +  Else
.head 9 -  Set colProgressDone = IifS(GetLang()='RUS', 'Ошибка создания файла тикета', IifS(GetLang()='UKR',
    'Помилка створення файлу тікета', 'Error of the creation of the file of tiсket')) || ' ...'
.head 7 +  Else
.head 8 -  Set colProgressDone = IifS(GetLang()='RUS', 'Ошибка импорта входного файла', IifS(GetLang()='UKR',
    'Помилка імпорту вхідного файлу', 'Error of the import of the input file')) || ' ...'
.head 6 +  Else
.head 7 -  Set colProgressDone = IifS(GetLang()='RUS', 'Ошибка чтения входного файла', IifS(GetLang()='UKR',
    'Помилка читання вхідного файлу', 'Error of reading the input file')) || ' ...'
.head 5 +  Else
.head 6 -  Set colProgressDone = IifS(GetLang()='RUS', 'Ошибка очистки временной таблицы', IifS(GetLang()='UKR',
    'Помилка очищення тимчасової таблиці', 'Error of cleaning the temporary table')) || ' ...'
.head 5 -  Call SalTblSetRowFlags(hWndForm, nI, ROW_Edited | ROW_New, FALSE)
.head 5 -  Call SalFileCreateDirectory(sKatCopyIn)
.head 5 -  Call VisFileCopy(dfKatIn || '\\' || sNameFile, sKatCopyIn || '\\' || sNameFile)
.head 5 +  If File(sKatCopyIn || '\\' || sNameFile)
.head 6 -  Call VisFileDelete(dfKatIn || '\\' || sNameFile)
.head 5 -  Call SalTblSetRowFlags(hWndForm, nCurrentR, ROW_New, FALSE)
.head 3 +  Function: Naselenie
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalTblReset(hWndForm)
.head 5 -  Set nFiles = VisDosEnumFiles(dfKatIn || '\\*.*', FA_Standard, smFiles)
.head 5 -  ! вычитываем каталог и обрабатываем файлы *.*
.head 5 +  If nFiles > 0
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set nI = 0
.head 6 +  While nI < nFiles
.head 7 -  Set nRow = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 -  Set colFileName = smFiles[nI]
.head 7 -  Set nI = nI + 1
.head 6 -  Call SalTblSetContext(hWndForm, 0)
.head 6 -  Call SalTblSetFocusRow(hWndForm, 0)
.head 6 -  Call SalTblSetRowFlags(hWndForm, 0, ROW_New | ROW_Selected, TRUE)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  Else
.head 6 -  Call MessageNoWait(IifS(GetLang()='RUS', 'Импорт из R3. Отсутствуют файлы для импорта (', IifS(GetLang()='UKR',
    'Імпорт з R3. Відсутні файли для імпорту (', 'Import from R3. There are no files for the import (')) || dfKatIn ||
    '\\*.*)', IifS(GetLang()='RUS', 'ВНИМАНИЕ !!!', IifS(GetLang()='UKR', 'УВАГА !!!', 'ATTENTION!!!')), 7, 1)
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nFiles
.head 3 -  Number: nI
.head 3 -  Boolean: bU
.head 3 -  String: smFiles[*]
.head 3 -  Long String: sTEXT
.head 3 -  String: sKatOut
.head 3 -  String: sKatCopyIn
.head 3 -  String: sKatTemp
.head 3 -  File Handle: fH
.head 3 -  Number: nT
.head 3 -  Number: nT2
.head 3 -  String: sTicName
.head 3 -  String: sTemp
.head 3 -  Number: nCurrentRow
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Set nFlags = GT_ReadOnly
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalDisableWindow(pbDel)
.head 4 -  Call SalDisableWindow(pbIns)
.head 4 -  ! Call SalDisableWindow(pbRefresh)
.head 4 -  Call SalDisableWindow(pbUpdate)
.head 4 -  Call SalDisableWindow(pbSearch)
.head 4 -  Call SalDisableWindow(pbFilter)
.head 4 -  ! Call SalDisableWindow(pbDetails)
.head 4 -  Call SalDisableWindow(pbPrint)
.head 4 -  Call SalUseRegistry(FALSE, '')
.head 4 -  Call SalGetProfileString('Import', 'XmlR3_In', 'C:\\R3\\IN', dfKatIn, GetIniFileName())
.head 4 -  Call SalGetProfileString('Import', 'XmlR3_Out', 'C:\\R3\\OUT', sKatOut, GetIniFileName())
.head 4 -  Call SalGetProfileString('Import', 'XmlR3_CopyIn', 'C:\\R3\\OUT', sKatCopyIn, GetIniFileName())
.head 4 -  Call SalGetProfileString('Import', 'XmlR3_Temp', 'C:\\R3\\OUT', sKatTemp, GetIniFileName())
.head 4 -  Set dfKatIn = IifS(Right(dfKatIn, 1)='\\', Left(dfKatIn, Len(dfKatIn)-1), dfKatIn)
.head 4 -  Set sKatOut = IifS(Right(sKatOut, 1)='\\', Left(sKatOut, Len(sKatOut)-1), sKatOut)
.head 4 -  Set sKatCopyIn = IifS(Right(sKatCopyIn, 1)='\\', Left(sKatCopyIn, Len(sKatCopyIn)-1), sKatCopyIn)
.head 4 -  Set sKatTemp = IifS(Right(sKatTemp, 1)='\\', Left(sKatTemp, Len(sKatTemp)-1), sKatTemp)
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_CreateComplete
.head 4 -  Set dfKI = IifS(GetLang()='RUS', 'Каталог импорта', IifS(GetLang()='UKR', 'Каталог імпорту', 'Catalog of the import'))
.head 4 +  If GetLang() = 'UKR'
.head 5 -  Call SalTblSetColumnTitle(colFileName, 'Файл імпорту')
.head 5 -  Call SalTblSetColumnTitle(colProgressDone, 'Дія')
.head 4 -  Call Naselenie()
.head 3 +  On UM_Populate
.head 4 -  Call Naselenie()
.head 4 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 3 +  On SAM_DoubleClick
.head 4 +  If SalTblQueryRowFlags(hWndForm, lParam, ROW_New)
.head 5 -  Call Import_Dok(colFileName, lParam)
.head 1 +  Dialog Box: dlgPolKB
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: ЗАПРОС
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   4.413"
.head 4 -  Top:    4.156"
.head 4 -  Width:  10.117"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.738"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Salmon
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: ПЕРЕДАТЬ полномочия по обработке документов КЛИЕНТ-БАНК
.head 4 -  Resource Id: 50079
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.283"
.head 5 -  Top:    0.226"
.head 5 -  Width:  7.533"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Fixedsys
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Salmon
.head 3 -  Background Text: исполнителя
.head 4 -  Resource Id: 50080
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.383"
.head 5 -  Top:    0.583"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Fixedsys
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: исполнителю
.head 4 -  Resource Id: 50081
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.383"
.head 5 -  Top:    0.94"
.head 5 -  Width:  2.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Fixedsys
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfIdFrom
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.783"
.head 6 -  Top:    0.583"
.head 6 -  Width:  4.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Salmon
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfIdTo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.783"
.head 6 -  Top:    0.94"
.head 6 -  Width:  4.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Salmon
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: с
.head 4 -  Resource Id: 50082
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.433"
.head 5 -  Top:    1.381"
.head 5 -  Width:  0.217"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Fixedsys
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: по
.head 4 -  Resource Id: 50083
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.917"
.head 5 -  Top:    1.381"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Fixedsys
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   5.55"
.head 6 -  Top:    1.357"
.head 6 -  Width:  2.717"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: DateTime
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Light Gray
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Применить
.head 4 -  Window Location and Size
.head 5 -  Left:   2.983"
.head 5 -  Top:    1.845"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set dOt = dfFrom
.head 6 -  Set dDo = dfTo
.head 6 -  Call SalEndDialog(hWndForm, 0)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbLabeledCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.75"
.head 5 -  Top:    1.833"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog(hWndForm, 1)
.head 3 +  Data Field: dfFrom
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.85"
.head 6 -  Top:    1.357"
.head 6 -  Width:  2.717"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: DateTime
.head 5 -  Country: Default
.head 5 -  Font Name: Fixedsys
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: sFrom
.head 3 -  String: sTo
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_CreateComplete
.head 4 -  Set dfIdFrom = sFrom
.head 4 -  Set dfIdTo = sTo
.head 4 -  Set dfFrom = SalDateCurrent()
.head 3 +  On SAM_Close
.head 4 -  Call SalEndDialog(hWndForm, 1)
