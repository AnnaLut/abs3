.head 0 +  Application Description: BARS-VEGA сервисные функции
"УНИТИ-БАРС" (С) 2001
Сыропоршнев Д.Л., Щетенюк С.П.
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000E50000 002C000000020000 0003000000FFFFFF FFFFFFFFFFFCFFFF
0040: FFE9FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.data DT_MAKERUNDLG
0000: 02000000001E513A 5C4241525339385C 4C4942524152595C 6261727376656761
0020: 2E6578651E513A5C 4241525339385C4C 4942524152595C62 617273766567612E
0040: 646C6C1E513A5C42 41525339385C4C49 42524152595C6261 7273766567612E61
0060: 706300000101011E 513A5C4241525339 385C4C4942524152 595C626172737665
0080: 67612E72756E1E51 3A5C424152533938 5C4C494252415259 5C62617273766567
00A0: 612E646C6C1E513A 5C4241525339385C 4C4942524152595C 6261727376656761
00C0: 2E61706300000101 011A513A5C424152 5339385C42494E5C 6261727376656761
00E0: 2E6170641A513A5C 4241525339385C42 494E5C6261727376 6567612E646C6C1A
0100: 513A5C4241525339 385C42494E5C6261 7273766567612E61 706300000101011E
0120: 513A5C4241525339 385C4C4942524152 595C626172737665 67612E61706C1E51
0140: 3A5C424152533938 5C4C494252415259 5C62617273766567 612E646C6C1E513A
0160: 5C4241525339385C 4C4942524152595C 6261727376656761 2E61706300000101
0180: 01
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0418B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  Dynalib: Absapi.apd
.head 2 -  Dynalib: Global.apd
.head 2 -  File Include: Gentbl.apl
.head 2 -  File Include: XSALCPT.APL
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 +  External Functions
.head 3 -  !
.head 3 +  ! Library name: vegaman.dll
.head 4 +  Function: CallTestDialog
.head 5 -  Description: 
.head 5 -  Export Ordinal: 0
.head 5 +  Returns 
.head 6 -  Number: LONG
.head 5 +  Parameters 
.head 6 -  Window Handle: HWND
.head 3 +  Library name: VEGA32.DLL
.head 4 +  Function: VegaGetVer
.head 5 -  Description: int GLOBAL VegaGetVer
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 -  Parameters
.head 4 +  Function: VegaSetBuf
.head 5 -  Description: int GLOBAL VegaSetBuf (void *Buf,int len)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  String: LPCSTR
.head 6 -  Number: INT
.head 4 +  Function: VegaCheckDB
.head 5 -  Description: int GLOBAL VegaCheckDB
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 -  Parameters
.head 4 +  Function: VegaSetDate
.head 5 -  Description: int GLOBAL VegaSetDate
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  String: LPCSTR
.head 4 +  Function: VegaOpen
.head 5 -  Description: int GLOBAL VegaOpen (File Config,char *VegaPath, pVegaSES xVS)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  String: LPCSTR
.head 6 -  String: LPCSTR
.head 6 -  Number: DWORD
.head 6 -  ! String: LPCSTR
.head 4 +  Function: VegaClose
.head 5 -  Description: int GLOBAL VegaClose ( pVegaSES xVS )
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  Number: DWORD
.head 6 -  ! String: LPCSTR
.head 4 +  Function: VegaLoadSecKey
.head 5 -  Description: int GLOBAL VegaLoadSecKey (File SKPath,char *Psw,char *Id, pVegaSES xVS)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  String: LPCSTR
.head 6 -  String: LPCSTR
.head 6 -  String: LPCSTR
.head 6 -  Number: DWORD
.head 6 -  ! String: LPCSTR
.head 4 +  Function: VegaDelSecKey
.head 5 -  Description: int GLOBAL VegaDelSecKey (char *Id, pVegaSES xVS)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  String: LPCSTR
.head 6 -  String: LPCSTR
.head 4 +  Function: VegaEnsignGet
.head 5 -  Description: int GLOBAL VegaEnsignGet (void *Sign,void *IdR,void *Id, pVegaWA V,  pVegaSES xVS)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  String: LPCSTR
.head 6 -  String: LPCSTR
.head 6 -  String: LPCSTR
.head 6 -  String: LPCSTR
.head 6 -  String: LPCSTR
.head 4 +  Function: VegaEnsign
.head 5 -  Description: int GLOBAL VegaEnsign (void *Sign,void *Mess,word Len,void *IdR, void *Id, pVegaWA V, pVegaSES xVS)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  Receive String: LPVOID
.head 6 -  String: LPCSTR
.head 6 -  Number: DWORD
.head 6 -  Number: DWORD
.head 6 -  String: LPCSTR
.head 6 -  Number: DWORD
.head 6 -  Number: DWORD
.head 6 -  ! String: LPCSTR
.head 6 -  ! String: LPCSTR
.head 4 +  Function: VegaStart
.head 5 -  Description: int GLOBAL VegaStart (pVegaWA V,pVegaSES xVS)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  String: LPCSTR
.head 6 -  String: LPCSTR
.head 4 +  Function: VegaStep
.head 5 -  Description: int GLOBAL VegaStep (void *Mess,word Len, pVegaWA V, pVegaSES xVS)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  String: LPCSTR
.head 6 -  Number: DWORD
.head 6 -  String: LPCSTR
.head 6 -  String: LPCSTR
.head 4 +  Function: VegaRcpName
.head 5 -  Description: int GLOBAL VegaRcpName (char *Name,char *Path,File RcpNum, pVegaSES xVS)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  String: LPCSTR
.head 6 -  String: LPCSTR
.head 6 -  String: LPCSTR
.head 6 -  Number: DWORD
.head 4 +  Function: VegaMail
.head 5 -  Description: int GLOBAL VegaMail (File FileIn,File FileOut, pVegaSES xVS)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  String: LPCSTR
.head 6 -  String: LPCSTR
.head 6 -  Number: DWORD
.head 4 +  Function: VegaSetFmode
.head 5 -  Description: int GLOBAL VegaSetFmode (int Fmode, pVegaSES xVS)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  Number: INT
.head 6 -  Number: DWORD
.head 4 +  Function: VegaSecKeyUpdate
.head 5 -  Description: int VegaSecKeyUpdate(pVegaSes VS)
Возвращает ненулевое значение, если было произведено обновление
секретного ключа при последнем запуске VegaLoadSecKey
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  Number: DWORD
.head 4 +  Function: VegaDaysLeft
.head 5 -  Description: int VegaDaysLeft(pVegaSES VS);
Получение числа дней, оставшихся до конца действия секретного ключа,
загруженного при последнем запуске VegaLoadSecKey
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  Number: DWORD
.head 4 +  Function: VegaDaysLeftA
.head 5 -  Description: int VegaDaysLeftA(pVegaSES VS);
Получение числа дней, оставшихся до конца действия ключа администратора,
загруженного при последнем запуске VegaLoadSecKey
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  Number: DWORD
.head 4 +  Function: VegaCrtFF
.head 5 -  Description: int VegaCrtFF(CrtInfo* C, int Cur, char* ID, VegaSES VS)
Поиск первого сертификата по условию
.head 5 -  Export Ordinal: 23
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 +  structPointer
.head 7 -  Receive Number: DWORD
.head 7 -  Receive Number: DWORD
.head 7 -  Receive Number: DWORD
.head 7 -  Receive String: byte[8]
.head 7 -  Receive String: byte[40]
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: DWORD
.head 7 -  Receive Number: DWORD
.head 6 -  Number: DWORD
.head 6 -  String: LPCSTR
.head 6 -  Number: DWORD
.head 4 +  Function: VegaCrtFN
.head 5 -  Description: int VegaCrtFN(CrtInfo *C, pVegaSES xVS)
Поиск следующего сертификата по условию
.head 5 -  Export Ordinal: 24
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 +  structPointer
.head 7 -  Receive Number: DWORD
.head 7 -  Receive Number: DWORD
.head 7 -  Receive Number: DWORD
.head 7 -  Receive String: byte[8]
.head 7 -  Receive String: byte[40]
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: DWORD
.head 7 -  Receive Number: DWORD
.head 6 -  Number: DWORD
.head 4 +  Function: VegaSecKeyInfo
.head 5 -  Description: int VegaSecKeyInfo (File SKPath,char *Psw,
SKInfo *SK0,SKInfo *SK1,SKInfo *SKA,pVegaSES xVS)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  String: LPCSTR
.head 6 -  String: LPCSTR
.head 6 +  structPointer
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: DWORD
.head 7 -  Receive String: byte[8]
.head 7 -  Receive Number: WORD
.head 6 +  structPointer
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: DWORD
.head 7 -  Receive String: byte[8]
.head 7 -  Receive Number: WORD
.head 6 +  structPointer
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: WORD
.head 7 -  Receive Number: DWORD
.head 7 -  Receive String: byte[8]
.head 7 -  Receive Number: WORD
.head 6 -  Number: DWORD
.head 3 +  Library name: tmm.dll
.head 4 +  Function: TMinitOwn
.head 5 -  Description: TMinit  (int AdapterType,int PortNum,int TmType)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  Number: INT
.head 6 -  Number: INT
.head 6 -  Number: INT
.head 4 +  Function: TMcheckOwn
.head 5 -  Description: TMcheck (byte *Id,word *RAMsize);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  Receive String: LPVOID
.head 6 -  Receive Number: LPWORD
.head 4 +  Function: TMreadOwn
.head 5 -  Description: TMread  (void *Buf,int Ofs,int Len);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  Receive String: LPVOID
.head 6 -  Number: INT
.head 6 -  Number: INT
.head 4 +  Function: TMdoneOwn
.head 5 -  Description: TMdone  (void);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 -  Parameters
.head 4 +  Function: TMwriteOwn
.head 5 -  Description: int TMwrite (void *Buf,int Ofs,int Len);
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  String: LPCSTR
.head 6 -  Number: INT
.head 6 -  Number: INT
.head 3 +  Library name: VEGAMSG
.head 4 +  Function: VegaGetMsgAux
.head 5 -  Description: void VegaGetMsgAux(int nCode, char* szMsgBuf, int nBufLen)
.head 5 -  Export Ordinal: 0
.head 5 -  Returns
.head 5 +  Parameters
.head 6 -  Number: INT
.head 6 -  Receive String: LPSTR
.head 6 -  Number: INT
.head 4 +  Function: VegaCrtFFAux
.head 5 -  Description:
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  Receive Number: LPDWORD
.head 6 -  Receive Number: LPDWORD
.head 6 -  Receive Number: LPDWORD
.head 6 -  Receive String: LPSTR
.head 6 -  Receive String: LPSTR
.head 6 -  Receive Number: LPWORD
.head 6 -  Receive Number: LPWORD
.head 6 -  Receive Number: LPWORD
.head 6 -  Receive Number: LPWORD
.head 6 -  Receive Number: LPWORD
.head 6 -  Receive Number: LPWORD
.head 6 -  Receive String: LPSTR
.head 6 -  Number: INT
.head 6 -  String: LPCSTR
.head 6 -  Number: DWORD
.head 4 +  Function: VegaCrtFNAux
.head 5 -  Description:
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  Receive Number: LPDWORD
.head 6 -  Receive Number: LPDWORD
.head 6 -  Receive Number: LPDWORD
.head 6 -  Receive String: LPSTR
.head 6 -  Receive String: LPSTR
.head 6 -  Receive Number: LPWORD
.head 6 -  Receive Number: LPWORD
.head 6 -  Receive Number: LPWORD
.head 6 -  Receive Number: LPWORD
.head 6 -  Receive Number: LPWORD
.head 6 -  Receive Number: LPWORD
.head 6 -  Receive String: LPSTR
.head 6 -  Number: DWORD
.head 4 +  Function: VegaCrtInfo ! Получение информации о сертификате(из файла)
.head 5 -  Description: Получение информации о сертификате(из файла)
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Number: INT
.head 5 +  Parameters
.head 6 -  String: LPCSTR
.head 6 -  Receive Number: LPDWORD
.head 6 -  Receive Number: LPDWORD
.head 6 -  Receive Number: LPDWORD
.head 6 -  Receive String: LPSTR
.head 6 -  Receive String: LPSTR
.head 6 -  Receive String: LPVOID
.head 6 -  Receive Number: LPWORD
.head 6 -  Receive Number: LPWORD
.head 6 -  Receive Number: LPWORD
.head 6 -  Receive Number: LPWORD
.head 3 +  Library name: MSVCRT.DLL
.head 4 +  Function: _ultoa
.head 5 -  Description: char *_ultoa( unsigned long value, char *string, int radix );
Convert an unsigned long integer to a string.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  String: LPSTR
.head 5 +  Parameters
.head 6 -  Number: DWORD
.head 6 -  Receive String: LPSTR
.head 6 -  Number: INT
.head 4 +  Function: _strupr
.head 5 -  Description: Convert a string to uppercase.
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  String: LPSTR
.head 5 +  Parameters
.head 6 -  String: LPSTR
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 2 -  Resources
.head 2 -  Variables
.head 2 +  Internal Functions
.head 3 -  !
.head 3 +  Function: VEGA_Sel			! __exported
.head 4 -  Description: Функция селектор
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWinParent
.head 5 -  Number: nMode   ! 0 - разрешено все
		! 1 - только просмотр
.head 5 -  Number: nParam1
.head 5 -  Number: nParam2
.head 5 -  String: strParam1
.head 5 -  String: strParam2
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  Select Case nMode
.head 6 +  Case 0	! Таблица открытых ключей
.head 7 -  Call SalCreateWindow( frm_VegaOpenKeys, hWinParent, nParam1 )
.head 7 -  ! Call CallTestDialog( hWinParent )
.head 7 -  Break
.head 6 +  Default
.head 7 -  Break
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 915076427
0000: E10000008E000000 0000000000000000 0200000200FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F04003C00 000B630056656761
0040: 48656C700065721E 00000001003C0000 0204FA0000FF0F01 8022001000000100
0060: 000A630047656E46 696C746580727400 00000400DE0002D9 0001003F8001F800
0080: 000037040001F00D 000000FF1F110000 DC000200FF7F1570 0000000100FFFF01
.enddata
.head 3 +  Functional Class: cVegaHelper
.head 4 -  Description: класс для сервисных работ с системой ЭЦП VEGA
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Boolean: m_isInited	! признак инициализации
.head 5 -  Number: m_nCrtFilter	! фильтр для сертификатов(0-все, 1-текущие)
.head 5 -  String: m_szCrtID	! ID сертификата для фильтра
.head 5 -  Number: CN		! уникальный номер сертификата
.head 5 -  String: m_szCN
.head 5 -  Number: KN		! номер ключа
.head 5 -  String: m_szKN
.head 5 -  Number: CA		! номер сертификата которым подписан данный
.head 5 -  String: m_szCA
.head 5 -  String: szID		! идентификатор владельца
.head 5 -  String: m_szID
.head 5 -  String: szNM		! фио владельца
.head 5 -  String: m_szNM
.head 5 -  Number: Db		! дата начала действия сертификата
.head 5 -  Date/Time: m_dtDb
.head 5 -  Number: De		! дата завершения действия сертификата
.head 5 -  Date/Time: m_dtDe
.head 5 -  Number: Di		! дата с которой серт. считается отмененным
.head 5 -  Date/Time: m_dtDi
.head 5 -  Number: Df		! дата факта отмены сертификата
.head 5 -  Date/Time: m_dtDf
.head 5 -  Number: SrchId		! зарезервировано
.head 5 -  Number: SrchCur		! зарезервировано
.head 5 -  String: SrchKey
.head 5 -  Number: nCrtFilter
.head 5 -  String: szCrtID
.head 5 -  Number: nRes
.head 5 -  Number: m_nCrtCount	! Кол-во сертификатов в активном списке
.head 5 -  Boolean: m_bOnlyElapsed ! показывать только истекающие сертификаты
.head 4 +  Functions
.head 5 +  Function: Init
.head 6 -  Description: Инициализация системы VEGA
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 +  Static Variables
.head 7 -  String: sBuf
.head 6 +  Local variables
.head 7 -  Number: nErrorSign
.head 7 -  String: strErrorSign
.head 6 +  Actions
.head 7 -  Set m_isInited = FALSE
.head 7 -  Set m_bOnlyElapsed = FALSE
.head 7 -  Call SalStrSetBufferLength( sBuf, 11024+4104+1)
.head 7 -  Set nErrorSign = VegaSetBuf(sBuf,11024+4104)
.head 7 -  Set strErrorSign = SalStrRepeatX(' ', 129)
.head 7 -  Call VegaSetFmode(0, 0)
.head 7 +  If nErrorSign
.head 8 -  Call VegaGetMsgAux(nErrorSign, strErrorSign, 128)
.head 8 -  Call SalMessageBox(strErrorSign, 'VEGA Error', MB_Ok | MB_IconHand)
.head 8 -  Return nErrorSign
.head 7 -  Set nErrorSign = VegaSetDate(SalFmtFormatDateTime(SalDateCurrent(),'dd/MM/yyyy'))
.head 7 +  If nErrorSign
.head 8 -  Call VegaGetMsgAux(nErrorSign, strErrorSign, 128)
.head 8 -  Call SalMessageBox(strErrorSign, 'VEGA Error', MB_Ok | MB_IconHand)
.head 8 -  Return nErrorSign
.head 7 -  Set nErrorSign = VegaOpen(GetOpenKeyDir()||'\\Vega.cfg',GetOpenKeyDir()||'\\',0)
.head 7 +  If nErrorSign
.head 8 -  Call VegaGetMsgAux(nErrorSign, strErrorSign, 128)
.head 8 -  Call SalMessageBox(strErrorSign, 'VEGA Error', MB_Ok | MB_IconHand)
.head 8 -  Return nErrorSign
.head 7 -  Set m_isInited = TRUE
.head 5 +  Function: FindCrtFirst
.head 6 -  Description: поиск первого сертификата по условию
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: szBuf
.head 6 +  Actions
.head 7 -  Set szID = SalStrRepeatX( ' ', 9 )
.head 7 -  Set szBuf = SalStrRepeatX( ' ', 128 )
.head 7 -  Set szNM = SalStrRepeatX( ' ', 41 )
.head 7 -  Set SrchKey = SalStrRepeatX( ' ', 9 )
.head 7 -  Set nRes = VegaCrtFFAux( CN, KN, CA, szID, szNM, Db, De, Di, Df, SrchId, SrchCur, SrchKey, m_nCrtFilter, m_szCrtID, NUMBER_Null )
.head 7 +  If nRes=221
.head 8 -  Return nRes
.head 7 +  If nRes
.head 8 -  Call VegaGetMsgAux(nRes, szBuf, 128)
.head 8 -  Call SalMessageBox(szBuf, 'VEGA Error', MB_Ok | MB_IconHand)
.head 8 -  Return nRes
.head 7 -  Set m_szCN = SalStrRepeatX( ' ', 8 )
.head 7 -  Set m_szKN = SalStrRepeatX( ' ', 8 )
.head 7 -  Set m_szCA = SalStrRepeatX( ' ', 8 )
.head 7 -  ! 'Идентификатор'
.head 7 -  Set m_szID = szID
.head 7 -  ! 'Номер'
.head 7 -  Call _ultoa( CN, m_szCN, 16)
.head 7 -  Call _strupr(m_szCN)
.head 7 -  ! 'Подписан'
.head 7 -  Call _ultoa( CA, m_szCA, 16)
.head 7 -  Call _strupr(m_szCA)
.head 7 -  ! '№ ключа'
.head 7 -  Call _ultoa( KN, m_szKN, 16)
.head 7 -  Call _strupr(m_szKN)
.head 7 -  ! 'Дата н.д.'
.head 7 +  If Db = 0
.head 8 -  Set m_dtDb = DATETIME_Null
.head 7 +  Else
.head 8 -  Set m_dtDb = SalDateConstruct ( (Db & 0xFE00)/0x200 + 1980, (Db & 0x1E0)/0x20, Db & 0x1F, 0, 0, 0 )
.head 7 -  Call SalDateToStr( m_dtDb, szBuf )
.head 7 -  ! 'Дата к.д.'
.head 7 +  If De = 0
.head 8 -  Set m_dtDe = DATETIME_Null
.head 7 +  Else
.head 8 -  Set m_dtDe = SalDateConstruct ( (De & 0xFE00)/0x200 + 1980, (De & 0x1E0)/0x20, De & 0x1F, 0, 0, 0 )
.head 7 -  Call SalDateToStr( m_dtDe, szBuf )
.head 7 -  ! 'Дата отм.'
.head 7 +  If Df = 0
.head 8 -  Set m_dtDf = DATETIME_Null
.head 7 +  Else
.head 8 -  Set m_dtDf = SalDateConstruct ( (Df & 0xFE00)/0x200 + 1980, (Df & 0x1E0)/0x20, Df & 0x1F, 0, 0, 0 )
.head 7 -  Call SalDateToStr( m_dtDf, szBuf )
.head 7 -  ! 'Имя пользователя'
.head 7 -  Set m_szNM = szNM
.head 7 -  Return nRes
.head 5 +  Function: FindCrtNext
.head 6 -  Description: поиск следующего сертификата по условию
.head 6 +  Returns
.head 7 -  Number:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: szBuf
.head 6 +  Actions
.head 7 -  Set szID = SalStrRepeatX( ' ', 9 )
.head 7 -  Set szBuf = SalStrRepeatX( ' ', 128 )
.head 7 -  Set szNM = SalStrRepeatX( ' ', 41 )
.head 7 -  Set SrchKey = SalStrRepeatX( ' ', 9 )
.head 7 -  Set nRes = VegaCrtFNAux( CN, KN, CA, szID, szNM, Db, De, Di, Df, SrchId, SrchCur, SrchKey, NUMBER_Null )
.head 7 +  If nRes=221
.head 8 -  Return nRes
.head 7 +  If nRes
.head 8 -  Call VegaGetMsgAux(nRes, szBuf, 128)
.head 8 -  Call SalMessageBox(szBuf, 'VEGA Error', MB_Ok | MB_IconHand)
.head 8 -  Return nRes
.head 7 -  Set m_szCN = SalStrRepeatX( ' ', 8 )
.head 7 -  Set m_szKN = SalStrRepeatX( ' ', 8 )
.head 7 -  Set m_szCA = SalStrRepeatX( ' ', 8 )
.head 7 -  ! 'Идентификатор'
.head 7 -  Set m_szID = szID
.head 7 -  ! 'Номер'
.head 7 -  Call _ultoa( CN, m_szCN, 16)
.head 7 -  Call _strupr(m_szCN)
.head 7 -  ! 'Подписан'
.head 7 -  Call _ultoa( CA, m_szCA, 16)
.head 7 -  Call _strupr(m_szCA)
.head 7 -  ! '№ ключа'
.head 7 -  Call _ultoa( KN, m_szKN, 16)
.head 7 -  Call _strupr(m_szKN)
.head 7 -  ! 'Дата н.д.'
.head 7 +  If Db = 0
.head 8 -  Set m_dtDb = DATETIME_Null
.head 7 +  Else
.head 8 -  Set m_dtDb = SalDateConstruct ( (Db & 0xFE00)/0x200 + 1980, (Db & 0x1E0)/0x20, Db & 0x1F, 0, 0, 0 )
.head 7 -  Call SalDateToStr( m_dtDb, szBuf )
.head 7 -  ! 'Дата к.д.'
.head 7 +  If De = 0
.head 8 -  Set m_dtDe = DATETIME_Null
.head 7 +  Else
.head 8 -  Set m_dtDe = SalDateConstruct ( (De & 0xFE00)/0x200 + 1980, (De & 0x1E0)/0x20, De & 0x1F, 0, 0, 0 )
.head 7 -  Call SalDateToStr( m_dtDe, szBuf )
.head 7 -  ! 'Дата отм.'
.head 7 +  If Df = 0
.head 8 -  Set m_dtDf = DATETIME_Null
.head 7 +  Else
.head 8 -  Set m_dtDf = SalDateConstruct ( (Df & 0xFE00)/0x200 + 1980, (Df & 0x1E0)/0x20, Df & 0x1F, 0, 0, 0 )
.head 7 -  Call SalDateToStr( m_dtDf, szBuf )
.head 7 -  ! 'Имя пользователя'
.head 7 -  Set m_szNM = szNM
.head 7 -  Return nRes
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton: cpbExecute
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control:
.head 2 -  Application Actions
.head 1 +  Table Window: frm_VegaOpenKeys
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: АРМ Администратора системы VEGA
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   2.2"
.head 4 -  Top:    1.833"
.head 4 -  Width:  12.433"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.143"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 65536
.head 3 -  Discardable? Class Default
.head 2 -  Description: Таблица открытых ключей.
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 1.107"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.983"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip='Добавить сертификат в ТОК'
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.417"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.85"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.283"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 40598
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  9.8"
.head 6 -  Begin Y:  0.06"
.head 6 -  End X:  9.8"
.head 6 -  End Y:  0.393"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.917"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.35"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.783"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalModalDialog( dlgCrtInfo, frm_VegaOpenKeys,
 colNumber, colKeyNumber, colKeyAdmin, colID,
 colUserName, colDateBegin, colDateEnd, colDateDiscard )
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.217"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 40599
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  8.767"
.head 6 -  Begin Y:  0.06"
.head 6 -  End X:  8.767"
.head 6 -  End Y:  0.393"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.95"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 40600
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  6.817"
.head 6 -  Begin Y:  0.06"
.head 6 -  End X:  6.817"
.head 6 -  End Y:  0.393"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dfCrt
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.683"
.head 7 -  Top:    0.131"
.head 7 -  Width:  1.1"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: ID
.head 5 -  Resource Id: 65221
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.483"
.head 6 -  Top:    0.179"
.head 6 -  Width:  0.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Group Box: Сертификаты
.head 5 -  Resource Id: 65222
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.0"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Radio Button: rbCrtAll
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Все
.head 5 -  Window Location and Size
.head 6 -  Left:   1.883"
.head 6 -  Top:    0.738"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set rbCrtAll = FALSE
.head 6 +  On SAM_Click
.head 7 +  If rbCrtAll
.head 8 -  Set theVegaHelper.m_nCrtFilter = 0
.head 8 -  Set theVegaHelper.m_bOnlyElapsed = FALSE
.head 7 -  Call SalSendMsg( frm_VegaOpenKeys, UM_Update, 0, 0 )
.head 4 +  Radio Button: rbCrtCur
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Текущие
.head 5 -  Window Location and Size
.head 6 -  Left:   1.883"
.head 6 -  Top:    0.488"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set rbCrtCur = TRUE
.head 6 +  On SAM_Click
.head 7 +  If rbCrtCur
.head 8 -  Set theVegaHelper.m_nCrtFilter = 1 
.head 8 -  Set theVegaHelper.m_bOnlyElapsed = FALSE
.head 7 -  Call SalSendMsg( frm_VegaOpenKeys, UM_Update, 0, 0 )
.head 4 +  Radio Button: rbElapsed
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Истекающие
.head 5 -  Window Location and Size
.head 6 -  Left:   1.883"
.head 6 -  Top:    0.238"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set rbElapsed = FALSE
.head 6 +  On SAM_Click
.head 7 +  If rbElapsed
.head 8 -  Set theVegaHelper.m_nCrtFilter = 1
.head 8 -  Set theVegaHelper.m_bOnlyElapsed = TRUE
.head 7 -  Call SalSendMsg( frm_VegaOpenKeys, UM_Update, 0, 0 )
.head 4 +  Data Field: dfCrtCount
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.683"
.head 7 -  Top:    0.738"
.head 7 -  Width:  1.0"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: Всего:
.head 5 -  Resource Id: 56676
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.762"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Frame
.head 5 -  Resource Id: 40713
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.583"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Corners: Round
.head 5 -  Border Style: Solid
.head 5 -  Border Thickness: 1
.head 5 -  Border Color: Default
.head 5 -  Background Color: White
.head 4 -  Background Text: Действующий
.head 5 -  Resource Id: 40716
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: White
.head 4 -  Background Text: Истекающий
.head 5 -  Resource Id: 40715
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    0.262"
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Red
.head 5 -  Background Color: White
.head 4 -  Background Text: Истекший
.head 5 -  Resource Id: 40714
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    0.429"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Gray
.head 5 -  Background Color: White
.head 4 -  Line
.head 5 -  Resource Id: 21955
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  4.867"
.head 6 -  Begin Y:  0.06"
.head 6 -  End X:  4.867"
.head 6 -  End Y:  0.393"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbCrtInfo
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.867"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: Q:\BARS98\RESOURCE\BMP\VIEWCRT.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip='Просмотр сертификата'
.head 6 +  On SAM_Click
.head 7 -  Set szBuf=SalStrRepeatX( ' ', 129 )
.head 7 -  Set szID=SalStrRepeatX( ' ', 16 )
.head 7 -  Set szFIO=SalStrRepeatX( ' ', 64 )
.head 7 -  Set szOKeyBuf=SalStrRepeatX( ' ', 1024 )
.head 7 -  ! ////
.head 7 -  Set strFilters[0]='Certificate files'
.head 7 -  Set strFilters[1]='*.crt'
.head 7 -  Set strFilters[2]='All files'
.head 7 -  Set strFilters[3]='*.*'
.head 7 +  If SalDlgOpenFile( frm_VegaOpenKeys, 'Выберите сертификат', 
	strFilters, 4, nIndex, szFile, szPath )
.head 8 -  Set nRes=VegaCrtInfo( szPath, dwCN, dwKN, dwCA, szID, szFIO, szOKeyBuf,
wDb, wDe, wDi, wDf )
.head 8 +  If nRes=0  ! success
.head 9 -  ! 'Номер'
.head 9 -  Set szCN=SalStrRepeatX( ' ', 64 )
.head 9 -  Call _ultoa( dwCN, szCN, 16)
.head 9 -  Call _strupr(szCN)
.head 9 -  ! '№ ключа'
.head 9 -  Set szKN=SalStrRepeatX( ' ', 64 )
.head 9 -  Call _ultoa( dwKN, szKN, 16)
.head 9 -  Call _strupr(szKN)
.head 9 -  ! Кем подписан 
.head 9 -  Set szCA=SalStrRepeatX( ' ', 64 )
.head 9 -  Call _ultoa( dwCA, szCA, 16)
.head 9 -  Call _strupr(szCA)
.head 9 -  ! 'Имя пользователя'
.head 9 -  ! 'Дата н.д.'
.head 9 +  If wDb = 0
.head 10 -  Set dtDb = DATETIME_Null
.head 9 +  Else
.head 10 -  Set dtDb = SalDateConstruct ( (wDb & 0xFE00)/0x200 + 1980, (wDb & 0x1E0)/0x20, wDb & 0x1F, 0, 0, 0 )
.head 9 -  ! 'Дата к.д.'
.head 9 +  If wDe = 0
.head 10 -  Set dtDe = DATETIME_Null
.head 9 +  Else
.head 10 -  Set dtDe = SalDateConstruct ( (wDe & 0xFE00)/0x200 + 1980, (wDe & 0x1E0)/0x20, wDe & 0x1F, 0, 0, 0 )
.head 9 -  ! 'Дата отм.'
.head 9 +  If wDf = 0
.head 10 -  Set dtDf = DATETIME_Null
.head 9 +  Else
.head 10 -  Set dtDf = SalDateConstruct ( (wDf & 0xFE00)/0x200 + 1980, (wDf & 0x1E0)/0x20, wDf & 0x1F, 0, 0, 0 )
.head 9 -  Call SalModalDialog( dlgCrtInfo, frm_VegaOpenKeys,
 szCN, szKN, szCA, szID, szFIO, dtDb, dtDe, dtDf)
.head 8 +  Else ! error occured
.head 9 +  If nRes=-1
.head 10 -  Call SalMessageBox('Ошибка работы с файлом', 
'VEGA Error', MB_Ok | MB_IconHand)
.head 9 +  Else
.head 10 -  Call VegaGetMsgAux(nRes, szBuf, 128)
.head 10 -  Call SalMessageBox(szBuf, 'VEGA Error', MB_Ok | MB_IconHand)
.head 4 +  Pushbutton: pbKeyInfo
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.3"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: Q:\BARS98\RESOURCE\BMP\VIEWKEY.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip='Просмотр секретного ключа'
.head 2 +  Contents
.head 3 +  Column: colID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Идентификатор
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNumber
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.3"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKeyAdmin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Подписан
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKeyNumber
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № ключа
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.25"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDateBegin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата н.д.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.117"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDateEnd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата к.д.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.117"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDateDiscard
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата отм.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.117"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colUserName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Имя пользователя
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nMode   ! 0 - разрешено все
		! 1 - только просмотр
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  Number: nRes
.head 3 -  : theVegaHelper
.head 4 -  Class: cVegaHelper
.head 3 -  Boolean: bDoInsertRow
.head 3 -  String: szSomeBuf
.head 3 -  Date/Time: dtCurDate
.head 3 -  String: strFilters[0:3]
.head 3 -  String: szFile
.head 3 -  String: szPath
.head 3 -  Number: nIndex
.head 3 -  Number: nRetVal
.head 3 -  String: szReceipt ! имя файла квитанции
.head 3 -  String: szBuf
.head 3 -  ! ----------
.head 3 -  Number: dwCN
.head 3 -  String: szCN
.head 3 -  Number: dwKN
.head 3 -  String: szKN
.head 3 -  Number: dwCA
.head 3 -  String: szCA
.head 3 -  String: szID
.head 3 -  String: szFIO
.head 3 -  String: szOKeyBuf
.head 3 -  Number: wDb
.head 3 -  Date/Time: dtDb
.head 3 -  Number: wDe
.head 3 -  Date/Time: dtDe
.head 3 -  Number: wDi
.head 3 -  Date/Time: dtDi
.head 3 -  Number: wDf
.head 3 -  Date/Time: dtDf
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Инициализация системы VEGA
.head 4 -  Set nRes = theVegaHelper.Init()
.head 4 +  If nRes  ! что-то не в порядке
.head 5 -  ! Нафиг с поля
.head 5 -  Call SalMessageBox( 'Cannot start VEGA Admin Center', 'Error', 
MB_Ok | MB_IconHand )
.head 5 -  Call SalDestroyWindow( hWndForm )
.head 4 -  Call PrepareWindow( hWndForm )
.head 4 -  Call SetWindowFullSize( hWndForm )
.head 4 -  Set frm_VegaOpenKeys.nFlags = GT_NoUpd | GT_NoDel | GT_NoRet
.head 4 -  Set frm_VegaOpenKeys.strPrintFileName = 'okeyvega.txt'
.head 4 -  Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 4 -  !
.head 4 -  ! Call SalUseRegistry( TRUE, GetCompanyName() )
.head 4 -  ! Call SalGetProfileString( INI_DigitalSignature, 'KeySize', '2048', strMyVal, GetProductName() )
.head 4 -  !
.head 4 -  Set rbCrtAll = FALSE
.head 4 -  Set rbElapsed = FALSE
.head 4 -  Set rbCrtCur = TRUE
.head 4 -  Set dfCrt = ''
.head 4 +  If nMode=1
.head 5 -  Call SalDisableWindow( pbIns )
.head 5 -  Call SalDisableWindow( pbCrtInfo )
.head 5 -  Call SalDisableWindow( pbKeyInfo )
.head 3 +  On UM_Populate
.head 4 -  ! Население таблицы сертификатов
.head 4 -  Set nRes=0
.head 4 -  Set theVegaHelper.m_nCrtCount = 0
.head 4 -  Call SalSendClassMessage( UM_Populate, 0, 0 )
.head 4 -  Call SalTblReset( hWndForm )
.head 4 -  ! Вычисляем тек. дату без времени
.head 4 -  Set dtCurDate = SalDateConstruct( SalDateYear(SalDateCurrent()), 
		SalDateMonth(SalDateCurrent()), 
		SalDateDay(SalDateCurrent()), 0, 0, 0 )
.head 4 -  ! Выставляем параметры
.head 4 +  If rbCrtAll
.head 5 -  Set theVegaHelper.m_nCrtFilter = 0
.head 4 +  Else
.head 5 -  Set theVegaHelper.m_nCrtFilter = 1
.head 4 -  Set theVegaHelper.m_szCrtID = dfCrt
.head 4 -  ! Находим первый сертификат по условию
.head 4 -  Set nRes = theVegaHelper.FindCrtFirst()
.head 4 +  If not nRes
.head 5 -  Set bDoInsertRow = TRUE
.head 5 +  If theVegaHelper.m_bOnlyElapsed
.head 6 +  If ( theVegaHelper.m_dtDe-dtCurDate>=0 
     and theVegaHelper.m_dtDe-dtCurDate<10 )
or ( theVegaHelper.m_dtDf!=DATETIME_Null 
     and theVegaHelper.m_dtDf-dtCurDate>=0
     and theVegaHelper.m_dtDf-dtCurDate<10)
.head 7 -  Set bDoInsertRow=TRUE
.head 6 +  Else
.head 7 -  Set bDoInsertRow=FALSE
.head 5 +  If bDoInsertRow
.head 6 -  Set nRow = SalTblInsertRow( hWndForm, TBL_MaxRow )
.head 6 +  If nRow != TBL_Error
.head 7 -  Call SalTblSetContext(  hWndForm, nRow )
.head 7 -  Call SalTblSetRowFlags( hWndForm, nRow, ROW_New, FALSE )
.head 7 -  Set colID = theVegaHelper.m_szID
.head 7 -  Set colNumber = theVegaHelper.m_szCN
.head 7 -  Set colKeyAdmin = theVegaHelper.m_szCA
.head 7 -  Set colKeyNumber = theVegaHelper.m_szKN
.head 7 -  Set colDateBegin = theVegaHelper.m_dtDb
.head 7 -  Set colDateEnd = theVegaHelper.m_dtDe
.head 7 -  Set colDateDiscard = theVegaHelper.m_dtDf
.head 7 -  Set colUserName = theVegaHelper.m_szNM
.head 7 -  ! Расцветка: уже истекшие серт.  - серым цветом
.head 7 +  If theVegaHelper.m_dtDe<dtCurDate
or (theVegaHelper.m_dtDf!=DATETIME_Null 
     and theVegaHelper.m_dtDf<dtCurDate)
.head 8 -  Call XSalTblSetRowCustom( hWndForm, nRow, COLOR_White )
.head 8 -  Call SetTblRowColor( hWndForm, COLOR_Gray )
.head 7 +  Else If ( theVegaHelper.m_dtDe-dtCurDate>=0 
          and theVegaHelper.m_dtDe-dtCurDate<10 )
     or ( theVegaHelper.m_dtDf!=DATETIME_Null 
          and theVegaHelper.m_dtDf-dtCurDate>=0
          and theVegaHelper.m_dtDf-dtCurDate<10 )
.head 8 -  ! Расцветка: истекающие серт.  - красным цветом
.head 8 -  Call XSalTblSetRowCustom( hWndForm, nRow, COLOR_White )
.head 8 -  Call SetTblRowColor( hWndForm, COLOR_Red )
.head 7 -  ! инкремент счетчика
.head 7 -  Set theVegaHelper.m_nCrtCount = theVegaHelper.m_nCrtCount + 1 
.head 5 -  ! Находим все последующие сертификаты по условию
.head 4 +  While nRes=0
.head 5 -  Set nRes = theVegaHelper.FindCrtNext()
.head 5 +  If not nRes
.head 6 -  Set bDoInsertRow = TRUE
.head 6 +  If theVegaHelper.m_bOnlyElapsed
.head 7 +  If ( theVegaHelper.m_dtDe-dtCurDate>=0 
     and theVegaHelper.m_dtDe-dtCurDate<10 )
or ( theVegaHelper.m_dtDf!=DATETIME_Null 
     and theVegaHelper.m_dtDf-dtCurDate>=0
     and theVegaHelper.m_dtDf-dtCurDate<10 )
.head 8 -  Set bDoInsertRow=TRUE
.head 7 +  Else
.head 8 -  Set bDoInsertRow=FALSE
.head 6 +  If bDoInsertRow
.head 7 -  Set nRow = SalTblInsertRow( hWndForm, TBL_MaxRow )
.head 7 +  If nRow != TBL_Error
.head 8 -  Call SalTblSetContext(  hWndForm, nRow )
.head 8 -  Call SalTblSetRowFlags( hWndForm, nRow, ROW_New, FALSE )
.head 8 -  Set colID = theVegaHelper.m_szID
.head 8 -  Set colNumber = theVegaHelper.m_szCN
.head 8 -  Set colKeyAdmin = theVegaHelper.m_szCA
.head 8 -  Set colKeyNumber = theVegaHelper.m_szKN
.head 8 -  Set colDateBegin = theVegaHelper.m_dtDb
.head 8 -  Set colDateEnd = theVegaHelper.m_dtDe
.head 8 -  Set colDateDiscard = theVegaHelper.m_dtDf
.head 8 -  Set colUserName = theVegaHelper.m_szNM
.head 8 -  ! Расцветка: уже истекшие серт.  - серым цветом
.head 8 +  If theVegaHelper.m_dtDe<dtCurDate
or (theVegaHelper.m_dtDf!=DATETIME_Null 
     and theVegaHelper.m_dtDf<dtCurDate)
.head 9 -  Call XSalTblSetRowCustom( hWndForm, nRow, COLOR_White )
.head 9 -  Call SetTblRowColor( hWndForm, COLOR_Gray )
.head 8 +  Else If ( theVegaHelper.m_dtDe-dtCurDate>=0 
          and theVegaHelper.m_dtDe-dtCurDate<10 )
     or ( theVegaHelper.m_dtDf!=DATETIME_Null 
          and theVegaHelper.m_dtDf-dtCurDate>=0
          and theVegaHelper.m_dtDf-dtCurDate<10 )
.head 9 -  ! Расцветка: истекающие серт.  - красным цветом
.head 9 -  Call XSalTblSetRowCustom( hWndForm, nRow, COLOR_White )
.head 9 -  Call SetTblRowColor( hWndForm, COLOR_Red )
.head 8 -  ! инкремент счетчика
.head 8 -  Set theVegaHelper.m_nCrtCount = theVegaHelper.m_nCrtCount + 1 
.head 4 -  Set dfCrtCount = theVegaHelper.m_nCrtCount
.head 3 +  On UM_Insert
.head 4 -  ! Принять новый сертификат в таблицу
.head 4 -  ! Call SalMessageBox( 'On Insert action', 'Message', MB_Ok )
.head 4 -  Set strFilters[0]='Certificate files'
.head 4 -  Set strFilters[1]='*.crt'
.head 4 -  Set strFilters[2]='All files'
.head 4 -  Set strFilters[3]='*.*'
.head 4 -  ! Set szFile = SalStrRepeatX( ' ', 128 )
.head 4 -  ! Set szPath = SalStrRepeatX( ' ', 128 )
.head 4 +  If SalDlgOpenFile( frm_VegaOpenKeys, 'Выберите сертификат', 
	strFilters, 4, nIndex, szFile, szPath )
.head 5 +  ! If SalMessageBox( 'Принять сертификат '||SalStrMidX(szFile,0,8)||' ?', 
'Сертификат', MB_YesNoCancel )=IDYES
.head 6 -  ! Call SalMessageBox( 'Certificate received', 'Info', MB_Ok )
.head 6 -  Set szReceipt = SalStrRepeatX( ' ', 128 )
.head 6 -  Set szReceipt = GetOpenKeyDir()||'\\'||SalStrMidX(szFile,0,8)||'.00#'
.head 6 -  Set nRes = VegaMail(szPath, szReceipt, 0)
.head 6 +  If nRes
.head 7 -  Set szBuf = SalStrRepeatX( ' ', 128 )
.head 7 -  Call VegaGetMsgAux(nRes, szBuf, 128)
.head 7 -  Call SalMessageBox(szBuf, 'VEGA Error', MB_Ok | MB_IconHand)
.head 6 +  Else 
.head 7 -  Call SalMessageBox( 'Сертификат '||SalStrMidX(szFile,0,8)
	||' успешно принят.', 
	'Информация', MB_Ok | MB_IconAsterisk )
.head 6 -  Call SalMessageBox( 'Квитанция помещена в файл: '||szReceipt, 
'Информация', MB_Ok | MB_IconAsterisk )
.head 6 -  Call SalSendMsg( frm_VegaOpenKeys, UM_Populate, 0, 0 )
.head 5 +  If SalModalDialog( dlgInfo, frm_VegaOpenKeys, szFile, szPath )
.head 6 -  Set szReceipt = SalStrRepeatX( ' ', 128 )
.head 6 -  Call VegaRcpName(szReceipt, GetOpenKeyDir()||'\\', 
	GetOpenKeyDir()||'\\'||'receipt.num', 0)
.head 6 -  ! Set szReceipt = GetOpenKeyDir()||'\\'||SalStrMidX(szFile,0,8)||'.00#'
.head 6 -  Set nRes = VegaMail(szPath, szReceipt, 0)
.head 6 +  If nRes
.head 7 -  Set szBuf = SalStrRepeatX( ' ', 128 )
.head 7 -  Call VegaGetMsgAux(nRes, szBuf, 128)
.head 7 -  Call SalMessageBox(szBuf, 'VEGA Error', MB_Ok | MB_IconHand)
.head 6 +  Else
.head 7 -  Call SalMessageBox( 'Сертификат '||SalStrMidX(szFile,0,8)
	||' успешно принят.', 
	'Информация', MB_Ok | MB_IconAsterisk )
.head 6 -  Call SalMessageBox( 'Квитанция помещена в файл: '||szReceipt, 
'Информация', MB_Ok | MB_IconAsterisk )
.head 6 -  Call SalSendMsg( frm_VegaOpenKeys, UM_Populate, 0, 0 )
.head 3 +  On SAM_Close
.head 4 -  ! Закрываем все
.head 4 -  Call VegaClose(0)
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalSendMsg( pbDetails, SAM_Click, 0, 0 )
.head 1 +  Dialog Box: dlgInfo
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Сертификат
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   4.95"
.head 4 -  Top:    2.281"
.head 4 -  Width:  5.367"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.869"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbOK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Принять
.head 4 -  Window Location and Size
.head 5 -  Left:   1.083"
.head 5 -  Top:    2.167"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( dlgInfo, 1 )
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отменить
.head 4 -  Window Location and Size
.head 5 -  Left:   2.583"
.head 5 -  Top:    2.167"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( dlgInfo, 0 )
.head 3 -  Background Text: Идентификатор:
.head 4 -  Resource Id: 48966
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    0.119"
.head 5 -  Width:  1.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Имя пользователя:
.head 4 -  Resource Id: 48967
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    1.869"
.head 5 -  Width:  1.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Дата отм.
.head 4 -  Resource Id: 48968
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    1.619"
.head 5 -  Width:  1.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Дата к.д.
.head 4 -  Resource Id: 48969
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    1.369"
.head 5 -  Width:  1.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Подписан:
.head 4 -  Resource Id: 48970
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    0.619"
.head 5 -  Width:  1.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Дата н.д.
.head 4 -  Resource Id: 48971
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    1.119"
.head 5 -  Width:  1.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: № ключа:
.head 4 -  Resource Id: 48972
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    0.869"
.head 5 -  Width:  1.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Номер:
.head 4 -  Resource Id: 48973
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    0.369"
.head 5 -  Width:  1.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    0.06"
.head 6 -  Width:  3.15"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfNumber
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    0.31"
.head 6 -  Width:  3.15"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfKeyAdmin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    0.56"
.head 6 -  Width:  3.15"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfKeyNumber
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    0.81"
.head 6 -  Width:  3.15"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfDateBegin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    1.06"
.head 6 -  Width:  3.15"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfDateEnd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    1.31"
.head 6 -  Width:  3.15"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfDateDiscard
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    1.56"
.head 6 -  Width:  3.15"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfUserName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    1.81"
.head 6 -  Width:  3.15"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: szFile
.head 3 -  String: szPath
.head 2 +  Window Variables
.head 3 -  Number: nRes
.head 3 -  String: szBuf
.head 3 -  Number: dwCN
.head 3 -  String: szCN
.head 3 -  Number: dwKN
.head 3 -  String: szKN
.head 3 -  Number: dwCA
.head 3 -  String: szCA
.head 3 -  String: szID
.head 3 -  String: szFIO
.head 3 -  String: szOKeyBuf
.head 3 -  Number: wDb
.head 3 -  Number: wDe
.head 3 -  Number: wDi
.head 3 -  Number: wDf
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowText( dlgInfo, 'Сертификат: ' || szFile )
.head 4 -  Set szBuf=SalStrRepeatX( ' ', 129 )
.head 4 -  Set szID=SalStrRepeatX( ' ', 16 )
.head 4 -  Set szFIO=SalStrRepeatX( ' ', 64 )
.head 4 -  Set szOKeyBuf=SalStrRepeatX( ' ', 1024 )
.head 4 -  Set nRes=VegaCrtInfo( szPath, dwCN, dwKN, dwCA, szID, szFIO, szOKeyBuf,
wDb, wDe, wDi, wDf )
.head 4 +  If nRes=0  ! success
.head 5 -  ! 'Идентификатор'
.head 5 -  Set dfID = szID
.head 5 -  ! 'Номер'
.head 5 -  Set szCN=SalStrRepeatX( ' ', 64 )
.head 5 -  Call _ultoa( dwCN, szCN, 16)
.head 5 -  Call _strupr(szCN)
.head 5 -  Set dfNumber=szCN
.head 5 -  ! '№ ключа'
.head 5 -  Set szKN=SalStrRepeatX( ' ', 64 )
.head 5 -  Call _ultoa( dwKN, szKN, 16)
.head 5 -  Call _strupr(szKN)
.head 5 -  Set dfKeyNumber=szKN
.head 5 -  ! Кем подписан 
.head 5 -  Set szCA=SalStrRepeatX( ' ', 64 )
.head 5 -  Call _ultoa( dwCA, szCA, 16)
.head 5 -  Call _strupr(szCA)
.head 5 -  Set dfKeyAdmin=szCA
.head 5 -  ! 'Имя пользователя'
.head 5 -  Set dfUserName=szFIO
.head 5 -  ! Call SalSendClassMessage( SAM_Create, 0, 0 )
.head 5 -  ! 'Дата н.д.'
.head 5 +  If wDb = 0
.head 6 -  Set dfDateBegin = DATETIME_Null
.head 5 +  Else
.head 6 -  Set dfDateBegin = SalDateConstruct ( (wDb & 0xFE00)/0x200 + 1980, (wDb & 0x1E0)/0x20, wDb & 0x1F, 0, 0, 0 )
.head 5 -  Call SalDateToStr( dfDateBegin, szBuf )
.head 5 -  ! 'Дата к.д.'
.head 5 +  If wDe = 0
.head 6 -  Set dfDateEnd = DATETIME_Null
.head 5 +  Else
.head 6 -  Set dfDateEnd = SalDateConstruct ( (wDe & 0xFE00)/0x200 + 1980, (wDe & 0x1E0)/0x20, wDe & 0x1F, 0, 0, 0 )
.head 5 -  Call SalDateToStr( dfDateEnd, szBuf )
.head 5 -  ! 'Дата отм.'
.head 5 +  If wDf = 0
.head 6 -  Set dfDateDiscard = DATETIME_Null
.head 5 +  Else
.head 6 -  Set dfDateDiscard = SalDateConstruct ( (wDf & 0xFE00)/0x200 + 1980, (wDf & 0x1E0)/0x20, wDf & 0x1F, 0, 0, 0 )
.head 5 -  Call SalDateToStr( dfDateDiscard, szBuf )
.head 4 +  Else ! error occured
.head 5 +  If nRes=-1
.head 6 -  Call SalMessageBox('Ошибка работы с файлом', 
'VEGA Error', MB_Ok | MB_IconHand)
.head 5 +  Else
.head 6 -  Call VegaGetMsgAux(nRes, szBuf, 128)
.head 6 -  Call SalMessageBox(szBuf, 'VEGA Error', MB_Ok | MB_IconHand)
.head 1 +  Dialog Box: dlgAccept
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Информация
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  5.15"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.369"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbAccept
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Принять
.head 4 -  Window Location and Size
.head 5 -  Left:   1.233"
.head 5 -  Top:    1.595"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( dlgAccept, 1 )
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отменить
.head 4 -  Window Location and Size
.head 5 -  Left:   2.583"
.head 5 -  Top:    1.595"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( dlgAccept, 0 )
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 -  Window Variables
.head 2 -  Message Actions
.head 1 +  Dialog Box: dlgCrtInfo
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Сертификат
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   4.95"
.head 4 -  Top:    2.281"
.head 4 -  Width:  5.367"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.869"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbOK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &Ok
.head 4 -  Window Location and Size
.head 5 -  Left:   1.983"
.head 5 -  Top:    2.167"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( dlgCrtInfo, 1 )
.head 3 -  Background Text: Идентификатор:
.head 4 -  Resource Id: 22440
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    0.119"
.head 5 -  Width:  1.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Имя пользователя:
.head 4 -  Resource Id: 22441
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    1.869"
.head 5 -  Width:  1.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Дата отм.
.head 4 -  Resource Id: 22442
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    1.619"
.head 5 -  Width:  1.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Дата к.д.
.head 4 -  Resource Id: 22443
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    1.369"
.head 5 -  Width:  1.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Подписан:
.head 4 -  Resource Id: 22444
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    0.619"
.head 5 -  Width:  1.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Дата н.д.
.head 4 -  Resource Id: 22445
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    1.119"
.head 5 -  Width:  1.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: № ключа:
.head 4 -  Resource Id: 22446
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    0.869"
.head 5 -  Width:  1.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Номер:
.head 4 -  Resource Id: 22447
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    0.369"
.head 5 -  Width:  1.75"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    0.06"
.head 6 -  Width:  3.15"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfNumber
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    0.31"
.head 6 -  Width:  3.15"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfKeyAdmin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    0.56"
.head 6 -  Width:  3.15"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfKeyNumber
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    0.81"
.head 6 -  Width:  3.15"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfDateBegin
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    1.06"
.head 6 -  Width:  3.15"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfDateEnd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    1.31"
.head 6 -  Width:  3.15"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfDateDiscard
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    1.56"
.head 6 -  Width:  3.15"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfUserName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.983"
.head 6 -  Top:    1.81"
.head 6 -  Width:  3.15"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: szCN
.head 3 -  String: szKN
.head 3 -  String: szCA
.head 3 -  String: szID
.head 3 -  String: szFIO
.head 3 -  Date/Time: dtDb
.head 3 -  Date/Time: dtDe
.head 3 -  Date/Time: dtDf
.head 2 +  Window Variables
.head 3 -  Number: nRes
.head 3 -  String: szBuf
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowText( dlgCrtInfo, 'Сертификат: ' || szCN )
.head 4 -  Set szBuf=SalStrRepeatX( ' ', 129 )
.head 4 -  ! 'Идентификатор'
.head 4 -  Set dfID = szID
.head 4 -  ! 'Номер'
.head 4 -  Set dfNumber=szCN
.head 4 -  ! '№ ключа'
.head 4 -  Set dfKeyNumber=szKN
.head 4 -  ! Кем подписан 
.head 4 -  Set dfKeyAdmin=szCA
.head 4 -  ! 'Имя пользователя'
.head 4 -  Set dfUserName=szFIO
.head 4 -  ! 'Дата н.д.'
.head 4 -  Set dfDateBegin = dtDb
.head 4 -  ! 'Дата к.д.'
.head 4 -  Set dfDateEnd = dtDe
.head 4 -  ! 'Дата отм.'
.head 4 -  Set dfDateDiscard = dtDf
