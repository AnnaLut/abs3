Application Description: Договора на эл,услуги клиентам (АЖИО)
		Межфилиальный FOREX
		Анализ кредитовых оборотов клиентов
		Интефейс с ПЦ (в АЖИО)
	Outline Version - 4.0.26
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000E20000 002C000000020000 0003000000000000 005B020000F8FFFF
0040: FFE2FFFFFFFFFFFF FF000000007C0200 004D010000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F7773025430
.enddata
.data DT_MAKERUNDLG
0000: 0200000000001D51 3A5C424152533938 5C4C494252415259 5C42415253303135
0020: 2E646C6C1D513A5C 4241525339385C4C 4942524152595C42 4152533031352E61
0040: 706300000101011D 513A5C4241525339 385C4C4942524152 595C424152533031
0060: 352E72756E1D513A 5C4241525339385C 4C4942524152595C 424152533031352E
0080: 646C6C1D513A5C42 41525339385C4C49 42524152595C4241 52533031352E6170
00A0: 630000010101175C 4241525339385C42 494E5C4241525330 30312E6170640C5C
00C0: 4241525339385C42 494E5C0C5C424152 5339385C42494E5C 0000010101001D51
00E0: 3A5C424152533938 5C4C494252415259 5C42415253303135 2E646C6C1D513A5C
0100: 4241525339385C4C 4942524152595C42 4152533031352E61 70630000010101
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left:   -0.013"
			Top:    0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: 0418B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left:   4.15"
			Top:    1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left:   0.575"
			Top:    0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left:   6.388"
			Top:    0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		File Include: Gentbl.apl
		File Include: Genlist.apl
		Dynalib: Absapi.apd
		Dynalib: Global.apd
		Dynalib: Custacnt.apd
		Dynalib: Cc_doc.apd
		Dynalib: Nsiapi.apd
		Dynalib: Docview.apd
		Dynalib: PRINTAPI.apd
		!
		File Include: Docfun6.apl
		File Include: Winapi.apl
		File Include: Xsalcpt.apl
		File Include: vttblwin.apl
		File Include: Vtmeter.apl
		File Include: Vtfile.apl
		File Include: Genlabel.apl
		File Include: XSALIMG.APL
		File Include: qckdvc.apl
		! File Include: qcktabs.apl
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
			Number: #00000
		External Functions
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
				String: ApdNum   =  '02'
				String: ApdVer   =  '01'
				! История изменений: -----------------------------------------------------|
				! 01 30-11-01  MIK     Заложил новые apd                        |
				String: sLibVersion = 'від 16.12.2016'
		Resources
		Variables
.data RESOURCE 0 0 1 1270023946
0000: 1E00000011000000 0000000000000000 02000001000000B8 000000E0010D0000
0020: 00FF3F
.enddata
			Window Handle: hWin0
			Window Handle: hWin7
			Window Handle: hWin8
			Window Handle: hWin9
			Window Handle: hWin4
			Window Handle: hWin10
			Window Handle: hWin11
			Window Handle: hWin14
			Window Handle: hWin15
			Window Handle: hWin16
			Window Handle: hWin11a
			Window Handle: hWin1
			Window Handle: hWin2
			Window Handle: hOPL
			Number: nFetchRes
			Boolean: bApdInited
		Internal Functions
			Function: Sel001	! __exported
				Description: Bars001_Selector
				Returns
				Parameters
					Window Handle: hWndParent
					Number: nMode
					Number: nPar
					String: strPar01
					String: strPar02
				Static Variables
				Local variables
				Actions
					! надо вставить инициализацию apd
					Call Ini001()
					If nMode = 0 or nMode =1 or nMode= 2 or nMode= 3 or nMode= 31
						! Угоди на ел.послуги
						! Sel001( hWndMDI, U, P, TT,  sNDS )
								U  =  Уровень доступа  ( 3 -весь портфель (тільки пергляд),
								                         0 - весь портфель,
								                         1- портфель инспектора,
								                         2 - портфель подразделения
								                         31 - портфель ТОБО (перегляд)
								P  =  Действующий Процент НДС
								TT =  Код операции (один из справочника операций ), 
								      которым будут выполнены автоматические проводки по абонплате, доходам, НДС. 
								sNDS = Лицевой счет для сумм НДС.
						If not IsWindow(hWin0)
							Set hWin0 = SalCreateWindow( T0, hWndParent, nMode, nPar, strPar01,strPar02 )
						Else
							Call SalBringWindowToTop ( T0 )
					Else If nMode = 6 or nMode = 99 ! СВЯЗЬ С ПРОЦ ЦЕНТРОМ АЖИО, запросы на списание со счетов
						If not IsWindow(hWin4)
							Set hWin4 = SalCreateWindow(PKA, hWndMDI, nMode, strPar01, strPar02, Str(nPar) )
						Else
							Call SalBringWindowToTop(PKA)
					Else
						Select Case nMode
							Case 7 ! Дисконтированная стоимость
								If not IsWindow(hWin7)
									Set hWin7 = SalCreateWindow(DS, hWndMDI, nPar, strPar01, strPar02)
								Else
									Call SalBringWindowToTop(DS)
								Break
							Case 8 ! Підкріплення гот вал поз 
								If not IsWindow(hWin8)
									Set hWin8 = SalCreateWindow(VPR, hWndMDI, nPar, strPar01, strPar02)
								Else
									Call SalBringWindowToTop(VPR)
								Break
							Case 9 ! СВЯЗЬ С ПРОЦ ЦЕНТРОМ АЖЖИО
								If not IsWindow(hWin9)
									Set hWin9 = SalCreateWindow(PK, hWndMDI, nPar, strPar01, strPar02)
								Else
									Call SalBringWindowToTop(PK)
								Break
							Case 10  ! Межфилиальный FOREX
								If not IsWindow(hWin10)
									Set hWin10 = SalCreateWindow( FX, hWndParent,nPar, strPar01,strPar02 )
								Else
									Call SalBringWindowToTop ( FX )
								Break
							Case 114 ! Анализ клиентов - накопление в архив
								If not IsWindow(hWin14)
									Set hWin14 = SalCreateWindow(ANA, hWndMDI )
								Else
									Call SalBringWindowToTop(hWin14)
								Break
							Case 115 ! Анализ клиентов с расчетом
								If not IsWindow(hWin15)
									Set hWin15 = SalCreateWindow(AN_KL, hWndMDI, nMode, '', '', 0, 0, '' )
								Else
									Call SalBringWindowToTop(AN_KL)
								Break
							Case 116 ! Анализ клиентов из архива
								If not IsWindow(hWin16)
									Set hWin16 = SalCreateWindow(AN, hWndMDI, nPar, '', '')
								Else
									Call SalBringWindowToTop(AN)
								Break
			Function: ShowApdVersion
				Description: Показать версию APD
				Returns
				Parameters
					String: sWin
				Static Variables
				Local variables
					String: strText
					Number: nLength
				Actions
					Call SalStrSetBufferLength( strText, 160 )
					Set nLength = SalGetWindowText ( hWndForm, strText, 160 )
					Call SalSetWindowText ( hWndForm, ApdNum||sWin||ApdVer||' '||SalStrTrimX(strText) )
			Function: Ini001
				Description: инициализация библиотеки
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: strPathToLangResources
					String: strLangId
					String: strFileName
				Actions
					If not bApdInited
						Set strPathToLangResources = GetLangPath()
						Set strLangId = GetLang()
						Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars001.lng"
						If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
							Call CurrentLangTable.Init()
						Set bApdInited = TRUE
					Return bApdInited
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 37876618
0000: 2C03000080010000 0000000000000000 0200000500FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F61003C00 000B5F005F457272
0040: 6F72426100736556 0100000D003C0000 010DFA0000FF6F0D 00EE0100FF3F1A00
0060: B800000100FFFFE0 2700000001FE00FF 03340000000204F8 000000FF0F380000
0080: 00EE0200FF3F3C00 B800000200FFFF80 40000000030400FE 00FF834400000002
00A0: FB00FF0F48000000 EE0200FF3F4C00B8 00000300FFFFE050 00000003FE00FF83
00C0: 5400000001FB00FF 0F01800D00110001 0000065F005F466C 61671E0000EC0001
00E0: 00D9010D00FF7F01 08801A0000020000 00000B6351756963 6B805461626C6538
0100: 00EC000200D9010D 00FF7F0D73000100 FFFF010180220000 0003000000000A63
0120: 47656E0046696C74 65727400D0000004 00003302040001FA 0000078001000000
0140: FFC60400010DFE00 FF831100000002FB 00FF0F15000000EE 0100FF3F01806622
0160: 0004001A0B474446 697F00F604008E02 000100FE00C98001 0000BF04B100010D
0180: 00FFFFE6110002FE 00FF9B150001FB00 FF0F
.enddata
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton: ctb_pbSynchro
			Radio Button:
			Option Button:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box:
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control:
		Application Actions
	Table Window: PKA
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Запити до АКС на списання коштiв
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.825"
				Top:    0.688"
				Width:  15.55"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 5000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.452"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pb_CCK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.883"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Doc_in.bmp
					Picture Transparent Color: Cyan
					Image Style: Class Default
					Text Color: Sky
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 
									'Сформувати запити з КП на 
									Прострочені та Планові платежі'
						On SAM_Click
							If SqlPLSQLCommand(hSql(),"BARS.CCK_PKA (1, 0, nOch,'', '','', 0,0 )" )
								Call SqlCommit( hSql() )
								Call SalWaitCursor(FALSE)
								Call MessageNoWait( strTip, 'CCK_PKA', 30, 0 )
								Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 ) 
							Else
								Call SqlRollback(hSql())
								Call SalWaitCursor(FALSE)
								Call MessageNoWait( 'Помилка !
										'||strTip , 'CCK_PKA', 30, 1 )
							! CREATE OR REPLACE PROCEDURE CCK_PKA
									 (MOD_ int, ND_ int, OCH_ int, NLST_ varchar2, TXT_ varchar2, NMK_ varchar2,
									  REC_ int, SV_ number);
									
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.383"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 
									'Ввести новий ' || 
									IifS(nOch =99,'Ручний','на дострокове погашення кредиту ')||' запит до АКС '
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.883"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.883"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7572
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.883"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Відповідний авто-Документ в АБС '
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7573
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 7574
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pb_Del 
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSynchro
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\ARR1TOD.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 
									'Вилучення запитів попередніх днів'
						On SAM_Click
							If SqlPrepareAndExecute( hSql(),sSqlD ) and SqlCommit( hSql() )
				!
				Pushbutton: pb_DBF
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.883"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Doc_in.bmp
					Picture Transparent Color: Cyan
					Image Style: Class Default
					Text Color: Sky
					Background Color: Red
					Message Actions
						On SAM_Create
							Set strTip = 'Сформувати файл запитів, 
									що ВИДІЛЕНІ в таблиці'
						On SAM_Click
							Call F_FILE( ROW_Selected )
				Pushbutton: pb_DBF_All
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.383"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\UNDO1.BMP
					Picture Transparent Color: Cyan
					Image Style: Class Default
					Text Color: Sky
					Background Color: Red
					Message Actions
						On SAM_Create
							Set strTip = 'Сформувати файл запитів, 
									що Є в таблиці'
						On SAM_Click
							Call F_FILE(0)
				Pushbutton: pb_DBF_Ret
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.283"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\UNDO.BMP
					Picture Transparent Color: Cyan
					Image Style: Class Default
					Text Color: Sky
					Background Color: Blue
					Message Actions
						On SAM_Create
							Set strTip = 'Обробити файл відповідей 
									'|| IifS(nOch = 99, "без АВТО-проводок (ручні)", "з АВТО-проводками в АБС" )
						On SAM_Click
							If R_FILE(0)
		Contents
			Column: REC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф.
						запиту
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						чеговостi
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sOCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Черговість
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.05"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: STA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						Стану
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sSTA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Стан
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.033"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: РЕФ
						КД
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If nOch =6 and REC = NUMBER_Null ! для КП
							Set sTmp = STRING_Null
							Call FunNSIGetFiltered
									("CC_V_PKA","PAN", " OST>0 ",sTmp, PAN )
							If sTmp != STRING_Null
								Set ND = Val(sTmp)
								If SqlPrepareAndExecute ( hSql(),"select 
										'КД № '|| substr(d.cc_id,1,20) || ' вiд '|| to_char(d.sdate,'dd/mm/yyyy') ||
										'. Достроковий платiж.', Substr(c.nmk,1,40)  
										 into :TXT, :NMK  from customer c, cc_deal d
										 where d.nd=:ND and d.rnk=c.rnk and d.sos<15 and d.sos>=10" ) 
										and SqlFetchNext( hSql(), nFetchRes )
			Column: ISP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						Вик
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.667"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Банк.
						Дата 
						формування
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.183"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: FTIM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Системний 
						час
						формування
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Left
				Width:  1.117"
				Width Editable? Yes
				Format: DateTime
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: PAN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код для 
						iдентифiкацiї 
						в АКС
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.183"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						запиту
						в "коп"
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set nTmp1 = S
					On SAM_AnyEdit
						If OCH < 3 and OCH != NUMBER_Null
							Set S = nTmp1
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Клієнт
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.667"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TXT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Коментар
						(признач.пл)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.983"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ZFIL 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Файл запиту
						 до АКС
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф.відп.
						платежу
						в АБС
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.033"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
		Functions
			Function: F_FILE
				Description:
				Returns
					Boolean:
				Parameters
					Number: nTipRow
				Static Variables
				Local variables
					String: sODBCDir
					Sql Handle: hSqlA
					String: sErr
					String: sTek_Kat 
					Boolean: FL
					Number: nKol
					String: sK ! Короткое имя без расширения ( ZZyyMMdd )
					String: sD_dbf ! Длинное имя c расширением .DBF (  PK_FILE\ZZyyMMdd.dbf )
					String: sD_nnn ! Длинное имя c расширением .nnn (  PK_FILE\ZZyyMMdd.nnn )
					String: SBK_FIO 
					String: SBK_FLR
					String: sK_nnn ! Короткое имя c расширением .nnn ( ZZyyMMdd.nnn )
					Number: nFA
					Number: nRow 
				Actions
					! Взать имя текущего каталога
					Call SalFileGetCurrentDirectory( sTek_Kat )
					! Определить след сеанс
					If SqlPrepareAndExecute( hSql(), 
							  "SELECT NVL(max(to_number(substr(ZFIL,-3))),0)+1 INTO :nFA FROM PKa_REC WHERE fdat=:PKA.bDat ") 
							and not SqlFetchNext( hSql(), nFetchRes )
						Set nFA =1
					!
					Call SalUseRegistry(FALSE, '')
					Call SalGetProfileString( 'Export', 'PK_FILE', GetPrnDir()||"\\", sODBCDir, GetIniFileName() )
					Set sK = Subs(sMask,1,8)
					Set sK_nnn = Subs(sMask,1,9) || Subs( Str(1000+nFA), 2,3 )
					Set sD_dbf = sODBCDir || '\\' || sK || '.DBF'
					Set sD_nnn = sODBCDir || '\\' || sK_nnn
					! - 1 Отказались
					If File (sD_nnn)
						If SalMessageBox("Удалить файл ?","Файл "|| sD_nnn ||" уже существует !", MB_YesNoCancel | MB_IconHand )=IDYES	
							Call VisFileDelete(sD_nnn)
						Else
							Return FALSE
					If File (sD_dbf)
						Call VisFileDelete(sD_dbf)
					! 2 - Нет каталога
					! Переустановить тек каталог на путь из ini-файла
					If not SalFileSetCurrentDirectory( sODBCDir)
						Call SalFileSetCurrentDirectory( sTek_Kat)
						Call MessageAttention('Нет каталога: ' ||   sODBCDir)
						Return FALSE
					! 3 - Ошибка подсоединения
					Set SqlDatabase='dBase_Files'
					If not SqlConnect( hSqlA )
						Call SalFileSetCurrentDirectory( sTek_Kat)
						Call MessageAttention('Ошибка подсоединения к Базе данных:'|| SqlDatabase)
						Return FALSE
					! !!!!!!!!!!!!!!!!!!!!!!
					If SqlPrepareAndExecute( hSqlA, "CREATE table "|| sK  ||" 
							( BRANCHPART NUMBER(3),
							  COMPANY  NUMBER(7),
							  SBK_NUM  Char(20),
							  SBK_SUM  Numeric(10,2), 
							  SBK_FIO  Char(40),
							  SBK_CRD  Char(20),
							  SBK_COR  Char(20), 
							  SBK_PAS  Char(20), 
							  SBK_INN  Char(10), 
							  SBK_SHR  Char(10), 
							  SBK_FLR  Char(250) )" )
						Set FL = TRUE
						Set sErr = STRING_Null
						Set nKol = 0
						Set nRow = TBL_MinRow
						While SalTblFindNextRow( hWndForm, nRow, nTipRow, 0)
							Call SalTblSetContext(hWndForm, nRow)
							If STA = 1 and ZFIL = STRING_Null
								Set SBK_FIO = StrWinToDosX( NMK )
								Set SBK_FLR = Str(REC) ||':'|| StrWinToDosX( TXT )
								Set nKol = nKol + 1
								If not SqlPrepareAndExecute( hSqlA,
										  "INSERT into "|| sK ||"(SBK_NUM,SBK_SUM,SBK_FIO,SBK_FLR) VALUES (:PAN,:S,:SBK_FIO,:SBK_FLR )") 
										or not SqlPrepareAndExecute( hSqlAux2(),
										  "UPDATE PKa_REC set STA=2, ZFIL = :sK_nnn where rec=:REC")
									Set FL = FALSE
									Set sErr = "ПКА: Помилка вставки-1"
									Break
						!
					Else
						Set FL = FALSE
						Set sErr = "ПКА: Не можу створити dbf-файл "|| sK 
					!
					If FL 
						Call SqlCommit( hSqlA ) 
						Call SqlDisconnect(hSqlA)
						Call SqlCommit( hSqlAux2() ) 
						!
						If nKol > 0
							If VisFileRename( sD_dbf, sD_nnn ) = 1 and File (sD_nnn)
								Call SalMessageBox( "Вигрузку в " || sD_nnn || " закінчено !", "Експорт", MB_Ok)
					Else
						Call SqlRollback(hSqlA )
						Call SqlDisconnect(hSqlA)
						Call SqlRollback(hSqlAux2() )
						Call SalMessageBox( "НЕУСПІШНА Вигрузка  ! "|| sErr , "Експорт", MB_Ok)
					! Восстановить тек каталог
					Call SalFileSetCurrentDirectory( sTek_Kat)
					If FL and nKol > 0
						Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
					Call SalWaitCursor(FALSE)
					Return FL
			Function: R_FILE
				Description:
				Returns
					Boolean:
				Parameters
					Number: nTipRow
				Static Variables
				Local variables
					String: sTek_Kat 
					String: sODBCDir
					Sql Handle: hSqlA
					String: sZ_nnn ! Короткое имя c расширением .nnn ( ZZyyMMdd.nnn )
					String: sK_nnn ! Короткое имя c расширением .nnn ( ZVyyMMdd.nnn )
					String: sK ! Короткое имя без расширения ( ZVyyMMdd )
					String: sD_dbf ! Длинное имя c расширением .DBF (  PK_FILE\ZVyyMMdd.dbf )
					String: sD_nnn ! Длинное имя c расширением .nnn (  PK_FILE\ZVyyMMdd.nnn )
					Number: nRec
					Number: SBK_SUM   
					String: SBK_FLR
					Number: nSta
					Boolean: FL
					String: sErr
					Number: nKol
					Number: i_
					String: ZFIL [*]  ! список файлов, ответ на которые мы ожидаем
					!
					Number: ND_
					Number: OCH_
					String: NMK_
					String: TXT_
				Actions
					! Запомнить имя тек.каталога для последующего восстановления
					Call SalFileGetCurrentDirectory( sTek_Kat )
					Call SalUseRegistry(FALSE, '')
					Call SalGetProfileString( 'Import', 'PK_FILE', GetPrnDir()||"\\", sODBCDir, GetIniFileName() )
					Set SqlDatabase='dBase_Files'
					! Переустановить тек каталог на путь из ini-файла
					If not SalFileSetCurrentDirectory( sODBCDir)
						Call SalFileSetCurrentDirectory( sTek_Kat)
						Call MessageAttention('Нет каталога: ' ||   sODBCDir)
						Return FALSE
					! Вычитать в массив список файлов, ответ на которые мы ожидаем
					Set i_ = 0 ! количество ожидаемых файлов 
					Set nKol = 0  ! количество фактически обраб записей 
					If SqlPrepareAndExecute( hSql(),
							  "select distinct ZFIL into :sZ_nnn from PKa_REC 
							   where STA=2 and ZFIL is not null and OCH " || PKA.sOch )
						While SqlFetchNext( hSql(), nFetchRes )
							Set i_ = i_ + 1
							Set ZFIL [i_]= sZ_nnn
					! Собственно обработка файлов с COMMIT по каждому файлу
					While i_ > 0
						! Имя пришедшего файла д.б
						Set sZ_nnn = ZFIL [i_]
						Set sK_nnn = sMaskV||Subs(sZ_nnn,3,10)
						Set sK = Subs(sK_nnn,1,8)
						Set sD_nnn = sODBCDir || '\\' || sK_nnn
						Set sD_dbf = sODBCDir || '\\' || sK || '.DBF'
						Set FL = FALSE
						! Если этот файл найлен
						If File (sD_nnn)
							! М.б. есть старый ненужный dbf - Удалим его
							If File (sD_dbf)
								Call VisFileDelete(sD_dbf)
							! --------------------------- Переименуем пришедший файл в dbf
							! Копируем файл в dbf
							If VisFileCopy( sD_nnn, sD_dbf ) >=0 
								! Подсоединение к ODBC
								If not SqlConnect( hSqlA )
									Call SalFileSetCurrentDirectory( sTek_Kat)
									Call MessageAttention('Ошибка подсоединения к Базе данных:'|| SqlDatabase)
									Return FALSE
								! Вычитаем в цикле записи из пришедшего файла
								Set FL = TRUE
								If SqlPrepareAndExecute( hSqlA, 
										"select SBK_FLR, SBK_SUM into :SBK_FLR, :SBK_SUM from "|| sK  )
									While SqlFetchNext( hSqlA, nFetchRes )
										Set nRec = Val( Left( SBK_FLR, At( ":",SBK_FLR )-1 ) )
										If SqlPrepareAndExecute( hSqlAux2(),
												  "select decode(s,:SBK_SUM,3,-3), OCH,ND,TXT,NMK 
												   into :nSta, :OCH_, :ND_, :TXT_, :NMK_ 
												   from pka_rec where rec=:nRec and sta=2 ")
												and SqlFetchNext(hSqlAux2(), nFetchRes ) 
												and SqlPrepareAndExecute( hSqlAux2(),"update pka_rec set sta=:nSta where rec=:nRec")
											Set nKol = nKol + 1
											If nSta = 3 ! Удовл.запрс
												Set sErr = STRING_Null
												If FL and nOch = 6 ! для КП -  Оплата
													If NOT SqlPLSQLCommand(hSql(),
															"BARS.CCK_PKA (2, ND_, OCH_, NLST_, TXT_,NMK_, nRec,SBK_SUM )" )
														Set FL = FALSE
														Set sErr = "ПКА: Помилка при оплаті"
														Break
													! CREATE OR REPLACE PROCEDURE CCK_PKA
															 (MOD_ int, ND_ int, OCH_ int, NLST_ varchar2, TXT_ varchar2, NMK_ varchar2,
															  REC_ int, SV_ number);
								Else
									Set FL = FALSE
									Set sErr = "ПКА: Не можу прочитати dbf-файл "|| sK 
								If FL 
									Call SqlCommit( hSqlAux2() ) 
								Else
									Call SqlRollback(hSqlAux2() )
									Call SalMessageBox( "НЕУСПІШНА Обробка  ! "|| sErr , "Імпорт", MB_Ok)
								! Отсоединение от ODBC
								Call SqlDisconnect(hSqlA)
						Set i_ = i_ - 1
					! Восстановить тек каталог
					Call SalFileSetCurrentDirectory( sTek_Kat)
					If nKol > 0
						Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
						Set FL = TRUE
					Else
						Set FL = FALSE
					Call SalWaitCursor(FALSE)
					Return FL
		Window Parameters
			Number: nOch
			String: sMaskZ
			String: sMaskV
			String: NLST_
		Window Variables
			Date/Time: bDat
			Number: nTmp1
			String: sTmp
			String: sSqlD
			String: sMask
			String: sOch
			! cDoc: cDoc
.winattr class :
				Class: cDoc
.end
		Message Actions
			On SAM_Create
				Set PKA.bDat =  GetBankDate()
				Set sMask = sMaskZ || SalFmtFormatDateTime( bDat , "yyMMdd" ) || ".___"
				Call SalSetWindowText( hWndForm, IifS(nOch=99, "Ручні", "КП:")||" Запити до АКС на списання коштiв" )
				If nOch = 99 ! для ручных
					Set PKA.sOch = "=:PKA.nOch "
					Call SalHideWindow( pb_CCK )
					Call SalHideWindow( ND )
					Call SalHideWindow( OCH )
					Call SalHideWindow( sOCH )
					Set PKA.strSqlPopulate =
							"SELECT PKA_REC.REC, PKA_REC.OCH, PKA_REC.STA, PKA_REC.ISP, PKA_REC.FDAT, PKA_REC.FTIM, 
							        PKA_REC.PAN, PKA_REC.S  , PKA_REC.ZFIL,PKA_REC.NMK, PKA_REC.TXT , PKA_REC.REF ,
							        o.name, s.name
							 INTO :PKA.REC, :PKA.OCH, :PKA.STA,  :PKA.ISP, :PKA.FDAT, :PKA.FTIM, 
							      :PKA.PAN, :PKA.S  , :PKA.ZFIL, :PKA.NMK, :PKA.TXT , :PKA.REF , 
							      :PKA.sOCH,:PKA.sSTA
							 from  PKA_REC, PKa_och O, PKA_sta S 
							 where PKA_REC.OCH = O.OCH AND PKA_REC.STA = S.STA and PKA_REC.OCH " || PKA.sOch || "
							   AND (PKA_REC.FDAT = :PKA.bDat OR PKA_REC.STA IN (2,3,-3) ) 
							  order by PKA_REC.REC DESC  "
				Else If nOch = 6 ! для КП
					Set PKA.sOch  = "<=:PKA.nOch "
					Call SalDisableWindow( PAN )
					Call SalDisableWindow( TXT )
					Call SalDisableWindow( NMK)
					Call SalDisableWindow( REF)
					Set PKA.strSqlPopulate =
							"SELECT PKA_REC.REC,PKA_REC.OCH,PKA_REC.STA ,PKA_REC.ND ,PKA_REC.ISP,PKA_REC.FDAT, PKA_REC.FTIM,
							        PKA_REC.PAN,PKA_REC.S  ,PKA_REC.ZFIL,PKA_REC.NMK,PKA_REC.TXT,PKA_REC.REF ,
							        o.name, s.name
							 INTO :PKA.REC, :PKA.OCH, :PKA.STA, :PKA.ND,  :PKA.ISP, :PKA.FDAT, :PKA.FTIM, 
							      :PKA.PAN, :PKA.S ,  :PKA.ZFIL,:PKA.NMK, :PKA.TXT, :PKA.REF , 
							      :PKA.sOCH, :PKA.sSTA
							 from  PKA_REC, PKa_och O, PKA_sta S , CC_DEAL D
							 where PKA_REC.OCH = O.OCH AND PKA_REC.STA=S.STA AND D.ND=PKA_REC.nd AND PKA_REC.OCH " || PKA.sOch || "
							   AND (PKA_REC.FDAT=:PKA.bDat OR PKA_REC.STA IN (2,3,-3) ) 
							  order by PKA_REC.ND, PKA_REC.OCH, PKA_REC.REC DESC "
				Set sSqlD = "DELETE FROM PKA_REC where  FDAT < :PKA.bDat and OCH "|| PKA.sOch
				Set PKA.strSqlDelete = "DELETE FROM PKA_REC where (STA=1 OR FDAT < :PKA.bDat ) AND REC =:PKA.REC "
				Set PKA.strSqlInsert = "INSERT into PKA_REC(OCH,ND,S,PAN,TXT,NMK) values (:PKA.nOch,:PKA.ND,:PKA.S,:PKA.PAN,:PKA.TXT,:PKA.NMK)"
				Set PKA.strSqlUpdate = "UPDATE PKA_REC SET pan=:PKA.PAN,s=:PKA.S,txt=:PKA.TXT,nmk=:PKA.NMK where STA=1 and FDAT=:PKA.bDat AND REC=:PKA.REC " 
				Call SalTblSetLockedColumns( hWndForm, 9 )
				! Call SalHideWindow( cmb_FA )
				Set PKA.strFilterTblName = 'PKA_REC'
				! Set PKA.nUser = GetUserId()
				Set PKA.nTabInstance = 1
				Set PKA.strPrintFileName = 'PKA_REC'
				!
				! Set PK.bDat3 = PK.bDat - PK.nDni
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			! On UM_Update
				                                                                         Call SalWaitCursor(TRUE)
				!
				! Call SqlPrepare(hSql(),
						 "insert into operw (ref, tag, value) values (:PK.REF, 'PK_F ', 'NOT_FILE' ) ")
				! Call SalTblDoDeletes(hWndForm, hSql(),  ROW_MarkDeleted)
				!
				                                                                         Call SqlPrepare(hSql(),"DELETE FROM pk_ref where ref=:PK.REF")
				                                                                         Call SalTblDoDeletes(hWndForm, hSql(),  ROW_MarkDeleted)
				!
				                                                                         Call SqlPrepare(hSql(),
						 "insert into oper_visa(ref,dat,userid,STATUS) values (:PK.REF,sysdate,:PK.nUser,7) ")
				                                                                         Call SalTblDoUpdates(hWndForm, hSql(), FALSE )
				                                                                         Call SqlPrepare(hSql(),
						 "update OPERW  set VALUE=decode( tag, 'PK_H ', :PK.FIO, :PK.KART )
						  WHERE REF=:PK.REF and tag in ('PK_H ','PK_N ') ")
				                                                                         Call SalTblDoUpdates(hWndForm, hSql(), TRUE )
				!
				                                                                         Call SalSendClassMessage(UM_Update, 0, 0)
				                                                                         Call SalWaitCursor(FALSE)
			On SAM_DoubleClick
				If REF >0     
					Call DocViewContentsEx(hWndForm, REF)
			! On SAM_FetchRowDone
				                                                                         If PK.TIP = 'ПКЮ'
					                                                                         Call XSalTblSetRowBackColor( hWndForm, lParam,  SalColorFromRGB( 230,255,230 )  )
				                                                                         If PK.S < 0
					                                                                         Call XSalTblSetCellBackColor( PK.S , COLOR_Salmon )
				                                                                         If SqlPrepareAndExecute( hSqlAux2(),
						"SELECT value INTO :KART FROM operw WHERE ref=:REF and tag='PK_N ' " )
						and SqlFetchNext( hSqlAux2(), nFetchRes )
				                                                                         If SqlPrepareAndExecute( hSqlAux2(),
						"SELECT value INTO :FIO FROM operw WHERE ref=:REF and tag='PK_H ' " )
						and SqlFetchNext( hSqlAux2(), nFetchRes )
			! On SAM_ColumnSelectClick
				! Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
				! Set bSortOrd = not bSortOrd
				! Call SalTblSortRows(hWndForm, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
	Table Window: AN
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Аналіз русурсів, динаміки, доходності клієттів банку по місяцям
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.225"
				Top:    0.229"
				Width:  17.267"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.619"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 31823
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.333"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.783"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Фильтр по реквизитам карточки клиента'
				Pushbutton: pbFilterA
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbFilter
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.283"
						Top:    0.155"
						Width:  0.4"
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Фильтр по реквизитам архива анализа клиента'
						On SAM_Click
							If SetQueryFilter( cF2 )
								Set sf2 = cF2.GetFilterWhereClause( FALSE )
							Else
								Set sf2 =''
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Pushbutton: pbDetails_All
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.283"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Details.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Детально по РАХУНКАХ всіх вибраних клієнтах'
						On SAM_Click
							If not IsWindow(hWin15)
								Set hWin15 = SalCreateWindow
										(AN_KL, hWndMDI, 117, strTip, sf2, 0, 0, sf )
							Else
								Call SalBringWindowToTop(AN_KL)
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.783"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Детально по РАХУНКАХ одного вибраного клієнта'
						On SAM_Click
							If not IsWindow(hWin15)
								Set hWin15 = SalCreateWindow
										(AN_KL,
										 hWndMDI,
										 117,
										 IifS(AN.VIP=STRING_Null,'','VIP='|| AN.VIP ||' ') || AN.NMK,
										 '',
										 AN.KLI,
										 AN.RNKP,'' )
							Else
								Call SalBringWindowToTop(AN_KL)
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.783"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 31824
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 31825
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbKOS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbSwitch
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.283"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Doc_turn.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Default
					Message Actions
						On SAM_Click
							If not IsWindow(hWin11a)
								Set hWin11a = SalCreateWindow( AN1, hWndMDI, KLI, NMK, OKPO )
							Else
								Call SalBringWindowToTop ( AN1)
						On SAM_Create
							Set strTip = 'Динамика Кредитовых оборотов'
				Option Button: pb_Tab
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.283"
						Top:    0.155"
						Width:  0.429"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\look.bmp
					Picture Transparent Color: Gray
					Button Style: Check
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 
									'Показати/Скрити загальну фінансову інформацію по клієнтах' )
						On SAM_Click
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Data Field: dYYYY
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.983"
							Top:    0.155"
							Width:  1.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: dL
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   6.483"
							Top:    0.155"
							Width:  0.367"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Validate
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Background Text: -
					Resource Id: 41601
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.983"
						Top:    0.179"
						Width:  0.4"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Justify: Center
					Font Name: Default
					Font Size: 14
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Default
				Frame
					Resource Id: 22603
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   0.183"
						Top:    0.071"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
		Contents
			Column: VIP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Гр.
						VIP
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.417"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNKP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реєст.
						№ холд
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KLI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реєст.
						№ кл
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата реєс.
						 в банке
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  0.95"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OKPO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОКПО
						кл
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.0"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Найменування
						кл
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.367"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TOBO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ТОБО
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MEN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Менеджер
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: YYYY
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рік
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S01
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Срд.зал.
						01
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: K01
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Крд.об.
						01
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D01
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D01
						01
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S02
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Срд.зал.
						02
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: K02
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Крд.об.
						02
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D02
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D01
						02
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S03
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Срд.зал.
						03
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: K03
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Крд.об.
						03
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D03
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D01
						03
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S04
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Срд.зал.
						04
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: K04
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Крд.об.
						04
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D04
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D01
						04
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S05
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Срд.зал.
						05
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: K05
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Крд.об.
						05
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D05
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D01
						05
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S06
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Срд.зал.
						06
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: K06
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Крд.об.
						06
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D06
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D01
						06
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S07
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Срд.зал.
						07
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: K07
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Крд.об.
						07
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D07
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D01
						07
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S08
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Срд.зал.
						08
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: K08
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Крд.об.
						08
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D08
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D01
						08
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S09
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Срд.зал.
						09
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: K09
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Крд.об.
						09
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D09
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D01
						09
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S10
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Срд.зал.
						10
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: K10
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Крд.об.
						10
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D10
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D01
						10
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S11
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Срд.зал.
						11
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: K11
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Крд.об.
						11
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D11
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D01
						11
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S12
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Срд.зал.
						12
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: K12
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Крд.об.
						12
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D12
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D01
						12
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_HIDE
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If AN.pb_Tab
						! Щирокая таблица
						Set AN.strSqlPopulate =
								"SELECT distinct nvl(CUSTOMER.TOBO,'0'), to_char(CUSTOMER.ISP),
								        CUSTOMER.RNK, CUSTOMER.NMK, substr(w.value,1,3), CUSTOMER.RNKP, 
								        CUSTOMER.DATE_ON, CUSTOMER.OKPO,  to_number(:dYYYY) - c.num+1,
								        c.num
								 INTO :AN.TOBO, :AN.MEN, :AN.KLI, :AN.NMK,  :AN.VIP, :AN.RNKP, :AN.DAT, :AN.OKPO, :AN.YYYY, :nTmp
								 FROM  CUSTOMERW w, CUSTOMER, conductor c" || IifS ( AN.sFROM = "", "", ", "|| AN.sFROM ) || " 
								 WHERE w.tag (+)='VIP_K' and w.rnk(+)=CUSTOMER.rnk  and c.num <= :AN.dL and 
								  CUSTOMER.rnk in 
								(select rnk from arc_AN_KL "|| IifS( sf2="", "", " where "|| sf2 ) || " ) " 
								|| IifS( AN.sf = "", "", " and "|| AN.sf ) || 
								" ORDER By  CUSTOMER.RNKP,  CUSTOMER.RNK, c.num  "
						!
						Call SalShowWindow( S01 )
						Call SalShowWindow( K01 )
						Call SalShowWindow( D01 )
						Call SalShowWindow( S02 )
						Call SalShowWindow( K02 )
						Call SalShowWindow( D02 )
						Call SalShowWindow( S03 )
						Call SalShowWindow( K03 )
						Call SalShowWindow( D03 )
						Call SalShowWindow( S04 )
						Call SalShowWindow( K04 )
						Call SalShowWindow( D04 )
						Call SalShowWindow( S05 )
						Call SalShowWindow( K05)
						Call SalShowWindow( D05 )
						Call SalShowWindow( S06 )
						Call SalShowWindow( K06 )
						Call SalShowWindow( D06 )
						Call SalShowWindow( S07 )
						Call SalShowWindow( K07 )
						Call SalShowWindow( D07 )
						Call SalShowWindow( S08 )
						Call SalShowWindow( K08 )
						Call SalShowWindow( D08 )
						Call SalShowWindow( S09 )
						Call SalShowWindow( K09 )
						Call SalShowWindow( D09 )
						Call SalShowWindow( S10 )
						Call SalShowWindow( K10 )
						Call SalShowWindow( D10 )
						Call SalShowWindow( S11 )
						Call SalShowWindow( K11 )
						Call SalShowWindow( D11 )
						Call SalShowWindow( S12 )
						Call SalShowWindow( K12 )
						Call SalShowWindow( D12 )
						Call SalShowWindow( AN.YYYY )
					Else
						! Узкая таблица
						Set AN.strSqlPopulate =
								"SELECT distinct NVL(CUSTOMER.TOBO,0), to_char(CUSTOMER.ISP),
								        CUSTOMER.RNK, CUSTOMER.NMK, substr(w.value,1,3), CUSTOMER.RNKP, 
								        CUSTOMER.DATE_ON, CUSTOMER.OKPO 
								 INTO :AN.TOBO, :AN.MEN, :AN.KLI, :AN.NMK,  :AN.VIP, :AN.RNKP, :AN.DAT, :AN.OKPO  
								 FROM  CUSTOMERW w, CUSTOMER" || IifS ( AN.sFROM = "", "", " , "|| AN.sFROM ) || " 
								WHERE w.tag (+)='VIP_K' and w.rnk(+)=CUSTOMER.rnk  and
								  CUSTOMER.rnk in (select rnk from arc_AN_KL "|| IifS( sf2="", "", " where "|| sf2 ) || "  )" 
								|| IifS( AN.sf = "", "", " and "|| AN.sf ) || 
								" ORDER BY  CUSTOMER.RNKP,  CUSTOMER.RNK "
						Call SalHideWindow( S01 )
						Call SalHideWindow( K01 )
						Call SalHideWindow( D01 )
						Call SalHideWindow( S02 )
						Call SalHideWindow( K02 )
						Call SalHideWindow( D02 )
						Call SalHideWindow( S03 )
						Call SalHideWindow( K03 )
						Call SalHideWindow( D03 )
						Call SalHideWindow( S04 )
						Call SalHideWindow( K04 )
						Call SalHideWindow( D04 )
						Call SalHideWindow( S05 )
						Call SalHideWindow( K05)
						Call SalHideWindow( D05 )
						Call SalHideWindow( S06 )
						Call SalHideWindow( K06 )
						Call SalHideWindow( D06 )
						Call SalHideWindow( S07 )
						Call SalHideWindow( K07 )
						Call SalHideWindow( D07 )
						Call SalHideWindow( S08 )
						Call SalHideWindow( K08 )
						Call SalHideWindow( D08 )
						Call SalHideWindow( S09 )
						Call SalHideWindow( K09 )
						Call SalHideWindow( D09 )
						Call SalHideWindow( S10 )
						Call SalHideWindow( K10 )
						Call SalHideWindow( D10 )
						Call SalHideWindow( S11 )
						Call SalHideWindow( K11 )
						Call SalHideWindow( D11 )
						Call SalHideWindow( S12 )
						Call SalHideWindow( K12 )
						Call SalHideWindow( D12 )
						Call SalHideWindow( AN.YYYY )
		Window Parameters
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Number: nMM
			Number: nS[*]
			Date/Time: dDat
			String: sf
			String: sFROM
			String: sLike
			!
			String: sSql
			Number: nColID
			Number: i
			Window Handle: hWndCol
			Number: nTmp
			!
			: cF2
				Class: cGenFilter
			String: sf2
			String: sTOBO
			String: sMEN
		Message Actions
			On SAM_Create
				Set AN.strPrintFileName = 'AN'
				Set AN.strFilterTblName ='CUSTOMER'
				Set AN.nTabInstance= 1
				Set AN.pb_Tab = FALSE
				Call cF2.Init('ARC_AN_KL', '')
				!
				Set AN.dDat = GetBankDate()
				Set AN.dYYYY = Val(SalFmtFormatDateTime( AN.dDat, 'yyyy' ))
				Set AN.dL = 2
				!
				Set AN.sSql =
						"SELECT to_number(substr(nmk,5,2)),
						        Round ( Sum( S_980+Q_840+Q_978+Q_810 ) / 100, 0 ),
						        Round ( Sum( C_EQV ) / 100, 0 ),
						        Round ( Sum( D1 ) / 100, 0 )  
						 INTO :AN.nMM,  :AN.nS[1], :AN.nS[2], :AN.nS[3]
						 FROM arc_AN_KL
						 WHERE rnk=:AN.KLI and Nmk LIKE :sLike 
						 GROUP BY nmk "
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_DoubleClick
				Call SalSendMsg( AN.pbDetails, SAM_Click, 0, 0 )
			On UM_Populate
				Call SalWaitCursor(TRUE)
				If dL =0 
					Set dL =1 
				Set sf=""
				Set sf = cF.GetFilterWhereClause( FALSE )
				Set sFROM = cF.GetFilterFromClause( FALSE )
				Call F_HIDE()
				! Call Debug( sf )
				Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
				Call SalTblPopulate(hWndForm, hSql(), T(AN.strSqlPopulate), TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If AN.pb_Tab
					Set sLike = Str(AN.YYYY) ||'__' 
					If SqlPrepareAndExecute( hSqlAux2(),  AN.sSql )
						While SqlFetchNext( hSqlAux2(), nFetchRes)
							Set nColID = 9 + (nMM-1)*3 
							Set i = 1
							While i < 4
								Call SalTblSetColumnText ( hWndForm, nColID+i, Str(nS[i]) )
								Set AN.hWndCol = SalTblGetColumnWindow ( hWndForm, nColID+i, COL_GetID )
								Set i = i + 1
					If AN.YYYY != AN.dYYYY 
						Call XSalTblSetRowBackColor( hWndForm, lParam,COLOR_LightGray )
						Set TOBO = STRING_Null
						Set MEN = STRING_Null
				!
				If NOT AN.pb_Tab OR AN.YYYY = AN.dYYYY 
					If TOBO != '0'
						If SqlPrepareAndExecute( hSqlAux2(),"select name into :sTOBO from tobo where tobo=:TOBO" )
								and SqlFetchNext( hSqlAux2(), nFetchRes)
							Set TOBO = TOBO ||' '|| sTOBO
					Else
						Set TOBO = 'Головной банк'
					If MEN != STRING_Null
						If SqlPrepareAndExecute( hSqlAux2(),"select fio into :sMEN from staff where id=:MEN" )
								and SqlFetchNext( hSqlAux2(), nFetchRes)
							Set MEN =  MEN  ||' '|| sMEN
			On SAM_CreateComplete
				Call F_HIDE()
				Call SalWaitCursor(FALSE)
	Table Window: AN_KL
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Аналіз клієнтів банку
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.05"
				Top:    0.76"
				Width:  17.267"
				Width Editable? Class Default
				Height: 6.655"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 29000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.619"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.917"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						! On SAM_Create
							                                                                                                                                                      Set strTip = 'Выполнить формирование в архив за месяц первой даты '
						! On SAM_Click
							                                                                                                                                                      Call F_PROC (1)
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.283"
							Top:    0.155"
							Width:  2.3"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: DAT2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   2.583"
							Top:    0.155"
							Width:  2.3"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: sNls
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   4.883"
							Top:    0.155"
							Width:  2.9"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? No
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_Validate
							Set AN_KL.sNls=SalStrTrimX( AN_KL.sNls )
				Data Field: nRnk1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.283"
							Top:    0.155"
							Width:  2.3"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Data Field: nRnk2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.583"
							Top:    0.155"
							Width:  2.3"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				Frame
					Resource Id: 22604
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   7.483"
						Top:    0.071"
						Width:  1.8"
						Width Editable? Yes
						Height: 0.5"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Check Box: cb1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Только по VIP
					Window Location and Size
						Left:   4.883"
						Top:    0.155"
						Width:  1.833"
						Width Editable? Yes
						Height: 0.321"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				!
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.883"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Выполнить текущее формирование в интервале дат '
						On SAM_Click
							Call SalSetWindowText( hWndForm, 'Анализ клиентов c '||
									 SalFmtFormatDateTime( AN_KL.DAT1, 'dd-MM-yyyy' ) ||' по '||
									 SalFmtFormatDateTime( AN_KL.DAT2, 'dd-MM-yyyy')||'.   ( Маска '||
									 AN_KL.sNls||'. Рег № >='||Str(AN_KL.nRnk1)||' и Рег № <='||Str(AN_KL.nRnk2)|| ' )' )
							Call F_PROC (0)
				Line
					Resource Id: 31829
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   7.683"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.183"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							If nMode = 115  !! оперативныій расчет
								Set strTip = 'Фильтр по реквизитам карточки клиента'
							Else If nMode = 117 !! из архива
								Set strTip = 'Фильтр по реквизитам архива анализа клиента'
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.383"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 31830
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.983"
						Top:    0.155"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 31831
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: ISP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вик
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.5"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: VIP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Гр.
						VIP
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.417"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: RNKP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реєст.
						№ холд
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.733"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KLI
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реєст.
						№ кл
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Найменування
						кл
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TOBO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ТОБО
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MEN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Менеджер
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMKD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Найменування
						кл
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Особ.рах
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кіл.
						вал
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: Q_SN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Q_SN
						Екв-сума
						деб.20_8
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.933"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: S_980
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: S_980
						Срд.зал
						грн
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.1"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S_840
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: S_840
						Срд.зал
						USD
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.133"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S_978
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: S_978
						Срд.зал
						EUR
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.067"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S_810
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: S_810
						Срд.зал
						RUB
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.067"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: Q_840
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Q_840
						Срд.заk
						екв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.117"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: Q_978
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Q_978
						Срд.зал
						екв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.117"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: Q_810
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Q_810
						Срд.зал
						екв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.117"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: C_EQV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: C_EQV
						Чисті кр.об
						екв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.067"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: K_980
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: K_980
						Кр.об
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.017"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: K_840
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: K_840
						Кр.об
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.983"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: K_978
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: K_978
						Кр.об
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.0"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: K_810
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: K_810
						Кр.об
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.983"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: NNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: NNK
						Почат.
						не ел
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NYK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: NYK
						Почат
						ел
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: NMB
						Почат
						СЕП
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OMB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: OMB
						Відп
						СЕП
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.517"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: D01
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D01
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D02
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D02
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D03
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D03
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D04
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D04
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D05
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D05
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D06
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D06
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D07
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D07
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D08
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D08
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D09
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D09
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D10
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D10
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D11
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D11
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D12
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D12
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D13
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D13
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D14
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D14
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D15
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D15
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D16
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D16
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D17
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D17
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D18
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D18
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D19
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D19
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: D20
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D20
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D21
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D21
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D22
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D22
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D23
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D23
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: D24
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: D24
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
			Column: R01
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: R01
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.783"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
			Column: R02
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: R02
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.783"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
			Column: R03
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: R03
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.783"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
			Column: R04
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: R04
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.783"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
			!
			!
			Column: F01
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: F01
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.117"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F02
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: F02
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F03
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: F03
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F04
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: F04
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F05
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: F05
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F06
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: F06
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F07
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: F07
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F08
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: F08
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F09
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: F09
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: F10
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: F10
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.85"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_TITL
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nColID
					Number: nF
					Window Handle: hWndCol
					String: strColName
					Number: nColAppId
					String: strTitl
					String: strFormula
					String: sG
				Actions
					Set nColID = 15
					Loop
						Set hWndCol = SalTblGetColumnWindow ( hWndForm, nColID, COL_GetID )
						If hWndCol = hWndNULL
							Return TRUE
						Call SalGetItemName( hWndCol, strColName )
						Set sG = SalStrLeftX( strColName, 1 )
						If sG ='D' or sG ='R' or sG ='F' 
							If SqlPrepareAndExecute( hSql(),
									"SELECT name, FRM INTO :strTitl, :strFormula FROM an_kl_GRF WHERE grf=:strColName " )
									and SqlFetchNext( hSql(), nFetchRes)
								Call SalTblSetColumnTitle( hWndCol, strColName||"
										"||Subs(strTitl,01,10) ||"
										"||Subs(strTitl,11,10) ||"
										"||Subs(strTitl,21,10) )
								If sG ='F'
									Set nF = Val(Subs(strColName, 2,2))
									Set sForm [nF] = strFormula
									! Call DebugN(nF)
									! Call Debug(strFormula)
						Set nColID = nColID + 1
			Function: F_PROC
				Description:
				Returns
				Parameters
					Number: nMode 
				Static Variables
				Local variables
					String: sFilt_
					String: sFrom_
				Actions
					Set sFilt_ = ""
					Set sFilt_ = cF.GetFilterWhereClause( FALSE )
					! Call Debug('sFilt_='|| sFilt_ )
					Set sFrom_ = ""
					Set sFrom_ = cF.GetFilterFromClause( FALSE )
					! Call Debug('sFrom_='|| sFrom_ )
					!
					If SalMessageBox(
							  "Выполнить расчет "|| IifS(sFilt_ = "", "БЕЗ фильтра ?", "с учетом фильтра ? "|| sFilt_ ),
							   "Подтвердите (или откажитесь)", MB_IconQuestion | MB_YesNo) = IDYES 
						If sFilt_ != ""
							Call SalWaitCursor(TRUE)
							If SqlPrepareAndExecute( hSql(), 
									T("BEGIN 
									   delete from tmp_rnk;
									   insert into tmp_rnk(rnk) 
									   select distinct customer.rnk 
									   from customer "|| IifS( sFrom_="", "", ","||sFrom_ ) || 
									 " where "||sFilt_||";
									END;" ) )
								Set sFilt_ = "+"
							Else
								Call SalWaitCursor(FALSE)
								Return FALSE
						Else
							Set sFilt_ = "-"
						!
						If SqlPLSQLCommand(hSql(),
								"BARS.AN2.an_kl_p
								(AN_KL.nID, AN_KL.DAT1, AN_KL.DAT2, AN_KL.nRnk1, AN_KL.nRnk2, AN_KL.sNls, AN_KL.cb1, nMode, sFilt_ )" )
							Call SqlCommit( hSql() )
							Call SalWaitCursor(FALSE)
							Call MessageNoWait( 'Выполнение процедуры завершено!', 'AN_KL_P', 30, 0 )
						Else
							Call SqlRollback(hSql())
							Call SalWaitCursor(FALSE)
							Call MessageNoWait( 'Ошибка при выполнении процедуры !', 'AN_KL_P', 30, 1 )
							Return FALSE
					!
					Return TRUE
			Function: F_Form
				Description:
				Returns
					Number:
				Parameters
					String: sForm
				Static Variables
				Local variables
					Number: nTypeF
					Number: nErrorF
					Number: nErrPosF
					Number: nRetF
					String: sRetF
					Date/Time: dRetF
					Window Handle: hWndF
				Actions
					If sForm != STRING_Null
						Set nTypeF =  SalCompileAndEvaluate( SalStrTrimX(sForm), 
								nErrorF, nErrPosF, nRetF, sRetF, dRetF, hWndF, FALSE, SalContextCurrent(  ) )
						Return nRetF
					! Return 0
		Window Parameters
			Number: nMode !!! 115 = Оперативный просмотр
					                  117 = 
			String: strPar01
			String: sf2
			Number: pRNK
			Number: pRNKP
			String: sf
			!
		Window Variables
			String: sYYYYMM
			Date/Time: DatB_
			Date/Time: DatE_
			String: sTOBO
			String: sMEN
			Number: nID
			Number: nColD
			Number: nColR
			Number: nCol
			Boolean: FL
			Number: nCol_980
			Number: nCol_840
			Number: nCol_978
			Number: nCol_810
			String: sForm [11] 
			!
			Number: K1_980
			Number: K2_980
			Number: K3_980
			Number: K4_980
			Number: K5_980
			Number: K1_840
			Number: K2_840
			Number: K3_840
			Number: K4_840
			Number: K5_840
			Number: K1_978
			Number: K2_978
			Number: K3_978
			Number: K4_978
			Number: K5_978
			Number: K1_810
			Number: K2_810
			Number: K3_810
			Number: K4_810
			Number: K5_810
			Number: D360
			Number: D30
		Message Actions
			On SAM_Create
				Set AN_KL.nCol_980 = SalColorFromRGB( 255,255,180)  !  желтій
				Set AN_KL.nTabInstance= 1
				Set AN_KL.nCol_840 = SalColorFromRGB( 230,255,230 ) ! бледнозеленый
				Set AN_KL.nCol_978 = COLOR_Sky  ! бледноголубой
				Set AN_KL.nCol_810 = COLOR_LightGray ! серый
				!
				Set AN_KL.nColD = COLOR_LightAqua  ! ДОХОДЫ голубой
				Set AN_KL.nColR = SalColorFromRGB( 255,210,250 )   ! расходы - розовый
				Set AN_KL.nCol  = COLOR_LightGreen  ! операции - ЗЕЛЕНЫЙ
				Call AN_KL.F_TITL()
				Set AN_KL.nID=GetUserId()
				Set AN_KL.cb1 = FALSE
				Set AN_KL.strPrintFileName = 'AN_KL'
				If nMode = 115  !! оперативныій расчет
					Call SalHideWindow( AN_KL.nRnk1 )
					Call SalHideWindow( AN_KL.nRnk2 )
					!
					Set AN_KL.fFilterAtStart = TRUE
					!
					Set AN_KL.DAT2= GetBankDate()
					Set AN_KL.DAT1= GetBankDate() +1 -SalDateDay( GetBankDate())
					Set AN_KL.nRnk1=1
					Set AN_KL.nRnk2=999999
					Set AN_KL.sNls='2600_%'
					Set AN_KL.strFilterTblName ='CUSTOMER'
					Call SalColorSet( pbFilter, COLOR_IndexWindow, COLOR_LightGreen ) ! Зеленая кнопка фильтра
					Set AN_KL.strSqlPopulate =
							"SELECT distinct 
							        TMP_AN_KL.ISP, TMP_AN_KL.RNK, CUSTOMER.NMK,
							        nvl(CUSTOMER.TOBO,'0'),to_char(CUSTOMER.ISP), TMP_AN_KL.NLS  ,
							        S_980/100, S_840/100, S_978/100, S_810/100,
							        C_EQV/100, Q_840/100, Q_978/100, Q_810/100,
							        K_980/100, K_840/100, K_978/100, K_810/100,
							        NNK      , NYK      , NMB      , OMB      ,
							        d1/100   , d2/100   , d3/100   , d4/100   ,
							        d5/100   , d6/100   , d7/100   , d8/100   ,
							        d9/100   , d10/100  , d11/100  , d12/100  ,
							        d13/100  , d14/100  , d15/100  , d16/100  ,
							        d17/100  , d18/100  , d19/100  , d20/100  ,
							        d21/100  , d22/100  , d23/100  , d24/100  ,
							        r1/100   , r2/100   , r3/100   , r4/100,
							        substr(w.value,1,3) , CUSTOMER.RNKP
							 INTO :AN_KL.ISP  , :AN_KL.KLI  , :AN_KL.NMK, :AN_KL.TOBO,:AN_KL.MEN,:AN_KL.NLS,
							      :AN_KL.S_980, :AN_KL.S_840, :AN_KL.S_978, :AN_KL.S_810,
							      :AN_KL.C_EQV, :AN_KL.Q_840, :AN_KL.Q_978, :AN_KL.Q_810,
							      :AN_KL.K_980, :AN_KL.K_840, :AN_KL.K_978, :AN_KL.K_810,
							      :AN_KL.NNK  , :AN_KL.NYK  , :AN_KL.NMB  , :AN_KL.OMB  ,
							      :AN_KL.D01  , :AN_KL.D02  , :AN_KL.D03  , :AN_KL.D04  ,
							      :AN_KL.D05  , :AN_KL.D06  , :AN_KL.D07  , :AN_KL.D08  ,
							      :AN_KL.D09  , :AN_KL.D10  , :AN_KL.D11  , :AN_KL.D12  ,
							      :AN_KL.D13  , :AN_KL.D14  , :AN_KL.D15  , :AN_KL.D16  ,
							      :AN_KL.D17  , :AN_KL.D18  , :AN_KL.D19  , :AN_KL.D20  ,
							      :AN_KL.D21  , :AN_KL.D22  , :AN_KL.D23  , :AN_KL.D24  ,
							      :AN_KL.R01  , :AN_KL.R02  , :AN_KL.R03  , :AN_KL.R04,
							      :AN_KL.VIP  , :AN_KL.RNKP
							 FROM TMP_AN_KL, CUSTOMERW w, customer
							 WHERE TMP_AN_KL.nmk is null  and
							       w.tag (+)='VIP_K' and w.rnk(+)=TMP_AN_KL.rnk and CUSTOMER.rnk=TMP_AN_KL.rnk
							 ORDER BY  CUSTOMER.RNKP,  TMP_AN_KL.RNK "
				Else If nMode = 117 !! из архива
					Set AN_KL.strFilterTblName ='ARC_AN_KL'
					Call SalColorSet( pbFilter, COLOR_IndexWindow, COLOR_Sky ) ! Голубая кнопка фильтра
					Call SalHideWindow( AN_KL.cb1 )
					Call SalHideWindow( AN_KL.pbUpdate )
					Call SalHideWindow( AN_KL.pbIns )
					Call SalHideWindow( AN_KL.DAT1 )
					Call SalHideWindow( AN_KL.DAT2 )
					Call SalTblSetColumnTitle( AN_KL.NMK, "Рік Міс" )
					Set AN_KL.nRnk1 = AN_KL.pRNK
					Set AN_KL.nRnk2 = AN_KL.pRNKP
					Set AN_KL.sNls  = AN_KL.strPar01
					Set AN_KL.strSqlPopulate =
							"SELECT arc_AN_KL.ISP, arc_AN_KL.NLS, substr(arc_AN_KL.NMK,1,4)||' '|| substr(arc_AN_KL.NMK,5,2),
							        S_980/100, S_840/100, S_978/100, S_810/100,
							        C_EQV/100, Q_840/100, Q_978/100, Q_810/100,
							        K_980/100, K_840/100, K_978/100, K_810/100,
							        NNK      , NYK      , NMB      , OMB      ,
							        d1/100   , d2/100   , d3/100   , d4/100   ,
							        d5/100   , d6/100   , d7/100   , d8/100   ,
							        d9/100   , d10/100  , d11/100  , d12/100  ,
							        d13/100  , d14/100  , d15/100  , d16/100  ,
							        d17/100  , d18/100  , d19/100  , d20/100  ,
							        d21/100  , d22/100  , d23/100  , d24/100  ,
							        r1/100   , r2/100   , r3/100   , r4/100   ,
							        customer.RNKP, customer.RNK, customer.NMK , 
							        nvl(CUSTOMER.TOBO,'0'),to_char(CUSTOMER.ISP)
							 INTO :AN_KL.ISP ,  :AN_KL.NLS, :AN_KL.NMK,
							      :AN_KL.S_980, :AN_KL.S_840, :AN_KL.S_978, :AN_KL.S_810,
							      :AN_KL.C_EQV, :AN_KL.Q_840, :AN_KL.Q_978, :AN_KL.Q_810,
							      :AN_KL.K_980, :AN_KL.K_840, :AN_KL.K_978, :AN_KL.K_810,
							      :AN_KL.NNK  , :AN_KL.NYK  , :AN_KL.NMB  , :AN_KL.OMB  ,
							      :AN_KL.D01  , :AN_KL.D02  , :AN_KL.D03  , :AN_KL.D04  ,
							      :AN_KL.D05  , :AN_KL.D06  , :AN_KL.D07  , :AN_KL.D08  ,
							      :AN_KL.D09  , :AN_KL.D10  , :AN_KL.D11  , :AN_KL.D12  ,
							      :AN_KL.D13  , :AN_KL.D14  , :AN_KL.D15  , :AN_KL.D16  ,
							      :AN_KL.D17  , :AN_KL.D18  , :AN_KL.D19  , :AN_KL.D20  ,
							      :AN_KL.D21  , :AN_KL.D22  , :AN_KL.D23  , :AN_KL.D24  ,
							      :AN_KL.R01  , :AN_KL.R02  , :AN_KL.R03  , :AN_KL.R04  ,
							      :AN_KL.RNKP , :AN_KL.KLI  , :AN_KL.NMKD,
							      :AN_KL.TOBO,:AN_KL.MEN 
							 FROM arc_AN_KL, customer 
							 WHERE customer.RNK=arc_AN_KL.rnk AND
							       arc_AN_KL.nmk is not null " ||
							 IifS(pRNK=0, " ", " and arc_AN_KL.rnk=:AN_KL.pRNK " ) || 
							 IifS( sf ="","", " and "|| sf  ) || 
							 IifS( sf2="","", " and "|| sf2 ) || 
							" ORDER BY  nmk  "
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				If AN_KL.nMode = 117
					Call SalWaitCursor ( TRUE )
					Call SalSendClassMessage( UM_Populate, 0, 0)
					Call SalHideWindow( AN_KL.VIP )
					! Call SalHideWindow( AN_KL.RNKP )
					! Call SalHideWindow( AN_KL.KLI )
				Else
					Call SalHideWindow( AN_KL.NMKD )
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If TOBO != '0'
					If SqlPrepareAndExecute( hSqlAux2(),"select name into :sTOBO from tobo where tobo=:TOBO" )
							and SqlFetchNext( hSqlAux2(), nFetchRes)
						Set TOBO = TOBO ||' '|| sTOBO
				Else
					Set TOBO = 'Головной банк'
				If MEN != STRING_Null
					If SqlPrepareAndExecute( hSqlAux2(),"select fio into :sMEN from staff where id=:MEN" )
							and SqlFetchNext( hSqlAux2(), nFetchRes)
						Set MEN =  MEN  ||' '|| sMEN
				If AN_KL.nMode = 117 !! из архива
					Set sYYYYMM = Subs(AN_KL.NMK,1,4) || Subs(AN_KL.NMK,6,2)
					Set D360 = 360
					Set D30 = 30
					Set DatB_ = SalDateConstruct( Val(Subs(sYYYYMM,1,4)), Val(Subs(sYYYYMM,5,2)), 1, 0, 0, 0 )
					Set DatE_ = AddMonths( DatB_,1 ) - 1
					If SqlPrepareAndExecute( hSqlAux2(),
							"SELECT K1_980, K2_980, K3_980, K4_980, K5_980, K1_840, K2_840, K3_840, K4_840, K5_840,
							        K1_978, K2_978, K3_978, K4_978, K5_978, K1_810, K2_810, K3_810, K4_810, K5_810,
							        D360  , D30 
							 INTO  :K1_980,:K2_980,:K3_980,:K4_980,:K5_980,:K1_840,:K2_840,:K3_840,:K4_840,:K5_840,
							       :K1_978,:K2_978,:K3_978,:K4_978,:K5_978,:K1_810,:K2_810,:K3_810,:K4_810,:K5_810,
							       :D360  ,:D30 
							 FROM AN_KL_K  
							 WHERE YYYYMM = ( select max(YYYYMM) from AN_KL_K where YYYYMM<=:AN_KL.sYYYYMM )" ) and
							SqlFetchNext( hSqlAux2(), nFetchRes) 
					Set F01 = F_Form (sForm[ 1])
					Set F02 = F_Form (sForm[ 2])
					Set F03 = F_Form (sForm[ 3])
					Set F04 = F_Form (sForm[ 4])
					Set F05 = F_Form (sForm[ 5])
					Set F06 = F_Form (sForm[ 6])
					Set F07 = F_Form (sForm[ 7])
					Set F08 = F_Form (sForm[ 8])
					Set F09 = F_Form (sForm[ 9])
					Set F10 = F_Form (sForm[10])
				Else
					Set DatB_ = DAT1
					Set DatE_ = DAT2
				If SqlPrepareAndExecute( hSqlAux2(),
						  "SELECT Nvl(sum( gl.p_Icurval(a.kv,s.dos,s.fdat) ),0)/100 
						   INTO :Q_SN 
						   FROM saldoa s, accounts a, cust_acc u 
						   WHERE u.rnk=:KLI and u.acc=a.acc and a.nls like '20_8%' and a.acc=s.acc 
						     and s.fdat >=:DatB_ and s.fdat<=:DatE_" ) 
						and SqlFetchNext( hSqlAux2(), nFetchRes)
				!
				Call XSalTblSetCellBackColor( AN_KL.D01, AN_KL.nColD )
				Call XSalTblSetCellBackColor( AN_KL.D02, AN_KL.nColD )
				Call XSalTblSetCellBackColor( AN_KL.D03, AN_KL.nColD )
				Call XSalTblSetCellBackColor( AN_KL.D04, AN_KL.nColD )
				Call XSalTblSetCellBackColor( AN_KL.D05, AN_KL.nColD )
				Call XSalTblSetCellBackColor( AN_KL.D06, AN_KL.nColD )
				Call XSalTblSetCellBackColor( AN_KL.D07, AN_KL.nColD )
				Call XSalTblSetCellBackColor( AN_KL.D08, AN_KL.nColD )
				Call XSalTblSetCellBackColor( AN_KL.D09, AN_KL.nColD )
				Call XSalTblSetCellBackColor( AN_KL.D10, AN_KL.nColD )
				Call XSalTblSetCellBackColor( AN_KL.D11, AN_KL.nColD )
				Call XSalTblSetCellBackColor( AN_KL.D12, AN_KL.nColD )
				Call XSalTblSetCellBackColor( AN_KL.D13, AN_KL.nColD )
				Call XSalTblSetCellBackColor( AN_KL.D14, AN_KL.nColD )
				Call XSalTblSetCellBackColor( AN_KL.D15, AN_KL.nColD )
				Call XSalTblSetCellBackColor( AN_KL.D16, AN_KL.nColD )
				Call XSalTblSetCellBackColor( AN_KL.D17, AN_KL.nColD )
				Call XSalTblSetCellBackColor( AN_KL.D18, AN_KL.nColD )
				Call XSalTblSetCellBackColor( AN_KL.D19, AN_KL.nColD )
				Call XSalTblSetCellBackColor( AN_KL.D20, AN_KL.nColD )
				Call XSalTblSetCellBackColor( AN_KL.D21, AN_KL.nColD )
				Call XSalTblSetCellBackColor( AN_KL.D22, AN_KL.nColD )
				Call XSalTblSetCellBackColor( AN_KL.D23, AN_KL.nColD )
				Call XSalTblSetCellBackColor( AN_KL.D24, AN_KL.nColD )
				!
				Call XSalTblSetCellBackColor( AN_KL.R01, AN_KL.nColR )
				Call XSalTblSetCellBackColor( AN_KL.R02, AN_KL.nColR )
				Call XSalTblSetCellBackColor( AN_KL.R03, AN_KL.nColR )
				Call XSalTblSetCellBackColor( AN_KL.R04, AN_KL.nColR )
				!
				Call XSalTblSetCellBackColor( AN_KL.NNK, AN_KL.nCol )
				Call XSalTblSetCellBackColor( AN_KL.NYK, AN_KL.nCol )
				Call XSalTblSetCellBackColor( AN_KL.NMB, AN_KL.nCol )
				Call XSalTblSetCellBackColor( AN_KL.OMB, AN_KL.nCol )
				!
				Call XSalTblSetCellBackColor( AN_KL.S_980, AN_KL.nCol_980 )
				Call XSalTblSetCellBackColor( AN_KL.K_980, AN_KL.nCol_980 )
				Call XSalTblSetCellBackColor( AN_KL.S_840, AN_KL.nCol_840 )
				Call XSalTblSetCellBackColor( AN_KL.K_840, AN_KL.nCol_840 )
				Call XSalTblSetCellBackColor( AN_KL.Q_840, AN_KL.nCol_840 )
				Call XSalTblSetCellBackColor( AN_KL.S_978, AN_KL.nCol_978 )
				Call XSalTblSetCellBackColor( AN_KL.K_978, AN_KL.nCol_978 )
				Call XSalTblSetCellBackColor( AN_KL.Q_978, AN_KL.nCol_978 )
				Call XSalTblSetCellBackColor( AN_KL.K_810, AN_KL.nCol_810 )
				Call XSalTblSetCellBackColor( AN_KL.Q_810, AN_KL.nCol_810 )
				Call XSalTblSetCellBackColor( AN_KL.S_810, AN_KL.nCol_810 )
	Table Window: ANA
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Аналіз клієнтів банку (накопичення в архів)
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.313"
				Top:    0.135"
				Width:  6.967"
				Width Editable? Class Default
				Height: 6.655"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 29000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.429"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.617"
						Top:    0.036"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.083"
							Top:    0.048"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
				!
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.9"
						Top:    0.048"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.867"
						Top:    0.048"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.383"
						Top:    0.048"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Save.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
				Line
					Resource Id: 45952
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.833"
						Top:    0.048"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.417"
						Top:    0.048"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Виконати накопичення в архів за місяць введеної дати '
						On SAM_Click
							If SetQueryFilter( ANA.cF )
							Call F_PROC (1)
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.35"
						Top:    0.048"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 45953
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.317"
						Top:    0.048"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 45954
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: YYYY_MM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: РРРР ММ
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.95"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рік + 
						Місяць
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.117"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NBS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Бал
						рах
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.933"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOLK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кількість 
						клієнтів
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.95"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кількість 
						аналітичних
						 рахунків
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.167"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: YYYYMM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: YYYYMM
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.95"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			!
		Functions
			Function: F_PROC
				Description:
				Returns
				Parameters
					Number: nMode 
				Static Variables
				Local variables
					String: sFilt_
					String: sFrom_
					String: sName
					Number: nMM
				Actions
					Set sFilt_ = ""
					Set sFilt_ = cF.GetFilterWhereClause( FALSE )
					Set sFrom_ = ""
					Set sFrom_ = cF.GetFilterFromClause( FALSE )
					Set nMM = SalDateMonth( ANA.DAT1 )
					If SqlPrepareAndExecute( hSql(), "SELECT NAME_PLAIN INTO :sName FROM META_MONTH WHERE n=:nMM ")
							and SqlFetchNext( hSql(),  nFetchRes)
						Set sName = Str(SalDateYear( ANA.DAT1)) || ' '|| sName
					!
					If SalMessageBox(
							  "Виконати накопичення в архів за "|| sName ||"
							"|| IifS(sFilt_ = "", "БЕЗ фильтру ?", "з фільтром ? "||"
							"|| sFilt_ ),
							   "Підтвердіть, або відмовтесь", MB_IconQuestion | MB_YesNo) = IDYES 
						Call SalWaitCursor(TRUE)
						If sFilt_ != ""
							Call SalWaitCursor(TRUE)
							If SqlPrepareAndExecute( hSql(), T(
									"BEGIN 
									   delete from tmp_rnk;
									   insert into tmp_rnk(rnk) 
									   select distinct customer.rnk  
									   from customer "|| IifS( sFrom_="", "", ","||sFrom_ ) || 
									 " where "||sFilt_||";
									END;" ))
								Set sFilt_ = "+"
							Else
								Call SalWaitCursor(FALSE)
								Return FALSE
						Else
							Set sFilt_ = "-"
						!
						If SqlPLSQLCommand(hSql(),
								"BARS.AN2.an_kl_p (ANA.nID, ANA.DAT1, ANA.DAT1, 1, 99999999, STRING_Null, 0, 1, sFilt_ )" )
							Call SqlCommit( hSql() )
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 ) 
							Call SalWaitCursor(FALSE)
							Call MessageNoWait( 'Выполнение процедуры завершено!', 'an2.AN_KL_P', 30, 0 )
						Else
							Call SqlRollback(hSql())
							Call SalWaitCursor(FALSE)
							Call MessageNoWait( 'Ошибка при выполнении процедуры !', 'an2.AN_KL_P', 30, 1 )
							Return FALSE
					!
					Return TRUE
		Window Parameters
		Window Variables
			Number: nID
			String: sSql
			Number: nCol [13]
			!
		Message Actions
			On SAM_Create
				Set nCol[1]= SalColorFromRGB( 220,255,255 ) ! голубой
				Set nCol[2]= SalColorFromRGB( 255,255,220)  !  желтій
				Set nCol[3]= SalColorFromRGB( 230,245,240 ) ! бледнфиолет
				Set nCol[4]= SalColorFromRGB( 230,255,230 ) ! бледнозеленый
				Set nCol[5]= SalColorFromRGB( 250,250,250 ) ! серый
				Set nCol[6]= SalColorFromRGB( 255,240,255 )  ! розовій
				Set nCol[7]= nCol[1]
				Set nCol[8]= nCol[2]
				Set nCol[9]= nCol[3]
				Set nCol[10]=nCol[4]
				Set nCol[11]=nCol[5]
				Set nCol[12]=nCol[6]
				Set ANA.strFilterTblName ='CUSTOMER'
				Set ANA.fFilterAtStart = TRUE
				Set ANA.DAT1= GetBankDate() +1 - SalDateDay( GetBankDate())
				Set ANA.nID = GetUserId()
				Set ANA.sSql =
						"SELECT a.YYYY||a.MM,  a.yyyy||' '||a.mm, a.yyyy||' '||m.NAME_PLAIN, a.NBS,
						  count(*) KOLK, Sum(a.KOLS ) KOLS 
						 INTO :ANA.YYYYMM, :ANA.YYYY_MM, :ANA.NAME, :ANA.NBS, :ANA.KOLK, :ANA.KOLS
						 FROM META_MONTH m,
						     (SELECT RNK, substr(nmk,1,4) yyyy, 
						             substr(nmk,5,2) mm, 
						             substr(NLS,1,4) NBS, 
						             sum(kol) KOLS 
						      FROM arc_an_kl  
						      GROUP BY RNK, nmk,  substr(NLS,1,4)  ) a
						 WHERE m.n=to_number(a.mm) 
						 GROUP BY a.YYYY, a.MM, m.NAME_PLAIN, a.NBS 
						 ORDER BY a.yyyy desc, a.mm desc " 
				Set ANA.strSqlDelete = "DELETE from arc_an_kl WHERE nmk=:ANA.YYYYMM and substr(NLS,1,4)=:ANA.NBS " 
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Populate
				Call SalTblPopulate(hWndForm, hSql(), ANA.sSql, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				Call XSalTblSetRowBackColor( hWndForm, lParam,  nCol[Val(Subs(YYYY_MM,6,2)) ])
	Table Window: AN1
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Аналіз кредитових оборотів клієттів банку по місяцям
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.225"
				Top:    0.229"
				Width:  13.833"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.476"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.25"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 32219
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.733"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.983"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.217"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Кредитовые документы '
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.7"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 32220
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 32221
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   0.083"
							Top:    0.071"
							Width:  1.5"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'С даты')
				Data Field: DAT2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? Yes
					Display Settings
						Window Location and Size
							Left:   1.683"
							Top:    0.071"
							Width:  1.517"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'По дату')
				Data Field: dKLI
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.683"
							Top:    0.071"
							Width:  0.833"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рег.№ клиента в банке')
				Data Field: dNMK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.883"
							Top:    0.071"
							Width:  3.8"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Наименование клиента')
				Data Field: dOKPO
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.483"
							Top:    0.071"
							Width:  1.433"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'ОКПО клиента')
		Contents
			Column: YYYYMM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рік
						Міс
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.033"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: mDAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: C
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.033"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: mDAT2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: По
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.033"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рах
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Загал.КРЕДИТ
						ном
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.367"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CKOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Чист.КРЕДИТ
						ном
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.367"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KOSQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Загал.КРЕДИТ
						екв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.367"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CKOSQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Чист.КРЕДИТ
						екв
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.367"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.533"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: KLI
			String: NMK
			String: OKPO
		Window Variables
			String: sTmp
			Number: KQ1
			Number: CKQ1
			Number: nRow
			Number: n980
		Message Actions
			On SAM_Create
				Set AN1.strPrintFileName = 'AN1'
				Set AN1.nTabInstance= 1
				Set DAT2 = GetBankDate()
				Set DAT1 =  AddMonths( DAT2,-4)
				Set AN1.dKLI = AN1.KLI
				Set AN1.dNMK = AN1.NMK
				Set AN1.dOKPO = AN1.OKPO
				Set AN1.n980 = GetBaseVal()
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_CreateComplete
				Call SalWaitCursor(FALSE)
			On SAM_DoubleClick
				If SqlPLSQLCommand(hSql(),
						"BARS.AN2.PC_KOS ( AN1.dKLI, AN1.NLS, AN1.KV, AN1.ACC, AN1.mDAT1, AN1.mDAT2 ) " )
					Call SalWaitCursor(FALSE)
					Call SqlCommit( hSql() )
					! Call MessageNoWait( 'Выполнение процедуры завершено!', 'AN_KL_P', 30, 0 )
					If not IsWindow(hWin11)
						Set hWin11 = SalCreateWindow
								( AN2, hWndMDI, AN1.KLI, AN1.NMK, AN1.NLS, AN1.KV, AN1.mDAT1, AN1.mDAT2, AN1.OKPO )
					Else
						Call SalBringWindowToTop(AN2)
				Else
					Call SqlRollback(hSql())
					Call SalWaitCursor(FALSE)
					Call MessageNoWait( 'Ошибка при выполнении процедуры !', 'AN2.PC_KOS', 30, 1 )
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set AN1.strSqlPopulate =
						"SELECT a.acc, a.kv, a.nls, h.YYYYMM 
						 INTO  :AN1.ACC, :AN1.KV, :AN1.NLS, :AN1.YYYYMM 
						 FROM  accounts a, cust_acc u,
						       (select distinct to_char(fdat,'YYYY-MM') YYYYMM from fdat where fdat >=:DAT1 and fdat <=:DAT2 ) h 
						 WHERE u.rnk=:AN1.KLI and u.acc=a.acc and 
						   a.nls in (select nls from arc_an_kl where rnk=:AN1.KLI )
						 ORDER BY a.nls, a.kv, h.YYYYMM  "
				Set AN1.KQ1 = 0
				Set AN1.CKQ1 = 0
				Call SalTblPopulate(hWndForm, hSql(), AN1.strSqlPopulate, TBL_FillAll)
				!
				Call SalTblDefineSplitWindow(hWndForm, 1, TRUE)
				Set AN1.nRow = SalTblInsertRow( hWndForm, TBL_MinRow  )
				Call SalTblSetContext ( hWndForm, AN1.nRow )
				Call SalTblSetRowFlags( hWndForm, AN1.nRow, ROW_New, FALSE )
				Set AN1.KV =  AN1.n980
				Set AN1.KOSQ = AN1.KQ1
				Set AN1.CKOSQ = AN1.CKQ1
				!
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_FetchRowDone
				If SqlPrepareAndExecute( hSqlAux2(),
						   "SELECT substr(BARS.AN2.C_KOS(:AN1.dKLI,:AN1.NLS,:AN1.KV,:AN1.ACC,
						                                 min(fdat), max(fdat) 
						                  ),1,64), min(fdat), max(fdat) 
						    INTO :sTmp, :AN1.mDAT1, :AN1.mDAT2  
						    from saldoa 
						    where acc=:AN1.ACC and fdat>=:AN1.DAT1 and fdat<=:AN1.DAT2 and 
						          to_char(fdat, 'YYYY-MM')=:AN1.YYYYMM " )
						and SqlFetchNext(  hSqlAux2(), nFetchRes ) 
					Set AN1.KOS  = Val ( Subs( sTmp, 1,  16 ) ) / 100
					Set AN1.KOSQ = Val ( Subs( sTmp, 17, 16 ) ) / 100
					Set AN1.CKOS = Val ( Subs( sTmp, 33, 16 ) ) / 100
					Set AN1.CKOSQ= Val ( Subs( sTmp, 49, 16 ) ) / 100
					Set AN1.KQ1 = AN1.KQ1 + AN1.KOSQ
					Set AN1.CKQ1 = AN1.CKQ1 + AN1.CKOSQ
					If CKOSQ > 0 
						Call XSalTblSetCellBackColor( AN1.CKOS, COLOR_Sky )
						Call XSalTblSetCellBackColor( AN1.CKOSQ, COLOR_LightAqua )
	Table Window: AN2
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Кредитовые обороты
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.175"
				Top:    0.844"
				Width:  14.167"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 10000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.714"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.883"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.883"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 25339
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.383"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.883"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.383"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.883"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 25340
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.383"
						Top:    0.321"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 25341
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Data Field: dKLI
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.883"
							Top:    0.071"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рег.№ клиента в банке')
				Data Field: dOKPO
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.383"
							Top:    0.071"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'ОКПО клиента')
				Data Field: dNMK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   3.883"
							Top:    0.071"
							Width:  5.4"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Наименование клиента')
				Data Field: DAT1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.583"
							Top:    0.321"
							Width:  1.4"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'С даты')
				Data Field: DAT2
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   7.983"
							Top:    0.321"
							Width:  1.3"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'По дату')
				Data Field: dNLS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   3.883"
							Top:    0.321"
							Width:  2.0"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Выбранный счет')
				Data Field: dKV
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.883"
							Top:    0.321"
							Width:  0.7"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Выбранная вал')
		Contents
			Column: PR
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Чист
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  0.483"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						If PR
							Set AN1.CKOS =  AN1.CKOS + AN2.S
							Set AN1.CKOSQ =  AN1.CKOSQ + AN2.SQ
						Else
							Set AN1.CKOS =  AN1.CKOS - AN2.S
							Set AN1.CKOSQ =  AN1.CKOSQ - AN2.SQ
			Column: DD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: День
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.567"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.983"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SQ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма экв 
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  Default
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: MFOB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МФО-кор
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.117"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OKPOB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ОКПО-кор
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.117"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сч-кор
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.267"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KVD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.617"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAZN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Подробности пл
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  4.883"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: KLI
			String: NMK
			String: NLS
			Number: KV
			Date/Time: mDAT1
			Date/Time: mDAT2
			String: OKPO
		Window Variables
			String: sFilter
		Message Actions
			On SAM_Create
				Set AN2.strPrintFileName = 'AN2'
				Set AN2.strFilterTblName ='KRED_OBO'
				Set AN2.nTabInstance= 1
				Set AN2.dKLI = AN2.KLI
				Set AN2.dNMK = AN2.NMK
				Set AN2.dNLS = AN2.NLS
				Set AN2.dKV  = AN2.KV
				Set AN2.DAT1 = AN2.mDAT1
				Set AN2.DAT2 = AN2.mDAT2
				Set AN2.dOKPO = AN2.OKPO
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_DoubleClick
				If AN2.REF > 0
					Call DocViewContentsEx ( hWndForm, AN2.REF )
			On SAM_FetchRowDone
				! Чистій кредит
				If AN2.PR =1 
					Call XSalTblSetCellBackColor( AN2.S, COLOR_Sky )
					Call XSalTblSetCellBackColor( AN2.SQ, COLOR_LightAqua )
			On UM_Close
				Call SalDestroyWindow(hWndForm)
			On UM_Populate
				Call SalWaitCursor(TRUE)
				Set sFilter = ""
				Set sFilter = cF.GetFilterWhereClause( FALSE )
				Set AN2.strSqlPopulate =
						"SELECT REF, PR, KV, N1, N2/100, NAZN, MFOB, NLSD, OKPOB, SQ/100
						 INTO  :AN2.REF,:AN2.PR,:AN2.KVD,:AN2.DD,:AN2.S,:AN2.NAZN,:AN2.MFOB,:AN2.NLSD, 
						       :AN2.OKPOB,:AN2.SQ
						 FROM (SELECT PR REF, 
						        decode(PRS,:AN2.dKLI,0,1) PR, 
						        KV, N1, N2, NAME||CC_ID NAZN,
						        ACCL MFOB, ACC NLSD, N5 OKPOB,
						        gl.p_Icurval( :AN2.KV, N2, 
						          to_date(substr(to_char(100+n1),2,2)||to_char(:AN2.mDAT2,'mmyyyy'),'ddmmyyyy')) SQ 
						 FROM  CCK_AN_TMP ) KRED_OBO "||
						 IifS (sFilter = "", ""," WHERE "||sFilter ) || " 
						 ORDER BY REF "
				Call SalTblPopulate(hWndForm, hSql(), AN2.strSqlPopulate, TBL_FillAll)
				Call SalTblSetContext(hWndForm, 0)
				Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
				Call SalWaitCursor(FALSE)
	Dialog Box: dlg_CreateDoc
		Class:
		Property Template:
		Class DLL Name:
		Title: Новый документ
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  8.429"
				Width Editable? Yes
				Height: 4.385"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: Номер дополнительного соглашения:
				Resource Id: 22564
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.286"
					Top:    0.177"
					Width:  3.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			List Box: lbAdd
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenListBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   4.1"
					Top:    0.146"
					Width:  1.186"
					Width Editable? Class Default
					Height: 0.229"
					Height Editable? Class Default
				Visible? Class Default
				Multiple selection? Class Default
				Sorted? Yes
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Horizontal Scroll? Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call SalListPopulate( lbAdd, hSql(), "
								SELECT
								adds
								FROM
								cc_add
								WHERE
								nd = :nND ")
			Child Table: tblTemplates
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.186"
						Top:    0.74"
						Width:  8.0"
						Width Editable? Yes
						Height: 2.667"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: Default
					Discardable? Yes
				Contents
					Column: colId
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Идентификатор
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  1.771"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Наименование
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  5.614"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						If SalTblPopulate( dlg_CreateDoc.tblTemplates, hSql(),
								"SELECT r.id,s.name 
								 INTO :dlg_CreateDoc.tblTemplates.colId,:dlg_CreateDoc.tblTemplates.colName
								 FROM doc_root r, doc_scheme s
								 WHERE  r.vidd =:nVidd AND s.id = r.id ", TBL_FillAll )
						If SalTblAnyRows( tblTemplates, 0, 0 ) != TRUE
							Call SalMessageBox( 'Для договора не указаны шаблоны!', 'Ошибка', MB_IconStop | MB_Ok  )
							Call SalEndDialog( dlg_CreateDoc, 0 )
						Else
							Call SalTblSetContext( tblTemplates, TBL_MinRow )
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbOk
				Property Template:
				Class DLL Name:
				Title: Создать
				Window Location and Size
					Left:   5.686"
					Top:    3.573"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call XConnectGetParams( cCnc )
						If cCnc.Connect() and cCnc2.Clone( cCnc, TRUE )
							Set sDoc=cdoc_CreateDocFromTemplate( cCnc.hSql(), cCnc2.hSql(), tblTemplates.colId,  nND,lbAdd.GetCurrentKey())
							If sDoc
								! Показываем документ с редактированием
								If cdoc_ShowDoc( sDoc, TRUE, FALSE )!=3
									! Сохраняем документ в БД
									If NOT cdoc_SetDocText(hSql(), TRUE,
											  tblTemplates.colId, nND, 0, DATETIME_Null, sDoc)
										Call SqlRollback(hSql())
									Else
										Call SqlCommitEx(hSql(), 'Текст договора № ' || SalNumberToStrX(nND,0) || ', дополнительное соглашение:' || SalNumberToStrX(lbAdd.GetCurrentKey(),0) || ' сохранен в БД!')
									! If SqlPrepare( hSql(), 'INSERT INTO CC_DOCS (id,nd,text,adds)
											 VALUES (:tblTemplates.colId,:nND,:sDoc,0)' )
										                                                                                             If SqlSetLongBindDatatype( 3, 23 )
											                                                                                             If SqlExecute( hSql() )
												                                                                                             Call SqlCommitEx( hSql(), 'Текст договора № ' || SalNumberToStrX(nND,0) || ', дополнительное соглашение:'||SalNumberToStrX( lbAdd.GetCurrentKey(),0)|| ' сохранен в БД!' )
												! Return 1
							Call cCnc.Disconnect()
							Call cCnc2.Disconnect()
						Call SalEndDialog( dlg_CreateDoc, 0 )
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   7.086"
					Top:    3.573"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( dlg_CreateDoc, 0 )
			Group Box: Выбор шаблона
				Resource Id: 22565
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.086"
					Top:    0.49"
					Width:  8.2"
					Width Editable? Yes
					Height: 3.0"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
		Functions
		Window Parameters
			Number: nND
			Number: nVidd
		Window Variables
			: cCnc
				Class: cABSConnect
			: cCnc2
				Class: cABSConnect
			Long String: sDoc
		Message Actions
			On SAM_Create
				Call SalSetWindowText( hWndForm, 'Новый документ к договору №'||
						                      SalNumberToStrX( nND, 0 ) )
				Call SalCenterWindow( hWndForm )
	Form Window: FX
		Class:
		Property Template:
		Class DLL Name:
		Title: FOREX : Головной банк и филиал 
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.913"
				Top:    1.146"
				Width:  12.65"
				Width Editable? Yes
				Height: 5.905"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Radio Button: rbK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Покупка 
				Window Location and Size
					Left:   0.283"
					Top:    0.31"
					Width:  2.733"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 12
				Font Enhancement: Bold
				Text Color: Red
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalSendMsg( cmb_MF2, SAM_Click, 0, 0 )
			Radio Button: rbP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Продажа
				Window Location and Size
					Left:   5.983"
					Top:    0.321"
					Width:  2.267"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 12
				Font Enhancement: Bold
				Text Color: Blue
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalSendMsg( cmb_MF2, SAM_Click, 0, 0 )
			Check Box: cbKom
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Использовать осн.счета дох/расх для комиссии
				Window Location and Size
					Left:   0.283"
					Top:    0.571"
					Width:  5.4"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Jade
				Background Color: Default
				Message Actions
					On SAM_Click
						If cbKom 
							! Стандартніе
							Call SalDisableWindow( s7_1 )
							Call SalDisableWindow( s6_2 )
							Call SalSendMsg( cmb_MF2, SAM_Click, 0, 0 )
						Else
							Call SalEnableWindow( s7_1 )
							Call SalEnableWindow( s6_2 )
			Combo Box: cmb_KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.3"
					Top:    1.298"
					Width:  2.983"
					Width Editable? Yes
					Height: 2.429"
					Height Editable? Yes
				Visible? Yes
				Editable? Yes
				String Type: String
				Maximum Data Length: Default
				Sorted? No
				Always Show List? No
				Vertical Scroll? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Input Mask: Unformatted
				List Initialization
				Message Actions
					On SAM_Create
						Call SalWaitCursor( TRUE )
						If SqlPrepareAndExecute( hSql(), 
								  "SELECT substr(to_char(1000+t.kv),2,3) || ' ' || NAME ,
								    t.kv, t.lcv || '  '|| c.bsum||' / '||c.rate_o 
								   INTO :sTmp, :nTmp, :sTmp1  FROM tabval t, CUR_RATES c
								 WHERE t.kv in (840,978,643,826) and t.kv=c.kv and (c.kv,vdate)=
								(select kv,max(vdate) from cur_rates where kv=c.kv and vdate<=:bDat group by kv)
								 order by kv desc " )
							While SqlFetchNext( hSql(), nFetchRes )
								Call SalListAdd( cmb_KV, sTmp )
								If nTmp=840
									Set d840=sTmp1
								Else If nTmp=978
									Set d978=sTmp1
								Else If nTmp=643
									Set d643=sTmp1
								Else If nTmp=826
									Set d826=sTmp1
							Call SalListSetSelect( cmb_KV, 1 )
							Call SalSendMsg( cmb_KV, SAM_Click, 0, 0 )
						Call SalWaitCursor( FALSE )
					On SAM_Click
						Set KV = Val(Subs(cmb_KV,1,3))
						Call F_MVPS()
						! If KV = 840 
							                                                                                                             Set hTmp = d840
						! Else If KV = 978
							                                                                                                             Set hTmp = d978
						! Else If KV = 643
							                                                                                                             Set hTmp = d643
						! Else If KV = 826
							                                                                                                             Set hTmp = d826
						! Call F_MIGALKA( hTmp )
			Data Field: SV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.283"
						Top:    1.286"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сумма ИНвалюты')
					On SAM_Validate
						If SV = NUMBER_Null
							Set SN = NUMBER_Null
							Return TRUE
						If SV < 0
							Return FALSE
						Set nTmp= SV * 100
						If SqlPrepareAndExecute( hSql(), 
								"SELECT gl.p_icurval(:KV, :nTmp, :bDat )/100 INTO :SN  from dual" ) 
								and SqlFetchNext( hSql(), nFetchRes )
						Set ml1=SumPr( SN*100, 'F', 'грн' , "коп" )
						If SN > 0 and SV > 0
							Set dKurs = SalNumberToStrX( SN/SV, 4)
					! On SAM_KillFocus
			Data Field: SN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.283"
						Top:    1.821"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сумма НАЦвалюты')
					On SAM_KillFocus
						Set ml1=SumPr( SN*100, 'F', 'грн' , "коп" )
						If SN > 0 and SV > 0
							Set dKurs = SalNumberToStrX( SN/SV, 4)
			Data Field: dKurs
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.683"
						Top:    1.821"
						Width:  1.6"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Курс сделки')
			Data Field: SK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.283"
						Top:    2.321"
						Width:  2.2"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Комиссия в НАЦвалюте')
			!
			Data Field: POKUPATEL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    2.655"
						Width:  3.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Покупатель')
			Data Field: OKPO1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.983"
						Top:    2.905"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'ОКПО Покупателя')
			Data Field: MF1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    2.905"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'MФO Покупателя')
			Data Field: s35_1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.683"
						Top:    2.655"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сч.Дебитор у Покупателя')
			Data Field: s36_1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.683"
						Top:    2.905"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сч.Кредитор у Покупателя')
			Data Field: s6_1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.683"
						Top:    3.155"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сч.Доходов у Покупателя')
			Data Field: s7_1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.683"
						Top:    3.405"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сч.Расходов у Покупателя')
			!
			Data Field: PRODAVEC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.883"
						Top:    2.655"
						Width:  3.4"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Продавец')
			Data Field: OKPO2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   9.583"
						Top:    2.905"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'ОКПО Продавца')
			Data Field: MF2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   7.883"
						Top:    2.905"
						Width:  1.7"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'MФO Продавца')
			Data Field: s35_2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.783"
						Top:    2.655"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сч.Дебитор у Продавца')
			Data Field: s36_2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.783"
						Top:    2.905"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сч.Кредитор у Продавца')
			Data Field: s6_2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.783"
						Top:    3.155"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сч.Доходов у Продавца')
			Data Field: s7_2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.783"
						Top:    3.405"
						Width:  2.1"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Сч.Расходов у Продавца')
			!
			Combo Box: cmb_MF2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   6.567"
					Top:    1.536"
					Width:  4.85"
					Width Editable? Yes
					Height: 3.821"
					Height Editable? Yes
				Visible? Yes
				Editable? Yes
				String Type: String
				Maximum Data Length: Default
				Sorted? No
				Always Show List? No
				Vertical Scroll? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Input Mask: Unformatted
				List Initialization
				Message Actions
					On SAM_Create
						Call SalWaitCursor( TRUE )
						If SqlPrepareAndExecute( hSql(), 
								  "SELECT f.mfo||' '||b.NB FROM banks b, forex_fil f 
								   WHERE b.mfo=f.mfo and f.mfo<>:aMFO
								   INTO :sTmp order by f.mfo " )
							While SqlFetchNext( hSql(), nFetchRes )
								Call SalListAdd( cmb_MF2, sTmp )
							Call SalListSetSelect( cmb_MF2, 0 )
							Call SalSendMsg( cmb_MF2, SAM_Click, 0, 0 )
						Call SalWaitCursor( FALSE )
					On SAM_Click
						If rbK
							Set MF1 =aMFO
							Set OKPO1 = GetBankOkpoS( )
							Set POKUPATEL= GetBankName()
							Set MF2 = Subs(cmb_MF2,1,6) 
							Set PRODAVEC = Subs(cmb_MF2,7,38) 
							Call SalShowWindow( cbKom )
							Call SalShowWindow( SK )
							Call SalShowWindow( df5 )
						Else
							Set MF1 = Subs(cmb_MF2,1,6) 
							Set POKUPATEL = Subs(cmb_MF2,7,38) 
							Set MF2 =aMFO
							Set OKPO2 = GetBankOkpoS( )
							Set PRODAVEC = GetBankName()
							Call SalHideWindow( cbKom )
							Call SalHideWindow( SK )
							Call SalHideWindow( df5 )
						Call SalHideWindow( pb_Print )
						!
						If SqlPrepareAndExecute( hSql(), 
								  "SELECT f1.s35, f1.s36, f1.s61, decode(:MF1,300120,decode(f7.s7,null,f1.s71,f7.s7),f1.s71), f2.s35, f2.s36, f2.s61, f2.s71
								   INTO :s35_1, :s36_1, :s6_1, :s7_1, :s35_2, :s36_2, :s6_2, :s7_2
								   FROM forex_fil f1, forex_fil f2, forex_fil_7 f7 
								   WHERE f1.mfo=:MF1 and f2.mfo=:MF2 and f7.mfo(+)=f2.mfo" )
								and not SqlFetchNext( hSql(), nFetchRes ) 
							Call SalMessageBox(
									'счета для '|| MF1 ||' или для '||MF2,
									'Ошибка в настройках !',
									MB_IconStop)
						! Set bMVPS = TRUE
						Call F_MVPS()
						If SqlPrepareAndExecute( hSql(), 
								"select c.okpo into  :OKPO" || IifS(rbK,"2","1") ||" from customer c, custbank b 
								 where c.rnk=b.rnk and b.mfo=:MF" || IifS(rbK,"2","1") ) 
								and not SqlFetchNext( hSql(), nFetchRes )
							Call SalMessageBox(
									'ОКПО для '|| MF1 ||' или для '||MF2,
									'Ошибка в настройках !',
									 MB_IconStop)
			Pushbutton: pb_Run
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbExecute
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   8.917"
					Top:    1.988"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Выполнить'
					On SAM_Click
						Call SalWaitCursor(TRUE)
						Call SalDisableWindow( pb_Run )
						If SV > 0 and SN > 0
							!
							If F_OPL()
								Call SqlCommitEx( hSql(),'МежФил ФОРЕКС' )
								Call SalDisableWindow( pb_Run )
								Call SalDisableWindow( rbK )
								Call SalDisableWindow( rbP )
								Call SalDisableWindow( cbKom )
								Call SalDisableWindow( cmb_KV )
								Call SalDisableWindow( SV )
								Call SalDisableWindow( SN )
								Call SalDisableWindow( SK )
								Call SalDisableWindow( cmb_MF2 )
								Call SalDisableWindow( s7_1 )
								Call SalDisableWindow( s6_2 )
								!
								Call SalShowWindow( pb_Print )
								Call SalSendMsg( pb_Print, SAM_Click, 0, 0 )
							Else
								Call SqlRollback( hSql() )
								Call SalEnableWindow( pb_Run )
			Pushbutton: pb_Print
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbPrint
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   9.917"
					Top:    1.988"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Печать документов'
					On SAM_Click
						If nRef1 != NUMBER_Null
							Call DocsPrint(nRef1, 'OPER',0)
						If nRef2 != NUMBER_Null
							Call DocsPrint(nRef2, 'OPER',0)
						If nRef3 != NUMBER_Null
							Call DocsPrint(nRef3, 'OPER',0)
			Pushbutton: pb_Clear
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbRefresh
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   9.417"
					Top:    1.988"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Очистить данные'
					On SAM_Click
						Set SV=0
						Set SN=0
						Set SK=0
						Set dKurs = STRING_Null
						Set ml1 = STRING_Null
						Call SalHideWindow( pb_Print )
						Call SalEnableWindow( pb_Run )
						Call SalEnableWindow( rbK )
						Call SalEnableWindow( rbP )
						Call SalEnableWindow( cbKom )
						Call SalEnableWindow( cmb_KV )
						Call SalEnableWindow( SV )
						Call SalEnableWindow( SN )
						Call SalEnableWindow( SK )
						Call SalEnableWindow( cmb_MF2 )
						Call SalSendMsg( cmb_MF2, SAM_Click, 0, 0 )
			Pushbutton: pb_Exit
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbExecute
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   10.917"
					Top:    1.988"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \bars98\RESOURCE\BMP\Discard.bmp
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Завершить'
					On SAM_Click
						Call SalDestroyWindow(hWndForm)
			Data Field: aNAME
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   6.567"
						Top:    1.286"
						Width:  4.85"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Group Box: Установка покупки валюты
				Resource Id: 44660
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    0.071"
					Width:  5.7"
					Width Editable? Yes
					Height: 0.833"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 8
				Font Enhancement: Default
				Text Color: Dark Gray
				Background Color: Default
			Group Box: Установка продажи валюты
				Resource Id: 44661
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.783"
					Top:    0.071"
					Width:  5.7"
					Width Editable? Yes
					Height: 0.833"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Gray
				Background Color: Default
			Group Box: Параметры сделки
				Resource Id: 44662
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.083"
					Top:    0.905"
					Width:  11.4"
					Width Editable? Yes
					Height: 3.75"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Dark Gray
				Background Color: Default
			Background Text: Валюта сделки
				Resource Id: 55639
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.283"
					Top:    1.095"
					Width:  1.5"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Jade
				Background Color: Default
			Background Text: Сумма
				Resource Id: 55642
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.283"
					Top:    3.869"
					Width:  0.7"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Jade
				Background Color: Default
			Background Text: Сумма сделки вал
				Resource Id: 55640
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.183"
					Top:    1.095"
					Width:  2.3"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Jade
				Background Color: Default
			Background Text: Сумма сделки грн
				Resource Id: 55641
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   3.183"
					Top:    1.607"
					Width:  2.3"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Jade
				Background Color: Default
			Background Text: Банки-участники
				Resource Id: 55637
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   9.883"
					Top:    1.095"
					Width:  1.5"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Jade
				Background Color: Default
			Data Field: df5
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.283"
						Top:    2.096"
						Width:  2.3"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Jade
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
					On SAM_Create
						Set df5 = 'Сумма комиссии грн'
			Multiline Field: ml1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					String Type: String
					Editable? No
				Display Settings
					Border? Yes
					Word Wrap? Yes
					Vertical Scroll? No
					Window Location and Size
						Left:   0.283"
						Top:    3.738"
						Width:  11.1"
						Width Editable? Yes
						Height: 0.75"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: 3D Face Color
				Message Actions
			!
			Check Box: bMVPS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МВПС
				Window Location and Size
					Left:   5.583"
					Top:    1.321"
					Width:  0.9"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			!
			Data Field: d840
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.317"
						Top:    4.702"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Black
					Background Color: Light Green
					Input Mask: Unformatted
				Message Actions
			Data Field: d978
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.117"
						Top:    4.702"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Black
					Background Color: Sky
					Input Mask: Unformatted
				Message Actions
			Data Field: d643
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   5.917"
						Top:    4.702"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Black
					Background Color: Maize
					Input Mask: Unformatted
				Message Actions
			Data Field: d826
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   8.717"
						Top:    4.702"
						Width:  2.7"
						Width Editable? Yes
						Height: 0.333"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Default
					Background Color: Light Gray
					Input Mask: Unformatted
				Message Actions
		Functions
			Function: F_OPL
				Description:
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: sNazn
				Actions
					Set nRef1 = NUMBER_Null
					Set nRef2 = NUMBER_Null
					Set nRef3 = NUMBER_Null
					! найти 3900 или 3901 счет
					If NOT bMVPS
						Call F_390()
					!
					If rbK 
						! 3 Отправить грн комиссию
						If SK > 0 
							If cbKom
								Call cDoc.SetDoc(nRef3, FX1, 1, 6, Str(nRef3),
										     bDat, bDat, bDat, bDat,
										     s7_1, POKUPATEL,MF1, '', n980, SK*100, OKPO1,
										     s6_2, PRODAVEC, MF2, '', n980, SK*100, OKPO2,
										     "Комiсiя за перерозподiл валютної позицiї "||Str(KV)||", за курсом "||
										     SalNumberToStrX(SN/SV,6)||", суми "||SalNumberToStrX(SV, 2),
										     '', GetIdOper(), '', NUMBER_Null, 0) 
								If NOT cDoc.oDoc() 
									Return FALSE
								Set nRef3 = cDoc.m_nRef
						! 1 Отправить грн за покупаемую вал
						! 1 Отправить грн за покупаемую вал
						! Call Debug(OKPO1)
						! Call Debug(OKPO2)
						Call cDoc.SetDoc(nRef1, FX1, 1, 6, Str(nRef1),
								     bDat, bDat, bDat, bDat,
								     s35_1, POKUPATEL,MF1, '', n980, SN*100, OKPO1,
								     s36_2, PRODAVEC, MF2, '', n980, SN*100, OKPO2,
								     "Перерахування грн при перерозподiлi iноз.валюти "||SalNumberToStrX(SV, 2)||"("||Str(KV)||")"
								     ||", за курсом "||SalNumberToStrX(SN/SV,6),'', GetIdOper(), '', NUMBER_Null, 0)
						If NOT cDoc.oDoc() 
							Return FALSE
						Set nRef1 = cDoc.m_nRef
						! 2 Провести через ВАЛ ПОЗ
						Call cDoc.SetDoc(nRef2, FX2, 1, 16, Str(nRef2),
								     bDat, bDat, bDat, bDat,
								     s36_1, POKUPATEL, MF1, '', KV  , SV*100, OKPO1 ,
								     s35_1, POKUPATEL, MF1, '', n980, SN*100, OKPO1,
								     "Перерозподiл валютної позицiї "||Str(KV)||", за курсом "||SalNumberToStrX(SN/SV,6)
								     ||", суми "||SalNumberToStrX(SV, 2),'', GetIdOper(), '', NUMBER_Null, 0)
						! Было пожелание вставлять доп.рекв. для 39-го файла - потом убрали
						! If cDoc.oDoc() 
								and SqlPrepareAndExecute( hSql(),
								   "Insert into operW (ref,tag,value) values (:cDoc.m_nRef,'D#39','112' )" )
								and SqlPrepareAndExecute( hSql(),
								   "Insert into operW (ref,tag,value) values (:cDoc.m_nRef,'KURS',:dKurs )" )
						! Else
							                                                                                                            Return FALSE
						If NOT cDoc.oDoc()
							Return FALSE
						Set nRef2 = cDoc.m_nRef
						! 2` доч к 2 - при отсутствии МВ ВПС 
						If NOT bMVPS
							If NOT cDoc.PayV(0,nRef2,bDat,FX2, 1, KV, s39, SV*100, KV, s36_1, SV*100 )
								Return FALSE
					Else If rbP 
						! 1 Отправить  вал
						Set sNazn = "Перерахування перерозподiленої iноз.валюти "||SalNumberToStrX(SV, 2)||"("||Str(KV)||")"
								     ||", за курсом "||SalNumberToStrX(SN/SV,6)
						If bMVPS
							Call cDoc.SetDoc(nRef1, FX1, 1, IifN(KV=980,6,19), Str(nRef1),
									     bDat, bDat, bDat, bDat,
									     s35_2, PRODAVEC, MF2, '', KV, SV*100, OKPO2,
									     s36_1, POKUPATEL,MF1, '', KV, SV*100, OKPO1,
									     sNazn,'', GetIdOper(), '', NUMBER_Null, 0)
						Else
							Call cDoc.SetDoc(nRef1, FX2, 1, 6, Str(nRef1),
									     bDat, bDat, bDat, bDat,
									     s35_2, PRODAVEC, MF2, '', KV, SV*100, OKPO2,
									     s39,   POKUPATEL,MF2, '', KV, SV*100, OKPO1,
									     sNazn,'', GetIdOper(), '', NUMBER_Null, 0)
						! Было пожелание вставлять доп.рекв. для 39-го файла - потом убрали
						! If cDoc.oDoc() 
								and SqlPrepareAndExecute( hSql(),
								   "Insert into operW (ref,tag,value) values (:cDoc.m_nRef,'D#39','122' )" )
								and SqlPrepareAndExecute( hSql(),
								   "Insert into operW (ref,tag,value) values (:cDoc.m_nRef,'KURS',:dKurs )" )
						! Else
							                                                                                                            Return FALSE
						If NOT cDoc.oDoc()
							Return FALSE
						Set nRef1 = cDoc.m_nRef
						! 2 Провести через ВАЛ ПОЗ
						If bMVPS
							Call cDoc.SetDoc(nRef2, FX2, 1, 16, Str(nRef2),
									     bDat, bDat, bDat, bDat,
									     s36_2, PRODAVEC, MF2, '', n980,SN*100, OKPO2,
									     s35_2, PRODAVEC, MF2, '', KV,  SV*100, OKPO2,
									     "Перерозподiл валютної позицiї "||Str(KV)||", за курсом "||SalNumberToStrX(SN/SV,6)
									     ||", суми "||SalNumberToStrX(SV, 2),'', GetIdOper(), '', NUMBER_Null, 0)
							If NOT cDoc.oDoc() 
								Return FALSE
							Set nRef2 = cDoc.m_nRef
						Else
							If NOT cDoc.PayV(0,nRef1,bDat,FX2, 1, n980, s36_2, SN*100, KV, s35_2, SV*100 )
								Return FALSE
					!
					Return TRUE
			Function: F_390
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set s39 = ''
					If SqlPrepareAndExecute( hSql(), 
							"SELECT nls into :s39 from accounts where nbs='3900' and kv=:KV and dazs is null ") 
							and not SqlFetchNext( hSql(), nFetchRes )   
						If SqlPrepareAndExecute( hSql(), 
								"SELECT  a.nls into :s39 from accounts a, cust_acc u, custbank b 
								 where a.nbs='3901' and a.kv=:KV and a.dazs is null and a.acc=u.acc and u.rnk=b.rnk 
								   and b.mfo=decode(:aMFO,:MF1, :MF2, :MF1) ") 
								and not SqlFetchNext( hSql(), nFetchRes )   
							Call SalMessageBox(
									'390* счет '|| MF1 ||' или для '||MF2,
									'Не найден счет !',
									 MB_IconStop)
							Return FALSE
					Return TRUE
			Function: F_MVPS
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					If SqlPrepareAndExecute(hSql(),
							"SELECT PUL.MVPS_FIL(:MF"||IifS(rbK,"2","1")||",:KV) into :bMVPS from dual")
							and SqlFetchNext(hSql (), nTmp)
			! Function: F_MIGALKA
				                                                                                                             Description: 
				                                                                                                             Returns 
				                                                                                                             Parameters 
					                                                                                                             Window Handle: hTmp
				                                                                                                             Static Variables 
				                                                                                                             Local variables 
				                                                                                                             Actions 
					! Set nCol1 = SalColorFromRGB( 255,210,210 ) ! СЛАБО-КРАСНЫЙ
					! Call SalColorSet( hTmp, COLOR_IndexWindow, SalColorFromRGB( 255,210,210 ))
		Window Parameters
			Number: nPar
			String: FX1 !! МБ - грн
			String: FX2 !! Вн Мультивал
		Window Variables
			Number: n980
			Number: KV
			Number: nTmp
			Number: nRef1
			Number: nRef2
			Number: nRef3
			String: sTmp
			String: sTmp1
			Window Handle: hTmp
			! String: MF2
			String: OKPOB
			Date/Time: bDat
			! Boolean: FL
			!
			: cDoc
				Class: cDoc
			String: aMFO
			String: s39
			!
		Message Actions
			On SAM_Create
				Set n980 = GetBaseVal()
				Call SalDisableWindow( bMVPS )
				Set aMFO = GetBankMfo()
				Set MF1 = aMFO
				Set aNAME = aMFO || ' '|| GetBankName()
				Set bDat = GetBankDate()
				Set rbK  = TRUE
				Set cbKom = TRUE
	Table Window: PK
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Пополнение карточных счетов
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.825"
				Top:    0.688"
				Width:  15.55"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 5000
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.452"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.083"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Yes
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Исключить из файла-пополнения '
						! On SAM_Click
							                                                                                                                           If Val(REF) >0 
								                                                                                                                           If SqlPrepareAndExecute( hSql(), "insert into operw (ref,tag,value) values (:REF,'PK_F ','NOT_FILE')")
										and SqlPrepareAndExecute(hSql(),"DELETE FROM pk_ref where ref=:REF")
										and SqlCommitEx( hSql(),"ПК: Вилучено реф="|| REF )
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.017"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.55"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 20296
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.483"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.95"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.417"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Документ '
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.883"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 20297
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.367"
						Top:    0.06"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 20298
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				!
				Pushbutton: pb_DBF
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Doc_in.bmp
					Picture Transparent Color: Cyan
					Image Style: Class Default
					Text Color: Sky
					Background Color: Cyan
					Message Actions
						On SAM_Create
							Set strTip = 'Сформировать файл-пополнения 
									(ВЫДЕЛЕННЫЕ из таблицы)'
						On SAM_Click
							Call F_FILE( ROW_Selected )
				Pushbutton: pb_DBF_All
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\UNDO1.BMP
					Picture Transparent Color: Cyan
					Image Style: Class Default
					Text Color: Sky
					Background Color: Cyan
					Message Actions
						On SAM_Create
							Set strTip = 'Сформировать файл-пополнения 
									(ВСЕ из таблицы)'
						On SAM_Click
							Call F_FILE(0)
				Pushbutton: pb_UDBF
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   6.183"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Unform.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'РАСформировать файл-пополнения '
						On SAM_Click
							Call SalWaitCursor( TRUE )
							Call SalListClear( cmb_FA )
							If SqlPrepareAndExecute( hSql(), 
									  "SELECT fn INTO :sTmp FROM ZAG_PK WHERE fn like :PK.sMask order by fn desc " )
								While SqlFetchNext( hSql(), nFetchRes )
									Call SalShowWindow( cmb_FA )
									Call SalListAdd( cmb_FA, sTmp )
								Call SalListSetSelect( cmb_FA, 1 )
							Call SalWaitCursor( FALSE )
				Combo Box: cmb_FA
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   6.683"
						Top:    0.155"
						Width:  2.567"
						Width Editable? Yes
						Height: 3.821"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: Default
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Click
							If MessageQuestion('Расформировать файл-пополнений: ' || cmb_FA || ' ?') != IDNO
								If SqlPrepareAndExecute( hSql(), "INSERT into BARS.PK_REF(ref) select ref from operw  where tag='PK_F ' and value= :cmb_FA " )
										and SqlPrepareAndExecute( hSql(),"DELETE from operw  where tag='PK_F ' and value= :cmb_FA " ) 
										and SqlPrepareAndExecute( hSql(),"SELECT ref into :nRefZ from zag_PK where FN = :cmb_FA ") 
										and SqlFetchNext( hSql(), nFetchRes )
										and SqlPrepareAndExecute( hSql(),"DELETE from zag_PK where FN = :cmb_FA " ) 
										and ( nRefZ =NUMBER_Null OR 
										      SqlPLSQLCommand( hSql(), "ful_BAK(nRefZ)" ) 
										      and SqlPrepareAndExecute( hSql(),"delete from BARS.pk_ref where ref=:nRefZ " )
										    )
										and SqlCommitEx(hSql(), "РАСформирован файл " || cmb_FA )
									Call SalHideWindow( cmb_FA )
									Call MessageNoWait(  "РАСформирован файл " || cmb_FA , 'УСПЕШНО ', 30, 0 )
									Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				!
				Pushbutton: pb_Null
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.267"
						Top:    0.095"
						Width:  0.43"
						Width Editable? No
						Height: 0.317"
						Height Editable? No
					Visible? No
					Keyboard Accelerator: Esc
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\Discard.bmp
					Picture Transparent Color: Gray
					Image Style: Single
					Text Color: Default
					Background Color: Default
					Message Actions
				Pushbutton: pb_Help
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.683"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Help.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Все отправленные файлы-пополнения ПК'
						On SAM_Click
							Set hWndForm.PK.sTmpN = STRING_Null
							Call FunNSIGet ('ZAG_PK', 'NANE', hWndForm.PK.sTmpN, hWndForm.PK.sTmpN1 )
							If hWndForm.PK.sTmpN  != STRING_Null
								Call DocViewListInt( hWndMDI, 
										"(a.ref in (SELECT ref from operw where tag='PK_F ' and value='"||hWndForm.PK.sTmpN || "' ) )", 
										"Документы, отобранные в файл "|| hWndForm.PK.sTmpN )
							!
		Contents
			Column: TIP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тип
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сч.АБС
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.183"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: REF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф
						зачисл.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						зачисл.
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.017"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			! Column: DK
.winattr
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ДК
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.383"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
.end
				                                                                                                                                        List Values 
				                                                                                                                                        Message Actions 
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
						док
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.533"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAZN
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назнач
						платежа
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  4.767"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KART
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: №
						карточ.счета
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.9"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpR = KART
					On SAM_AnyEdit
						If PK.TIP = 'ПКЮ'
							Set KART = sTmpR
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
							Call SalSetFocus( pb_Null )
			Column: FIO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ФИО владельца карт.счета
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set sTmpR = FIO
					On SAM_AnyEdit
						If PK.TIP = 'ПКЮ'
							Set FIO = sTmpR
							Call SalTblSetRowFlags( hWndForm, lParam, ROW_Edited, FALSE )
							Call SalSetFocus( pb_Null )
			!
			Column: ACC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.55"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_FILE
				Description:
				Returns
					Boolean:
				Parameters
					Number: nTipRow
				Static Variables
				Local variables
					Number: nKv 
					Number: nS
					Number: nKol
					String: sTT
					String: sNLSD
					String: sNMSD
					String: sNLSK
					String: sNMSK
					String: sErr
					!
					Number: nFA
					String: sODBCDir
					Sql Handle: hSqlA
					String: sTek_Kat 
					Boolean: FL
					!
					String: SBK_NUM 
					Number: SBK_SUM   
					String: SBK_FIO 
					String: SBK_FLR
					Number: nRef
					Number: nRow 
					!
					String: sK ! Короткое имя без расширения ( ZDyyMMdd )
					String: sK_nnn ! Короткое имя c расширением .nnn ( ZDyyMMdd.nnn )
					String: sD_dbf ! Длинное имя c расширением .DBF (  PK_FILE\ZDyyMMdd.dbf )
					String: sD_nnn ! Длинное имя c расширением .nnn (  PK_FILE\ZDyyMMdd.nnn )
				Actions
					! Взать имя текущего каталога
					Call SalFileGetCurrentDirectory( sTek_Kat )
					! Определить след сеанс
					If SqlPrepareAndExecute( hSql(), 
							  "SELECT NVL( max ( to_number(substr(value,-3) )) ,0) + 1 INTO :nFA FROM operw 
							   WHERE tag='PK_F ' and upper(value) like :PK.sMask ") 
							and not SqlFetchNext( hSql(), nFetchRes )
						Set nFA =1
					!
					Call SalUseRegistry(FALSE, '')
					Call SalGetProfileString( 'Export', 'PK_FILE', GetPrnDir()||"\\", sODBCDir, GetIniFileName() )
					Set sK = Subs(PK.sMask,1,8)
					Set sK_nnn = Subs(PK.sMask,1,9) || Subs( Str(1000+nFA), 2,3 )
					Set sD_dbf = sODBCDir || '\\' || sK || '.DBF'
					Set sD_nnn = sODBCDir || '\\' || sK_nnn
					! - 1 Отказались
					If File (sD_nnn)
						If SalMessageBox("Удалить файл ?","Файл "|| sD_nnn ||" уже существует !", MB_YesNoCancel | MB_IconHand )=IDYES	
							Call VisFileDelete(sD_nnn)
						Else
							Return FALSE
					If File (sD_dbf)
						Call VisFileDelete(sD_dbf)
					! 2 - Нет каталога
					! Переустановить тек каталог на путь из ini-файла
					If not SalFileSetCurrentDirectory( sODBCDir)
						Call SalFileSetCurrentDirectory( sTek_Kat)
						Call MessageAttention('Нет каталога: ' ||   sODBCDir)
						Return FALSE
					! 3 - Ошибка подсоединения
					Set SqlDatabase='dBase_Files'
					If not SqlConnect( hSqlA )
						Call SalFileSetCurrentDirectory( sTek_Kat)
						Call MessageAttention('Ошибка подсоединения к Базе данных:'|| SqlDatabase)
						Return FALSE
					! !!!!!!!!!!!!!!!!!!!!!!
					If SqlPrepareAndExecute( hSqlA, "CREATE table "|| sK  ||" 
							( BRANCHPART NUMBER(3),
							  COMPANY  NUMBER(7),
							  SBK_NUM  Char(20),
							  SBK_SUM  Numeric(10,2), 
							  SBK_FIO  Char(40),
							  SBK_CRD  Char(20),
							  SBK_COR  Char(20), 
							  SBK_PAS  Char(20), 
							  SBK_INN  Char(10), 
							  SBK_SHR  Char(10), 
							  SBK_FLR  Char(250) )" )
						Set FL = TRUE
						Set sErr = STRING_Null
						Set nKv = 0
						Set sNLSD = STRING_Null
						Set nS = 0
						Set nKol = 0
						Set nRow = TBL_MinRow
						While SalTblFindNextRow( hWndForm, nRow, nTipRow, 0)
							Call SalTblSetContext(hWndForm, nRow)
							If KART != STRING_Null and FIO != STRING_Null
								If nKv = 0 and sNLSD = STRING_Null
									Set nKv = PK.KV
									Set sNLSD = PK.NLS
								Else If (nKv != PK.KV or sNLSD != PK.NLS)
									Break
								Set SBK_FIO = StrWinToDosX( FIO )
								Set SBK_FLR= REF ||':'|| StrWinToDosX( NAZN )
								Set nKol = nKol + 1
								If TIP != 'ПКЮ'
									Set nS = nS + PK.S
								If not 
										SqlPrepareAndExecute( hSqlA,
										  "INSERT into "|| sK ||"(SBK_NUM,SBK_SUM,SBK_FIO,SBK_FLR) VALUES (:KART,:S,:SBK_FIO,:SBK_FLR )") 
										or not 
										SqlPrepareAndExecute( hSqlAux2(),
										  "INSERT into operw (REF,TAG,VALUE) values (:REF, 'PK_F ',:sK_nnn)")
										or not 
										SqlPrepareAndExecute( hSqlAux2(), "delete from BARS.pk_ref where ref=:REF")
									Set FL = FALSE
									Set sErr = "ПК: Ош.вставки-1"
									Break
						!
						Set nRefZ = NUMBER_Null
						If FL
							If nKol > 0 
								If nS != 0
									If SqlPrepareAndExecute( hSqlAux2(), 
											   "SELECT b.tt, b.nls, substr(k.nms,1,38), substr(d.nms,1,38)
											    INTO :sTT,:sNLSK,:sNMSK f, :sNMSD 
											    from PKa_buch b, accounts k , accounts d
											    where b.FZ=1 and b.kv=:nKv and k.kv=b.kv and k.nls=b.nls and d.kv=k.kv and d.nls=:sNLSD") 
											and SqlFetchNext( hSqlAux2(), nFetchRes )
										Call cDoc.SetDoc( nRefZ, sTT, IifN(nS>0,1,0), 6, Subs(sK_nnn,3,10), 
												     PK.bDat, PK.bDat, PK.bDat, PK.bDat,
												     sNLSD, sNMSD, GetBankMfo(),'', nKv, Abs(nS)*100, GetBankOkpoS(),
												     sNLSK, sNMSK, GetBankMfo(),'', nKv, Abs(nS)*100, GetBankOkpoS(),
												     "Файл-підкріплення (списання) карток на АКС " || sK_nnn,
												     '',GetIdOper(),'',NUMBER_Null, 0)
										If not cDoc.oDoc() 
											Set FL = FALSE
											Set sErr = "ПК: Ош.Оплаты "
										Else
											Set nRefZ = cDoc.m_nRef
									Else
										Set FL = FALSE
										Set sErr = "ПК: Ош.счетов для оплаты"
								If FL 
									If SqlPrepareAndExecute(hSqlAux2(),"INSERT into ZAG_PK( FN,DAT,ID,OTM,ref) values(:sK_nnn,sysdate,:PK.nUser,1,:nRefZ )")
										If nRefZ != NUMBER_Null
											If not SqlPrepareAndExecute( hSqlAux2(), "delete from operw where ref=:nRefZ") 
													or not SqlPrepareAndExecute( hSqlAux2(), "delete from BARS.pk_ref where ref=:nRefZ") 
												Set FL = FALSE
												Set sErr = "ПК: Ош. ZAG_PK (с реф)"
									Else
										Set FL = FALSE
										Set sErr = "ПК: INSERT into ZAG_PK"
							Else
								Set FL = FALSE
								Set sErr = "ПК: Нет готовых сумм для отбора "
					Else
						Set FL = FALSE
						Set sErr = "ПК: Не могу создать dbf-файл "|| sK 
					!
					If FL 
						Call SqlCommit( hSqlA ) 
						Call SqlDisconnect(hSqlA)
						Call SqlCommit( hSqlAux2() ) 
						!
						If VisFileRename( sD_dbf, sD_nnn ) = 1 and File (sD_nnn)
							Call SalMessageBox( "Выгрузка в " || sD_nnn || " завершена!", "Экспорт", MB_Ok)
					Else
						Call SqlRollback(hSqlA )
						Call SqlDisconnect(hSqlA)
						Call SqlRollback(hSqlAux2() )
						Call SalMessageBox( "НЕУСПЕШНАЯ Выгрузка  ! "|| sErr , "Экспорт", MB_Ok)
					! Восстановить тек каталог
					Call SalFileSetCurrentDirectory( sTek_Kat)
					If FL 
						Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
					Call SalWaitCursor(FALSE)
					Return FL
		Window Parameters
			Number: nDni
			String: strPar01
			String: strPar02
		Window Variables
			: cDoc
				Class: cDoc
			Number: nRefZ
			Number: nUser
			String: sTmp
			Date/Time: bDat
			Date/Time: bDat3
			String: sMask
			String: sTmpR
			String: sTmpF
			String: sTmpN
			String: sTmpN1
			String: sSql
		Message Actions
			On SAM_Create
				Call SalTblSetLockedColumns( hWndForm, 7 )
				Call SalHideWindow( cmb_FA )
				Set PK.strFilterTblName = 'OPER'
				Set PK.nUser = GetUserId()
				Set PK.nTabInstance = 1
				Set PK.strPrintFileName = 'PK'
				! Предварительніе работы
				If SqlPrepareAndExecute( hSql(),"DELETE from BARS.pk_ref where ref in (select ref from operw where tag='PK_F ')")
						and SqlPrepareAndExecute(hSql(),"DELETE from Bars.pk_acc")
						and SqlPrepareAndExecute(hSql(),"INSERT into Bars.PK_acc (acc,tip,kv,nls) 
						     select acc,tip,kv,nls from accounts where tip in ('ПКФ','ПКЮ')")
						and SqlCommit( hSql())
				!
				Set PK.bDat =  GetBankDate()
				Set PK.sMask = "ZD" || SalFmtFormatDateTime( PK.bDat , "yyMMdd" ) ||".___"
				Set PK.bDat3 = PK.bDat - PK.nDni
				!
				Set PK.strSqlPopulate = 
						"SELECT a.tip, a.kv, a.nls, to_char(p.ref), p.fdat, (2*p.DK-1)*p.s/100, OPER.nazn
						 INTO :PK.TIP, :PK.KV, :PK.NLS, :PK.REF, :PK.DAT, :PK.S, :PK.NAZN      
						 from Bars.pk_acc a, opldok p, OPER,  BARS.pk_ref R 
						 where  A.ACC=P.ACC AND P.REF=OPER.REF and OPER.REF =R.REF and P.SOS=5 
						  order by a.kv, a.nls, p.ref  "
				! Set PK.strSqlPopulate = 
						"SELECT a.tip, a.kv, a.nls, to_char(p.ref), p.fdat, (2*p.DK-1)*p.s/100, OPER.nazn
						 INTO :PK.TIP, :PK.KV, :PK.NLS, :PK.REF, :PK.DAT, :PK.S, :PK.NAZN      
						 from ACCOUNTS a, opldok p, OPER 
						 where A.TIP IN ('ПКФ','ПКЮ') AND A.ACC=P.ACC 
						   AND P.REF=OPER.REF and OPER.REF in (select ref from BARS.pk_ref) 
						   AND p.fdat>=:PK.bDat3  and P.SOS=5 
						   and not exists (select 1 from operw where ref=OPER.REF and tag='PK_F ' )
						  order by a.kv, a.nls, p.ref  "
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Update
				Call SalWaitCursor(TRUE)
				!
				! Call SqlPrepare(hSql(),
						 "insert into operw (ref, tag, value) values (:PK.REF, 'PK_F ', 'NOT_FILE' ) ")
				! Call SalTblDoDeletes(hWndForm, hSql(),  ROW_MarkDeleted)
				!
				Call SqlPrepare(hSql(),"DELETE FROM pk_ref where ref=:PK.REF")
				Call SalTblDoDeletes(hWndForm, hSql(),  ROW_MarkDeleted)
				!
				Call SqlPrepare(hSql(),
						 "insert into oper_visa(ref,dat,userid,STATUS) values (:PK.REF,sysdate,:PK.nUser,7) ")
				Call SalTblDoUpdates(hWndForm, hSql(), FALSE )
				Call SqlPrepare(hSql(),
						 "update OPERW  set VALUE=decode( tag, 'PK_H ', :PK.FIO, :PK.KART ) 
						  WHERE REF=:PK.REF and tag in ('PK_H ','PK_N ') ")
				Call SalTblDoUpdates(hWndForm, hSql(), TRUE )
				!
				Call SalSendClassMessage(UM_Update, 0, 0)
				Call SalWaitCursor(FALSE)
			On SAM_DoubleClick
				Call DocViewContentsEx(hWndForm, Val(PK.REF))
			On SAM_FetchRowDone
				If PK.TIP = 'ПКЮ'
					Call XSalTblSetRowBackColor( hWndForm, lParam,  SalColorFromRGB( 230,255,230 )  ) 
				If PK.S < 0 
					Call XSalTblSetCellBackColor( PK.S , COLOR_Salmon )
				If SqlPrepareAndExecute( hSqlAux2(), 
						"SELECT value INTO :KART FROM operw WHERE ref=:REF and tag='PK_N ' " )
						and SqlFetchNext( hSqlAux2(), nFetchRes )
				If SqlPrepareAndExecute( hSqlAux2(), 
						"SELECT value INTO :FIO FROM operw WHERE ref=:REF and tag='PK_H ' " )
						and SqlFetchNext( hSqlAux2(), nFetchRes )
			On SAM_ColumnSelectClick
				! Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
				! Set bSortOrd = not bSortOrd
				! Call SalTblSortRows(hWndForm, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
	Table Window: T0
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Клієнти, що користуються електронними послугами банку
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.65"
				Top:    1.375"
				Width:  16.517"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 32000
			Discardable? Class Default
		Description: Ver 16/02/2017
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.821"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pb_Help
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.317"
						Top:    0.095"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Help.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Довідник послуг'
						On SAM_Click
							Call FunNSIGet ('E_TARIF', 'NANE', sTmp, sTmp1 )
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.767"
						Top:    0.095"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Нова угода'
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.217"
						Top:    0.095"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.85"
						Top:    0.095"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.667"
						Top:    0.095"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 45454
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.95"
						Top:    0.095"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.4"
						Top:    0.095"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.117"
						Top:    0.095"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Деталі угоди на послуги'
						On SAM_Click
							If ND != NUMBER_Null
								If not IsWindow(hWin1)
									Set hWin1 = 
											SalCreateWindow( T1, hWndForm, T0.nFl_U,
											T0.ND, T0.RNK, T0.TYP, T0.NMK, T0.CC_ID, T0.NLS36,
											T0.DAT4, T0.DAT1_, T0.DAT2_, T0.KOL_  )
								Else
									Call SalBringWindowToTop ( T1 )
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.5"
						Top:    0.095"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 45455
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.8"
						Top:    0.464"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 45456
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbDoc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.017"
						Top:    0.095"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Tomail.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Документи угоди на послуги'
						On SAM_Click
							If T0.ND != NUMBER_Null
								Call cdoc_ShowAllDocs( T0.ND, hWndForm )
				Pushbutton: pb2 ! Паспорт клиента
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.567"
						Top:    0.095"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Паспорт клієнта'
						On SAM_Click
							If RNK != NUMBER_Null
								If TYP=2 and ELT_FL_ACC='1'
									Call EditCustCorps(RNK,CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
								Else If TYP=3 and ELT_FL_ACC='1'
									Call EditCustPerson(RNK,CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
								Else If TYP=2
									Call EditCustCorps(RNK,CVIEW_ReadOnly, hWndMDI)
								Else If TYP=3
									Call EditCustPerson(RNK,CVIEW_ReadOnly, hWndMDI)
								Else If TYP=1
									! Call EditCustBanks(dfRNK, CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
				Pushbutton: pbNazad
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.183"
						Top:    0.107"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Arr1tol.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Повернути надлишки авансу (3600->2600)'
						On SAM_Click
							If SalMessageBox(strTip || "?"||"
									! Будуть згенеровані проводки", "Увага!", MB_IconQuestion | MB_YesNo) = IDYES
								Call T0.F_OPL ( strTip, 0)
				Pushbutton: pbAVANS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   8.7"
						Top:    0.107"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Arr1tor.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: White
					Message Actions
						On SAM_Create
							Set strTip = 'Стягнути розрахунковий аванс (2600->3600)'
							If T0.sVariant = '3'
								Set strTip = 'Стягнути заборгованість абонплати з р/р-ку (26_0->3570)'
						On SAM_Click
							If SalMessageBox(strTip || "?"||"
									! Будуть згенеровані проводки", "Увага!", MB_IconQuestion | MB_YesNo) = IDYES
								If T0.sVariant = '3'
									Call T0.F_OPL ( strTip, 3 )
								Else
									Call T0.F_OPL ( strTip, 1 )
				Pushbutton: pbDox
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   9.667"
						Top:    0.107"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Doc_in.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: White
					Background Color: Light Aqua
					Message Actions
						On SAM_Create
							Set strTip = 'Сформувати доходи банку (3600->6*)'
							If T0.sVariant = '3'
								Set strTip = 'Сформувати доходи банку (3570->6*)'
						On SAM_Click
							If SalMessageBox(strTip || "?"||"
									! Будуть згенеровані проводки", "Увага!", MB_IconQuestion | MB_YesNo) = IDYES
								Call T0.F_OPL ( strTip, 2 )
				Frame
					Resource Id: 43081
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Window Location and Size
						Left:   5.75"
						Top:    0.06"
						Width:  7.333"
						Width Editable? Yes
						Height: 0.429"
						Height Editable? Yes
					Visible? Yes
					Corners: Square
					Border Style: Drop-Shadow
					Border Thickness: 1
					Border Color: Default
					Background Color: Default
				Pushbutton: pbBorg
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.75"
						Top:    0.131"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Arr1tol.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Sky
					Message Actions
						On SAM_Create
							Set strTip = 'Аванс за рахунок боргу (3578->3600)'
							If T0.sVariant = '3'
								Set strTip = 'Перенести на простр.борг (3570->3579)'
						On SAM_Click
							If SalMessageBox(strTip || "?"||"
									! Будуть згенеровані проводки", "Увага!", MB_IconQuestion | MB_YesNo) = IDYES
								Call T0.F_BORG ( strTip, 7 )
				Pushbutton: pbBorgR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   11.167"
						Top:    0.131"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\Arr1tor.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Dark Aqua
					Message Actions
						On SAM_Create
							Set strTip = 'Закрити борг (26_0->3578)'
							If T0.sVariant = '3'
								Set strTip = 'Покриття простр.боргу (26_0->3579)'
						On SAM_Click
							If SalMessageBox(strTip || "?"||"
									! Будуть згенеровані проводки", "Увага!", MB_IconQuestion | MB_YesNo) = IDYES
								If T0.sVariant = '3'
									Call T0.F_BORG ( strTip, 8 )
								Else
									Call T0.F_BORG ( strTip, 8 )
				Combo Box: cmb1
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Window Location and Size
						Left:   5.85"
						Top:    0.155"
						Width:  2.15"
						Width Editable? Yes
						Height: 0.881"
						Height Editable? Yes
					Visible? Yes
					Editable? Yes
					String Type: String
					Maximum Data Length: Default
					Sorted? No
					Always Show List? No
					Vertical Scroll? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
					List Initialization
					Message Actions
						On SAM_Click
							Call cmb1_Click()
				Data Field: KOL_
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.05"
							Top:    0.107"
							Width:  0.567"
							Width Editable? Yes
							Height: 0.321"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Кількість роб.днів в місяці')
				Pushbutton: pbAvansR
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   5.283"
						Top:    0.095"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Doc_turn.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Green
					Message Actions
						On SAM_Create
							Set strTip = 'Поновити розрахунковий аванс'
						On SAM_Click
							! Call Debug('1.Начало вып.процедуры ELT.shnel = '||  SalFmtFormatDateTime( SalDateCurrent( ), 'hh:mm:ss' ) )
							Call SalWaitCursor(TRUE)
							If SqlPLSQLCommand(hSql(),
									"BARS.ELT.shnel( T0.DAT1_, T0.DAT2_, T0.KOL_, T0.sErr )" )
								Call SqlCommit( hSql() )
								Call SalWaitCursor( FALSE )
								! Call Debug('2.Конец вып.процедуры ELT.shnel = ' ||  SalFmtFormatDateTime( SalDateCurrent( ), 'hh:mm:ss' ) )
							Else
								Call SqlRollback(hSql())
								Call SalWaitCursor( FALSE )
								Call SalMessageBeep(MB_IconStop)
								Call MessageNoWait( " Помилка ! ELT.shnel " ,'',2,1)
								Return FALSE
				Check Box: PAKET_
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title: Все 
					Window Location and Size
						Left:   10.2"
						Top:    0.155"
						Width:  0.783"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Message Actions
				Pushbutton: pbNot
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   12.533"
						Top:    0.119"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \bars98\RESOURCE\BMP\A_BKLD.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Протокол НЕуспішних проводок'
						On SAM_Click
							If hOPL
								Call SalBringWindowToTop(T2)
							Else
								Call SalCreateWindow(T2, hWndMDI)
				Pushbutton: pbClose
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.3"
						Top:    0.464"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Cabinet.bmp
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Закрити угоду'
						On SAM_Click
							If SalMessageBox('Угоду '||Str(T0.RNK)||'/'||Str(T0.ND)||PutCrLf()||
									   ' закрити ?', 'Увага!', MB_YesNo | MB_IconHand) = IDYES
								Call SalWaitCursor( TRUE )
								! Call Debug('Закрытие в архив ')
								If SqlPrepareAndExecute(hSql(),
										 "update e_deal set sos=15
										  where nd=:T0.ND ")
									Call SqlCommit( hSql() )
									! Call Debug('Успешно закрыт')
								Else
									Call SqlRollback(hSql())
									! Call Debug('Ошыбка закрытия')
								Call SalWaitCursor( FALSE )
								Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Option Button: pbShow
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   0.8"
						Top:    0.464"
						Width:  0.383"
						Width Editable? Yes
						Height: 0.317"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Picture File Name: \BARS98\RESOURCE\BMP\Tudasuda.bmp
					Picture Transparent Color: Green
					Button Style: Check
					Image Style: Single
					Text Color: Magenta
					Background Color: Dark Aqua
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Відкриті/Закриті угоди' )
						On SAM_Click
							If pbShow
								Set nFl_U = 3 
								! Set nFl_U = T0.U
								Set WHE0 = " and e.sos = 15 "
								Call SalDisableWindow( pbIns )
								Call SalDisableWindow( pbDel )
								Call SalDisableWindow( pbUpdate )
								Call SalDisableWindow( pbDoc )
								Call SalDisableWindow( pbNazad )
								Call SalDisableWindow( pbAVANS )
								Call SalDisableWindow( pbDox )
								Call SalDisableWindow( pbAvansR )
								Call SalDisableWindow( PAKET_ )
								Call SalDisableWindow( pbNot )
								Call SalDisableWindow( pbClose )
								Call SalDisableWindow( pbBorg )
								Call SalDisableWindow( pbBorgR )
							Else
								Set WHE0 = " and e.sos <> 15 "
								Set nFl_U = T0.U
								If T0.U != 3 and T0.U != 31
									Call SalEnableWindow( pbIns )
									Call SalEnableWindow( pbDel )
									Call SalEnableWindow( pbUpdate )
									Call SalEnableWindow( pbDoc )
									Call SalEnableWindow( pbNazad )
									Call SalEnableWindow( pbAVANS )
									Call SalEnableWindow( pbDox )
									Call SalEnableWindow( pbAvansR )
									If T0.U = 0
										Call SalEnableWindow( PAKET_ )
									Call SalEnableWindow( pbNot )
									Call SalEnableWindow( pbClose )
									If sRegBorg = '0'
										Call SalEnableWindow( pbBorg )
										Call SalEnableWindow( pbBorgR )
								! Call SalEnableWindow( hWndForm )
							Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
				Pushbutton: pbDetacc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.367"
						Top:    0.464"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\OPEN.BMP
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Light Periwinkle
					Message Actions
						On SAM_Create
							Set strTip = 'Перегляд рахунків угоди'
							! Set strTip = CurrentLangTable.GetAtomTitle('CPP.cBTipDetails')
						On SAM_Click
							If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
								Call F_ACC(T0.ND)
				Data Field: sVer
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   10.957"
							Top:    0.51"
							Width:  1.533"
							Width Editable? Yes
							Height: 0.323"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
		Contents
			Column: RNK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реєст.
						№
						 клієнта
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.9"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TYP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тип
						кл
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NMK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва клієнта
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.683"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_DoubleClick
						If T0.ND = NUMBER_Null
							Set T0.sTmp=STRING_Null                   ! and customer.rnk not in (select rnk from e_deal )
							Call FunNSIGetFiltered
									("CUSTOMER","NMK",
									" DATE_OFF is null ",
									 T0.sTmp, T0.NMK)
							If T0.sTmp !=STRING_Null
								If SqlPrepareAndExecute(hSql(),
										"SELECT rnk INTO :nTmp FROM e_deal WHERE rnk=:T0.sTmp and sos<>15") AND
										   SqlFetchNext(hSql(), nFetchRes) AND nTmp = Val(sTmp)
									If SalMessageBox( 'У клиента '||sTmp||' '||NMK||' уже есть договор. Продолжить ввод нового?', 'Внимание', MB_IconAsterisk | MB_YesNo ) = IDNO
										Set NMK = ''
										Return FALSE
								Set T0.RNK=Val(T0.sTmp)
								Set T0.KV26=T0.n980
								If SqlPrepareAndExecute(hSql(), "SELECT BARS.F_NEWNLS2(NULL,'ELT',null,:T0.RNK,NULL) INTO :NLS36 FROM dual")
										and SqlFetchNext(hSql(), nFetchRes)
									! Call SalSendMsg( T0.NLS36, SAM_Validate, 0, 0 )
									Set T0.nls36t = T0.NLS36
								If SqlPrepareAndExecute( hSql(),"SELECT custtype, sab INTO :T0.TYP,:T0.SAB FROM customer where rnk=:T0.RNK " )
										and SqlFetchNext( hSql(), nFetchRes ) 
										and SqlPrepareAndExecute( hSql(),
										  "SELECT min(a.acc) INTO :T0.ACC_26
										   FROM accounts a        
										   WHERE a.rnk=:T0.RNK   
										          and a.kv =:T0.KV26 and a.nbs in (select nbs from e_nbs)    
										          and a.tip in ('ODB','BDB','SS','W4A')
										         and a.dazs is null      --and a.blkd=0
										 " )
										and SqlFetchNext( hSql(), nFetchRes ) 
										and SqlPrepareAndExecute( hSql(), "SELECT nls,tobo INTO :T0.NLS26,:T0.BRANCH FROM accounts WHERE acc=:T0.ACC_26 " )
										and SqlFetchNext( hSql(), nFetchRes ) 
									If T0.sMSK = '1'
										If SqlPrepareAndExecute( hSql(),
												  "SELECT  substr(sb_acc('3570??????????',:T0.NLS26),1,15)  INTO :T0.nls36s from dual " )
												and SqlFetchNext( hSql(), nFetchRes ) 
											Set T0.NLS36 = SalStrToNumber (T0.nls36s)
											Set T0.nls36t = SalStrToNumber (T0.nls36s)
										! Call Debug('ELT_sMSK='||T0.sMSK||' ')
									Set DEB_26 = 'Y'
									Set T0.DAT1 = T0.bDat
									Set T0.DAT4 = T0.DATP_
									Set USER_ID = nUser
									If SqlPrepareAndExecute( hSql(),
											  "SELECT min(a.nls) INTO :T0.NLS36 FROM accounts a   
											   WHERE a.rnk=:T0.RNK            
											         and a.nls like :T0.nls36t 
											         and a.kv=:T0.n980 and a.nbs=:T0.nbs36 and a.dazs is null " )
											and SqlFetchNext( hSql(), nFetchRes ) 
			Column: SAB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ел.
						адреса
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: USER_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вик-ць
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.8"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If USER_ID=NUMBER_Null
							Set USER_ID = nUser
			Column: ND
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Реф.
						угоди
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.857"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: CC_ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Ідент.
						угоди
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Right
				Width:  0.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS26
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рах-к для якого
						нарах-ся плата
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.614"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV26
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						валюти
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If KV26= NUMBER_Null
							Set KV26 = 980
			Column: DEB_26
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: А
						в
						т
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: Y
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If T0.U != 3 and T0.U != 31 and 
								SqlPLSQLCommand( hSql(), "kl.setCustomerElement( RNK, 'Y_ELT', '"||IifS(DEB_26='Y','','N')||"', 0, 0 )" )
							Call SqlCommit( hSql() )
			Column: DAT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						угоди
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If DAT1= DATETIME_Null
							Set DAT1 = bDat
			Column: DAT4
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
						попер.
						розрах.
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  1.1"
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If DAT1= DATETIME_Null
							Set DAT1 = bDat
			Column: OSTS26
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Залишок
						на рах-ку
						2....
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.15"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS36
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок
						  для сплати 
						абонплати
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.529"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						If SalIsNull(T0.NLS36)
							If T0.sMSK = '1'
								If SqlPrepareAndExecute( hSql(),
										  "SELECT  trim(substr(bars.sb_acc('3570??????????',:NLS26),1,15))  INTO :nls36s from dual " )
										and SqlFetchNext( hSql(), nFetchRes ) 
									Set T0.NLS36 = SalStrToNumber (nls36s)
									Set T0.nls36t = SalStrToNumber (nls36s)
									! Call DebugN(T0.NLS26)
							Else
								If SqlPrepareAndExecute(hSql(), "SELECT BARS.F_NEWNLS2(NULL,'ELT',null,:RNK,NULL) INTO :NLS36 FROM dual")
										and SqlFetchNext(hSql(), nFetchRes)
							Call SalSendMsg( T0.NLS36, SAM_Validate, 0, 0 )
					On SAM_Validate
						If not SalIsValidInteger(hWndItem)
							Call SalMessageBox("Нецифра в номере счета", "Ошибка", MB_IconExclamation)
							Return VALIDATE_Cancel
						Set NLS36 = Val(KeyAccount( sBankMfo, Str(T0.NLS36) ))
						If T0.U != 3 and T0.U != 31 and not pbShow
							Call F_NEW()
						Return VALIDATE_Ok
			Column: OSTS36
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Факт. зал.
						на рах-ку
						абонплати
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.05"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OSTP36
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: План.зал.
						на рах-ку
						абонплати
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.05"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: AVANS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Розр-ва
						абонплата 
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.143"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS_D		
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Р-к боргу
						абонплати
						3578/3579
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.614"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST_D
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Залишок
						на рах-ку 
						3579
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.05"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS_P
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рахунок - 
						платник 
						(NLS_P)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.543"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST_P
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Залишок на
						р-ку NLS_P
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.15"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ABT_PG
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: А
						в
						т
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  0.433"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: Y
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SOS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Стан
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: ACC_26
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ACC_2600
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.75"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: PRZ
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: BRANCH
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: (ТВБВ)
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.214"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: F_OPL
				Description:
				Returns
					Boolean:
				Parameters
					String: sMODE
					Number: nMODE
				Static Variables
				Local variables
					String: YYYYMM
					Boolean: FL_
					Number: nRow
					String: s36
				Actions
					Call SalWaitCursor( TRUE )
					Set YYYYMM = SalStrLeftX(  T0.cmb1,4)||SalStrMidX(  T0.cmb1, 5, 2)
					If T0.PAKET_
						If SqlPLSQLCommand( hSql(), 
								"ELT.OPL ( nMODE, sTT, 0, T0.sNDS, T0.cmb1, DAT1_, DAT2_, KOL_, 0, '', sErr )" ) 
								and sErr=STRING_Null
							Call SqlCommit(hSql())
							Set FL_ = TRUE
							Call SalWaitCursor( FALSE )
							Call MessageNoWait( sMODE||": Операцію виконано успішно " ,'',2,0)
						Else
							Call SqlRollback(hSql())
							Set FL_ = FALSE
							Call SalWaitCursor( FALSE )
							Call SalMessageBeep(MB_IconStop)
							Call MessageNoWait( sMODE||": Помилка ! "|| sErr ,'',2,1)
					Else
						Set nRow = TBL_MinRow
						While SalTblFindNextRow( hWndForm, nRow, 0, 0)
							Call SalTblSetContext(hWndForm, nRow)
							Set s36 = Str(NLS36)
							If SqlPLSQLCommand(hSql(), 
									"ELT.OPL(nMODE,sTT,0,T0.sNDS,T0.cmb1,DAT1_,DAT2_, KOL_, 1, s36, sErr )"  )
									and sErr=STRING_Null
								Call SqlCommit(hSql())
								Set FL_ = TRUE
							Else
								Call SqlRollback(hSql())
								Set FL_ = FALSE
								Call MessageNoWait('Неуспешное завершение для '||Str(NLS36), 'Ошибка', 0, 1)
						Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
					Return FL_
			Function: F_BORG
				Description:
				Returns
					Boolean:
				Parameters
					String: sMODE
					Number: nMODE
				Static Variables
				Local variables
					String: YYYYMM
					Boolean: FL_
					Number: nRow
					String: s36
				Actions
					Call SalWaitCursor( TRUE )
					Set YYYYMM = SalStrLeftX(  T0.cmb1,4)||SalStrMidX(  T0.cmb1, 5, 2)
					If T0.PAKET_
						If SqlPLSQLCommand( hSql(), 
								"ELT.BORG ( nMODE, sTT, 0, T0.sNDS, T0.cmb1, DAT1_, DAT2_, KOL_, 0, '', sErr )" ) 
								and sErr=STRING_Null
							Call SqlCommit(hSql())
							Set FL_ = TRUE
							Call SalWaitCursor( FALSE )
							Call MessageNoWait( sMODE||": Операцію виконано успішно " ,'',2,0)
						Else
							Call SqlRollback(hSql())
							Set FL_ = FALSE
							Call SalWaitCursor( FALSE )
							Call SalMessageBeep(MB_IconStop)
							Call MessageNoWait( sMODE||": Помилка ! "|| sErr ,'',2,1)
					Else
						Set nRow = TBL_MinRow
						While SalTblFindNextRow( hWndForm, nRow, 0, 0)
							Call SalTblSetContext(hWndForm, nRow)
							Set s36 = Str(NLS36)
							If SqlPLSQLCommand(hSql(), 
									"ELT.BORG(nMODE,sTT,0,T0.sNDS,T0.cmb1,DAT1_,DAT2_, KOL_, 1, s36, sErr )"  )
									and sErr=STRING_Null
								Call SqlCommit(hSql())
								Set FL_ = TRUE
							Else
								Call SqlRollback(hSql())
								Set FL_ = FALSE
								Call MessageNoWait('Неуспешное завершение для '||Str(NLS36), 'Ошибка', 0, 1)
						Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
					Return FL_
			Function: cmb1_Click
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Set T0.YYYYMM = SalStrLeftX( cmb1,4)||SalStrMidX( cmb1, 5, 2)
					Set T0.DAT1_  = SalFmtFormatStrDateTime( T0.YYYYMM ||'01','yyyyMMdd' )
					Set T0.DAT2_ = AddMonths( T0.DAT1_ , 1 ) - 1
					!
					If SqlPrepareAndExecute( hSql(),
							"SELECT elt.RAB_DNI( :T0.DAT1_, :T0.DAT2_ ) INTO :T0.KOL_ from dual ") 
							and SqlFetchNext( hSql(), nFetchRes )
					!
			Function: F_NEW
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
					Number: nAcc
					Number: nRnk
					Number: nErrQty
					Date/Time: dDAZS
					String: sOB22
					String: sNLS36
				Actions
					Set sNLS36 = Str(T0.NLS36)
					If SqlPrepareAndExecute( hSql(),
							"SELECT acc, rnk, ob22, dazs
							   INTO :nAcc, :nRnk, :sOB22, :dDAZS
							   FROM accounts
							  WHERE kv  = :T0.n980
							    and nls = :sNLS36
							") and not SqlFetchNext(hSql(), nFetchRes )
						If SalMessageBox( 'Відкрити рахунок '||sNLS36||'/'||Str(T0.n980)||'?'
								                , 'Увага!', MB_YesNo | MB_IconQuestion ) = IDYES
							If SqlPLSQLCommand( hSql(), "ELT.OPN_ACNT( ND, ACC_26, sNLS36 )" )
								Call SqlCommit( hSql() )
							Else
								Call SqlRollback(hSql())
								Call SalMessageBox( 'Неможливо відкрити рахунок ' || sNLS36
										                  , 'Помилка', MB_IconExclamation )
					Else
						If ( nRnk != T0.RNK )
							Call SalMessageBox( 'РНК рахунка '||sNLS36||' не відповідає РНК договору!'
									                  , 'Помилка!', MB_IconExclamation )
						Else If ( sOB22 != '02' )
							Call SalMessageBox( 'ОБ22 рахунка '||sNLS36||' належить іншому продукту!'
									                  , 'Помилка!', MB_IconExclamation )
						Else If ( dDAZS != DATETIME_Null )
							Call SalMessageBox( 'Рахунок '||sNLS36||' закритий!'
									                  , 'Помилка!', MB_IconExclamation )
						Else
							If SqlPrepareAndExecute( hSql(),"update BARS.E_DEAL$BASE set ACC36 = :nAcc where ND = :T0.ND")
								Call SqlCommit( hSql() )
							Else
								Call SqlRollback( hSql() )
			Function: F_ACC
				Description:
				Returns
				Parameters
					Number: nND
				Static Variables
				Local variables
					Number: nAcc26
					Number: nAcc36
					Number: nAccD
					Number: nAccP
				Actions
					If SqlPrepareAndExecute( hSqlAux2(),
							  "SELECT nvl(a26.ACC,-9), nvl(a36.ACC,-9), nvl(d.ACC,-9), nvl(p.ACC,-9)
							   INTO :nAcc26, :nAcc36, :nAccD,:nAccP  
							   FROM e_deal, accounts a26, accounts a36, accounts d, accounts p
							   WHERE nd=:nND 
							   and a26.acc=acc26
							   and a36.nls=nls36 and a36.kv=980
							    and p.nls(+)=nls_p and p.kv(+)=980
							   and d.nls(+)=nls_d and d.kv(+)=980 ")
						If SqlFetchNext ( hSqlAux2(), nFetchRes)
							Set sTmp = "a.acc in ("||
									Str(nAcc26 )||','||
									Str(nAcc36 )||','||
									Str(nAccP )||','||
									Str(nAccD )||')'
							If 2 = 2
								Call ShowAccList ( NUMBER_Null, AVIEW_ALL, AVIEW_ReadOnly | AVIEW_AllOptions, sTmp )
							Else
								Call ShowAccF(hWndMDI, sTmp )
		Window Parameters
			! Sel001( hWndMDI, U, pGr, TT,  sNDS )
					U   =  Уровень доступа: 3 -весь портфель (тільки пергляд),
					                        0-весь портфель,
					                        1-портфель инспектора, 
					                        2-портфель подразделения
					                       31 - портфель ТОБО (перегляд)
					pGR =  Группа доступа для открываемых счетов модуля
					TT  =  Код операции (один из справочника операций ), 
					       которым будут выполнены автоматические проводки по абонплате, доходам, НДС. 
					sNDS = Лицевой счет для сумм НДС.
					! В последующих версиях значения TT и sNDS будем определять из Params 
					  и освободим два пар-ра для других целей (для внешних фильтров)
			Number: U
			Number: pGr !  вместо pNDS
			String: TT  ! пока значение TT (постепенно переводим в п-же ELT на выбор TT из Params)
			String: sP_NDS ! внешний фильтр или счет НДС 
		Window Variables
			Number: n980
			String: sErr
			String: sBankMfo
			String: sBankMfoP
			String: YYYYMM
			Date/Time: bDat
			String: sTmp
			String: sTmp1
			Number: nUser
			String: sVariant
			String: sSql
			Number: nVariant
			Number: nbs36
			Number: n0
			Number: nOtd
			Date/Time: DAT1_
			Date/Time: DAT2_
			String: sWHERE 
			String: sf
			Date/Time: DATP_
			Number: nInd
			Number: nCol_Nls
			String: WHE0
			String: WHE1
			String: ORD
			Number: nFl_U
			Number: nTmp
			String: sRegBorg
			Number: nls36t
			String: ELT_FL_RNK
			String: ELT_FL_ACC
			String: sTOBO
			String: sTT
			String: sMSK
			String: nls36s
			String: sNDS  
			Number: nMonth_Back
			String: sM_B
		Message Actions
			On SAM_Create
				Set nFl_U = T0.U
				Set sVer = 'ver 18/04-17'
				If T0.U = 3 or T0.U = 31
					Call SalDisableWindow( pbIns )
					Call SalDisableWindow( pbDel )
					Call SalDisableWindow( pbUpdate )
					Call SalDisableWindow( pbDoc )
					Call SalDisableWindow( pbNazad )
					Call SalDisableWindow( pbAVANS )
					Call SalDisableWindow( pbDox ) 
					Call SalDisableWindow( pbAvansR ) 
					Call SalDisableWindow( PAKET_ ) 
					Call SalDisableWindow( pbNot ) 
					Call SalDisableWindow( pbBorg )
					Call SalDisableWindow( pbBorgR )
					Call SalDisableWindow( pbClose )
				Call SalWaitCursor( TRUE )
				Call PrepareWindow( hWndForm )
				Call SalTblSetLockedColumns( hWndForm, 4 )
				Set T0.nTabInstance = 1
				Call SetWindowFullSize(hWndForm)
				Set T0.strFilterTblName = 'E_DEA'
				Set T0.strPrintFileName = 'ELT'
				Set T0.fFilterAtStart = TRUE
				Set T0.bDat = GetBankDate()
				Set T0.n980 = GetBaseVal()
				Set T0.nUser = GetUserId()
				Set T0.sBankMfo = GetBankMfo()
				Set T0.sBankMfoP = GetGlobalOption('MFOP')
				Set T0.sM_B = GetGlobalOption('ELT_MB')
				If T0.sM_B = STRING_Null
					Set T0.nMonth_Back =  4
				Else
					Set T0.nMonth_Back = SalStrToNumber(sM_B) 
				Set T0.sNDS = T0.sP_NDS
				Set T0.WHE1 = STRING_Null
				If sBankMfoP = '300465'       
					Set T0.sNDS = STRING_Null
				If T0.sP_NDS != STRING_Null and SalStrLeftX(T0.sP_NDS, 4 ) != '3622'
					Set T0.WHE1 = T0.sP_NDS
					Call SalDisableWindow( PAKET_ ) 
				If SalStrLeftX(T0.sP_NDS, 4 ) = '3622'
					Set T0.WHE1 = STRING_Null
				Set T0.DATP_ = T0.bDat - SalDateDay( T0.bDat )
				Set T0.PAKET_ = FALSE
				Set T0.sVariant = '3'
				Set T0.nVariant = 3
				Set T0.nbs36 = 3570    !3600
				Set ORD = " ORDER BY rnk"
				Set T0.WHE0 = " and e.sos <> 15 "
				! !
				Set T0.sMSK = GetGlobalOption('ELT_MSK')
				Set T0.sRegBorg = '0'
				Set T0.sRegBorg = GetGlobalOption('ELT_BORG')
				Call SalDisableWindow( pb2 )
				If sRegBorg = STRING_Null
					Set T0.sRegBorg = '0'
				If sRegBorg = '1'
					Call SalDisableWindow( pbBorg )
					Call SalDisableWindow( pbBorgR )
				Set T0.sTT = GetGlobalOption('ELT_TT')
				! Call Debug('ELT_TT='||T0.sTT||sTT||T0.TT)
				If sTT = STRING_Null
					Set T0.sTT = T0.TT
				If SqlPrepareAndExecute( hSql(),
						"SELECT substr(pul.Get_Mas_Ini_Val('ELT_FL_RNK'),1,1)
						 INTO :ELT_FL_RNK from dual" )
						and SqlFetchNext( hSql(), nFetchRes )
					If ELT_FL_RNK = '1'
						Call SalEnableWindow( pb2 )
				Set nCol_Nls =  SalColorFromRGB(250,200,100)
				Set sSql = "SELECT substr(val,1,50) into :T0.sVariant
						   FROM params 
						   WHERE par = 'ELT_VAR'" 
				If SqlPrepareAndExecute(hSqlAux(), sSql)
					If SqlFetchNext( hSqlAux(), n0)
						If T0.sVariant='1'
							Set T0.nVariant=1
						If T0.sVariant='3'
							Set T0.nVariant=3
						If T0.sVariant='UPB'        ! Для УПБ
							Set T0.nVariant=2
						If T0.sVariant='2' 
							Set T0.nVariant=2
				If T0.nVariant = 1 or T0.nVariant = 2 or T0.nVariant = 3
					Call SalHideWindow(pbNazad)
					Set T0.nbs36=3570
					If T0.nVariant = 1 or T0.nVariant = 2
						Call SalHideWindow(pbAVANS)
				If SqlPrepareAndExecute( hSql(), 
						  "SELECT distinct substr( to_char(F.FDAT,'YYYY/MM') || ' ' || m.NAME_PLAIN , 1, 20) 
						   FROM fdat F,  meta_month M 
						   WHERE to_number(to_char(F.fdat,'MM') ) = M.n AND F.fdat + (30 * :T0.nMonth_Back) >= :T0.bDat 
						   ORDER BY 1 desc INTO :T0.sTmp " )
					While SqlFetchNext( hSql(), nFetchRes )
						Call SalListAdd( T0.cmb1, T0.sTmp )
					Call SalListSetSelect( T0.cmb1, 0 )
					Call SalSendMsg( T0.cmb1, SAM_Click, 0, 0 )
				Call cmb1_Click()
				!
				If T0.U = 0 or T0.U = 3
					Set T0.sWHERE = ' '
				Else If T0.U = 31
					Set T0.sWHERE = ' and e.rnk in 
							(select rnk from customer where tobo= (select tobo from staff where id=:T0.nUser))'
				Else If T0.U = 1
					Set T0.sWHERE = ' and e.USER_ID =:T0.nUser '
					Call SalDisableWindow( PAKET_ ) 
				Else If T0.U = 2
					Set T0.sWHERE = ' and e.USER_ID in 
							(SELECT uk.userid 
							 FROM OTD_USER uk, OTD_USER un 
							 WHERE uk.OTD=un.OTD and un.USERID=:T0.nUser)'
					Call SalDisableWindow( PAKET_ ) 
				Set T0.strSqlDelete =
						   "delete from e_deal where nd=:T0.ND"
				! для поддержки поля BRANCH, если E_DEAL таблица 
				! Set T0.strSqlUpdate = 
						   "update e_deal set CC_ID=:T0.CC_ID, USER_ID=:T0.USER_ID, sdate=:T0.DAT1, 
						    nls36=:T0.NLS36, nls26=:T0.NLS26        , branch=:T0.BRANCH 
						    where nd=:T0.ND"
				! Set T0.strSqlUpdate = 
						   "update e_deal set CC_ID=:T0.CC_ID, USER_ID=:T0.USER_ID, sdate=:T0.DAT1, 
						    nls36=:T0.NLS36, nls26=:T0.NLS26        , branch=:T0.BRANCH,  nls_p=:T0.NLS_P, kv26=:T0.KV26 
						    where nd=:T0.ND"
				Set T0.strSqlUpdate = 
						   "update e_deal set CC_ID=:T0.CC_ID, USER_ID=:T0.USER_ID, sdate=:T0.DAT1, 
						    nls36=:T0.NLS36, nls26=:T0.NLS26        , branch=:T0.BRANCH,  nls_p=:T0.NLS_P, kv26=:T0.KV26,  nls_d=:T0.NLS_D
						    where nd=:T0.ND"
				! для поддержки поля BRANCH, если E_DEAL таблица 
				! Set T0.strSqlInsert = 
						"Insert into e_deal (nd, SOS,CC_ID,SDATE,RNK,USER_ID, nls36,nls26, WDATE, BRANCH ) values 
						(0, 0, :T0.CC_ID, :T0.DAT1, :T0.RNK, :T0.USER_ID, :T0.NLS36, :T0.NLS26, :T0.DATP_, :T0.BRANCH )"
				Set T0.strSqlInsert = 
						"Insert into e_deal (nd, SOS,CC_ID,SDATE,RNK,USER_ID, nls36,nls26, WDATE, BRANCH, NLS_P,kv26) values 
						(0, 0, :T0.CC_ID, :T0.DAT1, :T0.RNK, :T0.USER_ID, :T0.NLS36, :T0.NLS26, :T0.DATP_, :T0.BRANCH, :T0.NLS_P,:T0.KV26 )"
				! Set T0.strSqlInsert = 
						"Insert into e_deal (nd, SOS,CC_ID,SDATE,RNK,USER_ID, nls36,nls26, WDATE ) values 
						(0, 0, :T0.CC_ID, :T0.DAT1, :T0.RNK, :T0.USER_ID, :T0.NLS36, :T0.NLS26, :T0.DATP_ )"
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On SAM_DoubleClick
				Call SalSendMsg( pbDetails, SAM_Click, 0, 0 )
			On SAM_FetchRowDone
				! Смысловая раскраска строк 
				If SalStrLeftX( Str(T0.NLS36), 4 ) = '3570'
					! задолженность по 3570 НЕ погашена - розовый   
					If T0.OSTS36 < 0      !  and bDat < T0.DAT4
						Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB(255,210,250 ))
					! договор уже обработан в расчетном месяце - (морская волна)
					If T0.OSTP36 = T0.OSTS36 and T0.OSTS36=0 and bDat<=T0.DAT4
						Call XSalTblSetRowBackColor( hWndForm, lParam,  SalColorFromRGB( 100,255,220 )  )
					! НЕ удержан доход на 6 класс - красный
					If T0.AVANS > 0 and T0.OSTS36=0 and bDat>T0.DAT4
						Call XSalTblSetRowBackColor( hWndForm, lParam,  SalColorFromRGB( 220,100,180 )  )
					! кирпичный (250,200,100)
					! План не = факт на NLS36 - бледно-зеленый
					If OSTS36 != OSTP36
						Call XSalTblSetRowBackColor( hWndForm, lParam,  SalColorFromRGB(230,255,230)  )
					If T0.PRZ != 0
						! Set nInd=COLOR_DarkBlue
						Call XSalTblSetCellBackColor( NLS26, nCol_Nls )
					Else
						! Set nInd=COLOR_Black
					! Call SalTblSetCellTextColor(T0.NLS26, nInd, FALSE )
					If T0.NLS_D != NUMBER_Null and T0.OST_D != 0
						! Set nInd=COLOR_DarkBlue
						Call XSalTblSetCellBackColor( RNK, nCol_Nls )
					If T0.NLS_P != NUMBER_Null 
						! Set nInd=COLOR_DarkBlue
						Call XSalTblSetCellBackColor( ND, nCol_Nls )
				Else
					! недоплата - розовый
					If T0.AVANS > T0.OSTS36 and T0.NLS36 !=NUMBER_Null
						Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 255,210,250 ))
					! переплата - голубой
					If T0.AVANS < T0.OSTS36
						Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Sky )
					! ! договор уже обработан в расчетном месяце - (морская волна)
					If T0.OSTS36 = 0 and bDat<=T0.DAT4
						Call XSalTblSetRowBackColor( hWndForm, lParam, SalColorFromRGB( 100,255,220 ) )
					! План не = факт на 36 - бледно-зеленый
					If OSTS36 != OSTP36
						Call XSalTblSetRowBackColor( hWndForm, lParam,  SalColorFromRGB( 230,255,230 )  )
					If T0.PRZ != 0
						! Set nInd=COLOR_DarkBlue
						Call XSalTblSetCellBackColor( NLS26, nCol_Nls )
					Else
						! Set nInd=COLOR_Black
					! Call SalTblSetCellTextColor(T0.NLS26, nInd, FALSE )
					If T0.NLS_D != NUMBER_Null and T0.OST_D != 0
						! Set nInd=COLOR_DarkBlue
						Call XSalTblSetCellBackColor( RNK, nCol_Nls )
				! Подчитка доп.реквизита 
				If SqlPrepareAndExecute( hSqlAux2(),
						  "SELECT substr(NVL(value,'Y'),1,1) INTO :T0.DEB_26 
						   FROM CUSTOMERW  WHERE tag ='Y_ELT' and rnk= :T0.RNK 
						        AND value='N' AND ROWNUM=1" ) 
						and not SqlFetchNext( hSqlAux2(), nFetchRes )
					Set T0.DEB_26  = 'Y'
			On UM_Populate
				If fFilterAtStart
					If SetQueryFilter(cF)
						Set fFilterAtStart = NOT fFilterAtStart
				If not fFilterAtStart
					Call SalWaitCursor(TRUE)
					Set T0.sf = ""
					Set T0.sf = cF.GetFilterWhereClause( FALSE )
					Set T0.strSqlPopulate =
							"SELECT ND   , SOS  , CC_ID, SDATE, RNK  , USER_ID, NMK  , SAB, CUSTTYPE,  
							        NLS36, OST36, NLS26, KV26, OST26, WDATE, ACC26, SA , PST36, PRZ_B, 
							        NLS_D, OST_D, BRANCH, NLS_P, OST_P
							 INTO  :T0.ND,   :T0.SOS,   :T0.CC_ID,:T0.DAT1,  :T0.RNK, :T0.USER_ID,:T0.NMK,   :T0.SAB  ,:T0.TYP, 
							       :T0.NLS36,:T0.OSTS36,:T0.NLS26,:T0.KV26,:T0.OSTS26,:T0.DAT4,:T0.ACC_26,:T0.AVANS,:T0.OSTP36,:T0.PRZ,
							       :T0.NLS_D,:T0.OST_D,:T0.BRANCH, :T0.NLS_P,:T0.OST_P
							 FROM ( SELECT e.ND,   e.SOS,  e.CC_ID,    e.SDATE,   e.RNK,  e.USER_ID, c.NMK, c.SAB, c.CUSTTYPE, 
							               to_number(a36.nls) NLS36, 
							               a36.ostc/100       OST36,
							               a36.ostb/100       PST36,
							               to_number(a26.nls) NLS26,  a26.kv KV26,
							               a26.ostc/100 OST26,
							               to_number(d.nls) NLS_D, 
							               d.ostc/100       OST_D, 
							               to_number(p.nls) NLS_P, 
							               p.ostc/100       OST_P, 
							               e.WDATE,                
							               a26.ACC ACC26, NVL(e.SA,0)/100 SA,
							               decode(a26.dazs,NULL,
							                      decode(a26.blkd,0,a26.blkk,a26.blkd),1) PRZ_B, e.branch BRANCH 
							        FROM e_deal e, customer c, accounts a36, accounts a26, 
							             accounts d , accounts p
							        WHERE e.rnk=c.rnk and 
							              a36.kv(+)=:T0.n980 and a36.nls(+) = e.nls36 and
							              d.kv(+)=:T0.n980 and d.nls(+) = e.nls_d and
							              p.kv(+)=:T0.n980 and p.nls(+) = e.nls_p 
							            --  and a26.kv=e.kv26 and a26.nls=e.nls26
							              and a26.acc=e.acc26 "
							              ||T0.WHE0|| T0.sWHERE || T0.WHE1 ||"
							       ) E_DEA "
					! Set T0.strSqlPopulate =
							"SELECT ND   , SOS  , CC_ID, SDATE, RNK  , USER_ID, NMK  , SAB, CUSTTYPE,  
							        NLS36, OST36, NLS26, OST26, WDATE, DEB_26 , ACC26, SA , PST36, PRZ_B,
							        NLS_D, OST_D
							 INTO  :T0.ND,   :T0.SOS,   :T0.CC_ID,:T0.DAT1,  :T0.RNK, :T0.USER_ID,:T0.NMK,   :T0.SAB  ,:T0.TYP, 
							       :T0.NLS36,:T0.OSTS36,:T0.NLS26,:T0.OSTS26,:T0.DAT4,:T0.DEB_26, :T0.ACC_26,:T0.AVANS,:T0.OSTP36,:T0.PRZ,
							       :T0.NLS_D,:T0.OST_D
							 FROM ( SELECT e.ND,   e.SOS,  e.CC_ID,    e.SDATE,   e.RNK,  e.USER_ID, c.NMK, c.SAB, c.CUSTTYPE, 
							               to_number(a36.nls) NLS36, 
							               a36.ostc/100       OST36,
							               a36.ostb/100       PST36,
							               to_number(a26.nls) NLS26, 
							               a26.ostc/100 OST26,
							               to_number(d.nls) NLS_D, 
							               d.ostc/100       OST_D, 
							               e.WDATE, 
							               substr(NVL(w.value,'Y'),1,1) DEB_26,  
							               a26.ACC ACC26, NVL(e.SA,0)/100 SA,
							               decode(a26.dazs,NULL,
							                      decode(a26.blkd,0,a26.blkk,a26.blkd),1) PRZ_B
							        FROM e_deal e, customer c, accounts a36, accounts a26, CUSTOMERW w,
							             accounts d 
							        WHERE  w.tag (+)='Y_ELT' and w.rnk(+)=c.rnk and e.rnk=c.rnk and 
							              a36.kv(+)=:T0.n980 and a36.nls(+) = e.nls36 and
							              d.kv(+)=:T0.n980 and d.nls(+) = e.nls_d and
							              a26.kv=:T0.n980 and a26.nls=e.nls26 "
							              ||T0.WHE0|| T0.sWHERE ||"
							       ) E_DEA "
					If sf != ""
						Set T0.strSqlPopulate = T0.strSqlPopulate || " WHERE "|| T0.sf 
					Set T0.strSqlPopulate = T0.strSqlPopulate || T0.ORD
					Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
					Call SalTblPopulate(hWndForm, hSql(), T0.strSqlPopulate, TBL_FillAll)
					Call SalTblSetContext(hWndForm, 0)
					Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
					Call SalWaitCursor(FALSE)
				Else
					Call SalDestroyWindow(hWndForm)
			On UM_Insert
				Call SalSendClassMessage(UM_Insert, 0, 0)
				Call SalSendMsg( T0.NMK, SAM_DoubleClick, 0, 0 )
			On UM_CreateDoc
				Call SalModalDialog( dlg_CreateDoc, hWndForm, T0.ND, 100 )
	Table Window: T1
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Угода на електронні послуги 
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.1"
				Top:    0.917"
				Width:  16.65"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: 500
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: 0.69"
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 45451
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 45452
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? No
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.8"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 45453
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbDoc
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: cTBarButton
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.233"
						Top:    0.06"
						Width:  0.433"
						Width Editable? Class Default
						Height: 0.321"
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name: \BARS98\RESOURCE\BMP\Tomail.bmp
					Picture Transparent Color: Gray
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Документи угоди'
						On SAM_Click
							If ND != NUMBER_Null
								Call cdoc_ShowAllDocs( ND, hWndForm )
				Pushbutton: pb2 ! Паспорт клиента
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbGetValue
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.8"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Create
							Set strTip = 'Паспорт клієнта'
						On SAM_Click
							If T1.RNK != NUMBER_Null
								If T1.TYP=2
									Call EditCustCorps( T1.RNK, CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
								Else If T1.TYP=3
									Call EditCustPerson( T1.RNK, CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
								Else If T1.TYP=1
									Call EditCustBanks( T1.RNK, CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
				Data Field: dNMK
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   0.05"
							Top:    0.381"
							Width:  2.85"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Клієнт') 
				Data Field: dCC_ID
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   2.9"
							Top:    0.381"
							Width:  1.733"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Угода') 
				Data Field: dNLS36
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   4.633"
							Top:    0.381"
							Width:  1.85"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Рах.авансової сплати') 
				Data Field: dKOL_
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   5.717"
							Top:    0.107"
							Width:  0.767"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Кількість роб.днів в місяці')
				Data Field: dOST36
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.483"
							Top:    0.381"
							Width:  1.733"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Фактична сума авансової сплати') 
				Data Field: dAVANS
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Number
						Editable? No
					Display Settings
						Window Location and Size
							Left:   6.483"
							Top:    0.119"
							Width:  1.733"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Right
						Format: Decimal
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Розрахункова сума авансової сплати') 
				Data Field: dNMS36
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: String
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.217"
							Top:    0.381"
							Width:  2.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Left
						Format: Unformatted
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Назва рах.')
				Data Field: dDAT4
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class:
					Property Template:
					Class DLL Name:
					Data
						Maximum Data Length: Default
						Data Type: Date/Time
						Editable? No
					Display Settings
						Window Location and Size
							Left:   8.217"
							Top:    0.119"
							Width:  2.6"
							Width Editable? Yes
							Height: 0.25"
							Height Editable? Yes
						Visible? Yes
						Border? Yes
						Justify: Center
						Format: Date
						Country: Default
						Font Name: Default
						Font Size: Default
						Font Enhancement: Default
						Text Color: Default
						Background Color: Default
						Input Mask: Unformatted
					Message Actions
						On SAM_TooltipSetText
							Return XSalTooltipSetText( lParam, 'Дата попереднього розрахунку')
		Contents
			Column: OTM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вкл
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Center
				Width:  0.417"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_AnyEdit
						If OTM=1 
							Set DAT_BEG=GetBankDate()
							Set DAT_END=DATETIME_Null
						If OTM=0 
							Set DAT_END=GetBankDate()
			Column: ID    
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код 
						послуги
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.683"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NAME  
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Назва
						послуги
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  2.05"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT_BEG 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Підключено
						послугу
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  Default
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DAT_END 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Відключено
						послугу
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  Default
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set DAT4_old = DAT_END
					On SAM_Validate
						If DAT_END < DAT_BEG and DAT_END != DATETIME_Null
							Set DAT_END = DAT4_old
							Call SalMessageBox( "Дата завершення менша Дати початку ", "Увага ! Помилка.",  MB_IconStop)
							Return VALIDATE_Cancel
			Column: KOL1 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Кіл-сть 
						днів 
						корист
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.683"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Розрах.
						сумма
						за послугу
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.4"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SUMT_ALL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Заг.Тариф 
						за послугу
						в цілому
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.383"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SUMT1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Інд.Тариф 
						за послугу 
						в 1 док
				Visible? No
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.25"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						Set SUMT1_100 = SUMT1 * 100
			Column: SUMT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Інд.Тариф 
						за послугу
						в цілому
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.4"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If SUMT = NUMBER_Null
							Set SUMT_100 = NUMBER_Null
						Else
							Set SUMT_100 = SUMT * 100
			Column: DAT_IB 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Підключено
						інд. тариф
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  Default
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If DAT_IB != DATETIME_Null
							Set DAT_IB = SalDateMonthBegin( DAT_IB)
			Column: DAT_IE 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Відмінено
						інд. тариф
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  Default
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_SetFocus
						Set DAT4_old = DAT_IE
					On SAM_Validate
						If DAT_IE < DAT_IB and DAT_IE != DATETIME_Null
							Set DAT_IE = DAT4_old
							Call SalMessageBox( "Дата завершення менша Дати початку ", "Увага ! Помилка.",  MB_IconStop)
							Return VALIDATE_Cancel
						Else If DAT_IE != DATETIME_Null
							Set DAT_IE = AddMonths(DAT_IE,1)
							Set DAT_IE = DAT_IE - SalDateDay(DAT_IE)
			Column: SUMT_100
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Інд.Тариф 
						за послугу
						в цілому
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.4"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SUMT1_100
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Інд.Тариф 
						за послугу 
						в 1 док
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.25"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: SUMT1_ALL
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Заг.Тариф 
						за послугу 
						в 1 док
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.267"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OLD 
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title:
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.683"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S_NADX
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сума 
						надхожень
						
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.4"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If SUMT = NUMBER_Null
							Set SUMT_100 = NUMBER_Null
						Else
							Set SUMT_100 = SUMT * 100
			Column: S_TAR1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тариф 1
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.4"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If SUMT = NUMBER_Null
							Set SUMT_100 = NUMBER_Null
						Else
							Set SUMT_100 = SUMT * 100
			Column: S_TAR2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тариф 2
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  1.4"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Validate
						If SUMT = NUMBER_Null
							Set SUMT_100 = NUMBER_Null
						Else
							Set SUMT_100 = SUMT * 100
		Functions
		Window Parameters
			Number: U
			Number: ND
			Number: RNK
			Number: TYP
			String: NMK
			String: CC_ID
			Number: NLS36
			Date/Time: DAT4
			Date/Time: DAT1_
			Date/Time: DAT2_
			Number: KOL_
		Window Variables
			Number: nRow
			Number: n980
			Boolean: FL_
			Date/Time: DAT4_old
		Message Actions
			On SAM_Create
				! Call DebugN(T1.U)
				Call PrepareWindow( hWndForm )
				If T1.U = 3 or T1.U = 31
					Call SalDisableWindow( pbIns )
					Call SalDisableWindow( pbDel )
					Call SalDisableWindow( pbUpdate )
					Call SalDisableWindow( pbDoc )
				Set T1.dNMK  = T1.NMK
				Set T1.dCC_ID= T1.CC_ID
				Set T1.dNLS36= T1.NLS36
				Set T1.dKOL_ = T1.KOL_
				Set T1.dDAT4 = T1.DAT4
				Set T1.nTabInstance = 1
				Set T1.n980  = GetBaseVal()
				Call SetWindowFullSize(hWndForm)
				! Call SalTblSetLockedColumns( hWndForm, 1 )
				Set T1.strPrintFileName = 'E_'||Str(T1.ND)
				!
				Set T1.strSqlInsert = 
						"Insert into e_tar_nd (ND, ID, OTM, DAT_BEG, DAT_END, SUMT, SUMT1, DAT_LB, DAT_LE ) values 
						(:T1.ND, :T1.ID,  :T1.OTM, :T1.DAT_BEG, :T1.DAT_END, :T1.SUMT_100, :T1.SUMT1_100, :T1.DAT_IB, :T1.DAT_IE )"
				!
				Set T1.strSqlDelete = 
						 "delete from e_tar_nd where nd=:T1.ND and id=:T1.ID and nvl(otm,0)=0 "
				!
				Set T1.strSqlUpdate =
						 "update e_tar_nd set   otm =:T1.OTM, 
						    SUMT =:T1.SUMT_100, dat_end=:T1.DAT_END, SUMT1 =:T1.SUMT1_100, dat_beg=:T1.DAT_BEG,
						    dat_LB=:T1.DAT_IB, dat_LE=:T1.DAT_IE, S_POROG=:T1.S_NADX, S_TAR_POR1=:T1.S_TAR1, S_TAR_POR2=:T1.S_TAR2
						  Where ND =:T1.ND and ID=:T1.ID " 
				!
				Set T1.FL_ = FALSE
				Set T1.strSqlPopulate =
						"SELECT nvl(n.otm,0), e.id, e.name, n.DAT_BEG, n.DAT_END, 
						        elt.RAB_DNI1( greatest(n.DAT_BEG,                :T1.DAT1_ ), 
						                      least   (nvl(n.DAT_END,:T1.DAT2_ ),:T1.DAT2_ ),
						                      :T1.dKOL_ ),
						        n.sumt/100, n.sumt1/100, n.sumt, n.sumt1, e.sumt/100, e.sumt1/100,
						        nvl(n.nd,0), n.dat_lb, n.dat_le, n.S_POROG, n.S_TAR_POR1, n.S_TAR_POR2       
						 INTO :T1.OTM, :T1.ID,  :T1.NAME, :T1.DAT_BEG, :T1.DAT_END, :T1.KOL1,
						      :T1.SUMT, :T1.SUMT1, :T1.SUMT_100, :T1.SUMT1_100,:T1.SUMT_ALL,:T1.SUMT1_ALL,:T1.OLD,
						      :T1.DAT_IB, :T1.DAT_IE , :T1.S_NADX,  :T1.S_TAR1 ,  :T1.S_TAR2
						 FROM e_tar_nd n, e_tarif e	
						 WHERE n.nd(+)=:T1.ND and n.id(+)=e.id 
						 ORDER BY nvl(n.nd,0) desc, e.id, n.dat_beg desc "
				!
				Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Update
				Call SalWaitCursor(TRUE)
				! удаление 
				Call SqlPrepare( hSql(), T1.strSqlDelete )
				Call SalTblDoDeletes( hWndForm, hSql(), ROW_MarkDeleted )
				! корр и вставка
				Set T1.nRow = TBL_MinRow
				While SalTblFindNextRow( hWndForm, T1.nRow,  ROW_Edited, 0 )
					Call SalTblSetContext( hWndForm, T1.nRow )
					Call SqlPrepareAndExecute( hSql(), IifS ( T1.OLD >0, T1.strSqlUpdate, T1.strSqlInsert ) )
				Call SqlCommit(hSql())
				Set T1.FL_ = TRUE
				Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
				Call SalWaitCursor(FALSE)
			On UM_Populate
				If SqlPrepareAndExecute( hSql(), 
						  "SELECT nms, ostc/100 INTO :T1.dNMS36, :T1.dOST36 from accounts where nls=:T1.NLS36 and kv=:T1.n980 ")
						and not SqlFetchNext( hSql(), nFetchRes ) 
					Set T1.dNMS36 = 'Рах.НЕ відкрито !' 
				!
				If T1.KOL_ >0 and T1.DAT1_> T1.DAT4 and SqlPrepareAndExecute( hSql(), 
						  "SELECT elt.ROZ_AV (:T1.DAT1_, :T1.DAT2_, :T1.KOL_, :T1.ND) INTO :T1.dAVANS FROM  dual ")
						and not SqlFetchNext( hSql(), nFetchRes ) 
					Set T1.dAVANS = 0 
				If T1.FL_ 
					Set T1.FL_ = FALSE
					If SqlPrepareAndExecute( hSql(), "UPDATE e_deal set SA = :T1.dAVANS where nd =:T1.ND ")
						Call SqlCommit( hSql() )
				Set T1.dAVANS = T1.dAVANS / 100
				Call SalSendClassMessage(UM_Populate, 0, 0)
			On SAM_FetchRowDone
				! If T1.OLD >0 and T1.DAT1_> T1.DAT4 
					                                                                                Set T1.S = IifN(T1.SUMT=NUMBER_Null,T1.SUMT_ALL, T1.SUMT ) * T1.KOL1 / T1.KOL_
				If T1.OLD >0 and T1.DAT1_> T1.DAT4 
						and SqlPrepareAndExecute( hSqlAux2(), 
						  "SELECT ELT.tarif (:T1.DAT1_, :T1.DAT2_, :T1.ND, :T1.ID)  INTO :T1.S FROM  dual ")
						and SqlFetchNext(hSqlAux2(),  nFetchRes ) 
					Set T1.S = T1.S * 0.01 * T1.KOL1 / T1.KOL_
				If T1.OLD =0  
					Call XSalTblSetRowBackColor( hWndForm, lParam,  SalColorFromRGB( 230,255,230 )  ) ! бледно-зелен
				Else If T1.DAT_END != DATETIME_Null and T1.OTM=0
					Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_LightGray ) ! серый
	Table Window: T2
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Протокол неуспешных проводок
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   1.925"
				Top:    1.604"
				Width:  10.967"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 15889
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   2.7"
						Top:    0.071"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   3.35"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 15890
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   4.0"
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 15891
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: ID
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: DK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: DK
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.833"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSA
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет-А
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.383"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLSB
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счет-Б
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.383"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: S
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Сумма
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.933"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: TXT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Подробнее о транзакции
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  3.917"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
		Window Variables
			Date/Time: DAT
		Message Actions
			On SAM_Create
				Call SalWaitCursor(TRUE)
				Set T2.DAT=GetBankDate()
				! If SqlPLSQLCommand(hSql(),  "BARS.FINIS_P(DAT)")
				Set T2.strPrintFileName = 'T2'
				Set T2.strFilterTblName = 'TMP_OVR'
				Set T2.strSqlPopulate =
						"SELECT DK, NLSA, NLSB, S/100, txt
						 INTO  :T2.DK, :T2.NLSA, :T2.NLSB, :T2.S, :T2.TXT
						 FROM tmp_ovr where dat=:T2.DAT and id=36
						 ORDER BY  1,2,3 "
				Call SalSendClassMessage(SAM_Create, 0, 0)
	Table Window: VPR
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Ручне підкріплення та зняття надлишків позасистемної ВАЛ ПОЗ
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  9.967"
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 57413
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 57414
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 57415
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: FDAT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Дата
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Date/Time
				Justify: Center
				Width:  Default
				Width Editable? Yes
				Format: Date
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: NLS
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Позасистемний
						рахунок
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Left
				Width:  1.517"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Вал
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.767"
				Width Editable? Yes
				Format: #0
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OST
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Залишок
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.4"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: OBO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Підкріпити (+)
						надлишки (-)
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  2.183"
				Width Editable? Yes
				Format: Decimal
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Number: nRow
			Number: nRef
			Number: nOBO
			Number: nDK
			Date/Time: bDat
			String: sNazn
			String: sVP
			String: sKS
			: cDoc
				Class: cDoc
		Message Actions
			On SAM_Create
				Call PrepareWindow( hWndForm )
				Call SetWindowFullSize(hWndForm)
				Set VPR.nTabInstance = 1
				Set VPR.strFilterTblName = 'SAL'
				Set VPR.bDat = GetBankDate()
				If SqlPrepareAndExecute( hSql(), "SELECT  nlsm, nlsk into :sKS, :sVP from tts where tt='VPR'" )
						and SqlFetchNext( hSql(), nFetchRes )
					!
					Set VPR.strSqlPopulate =
							"SELECT fdat, nls, kv, ost/100 INTO :VPR.FDAT, :VPR.NLS, :VPR.KV, :VPR.OST
							 from sal where nls='"|| sVP ||"' and fdat >=to_date('01-01-2004' ,'dd-mm-yyyy') 
							 ORDER BY fdat desc, kv desc "
					!
					Call SalSendClassMessage(SAM_Create, 0, 0)
			On UM_Update
				Call SalWaitCursor(TRUE)
				! корр 
				Set VPR.nRow = TBL_MinRow
				While SalTblFindNextRow( hWndForm, VPR.nRow,  ROW_Edited, 0 )
					Call SalTblSetContext( hWndForm, VPR.nRow )
					If VPR.OBO !=NUMBER_Null and VPR.OBO !=0
						If VPR.OBO >0
							Set nDK = 1
							Set sNazn = "Підкріплення позасист.ВП "
						Else
							Set nDK = 0
							Set sNazn = "Зняття надлишків позасист.ВП "
						Set nOBO = SalNumberAbs( OBO  ) * 100
						Call Pl_dat(VPR.FDAT)
						Call cDoc.SetDoc(nRef, 'VPR', nDK, 6, STRING_Null,  FDAT, FDAT, FDAT, FDAT,
								     sKS, '', GetBankMfo(), '', KV, nOBO , '',
								     sVP, '', GetBankMfo(), '', KV, nOBO , '',
								     sNazn, '', GetIdOper(), '', NUMBER_Null, 0)
						If cDoc.oDoc() 
							Set nRef = cDoc.m_nRef
							If SqlPLSQLCommand(hSql(),
									"gl.PAY(2, nRef, FDAT, 
									 STRING_Null, NUMBER_Null, NUMBER_Null, STRING_Null, NUMBER_Null, NUMBER_Null, STRING_Null )" )
								Call SqlCommit(hSql())
							Else
								Call SqlRollback(hSql())
							Call Pl_dat(VPR.bDat)
				Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
				Call SalWaitCursor(FALSE)
			On UM_Close
				Call Pl_dat(VPR.bDat)
				Call SalSendClassMessage(UM_Close, 0, 0)
	Form Window: DS
		Class:
		Property Template:
		Class DLL Name:
		Title: Расчет стоимости денег с учетом реинвестиций на одинаковых условиях
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Etched
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.35"
				Top:    0.688"
				Width:  14.717"
				Width Editable? Yes
				Height: 6.19"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Frame
				Resource Id: 41544
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.017"
					Top:    0.036"
					Width:  5.967"
					Width Editable? Yes
					Height: 0.667"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Raised-Shadow
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Data Field: RATE_
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.233"
						Top:    0.083"
						Width:  0.767"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Create
						Set RATE_ = 2
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Годовая % ставка (купона)')
			Combo Box: cmbBasey
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   1.017"
					Top:    0.083"
					Width:  1.483"
					Width Editable? Class Default
					Height: 0.881"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: 35
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						Call cmbBasey.Init(hWndItem)
						Call cmbBasey.Populate(hSql(), "BASEY", "NAME", "BASEY", " ORDER BY BASEY ")
					On SAM_Click
						Set nBasey = cmbBasey.GetKey( SalListQuerySelection(hWndItem))
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, '% база' )
			Data Field: DATK_
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.517"
						Top:    0.083"
						Width:  1.433"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Create
						Set DATK_ = AddMonths( GetBankDate(), -1 )
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата последней выплаты %(Купона)')
			Data Field: MES_
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.967"
						Top:    0.083"
						Width:  0.467"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Create
						Set MES_ = 1
						Set n_  = 12
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Процентный(купонный) период в месяцах')
					On SAM_Validate
						Set n_ = 12 / MES_
			Data Field: n_
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.967"
						Top:    0.321"
						Width:  0.467"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Частота выпл.%(раз в году')
			Data Field: DATP_
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   4.433"
						Top:    0.083"
						Width:  1.433"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Create
						Set DATP_ = AddMonths( GetBankDate(), 12 )
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата погашения')
			!
			Frame
				Resource Id: 41545
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   6.133"
					Top:    0.036"
					Width:  5.833"
					Width Editable? Yes
					Height: 0.667"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Raised-Shadow
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Data Field: K_
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.167"
						Top:    0.083"
						Width:  1.883"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Right
					Format: Decimal
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Create
						Set K_ = 100000
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Первичный капитал (номинал)')
			Data Field: DATR_
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   8.05"
						Top:    0.083"
						Width:  1.433"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата размещения (интервал - С)')
					On SAM_Create
						Set DATR_  =  GetBankDate()
						Set DATR1_ =  AddMonths( DATR_, 12 )
			Data Field: DATR1_
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Date/Time
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   9.483"
						Top:    0.083"
						Width:  1.433"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Center
					Format: Date
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_TooltipSetText
						Return XSalTooltipSetText( lParam, 'Дата размещения (интервал - По)')
			Radio Button: rbD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: День
				Window Location and Size
					Left:   6.983"
					Top:    0.369"
					Width:  1.067"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Radio Button: rbM
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Месяц
				Window Location and Size
					Left:   8.417"
					Top:    0.369"
					Width:  1.067"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Pushbutton: pb2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbOk
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   10.483"
					Top:    0.333"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						Set strTip = 'Выполнить расчет в периоде '
					On SAM_Click
						Call tb1.F_DS()
			!
			Child Table: tb1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.25"
						Top:    0.821"
						Width:  4.767"
						Width Editable? Yes
						Height: 4.333"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 366
					Discardable? Yes
				Contents
					Column: DAT_
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Дата
								разм.
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Center
						Width:  1.067"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: FV_
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: FV
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.683"
						Width Editable? Yes
						Format: #00000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: PV_
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: PV
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.75"
						Width Editable? Yes
						Format: #00000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: SD_
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Стоимость
								в дату погаш
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  1.4"
						Width Editable? Yes
						Format: Decimal
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: t_
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: t
						Visible? No
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Right
						Width:  0.467"
						Width Editable? Yes
						Format: #00000
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
					Function: F_DS
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							Date/Time: dDat
							Number: nSD
							Number: nK
							Number: r_
							Boolean: FL
							String: sTmp
						Actions
							If RATE_ = NUMBER_Null
								Set RATE_ = 0
							Set r_ = RATE_ / 100
							If DATR_ >= DATP_ or DATR1_ > DATP_ or RATE_ < 0 or MES_ < 0 or K_ <= 0 
								Return FALSE
							! !!!!!!!!!
							Call SalTblReset( tb1 )
							Set dDat = DATR_
							Set FL = TRUE
							Set nMin = 1 
							Set nMax = 1
							Set nK = K_ * 100
							While dDat <= DATR1_
								Call SalTblSetContext( tb1, SalTblInsertRow( tb1, TBL_MaxRow) )
								If FALSE
									Call SqlPLSQLCommand(hSql(),"BARS.DISKO_ST (nK, dDat, DATP_, RATE_, nBasey, DATK_, MES_, nSD )" )
									Set FV_ =  nSD  / nK
								Else
									Set t_ = (DATP_ - dDat) / 365
									Set FV_ =SalNumberPower( 1 + r_/n_, n_*t_ )
									Set nSD = nK * FV_
								!
								Set PV_ = 1/ FV_
								Set nMin = SalNumberMin( nMin, PV_ )
								Set nMax = SalNumberMax( nMax, FV_ )
								If rbM
									Set sTmp = SalFmtFormatDateTime( dDat, "MM/yy" )
									Set dDat = AddMonths( dDat, 1 )
								Else
									Set sTmp = SalFmtFormatDateTime( dDat, "dd/MM" )
									Set dDat = dDat + 1
								Set tb1.SD_ = nSD / 100
								Set tb1.DAT_ =  Subs(sTmp,1,5)
							Call SqlRollback(hSql())
							If FL 
								Set ccGraphD.Graph.GraphType = 6
								Set ccGraphD.Graph.YAxisStyle[0] = 2
								Set ccGraphD.Graph.YAxisTicks[0] = 4
								Set ccGraphD.Graph.YAxisMin[0] = nMin
								Set ccGraphD.Graph.YAxisMax[0] = nMax
								! Set ccGraphD.Graph.GraphTitle = dlg_Ind.tblInd.colMPok || '   ' || dlg_Ind.tblInd.colName
								! Set ccGraphD.Graph.LegendPos = 2
								Set ccGraphD.Graph.Background[0] = 7
								Set ccGraphD.Graph.Background[1] = 7
								Set ccGraphD.Graph.Background[6] = 7
								Set ccGraphD.Graph.DrawMode = 2
								Call ccGraphD.Draw()
				Window Variables
				Message Actions
			Custom Control: ccGraphD
.data CLASSPROPSSIZE
0000: 7D19
.enddata
.data CLASSPROPS
0000: 534F555243450004 0074623100004772 6170685370656300 4C19900100000000
0020: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
00E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0160: 0000000000000000 0000000000000200 0000320000000000 0000030000000100
0180: 0000000000000000 0000010000000200 0000030000004172 69616C0000000000
01A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
01C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
01E0: 0000000000004172 69616C0000000000 0000000000000000 0000000000000000
0200: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0220: 0000000000000000 0000000000000000 0000000000004172 69616C0000000000
0240: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0280: 0000000000004172 69616C0000000000 0000000000000000 0000000000000000
02A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
02C0: 0000000000000000 0000000000000000 000000000000C800 0000960000006400
02E0: 0000640000000000 0000000000000000 0000000000000000 0000000000000000
0300: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0340: 0000000000000000 0000000000000600 0000000000000000 0000000000000000
0360: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
03E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0400: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0480: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
04E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0540: 0000000000000000 0000000000000000 0000000000000000 0000000000000100
0560: 0000010000000000 0000000000000000 0000000000000000 0000000000000000
0580: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
05C0: 0000050000000200 0000000000000000 0000000000000000 0000000000000000
05E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0600: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0620: 0000000000003200 0000000000001E00 0000000000000000 0000000000000000
0640: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0660: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0680: 0000000000000000 0000640000000100 0000010000000100 0000030000000100
06A0: 0000000000000000 0000000000000000 0000010000000000 0000000000000000
06C0: 0000000000000000 0000000000000000 0000000000000000 0000000000007462
06E0: 3100000000000000 0000000000000000 0000000000000000 0000000000000000
0700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0720: 0000000000000000 0000000000000200 000050565F000000 0000000000000000
0740: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0780: 000046565F000000 0000000000000000 0000000000000000 0000000000000000
07A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
07E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0820: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0840: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0860: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0880: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
08E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0900: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0920: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0940: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0960: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0980: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
09E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0A80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0AE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0B80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0BE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0C80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0CE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0D60: 0000000000000000 0000000000000000 0000505600000000 0000000000000000
0D80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0DC0: 0000465600000000 0000000000000000 0000000000000000 0000000000000000
0DE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0E80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0EE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F00: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F20: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F40: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F60: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0F80: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FA0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FC0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
0FE0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1000: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1020: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1040: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1060: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1080: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
10E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1100: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1120: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1140: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1160: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1180: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
11E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1200: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1220: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1240: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1260: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1280: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
12E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1300: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1320: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1340: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1360: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1380: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13A0: 0000000000000000 0000000000000000 00004441545F0000 0000000000000000
13C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
13E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1400: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1420: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1440: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1460: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1480: 0000000000000000 0000010000000000 0000000000000000 0000000000000000
14A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
14E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1500: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1520: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1540: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1560: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1580: 0000000000000000 0000000000000000 000007000000FFFF FFFFFFFFFFFFFFFF
15A0: FFFFFFFFFFFFFFFF FFFFFFFFFFFF1000 0000100000001000 0000100000001000
15C0: 0000100000001000 0000100000001000 0000100000001000 0000100000001000
15E0: 0000100000000000 0000000000000000 0000000000000000 0000000000000000
1600: 0000000000000100 0000010000000000 0000000000000000 0000000000000000
1620: 0000000000000000 0000FFFFFFFF0000 0000FFFFFFFF0000 0000000000000000
1640: 0000000000000000 0000000000000000 0000000000004752 4150485050522E48
1660: 4C50000000000000 0000000000000000 0000000000000000 0000000000000000
1680: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
16E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1700: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1720: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1740: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1760: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1780: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
17E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1800: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1820: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1840: 0000000000000000 0000000000000000 0000000000000000 0000000000000100
1860: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1880: 0000000000000100 0000477261706820 436F6E74726F6C00 0000000000000000
18A0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
18C0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
18E0: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1900: 0000000000000000 0000000000000000 0000000000000000 0000000000000000
1920: 0000000000000000 0000000000000000 00000F0000000000 0000080000006400
1940: 0000140000001400 0000000000000000 0000000000000000 0000000000000000
1960: 0000010000000049 54454D0008005056 5F2C46565F000000 0000000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cQuickGraph
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   5.083"
						Top:    0.75"
						Width:  8.883"
						Width Editable? Class Default
						Height: 4.381"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
		Functions
		Window Parameters
			Number: nPar
			String: strPar01
			String: strPar02
		Window Variables
			Number: nBasey
			Number: nMax
			Number: nMin
		Message Actions
			On SAM_Create
				Set rbM = TRUE
				Set rbD = FALSE
