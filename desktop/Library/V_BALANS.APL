.head 0 +  Application Description: ! ООО "Унити-Барс" (C) 1996-2000
! Разработчик: Сухова
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000BC0000 002C000000020000 0003000000000000 0077020000F8FFFF
0040: FFE2FFFFFFFFFFFF FF000000007C0200 004D010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D01000000075769 6E646F7773
.enddata
.data DT_MAKERUNDLG
0000: 02000000001D513A 5C4241525339385C 4C4942524152595C 4E414C5F4445432E
0020: 6578651D513A5C42 41525339385C4C49 42524152595C4E41 4C5F4445432E646C
0040: 6C1D513A5C424152 5339385C4C494252 4152595C4E414C5F 4445432E61706300
0060: 000101011D513A5C 4241525339385C4C 4942524152595C4E 414C5F4445432E72
0080: 756E1D513A5C4241 525339385C4C4942 524152595C4E414C 5F4445432E646C6C
00A0: 1D513A5C42415253 39385C4C49425241 52595C4E414C5F44 45432E6170630000
00C0: 010101185C424152 5339385C42494E5C 765F62616C616E73 2E617064175C4241
00E0: 525339385C42494E 5C4E414C5F444543 2E646C6C175C4241 525339385C42494E
0100: 5C4E414C5F444543 2E61706300010101 011D513A5C424152 5339385C4C494252
0120: 4152595C4E414C5F 4445432E61706C1D 513A5C4241525339 385C4C4942524152
0140: 595C4E414C5F4445 432E646C6C1D513A 5C4241525339385C 4C4942524152595C
0160: 4E414C5F4445432E 6170630000010101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0118B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  Dynalib: Docview.apd
.head 2 -  Dynalib: CustAcnt.apd
.head 2 -  Dynalib: Nsiapi.apd
.head 2 -  File Include: Gentbl.apl
.head 2 -  File Include: vttblwin.apl
.head 2 -  File Include: Vtarray.apl
.head 2 -  File Include: Genemnu.apl
.head 2 -  File Include: Genlist.apl
.head 2 -  File Include: Winbars2.apl
.head 2 -  File Include: Xsalcpt.apl
.head 2 -  File Include: XSALIMG.APL
.head 2 -  ! File Include: Vtcal.apl
.head 2 -  File Include: VT.APL
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 -  Formats
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 2 +  Resources
.head 2 +  Variables
.head 3 -  !
.head 3 -  String: gOB22
.head 3 -  Number: nCalId
.head 3 -  Number: nHaveTOBO
.head 3 -  Boolean: bEQV !! - Эквиваленты находястя в SALDOA (НБУ, Казначейство)
.head 3 -  Boolean: bCUR !! - Без валюты (Казначейство)
.head 3 -  Boolean: fInitLib
.head 3 -  Number: nFetchRes
.head 3 -  Window Handle: hWin4
.head 3 -  Window Handle: hWin7 
.head 3 -  ! Window Handle: hWin_RES1 
.head 3 -  Boolean: bShowClient3
.head 2 +  Internal Functions
.head 3 -  !
.head 3 +  Function: Vbalans_ini
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strPathToLangResources
.head 5 -  String: strLangId
.head 5 -  !
.head 5 -  String: strFileName
.head 4 +  Actions
.head 5 -  Set nHaveTOBO = GetGlobalOptionEx('HAVETOBO')
.head 5 +  If NOT fInitLib
.head 6 -  ! bEQV - Эквиваленты находястя в SALDOA (НБУ, Казначейство)
.head 6 -  Set bEQV = SqlPrepareAndExecute(hSqlAux(), "SELECT val FROM params WHERE par='EQV' and val='YES'")
AND SqlFetchNext(hSqlAux(), nFetchRes)
.head 6 -  ! bCUR - Без валюты (Казначейство)
.head 6 -  Set bCUR = SqlPrepareAndExecute(hSqlAux(), "SELECT val FROM params WHERE par='ORGTYPE' and val='KAZNA'")
AND SqlFetchNext(hSqlAux(), nFetchRes)
.head 6 -  !
.head 6 -  Set strPathToLangResources = GetLangPath()
.head 6 -  Set strLangId = GetLang()
.head 6 -  Set strFileName = strPathToLangResources || "\\" || strLangId || "\\vbalans.lng"
.head 6 -  !
.head 6 +  If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
.head 7 -  Call CurrentLangTable.Init()
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('cTAt', 'Внимание!')
.head 7 -  Call CurrentLangTable.AddAtom('cTErr','Ошибка!')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('cTMenu0','С Оборотами')
.head 7 -  Call CurrentLangTable.AddAtom('cTMenu1','С Дебетовыми  об')
.head 7 -  Call CurrentLangTable.AddAtom('cTMenu2','С Кредитовыми об')
.head 7 -  Call CurrentLangTable.AddAtom('cTMenu3','Без Оборотов')
.head 7 -  Call CurrentLangTable.AddAtom('cTMenu4','Активы')
.head 7 -  Call CurrentLangTable.AddAtom('cTMenu5','Пассивы')
.head 7 -  Call CurrentLangTable.AddAtom('cTMenu6','Выйти')
.head 7 -  Call CurrentLangTable.AddAtom('bgF8','F8 - Все счета/с остатками(оборотами)')
.head 7 -  ! ====================================================
.head 7 -  ! GL_tbl1
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl1.cTWndTitle','Cостояние  Б А Л А Н С А (экв.)')
.head 7 -  ! menu
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl1.menuBalans.cTMenuBalans','Баланс')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl1.cBTipComm','Техн.инф.: Эквиваленты')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl1.cbBranch','Отделение')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl1.cbSubBranch','С подчиненными')
.head 7 -  ! Columns
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl1.SB','С~б')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl1.BAL','БАЛ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl1.DOS','Обороты ДЕБЕТ~1')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl1.KOS','Обороты КРЕДИТ~2')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl1.DOSr','Обороты ДЕБЕТ~1'||' real')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl1.KOSr','Обороты КРЕДИТ~2'||' real')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl1.ISD','Исходящий ДЕБЕТ~3')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl1.ISK','Исходящий КРЕДИТ~4')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl1.NAME','Наименование балансового счета~Б')
.head 7 -  ! ====================================================
.head 7 -  ! GL_tbl2
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl2.cTWndTitle1','состояние (экв.) бал.сч.')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl2.cTWndTitle2','по ИСПОЛНИТЕЛЯМ')
.head 7 -  ! menu
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl2.cTMenu','Информация по ИСПОЛНИТЕЛЯМ')
.head 7 -  ! Columns
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl2.BAL','БАЛ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl2.ISP','Исп.')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl2.DOS','Обороты ДЕБЕТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl2.KOS','Обороты КРЕДИТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl2.ISD','Исходящий ДЕБЕТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl2.ISK','Исходящий КРЕДИТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl2.NAME','Наименование исполнителя')
.head 7 -  ! ====================================================
.head 7 -  ! GL_tbl3
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl3.cTWndTitle1','Состояние ЛС (ном)')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl3.cTWndTitle2','БС')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl3.cTWndTitle3','Исп.')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl3.cTWndTitle4','Вал.')
.head 7 -  ! menu
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl3.cTMenu','Информация')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl3.cTMenu0','Выписка за выбранный день...')
.head 7 -  ! Columns
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl3.ISP','Исп.')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl3.NLS','ЛС')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl3.KV', 'ВАЛ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl3.DOSs','Обороты ДЕБЕТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl3.KOSs','Обороты КРЕДИТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl3.ISDs','Исход.ДЕБЕТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl3.ISKs','Исход.КРЕДИТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl3.NAMES','Наименование счета')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl3.NAME','Наименование клиента')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl3.DAZS','Дата закр')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl3.BRANCH','Отделение')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl3.BRANCH_NAME','Наименование отделения')
.head 7 -  ! ====================================================
.head 7 -  ! GL_tbl4
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl4.cTWndTitle1','Cостояние БС (ном)')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl4.cTWndTitle2','по ВАЛЮТАМ')
.head 7 -  ! menu
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl4.cTMenu','Информация по ВАЛЮТАМ')
.head 7 -  ! Columns
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl4.BAL','БАЛ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl4.KV', 'ВАЛ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl4.DOSs','Обороты ДЕБЕТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl4.KOSs','Обороты КРЕДИТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl4.ISDs','Исходящий ДЕБЕТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl4.ISKs','Исходящий КРЕДИТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl4.NAME','Наименование валюты')
.head 7 -  ! ====================================================
.head 7 -  ! GL_tbl5
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl5.cTWndTitle1','Текущее состояние (экв.) балансового счета')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl5.cTWndTitle2','по ДАТАМ')
.head 7 -  ! Columns
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl5.BAL','БАЛ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl5.DAT','Дата')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl5.DOS','Обороты ДЕБЕТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl5.KOS','Обороты КРЕДИТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl5.ISD','Исходящий ДЕБЕТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl5.ISK','Исходящий КРЕДИТ')
.head 7 -  ! ====================================================
.head 7 -  ! GL_tbl6
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl6.cTWndTitle1','Состояние (экв.)  Б А Л А Н С А . Итоги')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl6.cTWndTitle2','уровня')
.head 7 -  ! menu
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl6.cTMenu','Итоги')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl6.cTMenu0','Вперед')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl6.cTMenu1','Назад')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl6.cTMenu2','Обновить')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl6.cTMenu3','Экспорт...')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl6.cTMenu4','Выйти')
.head 7 -  ! Columns
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl6.BAL','БАЛ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl6.DOS','Обороты ДЕБЕТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl6.KOS','Обороты КРЕДИТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl6.ISD','Исходящий ДЕБЕТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl6.ISK','Исходящий КРЕДИТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl6.NAME','Наименование балансового счета')
.head 7 -  ! ====================================================
.head 7 -  ! GL_tbl7
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl7.cTWndTitle1','Cостояние БАЛАНСА в номинале по ОДНОЙ валюте')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl7.cTWndTitle2','Состояние БАЛАНСА в экв. базовой валюты')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl7.cTWndTitle3','Состояние (экв.) БАЛАНСА в альтернативном плане счетов')
.head 7 -  ! Columns
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl7.BAL','БАЛ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl7.DOS','Обороты ДЕБЕТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl7.KOS','Обороты КРЕДИТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl7.ISD','Исходящий ДЕБЕТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl7.ISK','Исходящий КРЕДИТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl7.NAM','Наименование балансового счета')
.head 7 -  ! ====================================================
.head 7 -  ! GL_tbl8
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl8.cTWndTitle','СРЕДНИЙ БАЛАНС ЗА ПЕРИОД')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl8.cTWndTitle1','Среднее состояние')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl8.cTWndTitle2','БАЛАНСА в эквиваленте за период')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl8.cTWndTitle3','с')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl8.cTWndTitle4','по')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl8.cTWndTitle5','Кал')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl8.cTWndTitle6','Банк')
.head 7 -  ! Columns
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl8.BAL','БАЛ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl8.DOS','Обороты ДЕБЕТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl8.KOS','Обороты КРЕДИТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl8.ISD','Исходящий ДЕБЕТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl8.ISK','Исходящий КРЕДИТ')
.head 7 -  Call CurrentLangTable.AddAtom('GL_tbl8.NAM','Наименование балансового счета')
.head 7 -  ! ====================================================
.head 6 -  !
.head 6 -  Set fInitLib = TRUE
.head 5 -  ! Call CurrentLangTable.SaveToFile('C:\\TEMP\\vbalans.lng','RUS')
.head 5 -  Return fInitLib
.head 3 +  Function: Show_Sal_GL		! __exported
.head 4 -  Description: Показать bal
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hW
.head 5 -  Number: nPar
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call Vbalans_ini()
.head 5 -  Set gOB22     = GetGlobalOption  ('OB22')
.head 5 +  If nPar=700 or nPar=800 
.head 6 -  ! Call SalCreateWindow( GAP, hWndMDI, nPar,NUMBER_Null, "",0,"",
FALSE,TRUE,FALSE,FALSE,FALSE,0,"",1,"", DATETIME_Null)
.head 5 +  Else If nPar=710
.head 6 -  ! Call SalCreateWindow( TRA, hWndMDI, nPar,NUMBER_Null, "",0,"",TRUE,FALSE,FALSE,FALSE,FALSE,"",1,"")
.head 5 +  Else If nPar=720
.head 6 -  ! Call SalCreateWindow( RTA, hWndMDI, nPar,NUMBER_Null, "",0,"",TRUE,FALSE,FALSE,FALSE,FALSE,"",1,"")
.head 5 +  Else If Subs(Str(nPar),1,1)='1' 
OR Subs(Str(nPar),1,1)='2' 
OR Subs(Str(nPar),1,1)='9' 
!! Хождение по балансу 
1 - От всего банка
2 - От всех доступных ТОБО
9 - От текущего ТОБО
.head 6 -  Call SalCreateWindow( GL_tbl1, hWndMDI, nPar )
.head 5 +  Else If nPar=3 or nPar=0
     !! Нормы резервирования (3 -только гол,банк,
                             0 - гол + филиалы)
.head 6 -  Call SalCreateWindow( RZ, hWndMDI, nPar )
.head 5 +  Else If nPar=4 or nPar=42 !! Упрощенный баланс
.head 6 -  Call SalCreateWindow( BS, hWndMDI,nPar)
.head 5 +  Else If nPar=5 !! Бюджет-2
.head 6 -  Call SalCreateWindow( B2, hWndMDI,nPar)
.head 5 +  Else If nPar=6 !! 1_KB
.head 6 -  Call SalCreateWindow(KB1, hWndMDI, 0, DATETIME_Null, '')
.head 5 +  Else If nPar=7 !! AN2. Анализ клиентов (для руководтителя)
.head 6 +  If not IsWindow( hWin7 )
.head 7 -  Set hWin7 = SalCreateWindow( AN2, hWndMDI, 2, '' ,'')
.head 6 +  Else
.head 7 -  Call SalBringWindowToTop ( AN2 )
.head 5 +  Else If nPar=8 !! Средний баланс за период
.head 6 -  Call SalCreateWindow( SBALANS, hWndMDI, nPar )
.head 5 +  ! Else If nPar=2 !! Укрупненный баланс (по образцу Авиатек)
.head 6 -                                                                                                                                                Call SalCreateWindow( KB1, hWndMDI,0,'','' )
.head 3 +  Function: Sel00V		! __exported
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nMode
.head 5 -  Number: nPar
.head 5 -  String: strPar01
.head 5 -  String: strPar02
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call Vbalans_ini()
.head 5 +  Select Case nMode
.head 6 +  Case 3
.head 7 -  Call SalCreateWindow(GL_tbl3, hWndMDI, '', nPar, 0, strPar01, SalFmtFormatStrDateTime(strPar02, 'dd-MM-yyyy'), 1 )
.head 7 -  Break
.head 6 +  Case 4	! ANI-2.Платежный календарь по КС
.head 7 +  ! If not IsWindow(hWin4)
.head 8 -                                                              Set hWin4 = SalCreateWindow(frmKS_PayCalendar, hWndParent, nPar, strPar01, strPar02)
.head 7 +  ! Else
.head 8 -                                                              Call SalBringWindowToTop(hWin4)
.head 7 -  Call SalCreateWindow(frmKS_PayCalendar, hWndParent, nPar, strPar01, strPar02)
.head 7 -  Break
.head 6 +  ! Case 5	! ANI-5.Концентрацiя ресурсiв
.head 7 -                             Call SalCreateWindow
(RES, hWndParent, nMode, nPar, strPar01, strPar02)
.head 7 -  ! Call SalCreateWindow
(RES, hWndParent, nMode, nPar, strPar01, strPar02,
NUMBER_Null,"",0,"",FALSE,TRUE,FALSE,FALSE,FALSE,0,"",1,"")
.head 7 -                             Break 
.head 6 +  ! Case 6	! ANI-6.Var-аналіз
.head 7 -                             Call SalCreateWindow
(VAR, hWndParent, nMode, nPar, strPar01, strPar02)
.head 7 -                             Break 
.head 6 +  Default
.head 7 -  Break
.head 5 +  ! If nMode =3
.head 6 -                                                               Call SalCreateWindow( GL_tbl3, hWndMDI, '', nPar, 0, strPar01, strPar02, 1 )
.head 3 -  !
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 1081538581
0000: E404000018020000 0000000000000000 0200000700FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F22003C00 000A630047656E46
0040: 696C746500727400 00000400001E0002 0400C10001000000 3F8001F800000037
0060: 040001F00D000000 FF1F110000DC0002 00FF7F1570000000 0100FFFF21018022
0080: 000001C200000B63 47F8444669B30004 00770200F601004F 800100FE008D0400
00A0: 010DFD00FF371100 02F700FFDF15DC00 0100FF7F0100808F 0000000200000000
00C0: 0F634465736B7400 6F704C697374426F 10782201000B0000 9E00010DFD00FF27
00E0: 0D000001F700FF1F 1A0000DC000100FF 7F27700000000100 FFFFC13400000001
0100: FD00FF0741000000 01F700FF1F4E0000 DC000100FF7F5B70 0000000100FFFFC1
0120: 6800000001FD00FF 077500000001F700 FF1F820000DC0001 00FF7F0108803400
0140: 0003000000000B63 4469724C691F6C00 00EC000400D9010D 00FF7F0D73000100
0160: FFFFCD1A0001FD00 FF37270001F700FF 1F01802732000004 000F0F547265657C
0180: 4C6952B000000003 0067010D00FFFFCD 0D0001FD00FF371A 0001F700FF1F0180
01A0: 5B02000005000000 0CC8634669654C0F BA000000F2070000 EC010D00FFBF0DB9
01C0: 000100FFFFE61A00 01FE00FF9B270001 FB00FF6F3400EE01 00FFBF41B9000100
01E0: FFFFE64E0001FE00 FF43018041000000 060000000D635261 E064696F4C698386
0200: 000000053D00010D FB00FF4F0D0000EE 0100FFBF1AB90001 00FFFFE6270001FE
0220: 00FF9B340001FB00 FF0F
.enddata
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton: ctb_pbExecute
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box: cCheckBoxLabeled
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box: cGenComboBox_DatId
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control: cCalendar
.head 2 -  Application Actions
.head 1 +  Table Window: GL_tbl1	!! БАЛАНС - эквивалент
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: По БАЛ СЧ
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.088"
.head 4 -  Top:    0.073"
.head 4 -  Width:  16.367"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.464"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 10000
.head 3 -  Discardable? Class Default
.head 2 -  Description: Баланс банка в эквиваленте (показывать с 0/без - F8)
.head 2 +  Named Menus
.head 3 +  Menu: menuBalans
.head 4 -  Resource Id: 9804
.head 4 -  Title: Баланс
.head 4 -  Description:
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Popup Menu: &Разрезы
.head 5 -  Resource Id: 9805
.head 5 -  Enabled when:
.head 5 -  Status Text:
.head 5 -  Menu Item Name:
.head 5 +  Menu Item: TOBO-&Дерево (выбранный день)...
.head 6 -  Resource Id: 9806
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0) 
.head 8 -  Call SalCreateWindow(GL_tbl2t, hWndMDI, BAL, dDAT, mbF[5], sTOBO, 0 )
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: TOBO-ит.&2 ур.(выбранный день)...
.head 6 -  Resource Id: 46470
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0) 
.head 8 -  Call SalCreateWindow(GL_tbl2t, hWndMDI, BAL, dDAT, mbF[5], sTOBO , 2)
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: &Исполнители (выбранный день)...
.head 6 -  Resource Id: 9807
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 8 -  Call SalSendMsg(hWndForm, SAM_DoubleClick, 0, 0)
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: &Валюты (выбранный день)...
.head 6 -  Resource Id: 9808
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 8 -  Call SalCreateWindow(GL_tbl4, hWndMDI, BAL, dDAT, mbF[5], sTOBO)
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: &Даты...
.head 6 -  Resource Id: 9809
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 8 -  Call SalCreateWindow(GL_tbl5, hWndMDI, BAL, dDAT, mbF[5], sTOBO)
.head 6 -  Menu Item Name:
.head 4 +  Popup Menu: &Итоги
.head 5 -  Resource Id: 9810
.head 5 -  Enabled when:
.head 5 -  Status Text:
.head 5 -  Menu Item Name:
.head 5 +  Menu Item: &Классы...
.head 6 -  Resource Id: 9811
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalCreateWindow(GL_tbl6, hWndMDI, '1', dDAT, sTOBO)
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: &Разделы...
.head 6 -  Resource Id: 9812
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalCreateWindow(GL_tbl6, hWndMDI, '2', dDAT, sTOBO)
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: &Группы...
.head 6 -  Resource Id: 9813
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalCreateWindow(GL_tbl6, hWndMDI, '3', dDAT, sTOBO)
.head 6 -  Menu Item Name:
.head 5 -  Menu Separator
.head 5 +  Menu Item: Другая &Базовая валюта...
.head 6 -  Resource Id: 9814
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalCreateWindow(GL_tbl7, hWndMDI, 0, dDAT, '', sTOBO)
.head 6 -  Menu Item Name:
.head 5 -  Menu Separator
.head 5 +  Menu Item: &Альтернат.план счетов...
.head 6 -  Resource Id: 9815
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalCreateWindow(GL_tbl7, hWndMDI, 2, dDAT, '', sTOBO)
.head 6 -  Menu Item Name:
.head 5 -  Menu Separator
.head 5 +  Menu Item: 1_KB...
.head 6 -  Resource Id: 9816
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalCreateWindow(KB1, hWndMDI, 0, dDAT, '')
.head 6 -  Menu Item Name:
.head 5 -  Menu Separator
.head 5 +  Menu Item: Средний баланс за календарный период...
.head 6 -  Resource Id: 9817
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalCreateWindow(GL_tbl8, hWndMDI, dDAT, 'K', sTOBO )
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: Средний баланс за банковский период...
.head 6 -  Resource Id: 9818
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalCreateWindow(GL_tbl8, hWndMDI, dDAT, 'B', sTOBO )
.head 6 -  Menu Item Name:
.head 5 -  Menu Separator
.head 4 +  Popup Menu: &Фильтры
.head 5 -  Resource Id: 9819
.head 5 -  Enabled when:
.head 5 -  Status Text:
.head 5 -  Menu Item Name:
.head 5 +  Menu Item: Об&новить все
.head 6 -  Resource Id: 9820
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Set ss = ""
.head 7 -  Call NASELENIE()
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: С &Оборотами
.head 6 -  Resource Id: 9821
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Set ss = " AND (b.DOSQ>0 OR b.KOSQ>0) "
.head 7 -  Call NASELENIE()
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: С &Дебетовыми  об
.head 6 -  Resource Id: 9822
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Set ss =  " AND (b.DOSQ>0) "
.head 7 -  Call NASELENIE()
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: С &Кредитовыми об
.head 6 -  Resource Id: 9823
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Set ss =  " AND (b.KOSQ>0) " 
.head 7 -  Call NASELENIE()
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: &Без оборотов
.head 6 -  Resource Id: 9824
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Set ss =  " AND (b.DOSQ=0 and b.KOSQ=0) " 
.head 7 -  Call NASELENIE()
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: &Активы
.head 6 -  Resource Id: 9825
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Set ss = "AND (b.OSTD <> 0 ) "
.head 7 -  Call NASELENIE()
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: &Пассивы
.head 6 -  Resource Id: 9826
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Set ss = "AND (b.OSTK<>0) "
.head 7 -  Call NASELENIE()
.head 6 -  Menu Item Name:
.head 5 +  Menu Item: &1 валюта
.head 6 -  Resource Id: 9827
.head 6 -  Keyboard Accelerator: (none)
.head 6 -  Status Text:
.head 6 +  Menu Settings
.head 7 -  Enabled when:
.head 7 -  Checked when:
.head 6 +  Menu Actions
.head 7 -  Call SalCreateWindow(GL_tbl7, hWndMDI, 1, dDAT, '', sTOBO )
.head 6 -  Menu Item Name:
.head 5 +  ! Menu Item: 1 &ТОБО
.head 6 -                                                                                Keyboard Accelerator: (none)
.head 6 -                                                                                Status Text: 
.head 6 +                                                                                Menu Settings 
.head 7 -                                                                                Enabled when: 
.head 7 -                                                                                Checked when: 
.head 6 +                                                                                Menu Actions 
.head 7 -                                                                                Call SalCreateWindow(GL_tbl9, hWndMDI, sDAT )
.head 6 -                                                                                Menu Item Name: 
.head 4 -  Menu Separator
.head 4 +  Menu Item: В&ыйти
.head 5 -  Resource Id: 9828
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 5 -  Menu Item Name:
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.798"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    0.4"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call NASELENIE()
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 9829
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  4.083"
.head 6 -  Begin Y:  0.012"
.head 6 -  End X:  4.083"
.head 6 -  End Y:  0.476"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.55"
.head 6 -  Top:    0.4"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.0"
.head 6 -  Top:    0.4"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SetQueryFilter( cF )
.head 8 -  Call NASELENIE()
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.0"
.head 6 -  Top:    0.4"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 
'Справка о парам. вызова "Бал-Сч-Док"'
.head 6 +  On SAM_Click
.head 7 -  Call SalMessageBox(
"Текущие = " || Str(vPar) || "
Наличие цифры в любой позиции ПОСЛЕ первой означает :
5 - Показавать итог по БС с ps.SB = 'K' (Капитал)
6 - Показавать итог по БС с ps.SB = 'D' (Доход)
7 - Показавать итог по БС с ps.SB = 'R' (Расход)
8 - Показавать итог по БС с ps.SB = 'M' (Меморанд)
9 - Показавать итог по БС с ps.SB = 'V' (Внебаланс
Всегда Показавать итог по БС с ps.SB = 'B' (Баланс)
0 - Не проваливаться в 'Историю счета' и далее
3 - Не показывать 'наименование клиента' в окне 'Счета' 

ПЕРВАЯ цифра в позиции означает Уровень доступа :
1 - весь банк 
2 - все доступные ТОБО с кодом привилегии		 
9 - текущее ТОБО", strTip , 
MB_Ok )
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.45"
.head 6 -  Top:    0.4"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 9830
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.0"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 9831
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  !
.head 4 +  Combo Box: cmbDat
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenComboBox_DatId
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    0.095"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.75"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Editable? Class Default
.head 5 -  String Type: Class Default
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Sorted? Class Default
.head 5 -  Always Show List? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call cmbDat.Init(hWndItem)
.head 7 -  Call cmbDat.Populate(hSql(), "fdat", "to_char(fdat,'dd-MM-yyyy')", "fdat", "ORDER BY fdat desc")
.head 7 +  If bCUR
.head 8 -  Call cmbDat.SetSelectById(dBankDate)
.head 7 +  Else
.head 8 -  Call SalListSetSelect(hWndItem, 0)
.head 7 +  ! If SqlPrepareAndExecute(hSql(),
"SELECT to_char(fdat,'dd-MM-yyyy')
   FROM fdat INTO :sTmp ORDER BY fdat DESC")
.head 8 +              While SqlFetchNext(hSql(), nFetchRes)
.head 9 -              Call SalListAdd(sDAT, sTmp)
.head 8 +              If bCUR
.head 9 -              Call SalListSetSelect(hWndItem, SalListSelectString(sDAT, -1, SalFmtFormatDateTime(GetBankDate(), 'dd-MM-yyyy')))
.head 8 +              Else 
.head 9 -              Call SalListSetSelect(hWndItem, 0)
.head 6 +  On SAM_Click
.head 7 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 7 -  Set dDAT = cmbDat.dtCurrentId
.head 7 -  Call NASELENIE()
.head 6 +  On SAM_SetFocus
.head 7 -  Call SalStatusSetText(hWndForm, 'Выберите дату.')
.head 4 -  Background Text: USD
.head 5 -  Resource Id: 9832
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.6"
.head 6 -  Top:    0.1"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Dark Green
.head 5 -  Background Color: Default
.head 4 +  Data Field: dKurs_840
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.25"
.head 7 -  Top:    0.05"
.head 7 -  Width:  1.3"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Dark Green
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: EUR
.head 5 -  Resource Id: 9833
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.6"
.head 6 -  Top:    0.35"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 4 +  Data Field: dKurs_978
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.25"
.head 7 -  Top:    0.3"
.head 7 -  Width:  1.3"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Blue
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: RUB
.head 5 -  Resource Id: 9834
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.6"
.head 6 -  Top:    0.1"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 4 +  Data Field: dKurs_810
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   5.25"
.head 7 -  Top:    0.05"
.head 7 -  Width:  1.3"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Red
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  Background Text: XDR
.head 5 -  Resource Id: 46469
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.6"
.head 6 -  Top:    0.35"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Marigold
.head 5 -  Background Color: Default
.head 4 +  Data Field: dKurs_960
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   5.25"
.head 7 -  Top:    0.3"
.head 7 -  Width:  1.3"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Marigold
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 -  !
.head 4 -  Line
.head 5 -  Resource Id: 10184
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  6.65"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  6.65"
.head 6 -  End Y:  0.8"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 -  Line
.head 5 -  Resource Id: 10185
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.55"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  2.55"
.head 6 -  End Y:  0.8"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Check Box: cbBranch
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cCheckBoxLabeled
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Отделение
.head 5 -  Window Location and Size
.head 6 -  Left:   6.8"
.head 6 -  Top:    0.1"
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If cbBranch
.head 8 -  Call SalShowWindow(sTOBO)
.head 8 -  Call SalShowWindow(cmbTOBO)
.head 8 -  Call SalShowWindow(pbTOBO)
.head 8 +  If nHaveTOBO = 2
.head 9 -  Call SalShowWindow(cbSubBranch)
.head 7 +  Else
.head 8 -  Set sTOBO = ''
.head 8 -  Set cmbTOBO = ''
.head 8 -  Set cbSubBranch = FALSE
.head 8 -  Set F_Naselenie = TRUE
.head 8 -  Call SalHideWindow(sTOBO)
.head 8 -  Call SalHideWindow(cmbTOBO)
.head 8 -  Call SalHideWindow(pbTOBO)
.head 8 -  Call SalHideWindow(cbSubBranch)
.head 4 +  Check Box: cbSubBranch
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cCheckBoxLabeled
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: С подчиненными
.head 5 -  Window Location and Size
.head 6 -  Left:   6.8"
.head 6 -  Top:    0.35"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set F_Naselenie = TRUE
.head 4 -  !
.head 4 +  Pushbutton: pbTOBO
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65300000
.enddata
.data CLASSPROPSSIZE
0000: 1700
.enddata
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbFilter
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.6"
.head 6 -  Top:    0.0"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Вибрати BRANCH"
.head 6 +  On SAM_Click
.head 7 -  Set sTmp = STRING_Null
.head 7 +  If nParD = 1 ! Все ТОБО банка
.head 8 +  If nHaveTOBO = 2
.head 9 -  Set sTmp = STRING_Null
.head 9 -  Call FunNSIGetFiltered("BRANCH", "NAME", " BRANCH LIKE '" || sUserTOBO || "%' ", sTmp, sTmpN)
.head 8 +  Else
.head 9 -  Call FunNSIGetFiltered("TOBO", "NAME", "",  sTmp, sTmpN)
.head 7 +  Else If nParD = 2 ! Все доступные ТОБО ( не по политикам, а куратортсво) 
.head 8 -  Call FunNSIGetFiltered("TOBO", "NAME", " TOBO in (select TOBO_ID from STAFF_TOBO where addp>1 and USER_ID="||Str(GetUserId()) ||")" , sTmp, sTmpN)
.head 7 +  Else If nParD = 9 ! Только текущее ТОБО
.head 8 +  If nHaveTOBO = 2
.head 9 -  Call FunNSIGetFiltered("BRANCH", "NAME"," BRANCH = '" || sUserTOBO || "'",  sTmp, sTmpN)
.head 8 +  Else
.head 9 -  Call FunNSIGetFiltered("TOBO", "NAME", " TOBO = '" || sUserTOBO || "'" , sTmp, sTmpN)
.head 7 +  If sTmp != STRING_Null
.head 8 -  Set sTOBO = sTmp
.head 8 -  Set cmbTOBO = sTmpN
.head 8 -  Set F_Naselenie = TRUE
.head 4 +  Data Field: sTOBO
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   9.1"
.head 7 -  Top:    0.05"
.head 7 -  Width:  5.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Combo Box: cmbTOBO
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenComboBox_StrId
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.1"
.head 6 -  Top:    0.3"
.head 6 -  Width:  5.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 3.667"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Editable? Class Default
.head 5 -  String Type: Class Default
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Sorted? Class Default
.head 5 -  Always Show List? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call cmbTOBO.Init(hWndItem)
.head 7 +  If nParD = 1 ! Все ТОБО банка
.head 8 +  If nHaveTOBO = 2
.head 9 -  Call cmbTOBO.Populate(hSql(), "BRANCH", "BRANCH || ' ' || NAME", "BRANCH", " WHERE BRANCH LIKE '" || sUserTOBO || "%' ORDER BY BRANCH ")
.head 8 +  Else
.head 9 -  Call cmbTOBO.Populate(hSql(), "TOBO", "TOBO || ' ' || NAME", "TOBO", " ORDER BY TOBO " )
.head 7 +  Else If nParD = 2 ! Все доступные ТОБО
.head 8 -  Call cmbTOBO.Populate(hSql(), "TOBO", "TOBO || ' ' || NAME", "TOBO", 
" WHERE TOBO in 
(select TOBO_ID from STAFF_TOBO where addp>1 and USER_ID="||Str(GetUserId()) ||") 
ORDER BY TOBO " )
.head 7 +  Else If nParD = 9 ! Только текущее ТОБО
.head 8 +  If nHaveTOBO = 2
.head 9 -  Call cmbTOBO.Populate(hSql(), "BRANCH", "BRANCH || ' ' || NAME", "BRANCH", " WHERE BRANCH = '" || sUserTOBO || "'")
.head 8 +  Else
.head 9 -  Call cmbTOBO.Populate(hSql(), "TOBO", "TOBO || ' ' || NAME", "TOBO", " WHERE TOBO = '" || sUserTOBO || "'")
.head 6 +  On SAM_Click
.head 7 -  Set sTOBO = cmbTOBO.GetKey( SalListQuerySelection(hWndItem))
.head 7 -  Set F_Naselenie = TRUE
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'ТОБО' )
.head 4 -  !
.head 4 -  Background Text: F8 - Все счета/с остатками(оборотами)
.head 5 -  Resource Id: 10186
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.75"
.head 6 -  Top:    0.57"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgF8
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: SB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: С
б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.283"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: BAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: БАЛ
A
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DOSr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты ДЕБЕТ
1 реальные
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOSr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты КРЕДИТ
2 реальные
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.717"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты ДЕБЕТ
1 общие
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты КРЕДИТ
2 общие
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исходящий ДЕБЕТ
3
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исходящий КРЕДИТ
4
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.883"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование балансового счета
Б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  6.933"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: NASELENIE
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sStrPopulate
.head 5 -  String: sf
.head 5 -  String: sPL
.head 5 -  Date/Time: BD
.head 5 -  Date/Time: DC
.head 5 -  String: sToboMask
.head 4 +  Actions
.head 5 +  If cbBranch and sTOBO = ''
.head 6 -  Return FALSE
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set sf = ""
.head 5 -  Set sf = cF.GetFilterWhereClause(FALSE)
.head 5 -  Set sDAT = SalFmtFormatDateTime(dDAT, 'dd-MM-yyyy')
.head 5 -  ! sDAT: Cостояние  Б А Л А Н С А (экв.)
.head 5 -  Call SalSetWindowText(hWndForm, sDAT || ': ' || CurrentLangTable.GetAtomTitle('GL_tbl1.cTWndTitle') || ' ' ||
     IifS(cbBranch=TRUE, CurrentLangTable.GetAtomTitle('GL_tbl1.cbBranch') || ' ' || sTOBO, '') || ' ' ||
     IifS(cbSubBranch=TRUE, CurrentLangTable.GetAtomTitle('GL_tbl1.cbSubBranch'), ''))
.head 5 -  ! Курсы по дол, евро, руб
.head 5 +  If not bCUR
.head 6 -  If SqlPrepareAndExecute(hSql(), "SELECT d_close INTO :DC FROM tabval WHERE kv=810")
AND SqlFetchNext(hSql(),nFetchRes)
.head 6 -  Set val643 = IifN(dDAT<DC, 810, 643)
.head 6 +  If SqlPrepareAndExecute(hSqlAux(), "select kv into :val960 from tabval where kv=960")
AND NOT SqlFetchNext(hSqlAux(), nFetchRes)
.head 7 -  Set val960 = 0
.head 6 -  If SqlPrepareAndExecute(hSqlAux(),
"SELECT gl.p_icurval(840,10000,:dDAT)/10000, 
        gl.p_icurval(978,10000,:dDAT)/10000, 
        gl.p_icurval(:val643,10000,:dDAT)/10000,
        Decode(:val960,0, null, gl.p_icurval(960,10000,:dDAT)/10000 )
   INTO :dKurs_840, :dKurs_978, :dKurs_810, :dKurs_960
   FROM dual ")
AND SqlFetchNext(hSqlAux(), nFetchRes)
.head 5 -  ! - В казначействе - без валют вообще
.head 5 +  If bCUR 
.head 6 +  If dDAT = dBankDate
.head 7 -  Set sStrPopulate = 
"SELECT p.sb, b.nbs, p.name, sum(b.dosq)/100, sum(b.kosq)/100, 
        sum(b.ostd)/100, sum(b.ostk)/100 
   INTO :SB, :BAL, :NAME, :DOS, :KOS, :ISD, :ISK 
   FROM (SELECT nbs, kv, 
                sum(decode(dapp, :dDAT, dos, 0)) dosq, 
                sum(decode(dapp, :dDAT, kos, 0)) kosq, 
               -sum(decode(sign(ostc), -1, ostc, 0)) ostd, 
                sum(decode(sign(ostc),  1, ostc, 0)) ostk 
           FROM V_GL a 
          WHERE dazs is null "|| IifS(sTOBO='',"", " and a.TOBO=:sTOBO ") || "
          GROUP BY nbs, kv) b, ps p 
  WHERE p.nbs = b.nbs " || ss || IifS(sf="", "", " AND " || sf) ||  "
  GROUP BY p.sb, b.nbs, p.name 
  ORDER BY b.nbs"
.head 6 +  Else
.head 7 -  Set sStrPopulate = 
"SELECT p.sb, b.nbs, p.name, sum(b.DOSQ)/100, sum(b.KOSQ)/100, 
       -sum(b.OSTD)/100, sum(b.OSTK)/100 
   INTO :SB, :BAL, :NAME, :DOS, :KOS, :ISD, :ISK 
   FROM (SELECT nbs NBS, sum(dos) DOSQ, sum(kos) KOSQ, 
                sum(decode(sign(ost),-1,ost,0)) OSTD, 
                sum(decode(sign(ost), 1,ost,0)) OSTK 
           FROM sal a 
          WHERE fdat=:dDAT AND kv=:n980 "|| IifS(sTOBO='',"", " and a.TOBO=:sTOBO ") || "
          GROUP BY nbs 
          ) b, ps p 
  WHERE b.NBS=p.nbs " || ss || IifS(sf="", "", " AND " || sf) || " 
  GROUP BY p.sb, b.NBS, p.name 
  ORDER BY b.NBS "
.head 5 -  ! - по экв из SALDOA (в НБУ)
.head 5 +  Else If bEQV  
.head 6 -  Set sStrPopulate =
"SELECT p.sb, b.NBS, p.name, b.DOSQ/100, b.KOSQ/100, 
        -b.OSTD/100, b.OSTK/100, b.DOSR/100, b.KOSR/100 
   INTO :SB, :BAL, :NAME, :DOS, :KOS, :ISD, :ISK, :DOSr, :KOSr 
   FROM (SELECT nbs NBS, 
                sum(gl.p_icurval(kv,dos,:dDAT)) DOSR, sum(dosq) DOSQ, 
                sum(gl.p_icurval(kv,kos,:dDAT)) KOSR, sum(kosq) KOSQ, 
                sum(decode(sign(ostq), 1, 0, ostq)) OSTD, 
                sum(decode(sign(ostq), 1, ostq, 0)) OSTK 
           FROM salQ a 
          WHERE fdat = :dDAT
            and a.nbs not in ('5100','6210','5140')
            and (a.dazs is null or a.dazs > a.fdat) " || IifS(sTOBO='',"", " and a.TOBO=:sTOBO ") || "
          GROUP BY nbs) b, ps p 
  WHERE b.NBS = p.nbs " || ss || IifS(sf="", "", " AND " || sf) || 
" union all " ||
"SELECT p.sb, b.NBS, p.name, b.DOSQ/100, b.KOSQ/100, 
        -b.OSTD/100, b.OSTK/100, b.DOSR/100, b.KOSR/100 
   FROM (SELECT nbs NBS, 
                sum(DOSR) DOSR, sum(dosq) DOSQ, 
                sum(KOSR) KOSR, sum(kosq) KOSQ, 
                sum(decode(sign(ostq), 1, 0, ostq)) OSTD, 
                sum(decode(sign(ostq), 1, ostq, 0)) OSTK 
           FROM ( SELECT nbs NBS, nls,
                         sum(gl.p_icurval(kv,dos,:dDAT)) DOSR, sum(dosq) DOSQ, 
                         sum(gl.p_icurval(kv,kos,:dDAT)) KOSR, sum(kosq) KOSQ, 
                         sum(ostq) OSTQ 
                    FROM salQ a 
                   WHERE fdat = :dDAT
                     and a.nbs in ('5100','6210','5140')
                     and (a.dazs is null or a.dazs > a.fdat) 
                   GROUP BY nbs, nls) a 
          GROUP BY nbs) b, ps p 
  WHERE b.NBS = p.nbs" ||
" ORDER BY 2 "
.head 5 -  ! - через процедуру для КБ
.head 5 +  Else
.head 6 -  Set sToboMask = IifS(cbSubBranch=TRUE, sTOBO || '%', sTOBO)
.head 6 -  Call SqlPLSQLCommand(hSql(), "Bars.Show_GL( dDAT, bEQV, sToboMask )")
.head 6 -  Set dCurrDAT  = dDAT
.head 6 -  Set sCurrTOBO = sTOBO
.head 6 -  !
.head 6 -  Set sStrPopulate =
"SELECT p.sb, b.NBS, p.name, 
        DOSR/100, KOSR/100, DOSQ/100, KOSQ/100, OSTD/100, OSTK/100 
   INTO :SB, :BAL, :NAME, :DOSr, :KOSr, :DOS, :KOS, :ISD, :ISK 
   FROM Bars.Tmp_Show_GL b, PS p 
  WHERE p.nbs = b.NBS " || ss || IifS(sf="", "", " AND " || sf) ||
" ORDER BY b.NBS "
.head 5 -  !
.head 5 -  Set iDOS  = 0
.head 5 -  Set iKOS  = 0
.head 5 -  Set iDOSr = 0
.head 5 -  Set iKOSr = 0
.head 5 -  Set iISD  = 0
.head 5 -  Set iISK  = 0
.head 5 -  Set iDOS5 = 0
.head 5 -  Set iKOS5 = 0
.head 5 -  Set iDOSr5 = 0
.head 5 -  Set iKOSr5 = 0
.head 5 -  Set iISD5 = 0
.head 5 -  Set iISK5 = 0
.head 5 -  Set iDOS6 = 0
.head 5 -  Set iKOS6 = 0
.head 5 -  Set iDOSr6 = 0
.head 5 -  Set iKOSr6 = 0
.head 5 -  Set iISD6 = 0
.head 5 -  Set iISK6 = 0
.head 5 -  Set iDOS7 = 0
.head 5 -  Set iKOS7 = 0
.head 5 -  Set iDOSr7 = 0
.head 5 -  Set iKOSr7 = 0
.head 5 -  Set iISD7 = 0
.head 5 -  Set iISK7 = 0
.head 5 -  Set iDOS8 = 0
.head 5 -  Set iKOS8 = 0
.head 5 -  Set iDOSr8 = 0
.head 5 -  Set iKOSr8 = 0
.head 5 -  Set iISD8 = 0
.head 5 -  Set iISK8 = 0
.head 5 -  Set iDOS9 = 0
.head 5 -  Set iKOS9 = 0
.head 5 -  Set iDOSr9 = 0
.head 5 -  Set iKOSr9 = 0
.head 5 -  Set iISD9 = 0
.head 5 -  Set iISK9 = 0
.head 5 -  Call SalTblPopulate(hWndForm, hSqlAux(), sStrPopulate, TBL_FillAll)
.head 5 -  !
.head 5 -  Call SalTblDefineSplitWindow(hWndForm, SalArraySum(mbF)+1, TBL_Split_Adjustable)
.head 5 +  If mbF[4]
.head 6 -  Call SalTblFetchRow(hWndForm, SalTblInsertRow(hWndForm,TBL_MinSplitRow))
.head 6 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 6 -  Set GL_tbl1.BAL = "V***"
.head 6 -  Set GL_tbl1.DOS = iDOS9
.head 6 -  Set GL_tbl1.KOS = iKOS9
.head 6 -  Set GL_tbl1.DOSr= iDOSr9
.head 6 -  Set GL_tbl1.KOSr= iKOSr9
.head 6 -  Set GL_tbl1.ISD = iISD9
.head 6 -  Set GL_tbl1.ISK = iISK9
.head 6 -  Set NAME = F_POZ (ISD,ISK, NAME ) 
.head 5 +  If mbF[3]
.head 6 -  Call SalTblFetchRow(hWndForm, SalTblInsertRow(hWndForm,TBL_MinSplitRow))
.head 6 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 6 -  Set GL_tbl1.BAL = "M***"
.head 6 -  Set GL_tbl1.DOS = iDOS8
.head 6 -  Set GL_tbl1.KOS = iKOS8
.head 6 -  Set GL_tbl1.DOSr = iDOSr8
.head 6 -  Set GL_tbl1.KOSr = iKOSr8
.head 6 -  Set GL_tbl1.ISD = iISD8
.head 6 -  Set GL_tbl1.ISK = iISK8
.head 6 -  Set NAME = F_POZ (ISD,ISK, NAME ) 
.head 5 +  If mbF[2]
.head 6 -  Call SalTblFetchRow(hWndForm, SalTblInsertRow(hWndForm,TBL_MinSplitRow))
.head 6 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 6 -  Set GL_tbl1.BAL = "R***"
.head 6 -  Set GL_tbl1.DOS = iDOS7
.head 6 -  Set GL_tbl1.KOS = iKOS7
.head 6 -  Set GL_tbl1.DOSr = iDOSr7
.head 6 -  Set GL_tbl1.KOSr = iKOSr7
.head 6 -  Set GL_tbl1.ISD = iISD7
.head 6 -  Set GL_tbl1.ISK = iISK7
.head 6 -  Set NAME = F_POZ (ISD,ISK, NAME ) 
.head 5 +  If mbF[1]
.head 6 -  Call SalTblFetchRow(hWndForm, SalTblInsertRow(hWndForm,TBL_MinSplitRow))
.head 6 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 6 -  Set GL_tbl1.BAL = "D***"
.head 6 -  Set GL_tbl1.DOS = iDOS6
.head 6 -  Set GL_tbl1.KOS = iKOS6
.head 6 -  Set GL_tbl1.DOSr = iDOSr6
.head 6 -  Set GL_tbl1.KOSr = iKOSr6
.head 6 -  Set GL_tbl1.ISD = iISD6
.head 6 -  Set GL_tbl1.ISK = iISK6
.head 6 -  Set NAME = F_POZ (ISD,ISK, NAME ) 
.head 5 +  If mbF[0]
.head 6 -  Call SalTblFetchRow(hWndForm, SalTblInsertRow(hWndForm,TBL_MinSplitRow))
.head 6 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 6 -  Set GL_tbl1.BAL = "K***"
.head 6 -  Set GL_tbl1.DOS = iDOS5
.head 6 -  Set GL_tbl1.KOS = iKOS5
.head 6 -  Set GL_tbl1.DOSr = iDOSr5
.head 6 -  Set GL_tbl1.KOSr = iKOSr5
.head 6 -  Set GL_tbl1.ISD = iISD5
.head 6 -  Set GL_tbl1.ISK = iISK5
.head 6 -  Set NAME = F_POZ (ISD,ISK, NAME ) 
.head 5 -  Call SalTblFetchRow(hWndForm, SalTblInsertRow(hWndForm,TBL_MinSplitRow))
.head 5 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 5 -  Set GL_tbl1.BAL = "B***"
.head 5 -  Set GL_tbl1.DOS = iDOS + IifN(mbF[4]=FALSE,iDOS9,0) +
    IifN(mbF[3]=FALSE,iDOS8,0) + IifN(mbF[2]=FALSE,iDOS7,0) +
    IifN(mbF[1]=FALSE,iDOS6,0) + IifN(mbF[0]=FALSE,iDOS5,0)
.head 5 -  Set GL_tbl1.KOS = iKOS + IifN(mbF[4]=FALSE,iKOS9,0) +
    IifN(mbF[3]=FALSE,iKOS8,0) + IifN(mbF[2]=FALSE,iKOS7,0) +
    IifN(mbF[1]=FALSE,iKOS6,0) + IifN(mbF[0]=FALSE,iKOS5,0)
.head 5 -  Set GL_tbl1.DOSr = iDOSr + IifN(mbF[4]=FALSE,iDOSr9,0) +
    IifN(mbF[3]=FALSE,iDOSr8,0) + IifN(mbF[2]=FALSE,iDOSr7,0) +
    IifN(mbF[1]=FALSE,iDOSr6,0) + IifN(mbF[0]=FALSE,iDOSr5,0)
.head 5 -  Set GL_tbl1.KOSr = iKOSr + IifN(mbF[4]=FALSE,iKOSr9,0) +
    IifN(mbF[3]=FALSE,iKOSr8,0) + IifN(mbF[2]=FALSE,iKOSr7,0) +
    IifN(mbF[1]=FALSE,iKOSr6,0) + IifN(mbF[0]=FALSE,iKOSr5,0)
.head 5 -  Set GL_tbl1.ISD = iISD + IifN(mbF[4]=FALSE,iISD9,0) +
    IifN(mbF[3]=FALSE,iISD8,0) + IifN(mbF[2]=FALSE,iISD7,0) +
    IifN(mbF[1]=FALSE,iISD6,0) + IifN(mbF[0]=FALSE,iISD5,0)
.head 5 -  Set GL_tbl1.ISK = iISK + IifN(mbF[4]=FALSE,iISK9,0) +
    IifN(mbF[3]=FALSE,iISK8,0) + IifN(mbF[2]=FALSE,iISK7,0) +
    IifN(mbF[1]=FALSE,iISK6,0) + IifN(mbF[0]=FALSE,iISK5,0)
.head 5 -  Set NAME = F_POZ (ISD,ISK, NAME ) 
.head 5 -  !
.head 5 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return TRUE
.head 3 +  Function: F_POZ
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Number: nISD
.head 5 -  Number: nISK
.head 5 -  Window Handle: hWn
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sRet
.head 5 -  Number: nRet
.head 5 -  Number: nLn
.head 4 +  Actions
.head 5 -  Set nRet = nISK-nISD
.head 5 -  Set sRet = SalFmtFormatNumber( Abs(nRet), '9 999 999 999 999,99' )
.head 5 -  Set nLn = SalStrLength( sRet )
.head 5 -  Set sRet = SalStrRepeatX( ' ', (20-nLn)*2  ) || sRet 
.head 5 +  If nRet > 0 ! - Голубой
.head 6 -  Call XSalTblSetCellBackColor(  hWn , SalColorFromRGB( 220,255,255 ) )
.head 5 +  Else If nRet < 0 ! - Розовій
.head 6 -  Call XSalTblSetCellBackColor(  hWn , SalColorFromRGB( 255,240,255 ) )
.head 5 -  !
.head 5 -  Return sRet
.head 3 +  Function: fPar
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sPar
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nL
.head 4 +  Actions
.head 5 -  Set nL = SalStrLength(sPar)
.head 5 -  Set nParD = Val(Subs(sPar,1,1))
.head 5 +  If nParD = 1 ! От всего банка
.head 6 -  Set nPar = vPar
.head 5 +  Else If nParD = 2 OR nParD = 9 !
 2 - От всех доступных ТОБО
 9 - От текущего ТОБО
.head 6 +  If nL < 2 
.head 7 -  Call SalMessageBox(
"Длина параметра < 2 (д.б. "||Subs(sPar,1,1)||"x...)" ,
"Внимание, ОШИБКА в параметрах вызова функции !",
 MB_IconStop)
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 6 -  Set nPar = Val(Subs(sPar, 2, nL - 1))
.head 5 +  If SqlPrepareAndExecute(hSql(), 
"select " || IifS(nHaveTOBO=2, 
"Substr(SYS_CONTEXT('bars_context','user_branch'),1,30)",
"Substr(pul.Get_Mas_Ini_Val('KOD_TOBO'),1,12)") || " INTO :sUserTOBO from dual")
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 2 +  Window Parameters
.head 3 -  Number: vPar
.head 2 +  Window Variables
.head 3 -  : subMenu
.head 4 -  Class: cChildMenuEngine
.head 3 -  : cF
.head 4 -  Class: cGenFilter
.head 3 -  Number: nParD
.head 3 -  Number: nPar
.head 3 -  String: sUserTOBO
.head 3 -  String: sTmpN
.head 3 -  Date/Time: dBankDate
.head 3 -  Date/Time: dDAT
.head 3 -  String: sDAT
.head 3 -  Boolean: bF8
.head 3 -  !
.head 3 -  Boolean: F_Naselenie
.head 3 -  Date/Time: dCurrDAT
.head 3 -  String: sCurrTOBO
.head 3 -  Number: n980
.head 3 -  Boolean: mbF[*]
.head 3 -  !
.head 3 -  Number: iDOS
.head 3 -  Number: iKOS
.head 3 -  Number: iDOSr
.head 3 -  Number: iKOSr
.head 3 -  Number: iISD
.head 3 -  Number: iISK
.head 3 -  !
.head 3 -  Number: iDOS5
.head 3 -  Number: iKOS5
.head 3 -  Number: iDOSr5
.head 3 -  Number: iKOSr5
.head 3 -  Number: iISD5
.head 3 -  Number: iISK5
.head 3 -  !
.head 3 -  Number: iDOS6
.head 3 -  Number: iKOS6
.head 3 -  Number: iDOSr6
.head 3 -  Number: iKOSr6
.head 3 -  Number: iISD6
.head 3 -  Number: iISK6
.head 3 -  !
.head 3 -  Number: iDOS7
.head 3 -  Number: iKOS7
.head 3 -  Number: iDOSr7
.head 3 -  Number: iKOSr7
.head 3 -  Number: iISD7
.head 3 -  Number: iISK7
.head 3 -  !
.head 3 -  Number: iDOS8
.head 3 -  Number: iKOS8
.head 3 -  Number: iDOSr8
.head 3 -  Number: iKOSr8
.head 3 -  Number: iISD8
.head 3 -  Number: iISK8
.head 3 -  !
.head 3 -  Number: iDOS9
.head 3 -  Number: iKOS9
.head 3 -  Number: iDOSr9
.head 3 -  Number: iKOSr9
.head 3 -  Number: iISD9
.head 3 -  Number: iISK9
.head 3 -  !
.head 3 -  Number: val643
.head 3 -  Number: val960
.head 3 -  String: sTmp
.head 3 -  String: ss
.head 3 -  String: sWhere
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call fPar(Str(vPar))
.head 4 -  Set F_Naselenie = TRUE
.head 4 -  ! Баланс
.head 4 -  Call subMenu.Init(hWndForm, 'menuBalans', CurrentLangTable.GetAtomTitle('GL_tbl1.menuBalans.cTMenuBalans'))
.head 4 -  ! Cостояние  Б А Л А Н С А (экв.)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('GL_tbl1.cTWndTitle'))
.head 4 -  Call SalSetWindowLabelText(bgF8, CurrentLangTable.GetAtomTitle('bgF8'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set dBankDate = GetBankDate()
.head 4 -  Set dDAT      = dBankDate
.head 4 -  Set dCurrDAT  = DATETIME_Null
.head 4 -  Set sCurrTOBO = ''
.head 4 -  Set n980 = GetBaseVal()
.head 4 -  Set bF8  = TRUE
.head 4 -  Set sWhere = "AND (b.DOSQ>0 OR b.KOSQ>0 OR b.OSTD<>0 OR b.OSTK<>0 )"
.head 4 +  If bCUR
.head 5 -  Set ss = sWhere
.head 5 -  Call SalHideWindow(DOSr)
.head 5 -  Call SalHideWindow(KOSr)
.head 4 -  ! Наличие цифры в любой позиции ПОСЛЕ первой означает :
5 - Показавать итог по БС с ps.SB = 'K' (Капитал)
6 - Показавать итог по БС с ps.SB = 'D' (Доход)
7 - Показавать итог по БС с ps.SB = 'R' (Расход)
8 - Показавать итог по БС с ps.SB = 'M' (Меморанд)
9 - Показавать итог по БС с ps.SB = 'V' (Внебаланс
Всегда Показавать итог по БС с ps.SB = 'B' (Баланс)
0 - Не проваливаться в "Историю счета" и далее
3 - Не показывать "наименование клиента" в окне  "Счета" tbl4

ПЕРВАЯ цифра в позиции означает Уровень доступа :
1 - весь банк 
2 - все доступные ТОБО с кодом привилегии		 
9 - текущее ТОБО
.head 4 -  Set mbF[0] = IifN(SalStrScan(Str(nPar),'5')=-1, FALSE, TRUE)
.head 4 -  Set mbF[1] = IifN(SalStrScan(Str(nPar),'6')=-1, FALSE, TRUE)
.head 4 -  Set mbF[2] = IifN(SalStrScan(Str(nPar),'7')=-1, FALSE, TRUE)
.head 4 -  Set mbF[3] = IifN(SalStrScan(Str(nPar),'8')=-1, FALSE, TRUE)
.head 4 -  Set mbF[4] = IifN(SalStrScan(Str(nPar),'9')=-1, FALSE, TRUE)
.head 4 -  Set mbF[5] = IifN(SalStrScan(Str(nPar),'0')=-1, TRUE, FALSE)
.head 4 -  Set bShowClient3 = IifN(SalStrScan(Str(nPar),'3')=-1, TRUE, FALSE)
.head 4 -  !
.head 4 +  If nHaveTOBO = 0
.head 5 -  Call SalHideWindow(cbBranch)
.head 5 -  Call SalHideWindow(sTOBO)
.head 5 -  Call SalHideWindow(cmbTOBO)
.head 5 -  Call SalHideWindow(pbTOBO)
.head 4 -  Call SalHideWindow(cbSubBranch)
.head 4 -  !
.head 4 -  Set GL_tbl1.strPrintFileName = 'TAB1'
.head 4 -  Call cF.Init('PS', 'p')
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call SalEnableWindow(pbFilter)
.head 3 +  On SAM_CreateComplete
.head 4 +  If nParD = 1 
.head 5 -  Set sTOBO = ''
.head 5 -  Set cbBranch = FALSE
.head 5 -  Call SalHideWindow(sTOBO)
.head 5 -  Call SalHideWindow(cmbTOBO)
.head 5 -  Call SalHideWindow(pbTOBO)
.head 4 +  Else
.head 5 -  Set sTOBO = sUserTOBO
.head 5 -  Set cbBranch = TRUE
.head 5 -  Call SalDisableWindow(cbBranch)
.head 5 -  Set cmbTOBO = cmbTOBO.GetNameById(sUserTOBO) 
.head 5 +  If nParD = 9
.head 6 -  Call SalDisableWindow(cmbTOBO)
.head 6 -  Call SalDisableWindow(pbTOBO)
.head 4 +  If bCUR
.head 5 -  Call SalSendMsg(cmbDat, SAM_Click, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_Activate
.head 4 -  Call subMenu.Enable(wParam)
.head 3 +  On SAM_FetchRowDone
.head 4 +  If SB = 'V'
.head 5 -  Set iDOS9  = iDOS9 + DOS
.head 5 -  Set iKOS9  = iKOS9 + KOS
.head 5 -  Set iDOSr9 = iDOSr9 + DOSr
.head 5 -  Set iKOSr9 = iKOSr9 + KOSr
.head 5 -  Set iISD9  = iISD9 + ISD
.head 5 -  Set iISK9  = iISK9 + ISK
.head 4 +  Else If SB = 'M'
.head 5 -  Set iDOS8  = iDOS8 + DOS
.head 5 -  Set iKOS8  = iKOS8 + KOS
.head 5 -  Set iDOSr8 = iDOSr8 + DOSr
.head 5 -  Set iKOSr8 = iKOSr8 + KOSr
.head 5 -  Set iISD8  = iISD8 + ISD
.head 5 -  Set iISK8  = iISK8 + ISK
.head 4 +  Else If SB = 'R'
.head 5 -  Set iDOS7  = iDOS7 + DOS
.head 5 -  Set iKOS7  = iKOS7 + KOS
.head 5 -  Set iDOSr7 = iDOSr7 + DOSr
.head 5 -  Set iKOSr7 = iKOSr7 + KOSr
.head 5 -  Set iISD7  = iISD7 + ISD
.head 5 -  Set iISK7  = iISK7 + ISK
.head 4 +  Else If SB = 'D'
.head 5 -  Set iDOS6  = iDOS6 + DOS
.head 5 -  Set iKOS6  = iKOS6 + KOS
.head 5 -  Set iDOSr6 = iDOSr6 + DOSr
.head 5 -  Set iKOSr6 = iKOSr6 + KOSr
.head 5 -  Set iISD6  = iISD6 + ISD
.head 5 -  Set iISK6  = iISK6 + ISK
.head 4 +  Else If SB = 'K'
.head 5 -  Set iDOS5  = iDOS5 + DOS
.head 5 -  Set iKOS5  = iKOS5 + KOS
.head 5 -  Set iDOSr5 = iDOSr5 + DOSr
.head 5 -  Set iKOSr5 = iKOSr5 + KOSr
.head 5 -  Set iISD5  = iISD5 + ISD
.head 5 -  Set iISK5  = iISK5 + ISK
.head 4 +  Else
.head 5 -  Set iDOS  = iDOS + DOS
.head 5 -  Set iKOS  = iKOS + KOS
.head 5 -  Set iDOSr = iDOSr + DOSr
.head 5 -  Set iKOSr = iKOSr + KOSr
.head 5 -  Set iISD  = iISD + ISD
.head 5 -  Set iISK  = iISK + ISK
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalCreateWindow(GL_tbl2, hWndMDI, BAL, dDAT, mbF[5], sTOBO )
.head 3 +  On WM_RbuttonDblClick
.head 4 -  Call SalCreateWindow(GL_tbl4, hWndMDI, BAL, dDAT, mbF[5], sTOBO )
.head 3 +  On UM_MenuComponentShow
.head 4 -  Call subMenu.ShowMenu(wParam, lParam)
.head 3 +  On VTM_KeyDown
.head 4 +  If wParam = VK_F8
.head 5 +  If bF8
.head 6 -  Set ss = ""
.head 5 +  Else
.head 6 -  Set ss = sWhere
.head 5 -  Set bF8 = NOT bF8
.head 5 -  Call NASELENIE()
.head 3 +  On SAM_Destroy
.head 4 -  Call subMenu.Kill()
.head 4 -  Call SalSendClassMessage(SAM_Destroy, 0, 0)
.head 1 +  Table Window: GL_tbl2	!! БС по ИСПОЛНИТЕЛЯМ - эквивалент ТЕКУЩИЙ БАНКОВСКИЙ ДЕНЬ
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: ПО ИСПОЛН
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Light Gray
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 10000
.head 3 -  Discardable? Class Default
.head 2 -  Description: (показывать с 0/без - F8)
.head 2 +  Named Menus
.head 3 +  Menu: menuBalans2
.head 4 -  Resource Id: 10609
.head 4 -  Title: &Информация по ИСПОЛНИТЕЛЯМ
.head 4 -  Description:
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: С &Оборотами
.head 5 -  Resource Id: 10610
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If bEQV
.head 7 -  Set ss = "(dosq>0 or kosq>0) "
.head 6 +  Else
.head 7 -  Set ss = "(dos>0 or kos>0) "
.head 6 -  Call NASELENIE(ss)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: С &Дебетовыми  об
.head 5 -  Resource Id: 10611
.head 5 -  Keyboard Accelerator: Alt+BkSp
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If bEQV
.head 7 -  Set ss = " dosq>0 "
.head 6 +  Else
.head 7 -  Set ss = " dos>0 "
.head 6 -  Call NASELENIE(ss)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: С &Кредитовыми об
.head 5 -  Resource Id: 10612
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If bEQV
.head 7 -  Set ss = " kosq>0 "
.head 6 +  Else
.head 7 -  Set ss = " kos>0 "
.head 6 -  Call NASELENIE(ss)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Без Оборотов
.head 5 -  Resource Id: 10613
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If bEQV
.head 7 -  Set ss = "dosq=0 and kosq=0 "
.head 6 +  Else
.head 7 -  Set ss = "dos=0 and kos=0 "
.head 6 -  Call NASELENIE(ss)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Активы
.head 5 -  Resource Id: 10614
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If bEQV
.head 7 -  Set ss = "ostq<0 "
.head 6 +  Else
.head 7 -  Set ss = "ost<0 "
.head 6 -  Call NASELENIE(ss)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Пассивы
.head 5 -  Resource Id: 10615
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If bEQV
.head 7 -  Set ss = "ostq>0 "
.head 6 +  Else
.head 7 -  Set ss = "ost>0 "
.head 6 -  Call NASELENIE(ss)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Выйти
.head 5 -  Resource Id: 10616
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 5 -  Menu Item Name:
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.452"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set ss = sStrDop
.head 7 -  Set bF8 = TRUE
.head 7 -  Call NASELENIE(ss)
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 40351
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 40352
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 40353
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Background Text: F8 - Все счета/с остатками(оборотами)
.head 5 -  Resource Id: 10187
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.7"
.head 6 -  Top:    0.2"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgF8
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: BAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: БАЛ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исп.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты ДЕБЕТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.683"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты КРЕДИТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исходящий ДЕБЕТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исходящий КРЕДИТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.967"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование исполнителя
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  6.933"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: NASELENIE
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: ss
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sf
.head 5 -  String: sSql
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set sf = cF.GetFilterWhereClause(FALSE)
.head 5 -  ! Типа Ощадбанк + Надра + УПБ = Новый эталон КБ
.head 5 +  If gOB22 = '1' and NOT bEQV 
.head 6 +  If dDAT = GetBankDate()
.head 7 -  Set sSql =
"SELECT m.isp, f.fio, sum(m.dosq)/100, sum(m.kosq)/100, 
       -sum(decode(sign(m.ostq),-1, m.ostq, 0) )/100, 
        sum(decode(sign(m.ostq), 1, m.ostq, 0) )/100 
 INTO :ISP, :NAME, :DOS, :KOS, :ISD, :ISK 
 FROM staff f, 
     (select acc, isp, 
             gl.p_icurval(kv, ostc, :dDAT) ostq, 
             gl.p_icurval(kv, kos , :dDAT) kosq,
             gl.p_icurval(kv, dos , :dDAT) dosq 
      from v_gl 
      where (ostc<>0 or dos>0 or kos>0)
        and (dazs is NULL OR dazs >= :dDAT) and nbs= :nBAL "||
        IifS(sTOBO="",""," and TOBO=:sTOBO") || 
        IifS(ss = "", "", " and " || ss) ||
 " ) m WHERE m.isp = f.id (+) GROUP BY m.isp, f.fio  ORDER BY m.isp "
.head 6 +  Else
.head 7 -  Set sSql =
"SELECT s.isp, f.fio, sum(m.dosq)/100, sum(m.kosq)/100, 
       -sum(decode(sign(m.ostq),-1, m.ostq, 0) )/100, 
        sum(decode(sign(m.ostq), 1, m.ostq, 0) )/100 
 INTO :ISP, :NAME, :DOS, :KOS, :ISD, :ISK 
 FROM staff f, 
  (select * from ACCM_SNAP_BALANCES where (ost<>0 or dos>0 or kos>0) )m,
  (select caldt_id from ACCM_CALENDAR  where caldt_date = :dDAT ) k,       
  (select acc, isp from v_gl where (dazs is NULL OR dazs >= :dDAT)
        and nbs= :nBAL "|| IifS(sTOBO="",""," and TOBO=:sTOBO") ||") s 
  WHERE k.caldt_id = m.caldt_id and s.acc= m.acc  AND s.isp = f.id (+) " || 
      IifS(ss="", "", " and " || ss) || "     
 GROUP BY  s.isp, f.fio 
 ORDER BY  s.isp "
.head 5 -  ! - Типа В казначействе - без валют вообще
.head 5 +  Else If bCUR  
.head 6 -  Set sSql =
"SELECT s.nbs, s.isp, f.fio, sum(s.dos)/100, sum(s.kos)/100, 
       -sum(decode(sign(s.ost),-1, s.ost, 0) )/100, 
        sum(decode(sign(s.ost), 1, s.ost, 0) )/100 
   INTO :BAL, :ISP, :NAME, :DOS, :KOS, :ISD, :ISK 
   FROM sal s, staff f 
  WHERE (s.ost<>0 or s.dos>0 or s.kos>0) and s.nbs = :nBAL " || 
        IifS(ss="", "", " and " || ss) || 
        IifS(sTOBO="", "", " and s.TOBO=:sTOBO ") || " 
    AND s.fdat = :dDAT AND (s.dazs is NULL OR s.dazs >= s.fdat) 
    AND f.id = s.isp 
 GROUP BY s.nbs, s.isp, f.fio 
 ORDER BY s.nbs, s.isp "
.head 5 -  ! - по экв из SALDOA (в НБУ)
.head 5 +  Else If bEQV 
.head 6 +  If nBAL = '5100' or nBAL = '6210' or nBAL = '5140'
.head 7 -  Set sSql =
"SELECT s.nbs, s.isp, f.fio, sum(s.dosq)/100, sum(s.kosq)/100, 
       -sum(decode(sign(s.ostq),-1, s.ostq, 0) )/100, 
        sum(decode(sign(s.ostq), 1, s.ostq, 0) )/100  
   INTO :BAL, :ISP, :NAME, :DOS, :KOS, :ISD, :ISK 
   from ( SELECT s.nbs, s.nls, s.isp, sum(s.dosq) dosq, sum(s.kosq) kosq, 
                 sum(s.ostq) ostq 
            FROM salQ s
           WHERE s.nbs = :nBAL
             AND s.fdat = :dDAT AND (s.dazs is NULL OR s.dazs >= s.fdat)
           GROUP BY s.nbs, s.nls, s.isp ) s, staff f
  WHERE f.id = s.isp 
  GROUP BY s.nbs, s.isp, f.fio 
  ORDER BY s.nbs, s.isp"
.head 6 +  Else
.head 7 -  Set sSql =
"SELECT s.nbs, s.isp, f.fio, sum(s.dosq)/100, sum(s.kosq)/100, 
       -sum(decode(sign(s.ostq),-1, s.ostq, 0) )/100, 
        sum(decode(sign(s.ostq), 1, s.ostq, 0) )/100 
   INTO :BAL, :ISP, :NAME, :DOS, :KOS, :ISD, :ISK 
   FROM salQ s, staff f 
  WHERE (ostq<>0 or dosq>0 or kosq>0)
     and s.nbs = :nBAL " ||
        IifS(ss="", "", " and " || ss) ||  
        IifS(sTOBO="", "", " and s.TOBO=:sTOBO ") || " 
    AND s.fdat = :dDAT AND (s.dazs is NULL OR s.dazs >= s.fdat) 
    AND f.id = s.isp 
  GROUP BY s.nbs, s.isp, f.fio 
  ORDER BY s.nbs, s.isp "
.head 5 -  ! - для КБ ( старый эталон, Петроком, Демарк)
.head 5 +  Else
.head 6 -  Set sSql =
"SELECT s.nbs, s.isp, nvl(f.fio,'?'), s.dos, s.kos, s.ostd, s.ostk        
   INTO :BAL, :ISP, :NAME, :DOS, :KOS, :ISD, :ISK 
   FROM (SELECT nbs, isp,  
                sum(gl.p_icurval(kv,dos,fdat))/100 dos, 
                sum(gl.p_icurval(kv,kos,fdat))/100 kos, 
               -sum(decode(sign(ost),-1,gl.p_icurval(kv,ost,fdat),0))/100 ostd, 
                sum(decode(sign(ost), 1,gl.p_icurval(kv,ost,fdat),0))/100 ostk
           FROM sal s 
          WHERE (ost<>0 or dos>0 or kos>0) 
            and nbs = :nBAL " ||
                IifS(ss="", "", " and " || ss) ||  
                IifS(sTOBO="", "", " and TOBO=:sTOBO ") || " 
            AND fdat = :dDAT AND (dazs is NULL OR dazs >= fdat) 
          GROUP BY nbs, isp) s, 
        staff f 
  WHERE s.isp = f.id (+)  ORDER BY s.nbs, s.isp "
.head 5 -  !
.head 5 -  Call SalTblPopulate(hWndForm, hSqlAux2(), sSql, TBL_FillAll)
.head 5 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 5 -  Call SalWaitCursor(FALSE)
.head 2 +  Window Parameters
.head 3 -  String: nBAL
.head 3 -  Date/Time: dDAT
.head 3 -  Boolean: bShowAccHist
.head 3 -  String: sTOBO
.head 2 +  Window Variables
.head 3 -  : subMenu
.head 4 -  Class: cChildMenuEngine
.head 3 -  : cF
.head 4 -  Class: cGenFilter
.head 3 -  String: sDAT   !! dd-MM-yyyy
.head 3 -  String: sStrDop
.head 3 -  String: ss
.head 3 -  Boolean: bF8
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  ! Информация по ИСПОЛНИТЕЛЯМ
.head 4 -  Call subMenu.Init(hWndForm, 'menuBalans2', CurrentLangTable.GetAtomTitle('GL_tbl2.cTMenu'))
.head 4 -  Set sDAT = SalFmtFormatDateTime(dDAT, 'dd-MM-yyyy')
.head 4 -  ! sDAT: состояние (экв.) бал/сч nBAL по ИСПОЛНИТЕЛЯМ
.head 4 -  Call SalSetWindowText(hWndForm, sDAT || ": " ||  
     CurrentLangTable.GetAtomTitle('GL_tbl2.cTWndTitle1') || " " || nBAL || " " || 
     CurrentLangTable.GetAtomTitle('GL_tbl2.cTWndTitle2') || " " || 
     IifS(sTOBO!=STRING_Null, CurrentLangTable.GetAtomTitle('GL_tbl1.cbBranch') || ' ' || sTOBO, ''))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalSetWindowLabelText(bgF8, CurrentLangTable.GetAtomTitle('bgF8'))
.head 4 -  Set GL_tbl2.strPrintFileName = 'TAB2'
.head 4 -  Set GL_tbl2.nFlags = GT_ReadOnly
.head 4 -  Call cF.Init('Accounts', 'a')
.head 4 -  Set bF8 = TRUE
.head 4 -  ! Set ss = sStrDop
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call NASELENIE('')
.head 3 +  On SAM_Activate
.head 4 -  Call subMenu.Enable(wParam)
.head 3 +  On UM_MenuComponentShow
.head 4 -  Call subMenu.ShowMenu(wParam, lParam)
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalCreateWindow(GL_tbl3, hWndMDI, sTOBO, 0, ISP, nBAL, dDAT, bShowAccHist)
.head 3 +  On VTM_KeyDown
.head 4 +  If wParam = VK_F8
.head 5 +  If bF8
.head 6 -  Set ss = ""
.head 5 +  Else
.head 6 -  Set ss = sStrDop
.head 5 -  Set bF8 = NOT bF8
.head 5 -  Call NASELENIE(ss)
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set BAL = nBAL 
.head 3 +  On SAM_Destroy
.head 4 -  Call subMenu.Kill()
.head 4 -  Call SalSendClassMessage(SAM_Destroy, 0, 0)
.head 1 +  Table Window: GL_tbl2t	!! БС по TOBO - эквивалент ТЕКУЩИЙ БАНКОВСКИЙ ДЕНЬ
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: по ТОБО
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.825"
.head 4 -  Top:    1.031"
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 10000
.head 3 -  Discardable? Class Default
.head 2 -  Description: (показывать с 0/без - F8)
.head 2 +  Named Menus
.head 3 +  Menu: menuBalans2t
.head 4 -  Resource Id: 10617
.head 4 -  Title: &Информация по ИСПОЛНИТЕЛЯМ
.head 4 -  Description:
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: С &Оборотами
.head 5 -  Resource Id: 10618
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If bEQV
.head 7 -  Set ss = "(dosq>0 or kosq>0) "
.head 6 +  Else
.head 7 -  Set ss = "(dos>0 or kos>0) "
.head 6 -  Call NASELENIE(ss)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: С &Дебетовыми  об
.head 5 -  Resource Id: 10619
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If bEQV
.head 7 -  Set ss = " dosq>0 "
.head 6 +  Else
.head 7 -  Set ss = " dos>0 "
.head 6 -  Call NASELENIE(ss)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: С &Кредитовыми об
.head 5 -  Resource Id: 10620
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If bEQV
.head 7 -  Set ss = " kosq>0 "
.head 6 +  Else
.head 7 -  Set ss = " kos>0 "
.head 6 -  Call NASELENIE(ss)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Без Оборотов
.head 5 -  Resource Id: 10621
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If bEQV
.head 7 -  Set ss = "dosq=0 and kosq=0 "
.head 6 +  Else
.head 7 -  Set ss = "dos=0 and kos=0 "
.head 6 -  Call NASELENIE(ss)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Активы
.head 5 -  Resource Id: 10622
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If bEQV
.head 7 -  Set ss = "ostq<0 "
.head 6 +  Else
.head 7 -  Set ss = "ost<0 "
.head 6 -  Call NASELENIE(ss)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Пассивы
.head 5 -  Resource Id: 10623
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If bEQV
.head 7 -  Set ss = "ostq>0 "
.head 6 +  Else
.head 7 -  Set ss = "ost>0 "
.head 6 -  Call NASELENIE(ss)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Выйти
.head 5 -  Resource Id: 10624
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 5 -  Menu Item Name:
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set ss = sStrDop
.head 7 -  Set bF8 = TRUE
.head 7 -  Call NASELENIE(ss)
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 24137
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 24138
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 24139
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Background Text: F8 - Все счета/с остатками(оборотами)
.head 5 -  Resource Id: 10188
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.7"
.head 6 -  Top:    0.2"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgF8
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: BAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: БАЛ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: TOBO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: TOBO
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.733"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты ДЕБЕТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.683"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты КРЕДИТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исходящий ДЕБЕТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исходящий КРЕДИТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.967"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование TOBO
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  6.933"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: NASELENIE
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: ss
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sf
.head 5 -  String: sSql
.head 5 -  String: sSEL
.head 5 -  String: sBR
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set sf = cF.GetFilterWhereClause(FALSE)
.head 5 +  If gOB22 = '1' and NOT bEQV
.head 6 -  ! nUr !! = 2 итог по 2 уровню бранча
         = -2 детально по бранчам , похожим на sTOBO
         = 0 по всем бранчам россыпью
.head 6 +  If nUr  = 0 or   nUr  = -2 
.head 7 -  Set sBR = 'v.branch'
.head 6 +  Else If nUr  = 2 
.head 7 -  Set sBR = 'substr(v.branch,1,15)'
.head 6 -  Set sSql = 
"SELECT a.branch, t.NAME, a.dos, a.kos, a.ISD, a.ISK         
 INTO :TOBO, :NAME, :DOS,:KOS,:ISD,:ISK 
 FROM branch t,
    (SELECT " || sBR || " branch, sum(m.dosq) DOS, sum(m.kosq) KOS, 
           -sum(decode(sign(m.ostq),-1,m.ostq,0)) ISD, 
            sum(decode(sign(m.ostq), 1,m.ostq,0)) ISK 
     FROM  ACCM_SNAP_BALANCES m, 
         (select acc, branch  from v_gl 
          where nbs =:nBAL and (dazs is NULL or dazs >= :dDAT) "  ||
            IifS(nUr = -2 ," and branch like :sTOBO || '%' ","") || " 
          ) v,
         (select caldt_id from ACCM_CALENDAR  where caldt_date = :dDAT ) k
     WHERE k.caldt_id = m.caldt_id and v.acc= m.acc " || 
          IifS(ss="", "", " and " || ss) || "  
     GROUP BY " || sBR || " ) a 
 where a.branch =  t.branch (+) order by  a.branch "
.head 5 -  ! - В казначействе - без валют вообще
.head 5 +  Else If bCUR  
.head 6 -  Set sSql =
"SELECT s.nbs, s.TOBO, t.NAME, sum(s.dos)/100, sum(s.kos)/100, 
       -sum(decode(sign(s.ost),-1,s.ost,0))/100, 
        sum(decode(sign(s.ost), 1,s.ost,0))/100 
   INTO :BAL, :TOBO, :NAME, :DOS, :KOS, :ISD, :ISK 
   FROM sal s, tobo T 
  WHERE s.nbs = :nBAL "||
        IifS(ss="", "", " and "||ss) ||
        IifS(sTOBO="", "", " and s.TOBO=:sTOBO ") || " 
    AND s.fdat = :dDAT AND (s.dazs is NULL OR s.dazs >= s.fdat) 
    AND t.TOBO = s.TOBO 
  GROUP BY s.nbs, s.TOBO, t.NAME 
  ORDER BY s.nbs, s.TOBO "
.head 5 -  ! - по экв из SALDOA (в НБУ)
.head 5 +  Else If bEQV 
.head 6 -  Set sSql =
"SELECT s.nbs, Nvl(s.TOBO,0), t.name, sum(s.dosq)/100, sum(s.kosq)/100, 
       -sum(decode(sign(s.ostq),-1, s.ostq, 0) )/100, 
        sum(decode(sign(s.ostq), 1, s.ostq, 0) )/100 
   INTO :BAL, :TOBO, :NAME, :DOS, :KOS, :ISD, :ISK 
   FROM salQ s, tobo t 
  WHERE s.nbs = :nBAL " || 
        IifS(ss="", "", " and " || ss) || 
        IifS(sTOBO="", "", " and s.TOBO=:sTOBO ") || " 
    AND s.fdat = :dDAT AND (s.dazs is NULL OR s.dazs >= s.fdat) 
    AND t.tobo = s.tobo 
  GROUP BY s.nbs,s.tobo, t.name 
  ORDER BY s.nbs,s.tobo "
.head 5 -  ! - для КБ
.head 5 +  Else
.head 6 -  Set sSEL = 
"SELECT s.nbs, s.TOBO, t.NAME, s.dos, s.kos, s.ostd, s.ostk         
 INTO :BAL,:TOBO, :NAME, :DOS,:KOS,:ISD,:ISK 
 FROM (SELECT s.nbs, s.TOBO, 
              sum(gl.p_icurval(s.kv,s.dos,s.fdat))/100 dos, 
              sum(gl.p_icurval(s.kv,s.kos,s.fdat))/100 kos, 
             -sum(decode(sign(s.ost),-1,gl.p_icurval(s.kv,s.ost,s.fdat),0))/100 ostd, 
              sum(decode(sign(s.ost), 1,gl.p_icurval(s.kv,s.ost,s.fdat),0))/100 ostk
         FROM sal s
        WHERE s.nbs = :nBAL AND s.fdat = :dDAT 
          and (s.dazs is NULL or s.dazs >= s.fdat) " ||
              IifS( ss ="", "", " and " || ss )
.head 6 -  ! Call DebugN(nUr)
.head 6 +  If nHaveTOBO = 2 and nUr = 2 
.head 7 -  ! nUr = 2 итог по 2 уровню бранча
.head 7 -  Set sSql = sSEL || IifS(sTOBO="", "", " and s.TOBO like :sTOBO || '%' ") ||
  " GROUP BY s.nbs, s.TOBO ) s , tobo T   
 WHERE t.TOBO=Substr(s.TOBO,1,15) and length(t.TOBO)<=15 
 ORDER BY s.nbs, t.TOBO "
.head 6 +  Else If nHaveTOBO = 2 and nUr = -2 
.head 7 -  ! nUr = 2 детально по бранчам ,похожим на sTOBO 
.head 7 -  Set sSql = sSEL  || " and substr(s.TOBO,1,15)= :sTOBO  
       GROUP BY s.nbs, s.TOBO) s , tobo T   
 WHERE t.TOBO=s.TOBO  ORDER BY s.nbs, t.TOBO "
.head 6 +  Else
.head 7 -  ! nUr = 0 по всем бранчам россыпью 
.head 7 -  Set sSql = sSEL || IifS(sTOBO="", "", " and s.TOBO=:sTOBO ") ||
 " GROUP BY s.nbs, s.TOBO ) s , tobo T   
 WHERE t.TOBO=s.TOBO  ORDER BY s.nbs, t.TOBO "
.head 5 -  !
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call SalTblPopulate(hWndForm, hSqlAux2(), sSql, TBL_FillAll)
.head 5 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 5 -  Call SalWaitCursor(FALSE)
.head 2 +  Window Parameters
.head 3 -  String: nBAL
.head 3 -  Date/Time: dDAT
.head 3 -  Boolean: bShowAccHist
.head 3 -  String: sTOBO 
.head 3 -  Number: nUr !! = 2 итог по 2 уровню бранча
               = -2 детально по бранчам ,похожим на sTOBO
               = 0 по всем бранчам россыпью
.head 2 +  Window Variables
.head 3 -  : subMenu
.head 4 -  Class: cChildMenuEngine
.head 3 -  : cF
.head 4 -  Class: cGenFilter
.head 3 -  String: sDAT   !! dd-MM-yyyy
.head 3 -  String: sStrDop
.head 3 -  String: ss
.head 3 -  Boolean: bF8
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call subMenu.Init(hWndForm, 'menuBalans2t', '&Информация по ТОБО')
.head 4 -  Set sDAT = SalFmtFormatDateTime(dDAT, 'dd-MM-yyyy')
.head 4 -  ! sDAT: состояние (экв.) бал/сч nBAL по ИСПОЛНИТЕЛЯМ"
.head 4 -  Call SalSetWindowText(hWndForm, sDAT || ": " ||  
     CurrentLangTable.GetAtomTitle('GL_tbl2.cTWndTitle1') || " " || nBAL || " " || 
     CurrentLangTable.GetAtomTitle('GL_tbl2.cTWndTitle2') || " " || 
     IifS(sTOBO!=STRING_Null, CurrentLangTable.GetAtomTitle('GL_tbl1.cbBranch') || ' ' || sTOBO, ''))
.head 4 -  Call SalSetWindowLabelText(bgF8, CurrentLangTable.GetAtomTitle('bgF8'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set GL_tbl2t.strPrintFileName = 'TAB2T'
.head 4 -  Set GL_tbl2t.nFlags = GT_ReadOnly
.head 4 -  Call cF.Init('Accounts', 'a')
.head 4 -  Set bF8 = TRUE
.head 4 +  If bEQV
.head 5 -  Set sStrDop = "(ostq<>0 or dosq>0 or kosq>0) "
.head 4 +  Else
.head 5 -  Set sStrDop = "(ost<>0 or dos>0 or kos>0) "
.head 4 -  Set ss = sStrDop
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call NASELENIE(ss)
.head 3 +  On SAM_Activate
.head 4 -  Call subMenu.Enable(wParam)
.head 3 +  On UM_MenuComponentShow
.head 4 -  Call subMenu.ShowMenu(wParam, lParam)
.head 3 +  On SAM_DoubleClick
.head 4 +  If nHaveTOBO = 2 and nUr = 2 
.head 5 -  Call SalCreateWindow(GL_tbl2t, hWndMDI, nBAL, dDAT, bShowAccHist, GL_tbl2t.TOBO, -2)
.head 4 +  Else
.head 5 -  Call SalCreateWindow(GL_tbl3, hWndMDI, TOBO, 0, 0, nBAL, dDAT, bShowAccHist)
.head 3 +  On VTM_KeyDown
.head 4 +  If wParam = VK_F8
.head 5 +  If bF8
.head 6 -  Set ss = ""
.head 5 +  Else
.head 6 -  Set ss = sStrDop
.head 5 -  Set bF8 = NOT bF8
.head 5 -  Call NASELENIE(ss)
.head 3 +  On SAM_Destroy
.head 4 -  Call subMenu.Kill()
.head 4 -  Call SalSendClassMessage(SAM_Destroy, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set BAL = nBAL 
.head 1 +  Table Window: GL_tbl3	!! СЧЕТА - номинал
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: СЧЕТА - номинал
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.55"
.head 4 -  Top:    0.688"
.head 4 -  Width:  15.933"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 7.464"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Sky
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 10000
.head 3 -  Discardable? Class Default
.head 2 -  Description: (показывать с 0/без - F8)
.head 2 +  Named Menus
.head 3 +  Menu: menuBalans3
.head 4 -  Resource Id: 10625
.head 4 -  Title: &Информация по счетам
.head 4 -  Description:
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: &Выписка за выбранный день...
.head 5 -  Resource Id: 10626
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
.head 7 -  Call ShowTurnForAccount(GL_tbl3.ACC, SalFmtFormatDateTime( dDAT, 'MM-dd-yyyy' ) )
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: С &Оборотами
.head 5 -  Resource Id: 10627
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call NASELENIE("( dos<>0 or kos<>0)")
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: С &Дебетовыми  об
.head 5 -  Resource Id: 10628
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call NASELENIE(" dos<>0 ")
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: С &Кредитовыми об
.head 5 -  Resource Id: 10629
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call NASELENIE(" kos<>0 ")
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Без Оборотов
.head 5 -  Resource Id: 10630
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call NASELENIE("ost<>0 and dos=0 and kos=0 ")
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Активы
.head 5 -  Resource Id: 10631
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call NASELENIE(" ost<0 ")
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Пассивы
.head 5 -  Resource Id: 10632
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call NASELENIE(" ost>0 ")
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Выйти
.head 5 -  Resource Id: 10633
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 5 -  Menu Item Name:
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.405"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call NASELENIE(ss)
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 40363
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  2.333"
.head 6 -  Begin Y:  0.012"
.head 6 -  End X:  2.333"
.head 6 -  End Y:  0.476"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SetQueryFilter(cF)
.head 8 -  Call NASELENIE(ss)
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 40364
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 10191
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  4.55"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  4.55"
.head 6 -  End Y:  0.452"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Line
.head 5 -  Resource Id: 10192
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  5.217"
.head 6 -  Begin Y:  -0.06"
.head 6 -  End X:  5.217"
.head 6 -  End Y:  0.405"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Line
.head 5 -  Resource Id: 10189
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  6.4"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  6.4"
.head 6 -  End Y:  0.464"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 40365
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pb_Kli
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.683"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\K.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = "Паспорт Клиента"
.head 6 +  On SAM_Click
.head 7 +  If CUSTTYPE=2
.head 8 -  Call EditCustCorps( GL_tbl3.RNK,CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
.head 7 +  Else If CUSTTYPE =3
.head 8 -  Call EditCustPerson( GL_tbl3.RNK,CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI)
.head 7 +  Else If CUSTTYPE=1
.head 8 -  Call EditCustBanks( GL_tbl3.RNK, CVIEW_ReadOnly | CVIEW_Accounts, hWndMDI) 
.head 4 +  Check Box: cb_Eqv
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: + Eqv
.head 5 -  Window Location and Size
.head 6 -  Left:   5.35"
.head 6 -  Top:    0.15"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call F_Eqv()
.head 4 -  Background Text: F8 - Все счета/с остатками(оборотами)
.head 5 -  Resource Id: 10190
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.5"
.head 6 -  Top:    0.2"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgF8
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: ACC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ACC
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исп.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ЛС
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.683"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ВАЛ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты ДЕБЕТ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.617"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DOSs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты ДЕБЕТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DOSq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Eqv Deb
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.617"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты КРЕДИТ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.667"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOSs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты КРЕДИТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOSq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Eqv Crd
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.617"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исход.ДЕБЕТ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISDs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исход.ДЕБЕТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISDq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Eqv Deb
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.617"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исход.КРЕДИТ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.45"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISKs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исход.КРЕДИТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISKq
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Eqv Crd
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.617"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: NAMES
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование счета
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.171"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.514"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAZS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата закр
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DIG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: RNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: RNK
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: CUSTTYPE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: RNK
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: BRANCH
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отделение
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: BRANCH_NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование отделения
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  4.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: NASELENIE
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: ss
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: titl
.head 5 -  String: sTmp
.head 5 -  String: sStrPopulate
.head 5 -  String: sf
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set sf = cF.GetFilterWhereClause(FALSE)
.head 5 -  Set titl = ''
.head 5 +  If nISP > 0
.head 6 +  If SqlPrepareAndExecute(hSql(), "SELECT fio FROM staff WHERE id=:nISP INTO :sTmp")
and SqlFetchNext(hSql(), nFetchRes)
.head 7 -  ! Исп.nISP - sTmp
.head 7 -  Set titl = ", " || CurrentLangTable.GetAtomTitle('GL_tbl3.cTWndTitle3') || Str(nISP) || " - " || sTmp
.head 5 +  Else If nKV > 0
.head 6 +  If SqlPrepareAndExecute(hSql(), "SELECT name FROM tabval WHERE kv=:nKV INTO :sTmp")
and SqlFetchNext(hSql(), nFetchRes)
.head 7 -  ! Вал.nKV - sTmp
.head 7 -  Set titl = ", " || CurrentLangTable.GetAtomTitle('GL_tbl3.cTWndTitle4') || Str(nKV) || " - " || sTmp
.head 5 -  Set titl = titl || " " || 
    IifS(sTOBO!=STRING_Null, CurrentLangTable.GetAtomTitle('GL_tbl1.cbBranch') || ' ' || sTOBO, '')
.head 5 -  !
.head 5 +  If gOB22 = '1' and NOT bEQV
.head 6 -  Set sStrPopulate =
"select acc, nls, kv, isp, nmk, dos/100, kos/100, ostd/100,ostk/100, 
        nms, dazs, dig, rnk, CUSTTYPE,  
        dosq/100, kosq/100,   ostqD/100, ostqk/100, branch, name
   INTO :ACC, :NLS, :KV, :ISP, :NAME, :DOS, :KOS, :ISD, :ISK,
        :NAMES, :DAZS, :DIG, :RNK, :CUSTTYPE,
        :DOSq, :KOSq, :ISDq, :ISKq, :BRANCH, :BRANCH_NAME 
   from ( SELECT a.ACC, a.NLS, a.KV, a.ISP, c.NMK, 
                 m.DOS, m.KOS, m.DOSq, m.KOSq, 
            decode(sign(m.ost),-1,-m.ost,0) ostd,
            decode(sign(m.ostq),-1,-m.ostq,0) ostqd, 
            decode(sign(m.ost), 1, m.ost,0) ostk,
            decode(sign(m.ostq), 1, m.ostq,0) ostqk, 
                 a.nms, a.dazs, t.dig, c.rnk, c.CUSTTYPE, 
                 b.branch,  b.name  
            FROM customer c, tabval t, branch b, ACCM_SNAP_BALANCES m,
                 (select caldt_id from ACCM_CALENDAR  where caldt_date = :dDAT ) k,  
                 (select rnk,kv,isp,branch,acc , nls, dazs, nms 
                 from v_gl where (dazs is null OR dazs > :dDAT) 
                 and nbs = :nBAL " || IifS(nKV  = 0, "", " AND kv = :nKV") || 
                                      IifS(nISP = 0, "", " AND isp = :nISP") ||  
                                      IifS(sTOBO="", "", " AND tobo = :sTOBO") || 
               " ) a 
           WHERE c.rnk = a.rnk  AND a.kv = t.kv AND a.branch = b.branch
             and k.caldt_id = m.caldt_id and a.acc= m.acc " || 
                 IifS(ss="", "", " and " || ss) || 
                 IifS(sf="", "", " and " || sf) || " ) 
  ORDER BY Substr(nls,1,4) ||Substr(nls,6,9), kv"
.head 5 -  ! - по экв из SALDOA (в НБУ)
.head 5 +  Else If bEQV
.head 6 -  Set sStrPopulate =
"select acc, nls, kv, isp, nmk, dos/100, kos/100, ostd/100,ostk/100, 
        nms, dazs, dig, rnk, CUSTTYPE,
        dosq/100, kosq/100, ostdq/100, ostkq/100,
        branch, branch_name
   INTO :ACC, :NLS, :KV, :ISP, :NAME, :DOS, :KOS, :ISD, :ISK,
        :NAMES, :DAZS, :DIG, :RNK, :CUSTTYPE,
        :DOSq, :KOSq, :ISDq, :ISKq, :BRANCH, :BRANCH_NAME 
   from ( SELECT a.ACC, a.NLS, a.KV, a.ISP, c.NMK, a.DOS, a.KOS, 
                 decode(sign(a.ost),-1,-a.ost,0) ostd, 
                 decode(sign(a.ost), 1, a.ost,0) ostk,
                 a.DOSq, a.KOSq, 
                 decode(sign(a.ostq),-1,-a.ostq,0) ostdq, 
                 decode(sign(a.ostq), 1, a.ostq,0) ostkq, 
                 a.nms, a.dazs, t.dig, c.rnk, c.CUSTTYPE, " ||
                 IifS(nHaveTOBO=2, "b.branch", IifS(nHaveTOBO=1, "b.tobo", "null")) || " branch, " ||
                 IifS(nHaveTOBO=2, "b.name",   IifS(nHaveTOBO=1, "b.name", "null")) || " branch_name
            FROM salq a, customer c, tabval t" ||
                 IifS(nHaveTOBO=2, ", branch b", IifS(nHaveTOBO=1, ", tobo b", "")) || "  
           WHERE (a.dazs is null OR a.dazs > a.fdat) 
             AND a.fdat = :dDAT AND c.rnk = a.rnk 
             AND a.nbs = :nBAL AND a.kv = t.kv " || 
                 IifS(nKV  = 0, "", " AND a.kv = :nKV") || 
                 IifS(nISP = 0, "", " AND a.isp = :nISP") ||  
                 IifS(sTOBO="", "", " AND a.tobo = :sTOBO") ||     
                 IifS(nHaveTOBO=2,  " AND a.branch = b.branch", 
                 IifS(nHaveTOBO=1,  " AND a.tobo = b.tobo", "")) || 
                 IifS(ss="", "", " and " || ss) || 
                 IifS(sf="", "", " and " || sf) || " ) 
  ORDER BY Substr(nls,1,4) ||Substr(nls,6,9), kv"
.head 5 -  ! - для КБ
.head 5 +  Else
.head 6 -  Set sStrPopulate =
"select acc, nls, kv, isp, nmk, dos/100, kos/100, ostd/100,ostk/100, 
        nms, dazs, dig, rnk, CUSTTYPE,
        gl.p_icurval(kv,dos, :dDAT)/100, gl.p_icurval(kv,kos, :dDAT)/100, 
        gl.p_icurval(kv,ostd,:dDAT)/100, gl.p_icurval(kv,ostk,:dDAT)/100,
        branch, branch_name
   INTO :ACC, :NLS, :KV, :ISP, :NAME, :DOS, :KOS, :ISD, :ISK,
        :NAMES, :DAZS, :DIG, :RNK, :CUSTTYPE,
        :DOSq, :KOSq, :ISDq, :ISKq, :BRANCH, :BRANCH_NAME 
   from ( SELECT a.ACC, a.NLS, a.KV, a.ISP, c.NMK, a.DOS, a.KOS, 
                 decode(sign(a.ost),-1,-a.ost,0) ostd, 
                 decode(sign(a.ost), 1, a.ost,0) ostk, 
                 a.nms, a.dazs, t.dig, c.rnk, c.CUSTTYPE, " ||
                 IifS(nHaveTOBO=2, "b.branch", IifS(nHaveTOBO=1, "b.tobo", "null")) || " branch, " ||
                 IifS(nHaveTOBO=2, "b.name",   IifS(nHaveTOBO=1, "b.name", "null")) || " branch_name
            FROM sal a, customer c, tabval t" ||
                 IifS(nHaveTOBO=2, ", branch b", IifS(nHaveTOBO=1, ", tobo b", "")) || "  
           WHERE (a.dazs is null OR a.dazs > a.fdat) 
             AND a.fdat = :dDAT AND c.rnk = a.rnk 
             AND a.nbs = :nBAL AND a.kv = t.kv " || 
                 IifS(nKV  = 0, "", " AND a.kv = :nKV") || 
                 IifS(nISP = 0, "", " AND a.isp = :nISP") ||  
                 IifS(sTOBO="", "", " AND a.tobo = :sTOBO") ||     
                 IifS(nHaveTOBO=2,  " AND a.branch = b.branch", 
                 IifS(nHaveTOBO=1,  " AND a.tobo = b.tobo", "")) || 
                 IifS(ss="", "", " and " || ss) || 
                 IifS(sf="", "", " and " || sf) || " ) 
  ORDER BY Substr(nls,1,4) ||Substr(nls,6,9), kv"
.head 5 -  ! sDAT : Состояние ЛС (ном), БС nBAL titl
.head 5 -  Call SalSetWindowText(hWndForm, sDAT || ": " || 
     CurrentLangTable.GetAtomTitle('GL_tbl3.cTWndTitle1') || ", " || 
     CurrentLangTable.GetAtomTitle('GL_tbl3.cTWndTitle2') || " " || nBAL || titl)
.head 5 -  Call F_Eqv()
.head 5 -  Call SalTblPopulate(hWndForm, hSql(), sStrPopulate, TBL_FillAll)
.head 5 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 5 -  Call SalWaitCursor(FALSE)
.head 3 +  Function: F_Eqv
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If cb_Eqv = 0
.head 6 -  Call SalHideWindow( DOSq )
.head 6 -  Call SalHideWindow( KOSq )
.head 6 -  Call SalHideWindow( ISDq )
.head 6 -  Call SalHideWindow( ISKq )
.head 5 +  Else
.head 6 -  Call SalShowWindow( DOSq )
.head 6 -  Call SalShowWindow( KOSq )
.head 6 -  Call SalShowWindow( ISDq )
.head 6 -  Call SalShowWindow( ISKq )
.head 2 +  Window Parameters
.head 3 -  String: sTOBO 
.head 3 -  Number: nKV  !! nKV=0 and nISP=0 
.head 3 -  Number: nISP
.head 3 -  String: nBAL
.head 3 -  Date/Time: dDAT
.head 3 -  Boolean: bShowAccHist
.head 2 +  Window Variables
.head 3 -  : subMenu
.head 4 -  Class: cChildMenuEngine
.head 3 -  : cF
.head 4 -  Class: cGenFilter
.head 3 -  String: sDAT !!  dd-MM-yyyy
.head 3 -  String: ss
.head 3 -  Number: nTmp
.head 3 -  !
.head 3 -  Number: nDig
.head 3 -  Boolean: bF8
.head 3 -  Window Handle: hColumn
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowLabelText(bgF8, CurrentLangTable.GetAtomTitle('bgF8'))
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call subMenu.Init(hWndForm, 'menuBalans3', CurrentLangTable.GetAtomTitle('GL_tbl3.cTMenu'))
.head 4 -  Set sDAT = SalFmtFormatDateTime(dDAT, 'dd-MM-yyyy')
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set GL_tbl3.strPrintFileName = 'TAB3'
.head 4 -  Set GL_tbl3.nFlags = GT_ReadOnly
.head 4 -  Set bF8 = TRUE
.head 4 -  Set cb_Eqv = 0
.head 4 -  !
.head 4 -  Call cF.Init('Sal', 'a')
.head 4 +  If GetAccountStructure(nTmp,nTmp,nTmp,nTmp) ! Прижимать влево или вправо
.head 5 -  Call SalTblSetColumnFlags(NLS, COL_RightJustify, TRUE)
.head 4 +  If bEQV
.head 5 -  Set ss = " (ostq<>0 or dosq<>0 or kosq<>0) "
.head 4 +  Else
.head 5 -  Set ss = " (ost<>0 or dos<>0 or kos<>0) "
.head 4 +  If not bShowAccHist
.head 5 -  Call SalHideWindow(GL_tbl3.NAME)
.head 5 -  Call SalHideWindow(GL_tbl3.NAMES)
.head 4 +  If not bShowClient3
.head 5 -  Call SalHideWindow(GL_tbl3.NAME)
.head 5 -  Call SalHideWindow(GL_tbl3.pb_Kli)
.head 4 +  If nHaveTOBO = 0
.head 5 -  Call SalHideWindow(BRANCH)
.head 5 -  Call SalHideWindow(BRANCH_NAME)
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 4 +  If SetQueryFilter(cF)
.head 5 -  Call NASELENIE(ss)
.head 4 -  Call SalEnableWindow(pbFilter)
.head 3 +  On SAM_Activate
.head 4 -  Call subMenu.Enable(wParam)
.head 3 +  On UM_MenuComponentShow
.head 4 -  Call subMenu.ShowMenu(wParam, lParam)
.head 3 +  On WM_RbuttonDblClick
.head 4 +  If bShowAccHist
.head 5 -  Call ShowTurnForAccount(GL_tbl3.ACC, SalFmtFormatDateTime(dDAT, 'MM-dd-yyyy'))
.head 3 +  On SAM_DoubleClick
.head 4 +  If bShowAccHist
.head 5 -  Call Show_Sal_Day_P(GL_tbl3.ACC, GL_tbl3.NLS, GL_tbl3.KV, dDAT-10, dDAT)
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set DOSs = Dig4(DOS, DIG, 4)
.head 4 -  Set KOSs = Dig4(KOS, DIG, 4)
.head 4 -  Set ISDs = Dig4(ISD, DIG, 4)
.head 4 -  Set ISKs = Dig4(ISK, DIG, 4)
.head 3 +  On SAM_ColumnSelectClick
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Set bSortOrd = not bSortOrd
.head 4 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 4 -  Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
.head 4 -  ! сортировка строковых столбцов по числовым
.head 4 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(DOSs), COL_GetID)
.head 5 -  Set wParam=SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(DOS), COL_GetID))
.head 4 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(KOSs), COL_GetID)
.head 5 -  Set wParam=SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(KOS), COL_GetID))
.head 4 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(ISDs), COL_GetID)
.head 5 -  Set wParam=SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(ISD), COL_GetID))
.head 4 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(ISKs), COL_GetID)
.head 5 -  Set wParam=SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(ISK), COL_GetID))
.head 4 -  !
.head 4 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 4 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(hColumn), bSortOrd)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On VTM_KeyDown
.head 4 +  If wParam = VK_F8
.head 5 +  If bF8
.head 6 -  Set ss = ""
.head 5 +  Else
.head 6 +  If bEQV
.head 7 -  Set ss = " (ostq<>0 or dosq<>0 or kosq<>0) "
.head 6 +  Else
.head 7 -  Set ss = " (ost<>0 or dos<>0 or kos<>0) "
.head 5 -  Set bF8 = NOT bF8
.head 5 -  Call NASELENIE(ss)
.head 3 +  On SAM_Destroy
.head 4 -  Call subMenu.Kill()
.head 4 -  Call SalSendClassMessage(SAM_Destroy, 0, 0)
.head 1 +  Table Window: GL_tbl4	!! БС по ВАЛЮТАМ - номинал
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: по ВАЛЮТАМ - номинал
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   -0.088"
.head 4 -  Top:    0.25"
.head 4 -  Width:  14.667"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 7.0"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Light Periwinkle
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 10000
.head 3 -  Discardable? Class Default
.head 2 -  Description: (показывать с 0/без - F8)
.head 2 +  Named Menus
.head 3 +  Menu: menuBalans4
.head 4 -  Resource Id: 10634
.head 4 -  Title: &Информация по ВАЛЮТАМ
.head 4 -  Description:
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: С &Оборотами
.head 5 -  Resource Id: 10635
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Set ss="(dos>0 or kos>0)"
.head 6 -  Call NASELENIE(ss)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: С &Дебетовыми  об
.head 5 -  Resource Id: 10636
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Set ss="(dos>0)"
.head 6 -  Call NASELENIE(ss)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: С &Кредитовыми об
.head 5 -  Resource Id: 10637
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Set ss="(kos>0)"
.head 6 -  Call NASELENIE(ss)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Без Оборотов
.head 5 -  Resource Id: 10638
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Set ss="(dos=0 and kos=0)"
.head 6 -  Call NASELENIE(ss)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Активы
.head 5 -  Resource Id: 10639
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Set ss="(ost<0)"
.head 6 -  Call NASELENIE(ss)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Пассивы
.head 5 -  Resource Id: 10640
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Set ss="(ost>0)"
.head 6 -  Call NASELENIE(ss)
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Выйти
.head 5 -  Resource Id: 10641
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 5 -  Menu Item Name:
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.429"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set ss = " (ost<>0 or dos>0 or kos>0) "
.head 7 -  Set bF8 = TRUE
.head 7 -  Call NASELENIE(ss)
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 37421
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.983"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  1.983"
.head 6 -  End Y:  0.464"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 37422
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 37423
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Background Text: F8 - Все счета/с остатками(оборотами)
.head 5 -  Resource Id: 10193
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.7"
.head 6 -  Top:    0.2"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgF8
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: BAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: БАЛ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ВАЛ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты ДЕБЕТ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.517"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DOSs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты ДЕБЕТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты КРЕДИТ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.783"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOSs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты КРЕДИТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исходящий ДЕБЕТ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.767"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISDs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исходящий ДЕБЕТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исходящий КРЕДИТ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISKs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исходящий КРЕДИТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование валюты
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  6.933"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DIG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: dig
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: NASELENIE
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: ss
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  If gOB22 = '1' and NOT bEQV
.head 6 -  Call SalTblPopulate(hWndForm, hSqlAux3(), 
"SELECT a.kv, t.name,  t.DIG ,
       sum(m.dos)/100, sum(m.kos)/100 kos, 
       sum(decode(sign(m.ost),-1,-m.ost,0))/100 ostd, 
       sum(decode(sign(m.ost), 1, m.ost,0))/100 ostk   
   INTO :KV, :NAME, :DIG, :DOS, :KOS, :ISD, :ISK
   FROM tabval t , ACCM_SNAP_BALANCES m, 
        (select caldt_id from ACCM_CALENDAR  where caldt_date = :dDAT ) k,  
        (select acc,kv from v_gl 
         where nbs = :nBAL and (dazs is NULL OR dazs >= :dDAT) " || 
         IifS(sTOBO="", "", " and s.TOBO=:sTOBO ") || " ) a 
  WHERE t.kv = a.kv and k.caldt_id = m.caldt_id and a.acc= m.acc 
  GROUP BY a.kv, t.name,  t.DIG    
  ORDER BY a.kv", TBL_FillAll)
.head 5 +  Else
.head 6 -  Call SalTblPopulate(hWndForm, hSqlAux3(), 
"SELECT a.nbs, a.kv, t.name,dos, kos, ostd, ostk, t.dig 
   INTO :BAL, :KV, :NAME, :DOS, :KOS, :ISD, :ISK, :DIG 
   FROM (SELECT nbs, kv, 
                sum(dos)/100 dos, sum(kos)/100 kos, 
                sum(decode(sign(ost),-1,-ost,0))/100 ostd, 
                sum(decode(sign(ost), 1, ost,0))/100 ostk 
           FROM sal s
          WHERE fdat = :dDAT
            AND nbs  = :nBAL " || 
                IifS( ss = "", "", " and " || ss ) || 
                IifS(sTOBO="", "", " and s.tobo=:sTOBO ") || " 
          GROUP BY nbs, kv) a, tabval t 
  WHERE t.kv = a.kv    
  ORDER BY a.nbs, a.kv", TBL_FillAll)
.head 5 -  !
.head 5 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 5 -  Call SalWaitCursor(FALSE)
.head 2 +  Window Parameters
.head 3 -  String: nBAL
.head 3 -  Date/Time: dDAT
.head 3 -  Boolean: bShowAccHist
.head 3 -  String: sTOBO 
.head 2 +  Window Variables
.head 3 -  : subMenu
.head 4 -  Class: cChildMenuEngine
.head 3 -  String: sDAT
.head 3 -  String: ss
.head 3 -  Boolean: bF8
.head 3 -  Number: nDig
.head 3 -  Number: nMaxDig
.head 3 -  Window Handle: hColumn
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call subMenu.Init(hWndForm, 'menuBalans4', CurrentLangTable.GetAtomTitle('GL_tbl4.cTMenu'))
.head 4 -  Set sDAT = SalFmtFormatDateTime(dDAT, 'dd-MM-yyyy')
.head 4 -  ! sDAT: Cостояние БС (ном) nBAL по ВАЛЮТАМ
.head 4 -  Call SalSetWindowText(hWndForm, sDAT || ": " || 
     CurrentLangTable.GetAtomTitle('GL_tbl4.cTWndTitle1') || " " || nBAL || " " || 
     CurrentLangTable.GetAtomTitle('GL_tbl4.cTWndTitle2') || " " || 
     IifS(sTOBO!=STRING_Null, CurrentLangTable.GetAtomTitle('GL_tbl1.cbBranch') || ' ' || sTOBO, ''))
.head 4 -  Call SalSetWindowLabelText(bgF8, CurrentLangTable.GetAtomTitle('bgF8'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set GL_tbl4.strPrintFileName = 'TAB4'
.head 4 -  Set GL_tbl4.nFlags = GT_ReadOnly
.head 4 -  Set bF8 = TRUE
.head 4 -  Set ss  = "(dos>0 or kos>0 or ost<>0)"
.head 4 +  If DigInit() != -1
.head 5 -  Set nMaxDig = DigInit()
.head 4 +  Else
.head 5 -  Set nMaxDig = 4
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call NASELENIE(ss)
.head 3 +  On SAM_Activate
.head 4 -  Call subMenu.Enable(wParam)
.head 3 +  On UM_MenuComponentShow
.head 4 -  Call subMenu.ShowMenu(wParam, lParam)
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalCreateWindow( GL_tbl3, hWndMDI, sTOBO, KV, 0, nBAL, dDAT, bShowAccHist )
.head 3 +  On SAM_FetchRowDone
.head 4 -  ! проверка на 3 знака
.head 4 -  Set DOSs = Dig4(DOS, DIG, nMaxDig)
.head 4 -  Set KOSs = Dig4(KOS, DIG, nMaxDig)
.head 4 -  Set ISDs = Dig4(ISD, DIG, nMaxDig)
.head 4 -  Set ISKs = Dig4(ISK, DIG, nMaxDig)
.head 4 -  Set BAL = nBAL 
.head 3 +  On SAM_ColumnSelectClick
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Set bSortOrd = not bSortOrd
.head 4 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 4 -  Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
.head 4 -  ! сортировка строковых столбцов по числовым
.head 4 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(DOSs), COL_GetID)
.head 5 -  Set wParam=SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(DOS), COL_GetID))
.head 4 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(KOSs), COL_GetID)
.head 5 -  Set wParam=SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(KOS), COL_GetID))
.head 4 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(ISDs), COL_GetID)
.head 5 -  Set wParam=SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(ISD), COL_GetID))
.head 4 +  If SalNumberToWindowHandle(wParam) = SalTblGetColumnWindow(hWndForm, SalTblQueryColumnID(ISKs), COL_GetID)
.head 5 -  Set wParam=SalWindowHandleToNumber(SalTblGetColumnWindow(hWndForm, SalTblQueryColumnPos(ISK), COL_GetID))
.head 4 -  !
.head 4 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 4 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(hColumn), bSortOrd)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On VTM_KeyDown
.head 4 +  If wParam = VK_F8
.head 5 +  If bF8
.head 6 -  Set ss = ""
.head 5 +  Else
.head 6 -  Set ss = " (ost<>0 or dos>0 or kos>0) "
.head 5 -  Set bF8 = NOT bF8
.head 5 -  Call NASELENIE(ss)
.head 3 +  On SAM_Destroy
.head 4 -  Call subMenu.Kill()
.head 4 -  Call SalSendClassMessage(SAM_Destroy, 0, 0)
.head 1 +  Table Window: GL_tbl5	!! БС по ДАТАМ - эквивалент
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: ПО ДАТАМ
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.275"
.head 4 -  Top:    0.344"
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Maize
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 10000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Data Field: dDat1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.183"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Дата початку періоду аналізу')
.head 4 +  Data Field: dDat2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.383"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.9"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Дата завершення періоду аналізу')
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.583"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call NASELENIE('')
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 12151
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  4.483"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  4.483"
.head 6 -  End Y:  0.464"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.183"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 12152
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.383"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 12153
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: BAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: БАЛ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Right
.head 4 -  Width:  1.317"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты ДЕБЕТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.367"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты КРЕДИТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исходящий ДЕБЕТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.667"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исходящий КРЕДИТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.4"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: NASELENIE
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: ss
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sStrPopulate
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set iDOS = 0
.head 5 -  Set iKOS = 0
.head 5 +  If gOB22 = '1' and NOT bEQV
.head 6 -  Set sStrPopulate = 
"SELECT k.caldt_date, sum(m.dosq)/100,  sum(m.kosq)/100, 
        sum(decode(sign(m.ostq),-1,-m.ostq,0))/100, 
        sum(decode(sign(m.ostq), 1, m.ostq,0))/100 
   INTO :DAT, :DOS, :KOS, :ISD, :ISK 
   FROM ACCM_SNAP_BALANCES m,
     (select caldt_id , caldt_date  from ACCM_CALENDAR 
      where caldt_date >= :dDat1 AND caldt_date <= :dDat2) k,
     (select acc from v_gl where nbs=:nBAL " ||
      IifS(sTOBO="", "", " and tobo=:sTOBO ") || " ) a
  where a.acc=m.acc and m.caldt_id= k.caldt_id 
   GROUP BY  k.caldt_date  
  ORDER BY 1 desc "
.head 5 -  ! - В казначействе - без валют вообще
.head 5 +  Else If bCUR
.head 6 -  Set sStrPopulate =
"SELECT FDAT,sum(DOS)/100, sum(KOS)/100, 
        sum(decode(sign(ost),-1,-ost,0))/100, 
        sum(decode(sign(ost), 1, ost,0))/100 
   INTO :DAT, :DOS, :KOS, :ISD, :ISK 
   FROM sal 
  WHERE nbs=:nBAL AND fdat>=:dDat1 AND fdat<=:dDat2 " || 
IifS(sTOBO="", "", " and tobo=:sTOBO ") || " 
  GROUP BY FDAT 
  ORDER BY 1 desc "
.head 5 -  ! - по экв из SALDOA (в НБУ)
.head 5 +  Else If bEQV
.head 6 -  Set sStrPopulate =
"SELECT FDAT,sum(DOSQ)/100, sum(KOSQ)/100, 
        sum(decode(sign(ostq),-1,-ostq,0))/100, 
        sum(decode(sign(ostq), 1, ostq,0))/100 
   INTO :DAT, :DOS, :KOS, :ISD, :ISK 
   FROM salQ 
  WHERE nbs=:nBAL AND fdat>=:dDat1 AND fdat<= :dDat2 " || 
IifS(sTOBO="", "", " and tobo=:sTOBO ") || " 
  GROUP BY FDAT 
  ORDER BY 1 desc "
.head 5 -  ! - для КБ
.head 5 +  Else
.head 6 -  Set sStrPopulate = 
"SELECT FDAT, sum(DOS)/100, sum(KOS)/100, sum(ISD)/100, sum(ISK)/100 
   INTO :DAT, :DOS, :KOS, :ISD, :ISK 
   FROM (SELECT fdat FDAT, sum(dos) DOS, sum(kos) KOS, 
                sum(decode(sign(ost),-1,-ost,0)) ISD, 
                sum(decode(sign(ost), 1, ost,0)) ISK 
           FROM sal 
          WHERE kv=:n980 AND nbs=:nBAL AND fdat>=:dDat1 AND fdat<=:dDat2 "|| 
                IifS(sTOBO="", "", " and tobo=:sTOBO ") || " 
          GROUP BY fdat
      UNION ALL
         SELECT fdat, sum(dos), sum(kos), 
                sum(decode(sign(ost),-1,-ost,0)), 
                sum(decode(sign(ost), 1, ost,0)) 
           FROM salB 
          WHERE kv<>:n980 AND nbs=:nBAL AND fdat>=:dDat1 AND fdat<=:dDat2 "|| 
                IifS(sTOBO="", "", " and tobo=:sTOBO ") || " 
          GROUP BY fdat) 
  GROUP BY FDAT 
  ORDER BY 1 desc "
.head 5 -  !
.head 5 -  Call SalTblPopulate(hWndForm,hSql(), sStrPopulate, TBL_FillAll)
.head 5 -  !
.head 5 -  Call SalTblDefineSplitWindow(hWndForm, 1, TBL_Split_Adjustable)
.head 5 -  Call SalTblFetchRow(hWndForm, SalTblInsertRow(hWndForm, TBL_MinSplitRow))
.head 5 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 5 -  Set GL_tbl5.BAL = "****"
.head 5 -  Set GL_tbl5.DOS = iDOS
.head 5 -  Set GL_tbl5.KOS = iKOS
.head 5 -  !
.head 5 -  Call SalWaitCursor(FALSE)
.head 2 +  Window Parameters
.head 3 -  String: nBAL
.head 3 -  Date/Time: dDAT
.head 3 -  Number: nShowClient
.head 3 -  String: sTOBO 
.head 2 +  Window Variables
.head 3 -  Number: n980
.head 3 -  Number: iDOS
.head 3 -  Number: iKOS
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  ! Текущее состояние (экв.) балансового счета nBAL по ДАТАМ
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('GL_tbl5.cTWndTitle1') || " " || nBAL || " " || 
     CurrentLangTable.GetAtomTitle('GL_tbl5.cTWndTitle2') || " " || 
     IifS(sTOBO!=STRING_Null, CurrentLangTable.GetAtomTitle('GL_tbl1.cbBranch') || ' ' || sTOBO, ''))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set GL_tbl5.strPrintFileName = 'TAB5'
.head 4 -  Set n980  = GetBaseVal()
.head 4 -  Set dDat2 = dDAT
.head 4 -  Set dDat1 = dDat2 - 10
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call NASELENIE("")
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set BAL  = nBAL
.head 4 -  Set iDOS = iDOS + DOS
.head 4 -  Set iKOS = iKOS + KOS
.head 3 +  On SAM_DoubleClick
.head 4 -  Call SalCreateWindow(GL_tbl3, hWndMDI, '', 0, 0, nBAL, dDAT, nShowClient)
.head 1 +  Table Window: GL_tbl6	!! ИТОГИ - эквивалент
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Текущее состояние  БАЛАНСА (экв)
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Light Green
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 1000
.head 3 -  Discardable? Class Default
.head 2 -  Description: (показывать с 0/без - F8)
.head 2 +  Named Menus
.head 3 +  Menu: menuBalans6
.head 4 -  Resource Id: 14770
.head 4 -  Title: &Итоги
.head 4 -  Description:
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: &Вперед
.head 5 -  Resource Id: 14771
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 7 -  Call SalSendMsg(hWndForm, SAM_DoubleClick, 0, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Назад
.head 5 -  Resource Id: 14772
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg(hWndForm, WM_RbuttonDblClick, 0, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Обновить
.head 5 -  Resource Id: 14773
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If bEQV
.head 7 -  Set sdop = " (dosq>0 or kosq>0 or ostq<>0)"
.head 6 +  Else
.head 7 -  Set sdop = " (a.DOS>0 or a.KOS>0 or a.ISD<>0 or a.ISK<>0) "
.head 6 -  Set bF8 = TRUE
.head 6 -  Call SalSendMsg(hWndForm, SAM_Create, 0, 0)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: &Экспорт...
.head 5 -  Resource Id: 14774
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call TablePrint(hWndForm,
     SalFmtFormatDateTime(GetBankDate(),ddMMyyyy()) || titl,
     GetPrnDir() || '\\' || SqlUser,
     '2,3,4,5')
.head 5 -  Menu Item Name:
.head 4 -  Menu Separator
.head 4 +  Menu Item: &Выйти
.head 5 -  Resource Id: 14775
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 5 -  Menu Item Name:
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 14776
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 14777
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 14778
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Background Text: F8 - Все счета/с остатками(оборотами)
.head 5 -  Resource Id: 20707
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.7"
.head 6 -  Top:    0.2"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgF8
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: BAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: БАЛ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты ДЕБЕТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.65"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты КРЕДИТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  3.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исходящий ДЕБЕТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исходящий КРЕДИТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование балансового счета
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  6.933"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: NASELENIE
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: pp
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: BS
.head 5 -  String: ss1
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set BS = 'Substr(nbs,1,' || pp || ')'
.head 5 -  !
.head 5 -  Set iDOS = 0
.head 5 -  Set iKOS = 0
.head 5 -  Set iISD = 0
.head 5 -  Set iISK = 0
.head 5 +  If gOB22 = '1' and NOT bEQV
.head 6 -  Set ss1 = 
"SELECT a.NBS, p.name, a.DOS/100, a.KOS/100, a.ISD/100, a.ISK/100 
 INTO :BAL, :NAME, :DOS, :KOS, :ISD, :ISK 
 FROM PS p ,
      (SELECT NBS, sum(m.dosq) DOS, sum(m.kosq) KOS, 
             -sum(decode(sign(m.ostq),-1,m.ostq,0)) ISD, 
              sum(decode(sign(m.ostq), 1,m.ostq,0)) ISK 
        FROM 
           (select * from ACCM_SNAP_BALANCES      " || IifS(sdop ="", "", " where " || sdop      ) || ") m,
           (select acc," || BS || " NBS from v_gl " || IifS(sTOBO="", "", " where branch=:sTOBO ") || ") v ,
           (select caldt_id from ACCM_CALENDAR  where caldt_date = :dDAT ) k
        WHERE k.caldt_id = m.caldt_id and v.acc= m.acc " || IifS(ss  ="", "", " and " || ss  )     ||  
" GROUP BY NBS ) a 
  WHERE to_number(p.nbs)=to_number(a.NBS) 
  ORDER BY a.NBS "
.head 5 -  ! - В казначействе - без валют вообще
.head 5 +  Else If bCUR
.head 6 -  Set ss1 =
"SELECT a.NBS, p.name, a.DOS/100, a.KOS/100, a.ISD/100, a.ISK/100 
   INTO :BAL, :NAME, :DOS, :KOS, :ISD, :ISK 
   FROM (SELECT " || BS || " NBS, sum(dos) DOS, sum(kos) KOS, 
               -sum(decode(sign(ost),-1,ost,0)) ISD, 
                sum(decode(sign(ost), 1,ost,0)) ISK 
           FROM sal a 
          WHERE fdat = :dDAT " || 
                IifS(ss   ="", "", " AND " || ss) || 
                IifS(sdop ="", "", " and " || sdop) || 
                IifS(sTOBO="", "", " and tobo=:sTOBO ") || " 
  GROUP BY " || BS || ") a , PS p 
  WHERE to_number(p.nbs)=to_number(a.NBS) 
  ORDER BY a.NBS "
.head 5 -  ! - по экв из SALDOA (в НБУ)
.head 5 +  Else If bEQV
.head 6 -  Set ss1 = 
"SELECT a.NBS, p.name, a.DOSQ/100, a.KOSQ/100, a.ISDQ/100, a.ISKQ/100 
   INTO :BAL, :NAME, :DOS, :KOS, :ISD, :ISK 
   FROM (SELECT " || BS || " NBS, sum(dosq) DOSQ, sum(kosq) KOSQ, 
               -sum(decode(sign(ostq),-1,ostq,0)) ISDQ, 
                sum(decode(sign(ostq), 1,ostq,0)) ISKQ 
           FROM salQ 
          WHERE fdat = :dDAT " || 
                IifS(ss   ="", "", " AND " || ss) || 
                IifS(sdop ="", "", " and " || sdop) || 
                IifS(sTOBO="", "", " and tobo=:sTOBO ") || " 
          GROUP BY " || BS || ") a , PS p 
  WHERE to_number(p.nbs)=to_number(a.NBS) 
  ORDER BY a.NBS "
.head 5 -  ! - для КБ
.head 5 +  Else
.head 6 +  If dDAT = GetBankDate()
.head 7 -  Set ss1 =
"SELECT a.NBS, p.name, 
        sum(gl.p_icurval(a.KV,a.DOS,BANKDATE))/100, 
        sum(gl.p_icurval(a.KV,a.KOS,BANKDATE))/100, 
        sum(gl.p_icurval(a.KV,a.ISD,BANKDATE))/100, 
        sum(gl.p_icurval(a.KV,a.ISK,BANKDATE))/100 
   INTO :BAL, :NAME, :DOS, :KOS, :ISD, :ISK 
   FROM (SELECT " || BS || " NBS, kv KV, 
                sum(decode(dapp,BANKDATE,dos,0)) DOS, 
                sum(decode(dapp,BANKDATE,kos,0)) KOS, 
               -sum(decode(sign(ostc),-1,ostc,0)) ISD, 
                sum(decode(sign(ostc), 1,ostc,0)) ISK 
           FROM V_GL  
           WHERE nbs is not null" ||
             IifS( ss  ="", "", " and " || ss) || 
             IifS(sTOBO="", "", " and tobo=:sTOBO ") || "  
          GROUP BY " || BS || ", kv ) a , PS p 
  WHERE to_number(p.nbs)=to_number(a.NBS) " || 
        IifS(sdop="", "", " and " || sdop) || " 
  GROUP BY a.NBS, p.name 
  ORDER BY a.NBS "
.head 6 +  Else
.head 7 -  Set ss1 = 
"SELECT a.NBS, p.name, sum(a.DOS)/100, sum(a.KOS)/100, 
        sum(a.ISD)/100, sum(a.ISK)/100 
   INTO :BAL, :NAME, :DOS, :KOS, :ISD, :ISK 
   FROM (SELECT " || BS || " NBS, sum(dos) DOS, sum(kos) KOS, 
               -sum(decode(sign(ost),-1,ost,0)) ISD, 
                sum(decode(sign(ost), 1,ost,0)) ISK 
           FROM sal 
          WHERE fdat = :dDAT AND kv = :n980 " || 
                IifS(ss   ="", "", " AND " || ss) || 
                IifS(sTOBO="", "", " and tobo=:sTOBO ") || "  
          GROUP BY " || BS || " 
      UNION ALL
         SELECT " || BS || ", sum(dos), sum(kos), 
               -sum(decode(sign(ost),-1,ost,0)), 
                sum(decode(sign(ost), 1,ost,0)) 
           FROM salB 
          WHERE fdat = :dDAT AND kv <> :n980 " || 
                IifS( ss = "", "", " AND " || ss) || 
                IifS(sTOBO="", "", " and tobo=:sTOBO ") || " 
          GROUP BY " || BS || " ) a , PS p 
  WHERE to_number(p.nbs)=to_number(a.NBS) " || 
        IifS(sdop="", "", " and " || sdop) || " 
  GROUP BY a.NBS, p.name 
  ORDER BY a.NBS "
.head 5 -  Call SalTblPopulate(hWndForm, hSql(), ss1, TBL_FillAll)
.head 5 -  !
.head 5 -  Call SalTblDefineSplitWindow(hWndForm, 1, TBL_Split_Adjustable)
.head 5 -  Call SalTblFetchRow(hWndForm, SalTblInsertRow(hWndForm, TBL_MinSplitRow))
.head 5 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 5 -  Set GL_tbl6.BAL = "****"
.head 5 -  Set GL_tbl6.DOS = iDOS
.head 5 -  Set GL_tbl6.KOS = iKOS
.head 5 -  Set GL_tbl6.ISD = iISD
.head 5 -  Set GL_tbl6.ISK = iISK
.head 5 -  !
.head 5 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 5 -  Call SalWaitCursor(FALSE)
.head 2 +  Window Parameters
.head 3 -  String: pp
.head 3 -  Date/Time: dDAT
.head 3 -  String: sTOBO 
.head 2 +  Window Variables
.head 3 -  : subMenu
.head 4 -  Class: cChildMenuEngine
.head 3 -  String: sDAT
.head 3 -  String: ss
.head 3 -  String: titl
.head 3 -  Number: nn
.head 3 -  Number: n980
.head 3 -  Number: iDOS
.head 3 -  Number: iKOS
.head 3 -  Number: iISD
.head 3 -  Number: iISK
.head 3 -  Boolean: bF8
.head 3 -  String: sdop
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Set sDAT = SalFmtFormatDateTime(dDAT, 'dd-MM-yyyy')
.head 4 -  ! sDAT: Состояние (экв.)  Б А Л А Н С А . Итоги pp-го уровня
.head 4 -  Set titl = sDAT || ": " || 
    CurrentLangTable.GetAtomTitle('GL_tbl6.cTWndTitle1') || " " || pp || " " || 
    CurrentLangTable.GetAtomTitle('GL_tbl6.cTWndTitle2') || " " || 
    IifS(sTOBO!=STRING_Null, CurrentLangTable.GetAtomTitle('GL_tbl1.cbBranch') || ' ' || sTOBO, '')
.head 4 -  Call SalSetWindowText(hWndForm, titl)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalSetWindowLabelText(bgF8, CurrentLangTable.GetAtomTitle('bgF8'))
.head 4 -  ! Итоги
.head 4 -  Call subMenu.Init(hWndForm, 'menuBalans6', CurrentLangTable.GetAtomTitle('GL_tbl6.cTMenu'))
.head 4 +  If bCUR 
.head 5 -  Set sdop = " (a.DOS>0 or a.KOS>0 or a.ost<>0)"
.head 4 +  Else If bEQV
.head 5 -  Set sdop = " (dosq>0 or kosq>0 or ostq<>0)"
.head 4 +  Else
.head 5 -  Set sdop = " (a.DOS>0 or a.KOS>0 or a.ISD<>0 or ISK<>0)"
.head 4 -  Set bF8  = TRUE
.head 4 -  Set ss   = ''
.head 4 -  Set n980 = GetBaseVal()
.head 4 -  Set nn   = Val(pp)
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call NASELENIE(pp)
.head 3 +  On SAM_Activate
.head 4 -  Call subMenu.Enable(wParam)
.head 3 +  On UM_MenuComponentShow
.head 4 -  Call subMenu.ShowMenu(wParam, lParam)
.head 3 +  On SAM_DoubleClick !! вперед
.head 4 +  If nn < 3
.head 5 -  Set ss = "Substr(nbs,1," || Str(nn) || ")=" || BAL
.head 5 -  Set nn = nn + 1
.head 5 -  Call NASELENIE(Str(nn))
.head 3 +  On WM_RbuttonDblClick !! назад
.head 4 +  If nn > 1 ! Назад
.head 5 -  Set ss = "Substr(nbs,1," || Str(nn-1) || ")=" || SalStrLeftX(BAL,nn-1)
.head 5 -  Set nn = nn - 1
.head 5 -  Call NASELENIE(Str(nn))
.head 4 +  Else If nn = 1
.head 5 -  Call SalSendMsg(hWndForm, SAM_Create, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set iDOS = iDOS + DOS
.head 4 -  Set iKOS = iKOS + KOS
.head 4 -  Set iISD = iISD + ISD
.head 4 -  Set iISK = iISK + ISK
.head 3 +  On VTM_KeyDown
.head 4 +  If wParam = VK_F8
.head 5 +  If bF8
.head 6 -  Set sdop = ""
.head 5 +  Else
.head 6 +  If bEQV
.head 7 -  Set sdop = " (dosq>0 or kosq>0 or ostq<>0)"
.head 6 +  Else
.head 7 -  Set sdop = " (a.DOS>0 or a.KOS>0 or a.ISD<>0 or a.ISK<>0) "
.head 5 -  Set bF8 = NOT bF8
.head 5 -  Call NASELENIE(Str(nn))
.head 3 +  On SAM_Destroy
.head 4 -  Call subMenu.Kill()
.head 1 +  Table Window: GL_tbl7	!! 1 - БАЛАНС по 1, 0 - Весь баланс в 2
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.825"
.head 4 -  Top:    1.031"
.head 4 -  Width:  12.95"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 10000
.head 3 -  Discardable? Class Default
.head 2 -  Description: 1- БАЛАНС по 1-ой валюте,
0 - Весь баланс в другой базовой валюте
(показывать с 0/без - F8)
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.452"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.85"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSetWindowText(hWndForm, titl || ' ' || LCV)
.head 7 -  Set iDOS = 0
.head 7 -  Set iKOS = 0
.head 7 -  Set iISD = 0
.head 7 -  Set iISK = 0
.head 7 +  If para = 1 !! БАЛАНС по 1-ой валюте
.head 8 -  Call NASELENIE()
.head 7 +  If para = 0 !! Весь баланс в другой базовой валют
.head 8 -  Call NAS0()
.head 7 -  !
.head 7 -  Call SalTblDefineSplitWindow(hWndForm, 1, TBL_Split_Adjustable)
.head 7 -  Call SalTblFetchRow(hWndForm, SalTblInsertRow(hWndForm, TBL_MinSplitRow))
.head 7 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 7 -  Set GL_tbl7.BAL = "****"
.head 7 -  Set GL_tbl7.DOS = iDOS
.head 7 -  Set GL_tbl7.KOS = iKOS
.head 7 -  Set GL_tbl7.ISD = iISD
.head 7 -  Set GL_tbl7.ISK = iISK
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 49362
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  11.033"
.head 6 -  Begin Y:  0.0"
.head 6 -  End X:  11.033"
.head 6 -  End Y:  0.464"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.517"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.083"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 49363
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.15"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 49364
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  !
.head 4 +  Data Field: KV
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   7.986"
.head 7 -  Top:    0.073"
.head 7 -  Width:  0.829"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.333"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set MyValue = 840
.head 7 -  Call SalSendMsg(hWndItem, SAM_Validate, 0, 0)
.head 6 +  On SAM_Validate
.head 7 -  Call F_KURS(KV, '')
.head 7 -  Return VALIDATE_Ok
.head 4 +  Data Field: NAME
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.286"
.head 7 -  Top:    0.071"
.head 7 -  Width:  4.0"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.333"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: kurs
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.083"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.333"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: DAT_
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.283"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.333"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: LCV
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   9.367"
.head 7 -  Top:    0.073"
.head 7 -  Width:  0.7"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.333"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Validate
.head 7 -  Set LCV = SalStrUpperX(LCV)
.head 7 -  Call F_KURS(0, LCV)
.head 7 -  Return VALIDATE_Ok
.head 4 -  Background Text: F8 - Все счета/с остатками(оборотами)
.head 5 -  Resource Id: 20708
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.683"
.head 6 -  Top:    0.2"
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: bgF8
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cLabelControl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Editable? Class Default
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Class Default
.head 7 -  Width Editable? Class Default
.head 7 -  Height: Class Default
.head 7 -  Height Editable? Class Default
.head 6 -  Visible? Class Default
.head 6 -  Border? Class Default
.head 6 -  Justify: Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Font Name: Class Default
.head 6 -  Font Size: Class Default
.head 6 -  Font Enhancement: Class Default
.head 6 -  Text Color: Class Default
.head 6 -  Background Color: Class Default
.head 6 -  Input Mask: Class Default
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: BAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: БАЛ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты ДЕБЕТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.117"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты КРЕДИТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.633"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исходящий ДЕБЕТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.267"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исходящий КРЕДИТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование балансового счета
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  6.933"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: NASELENIE
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: ss1
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  If para = 2 !!!! в альтернативном плане счетов
.head 6 -  ! баланс по расчетному экв
.head 6 +  If gOB22 = '1' and NOT bEQV
.head 7 -  Set ss1 =
"SELECT a.NBS, b.name, a.DOS/100, a.KOS/100, a.ISD/100, a.ISK/100 
   INTO :BAL, :NAM, :DOS, :KOS, :ISD, :ISK 
   FROM  ps2 b ,
    (SELECT v.NBS, sum(m.dosq) DOS, sum(m.kosq) KOS, 
             -sum(decode(sign(m.ostq),-1,m.ostq,0)) ISD, 
              sum(decode(sign(m.ostq), 1,m.ostq,0)) ISK 
        FROM  ACCM_SNAP_BALANCES m, 
           (select acc,nbs2 NBS from v_gl "|| IifS(sTOBO="", "", " where branch=:sTOBO ") || ") v ,
           (select caldt_id from ACCM_CALENDAR  where caldt_date = :dDAT ) k
        WHERE k.caldt_id = m.caldt_id and v.acc= m.acc " ||  IifS(ss="", "", ss) || "  
        GROUP BY v.NBS ) a 
  WHERE a.NBS = b.NBS (+) 
  ORDER BY a.NBS "
.head 6 +  Else If bEQV
.head 7 -  Set ss1 = 
"SELECT a.NBS, b.name, a.DOSQ/100, a.KOSQ/100, a.ISDQ/100, a.ISKQ/100 
   INTO :BAL, :NAM, :DOS, :KOS, :ISD, :ISK 
   FROM (SELECT nvl(nbs2,'0000') NBS, sum(dosq) DOSQ, sum(kosq) KOSQ, 
               -sum(decode(sign(ostq),-1,ostq,0)) ISDQ, 
                sum(decode(sign(ostq), 1,ostq,0)) ISKQ 
           FROM sal_nbs2Q 
          WHERE fdat = :dDAT " || 
                IifS(ss="", "", ss) || 
                IifS(sTOBO="", "", " and tobo=:sTOBO ") || "  
          GROUP BY nvl(nbs2,'0000') ) a, ps2 b 
  WHERE a.NBS  = b.NBS2 (+) 
  ORDER BY a.NBS "
.head 6 +  Else
.head 7 -  Set ss1 =
"SELECT a.NBS, b.name, 
        sum(gl.p_icurval(a.KV,a.DOS,:dDAT))/100, 
        sum(gl.p_icurval(a.KV,a.KOS,:dDAT))/100, 
        sum(gl.p_icurval(a.KV,a.ISD,:dDAT))/100, 
        sum(gl.p_icurval(a.KV,a.ISK,:dDAT))/100 
   INTO :BAL, :NAM, :DOS, :KOS, :ISD, :ISK 
   FROM (SELECT nbs2 NBS, kv KV, sum(dos) DOS, sum(kos) KOS, 
               -sum(decode(sign(ost),-1,ost,0)) ISD, 
                sum(decode(sign(ost), 1,ost,0)) ISK 
           FROM sal_nbs2 
          WHERE fdat = :dDAT " || 
                IifS(ss="", "", ss ) ||  
                IifS(sTOBO="", "", " and tobo=:sTOBO ") || "  
          GROUP BY NBS2, kv ) a, ps2 b 
  WHERE a.NBS = b.NBS2 (+)
  GROUP BY a.NBS, b.name 
  ORDER BY a.NBS "
.head 5 +  Else If para = 1 !!!! в номинале по ОДНОЙ валюте
.head 6 +  If gOB22 = '1' and NOT bEQV
.head 7 -  Set ss1 =
"SELECT a.NBS, b.name, a.DOS/100, a.KOS/100, a.ISD/100, a.ISK/100 
   INTO :BAL, :NAM, :DOS, :KOS, :ISD, :ISK 
   FROM  ps b ,
    (SELECT NBS, sum(m.dos) DOS, sum(m.kos) KOS, 
             -sum(decode(sign(m.ost),-1,m.ost,0)) ISD, 
              sum(decode(sign(m.ost), 1,m.ost,0)) ISK 
        FROM  ACCM_SNAP_BALANCES m, 
           (select acc,NBS from v_gl where kv=:KV "|| IifS(sTOBO="", "", " and branch=:sTOBO ") || ") v ,
           (select caldt_id from ACCM_CALENDAR  where caldt_date = :dDAT ) k
        WHERE k.caldt_id = m.caldt_id and v.acc= m.acc " ||  IifS(ss="", "", ss) || "  
        GROUP BY NBS ) a 
  WHERE a.NBS = b.NBS (+) 
  ORDER BY a.NBS "
.head 6 +  Else
.head 7 -  Set ss1 =
"SELECT a.NBS, b.NAME, a.DOS, a.KOS, a.ISD, a.ISK 
   INTO :BAL, :NAM, :DOS, :KOS, :ISD, :ISK 
   FROM (SELECT nbs NBS, sum(dos)/100 DOS, sum(kos)/100 KOS, 
               -sum( decode(sign(ost),-1,ost,0))/100 ISD, 
                sum( decode(sign(ost), 1,ost,0))/100 ISK 
           FROM sal 
          WHERE fdat = :dDAT AND kv = :KV " || 
                IifS(ss="", "", ss) || 
                IifS(sTOBO="", "", " and tobo=:sTOBO ") || "  
          GROUP BY NBS ) a, ps b 
  WHERE a.nbs (+) = b.nbs 
  ORDER BY a.NBS "
.head 5 -  Call SalTblPopulate(hWndForm, hSqlAux(), ss1, TBL_FillAll)
.head 5 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 5 -  Call SalWaitCursor(FALSE)
.head 3 +  Function: NAS0
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: i
.head 5 -  Number: j
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call SalTblReset(hWndForm)
.head 5 -  Set i = TBL_MinRow
.head 5 +  While SalTblFindNextRow(GL_tbl1, i, 0, 0)
.head 6 +  If i > -1
.head 7 -  Call SalTblFetchRow(GL_tbl1, SalTblInsertRow(hWndForm, TBL_MaxRow))
.head 7 +  If GL_tbl1.BAL != '****' 
.head 8 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 8 -  Set GL_tbl7.BAL = GL_tbl1.BAL
.head 8 -  Set GL_tbl7.DOS = GL_tbl1.DOS/kurs
.head 8 -  Set GL_tbl7.KOS = GL_tbl1.KOS/kurs
.head 8 -  Set GL_tbl7.ISD = GL_tbl1.ISD/kurs
.head 8 -  Set GL_tbl7.ISK = GL_tbl1.ISK/kurs
.head 8 -  Set GL_tbl7.NAM = GL_tbl1.NAME
.head 8 -  Set iDOS = iDOS + GL_tbl7.DOS
.head 8 -  Set iKOS = iKOS + GL_tbl7.KOS
.head 8 -  Set iISD = iISD + GL_tbl7.ISD
.head 8 -  Set iISK = iISK + GL_tbl7.ISK
.head 5 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return i
.head 3 +  Function: F_KURS
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nKv
.head 5 -  String: sLCV
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sSql
.head 4 +  Actions
.head 5 +  If sLCV = ''
.head 6 -  Set sSql = "SELECT lcv, name INTO :LCV, :NAME FROM tabval WHERE kv=:nKv "
.head 5 +  Else If nKv = 0
.head 6 -  Set sSql = "SELECT kv, name INTO :KV, :NAME FROM tabval WHERE UPPER(lcv)=:sLCV "
.head 5 -  !
.head 5 +  If para != 2 
.head 6 +  If SqlPrepareAndExecute(hSql(), sSql) AND SqlFetchNext(hSql(), nFetchRes)
.head 7 -  If SqlPrepareAndExecute(hSql(),
"SELECT c.rate_o/c.bsum INTO :kurs FROM cur_rates c 
  WHERE c.kv=:KV and (c.kv, c.vdate)=
   (select kv, max(vdate) from cur_rates where kv=c.kv and vdate<=:DAT_ group by kv) ")
AND SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalEnableWindow(pbRefresh)
.head 7 -  Call SalEnableWindow(pbPrint)
.head 7 +  If kurs != 0 AND kurs != NUMBER_Null
.head 8 -  Call SalEnableWindow(pbRefresh)
.head 7 +  Else
.head 8 -  Call SalDisableWindow(pbRefresh)
.head 6 +  Else
.head 7 -  Call SalMessageBox('Указанная валюта не найдена!', 'Ошибка!', MB_Ok|MB_IconStop)
.head 7 -  Call SalDisableWindow(pbRefresh)
.head 7 -  Call SalSetFocus(KV)
.head 2 +  Window Parameters
.head 3 -  Number: para
.head 3 -  Date/Time: dDAT
.head 3 -  String: sid
.head 3 -  String: sTOBO 
.head 2 +  Window Variables
.head 3 -  String: sDAT
.head 3 -  String: ss
.head 3 -  String: titl
.head 3 -  Number: iDOS
.head 3 -  Number: iKOS
.head 3 -  Number: iISD
.head 3 -  Number: iISK
.head 3 -  Boolean: bEQV
.head 3 -  Boolean: bF8
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalSetWindowLabelText(bgF8, CurrentLangTable.GetAtomTitle('bgF8'))
.head 4 -  Set sDAT = SalFmtFormatDateTime(dDAT, 'dd-MM-yyyy')
.head 4 -  Set GL_tbl7.strPrintFileName = 'TAB7' || Str(para)
.head 4 -  Set ss = " AND (ost<>0 or dos>0 or kos>0) "
.head 4 +  If SqlPrepareAndExecute(hSqlAux(),
"SELECT val FROM params WHERE par='EQV' and val='YES' ")
AND SqlFetchNext(hSqlAux(), nFetchRes)
.head 5 -  Set bEQV = TRUE
.head 5 +  If para != 1
.head 6 -  Set ss = " AND (ostq<>0 or dosq>0 or kosq>0) "
.head 4 -  Set bF8  = TRUE
.head 4 -  Set DAT_ = dDAT
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 +  If para = 1 !! в номинале по ОДНОЙ валюте (синий)
.head 5 -  Call SalColorSet(hWndForm, 8, COLOR_DarkBlue)
.head 5 -  ! sDAT Cостояние БАЛАНСА в номинале по ОДНОЙ валюте
.head 5 -  Set titl = sDAT || " " || CurrentLangTable.GetAtomTitle('GL_tbl7.cTWndTitle1')
.head 4 +  If para = 0 !! в другой базовой валюте (красный)
.head 5 -  Call SalColorSet(hWndForm, 8, COLOR_DarkRed)
.head 5 -  ! sDAT Состояние БАЛАНСА в экв. базовой валюты
.head 5 -  Set titl = sDAT || " " || CurrentLangTable.GetAtomTitle('GL_tbl7.cTWndTitle2')
.head 5 -  Call SalDisableWindow(pbRefresh)
.head 4 +  If para = 2 !! в альтернативном плане счетов (зеленый)
.head 5 -  Call SalColorSet(hWndForm, 8, COLOR_DarkGray)
.head 5 -  ! sDAT Состояние (экв.) БАЛАНСА в альтернативном плане счетов
.head 5 -  Set titl = sDAT || " " || CurrentLangTable.GetAtomTitle('GL_tbl7.cTWndTitle3')
.head 5 -  Call SalHideWindow(KV)
.head 5 -  Call SalHideWindow(NAME)
.head 5 -  Call SalHideWindow(pbRefresh)
.head 5 -  Call SalHideWindow(LCV)
.head 5 -  Call NASELENIE()
.head 4 -  !
.head 4 -  Call SalSetWindowText(hWndForm, titl)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set iDOS = iDOS + DOS
.head 4 -  Set iKOS = iKOS + KOS
.head 4 -  Set iISD = iISD + ISD
.head 4 -  Set iISK = iISK + ISK
.head 3 +  On VTM_KeyDown
.head 4 +  If wParam = VK_F8
.head 5 +  If bF8
.head 6 -  Set ss = ""
.head 5 +  Else
.head 6 +  If bEQV AND para != 1
.head 7 -  Set ss = " AND (ostq<>0 or dosq>0 or kosq>0) "
.head 6 +  Else
.head 7 -  Set ss = " AND (ost<>0 or dos>0 or kos>0) "
.head 5 -  Set bF8 = NOT bF8
.head 5 +  If para = 2
.head 6 -  Call NASELENIE()
.head 5 +  Else If para = 1
.head 6 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 1 +  Table Window: GL_tbl8	!! СР.бал.(ном) за период в экв. e-дату
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: СРЕДНИЙ БАЛАНС ЗА ПЕРИОД
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 1000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.5"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call NASELENIE(dat1, dat2)
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 40340
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.95"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 40341
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  4.483"
.head 6 -  Begin Y:  -0.024"
.head 6 -  End X:  4.483"
.head 6 -  End Y:  0.44"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.617"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 40342
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dat1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.117"
.head 7 -  Top:    0.107"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: dat2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.75"
.head 7 -  Top:    0.107"
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: BAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: БАЛ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты ДЕБЕТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.65"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обороты КРЕДИТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  3.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исходящий ДЕБЕТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ISK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Исходящий КРЕДИТ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  2.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование балансового счета
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  6.933"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: NASELENIE
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Date/Time: dat1
.head 5 -  Date/Time: dat2
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: ss1
.head 5 -  String: a1
.head 5 -  Number: nKol
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  ! Среднее состояние IifS(sid='K','Кал','Бан')БАЛАНСА в эквиваленте за период с dat1 по dat2
.head 5 -  Set tt1 =
  CurrentLangTable.GetAtomTitle('GL_tbl8.cTWndTitle1')  || " (" ||IifS(sid='K',
  CurrentLangTable.GetAtomTitle('GL_tbl8.cTWndTitle5'),
  CurrentLangTable.GetAtomTitle('GL_tbl8.cTWndTitle6')) || ") " || 
  CurrentLangTable.GetAtomTitle('GL_tbl8.cTWndTitle2')  || " "  || 
  CurrentLangTable.GetAtomTitle('GL_tbl8.cTWndTitle3')  || " "  || SalFmtFormatDateTime( dat1,'dd-MM-yyyy') || " " || 
  CurrentLangTable.GetAtomTitle('GL_tbl8.cTWndTitle4')  || " "  || SalFmtFormatDateTime( dat2,'dd-MM-yyyy')
.head 5 -  Call SalSetWindowText(hWndForm,tt1)
.head 5 -  Set iDOS = 0
.head 5 -  Set iKOS = 0
.head 5 -  Set iISD = 0
.head 5 -  Set iISK = 0
.head 5 +  If sid = 'K' ! Календарный
.head 6 -  Set nKol = dat2 - dat1 + 1
.head 6 +  If nKol > 1
.head 7 +  If SqlPLSQLCommand(hSql(), "bars.p_kdat(nUserId,dat1,dat2)") 
.head 8 -  Call SqlCommit(hSql())
.head 8 -  Set ss1 = 
"SELECT a.NBS, a.DOS, a.KOS, a.ISD, a.ISK, b.NAME 
   INTO :BAL, :DOS, :KOS, :ISD, :ISK, :NAM 
   FROM (SELECT NBS NBS, 
                (sum(dos)/:nKol)/100 dos, 
                (sum(kos)/:nKol)/100 kos, 
                (sum(isd)/:nKol)/100 isd, 
                (sum(isk)/:nKol)/100 isk 
           FROM (SELECT s.dat FDAT, a.nbs NBS, a.kv KV, 
                       -sum(decode(sign(b.ost),-1,b.ost,0)) ISD, 
                        sum(decode(sign(b.ost), 1,b.ost,0)) ISK, 
                        sum(s.dos) DOS, sum(s.kos) KOS 
                   FROM V_GL  a, 
                        (SELECT acc ACC, kdat DAT, sum(decode(fdat,kdat,dos,0)) DOS, sum(decode(fdat,kdat,kos,0)) KOS 
                         FROM saldoa s, tmp_kdat d WHERE fdat<=:dat2 AND id=:nUserId GROUP BY acc, kdat 
                         ) s,
                        (SELECT a.acc ACC, kdat KDAT, ostf-dos+kos OST FROM saldoa a, 
                                (SELECT acc, kdat, max(fdat) fdat FROM saldoa, 
                                        (select kdat, max(fdat) mdat from fdat, tmp_kdat 
                                          where fdat<=kdat and id=:nUserId 
                                          group by kdat) b 
                                  WHERE fdat<=mdat GROUP BY acc, kdat ) b 
                          WHERE a.acc=b.acc and a.fdat=b.fdat 
                        ) b				
                  WHERE a.acc=s.acc AND s.acc=b.acc AND s.dat=b.kdat AND a.kv=:n980 "||
 IifS(sTOBO="", "", " and tobo=:sTOBO ") || "  
                  GROUP BY s.dat, a.nbs, a.kv 
              UNION ALL
                 SELECT s.dat FDAT, a.nbs NBS, a.kv KV, 
                       -sum(decode(sign(b.ost),-1,b.ost,0)) ISD, 
                        sum(decode(sign(b.ost), 1,b.ost,0)) ISK, 
                        sum(s.dos) DOS, sum(s.kos) KOS 
                   FROM (SELECT acc ACC, kdat DAT, 
                                sum(decode(fdat,kdat,dos,0)) DOS, 
                                sum(decode(fdat,kdat,kos,0)) KOS 
                           FROM saldob s, tmp_kdat d 
                          WHERE fdat<=:dat2 and id=:nUserId 
                          GROUP BY acc, kdat ) s,
                        V_GL  a, 
                        (SELECT a.acc ACC, kdat KDAT, ostf-dos+kos OST 
                           FROM saldob a, 
                                (SELECT acc, kdat, max(fdat) fdat 
                                   FROM saldob, 
                                        (select kdat, max(fdat) mdat 
                                           from fdat, tmp_kdat 
                                          where fdat<=kdat and id=:nUserId 
                                          group by kdat) b 
               	                  WHERE fdat<=mdat
	                          GROUP BY acc, kdat ) b
                          WHERE a.acc=b.acc and a.fdat=b.fdat ) b				
                  WHERE a.acc=s.acc AND s.acc=b.acc AND s.dat=b.kdat AND a.kv<>:n980 " ||
 IifS(sTOBO="", "", " and tobo=:sTOBO ") || " 
                  GROUP BY s.dat, a.nbs, a.kv ) 
          GROUP BY NBS ) a, PS b 
  WHERE b.nbs=a.nbs 
  ORDER BY a.NBS"
.head 8 -  Call SalTblPopulate(hWndForm,hSql(),ss1,TBL_FillAll)
.head 8 -  !
.head 8 -  Call SalTblDefineSplitWindow(hWndForm, 1,TBL_Split_Adjustable)
.head 8 -  Call SalTblFetchRow(hWndForm, SalTblInsertRow(hWndForm,TBL_MinSplitRow))
.head 8 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 8 -  Set GL_tbl8.BAL = "****"
.head 8 -  Set GL_tbl8.DOS = iDOS
.head 8 -  Set GL_tbl8.KOS = iKOS
.head 8 -  Set GL_tbl8.ISD = iISD
.head 8 -  Set GL_tbl8.ISK = iISK
.head 8 -  !
.head 8 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 5 +  Else If sid = 'B' ! банковский
.head 6 +  If SqlPrepareAndExecute(hSql(),
"SELECT count(*) INTO :nKol FROM fdat WHERE fdat>=:dat1 AND fdat<=:dat2 ")
and SqlFetchNext(hSql(), nFetchRes)
.head 7 -  ! баланс по расчетному экв
.head 7 -  Set ss1 = 
"SELECT a.NBS, a.DOS, a.KOS, a.ISD, a.ISK, b.NAME 
   INTO :BAL, :DOS, :KOS, :ISD, :ISK, :NAM 
   FROM (SELECT NBS NBS, 
                (sum(DOS)/:nKol)/100 DOS, 
                (sum(KOS)/:nKol)/100 KOS, 
                (sum(ISD)/:nKol)/100 ISD, 
                (sum(ISK)/:nKol)/100 ISK 
           FROM (SELECT nbs NBS, kv KV, sum(dos) DOS, sum(kos) KOS, 
                       -sum(decode(sign(ost),-1,ost,0)) ISD, 
                        sum(decode(sign(ost), 1,ost,0)) ISK 
                   FROM sal 
                  WHERE fdat>=:dat1 AND fdat<=:dat2 AND kv=:n980 "||
   IifS(sTOBO="", "", " and tobo=:sTOBO ") || " 
                  GROUP BY fdat, NBS, kv 
              UNION ALL
                 SELECT nbs NBS, kv KV, sum(dos) DOS, sum(kos) KOS, 
                       -sum(decode(sign(ost),-1,ost,0)) ISD, 
                        sum(decode(sign(ost), 1,ost,0)) ISK 
                   FROM salb 
                  WHERE fdat>=:dat1 AND fdat<=:dat2 AND kv<>:n980 " ||
 IifS(sTOBO="", "", " and tobo=:sTOBO ") || " 
                  GROUP BY fdat, NBS, kv ) 
          GROUP BY NBS ) a, ps b 
  WHERE b.nbs=a.nbs 
  ORDER BY a.NBS"
.head 7 -  ! баланс по экв из SALDOA
.head 7 +  If SqlPrepareAndExecute(hSqlAux(),
"SELECT val FROM params WHERE par='EQV' and val='YES' ")
and SqlFetchNext(hSqlAux(), nFetchRes)
.head 8 -  Set ss1 =
"SELECT a.NBS, a.DOSQ/100, a.KOSQ/100, -a.ISDQ/100, a.ISKQ/100, b.NAME 
   INTO :BAL, :DOS, :KOS, :ISD, :ISK, :NAM 
   FROM (SELECT NBS NBS, sum(DOSQ)/:nKol DOSQ, sum(KOSQ)/:nKol KOSQ, 
                sum(decode(sign(ostq),-1,ostq,0))/:nKol ISDQ, 
                sum(decode(sign(ostq), 1,ostq,0))/:nKol ISKQ 
           FROM salQ 
          WHERE fdat>=:dat1 AND fdat<=:dat2 "||
 IifS(sTOBO="", "", " and tobo=:sTOBO ") || " 
          GROUP BY NBS ) a, ps b 
  WHERE a.nbs=b.nbs 
  ORDER BY a.NBS"
.head 7 -  Call SalTblPopulate(hWndForm,hSql(),ss1,TBL_FillAll)
.head 7 -  !
.head 7 -  Call SalTblDefineSplitWindow(hWndForm, 1, TBL_Split_Adjustable)
.head 7 -  Call SalTblFetchRow(hWndForm, SalTblInsertRow(hWndForm, TBL_MinSplitRow))
.head 7 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 7 -  Set GL_tbl8.BAL = "****"
.head 7 -  Set GL_tbl8.DOS = iDOS
.head 7 -  Set GL_tbl8.KOS = iKOS
.head 7 -  Set GL_tbl8.ISD = iISD
.head 7 -  Set GL_tbl8.ISK = iISK
.head 7 -  !
.head 7 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 5 -  Call SalWaitCursor(FALSE)
.head 2 +  Window Parameters
.head 3 -  Date/Time: dDAT
.head 3 -  String: sid
.head 3 -  String: sTOBO 
.head 2 +  Window Variables
.head 3 -  String: tt1
.head 3 -  Number: iDOS
.head 3 -  Number: iKOS
.head 3 -  Number: iISD
.head 3 -  Number: iISK
.head 3 -  Number: nUserId
.head 3 -  Number: n980
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('GL_tbl8.cTWndTitle') || " " || 
     IifS(sTOBO!=STRING_Null, CurrentLangTable.GetAtomTitle('GL_tbl1.cbBranch') || ' ' || sTOBO, ''))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  !
.head 4 -  Set n980    = GetBaseVal()
.head 4 -  Set nUserId = GetUserId()
.head 4 -  !
.head 4 -  Set dat2 = dDAT
.head 4 -  Set dat1 = dat2 - 31
.head 4 -  !
.head 4 -  Set strPrintFileName = SqlUser
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set iDOS = iDOS + DOS
.head 4 -  Set iKOS = iKOS + KOS
.head 4 -  Set iISD = iISD + ISD
.head 4 -  Set iISK = iISK + ISK
.head 1 +  ! cGenericTable: RZ
.winattr class Table Window:
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Стан Кор.Рахунку: Вільні кошти та Обов`язковий резерв
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.275"
.head 4 -  Top:    0.302"
.head 4 -  Width:  14.933"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.024"
.head 4 -  Height Editable? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  View: Table
.head 3 -  Allow Row Sizing? No
.head 3 -  Lines Per Row: Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Default
.head 3 -  Discardable? No
.end
.head 2 -              Description: 
.head 2 -              Named Menus 
.head 2 -              Menu 
.head 2 +              Tool Bar 
.head 3 +              Contents 
.head 4 +              Pushbutton: pbIns
.head 5 -              Message Actions 
.head 4 +              Pushbutton: pbDel
.head 5 -              Message Actions 
.head 4 +              Pushbutton: pbRefresh
.head 5 -              Message Actions 
.head 4 +              Pushbutton: pbUpdate
.head 5 -              Message Actions 
.head 4 -              Line 
.head 4 +              Pushbutton: pbSearch
.head 5 -              Message Actions 
.head 4 +              Pushbutton: pbFilter
.head 5 -              Message Actions 
.head 4 +              Pushbutton: pbDetails
.head 5 -              Message Actions 
.head 4 +              Pushbutton: pbPrint
.head 5 -              Message Actions 
.head 4 -              Line 
.head 4 +              Pushbutton: pbExit
.head 5 -              Message Actions 
.head 4 -              Line 
.head 4 -  !
.head 4 -              Background Text: Всього
.head 4 -              Background Text: ~Всього
.head 4 -              Background Text: Залишок
.head 4 -              Background Text: Вільні кошти
.head 4 +              Data Field: SAL
.head 5 +              Message Actions 
.head 6 +              On SAM_TooltipSetText
.head 7 -              Return XSalTooltipSetText(lParam, 'Факт: Залишок ')
.head 4 +              Data Field: DEL
.head 5 +              Message Actions 
.head 6 +              On SAM_TooltipSetText
.head 7 -              Return XSalTooltipSetText(lParam, 'Факт: + Вільні кошти, - Недорезерв ')
.head 4 +              Data Field: SAL1
.head 5 +              Message Actions 
.head 6 +              On SAM_TooltipSetText
.head 7 -              Return XSalTooltipSetText(lParam, 'План: Залишок ')
.head 4 +              Data Field: DEL1
.head 5 +              Message Actions 
.head 6 +              On SAM_TooltipSetText
.head 7 -              Return XSalTooltipSetText(lParam, 'План: + Вільні кошти, - Недорезерв ')
.head 4 -              Line 
.head 4 -              Line 
.head 4 +              Child Table: T_1200
.head 5 +              Contents 
.head 6 +              Column: NBS
.head 7 -              List Values 
.head 7 -              Message Actions 
.head 6 +              Column: OSTС
.head 7 -              List Values 
.head 7 -              Message Actions 
.head 6 +              Column: OSTB
.head 7 -              List Values 
.head 7 -              Message Actions 
.head 6 +              Column: PR_
.head 7 -              List Values 
.head 7 -              Message Actions 
.head 6 +              Column: OSTС_
.head 7 -              List Values 
.head 7 -              Message Actions 
.head 6 +              Column: OSTB_
.head 7 -              List Values 
.head 7 -              Message Actions 
.head 5 +              Functions 
.head 6 +              Function: REZ0A
.head 7 -              Description: 
.head 7 -              Returns 
.head 7 -              Parameters 
.head 7 -              Static Variables 
.head 7 -              Local variables 
.head 7 +              Actions 
.head 8 -              Call SalWaitCursor(TRUE)
.head 8 -              Set SAL  = 0
.head 8 -              Set SAL1 = 0
.head 8 +  ! If SalTblPopulate(T_1200, hSql(), 
"SELECT 'К/Р ', r.PR_,
       -sum( decode( a.TIP,'N00',a.ost, 'L00',a.ost, 0 ))/100, -sum(a.ost)/100
   INTO :hWndForm.T_1200.NBS,  :hWndForm.T_1200.PR_, 
        :hWndForm.T_1200.OSTС, :hWndForm.T_1200.OSTB 
   FROM sal a, REZ0A r 
  WHERE a.kv=:n980 and a.tip in ('N00','TNB','N99', 'L00') 
    and r.NBS='1200' and a.FDAT=:bDat 
  GROUP BY r.PR_ 
  union all
 SELECT r.NBS, r.PR_, -sum(a.OST)/100, -sum(a.ost)/100 
   FROM sal a, REZ0A r
  WHERE a.kv=:n980 and a.tip not in ('N00','TNB','N99') 
    and a.nbs=r.NBS and a.FDAT=:bDat 
  GROUP BY  r.NBS, r.PR_ ",  TBL_FillAll)
.head 9 -                          Set DEL  = SAL  - REZ_
.head 9 -                          Set DEL1 = SAL1 - REZ_
.head 8 +              If SalTblPopulate(T_1200, hSql(), 
"SELECT 'К/Р ', r.PR_,
       -sum( decode( a.TIP,'N00',a.ost, 'L00',a.ost, 0 ))/100, -sum(a.ost)/100
   INTO :hWndForm.T_1200.NBS,  :hWndForm.T_1200.PR_, 
        :hWndForm.T_1200.OSTС, :hWndForm.T_1200.OSTB 
   FROM sal a, REZ0A r 
  WHERE a.kv=:n980 and a.tip in ('N00','TNB','N99', 'L00') 
    and r.NBS IN ('1200','3900') and a.FDAT=:bDat 
  GROUP BY r.PR_ 
  union all
 SELECT r.NBS, r.PR_, -sum(a.OST)/100, -sum(a.ost)/100 
   FROM sal a, REZ0A r
  WHERE a.kv=:n980 and a.tip not in ('N00','TNB','N99') 
    and a.nbs=r.NBS and a.FDAT=:bDat 
  GROUP BY  r.NBS, r.PR_ ",  TBL_FillAll)
.head 9 -              Set DEL  = SAL  - REZ_
.head 9 -              Set DEL1 = SAL1 - REZ_
.head 8 -              Call SalWaitCursor(FALSE)
.head 7 -  ! Джерела резервування
.head 5 -              Window Variables 
.head 5 +              Message Actions 
.head 6 +              On SAM_FetchRowDone
.head 7 -              Set OSTС_  = OSTС * PR_ / 100
.head 7 -              Set OSTB_  = OSTB * PR_ / 100
.head 7 -              Call SalTblSetCellTextColor(OSTС_, COLOR_Red, TRUE)
.head 7 -              Call SalTblSetCellTextColor(OSTB_, COLOR_Blue, TRUE)
.head 7 -              Set SAL    = SAL  + OSTС_
.head 7 -              Set SAL1   = SAL1 + OSTB_
.head 2 +              Contents 
.head 3 +              Column: ID
.head 4 -              List Values 
.head 4 -              Message Actions 
.head 3 +              Column: NAME
.head 4 -              List Values 
.head 4 -              Message Actions 
.head 3 +              Column: OST0
.head 4 -              List Values 
.head 4 -              Message Actions 
.head 3 +              Column: OST1
.head 4 -              List Values 
.head 4 -              Message Actions 
.head 3 +              Column: OST0F
.head 4 -              List Values 
.head 4 -              Message Actions 
.head 3 +              Column: OST1F
.head 4 -              List Values 
.head 4 -              Message Actions 
.head 3 +              Column: OST0R
.head 4 -              List Values 
.head 4 -              Message Actions 
.head 3 +              Column: OST1R
.head 4 -              List Values 
.head 4 -              Message Actions 
.head 3 +              Column: REZ
.head 4 -              List Values 
.head 4 -              Message Actions 
.head 3 +              Column: PR_NV
.head 4 -              List Values 
.head 4 -              Message Actions 
.head 3 +              Column: PR_IV
.head 4 -              List Values 
.head 4 -              Message Actions 
.head 2 -              Functions 
.head 2 +              Window Parameters 
.head 3 -              Number: nPar !! Нормы резервирования 
3  - только гол.банк
0 - гол + филиалы
.head 2 +              Window Variables 
.head 3 -              Number: OST0_
.head 3 -              Number: OST1_
.head 3 -              Number: OST0F_
.head 3 -              Number: OST1F_
.head 3 -              Number: OST0R_
.head 3 -              Number: OST1R_
.head 3 -              Number: REZ_
.head 3 -              Number: n980
.head 3 -              Date/Time: bDat
.head 2 +              Message Actions 
.head 3 +              On SAM_Create
.head 4 -              Call SetWindowFullSize(hWndForm)
.head 4 -              Call SalSetWindowText(hWndForm, 
"Стан Кор.Рахунку: Вільні кошти та Обов`язковий резерв. " || 
 IifS(nPar=3, "Без філій", "З філіями"))
.head 4 +              If nPar=3
.head 5 -              Call SalHideWindow( OST0F )
.head 5 -              Call SalHideWindow( OST1F )
.head 5 -              Call SalHideWindow( OST0 )
.head 5 -              Call SalHideWindow( OST1 )
.head 4 -              Call PrepareWindowEx(hWndForm)
.head 4 -              Set bDat = GetBankDate()
.head 4 -              Set n980 = GetBaseVal()
.head 4 -              Call SalTblSetLockedColumns(hWndForm, 2)
.head 4 -              Set RZ.strPrintFileName = 'RZ'
.head 4 -              Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +              On UM_Populate
.head 4 -              Call SalWaitCursor(TRUE)
.head 4 -              Call SalTblReset(hWndForm)
.head 4 -              Call SalTblReset(T_1200)
.head 4 -              Set SAL  = 0
.head 4 -              Set SAL1 = 0
.head 4 -              Set DEL  = 0
.head 4 -              Set DEL1 = 0
.head 4 -  ! залучення
.head 4 -              Set OST0_ = 0
.head 4 -              Set OST1_ = 0
.head 4 -              Set OST0F_ = 0
.head 4 -              Set OST1F_ = 0
.head 4 -              Set OST0R_ = 0
.head 4 -              Set OST1R_ = 0
.head 4 -              Set REZ_ = 0
.head 4 +              If SqlPLSQLCommand(hSql(), "N_REZ(nPar, bDat)")
and SqlCommitEx(hSql(), "Расчет резерва")
.head 5 -              Call SalTblPopulate(hWndForm, hSql(), 
"SELECT ID, NAME, PR_NV, PR_IV,
        OST0, OST1, OST0F, OST1F
   INTO :RZ.ID,:RZ.NAME,:RZ.PR_NV,:RZ.PR_IV,
        :RZ.OST0,:RZ.OST1,:RZ.OST0F,:RZ.OST1F
   FROM TMP_rez0
  WHERE OST0<>0 or OST1<>0 or OST0F<>0 or OST1F<>0
  ORDER BY id ", TBL_FillAll)
.head 5 -  !
.head 5 -              Call SalTblDefineSplitWindow(hWndForm, 1, TBL_Split_Adjustable)
.head 5 -              Call SalTblFetchRow(hWndForm, SalTblInsertRow(hWndForm, TBL_MinSplitRow))
.head 5 -              Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 5 -              Set RZ.NAME  = "Всього"
.head 5 -              Set RZ.OST0  = OST0_
.head 5 -              Set RZ.OST1  = OST1_
.head 5 -              Set RZ.OST0F = OST0F_
.head 5 -              Set RZ.OST1F = OST1F_
.head 5 -              Set RZ.OST0R = OST0R_
.head 5 -              Set RZ.OST1R = OST1R_
.head 5 -              Set RZ.REZ   = REZ_
.head 5 +              If nPar = 3
.head 6 -              Call SalHideWindow(RZ.OST0F)
.head 6 -              Call SalHideWindow(RZ.OST1F)
.head 6 -  ! Call SalHideWindow(RZ.OST0R)
.head 6 -  ! Call SalHideWindow(RZ.OST1R)
.head 6 -  ! Call SalHideWindow(RZ.OST0R)
.head 6 -  ! Call SalHideWindow(RZ.OST1R)
.head 5 -  ! Джерела резервування
.head 5 -              Call T_1200.REZ0A()
.head 4 -              Call SalWaitCursor(FALSE)
.head 3 +              On SAM_FetchRowDone
.head 4 -              Set OST0R  = SalNumberMax(0, OST0+OST0F)
.head 4 -              Set OST1R  = SalNumberMax(0, OST1+OST1F)
.head 4 -              Set REZ    = (OST0R*PR_NV + OST1R*PR_IV) / 100
.head 4 -              Set OST0_  = OST0_  + SalNumberMax(0, OST0)
.head 4 -              Set OST1_  = OST1_  + SalNumberMax(0, OST1)
.head 4 -              Set OST0F_ = OST0F_ + SalNumberMax(0, OST0F)
.head 4 -              Set OST1F_ = OST1F_ + SalNumberMax(0, OST1F)
.head 4 -              Set OST0R_ = OST0R_ + OST0R
.head 4 -              Set OST1R_ = OST1R_ + OST1R
.head 4 -              Set REZ_   = REZ_ + REZ
.head 1 +  Table Window: RZ
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Стан Кор.Рахунку: Вільні кошти та Обов`язковий резерв
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.275"
.head 4 -  Top:    0.302"
.head 4 -  Width:  17.7"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.802"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 1.881"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.183"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 
'Справочник Рабочих Активов:
пополнить/изъять'
.head 6 +  On SAM_Click
.head 7 -  Call FunNSIEditF("REZ0A",0)
.head 7 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.783"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 
'Сохранить значение % по учету Раб.Акт и Групп обязат.'
.head 6 +  On SAM_Click
.head 7 -  Call Sav_Pr()
.head 4 -  Line
.head 5 -  Resource Id: 61214
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.883"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 61215
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 61216
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  !
.head 4 -  Background Text: Всього
.head 5 -  Resource Id: 61217
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.033"
.head 6 -  Top:    0.798"
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 4 -  Background Text: ~Всього
.head 5 -  Resource Id: 61218
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.033"
.head 6 -  Top:    1.06"
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 4 -  Background Text: Залишок
.head 5 -  Resource Id: 61219
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.417"
.head 6 -  Top:    0.512"
.head 6 -  Width:  1.817"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Black
.head 5 -  Background Color: Default
.head 4 -  Background Text: Вільні кошти
.head 5 -  Resource Id: 61220
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.25"
.head 6 -  Top:    0.512"
.head 6 -  Width:  1.817"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Black
.head 5 -  Background Color: Default
.head 4 +  Data Field: SAL
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   10.4"
.head 7 -  Top:    0.714"
.head 7 -  Width:  1.817"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Red
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, 'Факт: Залишок ')
.head 4 +  Data Field: DEL
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   12.25"
.head 7 -  Top:    0.714"
.head 7 -  Width:  1.817"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Dark Red
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, 'Факт: + Вільні кошти, - Недорезерв ')
.head 4 +  Data Field: SAL1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   10.4"
.head 7 -  Top:    0.976"
.head 7 -  Width:  1.814"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Blue
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, 'План: Залишок ')
.head 4 +  Data Field: DEL1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   12.25"
.head 7 -  Top:    0.976"
.head 7 -  Width:  1.814"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Decimal
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Dark Blue
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, 'План: + Вільні кошти, - Недорезерв ')
.head 4 -  Line
.head 5 -  Resource Id: 61221
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  13.367"
.head 6 -  Begin Y:  -0.036"
.head 6 -  End X:  13.367"
.head 6 -  End Y:  0.464"
.head 5 -  Visible? No
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 -  Line
.head 5 -  Resource Id: 61222
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  14.067"
.head 6 -  Begin Y:  -0.036"
.head 6 -  End X:  14.067"
.head 6 -  End Y:  0.464"
.head 5 -  Visible? No
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Child Table: T_1200
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.3"
.head 7 -  Top:    0.06"
.head 7 -  Width:  9.083"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 1.762"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  View: Table
.head 6 -  Allow Row Sizing? No
.head 6 -  Lines Per Row: Default
.head 5 -  Memory Settings
.head 6 -  Maximum Rows in Memory: Default
.head 6 -  Discardable? Yes
.head 5 +  Contents
.head 6 +  Column: NBS
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 0
.head 7 -  Class:
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title: Бал
рах
.head 7 -  Visible? Yes
.head 7 -  Editable? Yes
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: String
.head 7 -  Justify: Left
.head 7 -  Width:  0.85"
.head 7 -  Width Editable? Yes
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Input Mask: Unformatted
.head 7 -  Cell Options
.head 8 -  Cell Type? Standard
.head 8 -  Multiline Cell? No
.head 8 -  Cell DropDownList
.head 9 -  Sorted? Yes
.head 9 -  Vertical Scroll? Yes
.head 9 -  Auto Drop Down? No
.head 9 -  Allow Text Editing? Yes
.head 8 -  Cell CheckBox
.head 9 -  Check Value:
.head 9 -  Uncheck Value:
.head 9 -  Ignore Case? Yes
.head 7 -  List Values
.head 7 -  Message Actions
.head 6 +  Column: OSTС
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 0
.head 7 -  Class:
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title: Залишок Факт
всього
.head 7 -  Visible? Yes
.head 7 -  Editable? Yes
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: Number
.head 7 -  Justify: Right
.head 7 -  Width:  1.5"
.head 7 -  Width Editable? Yes
.head 7 -  Format: Decimal
.head 7 -  Country: Default
.head 7 -  Input Mask: Unformatted
.head 7 -  Cell Options
.head 8 -  Cell Type? Standard
.head 8 -  Multiline Cell? No
.head 8 -  Cell DropDownList
.head 9 -  Sorted? Yes
.head 9 -  Vertical Scroll? Yes
.head 9 -  Auto Drop Down? No
.head 9 -  Allow Text Editing? Yes
.head 8 -  Cell CheckBox
.head 9 -  Check Value:
.head 9 -  Uncheck Value:
.head 9 -  Ignore Case? Yes
.head 7 -  List Values
.head 7 -  Message Actions
.head 6 +  Column: OSTB
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 0
.head 7 -  Class:
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title: Залишок План
всього
.head 7 -  Visible? Yes
.head 7 -  Editable? Yes
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: Number
.head 7 -  Justify: Right
.head 7 -  Width:  1.75"
.head 7 -  Width Editable? Yes
.head 7 -  Format: Decimal
.head 7 -  Country: Default
.head 7 -  Input Mask: Unformatted
.head 7 -  Cell Options
.head 8 -  Cell Type? Standard
.head 8 -  Multiline Cell? No
.head 8 -  Cell DropDownList
.head 9 -  Sorted? Yes
.head 9 -  Vertical Scroll? Yes
.head 9 -  Auto Drop Down? No
.head 9 -  Allow Text Editing? Yes
.head 8 -  Cell CheckBox
.head 9 -  Check Value:
.head 9 -  Uncheck Value:
.head 9 -  Ignore Case? Yes
.head 7 -  List Values
.head 7 -  Message Actions
.head 6 +  Column: PR_
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 0
.head 7 -  Class:
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title: %
розрах
.head 7 -  Visible? Yes
.head 7 -  Editable? Yes
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: Number
.head 7 -  Justify: Right
.head 7 -  Width:  0.95"
.head 7 -  Width Editable? Yes
.head 7 -  Format: Unformatted
.head 7 -  Country: Default
.head 7 -  Input Mask: Unformatted
.head 7 -  Cell Options
.head 8 -  Cell Type? Standard
.head 8 -  Multiline Cell? No
.head 8 -  Cell DropDownList
.head 9 -  Sorted? Yes
.head 9 -  Vertical Scroll? Yes
.head 9 -  Auto Drop Down? No
.head 9 -  Allow Text Editing? Yes
.head 8 -  Cell CheckBox
.head 9 -  Check Value:
.head 9 -  Uncheck Value:
.head 9 -  Ignore Case? Yes
.head 7 -  List Values
.head 7 -  Message Actions
.head 6 +  Column: OSTС_
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 0
.head 7 -  Class:
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title: Залишок
для розрах
.head 7 -  Visible? Yes
.head 7 -  Editable? Yes
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: Number
.head 7 -  Justify: Right
.head 7 -  Width:  1.667"
.head 7 -  Width Editable? Yes
.head 7 -  Format: Decimal
.head 7 -  Country: Default
.head 7 -  Input Mask: Unformatted
.head 7 -  Cell Options
.head 8 -  Cell Type? Standard
.head 8 -  Multiline Cell? No
.head 8 -  Cell DropDownList
.head 9 -  Sorted? Yes
.head 9 -  Vertical Scroll? Yes
.head 9 -  Auto Drop Down? No
.head 9 -  Allow Text Editing? Yes
.head 8 -  Cell CheckBox
.head 9 -  Check Value:
.head 9 -  Uncheck Value:
.head 9 -  Ignore Case? Yes
.head 7 -  List Values
.head 7 -  Message Actions
.head 6 +  Column: OSTB_
.head 7 -  Class Child Ref Key: 0
.head 7 -  Class ChildKey: 0
.head 7 -  Class:
.head 7 -  Property Template:
.head 7 -  Class DLL Name:
.head 7 -  Title: Залишок ~
для розрах
.head 7 -  Visible? Yes
.head 7 -  Editable? Yes
.head 7 -  Maximum Data Length: Default
.head 7 -  Data Type: Number
.head 7 -  Justify: Right
.head 7 -  Width:  1.6"
.head 7 -  Width Editable? Yes
.head 7 -  Format: Decimal
.head 7 -  Country: Default
.head 7 -  Input Mask: Unformatted
.head 7 -  Cell Options
.head 8 -  Cell Type? Standard
.head 8 -  Multiline Cell? No
.head 8 -  Cell DropDownList
.head 9 -  Sorted? Yes
.head 9 -  Vertical Scroll? Yes
.head 9 -  Auto Drop Down? No
.head 9 -  Allow Text Editing? Yes
.head 8 -  Cell CheckBox
.head 9 -  Check Value:
.head 9 -  Uncheck Value:
.head 9 -  Ignore Case? Yes
.head 7 -  List Values
.head 7 -  Message Actions
.head 5 +  Functions
.head 6 +  Function: REZ0A
.head 7 -  Description: ! Джерела резервування
.head 7 +  Returns
.head 8 -  Number: nSal
.head 8 -  Number: nSal1
.head 7 -  Parameters
.head 7 -  Static Variables
.head 7 -  Local variables
.head 7 +  Actions
.head 8 -  Call SalWaitCursor(TRUE)
.head 8 -  Set SAL  = 0
.head 8 -  Set SAL1 = 0
.head 8 +  If SqlPLSQLCommand(hSql(), "N_REZ(-1 , bDat)")
.head 9 +  If SalTblPopulate(T_1200, hSql(),
"SELECT NLS,  pwn, - OSTC_Z/100, - OSTC_Z/100 
 INTO :hWndForm.T_1200.NBS,  :hWndForm.T_1200.PR_,:hWndForm.T_1200.OSTС, :hWndForm.T_1200.OSTB 
 FROM REZ_ZAL order by nls ",  TBL_FillAll)
.head 10 -  Set DEL  = SAL  - REZ_
.head 10 -  Set DEL1 = SAL1 - REZ_
.head 8 +  ! If SalTblPopulate(T_1200, hSql(),
"SELECT 'N00', r.PR_ , -sum( decode( a.TIP,'N00',a.ost,0 ))/100,                        -sum(a.ost)/100
 INTO :hWndForm.T_1200.NBS,  :hWndForm.T_1200.PR_,:hWndForm.T_1200.OSTС, :hWndForm.T_1200.OSTB
 FROM sal a , REZ0A r 
 WHERE a.kv = :n980 and a.tip in ('N00','TNB','N99')    and a.FDAT = :bDat  and r.nbs='N00'  GROUP BY r.PR_
   union all
 SELECT 'L00', r.PR_, -sum( decode( a.TIP,'L00',a.ost, 0 ))/100, -sum(a.ost)/100
 FROM sal a, REZ0A r    WHERE a.kv=:n980 and a.tip in ('L00','TUR','TUD')    and a.FDAT=:bDat  and r.nbs='L00'  GROUP BY r.PR_
   union all
 SELECT r.NBS, r.PR_, -sum(a.OST)/100, -sum(a.ost)/100 FROM sal a, REZ0A r
 WHERE a.kv=:n980 and a.tip not in ('N00','TNB','N99','L00','TUR','TUD')  and r.nbs=a.nbs and a.FDAT=:bDat  
 GROUP BY  r.NBS, r.PR_ ",  
TBL_FillAll)
.head 9 -    Set DEL  = SAL  - REZ_
.head 9 -    Set DEL1 = SAL1 - REZ_
.head 8 -  Call SalWaitCursor(FALSE)
.head 7 -  !
.head 5 -  Window Variables
.head 5 +  Message Actions
.head 6 +  On SAM_FetchRowDone
.head 7 -  Set OSTС_  = OSTС * PR_ / 100
.head 7 -  Set OSTB_  = OSTB * PR_ / 100
.head 7 -  Call SalTblSetCellTextColor(OSTС_, COLOR_Red, TRUE)
.head 7 -  Call SalTblSetCellTextColor(OSTB_, COLOR_Blue, TRUE)
.head 7 -  Set SAL    = SAL  + OSTС_
.head 7 -  Set SAL1   = SAL1 + OSTB_
.head 2 +  Contents
.head 3 +  Column: ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
гр
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.471"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва групи
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OST0
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Залучено
в НацВал
(ГБ)
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OST1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Залучено
в ІнВал
(ГБ)
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.643"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OST0F
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Залучено
в НацВал
(Філії)
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.371"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OST1F
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Залучено
в ІнВал
(Філії)
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.271"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OST0R
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Залучено
в НацВал
(Разом)
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.771"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OST1R
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Залучено
в ІнВал
(Разом)
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.571"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сума
резерву
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.643"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PR_NV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: %
рез
в НВ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PR_IV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: %
рез
в ІВ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.471"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: Sav_Pr
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRow
.head 4 +  Actions
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( T_1200, nRow, 0, 0 )
.head 6 -  Call SalTblSetContext( T_1200, nRow )
.head 6 -  If SqlPrepareAndExecute( hSql(),
 "UPDATE REZ0A set PR_ = :T_1200.PR_ where NBS = :T_1200.NBS " )
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow( RZ, nRow, 0, 0 )
.head 6 -  Call SalTblSetContext( RZ, nRow )
.head 6 -  If SqlPrepareAndExecute( hSql(),
 "UPDATE REZ0  set PR_NV = :RZ.PR_NV, PR_IV = :RZ.PR_IV 
 where ID  = :RZ.ID " )
.head 5 -  Call SalSendMsg( pbRefresh, SAM_Click, 0, 0 )
.head 2 +  Window Parameters
.head 3 -  Number: nPar !! Нормы резервирования
3  - только гол.банк
0 - гол + филиалы
.head 2 +  Window Variables
.head 3 -  Number: OST0_
.head 3 -  Number: nCol
.head 3 -  Number: OST1_
.head 3 -  Number: OST0F_
.head 3 -  Number: OST1F_
.head 3 -  Number: OST0R_
.head 3 -  Number: OST1R_
.head 3 -  Number: REZ_
.head 3 -  Number: n980
.head 3 -  Date/Time: bDat
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalSetWindowText(hWndForm,
"Стан Кор.Рахунку: Вільні кошти та Обов`язковий резерв. " ||
 IifS(nPar=3, "Без філій", "З філіями"))
.head 4 +  If nPar=3
.head 5 -  Call SalHideWindow( OST0F )
.head 5 -  Call SalHideWindow( OST1F )
.head 5 -  Call SalHideWindow( OST0 )
.head 5 -  Call SalHideWindow( OST1 )
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set bDat = GetBankDate()
.head 4 -  Set n980 = GetBaseVal()
.head 4 -  Call SalTblSetLockedColumns(hWndForm, 2)
.head 4 -  Set RZ.strPrintFileName = 'RZ'
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalTblReset(hWndForm)
.head 4 -  Call SalTblReset(T_1200)
.head 4 -  Set SAL  = 0
.head 4 -  Set SAL1 = 0
.head 4 -  Set DEL  = 0
.head 4 -  Set DEL1 = 0
.head 4 -  ! залучення
.head 4 -  Set OST0_ = 0
.head 4 -  Set OST1_ = 0
.head 4 -  Set OST0F_ = 0
.head 4 -  Set OST1F_ = 0
.head 4 -  Set OST0R_ = 0
.head 4 -  Set OST1R_ = 0
.head 4 -  Set REZ_ = 0
.head 4 +  If SqlPLSQLCommand(hSql(), "N_REZ(nPar, bDat)")
and SqlCommitEx(hSql(), "Расчет резерва")
.head 5 -  Call SalTblPopulate(hWndForm, hSql(),
"SELECT ID, NAME, PR_NV, PR_IV,
        OST0, OST1, OST0F, OST1F
   INTO :RZ.ID,:RZ.NAME,:RZ.PR_NV,:RZ.PR_IV,
        :RZ.OST0,:RZ.OST1,:RZ.OST0F,:RZ.OST1F
   FROM TMP_rez0
  WHERE OST0<>0 or OST1<>0 or OST0F<>0 or OST1F<>0
  ORDER BY id ", TBL_FillAll)
.head 5 -  !
.head 5 -  ! Call SalTblDefineSplitWindow(hWndForm, 1, TBL_Split_Adjustable)
.head 5 -  ! Call SalTblFetchRow(hWndForm, SalTblInsertRow(hWndForm, TBL_MinSplitRow))
.head 5 -  Call SalTblFetchRow(hWndForm, SalTblInsertRow(hWndForm, TBL_MaxRow))
.head 5 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 5 -  Set nCol =  SalColorFromRGB( 255,240,255 )
.head 5 -  Set RZ.NAME  = "Всього"
.head 5 -  Set RZ.OST0  = OST0_
.head 5 -  Set RZ.OST1  = OST1_
.head 5 -  Set RZ.OST0F = OST0F_
.head 5 -  Set RZ.OST1F = OST1F_
.head 5 -  Set RZ.OST0R = OST0R_
.head 5 -  Set RZ.OST1R = OST1R_
.head 5 -  Set RZ.REZ   = REZ_
.head 5 -  Call XSalTblSetCellBackColor( NAME,  nCol )
.head 5 -  Call XSalTblSetCellBackColor( OST0,  nCol )
.head 5 -  Call XSalTblSetCellBackColor( OST1,  nCol )
.head 5 -  Call XSalTblSetCellBackColor( OST0F, nCol )
.head 5 -  Call XSalTblSetCellBackColor( OST1F, nCol )
.head 5 -  Call XSalTblSetCellBackColor( OST0R, nCol )
.head 5 -  Call XSalTblSetCellBackColor( OST1R, nCol )
.head 5 -  Call XSalTblSetCellBackColor( REZ,  nCol )
.head 5 +  If nPar = 3
.head 6 -  Call SalHideWindow(RZ.OST0F)
.head 6 -  Call SalHideWindow(RZ.OST1F)
.head 6 -  ! Call SalHideWindow(RZ.OST0R)
.head 6 -  ! Call SalHideWindow(RZ.OST1R)
.head 6 -  ! Call SalHideWindow(RZ.OST0R)
.head 6 -  ! Call SalHideWindow(RZ.OST1R)
.head 5 -  ! Джерела резервування
.head 5 -  Call T_1200.REZ0A()
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set OST0R  = SalNumberMax(0, OST0+OST0F)
.head 4 -  Set OST1R  = SalNumberMax(0, OST1+OST1F)
.head 4 -  Set REZ    = (OST0R*PR_NV + OST1R*PR_IV) / 100
.head 4 -  Set OST0_  = OST0_  + SalNumberMax(0, OST0)
.head 4 -  Set OST1_  = OST1_  + SalNumberMax(0, OST1)
.head 4 -  Set OST0F_ = OST0F_ + SalNumberMax(0, OST0F)
.head 4 -  Set OST1F_ = OST1F_ + SalNumberMax(0, OST1F)
.head 4 -  Set OST0R_ = OST0R_ + OST0R
.head 4 -  Set OST1R_ = OST1R_ + OST1R
.head 4 -  Set REZ_   = REZ_ + REZ
.head 1 +  Table Window: BS 
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Сравнительный Укрупненный БАЛАНС
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.27"
.head 4 -  Top:    0.225"
.head 4 -  Width:  14.671"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.813"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 2000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.802"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.8"
.head 6 -  Top:    0.448"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Свернутые данные'
.head 6 +  On SAM_Click
.head 7 -  Set FLAG = TRUE
.head 7 -  Call NASELENIE()
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 26728
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.443"
.head 6 -  Top:    0.125"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.686"
.head 6 -  Top:    0.094"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.233"
.head 6 -  Top:    0.448"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Развернутые данные'
.head 6 +  On SAM_Click
.head 7 -  Set FLAG = FALSE
.head 7 -  Call NASELENIE()
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.014"
.head 6 -  Top:    0.125"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Excel.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Экспорт таблицы'
.head 4 -  Line
.head 5 -  Resource Id: 26729
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.871"
.head 6 -  Top:    0.125"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 26730
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: DAT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.571"
.head 7 -  Top:    0.458"
.head 7 -  Width:  1.314"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Validate
.head 7 -  Call F_DAT()
.head 4 +  Data Field: DAT1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   8.143"
.head 7 -  Top:    0.469"
.head 7 -  Width:  1.314"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Validate
.head 7 -  Call F_DAT()
.head 4 +  Data Field: DAT2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   11.971"
.head 7 -  Top:    0.5"
.head 7 -  Width:  1.314"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Validate
.head 7 -  Set sTmp=SalFmtFormatDateTime(DAT1,'dd-MM-yyyy')
.head 7 -  Call SalTblSetColumnTitle(S1, sTmp)
.head 7 -  Call SalTblSetColumnTitle(S1s, sTmp)
.head 4 +  Radio Button: rbNOM
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: В номинале
.head 5 -  Window Location and Size
.head 6 -  Left:   0.214"
.head 6 -  Top:    0.469"
.head 6 -  Width:  1.671"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If rbNOM
.head 8 -  Call SalShowWindow(cmb_KV)
.head 7 +  Else
.head 8 -  Call SalHideWindow(cmb_KV)
.head 4 +  Radio Button: rbEKV
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: В экв
.head 5 -  Window Location and Size
.head 6 -  Left:   5.686"
.head 6 -  Top:    0.479"
.head 6 -  Width:  0.843"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If rbEKV
.head 8 -  Call SalHideWindow(cmb_KV)
.head 7 +  Else
.head 8 -  Call SalShowWindow(cmb_KV)
.head 4 +  Combo Box: cmb_KV
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenComboBox_NumId
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.9"
.head 6 -  Top:    0.49"
.head 6 -  Width:  2.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.094"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Editable? Class Default
.head 5 -  String Type: Class Default
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Sorted? Class Default
.head 5 -  Always Show List? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call cmb_KV.Init(hWndItem)
.head 7 -  Call cmb_KV.Populate(hSql(), "KV", "NAME", "TABVAL", " ORDER BY SKV")
.head 6 +  On SAM_Click
.head 7 -  Set nKV = cmb_KV.GetKey(SalListQuerySelection(cmb_KV))
.head 4 +  Pushbutton: pbRep
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRelation
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.571"
.head 6 -  Top:    0.125"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Word.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  ! вызов функции печати
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Set nInd = 0
.head 7 -  Set strFa = GetPrnDir()      || "\\" || qBS || IifS(nPar=4, "1", "2") || ".rtf"
.head 7 -  Set sQRP  = GetTemplateDir() || "\\" || qBS || IifS(nPar=4, "1", "2") || ".QRP"
.head 7 -  Set strBankName = NB
.head 7 -  ! Set strBind =
'DAT0,DAT,DAT1,PU,PAP,ORD,ORD1,ORD2,NAME,NAM1,NAM2,' ||
'Ss,S1,R,S0,R0,sTit,sPU,sPAP,strBankName'
.head 7 -  Set strBind =
'DAT0,DAT,DAT1,PU,PAP,ORD,ORD1,ORD2,NAME,NAM1,NAM2,' ||
'Ss,S1s,Rs,S0,R0,sTit,sPU,sPAP,strBankName'
.head 7 -  ! Call Debug(strBind)
.head 7 -  ! Call Debug(sQRP)
.head 7 -  Call SalReportPrintToFile(hWndForm, sQRP, strFa,
     strBind, strBind, 1, RPT_PrintAll, 1, 1, TRUE,  nInd)
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 +  If nInd > 0
.head 8 -  Call Debug('Ош.формирования отчета '||Str(nInd))
.head 7 +  Else
.head 8 -  ! If SalMessageBox("Желаете просмотреть файл отчета " ||
   strFa || " в редакторе?",
   "Отчет сформирован успешно!",
   MB_IconQuestion | MB_YesNo ) = IDYES
.head 8 -  Call SalLoadApp(GetEditorPath(), strFa)
.head 7 -  ! конец
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Печатный отчет'
.head 4 +  Pushbutton: pb1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbChilds
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.986"
.head 6 -  Top:    0.125"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F1
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Bf1.bmp
.head 5 -  Picture Transparent Color: White
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Подробно по Классу БС'
.head 6 +  On SAM_Click
.head 7 -  Call F_BS1(1)
.head 4 +  Pushbutton: pb2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbChilds
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.414"
.head 6 -  Top:    0.125"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F2
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Bf2.bmp
.head 5 -  Picture Transparent Color: White
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Подробно по Разделу БС'
.head 6 +  On SAM_Click
.head 7 -  Call F_BS1(2)
.head 4 +  Pushbutton: pb3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbChilds
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.843"
.head 6 -  Top:    0.125"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F3
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Bf3.bmp
.head 5 -  Picture Transparent Color: White
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Подробно по Группе БС'
.head 6 +  On SAM_Click
.head 7 -  Call F_BS1(3)
.head 4 +  Pushbutton: pb4
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbChilds
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.286"
.head 6 -  Top:    0.125"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F4
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Bf4.bmp
.head 5 -  Picture Transparent Color: White
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Подробно по БС'
.head 6 +  On SAM_Click
.head 7 -  Call F_BS1(4)
.head 4 +  Data Field: MFO
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.386"
.head 7 -  Top:    0.125"
.head 7 -  Width:  1.271"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.333"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Validate
.head 7 +  If Val(MFO) = 0
.head 8 -  Set NB = 'КОНСОЛИДИРОВАНО - ' || GetBankName()
.head 8 -  Return VALIDATE_Ok
.head 7 +  Else
.head 8 +  If SqlPrepareAndExecute(hSql(), "SELECT nb INTO :NB FROM banks WHERE mfo=:MFO")
.head 9 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Return VALIDATE_Ok
.head 7 -  Return VALIDATE_Cancel
.head 4 +  Data Field: NB
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.7"
.head 7 -  Top:    0.125"
.head 7 -  Width:  7.771"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.333"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Dark Red
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: aPU
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Б
Н
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.314"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: aPAP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: А
П
С
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.329"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ORD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: XX
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 2
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.371"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ORD1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Y
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.243"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ORD2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ZZ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 2
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.271"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: XX-Наименование
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  4.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: На дату
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.614"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Ss
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: На дату
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: На дату
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.571"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S1s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: На дату
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: R
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Разница
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.514"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Rs
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Разница
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAM1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Y-Наименование
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.971"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAM2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ZZ-Наименование
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.129"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nTmp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: XXYZZ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.671"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PU
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вид уч
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.514"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PAP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: АП
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.471"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: XXYZZ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.671"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: NASELENIE
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sf
.head 5 -  Number: i
.head 5 -  Number: j
.head 5 -  !
.head 5 -  Date/Time: DATr
.head 4 +  Actions
.head 5 -  Set nDn  = DAT1 - DAT
.head 5 -  Set DATr = DAT - nDn
.head 5 +  If SqlPrepareAndExecute(hSql(),
"SELECT max(fdat) from fdat INTO :DAT2  WHERE fdat<=:DATr")
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 5 +  If SetQueryFilter(cF)
.head 6 -  Set sf = ""
.head 6 -  Set sf = cF.GetFilterWhereClause(FALSE)
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  If rbEKV
.head 7 -  Set sTit = sTit1 || ' в эквиваленте'
.head 7 -  Set sSql1 = " substr(t.kodp,2,1)='0' "
.head 6 +  Else
.head 7 -  Set sTit = sTit1 || ' по валюте ' || cmb_KV
.head 7 +  If nKV = 980
.head 8 -  Set sSql1 = " substr(t.kodp,2,1)='0' and substr(t.kodp,7,3)=980"
.head 7 +  Else
.head 8 -  Set sSql1 = " substr(t.kodp,2,1)='1' and substr(t.kodp,7,3)="||Str(nKV)
.head 6 -  ! проверка на 3 знака
.head 6 +  If rbEKV
.head 7 -  Set nKVs = 980
.head 6 +  Else
.head 7 -  Set nKVs = nKV
.head 6 -  Call SqlPrepareAndExecute(hSqlAux(), "SELECT dig INTO :nDig FROM tabval WHERE kv=:nKVs")
.head 6 +  If not SqlFetchNext(hSqlAux(), nFetchRes)
.head 7 -  Return FALSE
.head 6 -  !
.head 6 -  Set idF  = 0
.head 6 -  Set idF1 = 0
.head 6 -  If Val(MFO) = 0
.head 6 +  Else
.head 7 +  If MFO != aMFO
.head 8 +  If SqlPrepareAndExecute(hSql(),
"SELECT file_id INTO :idF FROM rnbu_in_files 
  WHERE mfo=:MFO
    AND to_date (INIT_DATE,'dd-mm-yyyy')=:DAT
    AND substr(FILE_NAME,2,2)='01'")
.head 9 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 8 +  If nPar != 4
.head 9 +  If SqlPrepareAndExecute(hSql(),
"SELECT file_id INTO :idF1 FROM rnbu_in_files 
  WHERE mfo=:MFO
    AND to_date (INIT_DATE,'dd-mm-yyyy')=:DAT1 
    AND substr(FILE_NAME,2,2)='01'")
.head 10 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 9 +  If SqlPrepareAndExecute(hSql(),
"SELECT file_id INTO :idF2 FROM rnbu_in_files 
  WHERE mfo=:MFO
    AND to_date (INIT_DATE,'dd-mm-yyyy')=:DAT2 
    AND substr(FILE_NAME,2,2)='01'")
.head 10 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 -  !
.head 6 +  If FLAG	!! Сводно
.head 7 -  Set qBS = 'BS'
.head 7 -  Call SalHideWindow(BS.NAM1)
.head 7 -  Call SalHideWindow(BS.NAM2)
.head 7 -  Call SalHideWindow(BS.ORD1)
.head 7 -  Call SalHideWindow(BS.ORD2)
.head 7 +  If nPar = 4  !! 1 дата
.head 8 -  ! Только по гл банку
.head 8 +  If MFO = aMFO
.head 9 -  Set sSql =
"SELECT c.PU, c.PAP, c.ORD, ca.NAME, c.S 
   INTO :BS.PU, :BS.PAP, :BS.ORD, :BS.NAME, :BS.S
   FROM (SELECT a.pu PU, a.pap PAP, trunc(a.ORD/1000)*1000 ORD,
                sum(decode(a.pap, substr(t.kodp,1,1), 1, -1) * t.znap*b.zn )/100 S
           FROM bs1 a, bs2 b, tmp_nbu t
          WHERE a.id=b.id AND a.pap<3 AND substr(t.kodp,3,length(b.nbs))=b.nbs 
            AND t.datf=:DAT AND t.kodf='01' AND " || sSql1 ||
        " GROUP BY a.pu, a.pap, trunc(a.ORD/1000)
      UNION ALL
         SELECT a.pu, a.pap, trunc(a.ORD/1000)*1000,
                sum(decode(substr(t.kodp,1,1), 2, 1, -1) * t.znap )/100
           FROM bs1 a, bs2 b, tmp_nbu t
          WHERE a.id=b.id AND a.pap=3 AND substr(t.kodp,3,length(b.nbs))=b.nbs 
            AND t.datf=:DAT AND t.kodf='01' AND " || sSql1 ||
        " GROUP BY a.pu, a.pap,trunc(a.ORD/1000) ) c, bs1 ca
  WHERE c.PU=ca.PU and c.pap=ca.PAP and c.ORD=ca.ORD "
.head 8 -  ! Консолидировано по нашему банку
.head 8 +  Else If Val(MFO) = 0
.head 9 -  Set sSql =
"SELECT c.PU, c.PAP, c.ORD, ca.NAME, c.S
    INTO :BS.PU, :BS.PAP, :BS.ORD, :BS.NAME, :BS.S
    FROM (SELECT a.pu PU, a.pap PAP, trunc(a.ORD/1000)*1000 ORD,
                 sum(decode(a.pap, substr(t.kodp,1,1), 1, -1) * t.znap*b.zn )/100 S
            FROM bs1 a, bs2 b, V_BANKS_REPORT1 t
           WHERE a.id=b.id AND a.pap<3 AND substr(t.kodp,3,length(b.nbs))=b.nbs 
             AND t.datf=:DAT AND t.kodf='01' AND " || sSql1 ||
         " GROUP BY a.pu, a.pap, trunc(a.ORD/1000)
       UNION ALL
          SELECT a.pu, a.pap, trunc(a.ORD/1000)*1000,
                 sum(decode(substr(t.kodp,1,1), 2, 1, -1) * t.znap )/100
            FROM bs1 a, bs2 b, V_BANKS_REPORT1 t
           WHERE a.id=b.id AND a.pap=3 AND substr(t.kodp,3,length(b.nbs))=b.nbs 
             AND t.datf=:DAT AND t.kodf='01' AND "||sSql1||
         " GROUP BY a.pu, a.pap,trunc(a.ORD/1000) ) c, bs1 ca
  WHERE c.PU=ca.PU and c.pap=ca.PAP and c.ORD=ca.ORD "
.head 8 -  ! По любому банку #01 rкоторого есть (филиал, другие)
.head 8 +  Else
.head 9 -  Set sSql =
"SELECT c.PU, c.PAP, c.ORD, ca.NAME, c.S
   INTO :BS.PU, :BS.PAP, :BS.ORD, :BS.NAME, :BS.S
   FROM (SELECT a.pu PU, a.pap PAP, trunc(a.ORD/1000)*1000 ORD,
                sum(decode(a.pap, substr(t.kodp,1,1), 1, -1) * t.znap*b.zn )/100 S
           FROM bs1 a, bs2 b, xau t
          WHERE a.id=b.id AND a.pap<3 AND substr(t.kodp,3,length(b.nbs))=b.nbs 
            AND t.FILE_ID=:idF AND " || sSql1 ||
        " GROUP BY a.pu, a.pap, trunc(a.ORD/1000)
      UNION ALL
         SELECT a.pu, a.pap, trunc(a.ORD/1000)*1000,
                sum(decode(substr(t.kodp,1,1), 2, 1, -1) * t.znap )/100
           FROM bs1 a, bs2 b, xau t
          WHERE a.id=b.id AND a.pap=3 AND substr(t.kodp,3,length(b.nbs))=b.nbs 
            AND t.FILE_ID=:idF AND " || sSql1 ||
        " GROUP BY a.pu, a.pap,trunc(a.ORD/1000) ) c, bs1 ca
  WHERE c.PU=ca.PU and c.pap=ca.PAP and c.ORD=ca.ORD "
.head 7 +  Else !! 2 даты
.head 8 -  ! Только по гл банку
.head 8 +  If MFO = aMFO
.head 9 -  Set sSql =
"SELECT c.PU, c.PAP, c.ORD, ca.NAME, c.S, c.S1
   INTO :BS.PU, :BS.PAP, :BS.ORD, :BS.NAME, :BS.S, :BS.S1
   FROM (SELECT a.pu PU, a.pap PAP, trunc(a.ORD/1000)*1000 ORD,
                sum(decode(t.datf,:DAT, decode(a.pap,substr(t.kodp,1,1),1,-1)*t.znap*b.zn,0))/100 S,
                sum(decode(t.datf,:DAT1,decode(a.pap,substr(t.kodp,1,1),1,-1)*t.znap*b.zn,0))/100 S1
           FROM bs1 a, bs2 b, V_BANKS_REPORT1 t
          WHERE a.id=b.id AND a.pap<3 AND substr(t.kodp,3,length(b.nbs))=b.nbs 
            AND (t.datf=:DAT1 or t.datf=:DAT) AND t.kodf='01' AND " || sSql1 ||
        " GROUP BY a.pu, a.pap, trunc(a.ORD/1000)
      UNION ALL
         SELECT a.pu, a.pap, trunc(a.ORD/1000)*1000,
                sum(decode(t.datf,:DAT, decode(substr(t.kodp,1,1),2,1,-1)*t.znap,0))/100,
                sum(decode(t.datf,:DAT1,decode(substr(t.kodp,1,1),2,1,-1)*t.znap,0))/100
           FROM bs1 a, bs2 b, V_BANKS_REPORT1 t
          WHERE a.id=b.id AND a.pap=3 AND substr(t.kodp,3,length(b.nbs))=b.nbs 
            AND (t.datf=:DAT1 or t.datf=:DAT) AND t.kodf='01' AND " || sSql1 ||
        " GROUP BY a.pu, a.pap,trunc(a.ORD/1000) ) c, bs1 ca
  WHERE c.PU=ca.PU and c.pap=ca.PAP and c.ORD=ca.ORD "
.head 8 -  ! Консолидировано по нашему банку
.head 8 +  Else If Val(MFO) = 0
.head 9 -  Set sSql =
"SELECT c.PU, c.PAP, c.ORD, ca.NAME, c.S, c.S1
   INTO :BS.PU, :BS.PAP, :BS.ORD, :BS.NAME, :BS.S, :BS.S1
   FROM (SELECT a.pu PU, a.pap PAP, trunc(a.ORD/1000)*1000 ORD,
                sum(decode(t.datf,:DAT, decode(a.pap,substr(t.kodp,1,1),1,-1)*t.znap*b.zn,0))/100 S,
                sum(decode(t.datf,:DAT1,decode(a.pap,substr(t.kodp,1,1),1,-1)*t.znap*b.zn,0))/100 S1
           FROM bs1 a, bs2 b, tmp_nbu t
          WHERE a.id=b.id AND a.pap<3 AND substr(t.kodp,3,length(b.nbs))=b.nbs 
            AND (t.datf=:DAT1 or t.datf=:DAT) AND t.kodf='01' AND " || sSql1 ||
        " GROUP BY a.pu, a.pap, trunc(a.ORD/1000)
      UNION ALL
         SELECT a.pu, a.pap, trunc(a.ORD/1000)*1000,
                sum(decode(t.datf,:DAT, decode(substr(t.kodp,1,1),2,1,-1)*t.znap,0))/100,
                sum(decode(t.datf,:DAT1,decode(substr(t.kodp,1,1),2,1,-1)*t.znap,0))/100
           FROM bs1 a, bs2 b, tmp_nbu t
          WHERE a.id=b.id AND a.pap=3 AND substr(t.kodp,3,length(b.nbs))=b.nbs 
            AND (t.datf=:DAT1 or t.datf=:DAT) AND t.kodf='01' AND " || sSql1 ||
        " GROUP BY a.pu, a.pap,trunc(a.ORD/1000) ) c, bs1 ca
  WHERE c.PU=ca.PU and c.pap=ca.PAP and c.ORD=ca.ORD "
.head 8 -  ! По любому банку #01 rкоторого есть (филиал, другие)
.head 8 +  Else
.head 9 -  Set sSql =
"SELECT c.PU, c.PAP, c.ORD, ca.NAME, c.S, c.S1
   INTO :BS.PU, :BS.PAP, :BS.ORD, :BS.NAME, :BS.S, :BS.S1
   FROM (SELECT a.pu PU, a.pap PAP, trunc(a.ORD/1000)*1000 ORD,
                sum(decode(t.FILE_ID,:idF, decode(a.pap,substr(t.kodp,1,1),1,-1)*t.znap*b.zn,0))/100 S,
                sum(decode(t.FILE_ID,:idF1,decode(a.pap,substr(t.kodp,1,1),1,-1)*t.znap*b.zn,0))/100 S1
           FROM bs1 a, bs2 b, xau t
          WHERE a.id=b.id AND a.pap<3 AND substr(t.kodp,3,length(b.nbs))=b.nbs 
            AND (t.FILE_ID=:idF or t.FILE_ID=:idF1 ) AND " || sSql1 ||
        " GROUP BY a.pu, a.pap, trunc(a.ORD/1000)
      UNION ALL
         SELECT a.pu, a.pap, trunc(a.ORD/1000)*1000,
                sum(decode(t.FILE_ID,:idF, decode(substr(t.kodp,1,1),2,1,-1)*t.znap,0))/100,
                sum(decode(t.FILE_ID,:idF1,decode(substr(t.kodp,1,1),2,1,-1)*t.znap,0))/100
           FROM bs1 a, bs2 b, xau t
          WHERE a.id=b.id AND a.pap=3 AND substr(t.kodp,3,length(b.nbs))=b.nbs 
            AND (t.FILE_ID=:idF or t.FILE_ID=:idF1) AND " || sSql1 ||
        " GROUP BY a.pu, a.pap,trunc(a.ORD/1000) ) c, bs1 ca
  WHERE c.PU=ca.PU and c.pap=ca.PAP and c.ORD=ca.ORD "
.head 6 +  Else !! Подробно
.head 7 -  Set qBS = 'BSR'
.head 7 -  Call SalShowWindow(BS.NAM1)
.head 7 -  Call SalShowWindow(BS.NAM2)
.head 7 -  Call SalShowWindow(BS.ORD1)
.head 7 -  Call SalShowWindow(BS.ORD2)
.head 7 +  If nPar = 4 !! 1 дата
.head 8 +  If MFO = aMFO
.head 9 -  Set sSql =
"SELECT PU, PAP, ORD, ID, NAME, S
   INTO :BS.PU, :BS.PAP, :BS.nTmp, :BS.ID, :BS.NAM2, :BS.S
   FROM (SELECT a.pu PU, a.pap PAP, a.ORD ORD, a.id ID, a.NAME NAME,
                sum(decode(a.pap,substr(t.kodp,1,1),1,-1) * t.znap*b.zn )/100 S
           FROM bs1 a, bs2 b, tmp_nbu t
          WHERE a.id=b.id AND a.pap<3 AND substr(t.kodp,3,length(b.nbs))=b.nbs 
            AND t.datf=:DAT AND t.kodf='01' AND " || sSql1 ||
        " GROUP BY a.pu, a.pap, a.ORD, a.id, a.NAME
      UNION ALL
         SELECT a.pu, a.pap, a.ORD, a.id, a.NAME,
                sum(decode(substr(t.kodp,1,1),2,1,-1)*t.znap)/100
           FROM bs1 a, bs2 b, tmp_nbu t
          WHERE a.id=b.id AND a.pap=3 AND substr(t.kodp,3,length(b.nbs))=b.nbs 
            AND t.datf=:DAT AND t.kodf='01' AND " || sSql1 ||
        " GROUP BY a.pu, a.pap, a.ORD, a.id, a.NAME) ca "
.head 8 +  Else If Val(MFO) = 0
.head 9 -  Set sSql =
"SELECT PU, PAP, ORD, ID, NAME, S
   INTO :BS.PU, :BS.PAP, :BS.nTmp, :BS.ID, :BS.NAM2, :BS.S
   FROM (SELECT a.pu PU, a.pap PAP, a.ORD ORD, a.id ID, a.NAME NAME,
                sum(decode(a.pap,substr(t.kodp,1,1),1,-1) * t.znap*b.zn )/100 S
           FROM bs1 a, bs2 b, V_BANKS_REPORT1 t
          WHERE a.id=b.id AND a.pap<3 AND substr(t.kodp,3,length(b.nbs))=b.nbs 
            AND t.datf=:DAT AND t.kodf='01' AND " || sSql1 ||
        " GROUP BY a.pu, a.pap, a.ORD, a.id, a.NAME
      UNION ALL
         SELECT a.pu, a.pap, a.ORD, a.id, a.NAME,
                sum(decode(substr(t.kodp,1,1),2,1,-1)*t.znap)/100
           FROM bs1 a, bs2 b, V_BANKS_REPORT1 t
          WHERE a.id=b.id AND a.pap=3 AND substr(t.kodp,3,length(b.nbs))=b.nbs 
            AND t.datf=:DAT AND t.kodf='01' AND " || sSql1 ||
        " GROUP BY a.pu, a.pap, a.ORD, a.id, a.NAME) ca "
.head 8 +  Else
.head 9 -  Set sSql =
"SELECT PU, PAP, ORD, ID, NAME, S
   INTO :BS.PU, :BS.PAP, :BS.nTmp, :BS.ID, :BS.NAM2, :BS.S
   FROM (SELECT a.pu PU, a.pap PAP, a.ORD ORD, a.id ID, a.NAME NAME,
                sum(decode(a.pap,substr(t.kodp,1,1),1,-1) * t.znap*b.zn )/100 S
           FROM bs1 a, bs2 b, xau t
          WHERE a.id=b.id AND a.pap<3 AND substr(t.kodp,3,length(b.nbs))=b.nbs 
            AND t.FILE_ID=:idF AND " || sSql1 ||
        " GROUP BY a.pu, a.pap, a.ORD, a.id, a.NAME
     UNION ALL
        SELECT a.pu, a.pap, a.ORD, a.id, a.NAME,
               sum(decode(substr(t.kodp,1,1),2,1,-1)*t.znap)/100
          FROM bs1 a, bs2 b, xau t
         WHERE a.id=b.id AND a.pap=3 AND substr(t.kodp,3,length(b.nbs))=b.nbs 
           AND t.FILE_ID=:idF AND " || sSql1 ||
" GROUP BY a.pu, a.pap, a.ORD, a.id, a.NAME) ca "
.head 7 +  Else !! 2 даты
.head 8 +  If MFO = aMFO
.head 9 -  Set sSql =
"SELECT PU, PAP, ORD, ID, NAME, S, S1
   INTO :BS.PU, :BS.PAP, :BS.nTmp, :BS.ID, :BS.NAM2, :BS.S, :BS.S1
   FROM (SELECT a.pu PU, a.pap PAP, a.ORD ORD, a.id ID, a.NAME NAME,
                sum(decode(t.datf,:DAT, decode(a.pap,substr(t.kodp,1,1),1,-1)*t.znap*b.zn,0))/100 S,
                sum(decode(t.datf,:DAT1,decode(a.pap,substr(t.kodp,1,1),1,-1)*t.znap*b.zn,0))/100 S1
           FROM bs1 a, bs2 b, tmp_nbu t
          WHERE a.id=b.id AND a.pap<3 AND substr(t.kodp,3,length(b.nbs))=b.nbs 
            AND (t.datf=:DAT1 or t.datf=:DAT) AND t.kodf='01' AND " || sSql1 ||
        " GROUP BY a.pu, a.pap, a.ORD, a.id, a.NAME
      UNION ALL
         SELECT a.pu, a.pap, a.ORD, a.id, a.NAME,
                sum(decode(t.datf,:DAT, decode(substr(t.kodp,1,1),2,1,-1)*t.znap,0))/100,
                sum(decode(t.datf,:DAT1,decode(substr(t.kodp,1,1),2,1,-1)*t.znap,0))/100
           FROM bs1 a, bs2 b, tmp_nbu t
          WHERE a.id=b.id AND a.pap=3 AND  substr(t.kodp,3,length(b.nbs))=b.nbs 
            AND (t.datf=:DAT1 or t.datf=:DAT) AND t.kodf='01' AND " || sSql1 ||
        " GROUP BY a.pu, a.pap, a.ORD, a.id, a.NAME ) ca"
.head 8 +  Else If Val(MFO) = 0
.head 9 -  Set sSql =
"SELECT PU, PAP, ORD, ID, NAME, S, S1
   INTO :BS.PU, :BS.PAP, :BS.nTmp, :BS.ID, :BS.NAM2, :BS.S, :BS.S1
   FROM (SELECT a.pu PU, a.pap PAP, a.ORD ORD, a.id ID, a.NAME NAME,
                sum(decode(t.datf,:DAT, decode(a.pap,substr(t.kodp,1,1),1,-1)*t.znap*b.zn,0))/100 S,
                sum(decode(t.datf,:DAT1,decode(a.pap,substr(t.kodp,1,1),1,-1)*t.znap*b.zn,0))/100 S1
           FROM bs1 a, bs2 b, V_BANKS_REPORT1 t
          WHERE a.id=b.id AND a.pap<3 AND substr(t.kodp,3,length(b.nbs))=b.nbs 
            AND (t.datf=:DAT1 or t.datf=:DAT) AND t.kodf='01' AND " || sSql1 ||
        " GROUP BY a.pu, a.pap, a.ORD, a.id, a.NAME
      UNION ALL
         SELECT a.pu, a.pap, a.ORD, a.id, a.NAME,
                sum(decode(t.datf,:DAT, decode(substr(t.kodp,1,1),2,1,-1)*t.znap,0))/100,
                sum(decode(t.datf,:DAT1,decode(substr(t.kodp,1,1),2,1,-1)*t.znap,0))/100
           FROM bs1 a, bs2 b, V_BANKS_REPORT1 t
          WHERE a.id=b.id AND a.pap=3 AND  substr(t.kodp,3,length(b.nbs))=b.nbs 
            AND (t.datf=:DAT1 or t.datf=:DAT) AND t.kodf='01' AND " || sSql1 ||
        " GROUP BY a.pu, a.pap, a.ORD, a.id, a.NAME ) ca"
.head 8 +  Else
.head 9 -  Set sSql =
"SELECT PU, PAP, ORD, ID, NAME, S, S1
   INTO :BS.PU, :BS.PAP, :BS.nTmp, :BS.ID, :BS.NAM2, :BS.S, :BS.S1
   FROM (SELECT a.pu PU, a.pap PAP, a.ORD ORD, a.id ID, a.NAME NAME,
                sum(decode(t.FILE_ID,:idF, decode(a.pap,substr(t.kodp,1,1),1,-1)*t.znap*b.zn,0))/100 S,
                sum(decode(t.FILE_ID,:idF1,decode(a.pap,substr(t.kodp,1,1),1,-1)*t.znap*b.zn,0))/100 S1
           FROM bs1 a, bs2 b, xau t
          WHERE a.id=b.id AND a.pap<3 AND substr(t.kodp,3,length(b.nbs))=b.nbs 
            AND (t.FILE_ID=:idF or t.FILE_ID=:idF1) AND " || sSql1 ||
        " GROUP BY a.pu, a.pap, a.ORD, a.id, a.NAME
      UNION ALL
         SELECT a.pu, a.pap, a.ORD, a.id, a.NAME,
                sum(decode(t.FILE_ID,:idF, decode(substr(t.kodp,1,1),2,1,-1)*t.znap,0))/100,
                sum(decode(t.FILE_ID,:idF1,decode(substr(t.kodp,1,1),2,1,-1)*t.znap,0))/100
           FROM bs1 a, bs2 b, xau t
          WHERE a.id=b.id AND a.pap=3 AND  substr(t.kodp,3,length(b.nbs))=b.nbs 
            AND (t.FILE_ID=:idF or t.FILE_ID=:idF1) AND " || sSql1 ||
        " GROUP BY a.pu, a.pap, a.ORD, a.id, a.NAME ) ca"
.head 6 -  Set sSql = sSql || IifS(sf="", "", IifS(FLAG=TRUE, " AND ", " WHERE ") || sf) || " ORDER BY 1,2,3,4"
.head 6 -  Set SS[1,1] = 0
.head 6 -  Set SS[1,2] = 0
.head 6 -  Set SS[1,3] = 0
.head 6 -  Set SS[2,1] = 0
.head 6 -  Set SS[2,2] = 0
.head 6 -  Set SS[2,3] = 0
.head 6 -  Set SS1[1,1] = 0
.head 6 -  Set SS1[1,2] = 0
.head 6 -  Set SS1[1,3] = 0
.head 6 -  Set SS1[2,1] = 0
.head 6 -  Set SS1[2,2] = 0
.head 6 -  Set SS1[2,3] = 0
.head 6 -  Call SalTblPopulate(hWndForm, hSql(),sSql, TBL_FillAll)
.head 6 -  !
.head 6 -  Set i = 2
.head 6 +  While i > 0
.head 7 -  Set j = 3
.head 7 -  Call SalTblDefineSplitWindow(hWndForm, 7, TBL_Split_Adjustable)
.head 7 +  While j > 0
.head 8 +  If SS[i,j] != 0 or  SS1[i,j] != 0
.head 9 -  Call SalTblFetchRow(hWndForm, SalTblInsertRow(hWndForm, TBL_MinSplitRow))
.head 9 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 9 -  Set PU = i
.head 9 -  Set PAP = j
.head 9 +  If PU = 1
.head 10 -  Set aPU = 'Б'
.head 10 -  Set NAME = 'Баланс - '
.head 9 +  Else
.head 10 -  Set aPU = 'Н'
.head 10 -  Set NAME = 'вНебаланс - '
.head 9 +  If PAP = 1
.head 10 -  Set aPAP = 'А'
.head 10 -  Set NAME = NAME || 'Активы'
.head 9 +  Else If PAP = 2
.head 10 -  Set aPAP = 'П'
.head 10 -  Set NAME = NAME || 'Пассивы'
.head 9 +  Else If PAP = 3
.head 10 -  Set aPAP = 'С'
.head 10 -  Set NAME = NAME || 'Справочно'
.head 9 -  Set S = SS[i,j]
.head 9 -  Set S1= SS1[i,j]
.head 9 -  Set R = S1-S
.head 9 -  !
.head 9 -  ! Set Ss  = SalNumberToStrX( S*SalNumberPower( 10, 2-nDig ), nDig )
.head 9 -  Set Ss  = Dig4(S, nDig, nDig)
.head 9 -  Set S1s = Dig4(S1, nDig, nDig)
.head 9 -  Set Rs  = Dig4(R, nDig, nDig)
.head 9 -  ! Set S1s = SalNumberToStrX( S1*SalNumberPower( 10, 2-nDig ), nDig )
.head 9 -  ! Set Rs  = SalNumberToStrX( R*SalNumberPower( 10, 2-nDig ), nDig )
.head 9 -  !
.head 8 -  Set j = j - 1
.head 7 -  Set i = i - 1
.head 6 -  !
.head 6 +  If nPar != 4 
.head 7 -  Call TFR()
.head 6 -  !
.head 6 -  Call SalSetWindowText(hWndForm,sTit)
.head 6 -  Call SalTblSetContext(hWndForm, 0)
.head 6 -  Call SalTblSetRowFlags(hWndForm, 0, ROW_Selected, TRUE)
.head 6 -  Call SalSendMsg(hWndForm, SAM_RowSetContext, 0, 0)
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 +  Function: TFR
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nT1
.head 5 -  Number: nT
.head 5 -  Number: nT2
.head 4 +  Actions
.head 5 +  If MFO = aMFO or Val(MFO) = 0 !! По гл банку или консолидировано
.head 6 -  Set sSql =
"SELECT SUM(S*ZN)/100, SUM(S1*ZN)/100, SUM(S2*ZN)/100 INTO :nT, :nT1, :nT2 
   FROM (select decode(substr(kodp,3,1),'6',1,-1) ZN,
                iif_d(datf,:DAT, 0,znap,0) S,
                iif_d(datf,:DAT1,0,znap,0) S1,
                iif_d(datf,:DAT2,0,znap,0) S2 
           from " || IifS(MFO=aMFO, "V_BANKS_REPORT1", "tmp_nbu") || "  
          WHERE substr(kodp,3,1) in ('6','7') AND datf in (:DAT1,:DAT,:DAT2) 
            AND kodf='01')"
.head 5 +  Else !! По любому МФО
.head 6 -  Set sSql =
"SELECT SUM(S*ZN)/100, SUM(S1*ZN)/100, SUM(S2*ZN)/100 INTO :nT, :nT1, :nT2 
   FROM (select decode(substr(kodp,3,1),'6',1,-1) ZN,
                iif_n(FILE_ID,:idF, 0,znap,0) S,
                iif_n(FILE_ID,:idF1,0,znap,0) S1,
                iif_n(FILE_ID,:idF2,0,znap,0) S2 
           from xau  
          WHERE substr(kodp,3,1) in ('6','7') 
            AND (FILE_ID=:idF or FILE_ID=:idF1 or FILE_ID=:idF2) )"
.head 5 +  If SqlPrepareAndExecute( hSql(),sSql)
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call SalTblFetchRow(hWndForm, SalTblInsertRow(hWndForm, TBL_MinSplitRow))
.head 6 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 6 -  Set PU = 1
.head 6 -  Set aPU = 'Б'
.head 6 -  Set PAP = 3
.head 6 -  Set aPAP = 'С'
.head 6 -  Set NAME = 'Динамика фин.результата за ' || Str(nDn) || ' дней'
.head 6 -  Set S1= nT1-nT
.head 6 -  Set S = nT -nT2
.head 6 -  Set R = S1-S
.head 6 -  !
.head 6 -  Set Ss  = Dig4(S, nDig, nDig)
.head 6 -  Set S1s = Dig4(S1, nDig, nDig)
.head 6 -  Set Rs  = Dig4(R, nDig, nDig)
.head 3 +  Function: F_BS1
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nUR
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalCreateWindow( BS1, hWndMDI, nUR, NAM2, nPar, DAT, DAT1, BS.ID, sSql1,
SS[BS.PU,BS.PAP], SS1[BS.PU,BS.PAP], SS1[BS.PU,BS.PAP]-SS[BS.PU,BS.PAP],
MFO, idF,idF1 )
.head 3 +  Function: F_DAT
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set sTmp=SalFmtFormatDateTime(DAT,'dd-MM-yyyy')
.head 5 -  Call SalTblSetColumnTitle(S, sTmp)
.head 5 -  Call SalTblSetColumnTitle(Ss, sTmp)
.head 5 -  Set sTmp=SalFmtFormatDateTime(DAT1,'dd-MM-yyyy')
.head 5 -  Call SalTblSetColumnTitle(S1, sTmp)
.head 5 -  Call SalTblSetColumnTitle(S1s, sTmp)
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 2 +  Window Variables
.head 3 -  String: strBankName
.head 3 -  Number: nRep
.head 3 -  Number: idF
.head 3 -  Number: idF1
.head 3 -  Number: idF2
.head 3 -  Number: nDn
.head 3 -  String: aMFO
.head 3 -  String: sTmp
.head 3 -  Number: iPU
.head 3 -  Number: iPAP
.head 3 -  String: sPU
.head 3 -  String: sPAP
.head 3 -  String: strBind
.head 3 -  String: sQRP
.head 3 -  String: strFa
.head 3 -  String: sSql
.head 3 -  String: sSql1
.head 3 -  String: sD
.head 3 -  String: sTit
.head 3 -  String: sTit1
.head 3 -  String: qBS
.head 3 -  Number: nKV
.head 3 -  Number: nInd
.head 3 -  Number: i
.head 3 -  Number: S0
.head 3 -  Number: R0
.head 3 -  Date/Time: DAT0
.head 3 -  Boolean: FLAG
.head 3 -  !
.head 3 -  : cF
.head 4 -  Class: cGenFilter
.head 3 -  Number: SS[3,4]
.head 3 -  Number: SS1[3,4]
.head 3 -  !
.head 3 -  Number: nDig
.head 3 -  Number: nKVs
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 +  If SqlPrepareAndExecute(hSql(), 
"SELECT max(datf) INTO :DAT FROM tmp_nbu WHERE kodf='01' AND datf<bankdate")
.head 5 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 5 -  Set sTmp = SalFmtFormatDateTime(DAT,'dd-MM-yyyy')
.head 5 -  Call SalTblSetColumnTitle(S, sTmp)
.head 5 -  Call SalTblSetColumnTitle(Ss, sTmp)
.head 4 +  If nPar = 4
.head 5 -  Set sTit1 = 'Укрупненный БАЛАНС '
.head 5 -  Call SalHideWindow(BS.S1)
.head 5 -  Call SalHideWindow(BS.R)
.head 5 -  Call SalHideWindow(BS.S1s)
.head 5 -  Call SalHideWindow(BS.Rs)
.head 5 -  Call SalHideWindow(BS.DAT1)
.head 5 -  Call SalHideWindow(BS.DAT2)
.head 4 +  Else
.head 5 -  Set DAT1 = DAT
.head 5 -  Set sTit1 = 'Сравнительный Укрупненный БАЛАНС '
.head 4 -  Set MFO = GetBankMfo()
.head 4 -  Set aMFO = MFO
.head 4 -  Set NB = GetBankName()
.head 4 -  Set strBankName = NB
.head 4 -  !
.head 4 -  Call SalHideWindow(BS.NAM1)
.head 4 -  Call SalHideWindow(BS.NAM2)
.head 4 -  Call SalHideWindow(BS.ORD1)
.head 4 -  Call SalHideWindow(BS.ORD2)
.head 4 -  Call SalTblSetLockedColumns(hWndForm, 6)
.head 4 -  Set rbEKV = TRUE
.head 4 -  Call SalHideWindow(cmb_KV)
.head 4 -  Set rbNOM = FALSE
.head 4 -  Set BS.strPrintFileName = 'BS'
.head 4 -  Call cF.Init('BS1', 'ca')
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 -  On UM_Populate
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set R = S1-S
.head 4 -  Set SS[PU,PAP]  = SS[PU,PAP]+S
.head 4 -  Set SS1[PU,PAP] = SS1[PU,PAP]+S1
.head 4 +  If not FLAG
.head 5 -  Set ORD2 = SalNumberMod(nTmp,100 )              !!    ZZ +NAM2
.head 5 -  !
.head 5 -  Set nTmp = nTmp - ORD2
.head 5 +  If SqlPrepareAndExecute(hSqlAux2(),
  "SELECT name INTO :NAM1 FROM  bs1
   WHERE  pu=:PU and pap=:PAP and ord=:nTmp")
.head 6 -  Call SqlFetchNext(hSqlAux2(),nFetchRes)
.head 5 -  Set ORD1 = SalNumberMod(nTmp,1000 ) /100        !!    Y +NAM1
.head 5 -  !
.head 5 -  Set nTmp=nTmp - ORD1 * 100
.head 5 +  If SqlPrepareAndExecute(hSqlAux2(),
  "SELECT name INTO :NAME FROM bs1
   WHERE pu=:PU and pap=:PAP and ord=:nTmp")
.head 6 -  Call SqlFetchNext(hSqlAux2(),nFetchRes)
.head 5 -  Set ORD = nTmp/1000             !!    XX +NAME
.head 4 +  Else
.head 5 -  Set ORD = ORD/1000
.head 4 -  Set aPU  = IifS(PU=1,'Б','Н')
.head 4 -  Set aPAP = IifS(PAP=1,'А',IifS(PAP=2,'П','С'))
.head 4 -  ! проверка на 3 знака
.head 4 -  Set Ss  = Dig4(S, nDig, nDig)
.head 4 -  Set S1s = Dig4(S1, nDig, nDig)
.head 4 -  Set Rs  = Dig4(R, nDig, nDig)
.head 3 +  On SAM_RowSetContext
.head 4 +  If not FLAG
.head 5 -  Call SalEnableWindow(pb1)
.head 5 -  Call SalEnableWindow(pb2)
.head 5 -  Call SalEnableWindow(pb3)
.head 5 -  Call SalEnableWindow(pb4)
.head 4 +  Else
.head 5 -  Call SalDisableWindow(pb1)
.head 5 -  Call SalDisableWindow(pb2)
.head 5 -  Call SalDisableWindow(pb3)
.head 5 -  Call SalDisableWindow(pb4)
.head 3 +  On SAM_ReportStart
.head 4 -  Set i = TBL_MinRow
.head 4 -  Set iPU  = -1
.head 4 -  Set iPAP = -1
.head 3 +  On SAM_ReportFetchNext
.head 4 +  If SalTblFindNextRow(hWndForm, i, 0, 0)
.head 5 -  Call SalTblFetchRow(hWndForm, i)
.head 5 +  If iPU != PU
.head 6 +  If SqlPrepareAndExecute(hSql(), "SELECT name INTO :sPU from bs0 where id=:PU")
.head 7 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set iPU = PU
.head 5 -  Return TRUE
.head 4 -  Return FALSE
.head 3 +  On SAM_ReportFetchInit
.head 4 -  Return TRUE
.head 3 +  On SAM_ReportFinish
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Table Window: SBALANS
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Средний БАЛАНС
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.0"
.head 4 -  Top:    0.317"
.head 4 -  Width:  14.671"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.813"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 2000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.5"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.157"
.head 6 -  Top:    0.115"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Баланс '
.head 6 +  On SAM_Click
.head 7 -  Set FLAG = TRUE
.head 7 -  Call NASELENIE()
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 34549
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.814"
.head 6 -  Top:    0.115"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.143"
.head 6 -  Top:    0.115"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   12.143"
.head 6 -  Top:    0.115"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Развернутые данные '
.head 6 +  On SAM_Click
.head 7 -  Set FLAG = FALSE
.head 7 -  Call NASELENIE()
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.257"
.head 6 -  Top:    0.115"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Print.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Экспорт таблицы'
.head 4 -  Line
.head 5 -  Resource Id: 34550
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   13.9"
.head 6 -  Top:    0.115"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 34551
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Radio Button: rbNOM
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: В номинале
.head 5 -  Window Location and Size
.head 6 -  Left:   7.029"
.head 6 -  Top:    0.135"
.head 6 -  Width:  1.643"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If rbNOM
.head 8 -  Call SalShowWindow(cmb_KV)
.head 7 +  Else
.head 8 -  Call SalHideWindow(cmb_KV)
.head 4 +  Radio Button: rbEKV
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: В экв
.head 5 -  Window Location and Size
.head 6 -  Left:   5.871"
.head 6 -  Top:    0.135"
.head 6 -  Width:  0.843"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If rbEKV
.head 8 -  Call SalHideWindow(cmb_KV)
.head 7 +  Else
.head 8 -  Call SalShowWindow(cmb_KV)
.head 4 +  Combo Box: cmb_KV
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenComboBox_NumId
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.843"
.head 6 -  Top:    0.135"
.head 6 -  Width:  2.9"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.26"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Editable? Class Default
.head 5 -  String Type: Class Default
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Sorted? Class Default
.head 5 -  Always Show List? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call cmb_KV.Init(hWndItem)
.head 7 -  Call cmb_KV.Populate(hSql(), "KV", "NAME", "TABVAL", " ORDER BY SKV")
.head 6 +  On SAM_Click
.head 7 -  Set nKV = cmb_KV.GetKey(SalListQuerySelection(cmb_KV))
.head 4 -  Line
.head 5 -  Resource Id: 34552
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  12.686"
.head 6 -  Begin Y:  0.479"
.head 6 -  End X:  12.686"
.head 6 -  End Y:  -0.031"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 -  Line
.head 5 -  Resource Id: 34553
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  13.786"
.head 6 -  Begin Y:  0.51"
.head 6 -  End X:  13.786"
.head 6 -  End Y:  0.0"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: Default
.head 4 +  Combo Box: cmbY
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenComboBox_NumId
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.9"
.head 6 -  Top:    0.135"
.head 6 -  Width:  1.514"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.927"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Editable? Class Default
.head 5 -  String Type: Class Default
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Sorted? Class Default
.head 5 -  Always Show List? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 +  If cmbY.Init(hWndItem)
.head 8 -  Call SqlPrepareAndExecute(hSql(), 
"SELECT distinct to_char(fdat,'YYYY') INTO :sY FROM fdat ORDER BY 1")
.head 8 +  While SqlFetchNext(hSql(), nFetchRes)
.head 9 -  Call cmbY.Add(Val(sY), sY)
.head 7 -  Call cmbY.SetCurrentKey(SalListSelectString(hWndItem, -1, Str(SalDateYear( GetBankDate()))))
.head 7 -  Call SalSendMsg(hWndItem, SAM_Click, 0, 0)
.head 6 +  On SAM_Click
.head 7 -  Set nY = cmbY.GetKey(SalListQuerySelection(cmbY))
.head 7 -  Call SalTblSetColumnTitle(SBALANS.S1s, Str(nY) ||'г.')
.head 7 -  Set i = 0
.head 7 -  Set nY2 = nY - 1
.head 7 +  Loop
.head 8 +  If i >= cmbY.nItemNum
.head 9 -  Call SalHideWindow(S2s)
.head 9 -  Call SalHideWindow(TP12)
.head 9 -  Set nY2 = 0
.head 9 -  Break
.head 8 +  If cmbY.strList[i, 0] = Str(nY2)
.head 9 -  Call SalShowWindow(S2s)
.head 9 -  Call SalTblSetColumnTitle(SBALANS.S2s, Str(nY2) || 'г.' )
.head 9 -  Call SalShowWindow(TP12)
.head 9 -  Call SalTblSetColumnTitle(  SBALANS.TP12, 'Темп
прироста в
' || Str(nY) || 'г. (%)' )
.head 9 -  Break
.head 8 -  Set i = i + 1
.head 7 -  Set i = 0
.head 7 -  Set nY3 = nY - 2
.head 7 +  Loop
.head 8 +  If i >= cmbY.nItemNum
.head 9 -  Call SalHideWindow(S3s)
.head 9 -  Call SalHideWindow(TP23)
.head 9 -  Set nY3 = 0
.head 9 -  Break
.head 8 +  If cmbY.strList[i, 0] = Str(nY3)
.head 9 -  Call SalShowWindow(S3s)
.head 9 -  Call SalTblSetColumnTitle( SBALANS.S3s, Str(nY3) || 'г.' )
.head 9 -  Call SalShowWindow(TP23)
.head 9 -  Call SalTblSetColumnTitle( SBALANS.TP23, 'Темп
прироста в
' || Str(nY2) || 'г. (%)' )
.head 9 -  Break
.head 8 -  Set i = i + 1
.head 7 -  Call SalTblReset(SBALANS)
.head 4 -  Background Text: Год
.head 5 -  Resource Id: 34554
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    0.177"
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Right
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 2 +  Contents
.head 3 +  Column: PAP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: АП
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.471"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: aPAP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: А
П
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.3"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ORD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: XXYZZ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.671"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование статьи
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  4.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Год1
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.614"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S1s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Год1
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Год2
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.571"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S2s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Год2
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Год3
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.571"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S3s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Год3
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: TP12
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Темп
прироста1
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: TP23
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Темп
прироста2
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.2"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: NASELENIE
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: j
.head 5 -  String: ssY
.head 4 +  Actions
.head 5 +  If SetQueryFilter(cF)
.head 6 -  Set sf = ""
.head 6 -  Set sf = cF.GetFilterWhereClause(FALSE)
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Call SqlPrepareAndExecute(hSqlAux(), 
"SELECT dig INTO :nDig FROM tabval WHERE kv=" || IifS(rbNOM=TRUE, ":nKV", Str(GetBaseVal())))
.head 6 +  If not SqlFetchNext(hSqlAux(), nFetchRes)
.head 7 -  Return FALSE
.head 6 -  !
.head 6 +  If FLAG
.head 7 -  Set sSql = 
"SELECT bs1.pap, bs1.ord, bs1.name, 
        abs(sum(decode(a.dat,:nY ,a.ost,0)))/100/decode(k.c1,0,1,k.c1) "      || IifS(nY2!=0, ", 
        abs(sum(decode(a.dat,:nY2,a.ost,0)))/100/decode(k.c2,0,1,k.c2) ", "") || IifS(nY3!=0, ", 
        abs(sum(decode(a.dat,:nY3,a.ost,0)))/100/decode(k.c3,0,1,k.c3) ", "") || "
   INTO :SBALANS.PAP, :SBALANS.ORD, :SBALANS.NAME
        :SBALANS.S1 " || IifS(nY2!=0, ", :SBALANS.S2" , "") || IifS(nY3!=0, ", :SBALANS.S3 ", "") || " 
   FROM bs1, 
        (SELECT bs1.id,to_number(to_char(f.fdat,'yyyy')) dat, " || 
                IifS(rbNOM=TRUE, "sum(s.ostf - s.dos + s.kos)", "sum(gl.p_icurval(a.kv,s.ostf - s.dos + s.kos,f.fdat))") || " ost 
           FROM V_GL  a, saldoa s, fdat f, bs2, bs1 
          WHERE a.acc=s.acc 
            AND (a.acc,s.fdat)=(SELECT c.acc,max(c.fdat) 
                                  FROM saldoa c 
                                 WHERE a.acc=c.acc AND c.fdat <= f.fdat 
                                 GROUP BY c.acc) 
            AND to_number(to_char(f.fdat,'yyyy')) in (:nY " || IifS(nY2!=0, ", :nY2", "") || IifS(nY3!=0, ", :nY3", "") || ") 
            AND a.nbs=bs2.nbs AND bs2.id=bs1.id AND bs1.pu=1 " || IifS(rbNOM=TRUE, " AND a.kv=:nKV ", "") || " 
          GROUP BY bs1.id, to_number(to_char(f.fdat,'yyyy'))     
      union all
         SELECT bs1.id, to_number(to_char(o.fdat,'yyyy'))-1, " || 
                IifS(rbNOM=TRUE, "sum(decode(o.dk,1,o.S,-o.S))", "sum(gl.p_icurval(a.kv,decode(o.dk,1,o.S,-o.S),o.fdat))") || "
           FROM opldok o, oper p, V_GL  a, bs2, bs1 
          WHERE o.ref=p.ref AND o.sos=5 AND p.vob=96 
            AND to_number(to_char(o.fdat,'yyyy')) in ((:nY)+1" || IifS(nY2!=0, ", :nY", "") || IifS(nY3!=0, ", (:nY)-1", "") || ") 
            AND to_char(o.fdat,'mm')='01' AND o.acc=a.acc 
            AND a.nbs=bs2.nbs AND bs2.id=bs1.id AND bs1.pu=1 " || IifS(rbNOM=TRUE, " AND a.kv=:nKV ", "") || " 
          GROUP BY bs1.id, to_number(to_char(o.fdat,'yyyy')) 
      union all 
         SELECT bs1.id, to_number(to_char(o.fdat,'yyyy')), " || 
                IifS(rbNOM=TRUE, "-sum(decode(o.dk,1,o.S,-o.S))", "-sum(gl.p_icurval(a.kv,decode(o.dk,1,o.S,-o.S),o.fdat))") || "
           FROM opldok o, oper p, V_GL  a, bs2, bs1 
          WHERE o.ref=p.ref AND o.sos=5 AND p.vob=96  
            AND to_number(to_char(o.fdat,'yyyy')) in (:nY " || IifS(nY2!=0, ", :nY2", "") || IifS(nY3!=0, ", :nY3", "") || ") 
            AND to_char(o.fdat,'mm')='01' AND o.acc=a.acc 
            AND a.nbs=bs2.nbs AND bs2.id=bs1.id AND bs1.pu=1 " || IifS(rbNOM=TRUE, " AND a.kv=:nKV ", "") || " 
          GROUP BY bs1.id, to_number(to_char(o.fdat,'yyyy')) ) a, 
        (SELECT sum(decode(to_char(fdat,'yyyy'),:nY, 1,0)) c1 "      || IifS(nY2!=0, ",  
                sum(decode(to_char(fdat,'yyyy'),:nY2,1,0)) c2 ", "") || IifS(nY3!=0, ", 
                sum(decode(to_char(fdat,'yyyy'),:nY3,1,0)) c3 ", "") || "
           FROM fdat 
          WHERE to_number(to_char(fdat,'yyyy')) in (:nY " || IifS(nY2!=0, ", :nY2", "") || IifS(nY3!=0, ", :nY3", "") || ") ) k 
  WHERE a.id=bs1.id " || IifS( sf="", "", " AND "||sf ) || " 
  GROUP BY bs1.pap, bs1.ord, bs1.name, k.c1 " || IifS(nY2!=0, ", k.c2", "") || IifS(nY3!=0, ", k.c3", "") || " 
  ORDER BY 1,2"
.head 6 -  Set SS1[1] = 0
.head 6 -  Set SS1[2] = 0
.head 6 -  Set SS2[1] = 0
.head 6 -  Set SS2[2] = 0
.head 6 -  Set SS3[1] = 0
.head 6 -  Set SS3[2] = 0
.head 6 -  Call SalTblPopulate(hWndForm, hSql(), sSql, TBL_FillAll)
.head 6 -  !
.head 6 -  Set j = 2
.head 6 -  Call SalTblDefineSplitWindow(hWndForm, 3, TBL_Split_Adjustable)
.head 6 +  While j > 0
.head 7 +  If SS1[j] != 0 or SS2[j] != 0 or SS3[j] != 0
.head 8 -  Call SalTblFetchRow(hWndForm, SalTblInsertRow(hWndForm, TBL_MinSplitRow))
.head 8 -  Call SalTblSetFlagsAnyRows(hWndForm, ROW_New, FALSE, 0, 0)
.head 8 -  Set PAP = j
.head 8 -  Set NAME = 'Баланс - '
.head 8 +  If PAP = 1
.head 9 -  Set aPAP = 'А'
.head 9 -  Set NAME = NAME || 'Активы'
.head 8 +  Else If PAP = 2
.head 9 -  Set aPAP = 'П'
.head 9 -  Set NAME = NAME || 'Пассивы'
.head 8 -  Set S1 = SS1[j]
.head 8 -  Set S2 = SS2[j]
.head 8 -  Set S3 = SS3[j]
.head 8 +  If nY2 AND S2 != NUMBER_Null AND S2 != 0
.head 9 -  Set TP12 = (S1-S2)/S2*100
.head 8 +  Else
.head 9 -  Set TP12 = NUMBER_Null
.head 8 +  If nY3 AND S3 != NUMBER_Null AND S3 != 0
.head 9 -  Set TP23 = (S2-S3)/S3*100
.head 8 +  Else
.head 9 -  Set TP23 = NUMBER_Null
.head 8 -  !
.head 8 -  Set S1s = Dig4(S1, nDig, nDig)
.head 8 -  Set S2s = Dig4(S2, nDig, nDig)
.head 8 -  Set S3s = Dig4(S3, nDig, nDig)
.head 8 -  !
.head 7 -  Set j = j - 1
.head 6 -  !
.head 6 -  Call SalSetWindowText(hWndForm, sTitle || IifS( rbEKV=TRUE, " в эквиваленте", " по валюте " || cmb_KV))
.head 6 -  Call SalTblSetContext(hWndForm, 0)
.head 6 -  Call SalTblSetRowFlags(hWndForm, 0, ROW_Selected, TRUE)
.head 6 -  Call SalSendMsg(hWndForm, SAM_RowSetContext, 0, 0)
.head 5 -  Call SalWaitCursor(FALSE)
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 2 +  Window Variables
.head 3 -  String: sSql
.head 3 -  String: sTitle
.head 3 -  Number: nKV
.head 3 -  Number: nY
.head 3 -  Number: nY2
.head 3 -  Number: nY3
.head 3 -  Boolean: FLAG
.head 3 -  String: sf
.head 3 -  String: sY
.head 3 -  Number: i
.head 3 -  !
.head 3 -  : cF
.head 4 -  Class: cGenFilter
.head 3 -  Number: SS1[3]
.head 3 -  Number: SS2[3]
.head 3 -  Number: SS3[3]
.head 3 -  !
.head 3 -  Number: nDig
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Set sTitle = "Средний БАЛАНС "
.head 4 -  Call SalSetWindowText(hWndForm, sTitle)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalTblSetLockedColumns(hWndForm, 3)
.head 4 -  Set rbEKV = TRUE
.head 4 -  Call SalHideWindow(cmb_KV)
.head 4 -  Set rbNOM = FALSE
.head 4 -  Set SBALANS.strPrintFileName = 'SBALANS'
.head 4 -  Call cF.Init('BS1', 'bs1')
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set SS1[PAP] = SS1[PAP] + S1
.head 4 -  Set SS2[PAP] = SS2[PAP] + S2
.head 4 -  Set SS3[PAP] = SS3[PAP] + S3
.head 4 -  Set aPAP = IifS(PAP=1, 'А', 'П')
.head 4 +  If nY2 AND S2 != NUMBER_Null AND S2 != 0
.head 5 -  Set TP12 = (S1-S2)/S2*100
.head 4 +  Else
.head 5 -  Set TP12 = NUMBER_Null
.head 4 +  If nY3 AND S3 != NUMBER_Null AND S3 != 0
.head 5 -  Set TP23 = (S2-S3)/S3*100
.head 4 +  Else
.head 5 -  Set TP23 = NUMBER_Null
.head 4 -  ! проверка на 3 знака
.head 4 -  Set S1s = Dig4(S1, nDig, nDig)
.head 4 -  Set S2s = Dig4(S2, nDig, nDig)
.head 4 -  Set S3s = Dig4(S3, nDig, nDig)
.head 1 +  Table Window: BS1
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.27"
.head 4 -  Top:    0.625"
.head 4 -  Width:  13.729"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 56781
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 56782
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 56783
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: KL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: К
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.243"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: RZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: P
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.257"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: GR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Г
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.243"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: BA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.243"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  4.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: %
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.886"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: На дату
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.614"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: Ss
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: На дату
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  1.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PS1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: %
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.829"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: S1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: На дату
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.571"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: %
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.886"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: R
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Разница
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.514"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NBS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: БС
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.886"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nUR
.head 3 -  String: NAM2
.head 3 -  Number: nPar
.head 3 -  Date/Time: DAT
.head 3 -  Date/Time: DAT1
.head 3 -  Number: ID
.head 3 -  String: sSql1
.head 3 -  Number: SS
.head 3 -  Number: SS1
.head 3 -  Number: RA
.head 3 -  !
.head 3 -  String: MFO
.head 3 -  Number: idF
.head 3 -  Number: idF1
.head 2 +  Window Variables
.head 3 -  String: sTmp
.head 3 -  String: sSQL
.head 3 -  String: sINS
.head 3 -  Number: nID
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalSetWindowText(hWndForm, 'Ур.' || Str(nUR) || '.' || NAM2)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set sTmp = SalFmtFormatDateTime (DAT,'dd-MM-yyyy')
.head 4 -  Call SalTblSetColumnTitle(S, sTmp)
.head 4 -  Call SalTblSetColumnTitle(Ss, sTmp)
.head 4 -  Set sTmp = SalFmtFormatDateTime(DAT1,'dd-MM-yyyy')
.head 4 -  Call SalTblSetColumnTitle(S1, sTmp)
.head 4 -  Set nID = GetUserId()
.head 4 +  If SqlPrepareAndExecute(hSql(), "DELETE FROM tmp_bs where id=:nID")
.head 5 -  Call SqlPrepareAndExecute(hSql(), "commit")
.head 4 +  If MFO = GetBankMfo()
.head 5 +  If nPar = 4 !! 1 дата
.head 6 -  Call SalHideWindow(BS1.S1)
.head 6 -  Call SalHideWindow(BS1.PS1)
.head 6 -  Call SalHideWindow(BS1.PR)
.head 6 -  Call SalHideWindow(BS1.R)
.head 6 -  Set sINS =
"INSERT INTO tmp_bs(NBS,S,ID)
 SELECT substr(t.kodp,3,4),
        sum(decode(a.pap,substr(t.kodp,1,1),1,-1) * t.znap*b.zn )/100,
        :nID
 FROM bs1 a, bs2 b, tmp_nbu t
 WHERE a.id=b.id AND b.id=:ID AND a.pap<3 AND
       substr(t.kodp,3,length(b.nbs))=b.nbs AND
       t.datf=:DAT AND t.kodf='01' AND " || sSql1 ||
" GROUP BY substr(t.kodp,3,4)
 UNION ALL
 SELECT substr(t.kodp,3,4),
        sum( decode(substr(t.kodp,1,1),2,1,-1)*t.znap)/100,
        :nID
 FROM bs1 a, bs2 b, tmp_nbu t
 WHERE a.id=b.id AND b.id=:ID AND a.pap=3 AND substr(t.kodp,3,length(b.nbs))=b.nbs AND
     t.datf=:DAT AND t.kodf='01' AND "|| sSql1 ||
" GROUP BY substr(t.kodp,3,4)  "
.head 5 +  Else !! 2 даты
.head 6 -  Set sINS = 
"INSERT INTO tmp_bs (NBS,S,S1,ID)
 SELECT substr(t.kodp,3,4) ,
   sum(decode(t.datf,:DAT, decode(a.pap,substr(t.kodp,1,1),1,-1)*t.znap*b.zn,0))/100,
   sum(decode(t.datf,:DAT1,decode(a.pap,substr(t.kodp,1,1),1,-1)*t.znap*b.zn,0))/100,
   :nID
  FROM bs1 a, bs2 b, tmp_nbu t
  WHERE b.id=:ID AND a.id=b.id AND a.pap<3 AND substr(t.kodp,3,length(b.nbs))=b.nbs AND
      (t.datf=:DAT1 or t.datf=:DAT) AND t.kodf='01' AND " || sSql1 ||
" GROUP BY substr(t.kodp,3,4)
 UNION ALL
 SELECT substr(t.kodp,3,4),
        sum(decode(t.datf,:DAT, decode(substr(t.kodp,1,1),2,1,-1)*t.znap,0))/100,
        sum(decode(t.datf,:DAT1,decode(substr(t.kodp,1,1),2,1,-1)*t.znap,0))/100,
       :nID
 FROM bs1 a, bs2 b, tmp_nbu t
 WHERE b.id=:ID AND a.id=b.id AND a.pap=3 AND  substr(t.kodp,3,length(b.nbs))=b.nbs AND
      (t.datf=:DAT1 or t.datf=:DAT) AND t.kodf='01' AND "|| sSql1 ||
" GROUP BY substr(t.kodp,3,4)"
.head 4 +  Else
.head 5 +  If nPar = 4 !! 1 дата
.head 6 -  Call SalHideWindow(BS1.S1)
.head 6 -  Call SalHideWindow(BS1.PS1)
.head 6 -  Call SalHideWindow(BS1.PR)
.head 6 -  Call SalHideWindow(BS1.R)
.head 6 -  Set sINS=
"INSERT INTO tmp_bs(NBS,S,ID)
 SELECT substr(t.kodp,3,4),
        sum(decode(a.pap,substr(t.kodp,1,1),1,-1) * t.znap*b.zn )/100,
        :nID
 FROM bs1 a, bs2 b, xau t
 WHERE a.id=b.id AND b.id=:ID AND a.pap<3 AND
       substr(t.kodp,3,length(b.nbs))=b.nbs AND
       t.FILE_ID=:idF AND " || sSql1 ||
" GROUP BY substr(t.kodp,3,4)
 UNION ALL
 SELECT substr(t.kodp,3,4),
        sum( decode(substr(t.kodp,1,1),2,1,-1)*t.znap)/100,
        :nID
 FROM bs1 a, bs2 b, xau t
 WHERE a.id=b.id AND b.id=:ID AND a.pap=3 AND substr(t.kodp,3,length(b.nbs))=b.nbs AND
       t.FILE_ID=:idF AND "|| sSql1 ||
" GROUP BY substr(t.kodp,3,4)  "
.head 5 +  Else !! 2 даты
.head 6 -  Set sINS = 
"INSERT INTO tmp_bs (NBS,S,S1,ID)
 SELECT substr(t.kodp,3,4) ,
   sum(decode(t.FILE_ID,:idF, decode(a.pap,substr(t.kodp,1,1),1,-1)*t.znap*b.zn,0))/100,
   sum(decode(t.FILE_ID,:idF1,decode(a.pap,substr(t.kodp,1,1),1,-1)*t.znap*b.zn,0))/100,
   :nID
  FROM bs1 a, bs2 b, xau t
  WHERE b.id=:ID AND a.id=b.id AND a.pap<3 AND substr(t.kodp,3,length(b.nbs))=b.nbs AND
      (t.FILE_ID=:idF or t.FILE_ID=:idF1) AND " || sSql1 ||
" GROUP BY substr(t.kodp,3,4)
 UNION ALL
 SELECT substr(t.kodp,3,4),
        sum(decode(t.FILE_ID,:idF, decode(substr(t.kodp,1,1),2,1,-1)*t.znap,0))/100,
        sum(decode(t.FILE_ID,:idF1,decode(substr(t.kodp,1,1),2,1,-1)*t.znap,0))/100,
       :nID
 FROM bs1 a, bs2 b, xau t
 WHERE b.id=:ID AND a.id=b.id AND a.pap=3 AND  substr(t.kodp,3,length(b.nbs))=b.nbs AND
      (t.FILE_ID=:idF or t.FILE_ID=:idF1) AND "|| sSql1 ||
" GROUP BY substr(t.kodp,3,4)"
.head 4 -  Set BS1.strPrintFileName = 'BS1'
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 4 +  If SqlPrepareAndExecute(hSql(), "DELETE FROM tmp_bs where id=:nID")
.head 5 -  Call SqlPrepareAndExecute(hSql(), "commit")
.head 4 +  If SqlPrepareAndExecute(hSql(), sINS)
.head 5 -  Call SqlPrepareAndExecute(hSql(), "commit")
.head 5 -  Set sSQL=
"SELECT substr(NBS,1,1)||'   ',sum(S),sum(S1) INTO :BS1.NBS,:BS1.S,:BS1.S1
 FROM tmp_bs WHERE id=:nID GROUP BY substr(NBS,1,1)  "  || IifS(nUR<2,"",
"UNION ALL SELECT substr(NBS,1,2)||'  ',sum(S),sum(S1)
 FROM tmp_bs WHERE id=:nID GROUP BY substr(NBS,1,2)  ") || IifS(nUR<3,"",
"UNION ALL SELECT substr(NBS,1,3)||' ',sum(S),sum(S1)
 FROM tmp_bs WHERE id=:nID GROUP BY substr(NBS,1,3)  ") || IifS(nUR<4,"",
"UNION ALL SELECT NBS,S,S1 FROM tmp_bs WHERE id=:nID ") ||
"ORDER BY 1"
.head 5 -  Call SalTblPopulate(hWndForm, hSql(), sSQL,TBL_FillAll)
.head 5 -  Call SalTblSetContext(hWndForm, 0)
.head 4 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set R  = S1-S
.head 4 +  If SS != 0
.head 5 -  Set PS = S*100/SS
.head 4 +  If SS1 != 0
.head 5 -  Set PS1 = S1*100/SS1
.head 4 +  If RA != 0
.head 5 -  Set PR = R*100/RA
.head 4 +  If SqlPrepareAndExecute(hSqlAux2(), 
"SELECT name INTO :NAME FROM ps WHERE nbs=:NBS")
.head 5 -  Call SqlFetchNext(hSqlAux2(),nFetchRes)
.head 4 -  Set KL = Subs(NBS,1,1)
.head 4 -  Set RZ = Subs(NBS,2,1)
.head 4 -  Set GR = Subs(NBS,3,1)
.head 4 -  Set BA = Subs(NBS,4,1)
.head 4 -  ! проверка на 3 знака
.head 4 -  Set Ss = Dig4(S, BS.nDig, BS.nDig)
.head 1 +  Table Window: B2
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Контроль исполнения бюджета-2
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.11"
.head 4 -  Top:    0.342"
.head 4 -  Width:  11.929"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.76"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 5000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.469"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.586"
.head 6 -  Top:    0.104"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call NASELENIE()
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 59631
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.5"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.529"
.head 6 -  Top:    0.104"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.057"
.head 6 -  Top:    0.104"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 59632
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.0"
.head 6 -  Top:    0.104"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 59633
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: DAT1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   5.071"
.head 7 -  Top:    0.125"
.head 7 -  Width:  1.7"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Validate
.head 7 +  If DAT1 > DAT2
.head 8 -  Return VALIDATE_Cancel
.head 7 -  Return VALIDATE_Ok
.head 4 +  Data Field: DAT2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   6.829"
.head 7 -  Top:    0.125"
.head 7 -  Width:  1.7"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Validate
.head 7 -  ! Set sTmp=SalFmtFormatDateTime (DAT1,'dd-MM-yyyy' )
.head 7 -  ! Call SalTblSetColumnTitle( S1, sTmp)
.head 4 -  Background Text: У.Е.
.head 5 -  Resource Id: 43608
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.671"
.head 6 -  Top:    0.135"
.head 6 -  Width:  0.829"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold-Italic
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: Kurs
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.329"
.head 7 -  Top:    0.115"
.head 7 -  Width:  1.171"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Column: KEKB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Символ
бюд.-2
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 6
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.829"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sKEKB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
символа бюджета-2
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.986"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: IDP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
ЦП
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.429"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sIDP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
 ЦП
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nSP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: План
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.414"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nSF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Факт
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.214"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: План -
Факт
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.086"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: %
Плана
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.171"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: NASELENIE
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strTemp
.head 5 -  String: sSQL
.head 5 -  String: sf
.head 4 +  Actions
.head 5 +  If SetQueryFilter(cF)
.head 6 -  Set sf = ""
.head 6 -  Set sf = cF.GetFilterWhereClause(FALSE)
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 7 -  Set strTemp = GetGlobalOption('RNBURBCK')
.head 7 +  If strTemp != ''
.head 8 -  Call SqlPrepareAndExecute(hSql(), 'SET TRANSACTION USE ROLLBACK SEGMENT ' || SalStrUpperX(strTemp))
.head 7 -  !
.head 7 -  If SqlPrepareAndExecute(hSql(),
"SELECT status    INTO :strTemp   FROM all_objects
  WHERE owner='BARS' AND object_name='P_BU2'")
and SqlFetchNext(hSql(), nFetchRes)
and SalStrTrimX(strTemp) = 'INVALID'
and SqlPrepareAndExecute(hSql(), "ALTER  PROCEDURE P_BU2 COMPILE")
.head 7 +  If SqlPLSQLCommand(hSql(), "P_BU2(DAT1,DAT2)")
.head 8 -  Call SalTblPopulate(hWndForm, hSqlAux2(),
"SELECT TMP_BU2.KEKB,TMP_BU2.IDP,
        TMP_BU2.SF,TMP_BU2.SP,
        bu2.name,bu1.name
 INTO :B2.KEKB,:B2.IDP,:B2.nSF,:B2.nSP,:B2.sKEKB,:B2.sIDP
 FROM TMP_BU2, bu1, bu2
 WHERE TMP_BU2.KEKB=bu2.KEKB(+) and TMP_BU2.IDP =bu1.ID  (+) "||
IifS( sf="",""," and "||sf) || " ORDER BY TMP_BU2.IDP,TMP_BU2.KEKB",
TBL_FillAll)
.head 5 -  Call SalWaitCursor(FALSE)
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 2 +  Window Variables
.head 3 -  : cF
.head 4 -  Class: cGenFilter
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalTblSetLockedColumns(hWndForm, 4)
.head 4 -  Call cF.Init('TMP_BU2', 'TMP_BU2')
.head 4 -  Set DAT2 = GetBankDate()
.head 4 -  Set Kurs = 1
.head 4 -  Set B2.strPrintFileName = 'B2'
.head 4 -  Set B2.strFilterTblName = 'TMP_BU2'
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 -  On UM_Populate
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set nSF = SalNumberRound(nSF/Kurs)
.head 4 -  Set nR  = nSP - nSF
.head 4 +  If nSP > 0
.head 5 -  Set nP = nSF * 100 / nSP
.head 1 +  Table Window: KB1
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Cостояние (экв.) бал (1_КБ)
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   2.2"
.head 4 -  Top:    1.833"
.head 4 -  Width:  14.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 1000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.6"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 27797
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.05"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.5"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 27798
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.15"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 27799
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  !
.head 4 +  Data Field: dfDAT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.783"
.head 7 -  Top:    0.107"
.head 7 -  Width:  1.633"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: dd/MM/yyyy
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 8
.head 6 -  Font Enhancement: None
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: 99/99/9999
.head 5 -  Message Actions
.head 4 +  Option Button: pb1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.467"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.467"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Bf1.bmp
.head 5 -  Picture Transparent Color: White
.head 5 -  Button Style: Radio
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set sI = '1'
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, 'Итоги-1 по Классу БС')
.head 4 +  Option Button: pb2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.0"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.467"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Bf2.bmp
.head 5 -  Picture Transparent Color: White
.head 5 -  Button Style: Radio
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set sI = '2'
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, 'Итоги-2 по Разделу БС')
.head 4 +  Option Button: pb3
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.533"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.467"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Bf3.bmp
.head 5 -  Picture Transparent Color: White
.head 5 -  Button Style: Radio
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set sI = '3'
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, 'Итоги-3 по Группе БС')
.head 4 +  Option Button: pb4
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.067"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.467"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Bf4.bmp
.head 5 -  Picture Transparent Color: White
.head 5 -  Button Style: Radio
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set sI = '4'
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, 'Итоги-4 по БС')
.head 4 +  Option Button: pb5
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.617"
.head 6 -  Top:    0.06"
.head 6 -  Width:  0.467"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Bf5_.bmp
.head 5 -  Picture Transparent Color: White
.head 5 -  Button Style: Radio
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set sI = '5'
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, 'Текуший финансовый результат')
.head 2 +  Contents
.head 3 +  Column: sD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вид
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.633"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sPAP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: А
П
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.3"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NBS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Бал
сч
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.65"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: G0
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Разом
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.567"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: G1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Резиденти
НВ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.433"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: G2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Резиденти
ВКВ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.517"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: G3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Резиденти
НКВ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.417"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: G4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Нерезиденти
НВ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.667"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: G5
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Нерезиденти
ВКВ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: G6
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Нерезиденти
НКВ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PAP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: А-П
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sNAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование БС
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.733"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nI
.head 3 -  Date/Time: dDAT
.head 3 -  String: sRezerv
.head 2 +  Window Variables
.head 3 -  String: sDAT
.head 3 -  String: sI
.head 3 -  String: sSql
.head 3 -  String: sTmp
.head 3 -  Number: nTmp
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalTblSetLockedColumns(hWndForm, 4)
.head 4 -  Set sDAT = SalFmtFormatDateTime(dDAT, 'dd-MM-yyyy')
.head 4 -  Call SalSetWindowText(hWndForm, IifS(dDAT = DATETIME_Null, " ТЕКУЩЕЕ", sDAT) || " состояние (экв.) бал (1_КБ)")
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 +  If dDAT = DATETIME_Null
.head 5 -  Set dfDAT = GetBankDate()
.head 4 +  Else
.head 5 -  Set dfDAT = dDAT
.head 4 +  If nI > 0 and nI < 6
.head 5 -  Set sI = Str(nI)
.head 4 +  Else
.head 5 -  Set sI = '4'
.head 5 -  Set pb4 = TRUE
.head 4 -  Set KB1.strPrintFileName = 'KB1'
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 -  On SAM_CreateComplete
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 +  If sI = '5'
.head 5 -  ! баланс по расчетному экв
.head 5 -  Set sSql=
"SELECT '5999', sum(s.ost),0,0,0,0,0 
   INTO :KB1.NBS, :KB1.G1, :KB1.G2, :KB1.G3, :KB1.G4, :KB1.G5, :KB1.G6 
   FROM sal s
  WHERE s.ost<>0 AND s.fdat=:dfDAT AND substr(s.nbs,1,1) in ('6','7') "
.head 5 -  ! баланс по экв из SALDOA
.head 5 +  If SqlPrepareAndExecute(hSqlAux(),
"SELECT val FROM params WHERE par='EQV' and val='YES' ")
and SqlFetchNext( hSqlAux(), nFetchRes )
.head 6 -  Set sSql=
"SELECT '5999', sum(s.ostq),0,0,0,0,0 
   INTO :KB1.NBS, :KB1.G1, :KB1.G2, :KB1.G3, :KB1.G4, :KB1.G5, :KB1.G6 
   FROM salQ s
  WHERE s.ostq<>0 AND s.fdat=:dfDAT AND substr(s.nbs,1,1) in ('6','7')"
.head 4 +  Else
.head 5 -  ! баланс по расчетному экв
.head 5 -  Set sSql=
"SELECT Decode(substr(nbs,1,1),'5',1,PAP) , NBS, 
        sum(decode(rez,1,decode(r031,1, S,0),0)) /100 G1, 
        sum(decode(rez,1,decode(r031,2, S,0),0)) /100 G2, 
        sum(decode(rez,1,decode(r031,3, S,0),0)) /100 G3, 
        sum(decode(rez,0,decode(r031,1, S,0),0)) /100 G4, 
        sum(decode(rez,0,decode(r031,2, S,0),0)) /100 G5, 
        sum(decode(rez,0,decode(r031,3, S,0),0)) /100 G6  
   INTO :KB1.PAP, :KB1.NBS, :KB1.G1, :KB1.G2, :KB1.G3, :KB1.G4, :KB1.G5, :KB1.G6 
   FROM 
 (SELECT a.PAP*b.XAR       PAP, 
         a.REZ             REZ,
         to_number(k.R031) R031, 
         substr(a.NBS,1,"||sI||") NBS, 
         sum(gl.p_icurval(a.KV,a.S,:dfDAT)* b.XAR)  S
    FROM kl_r030 k,
         (select nbs, DECODE(xar,21,-1,decode(xar,12,-1,1)) XAR from ps ) b,
         (select sign(s.ost)         PAP,  s.kv   KV,
                 mod(c.codcagent,2)  REZ,  s.NBS  NBS,  ABS(sum(s.ost))  S
            from sal s, cust_acc cu, customer c 
           where s.acc=cu.acc AND cu.rnk=c.rnk AND s.ost<>0 AND s.fdat=:dfDAT 
           group by sign(s.ost), s.kv, mod(c.codcagent,2), s.nbs ) a
   WHERE a.kv=to_number(k.r030) AND a.nbs=b.nbs 
   GROUP BY a.PAP*b.XAR, a.rez, k.r031, substr(a.NBS,1,"||sI||") 
   UNION ALL 
  SELECT 1, 1, 1, substr('5999',1,"||sI||"), sum(s.ost) 
    FROM sal s
   WHERE s.ost<>0 AND s.fdat=:dfDAT AND substr(s.nbs,1,1) in ('6','7')  ) 
   GROUP BY Decode(substr(nbs,1,1),'5',1,PAP), NBS  
 ORDER BY 1,2 "
.head 5 -  ! баланс по экв из SALDOA
.head 5 +  If SqlPrepareAndExecute(hSqlAux(),
"SELECT val FROM params WHERE par='EQV' and val='YES' ")
and SqlFetchNext(hSqlAux(), nFetchRes)
.head 6 -  Set sSql =
"SELECT Decode(substr(nbs,1,1),'5',1,PAP) , NBS, 
        sum(decode(rez,1,decode(r031,1, S,0),0)) /100 G1, 
        sum(decode(rez,1,decode(r031,2, S,0),0)) /100 G2, 
        sum(decode(rez,1,decode(r031,3, S,0),0)) /100 G3, 
        sum(decode(rez,0,decode(r031,1, S,0),0)) /100 G4, 
        sum(decode(rez,0,decode(r031,2, S,0),0)) /100 G5, 
        sum(decode(rez,0,decode(r031,3, S,0),0)) /100 G6 
   INTO :KB1.PAP, :KB1.NBS, :KB1.G1, :KB1.G2, :KB1.G3, :KB1.G4, :KB1.G5, :KB1.G6 
   FROM 
 (SELECT a.PAP*b.XAR       PAP, 
         a.REZ             REZ,
         to_number(k.R031) R031, 
         substr(a.NBS,1,"||sI||") NBS, 
         sum(a.S * b.XAR)  S
    FROM kl_r030 K,
         (select nbs, DECODE(xar,21,-1,decode(xar,12,-1,1)) XAR from ps ) B,
         (select sign(s.ostq)        PAP,  s.kv   KV,
                 mod(c.codcagent,2)  REZ,  s.NBS  NBS,  ABS(sum(s.ostq))  S 
            from salQ s, cust_acc cu, customer c
           where s.acc=cu.acc AND cu.rnk=c.rnk AND s.ostQ<>0 AND s.fdat=:dfDAT 
           group by sign(s.ostq),  s.kv,  mod(c.codcagent,2), s.nbs ) A
   WHERE a.kv=to_number(k.r030) AND a.nbs=b.nbs 
   GROUP BY a.PAP*b.XAR, a.rez, k.r031, substr(a.NBS,1,"||sI||") 
   UNION ALL 
  SELECT 1, 1, 1, substr('5999',1,"||sI||"), sum(s.ostq) 
    FROM salQ s 
   WHERE s.ostq<>0 AND s.fdat=:dfDAT AND substr(s.nbs,1,1) in ('6','7')  ) 
   GROUP BY Decode(substr(nbs,1,1),'5',1,PAP), NBS  
 ORDER BY 1,2 "
.head 4 -  Call SalTblPopulate(hWndForm, hSql(),sSql, TBL_FillAll)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set sPAP = IifS(PAP>0, 'П', 'А')
.head 4 -  Set G0 = G1 + G2 + G3 + G4 + G5 + G6
.head 4 +  If G0 < 0
.head 5 -  Call XSalTblSetRowBackColor(hWndForm, lParam, COLOR_LightGray)
.head 4 -  Set sTmp = Subs(NBS||'    ',1,4)
.head 4 -  If SqlPrepareAndExecute(hSqlAux2(), 
"SELECT name INTO :sNAME FROM ps WHERE nbs=:sTmp")
and SqlFetchNext(hSqlAux2(), nFetchRes)
.head 4 -  Set nTmp = Val(Subs(NBS,1,1))
.head 4 +  If nTmp < 5 
.head 5 -  Set sD = IifS(PAP >0,'Зоб','Акт')
.head 4 +  Else If nTmp = 5
.head 5 -  Set sD = 'Кап'
.head 4 +  Else If nTmp = 6
.head 5 -  Set sD = 'Дох'
.head 4 +  Else If nTmp = 7
.head 5 -  Set sD = 'Вит'
.head 4 +  Else If nTmp = 9
.head 5 -  Set sD = 'Поз'
.head 4 +  Else
.head 5 -  Set sD = 'Інш'
.head 1 +  Table Window: AN2
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: AN2. Анализ клиентов (для руководтителя)
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.925"
.head 4 -  Top:    1.604"
.head 4 -  Width:  13.583"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 200
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.512"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.767"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 8725
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.25"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.717"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.183"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.65"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 8726
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.117"
.head 6 -  Top:    0.095"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 8727
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: DAT1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.267"
.head 7 -  Top:    0.143"
.head 7 -  Width:  1.717"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Validate
.head 7 -  Call AN2.F_DAT()
.head 4 +  Data Field: DAT2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   2.0"
.head 7 -  Top:    0.143"
.head 7 -  Width:  1.717"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Validate
.head 7 -  Call AN2.F_DAT()
.head 4 +  Option Button: pb_Sort
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.783"
.head 6 -  Top:    0.095"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \bars98\RESOURCE\BMP\Sort.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Button Style: Check
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, ' Сортировать по: Прибыли/Ресурсу')
.head 6 +  On SAM_Click
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 +  If pb_Sort
.head 8 -  Set AN2.strSqlPopulate = AN2.sSql || "su67 desc, ospa desc "
.head 7 +  Else
.head 8 -  Set AN2.strSqlPopulate = AN2.sSql || "ospa desc, su67 desc "
.head 7 -  Call SalTblPopulate(hWndForm, hSql(), AN2.strSqlPopulate, TBL_FillAll)
.head 7 -  Call SalPostMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 7 -  Call SalWaitCursor(FALSE)
.head 2 +  Contents
.head 3 +  Column: RNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рег №
А
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.683"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMK 
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
Б
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OSPA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ресурс
В = 1 - 2
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SU67
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Прибыль
Г = 3 - 4 - 5
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: OSTA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Размешено 
1
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.3"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OSTP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Привлечено  
 2
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SUM6
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Доход
3
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.267"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: SUM7
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Расход
4
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: REZ7
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рез.фонд
5
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: DOSQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дебет
6
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.133"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KOSQ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кредит
7
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.333"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: TRCN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Проводок
8
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: F_DAT
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If AN2.DAT1 > AN2.DAT2
.head 6 -  Call Debug('Дата-1 больше Дата-2 !')
.head 6 -  Set AN2.DAT2 = AddMonths(AN2.DAT1,1)
.head 5 +  Else
.head 6 -  If SqlPrepareAndExecute(hSql(),
"SELECT min(fdat) into :AN2.DAT1 from an2k where fdat >= :AN2.DAT1") 
and SqlFetchNext(hSql(), nFetchRes)
.head 6 -  If SqlPrepareAndExecute(hSql(),
"SELECT max(fdat) into :AN2.DAT2 from an2k where fdat <= :AN2.DAT2") 
and SqlFetchNext(hSql(), nFetchRes)
.head 2 +  Window Parameters
.head 3 -  Number: TIP_KL
.head 3 -  String: Str01
.head 3 -  String: Str02
.head 2 +  Window Variables
.head 3 -  String: sSql
.head 3 -  Number: nRowE
.head 3 -  Window Handle: hWndColE
.head 3 -  Number: nColSortOrder
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set AN2.strPrintFileName = 'AN2'
.head 4 -  Call SalTblSetLockedColumns(hWndForm, 4)
.head 4 -  Set AN2.DAT2 = GetBankDate()
.head 4 -  Set AN2.DAT1 = AddMonths(AN2.DAT2, -1)
.head 4 -  Call AN2.F_DAT()
.head 4 -  !
.head 4 -  Set AN2.sSql =
"SELECT c.rnk, c.nmk, (a.OSTP-a.OSTA)/100 ospa, (b.SUM6-b.SUM7-a.REZ7)/100 su67,
        a.OSTA/100, a.OSTP/100, b.SUM6/100, b.SUM7/100, a.REZ7/100,
        b.DOSQ/100, b.KOSQ/100, b.TRCN 
 INTO :AN2.RNK, :AN2.NMK, :AN2.OSPA, :AN2.SU67, 
      :AN2.OSTA,:AN2.OSTP,:AN2.SUM6, :AN2.SUM7, :AN2.REZ7,
      :AN2.DOSQ, :AN2.KOSQ, :AN2.TRCN 
 FROM customer c, 
      (SELECT rnk, OSTP, OSTA, REZ7 FROM an2k WHERE fdat = :AN2.DAT2 ) a ,
      (SELECT rnk, sum(sum6) SUM6, sum(sum7) SUM7,         
                   sum(dosq) DOSQ, sum(kosq) KOSQ, sum(TRCN) TRCN  
       FROM  an2k WHERE fdat >= :AN2.DAT1 and fdat <= :AN2.DAT2 group by RNK ) b 
 WHERE c.rnk=a.rnk and c.rnk=b.rnk
 ORDER BY "
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_ColumnSelectClick
.head 4 -  Set nColSortOrder = wParam
.head 4 -  Call SalSendClassMessage(SAM_ColumnSelectClick, wParam, 0)
.head 3 -  On UM_Populate
.head 1 -  !
.head 1 +  Table Window: frmKS_PayCalendar	!! Платіжний календар по КР
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Платіжний календар по КР
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  12.067"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 30000
.head 3 -  Discardable? Class Default
.head 2 -  Description: Платіжний календар по КР
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set bRefresh = TRUE
.head 7 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 34555
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 34556
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 34557
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: colAcc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ACC
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 4 -  ! List Values
.head 4 -  ! Message Actions
.head 3 +  Column: colKv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал.
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKvName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва валюти
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNls
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
рахунку
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set sTmpNls = colNls
.head 5 +  On SAM_AnyEdit
.head 6 -  Set colNls = sTmpNls
.head 6 -  Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, FALSE)
.head 3 +  Column: colNms
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Назва рахунку
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOstc_s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Поточний
залишок
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOstPlan_s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Плановий
залишок
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOstIn_s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вхідний
залишок
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOst0_s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
на
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOst1_s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
на
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOst2_s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
на
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOst3_s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
на
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOst4_s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
на
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOst5_s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
на
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOst30_s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
на
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOst365_s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
на
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOst366_s
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
на
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOstc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Поточний
залишок
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOstPlan
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Плановий
залишок
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 4 -  ! List Values
.head 4 -  ! Message Actions
.head 3 +  Column: colOstIn
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вхідний
залишок
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOst0
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
на
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOst1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
+ 1 день
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOst2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
+ 2 дня
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOst3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
+ 3 дня
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOst4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
+ 4 дня
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOst5
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
+ 5 дней
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOst30
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
> 5 дней
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOst365
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
> 30 дней
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colOst366
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остаток
> 1 года
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.8"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDig
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: SetColTitle
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalTblSetColumnTitle(hWndForm.frmKS_PayCalendar.colOst0_s,   'Залишок' || PutCrLf() || 'на сьогодні' || PutCrLf() ||
     SalFmtFormatDateTime(dBankDate, 'dd.MM.yyyy'))
.head 5 -  Call SalTblSetColumnTitle(hWndForm.frmKS_PayCalendar.colOst1_s,   'Залишок' || PutCrLf() || '+ 1 день'    || PutCrLf() ||
     SalFmtFormatDateTime(dBankDate+1, 'dd.MM.yyyy'))
.head 5 -  Call SalTblSetColumnTitle(hWndForm.frmKS_PayCalendar.colOst2_s,   'Залишок' || PutCrLf() || '+ 2 дні'     || PutCrLf() ||
     SalFmtFormatDateTime(dBankDate+2, 'dd.MM.yyyy'))
.head 5 -  Call SalTblSetColumnTitle(hWndForm.frmKS_PayCalendar.colOst3_s,   'Залишок' || PutCrLf() || '+ 3 дні'     || PutCrLf() ||
     SalFmtFormatDateTime(dBankDate+3, 'dd.MM.yyyy'))
.head 5 -  Call SalTblSetColumnTitle(hWndForm.frmKS_PayCalendar.colOst4_s,   'Залишок' || PutCrLf() || '+ 4 дні'     || PutCrLf() ||
     SalFmtFormatDateTime(dBankDate+4, 'dd.MM.yyyy'))
.head 5 -  Call SalTblSetColumnTitle(hWndForm.frmKS_PayCalendar.colOst5_s,   'Залишок' || PutCrLf() || '+ 5 днів'    || PutCrLf() ||
     SalFmtFormatDateTime(dBankDate+5, 'dd.MM.yyyy'))
.head 5 -  Call SalTblSetColumnTitle(hWndForm.frmKS_PayCalendar.colOst30_s,  'Залишок' || PutCrLf() || 'більше 5 днів')
.head 5 -  Call SalTblSetColumnTitle(hWndForm.frmKS_PayCalendar.colOst365_s, 'Залишок' || PutCrLf() || 'більше місяця')
.head 5 -  Call SalTblSetColumnTitle(hWndForm.frmKS_PayCalendar.colOst366_s, 'Залишок' || PutCrLf() || 'більше 1 року')
.head 3 +  Function: SetColText
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hCol
.head 5 -  Number: nS
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nS < 0
.head 6 -  Set nColor = COLOR_Red
.head 5 +  Else If nS > 0
.head 6 -  Set nColor = COLOR_DarkBlue
.head 5 +  Else
.head 6 -  Set nColor = COLOR_Black
.head 5 -  Call SalTblSetColumnText(hWndForm, SalTblQueryColumnID(hCol), Dig4(Abs(nS)/100, colDig, nMaxDig))
.head 5 -  Call SalTblSetCellTextColor(hCol, nColor, FALSE)
.head 2 +  Window Parameters
.head 3 -  Number: nParKv
.head 3 -  String: sPar1
.head 3 -  String: sPar2
.head 2 +  Window Variables
.head 3 -  Boolean: bRefresh
.head 3 -  Date/Time: dBankDate
.head 3 -  Number: nColor
.head 3 -  Number: nDig
.head 3 -  Number: nMaxDig
.head 3 -  String: sTmpNls
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, 'Платіжний календар по КР' || 
     IifS(nParKv>0, ' (валюта ' || Str(nParKv) || ' ' || 
          GetValueStr('select name from tabval where kv='||Str(nParKv)) || ')', ''))
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Set bRefresh = TRUE
.head 4 -  Set dBankDate = GetBankDate()
.head 4 -  Call SetColTitle()
.head 4 -  Set hWndForm.frmKS_PayCalendar.nFlags = GT_ReadOnly
.head 4 -  Set hWndForm.frmKS_PayCalendar.strFilterTblName = 'v_paycalendar_ks'
.head 4 -  Set hWndForm.frmKS_PayCalendar.strPrintFileName = 'ks_payc'
.head 4 +  If nParKv
.head 5 -  Call SalTblSetLockedColumns(hWndForm, 7)
.head 5 -  Call SalHideWindow(colKvName)
.head 5 -  Set hWndForm.frmKS_PayCalendar.strSqlPopulate =
"select v_paycalendar_ks.acc, v_paycalendar_ks.kv, v_paycalendar_ks.nls, v_paycalendar_ks.nms,
        v_paycalendar_ks.ost_in, v_paycalendar_ks.ostc, v_paycalendar_ks.ost_plan,
        v_paycalendar_ks.s0, v_paycalendar_ks.s1, v_paycalendar_ks.s2,
        v_paycalendar_ks.s3, v_paycalendar_ks.s4, v_paycalendar_ks.s5,
        v_paycalendar_ks.s30, v_paycalendar_ks.s365, v_paycalendar_ks.s366, t.dig
   into :hWndForm.frmKS_PayCalendar.colAcc, :hWndForm.frmKS_PayCalendar.colKv,
        :hWndForm.frmKS_PayCalendar.colNls, :hWndForm.frmKS_PayCalendar.colNms,
        :hWndForm.frmKS_PayCalendar.colOstIn, :hWndForm.frmKS_PayCalendar.colOstc, :hWndForm.frmKS_PayCalendar.colOstPlan,
        :hWndForm.frmKS_PayCalendar.colOst0,:hWndForm.frmKS_PayCalendar.colOst1, :hWndForm.frmKS_PayCalendar.colOst2,
        :hWndForm.frmKS_PayCalendar.colOst3,:hWndForm.frmKS_PayCalendar.colOst4, :hWndForm.frmKS_PayCalendar.colOst5,
        :hWndForm.frmKS_PayCalendar.colOst30, :hWndForm.frmKS_PayCalendar.colOst365, :hWndForm.frmKS_PayCalendar.colOst366,
        :hWndForm.frmKS_PayCalendar.colDig
   from v_paycalendar_ks, tabval t
  where v_paycalendar_ks.kv = t.kv
    and v_paycalendar_ks.kv = :hWndForm.frmKS_PayCalendar.nParKv
    and (       v_paycalendar_ks.nls is not null
         or     v_paycalendar_ks.nls is null 
            and (   v_paycalendar_ks.s0 <> 0
                 or v_paycalendar_ks.s1 <> 0
                 or v_paycalendar_ks.s2 <> 0
                 or v_paycalendar_ks.s3 <> 0
                 or v_paycalendar_ks.s4 <> 0
                 or v_paycalendar_ks.s5 <> 0
                 or v_paycalendar_ks.s30 <> 0
                 or v_paycalendar_ks.s365 <> 0
                 or v_paycalendar_ks.s366 <> 0 ))
  order by v_paycalendar_ks.nls"
.head 4 +  Else
.head 5 -  Call SalTblSetLockedColumns(hWndForm, 3)
.head 5 -  Call SalHideWindow(colNls)
.head 5 -  Call SalHideWindow(colNms)
.head 5 -  Call SalHideWindow(colOstc_s)
.head 5 -  Call SalHideWindow(colOstPlan_s)
.head 5 -  Call SalHideWindow(colOstIn_s)
.head 5 -  Set hWndForm.frmKS_PayCalendar.strSqlPopulate =
"select v_paycalendar_ks.kv, t.name,
        sum(v_paycalendar_ks.ost_in), sum(v_paycalendar_ks.ostc), sum(v_paycalendar_ks.ost_plan),
        sum(v_paycalendar_ks.s0), sum(v_paycalendar_ks.s1), sum(v_paycalendar_ks.s2),
        sum(v_paycalendar_ks.s3), sum(v_paycalendar_ks.s4), sum(v_paycalendar_ks.s5),
        sum(v_paycalendar_ks.s30), sum(v_paycalendar_ks.s365), sum(v_paycalendar_ks.s366), t.dig
   into :hWndForm.frmKS_PayCalendar.colKv, :hWndForm.frmKS_PayCalendar.colKvName,
        :hWndForm.frmKS_PayCalendar.colOstIn, :hWndForm.frmKS_PayCalendar.colOstc, :hWndForm.frmKS_PayCalendar.colOstPlan,
        :hWndForm.frmKS_PayCalendar.colOst0,:hWndForm.frmKS_PayCalendar.colOst1, :hWndForm.frmKS_PayCalendar.colOst2,
        :hWndForm.frmKS_PayCalendar.colOst3,:hWndForm.frmKS_PayCalendar.colOst4, :hWndForm.frmKS_PayCalendar.colOst5,
        :hWndForm.frmKS_PayCalendar.colOst30, :hWndForm.frmKS_PayCalendar.colOst365, :hWndForm.frmKS_PayCalendar.colOst366,
        :hWndForm.frmKS_PayCalendar.colDig
   from v_paycalendar_ks, tabval t
  where v_paycalendar_ks.kv = t.kv
  group by v_paycalendar_ks.kv, t.name, t.dig
  order by v_paycalendar_ks.kv"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 +  If DigInit() != -1
.head 5 -  Set nMaxDig = DigInit()
.head 3 +  On UM_Populate
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 +  If bRefresh
.head 5 +  If SqlPLSQLCommand(hSql(), "ani(2,dBankDate,dBankDate )")
.head 6 -  Call SqlCommit(hSql())
.head 5 +  Else
.head 6 -  Call SqlRollback(hSql())
.head 4 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 4 +  If nParKv
.head 5 -  Call VisTblAutoSizeColumn(hWndForm, colKv)
.head 5 -  Call VisTblAutoSizeColumn(hWndForm, colKvName)
.head 5 -  Call VisTblAutoSizeColumn(hWndForm, colNls)
.head 5 -  Call VisTblAutoSizeColumn(hWndForm, colNms)
.head 4 +  Else
.head 5 -  Call VisTblAutoSizeColumn(hWndForm, colKv)
.head 5 -  Call VisTblAutoSizeColumn(hWndForm, colKvName)
.head 3 +  On SAM_FetchRowDone
.head 4 -  Call SetColText(colOstc_s, colOstc)
.head 4 -  Call SetColText(colOstPlan_s, colOstPlan)
.head 4 -  Call SetColText(colOstIn_s, colOstIn)
.head 4 -  Call SetColText(colOst0_s, colOst0)
.head 4 -  Call SetColText(colOst1_s, colOst1)
.head 4 -  Call SetColText(colOst2_s, colOst2)
.head 4 -  Call SetColText(colOst3_s, colOst3)
.head 4 -  Call SetColText(colOst4_s, colOst4)
.head 4 -  Call SetColText(colOst5_s, colOst5)
.head 4 -  Call SetColText(colOst30_s, colOst30)
.head 4 -  Call SetColText(colOst365_s, colOst365)
.head 4 -  Call SetColText(colOst366_s, colOst366)
.head 3 +  On SAM_DoubleClick
.head 4 +  If nParKv
.head 5 -  Call FunNSIEditFFiltered('V_PAYCALENDAR_KS_DETAILS', 1,
     IifS(colAcc!=NUMBER_Null, 'acc=' || Str(colAcc), 'nls is null and kv=' || Str(colKv)))
.head 4 +  Else
.head 5 -  Call Sel00V(hWndMDI, 4, colKv, '', '')
.head 1 +  ! cGenericTable: VAD
.winattr class Table Window:
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:  
.head 4 -  Top:   
.head 4 -  Width:  10.914"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.781"
.head 4 -  Height Editable? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  View: Table
.head 3 -  Allow Row Sizing? No
.head 3 -  Lines Per Row: Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Default
.head 3 -  Discardable? No
.end
.head 2 -                                         Description: 
.head 2 -                                         Named Menus 
.head 2 -                                         Menu 
.head 2 +                                         Tool Bar 
.head 3 +                                         Contents 
.head 4 +                                         Pushbutton: pbIns
.head 5 -                                         Message Actions 
.head 4 +                                         Pushbutton: pbDel
.head 5 -                                         Message Actions 
.head 4 +                                         Pushbutton: pbRefresh
.head 5 -                                         Message Actions 
.head 4 +                                         Pushbutton: pbUpdate
.head 5 -                                         Message Actions 
.head 4 -                                         Line 
.head 4 +                                         Pushbutton: pbSearch
.head 5 -                                         Message Actions 
.head 4 +                                         Pushbutton: pbFilter
.head 5 -                                         Message Actions 
.head 4 +                                         Pushbutton: pbDetails
.head 5 -                                         Message Actions 
.head 4 +                                         Pushbutton: pbPrint
.head 5 -                                         Message Actions 
.head 4 -                                         Line 
.head 4 +                                         Pushbutton: pbExit
.head 5 -                                         Message Actions 
.head 4 -                                         Line 
.head 2 +                                         Contents 
.head 3 +                                         Column: KV1
.head 4 -                                         List Values 
.head 4 -                                         Message Actions 
.head 3 +                                         Column: LCV1
.head 4 -                                         List Values 
.head 4 -                                         Message Actions 
.head 3 +                                         Column: KV2
.head 4 -                                         List Values 
.head 4 -                                         Message Actions 
.head 3 +                                         Column: LCV2
.head 4 -                                         List Values 
.head 4 -                                         Message Actions 
.head 3 -  !
.head 3 +                                         Column: KOEF_R
.head 4 -                                         List Values 
.head 4 -                                         Message Actions 
.head 3 +                                         Column: KOEF_V
.head 4 -                                         List Values 
.head 4 -                                         Message Actions 
.head 3 +                                         Column: VOL1
.head 4 -                                         List Values 
.head 4 -                                         Message Actions 
.head 3 +                                         Column: VOL2
.head 4 -                                         List Values 
.head 4 -                                         Message Actions 
.head 3 +                                         Column: RATE1
.head 4 -                                         List Values 
.head 4 -                                         Message Actions 
.head 3 +                                         Column: RATE2
.head 4 -                                         List Values 
.head 4 -                                         Message Actions 
.head 3 +                                         Column: CROS1
.head 4 -                                         List Values 
.head 4 -                                         Message Actions 
.head 3 +                                         Column: CROS2
.head 4 -                                         List Values 
.head 4 -                                         Message Actions 
.head 2 -                                         Functions 
.head 2 +                                         Window Parameters 
.head 3 -                                         Number: nMode
.head 3 -                                         Number: nPar
.head 3 -                                         String: strPar01
.head 3 -                                         String: strPar02
.head 3 -                                         Date/Time: pDat
.head 2 -                                         Window Variables 
.head 2 +                                         Message Actions 
.head 3 +                                         On SAM_Create
.head 4 -                                         Call PrepareWindow( hWndForm )
.head 4 -                                         Call SetWindowFullSize(hWndForm)
.head 4 -                                         Call SalTblSetLockedColumns(hWndForm, 4)
.head 4 -                                         Set hWndForm.VAD.dDat = hWndForm.VAD.pDat
.head 4 -                                         Set hWndForm.VAD.strPrintFileName = 'VAD_'||Str(hWndForm.VAR.nPar)
.head 4 -                                         Set hWndForm.VAD.strSqlPopulate =
"SELECT r.KV1, T1.lcv LCV1, r.KV2, T2.lcv LCV2, r.koef KOEF_R , v.koef KOEF_V    
 INTO :hWndForm.VAD.KV1,   :hWndForm.VAD.LCV1,
      :hWndForm.VAD.KV2,   :hWndForm.VAD.LCV2,
      :hWndForm.VAD.KOEF_R,:hWndForm.VAD.KOEF_V 
 FROM TMP_KOREL r, TMP_KOVAR v, TABVAL T1, TABVAL T2  
 WHERE r.kv1=T1.kv AND r.kv2=T2.kv 
   AND r.kv1>=r.kv2 AND v.kv1=r.kv1 AND v.kv2=r.kv2  
 ORDER BY 1, 2   "
.head 4 -  ! Set hWndForm.VAD.strSqlPopulate =
"SELECT r.KV1, T1.lcv LCV1, r.KV2, T2.lcv LCV2, r.koef KOEF_R , v.koef KOEF_V , 
   (select vol from TMP_VAR where kv=r.KV1 and rownum=1 ) VOL1, 
   (select vol from TMP_VAR where kv=r.KV2 and rownum=1 ) VOL2 
 INTO :hWndForm.VAD.KV1,   :hWndForm.VAD.LCV1,
      :hWndForm.VAD.KV2,   :hWndForm.VAD.LCV2,
      :hWndForm.VAD.KOEF_R,:hWndForm.VAD.KOEF_V, 
      :hWndForm.VAD.VOL1,  :hWndForm.VAD.VOL2 
 FROM TMP_KOREL r, TMP_KOVAR v, TABVAL T1, TABVAL T2  
 WHERE r.kv1=T1.kv AND r.kv2=T2.kv 
   AND r.kv1>=r.kv2 AND v.kv1=r.kv1 AND v.kv2=r.kv2  
 ORDER BY 1, 2   "
.head 4 -                                         Call SalSendClassMessage(SAM_Create, 0, 0)
