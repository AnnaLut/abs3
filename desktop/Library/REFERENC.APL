.head 0 +  Application Description: ! REFERENC.APL - Справочники АБС 'Барс-98'
! /////////////////////////////////////////
! ООО Унити-Барс  ( C )  1996-1999
! Разработчик: Сыропоршнев Д.Л.
! /////////////////////////////////////////
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000DC0000 002C000000020000 0003000000FFFFFF FFFFFFFFFFFCFFFF
0040: FFE2FFFFFF000000 0000000000F40300 005D020000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F77730F646C
0080: 675F4F7065724578 704F707473
.enddata
.data DT_MAKERUNDLG
0000: 0200000000001E71 3A5C626172733938 5C6C696272617279 5C524547434C4E45
0020: 582E646C6C1E713A 5C6261727339385C 6C6962726172795C 524547434C4E4558
0040: 2E61706300000101 011E713A5C626172 7339385C6C696272 6172795C52454743
0060: 4C4E45582E72756E 1E713A5C62617273 39385C6C69627261 72795C524547434C
0080: 4E45582E646C6C1E 713A5C6261727339 385C6C6962726172 795C524547434C4E
00A0: 45582E6170630000 010101185C424152 5339385C42494E5C 7265666572656E63
00C0: 2E617064185C4241 525339385C42494E 5C7265666572656E 632E646C6C185C42
00E0: 41525339385C4249 4E5C726566657265 6E632E6170630000 010101001E713A5C
0100: 6261727339385C6C 6962726172795C52 4547434C4E45582E 646C6C1E713A5C62
0120: 61727339385C6C69 62726172795C5245 47434C4E45582E61 70630000010101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0418B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  Dynalib: Absapi.apd
.head 2 -  Dynalib: Global.apd
.head 2 -  Dynalib: Message.apd
.head 2 -  Dynalib: Anketa.apd
.head 2 -  Dynalib: bankapi.apd
.head 2 -  Dynalib: CustAcnt.apd
.head 2 -  Dynalib: Dfltrapi.apd
.head 2 -  Dynalib: Docview.apd
.head 2 -  Dynalib: HOLIDAY.APD
.head 2 -  Dynalib: Nsiapi.apd
.head 2 -  Dynalib: OTCN.apd
.head 2 -  Dynalib: Service.apd
.head 2 -  ! для Аваль командные строки вызова для справочников
.head 2 -  Dynalib: BARS035.apd
.head 2 -  !
.head 2 -  File Include: xsalspl.apl
.head 2 -  File Include: qcktabs.apl
.head 2 -  File Include: Constant.apl
.head 2 -  File Include: Genbutn.apl
.head 2 -  File Include: Genlist.apl
.head 2 -  File Include: Vtlbx.apl
.head 2 -  File Include: Genfcls.apl
.head 2 -  File Include: Winapi.apl
.head 2 -  File Include: Gentbl.apl
.head 2 -  File Include: GENTBLD.APL
.head 2 -  File Include: GENTBLF.APL
.head 2 -  File Include: GENTBLS.APL
.head 2 -  File Include: Vtsplit.apl
.head 2 -  File Include: vttblwin.apl
.head 2 -  File Include: VTFILE.APL
.head 2 -  File Include: Winbars2.apl
.head 2 -  File Include: XSALIMG.APL
.head 2 -  !
.head 2 -  File Include: SQLNSI.APL
.head 2 -  File Include: xsalcpt_32.apl
.head 2 -  Dynalib: impexp.apd
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Window Color
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: System Window Color
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 +  External Functions
.head 3 +  ! Library name: ei.dll
.head 4 +      Function: ExportTts
.head 5 -      Description: Экспорт настройки операций в файлы *.dbf
.head 5 -      Export Ordinal: 0
.head 5 +      Returns 
.head 6 -      Number: INT
.head 5 +      Parameters 
.head 6 -      String: LPSTR
.head 6 -      String: LPSTR
.head 6 -      Number: INT
.head 4 +      Function: ImportTts
.head 5 -      Description: Экспорт настройки операций в файлы *.dbf
.head 5 -      Export Ordinal: 0
.head 5 +      Returns 
.head 6 -      Number: INT
.head 5 +      Parameters 
.head 6 -      String: LPSTR
.head 6 -      String: LPSTR
.head 6 -      Number: INT
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 4 -  Number: UM_DoPopulate = SAM_User + 150
.head 4 -  Number: UM_DoSaveChanges = SAM_User + 151
.head 3 +  User
.head 4 -  ! режим редактирования кат. отчетов
.head 4 -  Number: EDIT_MODE_BANK = 0    ! редактирование в банке
.head 4 -  Number: EDIT_MODE_BARS = 3    ! редактирование на БАРС-е
.head 4 -  Number: EDIT_MODE_USER = 2    ! текущий пользователь
.head 4 -  !
.head 4 -  !
.head 4 -  ! работа с VSS
.head 4 -  Number: VSS_ADD = 1
.head 4 -  Number: VSS_CHECKOUT = 2
.head 4 -  Number: VSS_CHECKIN = 3 
.head 4 -  Number: VSS_CHECK_STATUS = 4 
.head 4 -  Number: VSS_SHOW_USERCHECKED= 5 
.head 4 -  !
.head 4 -  Number: VSS_STATUS_UNKNOWN= 0
.head 4 -  Number: VSS_STATUS_NOT_FOUND= 1
.head 4 -  Number: VSS_STATUS_CHECKED= 2 
.head 4 -  Number: VSS_STATUS_FREE= 3 
.head 4 -  Number: VSS_STATUS_CHECKED_BY_USER= 4 
.head 4 -  !
.head 2 +  Resources
.head 3 +  Icon: ICO_BookC
.head 4 -  File Name: \BARS98\RESOURCE\ICO\BOOKC.ICO
.head 3 +  Icon: ICO_BookO
.head 4 -  File Name: \BARS98\RESOURCE\ICO\BOOKO.ICO
.head 3 +  Icon: ICO_ItemRO
.head 4 -  File Name: \BARS98\RESOURCE\ICO\REFRO.ICO
.head 3 +  Icon: ICO_ItemRW
.head 4 -  File Name: \BARS98\RESOURCE\ICO\REFRW.ICO
.head 3 +  Bitmap: bmpDebet
.head 4 -  File Name: \BARS98\RESOURCE\BMP\bmDebet.bmp
.head 3 +  Bitmap: bmpKredit
.head 4 -  File Name: \BARS98\RESOURCE\BMP\bmKredit.bmp
.head 3 +  Bitmap: bmpNegative
.head 4 -  File Name: \BARS98\RESOURCE\BMP\bmNegative.bmp
.head 3 +  Bitmap: bmpPositive
.head 4 -  File Name: \BARS98\RESOURCE\BMP\bmPositive.bmp
.head 2 +  Variables
.data RESOURCE 0 0 1 86665683
0000: 9600000047000000 0000000000000000 020000050000006D 0100008002040000
0020: 000100FE00C18001 0000003F71018200 010D000000FFFFE8 7E010001FE00FFA3
0040: 8B010002A3000100 007F80F20100008F 8F0100EC010D00FF 3F
.enddata
.head 3 -  ! // REFERENC.APL - Переменные ////////////////////////////////////////////////////////////////////////////////
.head 3 -  Boolean: bOB22
.head 3 -  Boolean: fInitLib
.head 3 -  Window Handle: hsplVal
.head 3 -  Window Handle: hWndBanks
.head 3 -  Window Handle: hTPar
.head 3 -  Window Handle: hTTS
.head 3 -  Window Handle: hWndFastReportEditor
.head 3 -  Number: nFetchRes
.head 3 -  Number: nNewRow
.head 3 -  Number: nRow
.head 3 -  Number: nTmp
.head 3 -  !
.head 3 -  String: strCodeAppTemp
.head 3 -  !
.head 3 -  Boolean: bTtsapMode
.head 3 -  String: strLinkTt
.head 3 -  Number: nCountLink
.head 3 -  Number: nErr
.head 3 -  !
.head 3 -  ! // "Временные" переменные
.head 3 -  Boolean: bSetFlag
.head 3 -  Number: nFlags[64]
.head 3 -  String: strFlags
.head 3 -  !
.head 3 -  ! Флаг вызова формы frm_OperList
.head 3 -  Boolean: fOlCalled
.head 3 -  ! Флаг вызова формы frm_QueryEditor
.head 3 -  Boolean: fEditorStarted
.head 3 -  ! ! Флаг вызова формы frm_DBFSyncEdit
.head 3 -  Boolean: fDbfSync
.head 3 -  ! ! Sync Wizard
.head 3 -  Number: nSWTabId
.head 3 -  String: sSWTabname
.head 3 -  String: sSWTabnameInt
.head 3 -  String: sSWTabnameDBF
.head 3 -  String: sPK[100]
.head 3 -  String: sDbFileds[100]
.head 3 -  String: sFlFields[100]
.head 3 -  String: sCompare[100]
.head 3 -  String: sSELECT_
.head 3 -  String: sINSERT_
.head 3 -  String: sUPDATE_
.head 3 -  String: sDELETE_
.head 3 -  String: pNBS
.head 3 -  ! ! Координаты и размер окна
.head 3 -  Number: nWinX
.head 3 -  Number: nWinY
.head 3 -  Number: nWinW
.head 3 -  Number: nWinH
.head 2 +  Internal Functions
.head 3 -  ! // REFERENC.APL - Функции ////////////////////////////////
.head 3 +  Function: IniReferenc
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strPathToLangResources
.head 5 -  String: strLangId
.head 5 -  !
.head 5 -  String: strFileName
.head 4 +  Actions
.head 5 +  If NOT fInitLib
.head 6 -  Set bOB22 = GetGlobalOption('OB22') = '1'
.head 6 -  Set strPathToLangResources = GetLangPath()
.head 6 -  Set strLangId = GetLang()
.head 6 -  Set strFileName = strPathToLangResources || "\\" || strLangId || "\\referenc.lng"
.head 6 -  !
.head 6 +  If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
.head 7 -  Call CurrentLangTable.Init()
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('cTAt', 'Внимание!')
.head 7 -  Call CurrentLangTable.AddAtom('cTErr','Ошибка!')
.head 7 -  Call CurrentLangTable.AddAtom('cTInfo','Информация')
.head 7 -  ! ====================================================
.head 7 -  ! splVal
.head 7 -  Call CurrentLangTable.AddAtom('splVal.cTWndTitle','Валютні позиції та еквіваленти')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('splVal.cBTipUp','Переместить вверх')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.cBTipDown','Переместить вниз')
.head 7 -  ! Columns
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl.colLcv','Код~ISO')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl.colNam','Назва~валюти')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl.colUnits','Назва~коп')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl.colKv','Код~числ')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl.colGender','Род~M / F')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl.colBas','Базова~сума')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl.colDig','Коп')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl.colCntry','Код~країни')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl.colGrp','№~групи')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl.colBasey','Код~% базы')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl.colBaseyName','Наимен.~% базы')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl.colSortOrd','Порядок~сортування')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl.colS0000','Рах техн~переоцінки~бал (АП)')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl.colS3800','Рах техн~переоцінки~бал (АКТ)')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl.colS3801','Рах техн~переоцінки~бал (ПАС)')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl.colS0009','Рах техн~переоцінки~позабал(АП)')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl2.colKv','Числ~код')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl2.colBranch','Отделение')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl2.colS3800','Валютна~позиція')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl2.colS3801','Еквівалент~Вал.Поз.')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl2.colS6204','Нереалізована~курсова різниця')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl2.colS_RRD','НКР~(дооцінка операцій~до оф.курсу) (+)')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl2.colS_RRR','НКР~(дооцінка операцій~до оф.курсу) (-)')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl2.colS_RRS','Реалізована~курсова різниця')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.tbl2.colComm','Коментар')
.head 7 -  ! Msg
.head 7 -  Call CurrentLangTable.AddAtom('splVal.cTMsgAccNotOpen','Не открыт счет')
.head 7 -  ! Err
.head 7 -  Call CurrentLangTable.AddAtom('splVal.cTErrRKR','Невірно заповнено:~Рахунки курсових різниць для розрахунку реалізованого результату')
.head 7 -  Call CurrentLangTable.AddAtom('splVal.cTErrVP','Не заповнено:~Валютна позиція, Еквівалент Валютної позиції чи Нереалізованоа курсова різниця')
.head 7 -  ! ====================================================
.head 7 -  ! frm_QueryEditor
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTWndTitle','Редактирование каталогизированных запросов')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cBTipDetails','Выполнить запрос')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cBTipShowSQL','Показать/Спрятать тело SQL')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cBTipShowBinds','Показать/Спрятать Binds-переменные')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cBTipShowParams','Показать/Спрятать Умолч.значения Binds-переменных')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cBTipShowCreate','Показать/Спрятать выражение для DBF')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cBTipShowCreator','Показать/Спрятать автора запроса')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cBTipCopy','Копировать запрос в буфер')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cBTipPaste','Вставить/Заменить запрос(из буфера)')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cBTipEditTemplate','Редактирование шаблона отчета')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cBTipExportQuery','Экспорт каталогизированного запроса')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cBTipEditReport','Добавить в <<Печатные отчеты>>')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cBTipImportXSL','Импорт XSL-выражения для отчета')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cBTipImportXSD','Импорт XSD-файла для отчета')
.head 7 -  ! Columns
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.colKODZ','Код')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.colID','Код~Пользователя')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.colNAME','Наименование запроса')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.colNAMEF','Имя файла для~экспорта запроса')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.colRPT_TEMPLATE','Имя файла шаблона~отчета')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.colUSER_NAME','Пользователи имеющие~доступ к запросу')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.colTXT','Текст SQL~выражения')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.colBINDVARS','Bind~переменные')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.colDEFAULT_VARS','Умолч.значения~переменных')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.colCREATE_STMT','Выражение на создание~dbf файла')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.colFORM_PROC','Процедура~формирования')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.colKODR','Связанный~запрос')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.colCREATOR','Автор запроса')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.colCREATOR_ID','Автор запроса')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.colBIND_SQL','SQL описание~переменной')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.colBranch','Подразделение')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.colPKey','Уникальный~ключ запроса')
.head 7 -  ! Msg
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTMsgSelectMain','Для экспрота нужно выбрать главный запрос')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTMsgNotFound','Невозможно найти описание связанного запроса')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTMsgImpXSL','Вы действительно хотите выполнить ~импорт XSL-выражения из файла')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTMsgImpXSD','Вы действительно хотите выполнить ~импорт XSD-файла')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTMsgForRep','для отчета №')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTMsgImpOk','Импорт выполнен успешно!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTMsgImpErr','Ошибка импорта!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTMsgNotSelect','Ни один запрос не выбран!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTMsgNoPkey','Не задан первичный ключ!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTMsgNoPkeyPar','Отсутсвует параметр ZPRS_PK-код банка для кат. запросов')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTMsgBrsEdit','Вы редактируете эталонный отчет БАРС-а, на его основе будет создан новый отчет с вашими модификациями')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTMsgMultSel','Для копирования нужно выбрать только один отчет')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTMsgSelRef','Выбран связанный запрос')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTMsgAppFailed','Невозможно выполнить сценарий \bin\vsswork.bat')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTMsgFileOpFld','Невозможно открыть файл \bin\$vssadd.log')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTMsgVSSFileExists','Данный запрос уже существует в эталоне')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTMsgVSSFileChecked','Данный запрос уже существует в эталоне')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTMsgVSSFileAded','Запрос успешно добавлен в VSS')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTMsgVSSFileCheckout','Запрос успешно заблокирован в VSS')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTMsgVSSFileCheckin','Запрос успешно разблокирован в VSS')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTMsgVSSFileNotYour','Запрос небыл вами заблокирован в VSS')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTMsgNoExecRight','У вас нету прав на выполнение данного запроса')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTMsgUsrZaprErr','Ошибка вычитки прав на данный запрос')
.head 7 -  ! Constant 
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTTitleTXT','Редактирование текста запроса')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTTitleBINDVARS','Редактирование списка Bind-переменных')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTTitleDEFAULT_VARS','Редактирование умолчательных значений переменных')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTTitleCREATE_STMT','Редактирование выражения создания dbf файла')
.head 7 -  Call CurrentLangTable.AddAtom('frm_QueryEditor.cTTitleBIND_SQL','Редактирование текста запроса переменных')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_MemoEditor
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MemoEditor.cTSave','Сохранить изменения?')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_MemoEditor.cTEdit','Редактирование')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_AddReport
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.cTWndTitle','Добавление кат. отчета')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.pbOk','Ок')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.pbCancel','Отменить')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.rbPeriod','За период')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.rbNoDate','Без дат')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.rbByDay','За день')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.cbShowWnd','Воспроизводить окно ввода параметров')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.cbFileName','Испоьзовать заданное имя файла отчета')
.head 7 -  ! bg
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.bgName','Наименование отчета')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.bgKod','Номер отчета')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.bgMask','Маска файла отчета')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.bgRep','Отчет')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.bgDefParams','Умолчательные параметры ')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.bgRepType','Формат исходящего файла отчета')
.head 7 -  ! Msg
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.cTMsgRepCreate','Отчет успешно создан')
.head 7 -  ! Err
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.cTErrRepKod','Невозможно вычислить свободный номер для отчета')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.cTErrFileName','Неправильно задано имя файла')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.cTErrRepRow','Невозможно создать запись для отчета')
.head 7 -  ! Constant
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.cTRepType1','DBF-DOS формат(пересоздание файла)' )
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.cTRepType2','DBF-WIN формат(пересоздание файла)' )
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.cTRepType3','Текстовый отчет по шаблону QRP' )
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.cTRepType4','DBF-DOS формат(дополнение файла)' )
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.cTRepType5','DBF-WIN формат(дополнение файла)' )
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.cTRepType6','RTF формат по шаблону QRP' )
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.cTRepType7','Форматированный с разделителями' )
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.cTRepType11','DBF-DOS без исп.Dbase Centura Dr.' )
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.cTRepType12','DBF-WIN без исп.Dbase Centura Dr.' )
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AddReport.cTRepType13','DBF-UKG без исп.Dbase Centura Dr.' )
.head 7 -  ! ====================================================
.head 7 -  ! dlg_ExpQuery 
.head 7 -  ! {dlg_AddReport.cTRepType13} {dlg_AddReport.cTRepType13} {DBF-UKG без исп.Dbase Centura Dr.} {DBF-UKG без вик.Dbase Centura Dr.}
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ExpQuery.cTWndTitle','Параметры экспорта кат. запроса')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ExpQuery.cbIsReportInset','Создать запись в табл. отчетов')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ExpQuery.rbDynRepNumber','динамический № отчета')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ExpQuery.rbFixRepNumber','фиксированный № отчета')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ExpQuery.pbOk','Ok')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ExpQuery.pbCancel','Отменить')
.head 7 -  ! Bg
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ExpQuery.bgExpFileName','Имя файла експорта')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ExpQuery.bgExpTemplateName','Имя файла шаблона для експорта')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_ExpQueryEx
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ExpQueryEx.cTWndTitle','Параметры экспорта кат. запроса')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ExpQueryEx.pbOk','Ok')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ExpQueryEx.pbCancel','Отменить')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ExpQueryEx.cbExportReports','Создать запись в табл. отчетов')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ExpQueryEx.rbDynRepId','динамический № отчета')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ExpQueryEx.rbFixRepId','фиксированный № отчета')
.head 7 -  ! bg
.head 7 -  Call CurrentLangTable.AddAtom('dlg_ExpQueryEx.bgExpPath','Путь для сценариев отчетов')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_Users
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Users.cTWndTitle','Выберите пользователя')
.head 7 -  ! Columns
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Users.tbl.colID','Код')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Users.tbl.colFIO','Ф.И.О. Пользователя')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_OperCard
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTWndTitle','Свойства операции')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cbMulti','Мультивалютная транзакция')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cbComplex','Сложная транзакция')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTabsTts','Операции')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTabs0','Карточка')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTabs1','Флаги и реквизиты')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTabs2','Связанные операции')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTabs3','Балансовые счета')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTabs4','Виды документов')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTabs5','Группы контроля')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTabs6','Информация')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTabs7','Папки')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cBTipPrintOper','Распечатать описание операции')
.head 7 -  ! Bg
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.bgOperType','Тип банковской транзакции')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.bgDK','Вид банковской транзакции')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.bgAccA','Счет А /для ОПЛАТЫ')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.bgAccB','Счет Б/для ОПЛАТЫ')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.bgKvA','Вал. А')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.bgKvB','Вал. Б')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.bgBankA','Сч банка А /для ВВОДА')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.bgBankB','Сч банка Б /для ВВОДА')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.bgMfoB','МФО банка Б')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.bgAccVP','Счет валют. позиции')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.bgAccInc','Счет маржин.доходов')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.bgAccExp','Счет маржин.расходов')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.bgSum','Формула суммы-А документа')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.bgSum2','Формула суммы-Б документа ')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.bgSKP','Символ кассплана')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.bgPriority','Привилегированность транзакции')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.bgNAZN','Умолчательное назначение платежа')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.bgOtmDK','*Отметка в поле Д/К соответствует Кредиту')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.bgF4','F4 или двойной щелчек правой кнопкой на строке - редактирование уловия визы')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.bgDelIns','Del или двойной щелчек на заголовке строки - пометка на удаление; Ins или двойной щелчек в области таблицы - добавление в список')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.bgF4Ob22','F4 на поле OB22 - выбрать OB22')
.head 7 -  ! Columns
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblOpFlags.colN',    'Код')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblOpFlags.colName', 'Имя флага')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblOpFlags.colValue','Значение~флага')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblOpRules.colTag', 'Код')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblOpRules.colName','Имя реквизита')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblOpRules.colOpt', 'Обязательность~реквизита')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblOpRules.colUse4In','Использовать~для ввода')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblOpRules.colOrd','Номер реквизита~(для сортировки)')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblOpRules.colVal','Значение по~умолчанию')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblRelOpers.colTT','Код~операции')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblRelOpers.colName','Имя связанной операции')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblRelOpers.colDC','Инверсия~Д/К')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblBalAcc.colAccBNum','Номер счета')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblBalAcc.colAccBName','Имя балансового счета')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblBalAcc.colDC','Д/К')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblVOB.colVOB',  'Код')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblVOB.colDName','Виды банковских документов')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblVOB.colTemplate','Файл шаблона')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblVOB.colORD','Порядок сорт')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblGrps.colId',   'Код')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblGrps.colGName','Группы контроля')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblGrps.colPriority','Приоритеты')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblGrps.colCharged','Подпись')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblGrps.colSqlVal',  'Условие визы')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblFOLD.colFOLD', 'Код')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.tblFOLD.colFName','Наименование папки')
.head 7 -  ! Msg
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTMsgDone',  'Продолжить?')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTMsgUpdate','Модификация невозможна.')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTMsgInsert','Вставка невозможна.')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTMsgConstr','Нарушение целостности')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTMsgOk','Подтверждение')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTMsgVisa1',
'Вы изменили маршрут визирования операции!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTMsgVisa2',
'Внимание! Возможны следующие последствия:' )
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTMsgVisa3',
'Потребуется время для модификации маршрута~   визирования недовизированных документов.' )
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTMsgVisa4',
'Необходимо будет визировать~   недовизированные документы заново.' )
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTMsgVisa5',
'Все недовизированные документы будут~   заблокированны для визирования и оплаты~    до сохранения изменений. (Рекомендуется сразу~    же после этого сохранить изменения)')
.head 7 -  ! Err
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTErrTt','Вид банковской транзакции введен неправильно!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTErrAcc','Счет')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTErrAccA','введенный как счет А~для оплаты, не существует!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTErrAccB','введенный как счет B~для оплаты, не существует!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTErrMfoB','МФО банка Б')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTErrMfoBNotExist','не существует!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTErrAccVP','Не указан счет валютной позиции для мульнивалютной операции!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTErrAccM','Не указаны маржинальные счета для торговой операции!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTErrAccMDClose','введенный как счет~маржинальных доходов, закрыт!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTErrAccMDNotExist','введенный как счет~маржинальных доходов, не существует!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTErrAccMRClose','введенный как счет~маржинальных расходов, закрыт!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTErrAccMRNotExist','введенный как счет~маржинальных расходов, не существует!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTErrGrpEmptyPriority','В группах контроля присутствует группа с пустым приоритетом!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTErrOperPlan','Плановая операция не имеет групп визирования!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTErrOperTt','Операция для ввода не имеет связанного вида документа!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTErrNbsC','Балансовый счет уже есть в списке~допустимых балансовых счетов по кредиту!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTErrNbsD','Балансовый счет уже есть в списке~допустимых балансовых счетов по дебету!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTErrNbsDC','Балансовый счет уже есть в списке~допустимых балансовых счетов по дебету и по кредиту!')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTErrGrpPriority','Группы контроля с одинаковыми приоритетами не допустимы!')
.head 7 -  ! Constant
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTToLogOperCard', 'Карточка операции')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTToLogBeginEdit','Начато редактирование операции')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTToLogOper',  'Операция')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTToLogUpdate','была изменена')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTToLogEndEdit',  'Закончено редактирование операции')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTOperType','Виды банковских транзакций')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTOpFlags','Флаги транзакции')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTOpRules','Реквизиты транзакции')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTRelOpers','Список операций')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTBalAcc','Балансовые счета')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTVob','Документы')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTGrps','Группы контроля')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTGrpSqlVal','Редактирование условия визы')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTFold','Папки')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTPriority','Приоритет')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTMultiVal','Свойства мультивалютной операции')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTFlags','Флаги')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTNotFlags','Флаги отсутствуют')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTDopR','Доп. реквизиты')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTOpt', 'Обязательный')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTNotOpt','Необязательный')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTForInput','Использовать для ввода')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTNotForInput','Не использовать для ввода')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTNotDopR','Доп. реквизиты отсутствуют')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTCred','Кредитовать')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTDeb', 'Дебетовать')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTNotVidDoc','Виды док-тов отсутствуют')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTNotGroups','Группы контроля отсутствуют')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTInvDC','Инверсия Д/К')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTOperAccess','Операция доступна на ввод следующим пользователям')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTOperAccess1','Операция доступна на ввод, но не дана ни одному пользователю')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperCard.cTOperAccess2','Операция недоступна на ввод')
.head 7 -  ! ====================================================
.head 7 -  Call CurrentLangTable.AddAtom('bgF4','F4 или двойной щелчек правой кнопкой на строке - редактирование уловия визы')
.head 7 -  Call CurrentLangTable.AddAtom('bgDelIns','Del или двойной щелчек на заголовке строки - пометка на удаление; Ins или двойной щелчек в области таблицы - добавление в список')
.head 7 -  ! ====================================================
.head 7 -  ! frmInset
.head 7 -  Call CurrentLangTable.AddAtom('frmInset.bgOperType','Тип банковской транзакции')
.head 7 -  Call CurrentLangTable.AddAtom('frmInset.bgDk','Вид банковской транзакции')
.head 7 -  Call CurrentLangTable.AddAtom('frmInset.cbMulti','Мультивалютная транзакция')
.head 7 -  Call CurrentLangTable.AddAtom('frmInset.cbComplex','Сложная транзакция')
.head 7 -  ! ====================================================
.head 7 -  ! #0-Dlg_OperTts
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OperTts.cTOperTts','Конструктор операций')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OperTts.tbl.colTT','Код')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OperTts.tbl.colTT_NAME','Название банковской операции')
.head 7 -  ! ====================================================
.head 7 -  ! #1-Dlg_OpCart
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpCart.tbl1.colNms','Назначение  счета')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpCart.tbl1.colNls','Маска/Формула~счета')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpCart.tbl1.colKv','Код~Валюты')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpCart.tbl1.colMfo','Код~Банка')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpCart.tbl1.colSk','Симв.~КП')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpCart.tbl2.colNam','Параметр')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpCart.tbl2.colFormula','Значение')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpCart.tbl1.cTAccA','Счет А/для ОПЛАТЫ')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpCart.tbl1.cTAccB','Счет Б/для ОПЛАТЫ')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpCart.tbl1.cTBankA','Счет банка А/для ВВОДА')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpCart.tbl1.cTBankB','Счет банка Б/для ВВОДА')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpCart.tbl1.cTAccVP','Счет валютной позиции')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpCart.tbl1.cTAccInc','Счет маржинальных доходов')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpCart.tbl1.cTAccExp','Счет маржинальных расходов')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpCart.tbl2.cTSum','Формула суммы-А документа')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpCart.tbl2.cTSum2','Формула суммы-Б документа')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpCart.tbl2.cTNazn','Назначение платежа по-умолчанию')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpCart.tbl2.cTPriority','Приоритет транзакции')
.head 7 -  ! ====================================================
.head 7 -  ! #2-Dlg_OpFlgs
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpFlgs.tbl1.colN','Код')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpFlgs.tbl1.colName','Имя флага')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpFlgs.tbl1.colValue','Значение~флага')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpFlgs.tbl2.colTag','Код')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpFlgs.tbl2.colName','Имя реквизита')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpFlgs.tbl2.colOpt','Обязательность~реквизита')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpFlgs.tbl2.colUse4In','Использовать~для ввода')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpFlgs.tbl2.colOrd','Номер реквизита~(для сортировки)')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpFlgs.tbl2.colVal','Значение по~умолчанию')
.head 7 -  ! ====================================================
.head 7 -  ! #3-Dlg_OpRels
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpRels.tbl.colTT','Код~операции')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpRels.tbl.colName','Имя связанной операции')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpRels.tbl.colDC','Инверсия~Д/К')
.head 7 -  ! ====================================================
.head 7 -  ! #4-Dlg_OpNbss
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpNbss.tbl.colAccBNum','Номер~счета')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpNbss.tbl.colAccBName','Имя балансового счета')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpNbss.tbl.colDC','Д/К')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpNbss.tbl.colDn','Значение~Д/К')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpNbss.tbl.colXn','Значение~+/-')
.head 7 -  ! ====================================================
.head 7 -  ! #5-Dlg_OpVobs
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpVobs.tbl.colVOB','Код')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpVobs.tbl.colDName','Виды банковских документов')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpVobs.tbl.colTemplate','Файл шаблона')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpVobs.tbl.colORD','Порядок сорт')
.head 7 -  ! ====================================================
.head 7 -  ! #6-Dlg_OpGrps
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpGrps.tbl.colId','Код')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpGrps.tbl.colGName','Группы контроля')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpGrps.tbl.colCharged','Подпись')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpGrps.tbl.colPriority','Приоритеты')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpGrps.tbl.colRespond','Отв.')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpGrps.tbl.colConditi','Усл.')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpGrps.tbl.colSqlVal','Условие визы')
.head 7 -  ! ====================================================
.head 7 -  ! #8-Dlg_OpFold
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpFold.tbl.colFOLD','Код')
.head 7 -  Call CurrentLangTable.AddAtom('Dlg_OpFold.tbl.colFName','Наименование папки')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_OperExpOpts
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperExpOpts.cTWndTitle','Параметры экспорта операции')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperExpOpts.cbAll','Все')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperExpOpts.cbErr','Выводить сообщения об ошибках')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperExpOpts.cbT00','Подбирать T00')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperExpOpts.cbFlag','С флагами')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperExpOpts.cbDRec','С доп. реквизитами')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperExpOpts.cbRelated','Со связанными операциями')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperExpOpts.cbBal','С допустимыми бал. счетами')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperExpOpts.cbVob','С видами документов')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperExpOpts.cbChk','С группами визирования')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperExpOpts.cbFolder','С папками')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperExpOpts.pbOk','Экспорт')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperExpOpts.pbCancel','Отменить')
.head 7 -  ! Bg
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperExpOpts.bgFileName','Файл')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_OperExpOpts.cbIns','Добавлять в базовый справочник')
.head 7 -  ! ====================================================
.head 7 -  ! dlg_PickList
.head 7 -  Call CurrentLangTable.AddAtom('dlg_PickList.tbl.colID','Код')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_PickList.tbl.colName','Наименование')
.head 7 -  ! ====================================================
.head 7 -  ! frm_OperList
.head 7 -  Call CurrentLangTable.AddAtom('frm_OperList.cTWndTitle','Настройка шаблонов операций')
.head 7 -  ! Button strTip
.head 7 -  Call CurrentLangTable.AddAtom('frm_OperList.cBTipToFile','Экспорт операций в текстовый файл')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OperList.cBTipExp','Экспорт настройки операций в набор *.dbf файлов')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OperList.cBTipImp','Синхронизация настройки операций из набора *.dbf файлов')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OperList.cBTipExportSelected','Экспорт операции в SQL сценарий')
.head 7 -  ! Columns
.head 7 -  Call CurrentLangTable.AddAtom('frm_OperList.colTT','Код')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OperList.colTT_NAME','Название банковской операции')
.head 7 -  ! Msg
.head 7 -  Call CurrentLangTable.AddAtom('frm_OperList.cTMsgToLogExecFunc','Запуск функции')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OperList.cTMsgToLogExitFunc','Выход из функции')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OperList.cTMsgOperNotSave','Настройки не сохранены!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OperList.cTMsgSave','Сохранить?')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OperList.cTMsgOper','Настройка операций')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OperList.cTMsgInfToFile','Информация помещена в файл')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OperList.cTMsgOperNotSelect','Ни одна операция не выбрана!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OperList.cTMsgExpNotSelect', 'Ничего не выбрано для экспорта!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OperList.cTMsgOperSaveToFile','Операции сохранены в файле')
.head 7 -  Call CurrentLangTable.AddAtom('frm_OperList.cTMsgFileNotCreate', 'Не могу создать файл')
.head 7 -  ! ====================================================
.head 7 -  ! frm_RefList
.head 7 -  Call CurrentLangTable.AddAtom('frm_RefList.cTWndTitle','Справочники')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_RefList.pbAction','Открыть')
.head 7 -  Call CurrentLangTable.AddAtom('frm_RefList.pbExit','Отменить')
.head 7 -  ! Err
.head 7 -  Call CurrentLangTable.AddAtom('frm_RefList.cTErrRef', 'Некорректно задана функция вызова справочника!')
.head 7 -  Call CurrentLangTable.AddAtom('frm_RefList.cTErrMenu','ошибка построения меню')
.head 7 -  ! Constant
.head 7 -  Call CurrentLangTable.AddAtom('frm_RefList.cTClose','Закрыть')
.head 7 -  Call CurrentLangTable.AddAtom('frm_RefList.cTShow','Показать')
.head 7 -  ! ====================================================
.head 7 -  ! Frm_PSSP
.head 7 -  Call CurrentLangTable.AddAtom('Frm_PSSP.cTWndTitle','Распределение  спецпараметров по балансовым счетам')
.head 7 -  ! tblPS
.head 7 -  Call CurrentLangTable.AddAtom('Frm_PSSP.tblPS.colNBS','№ БС')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_PSSP.tblPS.colName','Наименование БС')
.head 7 -  ! tblSP
.head 7 -  Call CurrentLangTable.AddAtom('Frm_PSSP.tblSP.colName','Выбранные параметры')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_PSSP.tblSP.colOpt','Признак обязат.~заполнения')
.head 7 -  Call CurrentLangTable.AddAtom('Frm_PSSP.tblSP.colSqlVal','SQL-выражение для умолч.значения')
.head 7 -  ! ====================================================
.head 7 -  ! Frm_SPar
.head 7 -  ! tblSPAll
.head 7 -  Call CurrentLangTable.AddAtom('Frm_SPar.tblSPAll.colName','Доступные параметры')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_AllUsers.wndTitle',   'Пользователи')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_PkeyData.wndTitleBNK','Для какого банка формируем отчет')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_PkeyData.wndTitleMOD','Для какого модуля формируем отчет')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_PkeyData.forAll',     'Для всех')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_PkeyData.msgNoBnk',   'Не выбран банк для запроса')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_PkeyData.msgNoMdl',   'Не выбран модуль для запроса')
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Pkey.wndTitle','Мнемонический ключ запроса')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Pkey.lable1NoVSS',     'Поскольку вы не используете работу с VSS, проставте')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Pkey.lable2NoVSS',     'последовательный номер для данного банка и модуля')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Pkey.lable3NoVSS',     'вычислив его как следующий из имеющихся в VSS')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Pkey.lable1WithVSS',   'При поиске в VSS, был найден последовательный номер')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_Pkey.pbOk',            'Продолжить')
.head 7 -  ! ====================================================
.head 7 -  ! frm_DBFSyncEdit
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('frm_DBFSyncEdit.msg.NoDBFFile}',  'В директории импорта не найден файл выбранного справочника')
.head 7 -  Call CurrentLangTable.AddAtom('frm_DBFSyncEdit.msg.TableExists', 'Промежуточная таблица уже существует')
.head 7 -  Call CurrentLangTable.AddAtom('frm_DBFSyncEdit.msg.IsDelTable',  'Удалить таблицу с потерей всех данных?')
.head 7 -  Call CurrentLangTable.AddAtom('frm_DBFSyncEdit.msg.ImpOk',       'Импорт во временную таблицу прошел успешно')
.head 7 -  Call CurrentLangTable.AddAtom('frm_DBFSyncEdit.msg.ImpBad',      'Импорт в промежуточную таблицу прошел с ошибками')
.head 7 -  Call CurrentLangTable.AddAtom('frm_DBFSyncEdit.msg.RenewOk',     'Обновление справочника успешно завершено')
.head 7 -  Call CurrentLangTable.AddAtom('frm_DBFSyncEdit.msg.ErrDel',      'Ошибка при удалении данных из справочника')
.head 7 -  Call CurrentLangTable.AddAtom('frm_DBFSyncEdit.msg.ErrUpd',      'Ошибка при обновлении данных из справочника')
.head 7 -  Call CurrentLangTable.AddAtom('frm_DBFSyncEdit.msg.ErrInd',      'Ошибка при вставке данных в справочник')
.head 7 -  Call CurrentLangTable.AddAtom('frm_DBFSyncEdit.msg.OldFile',     'Дата импортируемого файла меньше даты последнего обновления справочника! Продолжить?')
.head 7 -  Call CurrentLangTable.AddAtom('frm_DBFSyncEdit.msg.SameFile',     'Данный файл уже был заимпортирован'||PutLf()||'(дата создания файла совпадает с датой создания предыдущего заимпортированого файла)  Продолжить?')
.head 7 -  !
.head 7 -  ! ====================================================
.head 7 -  ! dlg_addToFunc
.head 7 -  !
.head 7 -  Call CurrentLangTable.AddAtom('dlg_addToFunc.lbFuncCode',  'Код функции')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_addToFunc.lbFuncName',  'Наименование функции')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_addToFunc.lbFunc',      'Формула для выполнения')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_addToFunc.Title',       'Добавить кат.запрос в список функций')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_addToFunc.lbRole',      'Роль для выполнения функции')
.head 7 -  Call CurrentLangTable.AddAtom('dlg_addToFunc.lbReportType',      'Тип отчета')
.head 7 -  !
.head 7 -  !
.head 6 -  Set fInitLib = TRUE
.head 5 -  ! Call CurrentLangTable.SaveToFile('C:\\TEMP\\ref.lng','RUS')
.head 5 -  Return fInitLib
.head 3 -  !
.head 3 +  Function: ShowRefList        ! __exported
.head 4 -  Description: Показать список справочников АБС ( dlg_RefList )
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndOwner
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call IniReferenc()
.head 5 -  ! Call SalMessageBox('frm_RefList', 'ooo', MB_Ok)
.head 5 -  Call SalCreateWindow(frm_RefList, hWndOwner)
.head 3 -  !
.head 3 +  Function: ShowRefBpReason    ! __exported
.head 4 -  Description: Показать справочник кодов причин возврата платежей СЭП ( dlg_RefBpReason )
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Boolean: bMode
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! /////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 5 -  !
.head 5 -  Return SalModalDialog( dlg_RefBpReason, hWndForm, bMode )
.head 5 -  !
.head 5 -  ! /////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 3 -  !
.head 3 +  Function: ShowRefTts         ! __exported
.head 4 -  Description: Показать справочник описания банковских транзакций ( dlg_RefTts )
.head 4 +  Returns
.head 5 -  Number:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return SalMessageBox('Вызов устаревшей функции! Обратитесь к Администратору АБС.', 'Внимание!', MB_Ok)
.head 3 +  Function: ShowRefTtsap       ! __exported
.head 4 -  Description: Показать справочник связанных шаблонов банковских операций
.head 4 +  Returns
.head 5 -  Number:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return SalMessageBox('Вызов устаревшей функции! Обратитесь к Администратору АБС.', 'Внимание!', MB_Ok)
.head 3 +  Function: ShowRefFlags       ! __exported
.head 4 -  Description: Показать справочник использования реквизитов банковских документов
.head 4 +  Returns
.head 5 -  Number:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return SalMessageBox('Вызов устаревшей функции! Обратитесь к Администратору АБС.', 'Внимание!', MB_Ok)
.head 3 +  Function: ShowRefSuch        ! __exported
.head 4 -  Description: Показать справочник участников Межбанковских расчетов
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  String: strAccess
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  ! If SalStrUpperX( strAccess ) = 'RO'
.head 6 -      Return SalModalDialog( dlg_RefSuch, hWndForm, FALSE )
.head 5 +  ! Else
.head 6 -      Return SalModalDialog( dlg_RefSuch, hWndForm, TRUE )
.head 5 -  Call IniReferenc()
.head 5 +  If not IsWindow(hWndBanks)
.head 6 -  Set hWndBanks= SalCreateWindow(tblBanks,hWndMDI,IifN(SalStrUpperX( strAccess ) = 'RO',0,1))
.head 5 +  Else
.head 6 -  Call SalBringWindowToTop ( tblBanks )
.head 3 +  Function: ShowRefTempl       ! __exported
.head 4 -  Description: Показать справочник шаблоны проводок электронных платежей
.head 4 +  Returns
.head 5 -  Number:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call IniReferenc()
.head 5 -  Return SalModalDialog( dlg_RefTemplates, hWndForm )
.head 3 +  Function: ShowRefCur         ! __exported
.head 4 -  Description: Показать справочник валют и вал позиций
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: strRefAccess       ! RO/WR
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call IniReferenc()
.head 5 +  If not IsWindow(hsplVal)
.head 6 -  Set hsplVal= SalCreateWindow(splVal,hWndMDI,strRefAccess)
.head 5 +  Else
.head 6 -  Call SalBringWindowToTop ( splVal )
.head 3 -  !
.head 3 -  ! Настройка операций
.head 3 +  Function: ShowOperEditor     ! __exported
.head 4 -  Description: Показать форму настройки операций
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Window Handle: Parent
.head 5 -  Number: Option
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If Option = 9 or Option = 8  ! Старая Иванова Версия
.head 6 -  Call IniReferenc()
.head 6 +  If fOlCalled
.head 7 -  Call SalBringWindowToTop( frm_OperList )
.head 6 +  Else
.head 7 -  Set fOlCalled=TRUE
.head 7 -  Call SalCreateWindow( frm_OperList, Parent, Option )
.head 5 +  Else ! Новая версия Mik
.head 6 -  Call ShowRef(Parent,0,Option,'','')
.head 3 -  ! Раздача каталогизированных запросов +
.head 3 -  ! редактирование обновляемых таблиц
.head 3 +  Function: ShowQueryEditor    ! __exported
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: Parent
.head 5 -  Number: Option
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call IniReferenc()
.head 5 -  ! Option:
0 - каталогизированные запросы  все
1 - обновляемые таблицы
2 - каталогизированные запросы только текущего пользователя 
3 - каталогизированные запросы только для разработчика
4 - обновляемые таблицы (только синхронизация без редактирования)
.head 5 +  Select Case Option
.head 6 +  Case 0
.head 7 +  If NOT fEditorStarted
.head 8 -  Call SalCreateWindow( frm_QueryEditor, Parent, Option )
.head 8 -  Set fEditorStarted=TRUE
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop( frm_QueryEditor )
.head 7 -  Break
.head 6 +  Case 1
.head 7 +  If NOT fDbfSync
.head 8 -  Call SalCreateWindow( frm_DBFSyncEdit, Parent, 0 )
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop( frm_DBFSyncEdit )
.head 7 -  Break
.head 6 +  Case 2
.head 7 +  If NOT fEditorStarted
.head 8 -  Call SalCreateWindow( frm_QueryEditor, Parent, Option )
.head 8 -  Set fEditorStarted=TRUE
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop( frm_QueryEditor )
.head 7 -  Break
.head 6 +  Case 3
.head 7 +  If NOT fEditorStarted
.head 8 -  Call SalCreateWindow( frm_QueryEditor, Parent, Option )
.head 8 -  Set fEditorStarted=TRUE
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop( frm_QueryEditor )
.head 7 -  Break
.head 6 +  Case 4
.head 7 +  If NOT fDbfSync
.head 8 -  Call SalCreateWindow( frm_DBFSyncEdit, Parent, 1 )
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop( frm_DBFSyncEdit )
.head 7 -  Break
.head 6 +  Case 5
.head 7 +  If hWndFastReportEditor
.head 8 -  Call SalBringWindowToTop( hWndFastReportEditor )
.head 7 +  Else
.head 8 -  Set hWndFastReportEditor=SalCreateWindow(tbl_FastReportEditor, Parent)
.head 3 +  Function: EmptyArrays
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  String: sArray[100]
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nIndex
.head 4 +  Actions
.head 5 -  Set nIndex=0
.head 5 +  Loop
.head 6 +  If nIndex<=99
.head 7 -  Set sArray[nIndex]=''
.head 7 -  Set nIndex=nIndex+1
.head 6 +  Else
.head 7 -  Break
.head 3 +  Function: ShowRefPSSP        ! __exported    
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call IniReferenc()
.head 5 -  Call SalCreateWindow( Frm_PSSP, hWndMDI)
.head 3 +  Function: ShowRefRRP        ! __exported    
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call IniReferenc()
.head 5 -  Call SalCreateWindow( tbl_RefRRP, hWndMDI)
.head 3 -  ! Внутр. ф-и для экспорта настройки операций
.head 3 +  Function: FL_StrToFile
.head 4 -  Description: Преобразует строку в формат для хранения в файле
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sString
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nLength
.head 4 +  Actions
.head 5 +  If sString
.head 6 -  Set nLength=SalStrLength( sString )
.head 6 -  Return PadL( SalNumberToStrX( nLength, 0 ), 7 ) || sString
.head 5 +  Else
.head 6 -  Return PadL( '0', 7 )
.head 3 +  Function: FL_StrFromFile
.head 4 -  Description: Читает следующую строку из файла
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  File Handle: hFile
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nLength
.head 4 -  Actions
.head 3 +  Function: PutOperToFile
.head 4 -  Description: Выгрузка операции в строку для выгрузки в файл
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sTt
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 -  Actions
.head 3 +  Function: EnumOpers
.head 4 -  Description: Получение списка операций из файла
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  File Handle: hFile
.head 5 -  Receive String: sTt[*]
.head 5 -  Receive String: sName[*]
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 -  Actions
.head 3 +  Function: LoadOpers
.head 4 -  Description: Загрузка операций указанных в списке
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  File Handle: hFile
.head 5 -  String: sTt[*]
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 -  Actions
.head 3 -  ! Экспорт кат. зпросов в сценарии
.head 3 +  Function: QE_NumberToStrFormat
.head 4 -  Description: !! Превращает число в строку заданной длины (nLen) - дополняя впереди нулями
.head 4 +  Returns
.head 5 -  String: strVal
.head 4 +  Parameters
.head 5 -  Number: nVal
.head 5 -  Number: nLen
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: i
.head 5 -  String: strVal
.head 4 +  Actions
.head 5 -  Set i=10
.head 5 -  Set strVal = SalNumberToStrX(nVal,0)
.head 5 +  Loop
.head 6 +  If i  > SalNumberPower (10 , nLen - 1)
.head 7 -  Return strVal
.head 7 -  Break
.head 6 +  If nVal < i
.head 7 -  Set strVal =  '0' || strVal
.head 6 -  Set i = i * 10
.head 3 +  Function: QE_GetExpFileNameById
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Number: nExpQry
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nFetchRes
.head 5 -  String: sPkey
.head 4 +  Actions
.head 5 +  If SqlPrepareAndExecute(hSql(),
 "select pkey into :sPkey  from zapros where kodz=:nExpQry")
.head 6 +  If SqlFetchNext(hSql(),nFetchRes)
.head 7 -  Return VisStrSubstitute(VisStrSubstitute( sPkey, "\\", "_" ),'*','X')||'.sql'
.head 6 +  Else
.head 7 -  Call SalMessageBox('Отчет с кодом '||SalNumberToStrX(nExpQry,0)||' не найден.', 'Внимание!',0 )
.head 7 -  Return STRING_Null
.head 3 +  Function: QE_GetExpFileNameByPK
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sPkey
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return VisStrSubstitute(VisStrSubstitute( sPkey, "\\", "_" ),'*','X')||'.sql'
.head 3 +  Function: QE_GetPKeyFormFileName
.head 4 -  Description: По имени выгруженного файла  - дат pkey
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sFileName
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sTmp
.head 5 -  Number: nDotPos
.head 4 +  Actions
.head 5 -  Set nDotPos = SalStrScan(sFileName,'.')
.head 5 +  If nDotPos > 0
.head 6 -  Set sTmp = SalStrLeftX(sFileName, nDotPos-1)
.head 5 +  Else
.head 6 -  Set sTmp = sFileName
.head 5 -  Return VisStrSubstitute(VisStrSubstitute( sTmp, "X", "*" ),'_','\\')
.head 3 -  !
.head 3 -  ! Экспорт кат. запроса в sql сценарий
.head 3 +  ! Function: QE_makeExport  ! old version
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Number: 
.head 4 +  Parameters 
.head 5 -  ! Код запроса
.head 5 -  Number: nExpQry
.head 5 -  ! Ключ запроса
.head 5 -  String: sExpPkey
.head 5 -  ! Наименование запроса
.head 5 -  String: sExpQryName
.head 5 -  ! Номер связанного запроса
.head 5 -  Number: nExpConstrQry
.head 5 -  ! Директория для файла экспорта
.head 5 -  String: sPrnPath
.head 5 -  ! Имя файла шаблона
.head 5 -  String: sTmplPath
.head 5 -  ! Создавать в сценарии выражение на создание отчета
.head 5 -  Boolean: fCreateReport
.head 5 -  ! Фиксированный код отчета (если 0 - используется динамический №)
.head 5 -  Number: nFixRepNumber
.head 5 -  ! Заменять ли строку в табл. reports
.head 5 -  Boolean: bIsReplaceReport
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  ! File Handle: hFileIn
.head 5 -  ! File Handle: hFileTmpl
.head 5 -  ! String: sFileLine
.head 5 -  String: sInsertFields
.head 5 -  ! Long String: sInsertValues
.head 5 -  ! Long String: sSQLExpr
.head 5 -  Number: nTmp
.head 5 -  Number: i
.head 5 -  !
.head 5 -  String: sZAPROSfields[*,2]
.head 5 -  String: sREPORTSfields[*,2]
.head 5 -  Number: nZAPROSnum
.head 5 -  Number: nREPORTSnum
.head 5 -  File Handle: hFileIn
.head 5 -  File Handle: hFileTmpl
.head 5 -  Long String: sFileLine
.head 5 -  Number: nFetchRes
.head 4 +  Actions 
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set sPrnPath = sPrnPath
.head 5 +  If not  SalFileOpen ( hFileTmpl, sTmplPath, OF_Read)
.head 6 -  Call SalMessageBox(' Невозможно открыть для чтения файл '|| sTmplPath, 'Внимание!',0)
.head 6 -  Call SalWaitCursor (FALSE )
.head 6 -  Return -1
.head 5 -  ! Если такой файл существует - удалить его и записать другой
.head 5 +  If (VisFileFind(sPrnPath)!=STRING_Null)
.head 6 +  If VisFileDelete(sPrnPath) < 0 
.head 7 -  Call SalMessageBox(' Невозможно удалить уже существующий файл '||sPrnPath, 'Внимание!',0)
.head 5 -  !
.head 5 +  If not  SalFileOpen ( hFileIn, sPrnPath, OF_Write )
.head 6 -  Call SalMessageBox(' Невозможно открыть для записи файл '||  sPrnPath, 'Внимание!',0)
.head 6 +  If not SalFileClose ( hFileTmpl )
.head 7 -  Call SalMessageBox(' Не возможно закрыть файл '||sTmplPath, 'Внимание!',0)
.head 6 -  Call SalWaitCursor (FALSE )
.head 6 -  Return -1
.head 5 -  Set sFileLine="PROMPT=====================================" ||PutCrLf()||
              "PROMPT  "|| sExpQryName||PutCrLf()||
              "PROMPT=====================================" ||PutCrLf()
.head 5 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 5 -  !
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '<Export_Template>' ) = -1
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  ! -- Вычитаем структуру таблиц в тэгах <Comments>
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '<Comment>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 -  ! -- Таблица ZAPROS
.head 5 -  Set i=0
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '<Table_ZAPROS>' ) = -1
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '</Table_ZAPROS>' ) = -1
.head 6 -  Set nTmp=SalStrScan ( sFileLine, '!')
.head 6 +  If nTmp > -1
.head 7 -  Set sZAPROSfields[i,0]=VisStrSubstitute( SalStrLeftX(sFileLine, nTmp),' ','')
.head 7 -  Set sZAPROSfields[i,1]=SalStrMidX(sFileLine, nTmp+1,1)
.head 7 -  Set i=i+1
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  Set nZAPROSnum=i
.head 5 -  !
.head 5 -  ! -- Таблица REPORTS
.head 5 -  Set i=0
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '<Table_REPORTS>' ) = -1
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '</Table_REPORTS>' ) = -1
.head 6 -  Set nTmp=SalStrScan ( sFileLine, '!')
.head 6 +  If nTmp > -1
.head 7 -  Set sREPORTSfields[i,0]=VisStrSubstitute(SalStrLeftX(sFileLine, nTmp),' ','')
.head 7 -  Set sREPORTSfields[i,1]=SalStrMidX(sFileLine, nTmp+1,1)
.head 7 -  Set i=i+1
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  Set nREPORTSnum=i
.head 5 -  !
.head 5 -  ! Найдем конец комментариям
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '</Comment>' ) = -1
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 -  ! --Удаление уже существующих таких же отчетов в ZAPROS
.head 5 -  ! -- отчет считать аналогичным,если
.head 5 -  !
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '<rep_name>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 -  !
.head 5 -  Call SalFilePutStr ( hFileIn, "  rep_name:='"||sExpQryName||"';" )
.head 5 -  Call SalFilePutStr ( hFileIn, "  pkey    :='"||sExpPkey||"';" )
.head 5 -  !
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '</rep_name>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 -  ! --Если запрос сложный - найдем строку для связанного --
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '<Constraint_query>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 +  If nExpConstrQry > 0
.head 6 -  ! -- Найдем начало св. запроса
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 +  While SalStrScan ( sFileLine, '<Insert_stmt>' ) = -1
.head 7 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 7 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 -  Call SalFilePutStr ( hFileIn,  QE_CreateInsertStmt(nExpConstrQry, 2, sZAPROSfields, nZAPROSnum, nFixRepNumber))
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 +  While SalStrScan ( sFileLine, '</Insert_stmt>' ) = -1
.head 7 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 7 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 -  !
.head 6 +  While SalStrScan ( sFileLine, '<Update_stmt>' ) = -1
.head 7 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 7 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 -  Call SalFilePutStr ( hFileIn,  QE_CreateUpdateStmt(nExpConstrQry, 2, sZAPROSfields, nZAPROSnum, nFixRepNumber))
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 +  While SalStrScan ( sFileLine, '</Update_stmt>' ) = -1
.head 7 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 7 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 -  !
.head 6 +  While SalStrScan ( sFileLine, '</Constraint_query>' ) = -1
.head 7 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 7 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 2048 )
.head 6 -  !
.head 5 -  !
.head 5 -  ! -- Найдем главный запрос
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '<Main_query>' ) = -1
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '<Insert_stmt>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 2048 )
.head 5 -  Call SalFilePutStr ( hFileIn, QE_CreateInsertStmt(nExpQry, 1, sZAPROSfields, nZAPROSnum, nFixRepNumber))
.head 5 -  !
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '</Insert_stmt>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 2048 )
.head 5 -  !
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '<Update_stmt>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 2048 )
.head 5 -  Call SalFilePutStr ( hFileIn, QE_CreateUpdateStmt(nExpQry, 1, sZAPROSfields, nZAPROSnum, nFixRepNumber))
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 +  While SalStrScan ( sFileLine, '</Update_stmt>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 2048 )
.head 5 -  !
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '</Main_query>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 2048 )
.head 5 -  !
.head 5 -  ! --Найдем строку для reports
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '<Reports_insert>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 -  !
.head 5 -  ! Если нужно создавать строки для REPORTS
.head 5 -  Set i=0
.head 5 +  If nFixRepNumber>0
.head 6 -  Call SalFilePutStr ( hFileIn, '    new_r:='||SalNumberToStrX(nFixRepNumber,0)||';' )
.head 5 +  If SqlPrepareAndExecute(hSql(),
 " SELECT id INTO :nTmp  FROM reports  WHERE form='frm_UniReport' AND  substr(param, 1, instr(param,',')-1)=TO_CHAR(:nExpQry)")
.head 6 +  While SqlFetchNext(hSql(),nFetchRes)
.head 7 -  Set i=i+1
.head 5 +  If i>0 and fCreateReport
.head 6 -  !
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 +  While SalStrScan ( sFileLine, '<Insert_stmt>' ) = -1
.head 7 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 7 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 2048 )
.head 6 -  !
.head 6 -  Call SalFilePutStr ( hFileIn, QE_CreateInsertStmt(nTmp, 3, sREPORTSfields, nREPORTSnum, nFixRepNumber))
.head 6 -  !
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 +  While SalStrScan ( sFileLine, '</Insert_stmt>' ) = -1
.head 7 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 7 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 2048 )
.head 6 -  !
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 +  While SalStrScan ( sFileLine, '</Reports_insert>' ) = -1
.head 7 +  If (SalStrScan(sFileLine,'NEW_R')>-1 ) and (nFixRepNumber)
.head 8 -  Set sFileLine= VisStrSubstitute(sFileLine, "NEW_R",
                       "'"||SalNumberToStrX(nFixRepNumber,0)||"'")
.head 7 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 7 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  Else 
.head 6 +  While SalStrScan ( sFileLine, '</Reports_insert>' ) = -1
.head 7 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '<Reports_comm>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 -  !
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '</Reports_comm>' ) = -1
.head 6 +  If (SalStrScan(sFileLine,'REP_NAME')>-1 )
.head 7 -  Set sFileLine= VisStrSubstitute(sFileLine, "REP_NAME", '"'||sExpQryName||'"')
.head 7 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 +  Else If (SalStrScan(sFileLine,'NEW_R')>-1 ) and (nFixRepNumber)
.head 7 -  Set sFileLine= VisStrSubstitute(sFileLine, "NEW_R",
                       "'"||SalNumberToStrX(nFixRepNumber,0)||"'")
.head 7 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 +  Else 
.head 7 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 -  !
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '</Export_Template>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 -  !
.head 5 +  If not SalFileClose ( hFileIn )
.head 6 -  Call SalMessageBox(' Не возможно закрыть файл ', 'Внимание!',0)
.head 6 -  Call SalWaitCursor (FALSE )
.head 6 -  Return -1
.head 5 +  If not SalFileClose ( hFileTmpl )
.head 6 -  Call SalMessageBox(' Не возможно закрыть файл ', 'Внимание!',0)
.head 6 -  Call SalWaitCursor (FALSE )
.head 6 -  Return -1
.head 5 -  !
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return 0
.head 3 +  ! Function: QE_makeExport
.head 4 -  Description: 
.head 4 +  Returns 
.head 5 -  Number: 
.head 4 +  Parameters 
.head 5 -  ! Код запроса
.head 5 -  Number: nExpQry
.head 5 -  ! Директория для файла экспорта
.head 5 -  String: sFilePathName
.head 5 -  ! Создавать в сценарии выражение на создание отчета
.head 5 -  Number: nCreateReport  !(0- нет , 1-да)
.head 5 -  ! Фиксированный код отчета (если 0 - используется динамический №)
.head 5 -  Number: nFixRepNumber
.head 5 -  ! Код формата отчета (если не указывается nFixRepNumber - данный парамтр может быть пустым)
.head 5 -  Number: nRepFormat
.head 4 -  Static Variables 
.head 4 -  Local variables 
.head 4 +  Actions 
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  !
.head 5 +  If not SqlPLSQLCommand(hSql(),"bars_report.export_to_script(nExpQry, nCreateReport, nFixRepNumber,nRepFormat)")
.head 6 -  Call SalMessageBox( 'Ошибка формирования SQL сценария для кат. запроса', 'Внимание', MB_Ok | MB_IconAsterisk )
.head 5 +  Else 
.head 6 +  If not PutLoadedBlobToFile(hSql(),sFilePathName)
.head 7 -  Call SalMessageBox( 'Ошибка выгрузки SQL сценария в файл', 'Внимание', MB_Ok | MB_IconAsterisk )
.head 6 +  Else 
.head 7 -  Call SalMessageBox( 'Выгрузка SQL сценария завершена!', 'Внимание', MB_Ok  )
.head 5 -  !
.head 5 -  !
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return 0
.head 3 +  ! Function: QE_makeExportToFile
.head 4 -  Description: Аналог QE_makeExport, но записывает все в указанный по hendl-у файл
.head 4 +  Returns 
.head 5 -  Number: 
.head 4 +  Parameters 
.head 5 -  ! Код запроса
.head 5 -  Number: nExpQry
.head 5 -  ! Ключ запроса
.head 5 -  String: sExpPkey
.head 5 -  ! Наименование запроса
.head 5 -  String: sExpQryName
.head 5 -  ! Номер связанного запроса
.head 5 -  Number: nExpConstrQry
.head 5 -  ! Директория для файла экспорта
.head 5 -  String: sPrnPath
.head 5 -  ! Имя файла шаблона
.head 5 -  String: sTmplPath
.head 5 -  ! Создавать в сценарии выражение на создание отчета
.head 5 -  Boolean: fCreateReport
.head 5 -  ! Фиксированный код отчета (если 0 - используется динамический №)
.head 5 -  Number: nFixRepNumber
.head 5 -  ! Заменять ли строку в табл. reports
.head 5 -  Boolean: bIsReplaceReport
.head 5 -  ! В какой файл выгружать
.head 5 -  File Handle: hFileIn
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sInsertFields
.head 5 -  Number: nTmp
.head 5 -  Number: i
.head 5 -  String: sZAPROSfields[*,2]
.head 5 -  String: sREPORTSfields[*,2]
.head 5 -  Number: nZAPROSnum
.head 5 -  Number: nREPORTSnum
.head 5 -  File Handle: hFileTmpl
.head 5 -  Long String: sFileLine
.head 5 -  Number: nFetchRes
.head 4 +  Actions 
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  If not  SalFileOpen ( hFileTmpl, sTmplPath, OF_Read)
.head 6 -  Call SalMessageBox(' Невозможно открыть для чтения файл '|| sTmplPath, 'Внимание!',0)
.head 6 -  Call SalWaitCursor (FALSE )
.head 6 -  Return -1
.head 5 -  ! --------------------------------------------
.head 5 -  Set sFileLine="PROMPT=====================================" ||PutCrLf()||
              "PROMPT  "|| sExpQryName||PutCrLf()||
              "PROMPT=====================================" ||PutCrLf()
.head 5 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 5 -  !
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '<Export_Template>' ) = -1
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  ! -- Вычитаем структуру таблиц в тэгах <Comments>
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '<Comment>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 -  ! -- Таблица ZAPROS
.head 5 -  Set i=0
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '<Table_ZAPROS>' ) = -1
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '</Table_ZAPROS>' ) = -1
.head 6 -  Set nTmp=SalStrScan ( sFileLine, '!')
.head 6 +  If nTmp > -1
.head 7 -  Set sZAPROSfields[i,0]=VisStrSubstitute( SalStrLeftX(sFileLine, nTmp),' ','')
.head 7 -  Set sZAPROSfields[i,1]=SalStrMidX(sFileLine, nTmp+1,1)
.head 7 -  Set i=i+1
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  Set nZAPROSnum=i
.head 5 -  !
.head 5 -  ! -- Таблица REPORTS
.head 5 -  Set i=0
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '<Table_REPORTS>' ) = -1
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '</Table_REPORTS>' ) = -1
.head 6 -  Set nTmp=SalStrScan ( sFileLine, '!')
.head 6 +  If nTmp > -1
.head 7 -  Set sREPORTSfields[i,0]=VisStrSubstitute(SalStrLeftX(sFileLine, nTmp),' ','')
.head 7 -  Set sREPORTSfields[i,1]=SalStrMidX(sFileLine, nTmp+1,1)
.head 7 -  Set i=i+1
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  Set nREPORTSnum=i
.head 5 -  !
.head 5 -  ! Найдем конец комментариям
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '</Comment>' ) = -1
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 -  ! --Удаление уже существующих таких же отчетов в ZAPROS
.head 5 -  ! -- отчет считать аналогичным,если
.head 5 -  !
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '<rep_name>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 -  !
.head 5 -  Call SalFilePutStr ( hFileIn, "  rep_name:='"||sExpQryName||"';" )
.head 5 -  Call SalFilePutStr ( hFileIn, "  pkey    :='"||sExpPkey||"';" )
.head 5 -  !
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '</rep_name>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 -  ! --Если запрос сложный - найдем строку для связанного --
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '<Constraint_query>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 +  If nExpConstrQry > 0
.head 6 -  ! -- Найдем начало св. запроса
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 +  While SalStrScan ( sFileLine, '<Insert_stmt>' ) = -1
.head 7 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 7 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 -  Call SalFilePutStr ( hFileIn,  QE_CreateInsertStmt(nExpConstrQry, 2, sZAPROSfields, nZAPROSnum, nFixRepNumber))
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 +  While SalStrScan ( sFileLine, '</Insert_stmt>' ) = -1
.head 7 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 7 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 -  !
.head 6 +  While SalStrScan ( sFileLine, '<Update_stmt>' ) = -1
.head 7 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 7 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 -  Call SalFilePutStr ( hFileIn,  QE_CreateUpdateStmt(nExpConstrQry, 2, sZAPROSfields, nZAPROSnum, nFixRepNumber))
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 +  While SalStrScan ( sFileLine, '</Update_stmt>' ) = -1
.head 7 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 7 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 -  !
.head 6 +  While SalStrScan ( sFileLine, '</Constraint_query>' ) = -1
.head 7 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 7 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 2048 )
.head 6 -  !
.head 5 -  !
.head 5 -  ! -- Найдем главный запрос
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '<Main_query>' ) = -1
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '<Insert_stmt>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 2048 )
.head 5 -  Call SalFilePutStr ( hFileIn, QE_CreateInsertStmt(nExpQry, 1, sZAPROSfields, nZAPROSnum, nFixRepNumber))
.head 5 -  !
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '</Insert_stmt>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 2048 )
.head 5 -  !
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '<Update_stmt>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 2048 )
.head 5 -  Call SalFilePutStr ( hFileIn, QE_CreateUpdateStmt(nExpQry, 1, sZAPROSfields, nZAPROSnum, nFixRepNumber))
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 +  While SalStrScan ( sFileLine, '</Update_stmt>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 2048 )
.head 5 -  !
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '</Main_query>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 2048 )
.head 5 -  !
.head 5 -  ! --Найдем строку для reports
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '<Reports_insert>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 -  !
.head 5 -  ! Если нужно создавать строки для REPORTS
.head 5 -  Set i=0
.head 5 +  If nFixRepNumber>0
.head 6 -  Call SalFilePutStr ( hFileIn, '    new_r:='||SalNumberToStrX(nFixRepNumber,0)||';' )
.head 5 +  If SqlPrepareAndExecute(hSql(),
 " SELECT id INTO :nTmp  FROM reports  WHERE form='frm_UniReport' AND  substr(param, 1, instr(param,',')-1)=TO_CHAR(:nExpQry)")
.head 6 +  While SqlFetchNext(hSql(),nFetchRes)
.head 7 -  Set i=i+1
.head 5 +  If i>0 and fCreateReport
.head 6 -  !
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 +  While SalStrScan ( sFileLine, '<Insert_stmt>' ) = -1
.head 7 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 7 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 2048 )
.head 6 -  !
.head 6 -  Call SalFilePutStr ( hFileIn, QE_CreateInsertStmt(nTmp, 3, sREPORTSfields, nREPORTSnum, nFixRepNumber))
.head 6 -  !
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 +  While SalStrScan ( sFileLine, '</Insert_stmt>' ) = -1
.head 7 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 7 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 2048 )
.head 6 -  !
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 6 +  While SalStrScan ( sFileLine, '</Reports_insert>' ) = -1
.head 7 +  If (SalStrScan(sFileLine,'NEW_R')>-1 ) and (nFixRepNumber)
.head 8 -  Set sFileLine= VisStrSubstitute(sFileLine, "NEW_R",
                       "'"||SalNumberToStrX(nFixRepNumber,0)||"'")
.head 7 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 7 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  Else 
.head 6 +  While SalStrScan ( sFileLine, '</Reports_insert>' ) = -1
.head 7 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '<Reports_comm>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 -  !
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '</Reports_comm>' ) = -1
.head 6 +  If (SalStrScan(sFileLine,'REP_NAME')>-1 )
.head 7 -  Set sFileLine= VisStrSubstitute(sFileLine, "REP_NAME", '"'||sExpQryName||'"')
.head 7 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 +  Else If (SalStrScan(sFileLine,'NEW_R')>-1 ) and (nFixRepNumber)
.head 7 -  Set sFileLine= VisStrSubstitute(sFileLine, "NEW_R",
                       "'"||SalNumberToStrX(nFixRepNumber,0)||"'")
.head 7 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 +  Else 
.head 7 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 -  !
.head 5 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 +  While SalStrScan ( sFileLine, '</Export_Template>' ) = -1
.head 6 -  Call SalFilePutStr ( hFileIn, sFileLine )
.head 6 -  Call SalFileGetStr ( hFileTmpl, sFileLine, 1024 )
.head 5 -  !
.head 5 -  !
.head 5 +  ! If not SalFileClose ( hFileIn )
.head 6 -   Call SalMessageBox(' Не возможно закрыть файл ', 'Внимание!',0)
.head 6 -   Call SalWaitCursor (FALSE )
.head 6 -   Return -1
.head 5 +  If not SalFileClose ( hFileTmpl )
.head 6 -  Call SalMessageBox(' Не возможно закрыть файл ', 'Внимание!',0)
.head 6 -  Call SalWaitCursor (FALSE )
.head 6 -  Return -1
.head 5 -  !
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return 0
.head 3 +  ! Function: QE_CreateInsertStmt
.head 4 -  Description: ! Создает строку для вставки в файл экспорта с данными
.head 4 +  Returns 
.head 5 -  Long String: 
.head 4 +  Parameters 
.head 5 -  Number: nPar
.head 5 -  Number: nInsertType    !-- =1 - главный	запрос
                       !-- =2 - связанный запрос
                       !-- =3 - строка всктавки в reports
.head 5 -  String: sInsFields[*,2] !-- наименование поля, тип поля
.head 5 -  Number: nInsFieldsNum
.head 5 -  Number: nFixRepNumber
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sTmp
.head 5 -  Number: i
.head 5 -  Number: nTmp
.head 5 -  Long String: sInsertValues
.head 5 -  Long String: sSQLExpr
.head 5 -  Long String: sSQLExprTmp
.head 5 -  Long String: sInsertFields
.head 5 -  Long String: sInitLONGVars
.head 5 -  Number: nFetchRes
.head 4 +  Actions 
.head 5 -  Set sInsertValues = ''
.head 5 -  Set sInsertFields = ''
.head 5 -  Set sInitLONGVars = ''
.head 5 -  !
.head 5 -  ! Инициализируем переменные кот. являются типом CLOB
.head 5 +  If nInsertType < 3
.head 6 -  Set i = 0
.head 6 +  While i < nInsFieldsNum
.head 7 +  If sInsFields[i,1] = 'L'
.head 8 -  Set sSQLExpr = ''
.head 8 -  Set sSQLExprTmp = GetStringFromClob(hSql(), 'zapros', 'kodz', SalStrTrimX(sInsFields[i,0]), nPar, '', '')
.head 8 -  !
.head 8 -  Set sSQLExprTmp = VisStrSubstitute( sSQLExprTmp, "'", "''" )
.head 8 -  ! Разобьем строку запроса на строки и добавим перевод каретки + конец строки
.head 8 -  ! Заменяю x0D0A на chr(13)||chr(10)
.head 8 -  Set sSQLExprTmp = VisStrSubstitute( sSQLExprTmp,
SalNumberToChar(13) || SalNumberToChar(10),
" '||chr(13)||chr(10)||" || SalNumberToChar(13) || SalNumberToChar(10) || "'" )
.head 8 -  Set sSQLExpr = sSQLExpr || "'" || sSQLExprTmp || "'"
.head 8 -  Set sInitLONGVars = sInitLONGVars||"     "||sInsFields[i,0]||"_long_type:="||sSQLExpr||";"||PutCrLf()
.head 7 -  Set i = i + 1
.head 6 -  Set sInitLONGVars = PutCrLf()||sInitLONGVars
.head 5 -  !
.head 5 -  ! "Обвернем" переменные в функции преобразования типов
.head 5 -  Set i = 0
.head 5 +  If sInsFields[i,1] = 'N'
.head 6 -  Set sInsertFields = "nvl(to_char("||sInsFields[i,0]||"),'NULL')"
.head 5 +  Else If sInsFields[i,1] = 'V'
.head 6 -  Set sInsertFields= "'@@'||nvl("||sInsFields[i,0]||",'NULL')||'@@'"
.head 5 -  Set i = i + 1
.head 5 +  While i < nInsFieldsNum - 1
.head 6 -  Set sTmp = ""
.head 6 +  If sInsFields[i,1] = 'N'
.head 7 -  Set sTmp = "||','||nvl(to_char("||sInsFields[i,0]||"),'NULL')"
.head 6 +  Else If sInsFields[i,1]='V'
.head 7 -  Set sTmp = "||',@@'||nvl("||sInsFields[i,0]||",'NULL')||'@@'"
.head 6 -  Set sInsertFields = sInsertFields||sTmp
.head 6 -  Set i = i + 1
.head 5 -  !
.head 5 -  ! Заменим переменную "номер запроса" - значением
.head 5 +  If nInsertType = 1
.head 6 -  Set sInsertFields = StrReplaceChr(sInsertFields, "nvl(to_char(KODZ),'NULL')", "'NEW_Z'",  1)
.head 6 -  Set sInsertFields = StrReplaceChr(sInsertFields, "nvl(to_char(KODR),'NULL')", "'NEW_Z2'", 1)
.head 5 +  If nInsertType = 2
.head 6 -  Set sInsertFields = StrReplaceChr(sInsertFields, "nvl(to_char(KODZ),'NULL')", "'NEW_Z2'", 1)
.head 5 +  If nInsertType = 3
.head 6 -  Set sInsertFields= StrReplaceChr(sInsertFields, "nvl(to_char(ID),'NULL')",
    IifS(nFixRepNumber, SalNumberToStrX(nFixRepNumber,0), "'NEW_R'"),1)
.head 6 -  Set sInsertFields= StrReplaceChr(sInsertFields, "nvl(PARAM,'NULL')",
    "'NEW_Z||'||substr(param, instr(param,','))",1)

.head 5 -  !
.head 5 -  ! Выберем поля из ZAPROS-а кот. нужно экспортировать
.head 5 +  If SqlPrepareAndExecute(hSql(),
 " SELECT "|| sInsertFields ||
  " INTO :sInsertValues FROM  "||IifS(nInsertType<3, "zapros", "reports")||
  " WHERE "||IifS(nInsertType<3,"kodz","id")||"=:nPar" )
.head 6 -  Call SqlFetchNext(hSql(),nFetchRes)
.head 5 -  Set sInsertValues = StrReplaceChr(sInsertValues, "@@NEW_Z||",  "NEW_Z||@@",0)
.head 5 -  Set sInsertValues = StrReplaceChr(sInsertValues, "@@NULL@@",  "NULL",0)
.head 5 -  Set sInsertValues = StrReplaceChr(sInsertValues, "'",  "''",0)
.head 5 -  Set sInsertValues = StrReplaceChr(sInsertValues, "@@",  "'",0)
.head 5 -  !
.head 5 -  ! -- Добавим переменные, которые являются значениями полей CLOB (текст запроса)
.head 5 +  If nInsertType < 3
.head 6 -  Set i = 0
.head 6 +  While i < nInsFieldsNum
.head 7 +  If sInsFields[i,1] = 'L'
.head 8 -  Set sInsertValues = sInsertValues||", "|| sInsFields[i,0]||"_long_type "
.head 7 -  Set i=i+1
.head 5 -  !
.head 5 -  Set sInsertFields = sInsFields[0,0]
.head 5 -  Set i = 1
.head 5 +  While i < nInsFieldsNum-1
.head 6 +  If (sInsFields[i,1] != 'L')
.head 7 -  Set sInsertFields = sInsertFields||','||sInsFields[i,0]
.head 6 -  Set i=i+1
.head 5 -  Set i = 0
.head 5 +  While i < nInsFieldsNum
.head 6 +  If (sInsFields[i,1] = 'L')
.head 7 -  Set sInsertFields = sInsertFields||','||sInsFields[i,0]
.head 6 -  Set i=i+1
.head 5 -  !
.head 5 -  Return sInitLONGVars||"     insert into "||IifS(nInsertType<3, "zapros", "reports")|| "(" ||
             sInsertFields||")"||PutCrLf()||"     values("||sInsertValues||");"
         
.head 3 +  ! Function: QE_CreateUpdateStmt
.head 4 -  Description: ! Создает строку для вставки в файл экспорта с данными
.head 4 +  Returns 
.head 5 -  Long String: 
.head 4 +  Parameters 
.head 5 -  Number: nPar
.head 5 -  Number: nUpdateType    !-- =1 - главный	запрос
                       !-- =2 - связанный запрос
                       !-- =3 - строка всктавки в reports
.head 5 -  String: sUpdFields[*,2] !-- наименование поля, тип поля
.head 5 -  Number: nUpdFieldsNum   !-- кол-во полей
.head 5 -  Number: nFixRepNumber
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: sTmp
.head 5 -  Number: i
.head 5 -  Number: nTmp
.head 5 -  Long String: sSQLExpr
.head 5 -  Long String: sSQLExprTmp
.head 5 -  Long String: sUpdateValues
.head 5 -  Long String: sUpdateFields
.head 5 -  String: sPkey
.head 5 -  Long String: sInitLONGVars
.head 5 -  Number: nFetchRes
.head 4 +  Actions 
.head 5 -  Set sInitLONGVars = ''
.head 5 -  !
.head 5 -  ! "Обвернем" переменные в функции преобразования типов
.head 5 -  Set i=0
.head 5 +  While i < nUpdFieldsNum - 1
.head 6 -  Set sTmp = ""
.head 6 -  !
.head 6 -  ! Имя файла выгрузки не вносить - это не параметр эталона!!!!
.head 6 +  If SalStrUpperX(sUpdFields[i,0])!='NAMEF'
.head 7 +  If sUpdFields[i,1] = 'N'
.head 8 +  If SalStrUpperX(sUpdFields[i,0]) ='KODZ' or SalStrUpperX(sUpdFields[i,0]) ='KODR'
.head 9 -  Set sTmp = "'"||sUpdFields[i,0]||"='||'"||sUpdFields[i,0]||"'||','||"
.head 8 +  Else 
.head 9 -  Set sTmp = "'"||sUpdFields[i,0]||"='||"||"nvl(to_char("||sUpdFields[i,0]||"),'NULL')" || "||','||"
.head 7 +  Else If sUpdFields[i,1]='V'
.head 8 -  Set sTmp = "'"||sUpdFields[i,0]||"='||"||"'@@'||nvl("||sUpdFields[i,0]||",'NULL')||'@@' "|| "||','||"
.head 6 -  Set sUpdateFields = sUpdateFields||sTmp
.head 6 -  Set i = i + 1
.head 5 -  ! Убарть последний сивол ||
.head 5 -  Set sUpdateFields = SalStrLeftX(sUpdateFields, SalStrLength(sUpdateFields)-2)
.head 5 -  !
.head 5 -  !
.head 5 -  ! Выберем поля из ZAPROS-а кот. нужно экспортировать
.head 5 +  If SqlPrepareAndExecute(hSql(),
 " SELECT pkey, "|| sUpdateFields ||
  " INTO :sPkey, :sUpdateValues FROM  "||IifS(nUpdateType<3, "zapros", "reports")||
  " WHERE "||IifS(nUpdateType<3,"kodz","id")||"=:nPar" )
.head 6 -  Call SqlFetchNext(hSql(),nFetchRes)
.head 5 -  !
.head 5 -  Set sUpdateValues = StrReplaceChr(sUpdateValues, "@@NEW_Z||",  "NEW_Z||@@",0)
.head 5 -  Set sUpdateValues = StrReplaceChr(sUpdateValues, "@@NULL@@",  "NULL",0)
.head 5 -  Set sUpdateValues = StrReplaceChr(sUpdateValues, "'",  "''",0)
.head 5 -  Set sUpdateValues = StrReplaceChr(sUpdateValues, "@@",  "'",0)
.head 5 -  !
.head 5 -  ! -- Добавим переменные, которые являются значениями полей CLOB (текст запроса)
.head 5 +  If nUpdateType < 3
.head 6 -  Set i = 0
.head 6 +  While i < nUpdFieldsNum
.head 7 +  If sUpdFields[i,1] = 'L'
.head 8 -  Set sUpdateValues = sUpdateValues || sUpdFields[i,0]||"="||sUpdFields[i,0]||"_long_type,"
.head 7 -  Set i=i+1
.head 6 -  ! Убарть последнюю запятую
.head 6 -  Set sUpdateValues = SalStrLeftX(sUpdateValues, SalStrLength(sUpdateValues)-1)
.head 5 -  !
.head 5 -  Return sInitLONGVars||"     update "||IifS(nUpdateType<3, "zapros", "reports")|| " set " ||PutCrLf()||
                      "     "||sUpdateValues||" where pkey='"||sPkey||"';"
         
.head 3 +  ! Function: QE_makeExportToFile
.head 4 -  Description: Экспорт SQL сценария в файл
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  ! Код запроса
.head 5 -  Number: nExpQry
.head 5 -  ! Создавать ли запись в таблице печ. отчентов (reports)
.head 5 -  Number: nIsCreateRep
.head 5 -  ! Код фиксированого отчета
.head 5 -  Number: nRepFixNumber
.head 5 -  ! Формат печатного отчета 
.head 5 -  Number: nRepFormat
.head 5 -  ! Дописывать или создать новый файл (OF_Append, OF_Create)
.head 5 -  Number: nFileOpenMode
.head 5 -  ! Полный путь к файлу
.head 5 -  String: sFilePathName
.head 5 -  ! Ошибка выполнения
.head 5 -  Receive String: sErrMsg
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bRes
.head 4 +  Actions 
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  If not SqlPLSQLCommand(hSql(),"bars_report.export_to_script(nExpQry, nIsCreateRep, nFixRepNumber, nRepFormat)")
.head 6 -  Set sErrMsg = Ошибка формирования SQL сценария для кат. запроса
.head 6 -  Return FALSE
.head 5 +  Else 
.head 6 +  If nFileOpenMode = OF_Create
.head 7 -  Set bRes = PutLoadedBlobToFile(hSql(),sFilePathName)
.head 6 +  If nFileOpenMode = OF_Append
.head 7 -  Set bRes = AppendLoadedBlobToFile(hSql(),sFilePathName)
.head 6 -  !
.head 6 +  If not bRes
.head 7 -  Set sErrMsg = Ошибка выгрузки SQL сценария для кат. запроса в файл
.head 7 -  Return FALSE
.head 5 -  !
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return TRUE
.head 3 +  ! Function: QE_makeExport
.head 4 -  Description: Экспорт SQL сценария в файл.
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  ! Коды запросов
.head 5 -  Number: nExpQry[*]
.head 5 -  ! Кол-во запросов для экспорта
.head 5 -  Number: nQryCnt
.head 5 -  ! Создавать ли запись в таблице печ. отчентов (reports) -  если  nQryCnt > 1 - игнорируется. 
! Запись о печатном отчете- не делается
.head 5 -  Number: nIsCreateRep
.head 5 -  ! Код фиксированого отчета -  если  nQryCnt > 1 - игнорируется
.head 5 -  Number: nRepFixNumber
.head 5 -  ! Формат печатного отчета  -  если  nQryCnt > 1 - игнорируется
.head 5 -  Number: nRepFormat
.head 5 -  ! Дописывать или создать новый файл (OF_Append, OF_Create)
.head 5 -  Number: nFileOpenMode
.head 5 -  ! Полный путь, где создавать файл
.head 5 -  String: sFilePathName
.head 5 -  ! Ошибка выполнения
.head 5 -  Receive String: sErrMsg
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bRes
.head 4 +  Actions 
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  If not SqlPLSQLCommand(hSql(),"bars_report.export_to_script(nExpQry, nIsCreateRep, nFixRepNumber, nRepFormat)")
.head 6 -  Set sErrMsg = Ошибка формирования SQL сценария для кат. запроса
.head 6 -  Return FALSE
.head 5 +  Else 
.head 6 +  If nFileOpenMode = OF_Create
.head 7 -  Set bRes = PutLoadedBlobToFile(hSql(),sFilePathName)
.head 6 +  If nFileOpenMode = OF_Append
.head 7 -  Set bRes = AppendLoadedBlobToFile(hSql(),sFilePathName)
.head 6 -  !
.head 6 +  If not bRes
.head 7 -  Set sErrMsg = Ошибка выгрузки SQL сценария для кат. запроса в файл
.head 7 -  Return FALSE
.head 5 -  !
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return TRUE
.head 3 +  ! Function: QE_makeExport
.head 4 -  Description: Экспорт SQL сценария в файл.
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  ! Коды запросов
.head 5 -  Number: nExpQry[*]
.head 5 -  ! Кол-во запросов для экспорта
.head 5 -  Number: nQryCnt
.head 5 -  ! Создавать ли запись в таблице печ. отчентов (reports) -  если  nQryCnt > 1 - игнорируется. 
! Запись о печатном отчете- не делается
.head 5 -  Number: nIsCreateRep
.head 5 -  ! Код фиксированого отчета -  если  nQryCnt > 1 - игнорируется
.head 5 -  Number: nRepFixNumber
.head 5 -  ! Формат печатного отчета  -  если  nQryCnt > 1 - игнорируется
.head 5 -  Number: nRepFormat
.head 5 -  ! Дописывать или создать новый файл (OF_Append, OF_Create)
.head 5 -  Number: nFileOpenMode
.head 5 -  ! Полный путь, где создавать файл
.head 5 -  String: sFilePathName
.head 5 -  ! Ошибка выполнения
.head 5 -  Receive String: sErrMsg
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bRes
.head 4 +  Actions 
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  If not SqlPLSQLCommand(hSql(),"bars_report.export_to_script(nExpQry, nIsCreateRep, nFixRepNumber, nRepFormat)")
.head 6 -  Set sErrMsg = Ошибка формирования SQL сценария для кат. запроса
.head 6 -  Return FALSE
.head 5 +  Else 
.head 6 +  If nFileOpenMode = OF_Create
.head 7 -  Set bRes = PutLoadedBlobToFile(hSql(),sFilePathName)
.head 6 +  If nFileOpenMode = OF_Append
.head 7 -  Set bRes = AppendLoadedBlobToFile(hSql(),sFilePathName)
.head 6 -  !
.head 6 +  If not bRes
.head 7 -  Set sErrMsg = Ошибка выгрузки SQL сценария для кат. запроса в файл
.head 7 -  Return FALSE
.head 5 -  !
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return TRUE
.head 3 +  ! Function: QE_ExpAllToSingleFile
.head 4 -  Description: Экспорт SQL сценариев в один файл.
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  ! Коды запросов
.head 5 -  Number: nExpQry[*]
.head 5 -  ! Кол-во запросов для экспорта
.head 5 -  Number: nQryCnt
.head 5 -  ! Создавать ли запись в таблице печ. отчентов (reports) -  если  nQryCnt > 1 - игнорируется. 
! Запись о печатном отчете- не делается
.head 5 -  Number: nIsCreateRep
.head 5 -  ! Код фиксированого отчета -  если  nQryCnt > 1 - игнорируется
.head 5 -  Number: nRepFixNumber
.head 5 -  ! Формат печатного отчета  -  если  nQryCnt > 1 - игнорируется
.head 5 -  Number: nRepFormat
.head 5 -  ! Дописывать или создать новый файл (OF_Append, OF_Create)
.head 5 -  Number: nFileOpenMode
.head 5 -  ! Полный путь, где создавать файл
.head 5 -  String: sFilePathName
.head 5 -  ! Ошибка выполнения
.head 5 -  Receive String: sErrMsg
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bRes
.head 4 +  Actions 
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  If not SqlPLSQLCommand(hSql(),"bars_report.export_to_script(nExpQry, nIsCreateRep, nFixRepNumber, nRepFormat)")
.head 6 -  Set sErrMsg = Ошибка формирования SQL сценария для кат. запроса
.head 6 -  Return FALSE
.head 5 +  Else 
.head 6 +  If nFileOpenMode = OF_Create
.head 7 -  Set bRes = PutLoadedBlobToFile(hSql(),sFilePathName)
.head 6 +  If nFileOpenMode = OF_Append
.head 7 -  Set bRes = AppendLoadedBlobToFile(hSql(),sFilePathName)
.head 6 -  !
.head 6 +  If not bRes
.head 7 -  Set sErrMsg = Ошибка выгрузки SQL сценария для кат. запроса в файл
.head 7 -  Return FALSE
.head 5 -  !
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return TRUE
.head 3 +  ! Function: QE_ExpAllToOwnFiles
.head 4 -  Description: Экспорт SQL сценария в файл.
.head 4 +  Returns 
.head 5 -  Boolean: 
.head 4 +  Parameters 
.head 5 -  ! Коды запросов
.head 5 -  Number: nExpQry[*]
.head 5 -  ! Кол-во запросов для экспорта
.head 5 -  Number: nQryCnt
.head 5 -  ! Создавать ли запись в таблице печ. отчентов (reports) -  если  nQryCnt > 1 - игнорируется. 
! Запись о печатном отчете- не делается
.head 5 -  Number: nIsCreateRep
.head 5 -  ! Код фиксированого отчета -  если  nQryCnt > 1 - игнорируется
.head 5 -  Number: nRepFixNumber
.head 5 -  ! Формат печатного отчета  -  если  nQryCnt > 1 - игнорируется
.head 5 -  Number: nRepFormat
.head 5 -  ! Дописывать или создать новый файл (OF_Append, OF_Create)
.head 5 -  Number: nFileOpenMode
.head 5 -  ! Полный путь, где создавать файл
.head 5 -  String: sFilePathName
.head 5 -  ! Ошибка выполнения
.head 5 -  Receive String: sErrMsg
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Boolean: bRes
.head 4 +  Actions 
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  If not SqlPLSQLCommand(hSql(),"bars_report.export_to_script(nExpQry, nIsCreateRep, nFixRepNumber, nRepFormat)")
.head 6 -  Set sErrMsg = Ошибка формирования SQL сценария для кат. запроса
.head 6 -  Return FALSE
.head 5 +  Else 
.head 6 +  If nFileOpenMode = OF_Create
.head 7 -  Set bRes = PutLoadedBlobToFile(hSql(),sFilePathName)
.head 6 +  If nFileOpenMode = OF_Append
.head 7 -  Set bRes = AppendLoadedBlobToFile(hSql(),sFilePathName)
.head 6 -  !
.head 6 +  If not bRes
.head 7 -  Set sErrMsg = Ошибка выгрузки SQL сценария для кат. запроса в файл
.head 7 -  Return FALSE
.head 5 -  !
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return TRUE
.head 3 -  !
.head 3 +  Function: QE_ExpOneQuery
.head 4 -  Description: Экспорт SQL сценария в файл.
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  ! Код запроса
.head 5 -  Number: nExpQry
.head 5 -  ! Создавать ли запись в таблице печ. отчентов (reports) -  если  nQryCnt > 1 - игнорируется. 
! Запись о печатном отчете- не делается
.head 5 -  Number: nIsCreateRep
.head 5 -  ! Код фиксированого отчета -  если  nQryCnt > 1 - игнорируется
.head 5 -  Number: nRepFixNumber
.head 5 -  ! Формат печатного отчета  -  если  nQryCnt > 1 - игнорируется
.head 5 -  Number: nRepFormat
.head 5 -  ! Номер папки отчета
.head 5 -  Number: nRepFolder
.head 5 -  ! Дописывать или создать новый файл (OF_Append, OF_Create)
.head 5 -  Number: nFileOpenMode
.head 5 -  ! Полный путь к файлу
.head 5 -  String: sFilePathName
.head 5 -  ! Ошибка выполнения
.head 5 -  Receive String: sErrMsg
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: bRes
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 +  If not SqlPLSQLCommand(hSql(),"bars_report.export_to_script(nExpQry, nIsCreateRep, nRepFixNumber, nRepFormat, nRepFolder)")
.head 6 -  Set sErrMsg = 'Ошибка формирования SQL сценария для кат. запроса'
.head 6 -  Return FALSE
.head 5 +  Else
.head 6 +  If not PutTmpLobToFile(hSql(), sFilePathName, 'C', nFileOpenMode)
.head 7 -  Set sErrMsg = 'Ошибка выгрузки SQL сценария для кат. запроса в файл'
.head 7 -  Return FALSE
.head 5 -  !
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return TRUE
.head 3 +  Function: QE_ExpSelectedQueries
.head 4 -  Description: Экспорт SQL сценариев.
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  ! Коды запросов
.head 5 -  Number: nExpQry[*]
.head 5 -  ! Кол-во запросов для экспорта
.head 5 -  Number: nQryCnt
.head 5 -  ! Полный путь, где создавать файлы (или путь + имя файла для генерации в один файл)
.head 5 -  String: sFilePath
.head 5 -  ! Создавать в один файл или в несколько
.head 5 -  Boolean: bIsSingleFile
.head 5 -  ! Ошибка выполнения
.head 5 -  Receive String: sErrMsg
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: bRes
.head 5 -  Number: i
.head 5 -  String: sFileNamePath
.head 5 -  String: sFileName
.head 5 -  Number: nFileOpenMode
.head 5 -  Number: nRepFolder
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set i=1
.head 5 -  Set nFileOpenMode = IifN(bIsSingleFile, OF_Append, OF_Create)
.head 5 -  !
.head 5 -  Set sFileNamePath = sFilePath
.head 5 +  While i <= nQryCnt
.head 6 +  If not bIsSingleFile 
.head 7 -  Set sFileName =  QE_GetExpFileNameById(nExpQry[i])
.head 7 +  If sFileName = STRING_Null
.head 8 -  Return FALSE
.head 7 -  Set sFileNamePath = sFilePath || '\\' || sFileName
.head 7 +  If SqlPrepareAndExecute(hSql(),"
      select bars_report.get_report_folder(:nExpQry[i])
        into :nRepFolder 
        from dual")
.head 8 -  Call SqlFetchNext(hSql(),nTmp)
.head 6 -  Call QE_ExpOneQuery(nExpQry[i], 0, NUMBER_Null, NUMBER_Null, nRepFolder, nFileOpenMode, sFileNamePath, sErrMsg)
.head 6 -  Set i=i+1
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Return TRUE
.head 3 -  !
.head 3 -  ! Вспомогательные функции для создания экспортных SQL сценариев
.head 3 +  Function: SG_CheckOption
.head 4 -  Description: Проверка опции
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  ! Все опции
.head 5 -  Number: nOptions
.head 5 -  ! Проверяемая опция
.head 5 -  Number: nOption
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return nOptions & nOption
.head 3 +  Function: SG_WrapCommand
.head 4 -  Description: Оформление выражения в строку с обхватом ее BEGIN-END`ом
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Выражение Declare
.head 5 -  String: strVariables
.head 5 -  ! Оформляемая команда или группа команд
.head 5 -  String: strCommand
.head 5 -  ! Отступ в пробелах
.head 5 -  Number: nIdent
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: Result
.head 4 +  Actions
.head 5 -  Set Result=''
.head 5 +  If strVariables
.head 6 -  Set Result = Result || 
"declare" || PutCrLf() || SG_IndentedResult(strVariables,2) || PutCrLf()
.head 5 -  Set Result=Result || 
"begin" || PutCrLf() || SG_IndentedResult(strCommand,2) || PutCrLf() || "end;" || PutCrLf()
.head 5 -  Return SG_IndentedResult( Result, nIdent )
.head 3 +  Function: SG_WrapCommandExcept
.head 4 -  Description: Оформление выражения в строку с обхватом ее BEGIN-EXCEPTION-END`ом и выводом сообщения в случае ошибки
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Оформляемая команда или группа команд
.head 5 -  String: strCommand
.head 5 -  ! Сообщение об успешном выполнении
.head 5 -  String: strSuccessMessage
.head 5 -  ! Сообщение об ошибке
.head 5 -  String: strErrorMessage
.head 5 -  ! Отступ в пробелах
.head 5 -  Number: nIdent
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: Result
.head 5 -  !
.head 5 -  String: strSuccessMessageX
.head 5 -  String: strErrorMessageX
.head 4 +  Actions
.head 5 -  Set Result=''
.head 5 +  If strSuccessMessage
.head 6 -  Set strSuccessMessageX="  DBMS_OUTPUT.PUT_LINE('" || strSuccessMessage || "');
"
.head 5 +  Else
.head 6 -  Set strSuccessMessageX=""
.head 5 +  If strErrorMessage
.head 6 -  Set strErrorMessageX="  WHEN OTHERS THEN 
    DBMS_OUTPUT.PUT_LINE('" || strErrorMessage || "');
"
.head 5 +  Else
.head 6 -  Set strErrorMessageX="  WHEN OTHERS THEN NULL;
"
.head 5 -  Set Result=Result || 
"BEGIN
" || SG_IndentedResult(strCommand,2) || strSuccessMessageX ||
"
EXCEPTION
" || strErrorMessageX || 
"END;
"
.head 5 -  Return SG_IndentedResult( Result, nIdent )
.head 3 +  Function: SG_IndentedResult
.head 4 -  Description: Добавление отступа в строку
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Строка, в которую добавляется отступ
.head 5 -  String: strValue
.head 5 -  ! Отступ
.head 5 -  Number: nIndent
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return SalStrRepeatX( ' ', nIndent ) || 
VisStrSubstitute( strValue, '
', '
' || SalStrRepeatX( ' ', nIndent ) )
.head 3 +  ! Function: SG_Insert
.head 4 -  Description: Генерация выражения на вставку
.head 4 +  Returns 
.head 5 -  String: 
.head 4 +  Parameters 
.head 5 -  ! EXCEPTION:
  0 - when DUP_VAL_ON_INDEX then null,
  2 - when DUP_VAL_ON_INDEX then null
    + ORA-02291: integrity constraint violated - parent key not found
.head 5 -  Number: nMode
.head 5 -  ! Имя таблицы
.head 5 -  String: strTableName
.head 5 -  ! Список колонок
.head 5 -  String: strColName[*]
.head 5 -  ! Список типов колонок
.head 5 -  Number: nColType[*]
.head 5 -  ! Строковые значения колонок
.head 5 -  String: strColValue[*]
.head 5 -  ! Числовые значения колонок
.head 5 -  Number: nColValue[*]
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  Number: i
.head 5 -  Number: iL
.head 5 -  !
.head 5 -  String: strColList
.head 5 -  String: strColValuesList
.head 4 +  Actions 
.head 5 -  Call SalArrayGetUpperBound(strColName, 1, iL)
.head 5 -  Set i = 0
.head 5 -  Set strColList = ''
.head 5 -  Set strColValuesList = ''
.head 5 +  While i <= iL
.head 6 +  If strColName[i]
.head 7 +  If (nColType[i]=1 AND strColValue[i]) OR
   (nColType[i]=2 AND nColValue[i]!=NUMBER_Null)
.head 8 +  If strColList
.head 9 -  Set strColList = strColList || ','
.head 9 -  Set strColValuesList = strColValuesList || ','
.head 8 -  Set strColList = strColList || strColName[i]
.head 8 +  If nColType[i] = 2
.head 9 -  Set strColValuesList = strColValuesList || SalNumberToStrX(nColValue[i], 0)
.head 8 +  Else 
.head 9 -  Set strColValuesList = strColValuesList || "'" || SG_CorrectScriptStr(strColValue[i]) || "'"
.head 6 +  Else 
.head 7 -  Break 
.head 6 -  Set i=i+1
.head 5 -  Return 
"BEGIN
  INSERT INTO " || strTableName || "(" || strColList || ")
  VALUES (" || strColValuesList || ");
EXCEPTION
  WHEN DUP_VAL_ON_INDEX THEN NULL;" || IifS(nMode=2, "
  WHEN OTHERS THEN 
    IF SQLCODE=-02291 THEN 
      DBMS_OUTPUT.PUT_LINE('Не удалось добавить запись (" || 
      strTableName || ": " || VisStrSubstitute(strColValuesList, "'", "''") || 
      ") - первичный ключ не найден!');
    ELSE RAISE;
    END IF;", "") || "
END;
"
.head 3 +  Function: SG_Insert
.head 4 -  Description: Генерация выражения на вставку, и при ошибке на обновление
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! EXCEPTION:
  0 - when DUP_VAL_ON_INDEX then null,
  1 - when DUP_VAL_ON_INDEX then update,
  2 - when DUP_VAL_ON_INDEX then null
    + ORA-02291: integrity constraint violated - parent key not found
.head 5 -  Number: nMode
.head 5 -  ! Имя таблицы
.head 5 -  String: strTableName
.head 5 -  ! Список колонок
.head 5 -  String: strColName[*]
.head 5 -  ! Список типов колонок
.head 5 -  Number: nColType[*]
.head 5 -  ! Строковые значения колонок
.head 5 -  String: strColValue[*]
.head 5 -  ! Числовые значения колонок
.head 5 -  Number: nColValue[*]
.head 5 -  ! Условие для обновления
.head 5 -  String: strUpdCond
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: i
.head 5 -  Number: iL
.head 5 -  !
.head 5 -  String: strColList
.head 5 -  String: strColValuesList
.head 5 -  String: strUpdates
.head 4 +  Actions
.head 5 -  Call SalArrayGetUpperBound(strColName, 1, iL)
.head 5 -  Set i = 0
.head 5 -  Set strColList = ''
.head 5 -  Set strColValuesList = ''
.head 5 -  Set strUpdates = ''
.head 5 +  While i <= iL
.head 6 +  If strColName[i]
.head 7 +  If strColList
.head 8 -  Set strColList       = strColList       || ', '
.head 8 -  Set strColValuesList = strColValuesList || ', '
.head 8 -  Set strUpdates       = strUpdates       || ', '
.head 7 -  ! strColList
.head 7 -  Set strColList = strColList || strColName[i]
.head 7 -  ! strColValuesList
.head 7 +  If nColType[i] = 2
.head 8 -  Set strColValuesList = strColValuesList || 
    IifS(nColValue[i]=NUMBER_Null, "null", SalNumberToStrX(nColValue[i], 0))
.head 7 +  Else
.head 8 -  Set strColValuesList = strColValuesList || 
    IifS(strColValue[i]=STRING_Null, "null", "'" || SG_CorrectScriptStr(strColValue[i]) || "'")
.head 7 -  ! strUpdates
.head 7 +  If nColType[i] = 2
.head 8 -  Set strUpdates = strUpdates || strColName[i] || "=" ||
    IifS(nColValue[i]=NUMBER_Null, "null", SalNumberToStrX(nColValue[i], 0))
.head 7 +  Else
.head 8 -  Set strUpdates = strUpdates || strColName[i] || "=" ||
    IifS(strColValue[i]=STRING_Null, "null", "'" || SG_CorrectScriptStr(strColValue[i]) || "'")
.head 6 +  Else
.head 7 -  Break
.head 6 -  Set i = i + 1
.head 5 -  Return 
"begin
  insert into " || strTableName || "(" || strColList || ")
  values (" || strColValuesList || ");
exception" || 
IifS(nMode=0 or nMode=2, "
  when dup_val_on_index then null;", "") ||
IifS(nMode=1, "
  when dup_val_on_index then
    update " || strTableName || " set
      " || strUpdates || "
     where " || strUpdCond || ";", "") || 
IifS(nMode=2, "
  when others then 
    if ( sqlcode = -02291 ) then
      dbms_output.put_line('Не удалось добавить запись (" || 
      strTableName || ": " || VisStrSubstitute(strColValuesList, "'", "''") || 
      ") - первичный ключ не найден!');
    else raise;
    end if;", "") || "
end;
"
.head 3 +  Function: SG_CorrectScriptStr
.head 4 -  Description: Замена одинарных кавычек на две для нормального экспорта 
строковых значений в SQL сценарии
+
Замена перевода каретки (0D, 0A) на функции CHR для корректной передачи 
многостроковых строк через сценарии

.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Строковое значение поля
.head 5 -  String: strValue
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: Result
.head 4 +  Actions
.head 5 -  Set Result=VisStrSubstitute( strValue, "'", "''" )
.head 5 -  Set Result=VisStrSubstitute( Result, 
SalNumberToChar(13)||SalNumberToChar(10), 
"'||CHR(13)||CHR(10)||" ||
SalNumberToChar(13)||SalNumberToChar(10)||"'"
 )
.head 5 -  Return Result
.head 3 -  !
.head 3 +  Function: ShowRef        ! __exported
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nMode
.head 5 -  Number: nPar
.head 5 -  String: strPar01
.head 5 -  String: strPar02
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call IniReferenc()
.head 5 +  Select Case nMode
.head 6 +  Case 0          ! New BOA-KONSTRUKTOR
.head 7 +  If not IsWindow(hTTS)
.head 8 -  Set hTTS = SalCreateWindow(frm_OperCard, hWndMDI, nMode, nPar, strPar01, strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( frm_OperCard )
.head 7 -  Break
.head 6 +  Case 1		! TICKETS_PAR
.head 7 +  If not IsWindow(hTPar)
.head 8 -  Set hTPar = SalCreateWindow(frm_TPar, hWndMDI, nMode, nPar, strPar01, strPar02)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( frm_TPar )
.head 7 -  Break
.head 6 +  Case 2		! HOLIDAY
.head 7 -  Call FunHoliday(hWndParent, nPar, 0, strPar01, strPar02)
.head 7 -  Break
.head 6 +  Case 3		! TICKETS_PAR
.head 7 +  If not IsWindow(hTPar)
.head 8 -  Set hTPar = SalCreateWindow(frm_F13_ZBSK, hWndMDI)
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( frm_F13_ZBSK)
.head 7 -  Break
.head 6 +  Default
.head 7 -  Break
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 3063301029
0000: D9010000F1000000 0000000000000000 0200000300FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F41003C00 000D630052616469
0040: 6F4C69730074426F 7886000000F00500 0000E0010D000000 FF3F0D00B9000100
0060: FFFFE01A00000001 FE00FF8327000000 01FB00FF0F340000 00EE0100FF3F0180
0080: 0022000000010000 00000A6347656E46 696C007465727400 0000047800000002
00A0: 640400000100FFE0 8001000000DF04D8 00010D00FF7F1170 0000000200FFFFC1
00C0: 1500000001FD00FF C701802200000200 00000B6347E34446 69CF00049E000204
00E0: D1000100003F8001 F9000037040001F6 0D00FFDF11DC0002 00FF7F1573000100
0100: FFFF01
.enddata
.head 3 +  Functional Class: cLog
.head 4 -  Description:
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  File Handle: hFile
.head 4 +  Functions
.head 5 +  Function: Create
.head 6 -  Description: Создает лог.
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sFileName
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If SalFileOpen( hFile, sFileName, OF_Exist )
.head 8 -  Return SalFileOpen( hFile, sFileName, OF_Append | OF_ReadWrite | OF_Share_Exclusive )
.head 7 +  Else
.head 8 -  Return SalFileOpen( hFile, sFileName, OF_Create | OF_ReadWrite | OF_Share_Exclusive )
.head 5 +  Function: Free
.head 6 -  Description: Закрывает лог
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Return SalFileClose( hFile )
.head 5 +  Function: PutLog
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sString
.head 7 -  Boolean: fPutDateTime
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sPutStr
.head 6 +  Actions
.head 7 +  If fPutDateTime
.head 8 -  Set sPutStr= SalFmtFormatDateTime( SalDateCurrent(), 
'dd/MM/yyyy hhhh:mm:ss' ) || ' ' ||
sString
.head 7 +  Else
.head 8 -  Set sPutStr=sString
.head 7 -  Return SalFilePutStr( hFile, sPutStr )
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field: cLabelControl
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton: cpbCancel
.head 3 -  Radio Button: cRadioButtonLabeled
.head 3 -  Option Button:
.head 3 -  Check Box: cCheckBoxLabeled
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box: cOutlineListBox
.head 3 -  Combo Box: cGenComboBox_NumId
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control: cXSalVSplitterInvisible
.head 2 -  Application Actions
.head 1 -  !
.head 1 +  Form Window: frm_RefList
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   1.1"
.head 4 -  Top:    0.917"
.head 4 -  Width:  8.417"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.25"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Список справочников с древовидным интерфейсом
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  List Box: lbReferences
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cOutlineListBox
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.043"
.head 5 -  Top:    0.042"
.head 5 -  Width:  7.871"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 4.219"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Multiple selection? Class Default
.head 4 -  Sorted? Yes
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 9
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: 3D Highlight Color
.head 4 -  Horizontal Scroll? Yes
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SetStyle( LBS_ShowNoTree | LBS_ShowHorzScrollBar | LBS_ShowSelectTextPicture | LBS_VisExtensions |  LBS_FmtMixedcase)
.head 6 -  Call nRefNodes.Init( )
.head 6 -  !
.head 6 -  Set hRoot = GetRoot()
.head 6 -  Set nNodeId = -1
.head 6 +  If hRoot
.head 7 -  ! Call nRefNodes.New( 0, hRoot, nNodeId, 'Справочники', 'ошибка построения меню, если видно', 0 )
.head 7 -  Call nRefNodes.New( 0, hRoot, nNodeId, 
  CurrentLangTable.GetAtomTitle('frm_RefList.cTWndTitle'), 
  CurrentLangTable.GetAtomTitle('frm_RefList.cTErrMenu'), '','', 0)
.head 7 -  Set strCurNodeName = ''
.head 7 -  Set sSecureWhere = ''
.head 7 +  If EnhancedSecurity()
.head 8 -  Set sSecureWhere = ' AND NVL(p.approve,0)=1 AND  date_is_valid(p.adate1,p.adate2,p.rdate1,p.rdate2)=1  '
.head 7 -  Call SqlPrepareAndExecute(hSql(), T('SELECT r.tabid, t.name, m.tabname, m.semantic, trim(p.acode)
    INTO :nTabID, :strRefGroup, :strRefTable, :strRefName, :strRefAccess
    FROM references r, refapp p, typeref t, meta_tables m
    WHERE r.tabid=m.tabid AND r.type=t.type AND p.tabid=r.tabid 
    AND p.codeapp = :strApplicationCode' || sSecureWhere  || '
    ORDER BY 2,4
'))
.head 7 +  While SqlFetchNext(hSql(), nFetchRes)
.head 8 +  If strRefGroup != strCurNodeName
.head 9 -  Set strCurNodeName = strRefGroup
.head 9 -  Set hCurNode = LoadChild( hRoot, hPicBookNormal, hPicBookOpen, strRefGroup, 0, 0 )
.head 9 -  Set nNodeId = nNodeId -1
.head 9 -  Call nRefNodes.New( nNodeId, hCurNode, 0, strRefGroup, '', '', '', 0)
.head 8 -  Set hPicItem = hPicItemRW
.head 8 +  If SalStrUpperX( strRefAccess ) = 'RO'
.head 9 -  Set hPicItem = hPicItemRO
.head 8 -  Set hItem =  LoadChild( hCurNode, hPicItem, hPicItem, strRefName, nTabID, 0 )
.head 8 -  Call nRefNodes.New( nTabID, hItem, nNodeId, strRefTable, strRefName, '', '', 1)
.head 7 -  Call lbReferences.ShowOutline( 0 )
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, wParam, lParam)
.head 6 -  Set nIndexItem = VisListGetFocusIndex( hWndItem )
.head 6 -  Call SalSendMsg( pbAction, SAM_User, nIndexItem, 0 )
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendClassMessage( SAM_DoubleClick, wParam, lParam)
.head 6 -  Set nIndexItem = VisListGetFocusIndex( hWndItem )
.head 6 -  Call SalSendMsg( pbAction, SAM_User, nIndexItem, 0 )
.head 6 -  Set nItemFlags = GetItemFlags( GetItemHandle( nIndexItem))
.head 6 +  If NOT (nItemFlags & ITEM_IsParent)
.head 7 -  Call SalSendMsg( pbAction, SAM_Click, nIndexItem, 0 )
.head 5 +  On VTM_KeyDown
.head 6 +  Select Case wParam
.head 7 +  Case VK_Right
.head 8 -  Set nIndexItem = VisListGetFocusIndex( hWndItem )
.head 8 -  Set nItemFlags = GetItemFlags( GetItemHandle( nIndexItem))
.head 8 +  If (nItemFlags & ITEM_IsParent) AND (nItemFlags & ITEM_CanExpand)
.head 9 -  Call SalSendClassMessage( SAM_DoubleClick, wParam, lParam)
.head 9 -  Call SalSendMsg( pbAction, SAM_User, nIndexItem, 0 )
.head 8 -  Break
.head 7 +  Case VK_Left
.head 8 -  Set nIndexItem = VisListGetFocusIndex( hWndItem )
.head 8 -  Set nItemFlags = GetItemFlags( GetItemHandle( nIndexItem))
.head 8 +  If (nItemFlags & ITEM_IsParent) AND (nItemFlags & ITEM_CanCollapse)
.head 9 -  Call SalSendClassMessage( SAM_DoubleClick, wParam, lParam)
.head 9 -  Call SalSendMsg( pbAction, SAM_User, nIndexItem, 0 )
.head 8 -  Break
.head 7 +  Case VK_Escape
.head 8 -  Call SalPostMsg(pbExit, SAM_Click, 0, 0)
.head 3 +  Pushbutton: pbAction
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Открыть
.head 4 -  Window Location and Size
.head 5 -  Left:   4.9"
.head 5 -  Top:    4.344"
.head 5 -  Width:  1.443"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\OPEN.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If wParam = 0
.head 7 -  Set nItemFlags = lbReferences.GetItemFlags( lbReferences.GetItemHandle( nIndexItem ))
.head 7 +  If (nItemFlags & ITEM_IsParent)
.head 8 +  If (nItemFlags & ITEM_CanExpand)
.head 9 -  Call VisListExpand( lbReferences, nIndexItem )
.head 9 -  ! Call SalSetWindowText( hWndItem, 'Закрыть')
.head 9 -  Call SalSetWindowText( hWndItem, CurrentLangTable.GetAtomTitle('frm_RefList.cTClose'))
.head 8 +  Else If (nItemFlags & ITEM_CanCollapse)
.head 9 -  Call VisListCollapse( lbReferences, nIndexItem )
.head 9 -  ! Call SalSetWindowText( hWndItem, 'Открыть')
.head 9 -  Call SalSetWindowText( hWndItem, CurrentLangTable.GetAtomTitle('frm_RefList.pbAction'))
.head 8 -  Return FALSE
.head 6 -  Set strRefTable = nRefNodes.GetName( lbReferences.GetItemValue( lbReferences.GetItemHandle( nIndexItem )) )
.head 6 -  Set nTabID = lbReferences.GetItemValue( lbReferences.GetItemHandle( nIndexItem ))
.head 6 -  !
.head 6 -  Call SqlPrepareAndExecute( hSql(), T('SELECT trim(dlgname), trim(role2edit) INTO :strRefDlgName, :strRefRole2Edit  FROM references WHERE tabid = :nTabID' )) 
.head 6 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 6 -  !
.head 6 -  Call SqlPrepareAndExecute( hSql(), T('SELECT trim(acode) INTO :strRefAccess FROM refapp 
    WHERE tabid = :nTabID AND codeapp=:strApplicationCode' )) 
.head 6 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 6 -  !
.head 6 -  ! Call SalMessageBox( 'Table: ' || strRefTable || ' TabID: ' || SalNumberToSt
' Dialog: ' || strRefDlgName, 'Debug', 0)
.head 6 +  If strRefDlgName = '' OR strRefDlgName = STRING_Null
.head 7 -  ! Установка роли
.head 7 +  If strRefRole2Edit != '' 
.head 8 +  If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
.head 9 -  Call XRoleSet(hSql(), strRefTable, strRefRole2Edit)
.head 8 +  Else
.head 9 -  Call SqlPrepareAndExecute(hSql(), 'SET ROLE ' || strRefRole2Edit)
.head 7 -  ! Справочник для чтения
.head 7 +  If SalStrUpperX(strRefAccess) = 'RO'
.head 8 -  Call FunNSIEditF(strRefTable, 1)
.head 7 -  ! Справочник для редактирования
.head 7 +  Else
.head 8 -  Call FunNSIEdit(strRefTable)
.head 6 +  Else
.head 7 +  If strRefRole2Edit != '' 
.head 8 +  If SalStrTrimX( SalStrUpperX( GetDBMS() )) = 'ORACLE'
.head 9 -  Call XRoleSet( hSql(), strRefDlgName, strRefRole2Edit )
.head 8 +  Else
.head 9 -  Call SqlPrepareAndExecute( hSql(), 'SET ROLE ' || strRefRole2Edit )
.head 7 -  Call SalCompileAndEvaluate( strRefDlgName, nErr, nErrPos, nRet, sRet, dRet, hRet, TRUE, SalContextCurrent() )
.head 7 +  If nErr != 0
.head 8 -  Call SalMessageBeep( MB_IconStop )
.head 8 -  ! Некорректно задана функция вызова справочника!
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_RefList.cTErrRef'),
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok | MB_IconStop )
.head 5 +  On SAM_User
.head 6 -  Set nItemFlags = lbReferences.GetItemFlags( lbReferences.GetItemHandle( wParam ))
.head 6 +  If (nItemFlags & ITEM_IsParent)
.head 7 +  If (nItemFlags & ITEM_CanExpand)
.head 8 -  ! Call SalSetWindowText( hWndItem, 'Открыть')
.head 8 -  Call SalSetWindowText( hWndItem, CurrentLangTable.GetAtomTitle('frm_RefList.pbAction'))
.head 7 +  Else If (nItemFlags & ITEM_CanCollapse)
.head 8 -  ! Call SalSetWindowText( hWndItem, 'Закрыть')
.head 8 -  Call SalSetWindowText( hWndItem, CurrentLangTable.GetAtomTitle('frm_RefList.cTClose'))
.head 6 +  Else
.head 7 -  ! Call SalSetWindowText( hWndItem, 'Показать')
.head 7 -  Call SalSetWindowText( hWndItem, CurrentLangTable.GetAtomTitle('frm_RefList.cTShow'))
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отменить
.head 4 -  Window Location and Size
.head 5 -  Left:   6.429"
.head 5 -  Top:    4.344"
.head 5 -  Width:  1.443"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDestroyWindow( hWndForm )
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: strApplicationCode
.head 3 -  String: strApplicationName
.head 3 -  !
.head 3 -  : nRefNodes
.head 4 -  Class: cNodeList
.head 3 -  !
.head 3 -  Number: hRoot
.head 3 -  Number: hItem
.head 3 -  Number: hCurNode
.head 3 -  Number: nNodeId
.head 3 -  String: strCurNodeName
.head 3 -  !
.head 3 -  Number: hPicBookNormal
.head 3 -  Number: hPicBookOpen
.head 3 -  Number: hPicItemRO
.head 3 -  Number: hPicItemRW
.head 3 -  Number: hPicItem
.head 3 -  !
.head 3 -  Number: nTabID
.head 3 -  String: strRefAccess
.head 3 -  String: strRefGroup
.head 3 -  String: strRefTable
.head 3 -  String: strRefName
.head 3 -  String: strRefDlgName
.head 3 -  String: strRefRole2Edit
.head 3 -  !
.head 3 -  Number: nItemFlags
.head 3 -  Number: nIndexItem
.head 3 -  !
.head 3 -  String: strKey1
.head 3 -  String: strKey2
.head 3 -  !
.head 3 -  Number: nErr
.head 3 -  Number: nErrPos
.head 3 -  Number: nRet
.head 3 -  String: sRet
.head 3 -  Date/Time: dRet
.head 3 -  Window Handle: hRet
.head 3 -  !
.head 3 -  Number: nListWidth
.head 3 -  Number: nListHeight
.head 3 -  Number: nButtonTop
.head 3 -  Number: nButtonLeft
.head 3 -  !
.head 3 -  String: sSecureWhere
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor ( TRUE )
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  !
.head 4 -  Set hPicBookNormal = VisPicLoad ( PIC_LoadSWinRes | PIC_FormatIcon | PIC_LoadSmallIcon, 'ICO_BookC', '' )
.head 4 -  Set hPicBookOpen = VisPicLoad ( PIC_LoadSWinRes | PIC_FormatIcon | PIC_LoadSmallIcon, 'ICO_BookO', '' )
.head 4 -  Set hPicItemRO = VisPicLoad ( PIC_LoadSWinRes | PIC_FormatIcon | PIC_LoadSmallIcon, 'ICO_ItemRO', '' )
.head 4 -  Set hPicItemRW = VisPicLoad ( PIC_LoadSWinRes | PIC_FormatIcon | PIC_LoadSmallIcon, 'ICO_ItemRW', '' )
.head 4 -  !
.head 4 -  Set strApplicationCode = SalStrTrimX(GetCodeApp( ))
.head 4 -  ! Call SalMessageBox(strApplicationCode, 'ttt', MB_Ok)
.head 4 -  Call SqlPrepareAndExecute(hSql(), 
T('SELECT trim(name) INTO :strApplicationName FROM applist 
    WHERE codeapp = :strApplicationCode'))
.head 4 -  Call SqlFetchNext(hSql(), nFetchRes )
.head 4 -  ! Call SalSetWindowText( hWndForm, strApplicationName || ': Справочники' )
.head 4 -  Call SalSetWindowText( hWndForm, strApplicationName || ': ' || 
  CurrentLangTable.GetAtomTitle('frm_RefList.cTWndTitle') )
.head 4 -  Call SalWaitCursor( FALSE )
.head 3 +  On SAM_Close
.head 4 -  Call SalDestroyWindow(  hWndForm )
.head 4 -  ! Call SalEndDialog( hWndForm, 0)
.head 3 +  On SAM_Destroy
.head 4 -  Call VisPicFree( hPicBookNormal )
.head 4 -  Call VisPicFree( hPicBookOpen )
.head 4 -  Call VisPicFree( hPicItemRO )
.head 4 -  Call VisPicFree( hPicItemRW )
.head 4 +  If SalStrTrimX( SalStrUpperX( GetDBMS() )) = 'ORACLE'
.head 5 -  Call XRoleUnset( hSql(), 'ShowRefList(hWndMDI)' )
.head 4 -  Call SalSetFocus( SalParentWindow( hWndForm ))
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect( hWndForm, nButtonTop, nButtonLeft, nListWidth, nListHeight )
.head 4 -  Set nButtonLeft = SalPixelsToFormUnits( hWndForm, nListWidth, FALSE ) - 3.4
.head 4 -  Set nButtonTop = SalPixelsToFormUnits( hWndForm, nListHeight, TRUE ) - 0.55
.head 4 -  Set nListWidth = SalPixelsToFormUnits( hWndForm, nListWidth, FALSE )
.head 4 -  Set nListHeight = SalPixelsToFormUnits( hWndForm, nListHeight, TRUE )
.head 4 -  Call SalSetWindowLoc( lbReferences, 0, 0 )
.head 4 -  Call SalSetWindowSize( lbReferences, nListWidth, nListHeight - 0.7 )
.head 4 -  Call SalSetWindowLoc( pbAction, nButtonLeft, nButtonTop )
.head 4 -  Call SalSetWindowLoc( pbExit, nButtonLeft + 1.7, nButtonTop )
.head 1 -  !
.head 1 -  ! Не удалять!
.head 1 -  !
.head 1 +  Dialog Box: dlg_RefTemplates
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Шаблоны проводок электронных платежей
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.225"
.head 4 -  Top:    0.344"
.head 4 -  Width:  12.443"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.927"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Шаблоны проводок электронных платежей
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.427"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblTemplates
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.043"
.head 6 -  Top:    0.031"
.head 6 -  Width:  12.271"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.896"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 16535
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colTT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTT_NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Название банковской
операции
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 35
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.933"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call SalListPopulate( hWndItem, hSql(), T( 'SELECT name FROM Tts WHERE fli=3' ) )
.head 7 +  On SAM_Validate
.head 8 -  Set strName=SalStrTrimX( MyValue )
.head 8 -  Call SqlPrepareAndExecute (hSql (), T( 'SELECT tt FROM Tts INTO :colTT WHERE name=:strName' ) )
.head 8 -  Call SqlFetchNext (hSql (), nErr)
.head 5 +  Column: colKV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
валюты
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.871"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
pm
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPM_NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вид
оплаты
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call SalListPopulate( hWndItem, hSql(), T( 'SELECT name FROM Pm_rrp' ) )
.head 7 +  On SAM_Validate
.head 8 -  Set strName=SalStrTrimX( MyValue )
.head 8 -  Call SqlPrepareAndExecute (hSql (), T( 'SELECT pm FROM Pm_rrp INTO :colPM WHERE name=:strName' ) )
.head 8 -  Call SqlFetchNext (hSql (), nErr)
.head 8 -  !
.head 8 -  ! //////////////////////////////////////////////////////////////////////////////////////////////////////
.head 5 +  Column: colKODNI
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
kodni
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKODNI_NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Входное
направление
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 40
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call SalListPopulate( hWndItem, hSql(), T( 'SELECT name FROM Dir_rrp' ) )
.head 7 +  On SAM_Validate
.head 8 -  Set strName=SalStrTrimX( MyValue )
.head 8 -  Call SqlPrepareAndExecute (hSql (), T( 'SELECT kodn FROM Dir_rrp INTO :colKODNI WHERE name=:strName' ) )
.head 8 -  Call SqlFetchNext (hSql (), nErr)
.head 5 +  Column: colKODNO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
kodno
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.583"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKODNO_NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Выходное
направление
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 40
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call SalListPopulate( hWndItem, hSql(), T( 'SELECT name FROM Dir_rrp' ) )
.head 7 +  On SAM_Validate
.head 8 -  Set strName=SalStrTrimX( MyValue )
.head 8 -  Call SqlPrepareAndExecute (hSql (), T( 'SELECT kodn FROM Dir_rrp INTO :colKODNO WHERE name=:strName' ) )
.head 8 -  Call SqlFetchNext (hSql (), nErr)
.head 5 +  Column: colTIPD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
tipd
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTIPD_NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип счета
(дебет)
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.517"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call SalListPopulate( hWndItem, hSql(), T( 'SELECT name FROM Tips' ) )
.head 7 +  On SAM_Validate
.head 8 -  Set strName=SalStrTrimX( MyValue )
.head 8 -  Call SqlPrepareAndExecute (hSql (), T( 'SELECT tip FROM Tips INTO :colTIPD WHERE name=:strName' ) )
.head 8 -  Call SqlFetchNext (hSql (), nErr)
.head 5 +  Column: colWD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Чей
счет
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? No
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 +  List Values
.head 7 -  Text: A
.head 7 -  Text: B
.head 6 -  Message Actions
.head 5 +  Column: colTIPK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
tipk
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.414"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTIPK_NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Тип счета
(кредит)
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.517"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call SalListPopulate( hWndItem, hSql(), T( 'SELECT name FROM Tips' ) )
.head 7 +  On SAM_Validate
.head 8 -  Set strName=SalStrTrimX( MyValue )
.head 8 -  Call SqlPrepareAndExecute (hSql (), T( 'SELECT tip FROM Tips INTO :colTIPK WHERE name=:strName' ) )
.head 8 -  Call SqlFetchNext (hSql (), nErr)
.head 5 +  Column: colWK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Чей
счет
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? No
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 +  List Values
.head 7 -  Text: A
.head 7 -  Text: B
.head 6 -  Message Actions
.head 5 +  Column: colCOMM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Описание
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 70
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.967"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ROWID
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetLockedColumns( hWndItem, 3 )
.head 6 -  !
.head 6 -  Call WaitCursorOn()
.head 6 -  Call SalTblPopulate( tblTemplates, hSql(),  T('
SELECT t.name, a.tt, a.kv, p.name, a.pm, di.name, a.kodn_i, do.name, a.kodn_o, td.name, a.tip_d,
       wd, tk.name, a.tip_k, wk, a.comm, a.rowid 
  INTO :colTT_NAME, :colTT, :colKV, :colPM_NAME, :colPM, :colKODNI_NAME, :colKODNI, :colKODNO_NAME, 
       :colKODNO, :colTIPD_NAME, :colTIPD, :colWD, :colTIPK_NAME, :colTIPK, :colWK,
       :colCOMM, :colRID
  FROM Templates a, OUTER Tts t, OUTER Pm_rrp p, OUTER Dir_rrp di, OUTER Dir_rrp do, OUTER Tips tk, 
       OUTER Tips td
 WHERE a.pm=p.pm (+) AND
       a.tt=t.tt (+) AND
       a.kodn_i=di.kodn (+) AND
       a.kodn_o=do.kodn (+) AND
       a.tip_d=td.tip (+) AND
       a.tip_k=tk.tip (+) '), TBL_FillAll )
.head 6 -  Call WaitCursorOff()
.head 5 +  On SAM_RowHeaderClick
.head 6 -  Call SalEnableWindow( pbDel )
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 23620
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.057"
.head 5 -  Top:    4.969"
.head 5 -  Width:  12.257"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.604"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 3 +  Pushbutton: pbNew
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbInsert
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.829"
.head 5 -  Top:    5.052"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! /////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 6 -  !
.head 6 -  Set nNewRow = SalTblInsertRow( tblTemplates, TBL_MaxRow )
.head 6 -  !
.head 6 +  If nNewRow != TBL_Error
.head 7 -  Call SalTblSetFocusRow( tblTemplates, nNewRow )
.head 6 -  !
.head 6 -  ! ////////////
.head 3 +  Pushbutton: pbDel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   7.343"
.head 5 -  Top:    5.052"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! /////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 6 -  !
.head 6 -  Call SalTblSetFlagsAnyRows( tblTemplates, ROW_MarkDeleted, TRUE, ROW_Selected, 0 )
.head 6 -  !
.head 6 -  ! /////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   9.186"
.head 5 -  Top:    5.052"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 6 -  !
.head 6 -  Call WaitCursorOn()
.head 6 -  !
.head 6 +  If SalTblAnyRows( tblTemplates, ROW_New, 0 )
.head 7 -  Call SqlPrepare( hSql(), T( 'INSERT INTO Templates ( tt, kv, pm, kodn_i, kodn_o, tip_d, wd, tip_k, wk, comm )
                                          VALUES
                                       ( :tblTemplates.colTT, :tblTemplates.colKV, :tblTemplates.colPM, :tblTemplates.colKODNI, :tblTemplates.colKODNO,
                                         :tblTemplates.colTIPD, :tblTemplates.colWD, :tblTemplates.colTIPK, :tblTemplates.colWK, :tblTemplates.colCOMM )' ) )
.head 7 -  Call SalTblDoInserts( tblTemplates, hSql(), TRUE )
.head 6 +  If SalTblAnyRows( tblTemplates, ROW_MarkDeleted, 0 )
.head 7 -  Call SqlPrepare( hSql(), T( 'DELETE FROM Templates WHERE rowid = :tblTemplates.colRID' ) )
.head 7 -  Call SalTblDoDeletes( tblTemplates, hSql(), ROW_MarkDeleted )
.head 6 +  If SalTblAnyRows( tblTemplates, ROW_Edited, 0)
.head 7 -  Call SqlPrepare( hSql(), T( 'UPDATE Templates SET
         tt=:tblTemplates.colTT, kv=:tblTemplates.colKV, 
         pm=:tblTemplates.colPM, kodn_i=:tblTemplates.colKODNI,
         kodn_o = :tblTemplates.colKODNO, tip_d=:tblTemplates.colTIPD, 
         tip_k=:tblTemplates.colTIPK,  wd=:tblTemplates.colWD, 
         wk=:tblTemplates.colWK, comm=:tblTemplates.colCOMM
         WHERE rowid=:tblTemplates.colRID' ) )
.head 7 -  Call SalTblDoUpdates( tblTemplates, hSql(), TRUE )
.head 6 -  !
.head 6 -  Call SqlCommitEx( hSql(), MSG_SaveDataRef() )
.head 6 -  !
.head 6 -  Call WaitCursorOff()
.head 6 -  !
.head 6 -  Call SalSendMsg( tblTemplates, SAM_Create, 0, 0 )
.head 6 -  Call SalSetFocus( tblTemplates )
.head 6 -  !
.head 6 -  ! //////////////////////////////
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   10.686"
.head 5 -  Top:    5.052"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 6 -  !
.head 6 -  Call SalEndDialog( dlg_RefTemplates, -1 )
.head 6 -  !
.head 6 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 3 -  !
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: strName
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow( hWndForm )
.head 4 -  Call SalDisableWindow( pbDel )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Dialog Box: dlg_RefBpReason
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Справочник кодов причин возврата платежей СЭП
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.5"
.head 4 -  Top:    0.5"
.head 4 -  Width:  10.129"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.107"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Справочник кодов причин возврата платежей СЭП
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblBpReason
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.088"
.head 6 -  Top:    0.042"
.head 6 -  Width:  9.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 5.094"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 128
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 4
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.714"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colID_NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 160
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  8.629"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colRID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: RID
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 6 -  !
.head 6 -  Call WaitCursorOn()
.head 6 -  Call SalTblPopulate( tblBpReason, hSql(),  T( 'SELECT 
         id, reason, rowid   FROM Bp_reason   INTO
         :tblBpReason.colID, :tblBpReason.colID_NAME, 
 :tblBpReason.colRID' ), TBL_FillAll )
.head 6 -  Call WaitCursorOff()
.head 6 -  !
.head 6 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 5 +  On SAM_RowHeaderClick
.head 6 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 6 -  !
.head 6 -  Call SalEnableWindow( pbDel )
.head 6 -  !
.head 6 +  If bMode=TRUE
.head 7 -  Call SalEnableWindow( pbSave )
.head 6 -  !
.head 6 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 5 +  On WM_LbuttonUp
.head 6 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 6 -  !
.head 6 -  Call SalSendMsg( tblBpReason, SAM_RowHeaderClick, 0, 0 )
.head 6 -  !
.head 6 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 3 -  !
.head 3 +  Pushbutton: pbNew
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbInsert
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.467"
.head 5 -  Top:    5.25"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! /////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 6 -  !
.head 6 -  Set nNewRow = SalTblInsertRow( tblBpReason, TBL_MaxRow )
.head 6 -  !
.head 6 +  If nNewRow != TBL_Error
.head 7 -  Call SalTblSetFocusRow( tblBpReason, nNewRow )
.head 6 -  !
.head 6 -  ! /////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 3 +  Pushbutton: pbDel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Удалить
.head 4 -  Window Location and Size
.head 5 -  Left:   4.983"
.head 5 -  Top:    5.25"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! /////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 6 -  !
.head 6 -  Call SalTblSetFlagsAnyRows( tblBpReason, ROW_MarkDeleted, TRUE, ROW_Selected, 0 )
.head 6 -  !
.head 6 -  ! /////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.833"
.head 5 -  Top:    5.25"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 6 -  !
.head 6 -  Call WaitCursorOn()
.head 6 -  !
.head 6 +  If bMode=TRUE
.head 7 -  Set nBpr=tblBpReason.colID
.head 7 -  Call SaveInfoToLog( 'Выбран код возврата платежа СЭП: ' || NumberToStr( nBpr ) )
.head 6 +  Else
.head 7 +  If SalIsNull( tblBpReason.colID ) Or tblBpReason.colID=0
.head 8 -  Call MessageInfoEx( 'Заполните корректно код возврата документа СЭП!' )
.head 7 +  Else
.head 8 +  If SalTblAnyRows( tblBpReason, ROW_New, 0 )
.head 9 -  Call SqlPrepare( hSql(), T( 'INSERT INTO Bp_reason ( id, reason ) VALUES ( :tblBpReason.colID, :tblBpReason.colID_NAME )' ) )
.head 9 -  Call SalTblDoInserts( tblBpReason, hSql(), TRUE )
.head 8 +  If SalTblAnyRows( tblBpReason, ROW_MarkDeleted, 0 )
.head 9 -  Call SqlPrepare( hSql(), T( 'DELETE FROM Bp_reason 
WHERE rowid=:tblBpReason.colRID' ) )
.head 9 -  Call SalTblDoDeletes( tblBpReason, hSql(), ROW_MarkDeleted )
.head 8 +  If SalTblAnyRows( tblBpReason, ROW_Edited, 0)
.head 9 -  Call SqlPrepare( hSql(), T( 'UPDATE Bp_reason    SET 
        reason=:tblBpReason.colID_NAME
        WHERE rowid=:tblBpReason.colRID' ) )
.head 9 -  Call SalTblDoUpdates( tblBpReason, hSql(), TRUE )
.head 8 -  !
.head 8 -  Call SqlCommitEx( hSql(), MSG_SaveDataRef() )
.head 8 -  !
.head 8 -  Call SalSendMsg( tblBpReason, SAM_Create, 0, 0 )
.head 8 -  Call SalSetFocus( tblBpReason )
.head 6 -  !
.head 6 -  Call WaitCursorOff()
.head 6 -  !
.head 6 +  If bMode=TRUE
.head 7 -  Set bMode=FALSE
.head 7 -  Call SalEndDialog( hWndForm, nBpr )
.head 6 -  !
.head 6 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выйти
.head 4 -  Window Location and Size
.head 5 -  Left:   8.333"
.head 5 -  Top:    5.25"
.head 5 -  Width:  1.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 6 -  !
.head 6 -  Call SalEndDialog( hWndForm, -1 )
.head 6 -  !
.head 6 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 17895
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    5.177"
.head 5 -  Width:  9.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.594"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Boolean: bMode
.head 2 +  Window Variables
.head 3 -  Number: nBpr
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! /////////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 4 -  !
.head 4 -  Call PrepareWindow( hWndForm )
.head 4 -  !
.head 4 -  Call SalDisableWindow( pbDel )
.head 4 -  !
.head 4 -  Set nBpr=NUMNULL
.head 4 -  !
.head 4 +  If bMode=TRUE
.head 5 -  Call SalHideWindow( pbNew )
.head 5 -  Call SalHideWindow( pbDel )
.head 5 -  !
.head 5 -  Call SalTblSetColumnFlags( tblBpReason.colID, COL_Editable, FALSE )
.head 5 -  Call SalTblSetColumnFlags( tblBpReason.colID_NAME, COL_Editable, FALSE )
.head 5 -  !
.head 5 -  Call SalSetWindowText( pbSave, 'Выбрать' )
.head 5 -  Call SalDisableWindow( pbSave )
.head 4 -  !
.head 4 -  ! /////////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 3 +  On SAM_CreateComplete
.head 4 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 4 -  !
.head 4 -  Call WaitCursorOff()
.head 4 -  !
.head 4 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 1 +  Dialog Box: dlg_RefSuch
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Справочник участников Межбанковских расчетов
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.138"
.head 4 -  Top:    0.198"
.head 4 -  Width:  12.771"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.393"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: MS Sans Serif
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Справочник участников Межбанковских расчетов
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblBanks
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.043"
.head 6 -  Top:    0.51"
.head 6 -  Width:  12.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 5.512"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 16535
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: MFO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО
банка
участника
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 6
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  1.043"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalSetFieldEdit( hWndItem, TRUE )
.head 7 +  On SAM_Validate
.head 8 +  If SalIsNull( hWndItem )
.head 9 +  If SalMessageBox( MSG_NeedFillField(), MSG_EmptyField(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 10 -  Return VALIDATE_OkClearFlag
.head 9 +  Else
.head 10 -  Return VALIDATE_Cancel
.head 8 +  Else
.head 9 +  If NOT IsValidMFO( tblBanks.MFO )
.head 10 +  If SalMessageBox( MSG_ErrorKeyByte(), MSG_Attention(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 11 -  Return VALIDATE_OkClearFlag
.head 10 +  Else
.head 11 -  Return VALIDATE_Cancel
.head 9 +  Else
.head 10 -  Call SqlPrepareAndExecute( hSql(), T( 'SELECT count(*) FROM Banks WHERE trim( mfo ) = trim(:tblBanks.MFO) INTO :nCnt' ) )
.head 10 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 10 +  If nCnt != 0
.head 11 +  If SalMessageBox( 'Поле хранит дублирующие значение', MSG_Attention(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 12 -  Return VALIDATE_OkClearFlag
.head 11 +  Else
.head 12 -  Return VALIDATE_Cancel
.head 10 +  Else
.head 11 -  Return VALIDATE_Ok
.head 5 +  Column: SAB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Элект-
ронный
адрес
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 4
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.914"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Uppercase
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If SalIsNull( hWndItem )
.head 9 +  If SalMessageBox( MSG_NeedFillField(), MSG_EmptyField(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 10 -  Return VALIDATE_OkClearFlag
.head 9 +  Else
.head 10 -  Return VALIDATE_Cancel
.head 8 +  Else
.head 9 -  Return VALIDATE_Ok
.head 7 +  On SAM_SetFocus
.head 8 -  Call SalSetFieldEdit( hWndItem, TRUE )
.head 5 +  Column: MFOP
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: МФО
расчетного
центра
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 6
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  1.1"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If SalIsNull( hWndItem )
.head 9 +  If SalMessageBox( MSG_NeedFillField(), MSG_EmptyField(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 10 -  Return VALIDATE_OkClearFlag
.head 9 +  Else
.head 10 -  Return VALIDATE_Cancel
.head 8 +  Else
.head 9 +  If NOT IsValidMFO( tblBanks.MFOP )
.head 10 +  If SalMessageBox( MSG_ErrorKeyByte(), MSG_Attention(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 11 -  Return VALIDATE_OkClearFlag
.head 10 +  Else
.head 11 -  Return VALIDATE_Cancel
.head 9 +  Else
.head 10 -  Return VALIDATE_Ok
.head 7 +  On SAM_KillFocus
.head 8 +  If NOT SalSendMsg( hWndItem, SAM_Validate, 0, 0 )
.head 9 -  Set wParam = SalWindowHandleToNumber( hWndItem )
.head 5 +  Column: NB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Наименование банка
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 70
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  6.243"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If SalIsNull( hWndItem )
.head 9 +  If SalMessageBox( MSG_NeedFillField(), MSG_EmptyField(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 10 -  Return VALIDATE_OkClearFlag
.head 9 +  Else
.head 10 -  Return VALIDATE_Cancel
.head 8 +  Else
.head 9 -  Return VALIDATE_Ok
.head 5 +  Column: BLKNAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Состояние:
рабочий либо
ликвидирован
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 20
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If SalIsNull( hWndItem )
.head 9 +  If SalMessageBox( MSG_NeedFillField(), MSG_EmptyField(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 10 -  Return VALIDATE_OkClearFlag
.head 9 +  Else
.head 10 -  Return VALIDATE_Cancel
.head 8 +  Else
.head 9 -  Return VALIDATE_Ok
.head 5 +  Column: KODGN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Группа банков
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.3"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call SalListPopulate( hWndItem, hSql(), T( 'SELECT namg FROM Groupsb' ) )
.head 7 +  On SAM_Validate
.head 8 +  If SalListQuerySelection( hWndItem ) = LB_Err
.head 9 +  If SalMessageBox( MSG_NeedFillField(), MSG_EmptyField(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 10 -  Return VALIDATE_OkClearFlag
.head 9 +  Else
.head 10 -  Return VALIDATE_Cancel
.head 8 +  Else
.head 9 -  Call SqlPrepareAndExecute (hSql (), T( 'SELECT kodg FROM Groupsb INTO :tblBanks.KODG WHERE trim(NAMG) = trim(:tblBanks.KODGN)' ) )
.head 9 -  Call SqlFetchNext (hSql (), nErr)
.head 9 -  Return VALIDATE_Ok
.head 5 +  Column: FMI
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
FMI
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 2
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.414"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: FMINAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Формат
входных 
сообщений
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 40
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.05"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? No
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call SalListPopulate( hWndItem, hSql(), T( 'SELECT name FROM Msf' ) )
.head 7 +  On SAM_Validate
.head 8 +  If SalListQuerySelection( FMINAME ) = LB_Err
.head 9 +  If SalMessageBox( MSG_NeedFillField(), MSG_EmptyField(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 10 -  Return VALIDATE_OkClearFlag
.head 9 +  Else
.head 10 -  Return VALIDATE_Cancel
.head 8 +  Else
.head 9 -  Call SqlPrepareAndExecute (hSql (), T( 'SELECT fm FROM Msf INTO :FMI WHERE name=:FMINAME' ) )
.head 9 -  Call SqlFetchNext (hSql (), nErr)
.head 9 -  Return VALIDATE_Ok
.head 5 +  Column: FMO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
FMO
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 2
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.483"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: FMONAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Формат
выходных
сообщений
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 40
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.05"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? No
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call SalListPopulate( hWndItem, hSql(), T( 'SELECT name FROM Msf' ) )
.head 7 +  On SAM_Validate
.head 8 -  ! //////////////////////////////////////////////////////////////////////////////////////////////////////
.head 8 -  !
.head 8 +  If SalListQuerySelection( FMONAME ) = LB_Err
.head 9 +  If SalMessageBox( MSG_NeedFillField(), MSG_EmptyField(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 10 -  Return VALIDATE_OkClearFlag
.head 9 +  Else
.head 10 -  Return VALIDATE_Cancel
.head 8 +  Else
.head 9 -  Call SqlPrepareAndExecute (hSql (), T( 'SELECT fm FROM Msf INTO :FMO WHERE name=:FMONAME' ) )
.head 9 -  Call SqlFetchNext (hSql (), nErr)
.head 9 -  Return VALIDATE_Ok
.head 8 -  !
.head 8 -  ! //////////////////////////////////////////////////////////////////////////////////////////////////////
.head 5 +  Column: PM
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
PM
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 2
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.386"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: PMNAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
Метод оплаты файлов СЭП
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.957"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? No
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call SalListPopulate( hWndItem, hSql(), T( 'SELECT name FROM Pm_rrp' ) )
.head 7 +  On SAM_Validate
.head 8 +  If SalListQuerySelection( hWndItem ) = LB_Err
.head 9 +  If SalMessageBox( MSG_NeedFillField(), MSG_EmptyField(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 10 -  Return VALIDATE_OkClearFlag
.head 9 +  Else
.head 10 -  Return VALIDATE_Cancel
.head 8 +  Else
.head 9 -  Call SqlPrepareAndExecute (hSql (), T( 'SELECT pm FROM Pm_rrp INTO :PM WHERE name=:PMNAME' ) )
.head 9 -  Call SqlFetchNext (hSql (), nErr)
.head 9 -  !
.head 9 -  Return VALIDATE_Ok
.head 5 +  Column: KODN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
KODN
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 2
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: KODNNAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Маршрут прохождения
электронных платежей
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 40
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? No
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 -  Call SalListPopulate( hWndItem, hSql(), T( 'SELECT name FROM Dir_rrp' ) )
.head 7 +  On SAM_Validate
.head 8 +  If SalListQuerySelection( hWndItem ) = LB_Err
.head 9 +  If SalMessageBox( MSG_NeedFillField(), MSG_EmptyField(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 10 -  Return VALIDATE_OkClearFlag
.head 9 +  Else
.head 10 -  Return VALIDATE_Cancel
.head 8 +  Else
.head 9 -  Call SqlPrepareAndExecute (hSql (), T( 'SELECT kodn FROM Dir_rrp INTO :KODN WHERE name=:KODNNAME' ) )
.head 9 -  Call SqlFetchNext (hSql (), nErr)
.head 9 -  !
.head 9 -  Return VALIDATE_Ok
.head 5 +  Column: KODG
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: KODG
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.967"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: BLK
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: BLK
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 2
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? No
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: ROWID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: 
ROWID
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.886"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: NMO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: #
МОД
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.483"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: tempN
.head 5 -  Number: nCnt
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalTblSetLockedColumns( tblBanks, 2 )
.head 6 -  !
.head 6 -  Set fBlkRedirect=FALSE
.head 6 -  !
.head 6 +  If bDirectAccess
.head 7 -  Call SalHideWindow( MFOP )
.head 7 -  Call SalShowWindow( FMINAME )
.head 7 -  Call SalShowWindow( FMONAME )
.head 7 -  Call SalShowWindow( PMNAME )
.head 7 -  Call SalShowWindow( KODNNAME )
.head 7 -  !
.head 7 -  Set strSqlTxt="
SELECT a.mfo, a.sab, a.nb, a.blk, a.fmi, fi.name, a.fmo, fo.name, 
       a.pm, p.name, a.kodn, k.name, a.kodg, g.namg, a.rowid, a.nmo 
  INTO :MFO, :SAB, :NB, :BLK, :FMI, :FMINAME, :FMO, :FMONAME, 
       :PM, :PMNAME, :KODN, :KODNNAME, :KODG, :KODGN, :ROWID, :NMO  
  FROM Banks a, OUTER Groupsb g, OUTER Msf fi, OUTER Msf fo, OUTER Pm_rrp p,
       OUTER Dir_rrp k
 WHERE a.kodg=g.kodg (+) AND
       a.fmi=fi.fm (+)   AND
       a.fmo=fo.fm (+)   AND
       a.pm=p.pm (+)     AND
       a.kodn=k.kodn (+) AND
       a.mfop = :strBankMfo AND 
       a.mfop IS NOT NULL 
ORDER BY a.mfo"
.head 6 +  Else
.head 7 -  Call SalShowWindow( MFOP )
.head 7 -  Call SalHideWindow( FMINAME )
.head 7 -  Call SalHideWindow( FMONAME )
.head 7 -  Call SalHideWindow( PMNAME )
.head 7 -  Call SalHideWindow( KODNNAME )
.head 7 -  !
.head 7 -  Set strSqlTxt="
SELECT a.mfo, a.mfop, a.sab, a.nb, a.blk, a.kodg, g.namg, a.rowid, a.nmo 
  INTO :MFO, :MFOP, :SAB, :NB, :BLK, :KODG, :KODGN, :ROWID, :NMO  
  FROM Banks a, OUTER Groupsb g
 WHERE a.kodg=g.kodg (+) AND "
.head 7 +  If strSeniorMfo != ''
.head 8 -  Set strSqlTxt=strSqlTxt || ' a.mfop = :strSeniorMfo '
.head 7 +  Else
.head 8 -  Set strSqlTxt=strSqlTxt || ' a.mfop IS NULL '
.head 7 -  Set strSqlTxt=strSqlTxt || ' ORDER BY a.mfo'
.head 6 -  !
.head 6 -  !
.head 6 -  Call WaitCursorOn()
.head 6 -  Call SalTblPopulate( tblBanks, hSqlAux(), T( strSqlTxt ), TBL_FillNormal )
.head 6 -  Call WaitCursorOff()
.head 6 -  Call SalTblSetFocusRow( tblBanks, 0 )
.head 5 +  On SAM_FetchRowDone
.head 6 +  If bDirectAccess
.head 7 +  If BLK=4
.head 8 -  Set BLKNAME = 'Ликвидирован'
.head 7 +  Else If BLK=0
.head 8 -  Set BLKNAME = 'Рабочий'
.head 7 +  Else
.head 8 -  Set BLKNAME = 'Неизвестный код'
.head 6 +  Else
.head 7 -  Call SalListSelectString( KODGN, -1, strGrName )
.head 7 -  !
.head 7 +  If BLK=4
.head 8 -  Set BLKNAME = 'Ликвидирован'
.head 7 +  Else If BLK=0
.head 8 -  Set BLKNAME = 'Рабочий'
.head 7 +  Else
.head 8 -  Set BLKNAME = 'Неизвестный код'
.head 5 +  On SAM_TblDoDetails
.head 6 +  If NOT SalIsWindowEnabled( pbAccounts )
.head 7 -  Call SalEnableWindow( pbAccounts )
.head 5 +  On SAM_DoubleClick
.head 6 +  If Not SalIsNull( tblBanks.MFO )
.head 7 -  !
.head 7 -  Set bDirectAccess=FALSE
.head 7 -  Set strSeniorMfo=tblBanks.MFO
.head 7 -  !
.head 7 -  Call SalSetWindowText( dlg_RefSuch, 'Участники Расчетной Палаты: ' || MFO || '   ' || NB )
.head 7 -  Call SalEnableWindow( pbBack )
.head 7 -  Call SalDisableWindow( pbDown )
.head 7 -  Call SalDisableWindow( pbAccounts )
.head 7 -  !
.head 7 -  Call SalSendMsg( tblBanks, SAM_Create, 0, 0 )
.head 3 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 41657
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.071"
.head 5 -  Top:    0.071"
.head 5 -  Width:  12.557"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: МФО:
.head 4 -  Resource Id: 41660
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.233"
.head 5 -  Top:    0.198"
.head 5 -  Width:  0.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Bold
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSeekMfo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 6
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.933"
.head 6 -  Top:    0.156"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbFind
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbSearch
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.957"
.head 5 -  Top:    0.125"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set pbFind.strTip='Искать участника с заданым МФО'
.head 5 +  On SAM_Click
.head 6 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 6 -  !
.head 6 +  If bDirectAccess
.head 7 -  Set strSqlTxt="SELECT a.mfo, a.sab, a.nb, a.blk, a.fmi, 
a.fmo, a.pm, a.kodn, a.kodg, g.namg, a.rowid, a.nmo "
.head 7 -  Set strSqlTxt = strSqlTxt || "INTO :tblBanks.MFO, 
 :tblBanks.SAB, :tblBanks.NB, :tblBanks.BLK, :tblBanks.FMI,
 :tblBanks.FMO, :tblBanks.PM, :tblBanks.KODN, 
 :tblBanks.KODG, :tblBanks.KODGN, :tblBanks.ROWID,:tblBanks.NMO "
.head 6 +  Else
.head 7 -  Set strSqlTxt="SELECT a.mfo, a.mfop, a.sab, a.nb,
a.blk, a.kodg, g.namg, a.rowid, a.nmo "
.head 7 -  Set strSqlTxt = strSqlTxt || "INTO :tblBanks.MFO, 
:tblBanks.MFOP, :tblBanks.SAB, :tblBanks.NB,
:tblBanks.BLK,  :tblBanks.KODG, :strGrName,
:tblBanks.ROWID, :tblBanks.NMO "
.head 6 -  Set strSqlTxt=strSqlTxt || "FROM Banks a, OUTER Groupsb g WHERE "
.head 6 -  Set strSqlTxt=strSqlTxt || "g.kodg (+) = a.kodg AND "
.head 6 +  If dfSeekMfo != ''
.head 7 -  Set strSqlTxt = strSqlTxt || "a.mfo LIKE '" || StrMatches2Like( dfSeekMfo ) || "' AND "
.head 6 +  If bDirectAccess
.head 7 -  Set strSqlTxt = strSqlTxt || " a.mfop = :strBankMfo AND a.mfop IS NOT NULL "
.head 6 +  Else
.head 7 +  If strSeniorMfo != ''
.head 8 -  Set strSqlTxt = strSqlTxt || " a.mfop = :strSeniorMfo "
.head 7 +  Else
.head 8 -  Set strSqlTxt = strSqlTxt || "  a.mfop IS NULL "
.head 6 -  !
.head 6 -  Set strSqlTxt = strSqlTxt || "ORDER BY 1"
.head 6 -  !
.head 6 -  Call WaitCursorOn()
.head 6 -  Call SalTblPopulate( tblBanks, hSql(), T( strSqlTxt ), TBL_FillAll )
.head 6 -  Call WaitCursorOff()
.head 6 -  !
.head 6 -  Call SalTblSetFocusRow( tblBanks, 0 )
.head 6 -  !
.head 6 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 3 +  Pushbutton: pbRefresh
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbRefresh
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.386"
.head 5 -  Top:    0.125"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set strTip = 'Перечитать'
.head 5 +  On SAM_Click
.head 6 -  Call WaitCursorOn()
.head 6 -  Call SalTblPopulate( tblBanks, hSql(), T( strSqlTxt ), TBL_FillAll )
.head 6 -  Call WaitCursorOff()
.head 6 -  !
.head 6 -  Call SalTblSetFocusRow( tblBanks, 0 )
.head 3 -  Line
.head 4 -  Resource Id: 34916
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  5.443"
.head 5 -  Begin Y:  0.083"
.head 5 -  End X:  5.443"
.head 5 -  End Y:  0.469"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: 3D Shadow Color
.head 3 -  !
.head 3 +  Pushbutton: pbBack
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: &<<
.head 4 -  Window Location and Size
.head 5 -  Left:   2.986"
.head 5 -  Top:    0.125"
.head 5 -  Width:  0.429"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.313"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If NOT bDirectAccess
.head 7 -  Call SalSendMsg( dlg_RefSuch, SAM_Create, 0, 0 )
.head 7 -  Call SalSendMsg( tblBanks, SAM_Create, 0, 0 )
.head 7 -  !
.head 7 -  Set bDirectAccess=TRUE
.head 7 -  Call SalEnableWindow( pbDown )
.head 7 -  Call SalEnableWindow( pbExit )
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Вернуться к "родительскому" МФО' )
.head 3 +  Pushbutton: pbDown
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: >&>
.head 4 -  Window Location and Size
.head 5 -  Left:   3.414"
.head 5 -  Top:    0.125"
.head 5 -  Width:  0.429"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.313"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If bDirectAccess
.head 7 -  Call SalSendMsg( tblBanks, SAM_DoubleClick, 0, 0 )
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, 'Показать "дочерние" МФО' )
.head 3 -  !
.head 3 +  Pushbutton: pbAdd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbInsert
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.043"
.head 5 -  Top:    0.125"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set pbAdd.strTip='Добавить запись об участнике'
.head 5 +  On SAM_Click
.head 6 -  Set nNewRow =  SalTblInsertRow( tblBanks, TBL_MaxRow )
.head 6 +  If nNewRow != TBL_Error
.head 7 -  Call SalTblSetFocusCell( tblBanks, nNewRow, tblBanks.MFO, 0, -1 )
.head 3 +  Pushbutton: pbDel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDelete
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.486"
.head 5 -  Top:    0.125"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set pbDel.strTip='Удалить запись об участнике'
.head 5 +  On SAM_Click
.head 6 -  Call SalTblSetFlagsAnyRows( tblBanks, ROW_MarkDeleted, TRUE, ROW_Selected, 0 )
.head 3 +  Pushbutton: pbAccounts
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbDetail
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.929"
.head 5 -  Top:    0.125"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set pbAccounts.strTip='Показать процессинговые счета учасника'
.head 6 +  If Not bDirectAccess
.head 7 -  Call SalDisableWindow( hWndItem )
.head 5 +  On SAM_Click
.head 6 -  Call ShowTechAccountsEx( SalStrToNumber( tblBanks.MFO ) )
.head 3 +  Pushbutton: pbSave
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbUpdate
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.571"
.head 5 -  Top:    0.125"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set pbSave.strTip='Внести изменения в БД'
.head 5 +  On SAM_Click
.head 6 +  If fReadWrite
.head 7 -  Call BanksApplyChanges()
.head 7 -  Call SalPostMsg( tblBanks, SAM_Create, 0, 0 )
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.017"
.head 5 -  Top:    0.125"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Set pbExit.strTip='Завершить работу'
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, FALSE )
.head 3 -  !
.head 3 +  Pushbutton: pbSystem
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дополнительно
.head 4 -  Window Location and Size
.head 5 -  Left:   25.0"
.head 5 -  Top:    0.131"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.292"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: F12
.head 4 -  Font Name: Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalIsWindowVisible( tblBanks.KODGN )
.head 7 -  Call SalHideWindow( tblBanks.KODGN )
.head 7 -  Call SalHideWindow( tblBanks.FMINAME )
.head 7 -  Call SalHideWindow( tblBanks.FMONAME )
.head 7 -  Call SalHideWindow( tblBanks.PMNAME )
.head 7 -  Call SalHideWindow( tblBanks.KODNNAME )
.head 6 +  Else
.head 7 +  If ShowInputPassword() = FALSE
.head 8 -  Return SalEndDialog( hWndForm, FALSE )
.head 7 -  !
.head 7 -  Call SalShowWindow( tblBanks.KODGN )
.head 7 -  Call SalShowWindow( tblBanks.FMINAME )
.head 7 -  Call SalShowWindow( tblBanks.FMONAME )
.head 7 -  Call SalShowWindow( tblBanks.PMNAME )
.head 7 -  Call SalShowWindow( tblBanks.KODNNAME )
.head 7 -  !
.head 7 +  If fReadWrite
.head 8 -  Call SalEnableWindow( tblBanks.KODGN )
.head 8 -  Call SalEnableWindow( tblBanks.FMINAME )
.head 8 -  Call SalEnableWindow( tblBanks.FMONAME )
.head 8 -  Call SalEnableWindow( tblBanks.PMNAME )
.head 8 -  Call SalEnableWindow( tblBanks.KODNNAME )
.head 3 -  !
.head 3 -  Line
.head 4 -  Resource Id: 34914
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  2.886"
.head 5 -  Begin Y:  0.083"
.head 5 -  End X:  2.886"
.head 5 -  End Y:  0.479"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: 3D Shadow Color
.head 3 -  Line
.head 4 -  Resource Id: 34915
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  3.929"
.head 5 -  Begin Y:  0.083"
.head 5 -  End X:  3.929"
.head 5 -  End Y:  0.479"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 1
.head 4 -  Line Color: 3D Shadow Color
.head 2 +  Functions
.head 3 +  Function: BanksApplyChanges
.head 4 -  Description: Сохраняет изменения в таблице BANKS
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  File Handle: hFile
.head 4 +  Actions
.head 5 -  ! ///////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 5 -  !
.head 5 -  Call WaitCursorOn()
.head 5 -  Call SqlIsolationExclusive( hSql() )
.head 5 -  !
.head 5 +  If SalTblAnyRows( tblBanks, ROW_MarkDeleted, 0 )
.head 6 -  Call SaveInfoToLog( 'Удаление участника(ов) расчетов' )
.head 6 -  !
.head 6 -  Set nRow = TBL_MinRow
.head 6 -  !
.head 6 +  If bDirectAccess
.head 7 +  While SalTblFindNextRow( tblBanks, nRow, ROW_MarkDeleted, 0 )
.head 8 -  Call SalTblFetchRow( tblBanks, nRow )
.head 8 -  !
.head 8 -  Call SalStrTrim( tblBanks.MFO, tblBanks.MFO )
.head 8 -  Call SqlPrepareAndExecute( hSql(), T(
"UPDATE Accounts SET tip ='ODB' 
 WHERE Accounts.tip <> 'T00' AND Accounts.acc
    IN (SELECT b.acc FROM Bank_acc b WHERE trim(b.mfo)=:tblBanks.MFO )" 
) )
.head 8 -  Call SqlPrepareAndExecute( hSql(), T( "DELETE FROM Bank_acc WHERE trim(mfo) = :tblBanks.MFO" ) )
.head 6 -  !
.head 6 -  Set strSqlTxt= " DELETE FROM Banks WHERE rowid=:tblBanks.ROWID"
.head 6 -  !
.head 6 -  Call SqlPrepare( hSql(), T( strSqlTxt ) )
.head 6 -  Call SalTblDoDeletes( tblBanks, hSql(), ROW_MarkDeleted )
.head 6 -  Call SqlCommitEx( hSql(), MSG_SaveDataRef() )
.head 6 -  !
.head 6 -  Call SalTblSetFlagsAnyRows( tblBanks, ROW_MarkDeleted, FALSE, ROW_MarkDeleted, 0 )
.head 5 -  !
.head 5 +  If SalTblAnyRows( tblBanks, ROW_New, 0 )
.head 6 -  Call SaveInfoToLog( 'Добавление участника(ов) расчетов' )
.head 6 -  !
.head 6 -  Set nRow=TBL_MinRow
.head 6 -  !
.head 6 +  While SalTblFindNextRow( tblBanks, nRow, ROW_New, 0 )
.head 7 -  Call SalTblFetchRow( tblBanks, nRow )
.head 7 -  !
.head 7 -  Set InsFld = "( mfo, sab, nb, blk, nmo "
.head 7 -  Set InsTbl = "( :tblBanks.MFO, :tblBanks.SAB, :tblBanks.NB, :tblBanks.BLK, tblBanks.NMO "
.head 7 -  !
.head 7 +  If bDirectAccess
.head 8 +  If Not SalIsNull ( tblBanks.FMI )
.head 9 -  Set InsFld = InsFld || ', fmi'
.head 9 -  Set InsTbl = InsTbl || ', :tblBanks.FMI'
.head 8 +  If Not SalIsNull ( tblBanks.FMO )
.head 9 -  Set InsFld = InsFld || ', fmo'
.head 9 -  Set InsTbl = InsTbl || ', :tblBanks.FMO'
.head 8 +  If Not SalIsNull ( tblBanks.PM )
.head 9 -  Set InsFld = InsFld || ', pm'
.head 9 -  Set InsTbl = InsTbl || ', :tblBanks.PM'
.head 8 +  If Not SalIsNull ( tblBanks.KODN )
.head 9 -  Set InsFld = InsFld || ', kodn'
.head 9 -  Set InsTbl = InsTbl || ', :tblBanks.KODN'
.head 8 -  !
.head 8 -  Set InsFld = InsFld || ', mfop'
.head 8 -  Set InsTbl = InsTbl || ', :strBankMfo'
.head 7 +  Else
.head 8 +  If NOT SalIsNull ( tblBanks.MFOP )
.head 9 -  Set InsFld = InsFld || ', mfop'
.head 9 -  Set InsTbl = InsTbl || ', :tblBanks.MFOP'
.head 7 -  !
.head 7 +  If Not SalIsNull ( tblBanks.KODG )
.head 8 -  Set InsFld = InsFld || ', kodg'
.head 8 -  Set InsTbl = InsTbl || ', :tblBanks.KODG'
.head 7 -  !
.head 7 -  Set strSqlTxt = "INSERT INTO Banks " || InsFld || ") VALUES " || InsTbl || ")"
.head 7 -  !
.head 7 -  ! Call Debug( T(strSqlTxt) )
.head 7 -  Call SqlPrepareAndExecute( hSql(), T( strSqlTxt ) )
.head 6 -  !
.head 6 -  Call SqlCommitEx( hSql(), MSG_SaveDataRef() )
.head 6 -  !
.head 6 -  Call SalTblSetFlagsAnyRows( tblBanks, ROW_New, FALSE, ROW_New, 0 )
.head 6 -  !
.head 6 +  If bDirectAccess
.head 7 -  ! Call SalModalDialog( dlgAccReg, hWndForm )
.head 5 -  !
.head 5 +  If SalTblAnyRows( tblBanks, ROW_Edited, 0 )
.head 6 -  Set nRow=TBL_MinRow
.head 6 -  !
.head 6 +  While SalTblFindNextRow( tblBanks, nRow, ROW_Edited, 0 )
.head 7 -  Call SalTblFetchRow( tblBanks, nRow )
.head 7 -  !
.head 7 -  Set strSqlTxt = "UPDATE Banks SET mfo=:tblBanks.MFO, sab=:tblBanks.SAB, nb=:tblBanks.NB, blk=:tblBanks.BLK, nmo=:tblBanks.NMO"
.head 7 -  !
.head 7 +  If bDirectAccess
.head 8 +  If Not SalIsNull ( tblBanks.FMI )
.head 9 -  Set strSqlTxt = strSqlTxt || ', fmi=:tblBanks.FMI'
.head 8 +  If Not SalIsNull ( tblBanks.FMO )
.head 9 -  Set strSqlTxt = strSqlTxt || ', fmo=:tblBanks.FMO'
.head 8 +  If Not SalIsNull ( tblBanks.PM )
.head 9 -  Set strSqlTxt = strSqlTxt || ', pm=:tblBanks.PM'
.head 8 +  If Not SalIsNull (tblBanks.KODN)
.head 9 -  Set strSqlTxt = strSqlTxt || ', kodn = :tblBanks.KODN'
.head 7 +  Else
.head 8 +  If Not SalIsNull (tblBanks.MFOP)
.head 9 -  Set strSqlTxt = strSqlTxt || ', mfop=:tblBanks.MFOP'
.head 7 +  If Not SalIsNull ( tblBanks.KODG )
.head 8 -  Set strSqlTxt = strSqlTxt || ', kodg = :tblBanks.KODG'
.head 7 -  !
.head 7 -  Set strSqlTxt = strSqlTxt || ' WHERE rowid=:tblBanks.ROWID' 
.head 7 -  ! Call Debug(strSqlTxt) 
.head 7 -  Call SqlPrepareAndExecute( hSql(),  T(strSqlTxt)) 
.head 6 -  !
.head 6 -  Call SalTblSetFlagsAnyRows( tblBanks, ROW_Edited, FALSE, ROW_Edited, 0 )
.head 6 -  !
.head 6 -  Call SqlCommitEx( hSql(), MSG_SaveDataRef() )
.head 5 -  !
.head 5 -  Call SqlIsolationNormal( hSql() )
.head 5 -  !
.head 5 +  If fBlkRedirect
.head 6 +  If MessageQuestion( 'Формировать файлы СЭП K с новыми признаками блокировки на участников?' ) = IDYES
.head 7 +  If SalFileOpen( hFile, GetIntDir() || FILE_K(), OF_Create | OF_Binary | OF_Write ) = TRUE
.head 8 -  Call SalFileClose( hFile )
.head 6 -  !
.head 6 -  Set fBlkRedirect = FALSE
.head 5 -  !
.head 5 -  Call WaitCursorOff()
.head 5 -  !
.head 5 -  ! ///////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 2 +  Window Parameters
.head 3 -  Boolean: fReadWrite
.head 2 +  Window Variables
.head 3 -  ! /////////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 3 -  !
.head 3 -  String: strBankMfo
.head 3 -  !
.head 3 -  Boolean: bDirectAccess
.head 3 -  String: strSeniorMfo
.head 3 -  !
.head 3 -  Number: maxRNK
.head 3 -  String: InsFld
.head 3 -  String: InsTbl
.head 3 -  String: strGrName
.head 3 -  String: strSqlTxt
.head 3 -  Boolean: fBlkRedirect
.head 3 -  !
.head 3 -  ! /////////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow( hWndForm )
.head 4 -  Call XSalTooltipSetUserDefault( )
.head 4 -  !
.head 4 -  Set strBankMfo=GetBankMfo()
.head 4 -  !
.head 4 -  Set bDirectAccess=TRUE
.head 4 -  Set strSeniorMfo=''
.head 4 -  Set dfSeekMfo=''
.head 4 -  !
.head 4 -  Call SalSetWindowText( hWndForm, 'Прямые Участники Расчетной Палаты' )
.head 4 -  !
.head 4 +  If NOT fReadWrite
.head 5 -  Call SalDisableWindow( pbAdd )
.head 5 -  Call SalDisableWindow( pbDel )
.head 5 -  Call SalDisableWindow( pbSave )
.head 5 -  !
.head 5 -  Call SalDisableWindow( tblBanks.MFO )
.head 5 -  Call SalDisableWindow( tblBanks.SAB )
.head 5 -  Call SalDisableWindow( tblBanks.MFOP )
.head 5 -  Call SalDisableWindow( tblBanks.NB )
.head 5 -  Call SalDisableWindow( tblBanks.KODGN )
.head 5 -  Call SalDisableWindow( tblBanks.FMINAME )
.head 5 -  Call SalDisableWindow( tblBanks.FMONAME )
.head 5 -  Call SalDisableWindow( tblBanks.PMNAME )
.head 5 -  Call SalDisableWindow( tblBanks.KODNNAME )
.head 5 -  Call SalDisableWindow( tblBanks.NMO )
.head 4 -  !
.head 4 -  Call SalDisableWindow( pbBack )
.head 4 -  Call SalDisableWindow( pbAccounts )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call WaitCursorOff()
.head 1 -  !
.head 1 -  ! Настройка операций
.head 1 +  Table Window: frm_OperList
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Настройка шаблонов операций
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   2.475"
.head 4 -  Top:    1.396"
.head 4 -  Width:  10.067"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.988"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 20000
.head 3 -  Discardable? Class Default
.head 2 -  Description: Настройка шаблонов операций(Tts)
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 7 -  Set fSaved = TRUE
.head 4 -  Line
.head 5 -  Resource Id: 62138
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  5.75"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  5.75"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 37778
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  6.817"
.head 6 -  Begin Y:  -0.071"
.head 6 -  End X:  6.817"
.head 6 -  End Y:  0.5"
.head 5 -  Visible? No
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Enter
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 62139
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  5.083"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  5.083"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbToFile
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRelation
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \Bars98\RESOURCE\BMP\DOC_IN.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Экспорт операций в текстовый файл
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_OperList.cBTipToFile')
.head 6 +  On SAM_Click
.head 7 -  Call DumpOperationsToFile()
.head 4 -  Line
.head 5 -  Resource Id: 4235
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  3.85"
.head 6 -  Begin Y:  0.012"
.head 6 -  End X:  3.85"
.head 6 -  End Y:  0.476"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.217"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 62140
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExp
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.883"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\todisk.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Экспорт настройки операций в набор *.dbf файлов
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_OperList.cBTipExp')
.head 6 +  On SAM_Click
.head 7 -  ! Call SalUseRegistry(FALSE, '')
.head 7 -  ! Call SalGetProfileString( 'Import', 'IE_Tts', '', sEI_Path, GetIniFileName() )
.head 7 -  ! Call XConnectGetParams( cParamsFetcher )
.head 7 -  ! Set sCnc = cParamsFetcher.strUserName || '/' || cParamsFetcher.strPassword || '@' || cParamsFetcher.strDBName
.head 7 -  ! Call ExportTts( sCnc, sEI_Path, 0 )
.head 7 -  ! Call SalLoadApp( 'ExpTts.exe', sCnc||' '||sEI_Path||' 0' )
.head 7 -  ! Call SalSetFocus( frm_OperList )
.head 4 +  Pushbutton: pbImp
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.317"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\fromdisk.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Синхронизация настройки операций из набора *.dbf файлов
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_OperList.cBTipImp')
.head 6 +  On SAM_Click
.head 7 -  ! Call SalUseRegistry(FALSE, '')
.head 7 -  ! Call SalGetProfileString( 'Import', 'IE_Tts', '', sEI_Path, GetIniFileName() )
.head 7 -  ! Call XConnectGetParams( cParamsFetcher )
.head 7 -  ! Set sCnc = cParamsFetcher.strUserName || '/' || cParamsFetcher.strPassword || '@' || cParamsFetcher.strDBName
.head 7 -  ! Call ExportTts( sCnc, sEI_Path, 0 )
.head 7 -  ! Set nFlags=SalModalDialog( dlg_ImpOptions, hWndMDI )
.head 7 +  ! If nFlags>=0
.head 8 -      Call SalLoadApp( 'ImpTts.exe', sCnc||' '||sEI_Path||' 0' )
.head 8 -      Call SalSetFocus( frm_OperList )
.head 4 +  Pushbutton: pbExportSelected
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.55"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\todisk.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Экспорт выбранных операций в SQL сценарий
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_OperList.cBTipExportSelected')
.head 6 +  On SAM_Click
.head 7 -  Call DoExportSelected()
.head 2 +  Contents
.head 3 +  Column: colTT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.783"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Uppercase
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On WM_KeyUp
.head 6 -  Set fSaved=FALSE
.head 3 +  Column: colTT_NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Название банковской операции
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 70
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  8.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On WM_KeyUp
.head 6 -  Set fSaved=FALSE
.head 3 +  Column: colTT_BRANCH
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отделение
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 30
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  8.383"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On WM_KeyUp
.head 6 -  Set fSaved=FALSE
.head 2 +  Functions
.head 3 -  ! Показать детальную информацию об операции
.head 3 +  Function: ShowOperDetail
.head 4 -  Description: Показать детальную информацию об операции
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hParent
.head 5 -  String: strOperId
.head 5 -  Number: Option
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If strOperId != STRING_Null
.head 6 -  Call SalModalDialog( dlg_OperCard, hParent, strOperId, cMain.hSql(),Option)
.head 3 -  ! Возвращает информацию об операции по коду
.head 3 +  ! Function: OperationInfo
.head 4 -     Description: Возвращает информацию об операции по коду
.head 4 +     Returns 
.head 5 -     String: 
.head 4 +     Parameters 
.head 5 -     String: strTT
.head 4 -     Static Variables 
.head 4 +     Local variables 
.head 5 -     String: sCurLine
.head 5 -     String: sSqlText
.head 5 -     Number: nPiRes
.head 5 -     String: sEOL
.head 5 -     Number: nFLV
.head 5 -     Number: nFLC
.head 5 -     Boolean: fHead
.head 5 -     Number: n1
.head 5 -     String: s1
.head 5 -     String: s2
.head 5 -     String: strResult
.head 5 -     Sql Handle: hMainSql
.head 4 +     Actions 
.head 5 -     Set sEOL=SalNumberToChar( 13 ) || SalNumberToChar( 10 )
.head 5 -     Set hMainSql=cMain.hSql()
.head 5 -     Set strResult=''
.head 5 -     Set sSqlText=
"SELECT a.tt || '  ' || a.name || '(' || b.name || ')' 
INTO :sCurLine 
FROM tts a, dk b 
WHERE a.dk=b.dk and tt=:strTT"
.head 5 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 5 +     If SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 6 -  ! Наименование
.head 6 -     Set strResult=strResult || sCurLine
.head 6 -     Set sSqlText=
"SELECT '    Тип Операции: ' || b.name
INTO :sCurLine 
FROM tts a,interbank b 
WHERE a.fli=b.fli and a.tt=:strTT"
.head 6 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 6 +     If SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 7 -     Set strResult=strResult || sEOL || sCurLine
.head 6 -  ! Общие свойства
.head 6 -     Set sSqlText=
"SELECT '    МФО Б: ' || mfob 
INTO :sCurLine 
FROM tts 
WHERE tt=:strTT"
.head 6 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 6 +     If SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 7 -     Set strResult=strResult || sEOL || sCurLine
.head 6 -  !
.head 6 -     Set strResult=strResult || sEOL
.head 6 -  !
.head 6 -     Set sSqlText=
"SELECT '    Счет А для оплаты: '|| nlsm || '(' || kv || ')'
INTO :sCurLine 
FROM tts 
WHERE tt=:strTT"
.head 6 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 6 +     If SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 7 -     Set strResult=strResult || sEOL || sCurLine
.head 6 -  !
.head 6 -     Set sSqlText=
"SELECT '    Счет Б для оплаты: '|| nlsk || '(' || kvk || ')' 
INTO :sCurLine 
FROM tts 
WHERE tt=:strTT"
.head 6 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 6 +     If SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 7 -     Set strResult=strResult || sEOL || sCurLine
.head 6 -  !
.head 6 -     Set sSqlText=
"SELECT '    Счет А для ввода: ' || nlsa   
INTO :sCurLine 
FROM tts 
WHERE tt=:strTT"
.head 6 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 6 +     If SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 7 -     Set strResult=strResult || sEOL || sCurLine
.head 6 -  !
.head 6 -     Set sSqlText=
"SELECT '    Счет Б для ввода: ' || nlsb 
INTO :sCurLine 
FROM tts 
WHERE tt=:strTT"
.head 6 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 6 +     If SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 7 -     Set strResult=strResult || sEOL || sCurLine
.head 6 -  !
.head 6 -     Set strResult=strResult || sEOL
.head 6 -     Set sSqlText=
"SELECT '    Символ кассы: ' || sk 
INTO :sCurLine 
FROM tts 
WHERE tt=:strTT"
.head 6 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 6 +     If SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 7 -     Set strResult=strResult || sEOL || sCurLine
.head 6 -  !
.head 6 -     Set strResult=strResult || sEOL
.head 6 -     Set sSqlText=
"SELECT s 
INTO :sCurLine 
FROM tts 
WHERE tt=:strTT"
.head 6 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 6 +     If SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 7 -     Set strResult=strResult || sEOL || '    Формула суммы: ' || sCurLine
.head 6 -  !
.head 6 -     Set sSqlText=
"SELECT s2 
INTO :sCurLine 
FROM tts 
WHERE tt=:strTT"
.head 6 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 6 +     If SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 7 -     Set strResult=strResult || sEOL || '    Формула суммы 2: ' || sCurLine
.head 6 -  !
.head 6 -     Set sSqlText=
"SELECT '    Приоритет: ' || rang 
INTO :sCurLine 
FROM tts 
WHERE tt=:strTT"
.head 6 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 6 +     If SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 7 -     Set strResult=strResult || sEOL
.head 7 -     Set strResult=strResult || sEOL || sCurLine
.head 6 -  ! Свойства мультивалютной
.head 6 -     Set sSqlText=
"SELECT flv 
INTO :nFLV 
FROM tts 
WHERE tt=:strTT"
.head 6 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 6 +     If SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 7 +     If nFLV
.head 8 -     Set strResult=strResult || sEOL
.head 8 -     Set strResult=strResult || sEOL || "  Свойства мультивалютной операции"
.head 8 -  !
.head 8 -     Set sSqlText=
"SELECT '    Счет вал. позиции: '||s3800 
INTO :sCurLine 
FROM tts 
WHERE tt=:strTT"
.head 8 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 8 +     If SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 9 -     Set strResult=strResult || sEOL || sCurLine
.head 8 -  !
.head 8 -     Set sSqlText=
"SELECT '    Счет доходов: ' || b.nls || '(' || b.kv || ')' 
INTO :sCurLine 
FROM tts a, accounts b 
WHERE a.s6201=b.acc and a.tt=:strTT"
.head 8 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 8 +     If SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 9 -     Set strResult=strResult || sEOL || sCurLine
.head 8 -  !
.head 8 -     Set sSqlText=
"SELECT '    Счет расходов: ' || b.nls || '(' || b.kv || ')' 
INTO :sCurLine 
FROM tts a, accounts b 
WHERE a.s7201=b.acc and a.tt=:strTT"
.head 8 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 8 +     If SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 9 -     Set strResult=strResult || sEOL || sCurLine
.head 6 -  ! Связанные операции
.head 6 -     Set sSqlText=
"SELECT flc 
INTO :nFLC 
FROM tts 
WHERE tt=:strTT"
.head 6 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 6 +     If SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 7 +     If nFLC
.head 8 -     Set strResult=strResult || sEOL
.head 8 -     Set strResult=strResult || sEOL || "  Связанные операции"
.head 8 -  !
.head 8 -     Set sSqlText=
"SELECT a.tt || ' ' || a.name|| ' (Инверсия Д/К=' || NVL(b.dk,0) || ')' 
INTO :sCurLine 
FROM tts a, ttsap b 
WHERE a.tt=b.ttap and b.tt=:strTT
ORDER BY a.tt"
.head 8 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 8 +     While SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 9 -     Set strResult=strResult || sEOL || "    " || sCurLine
.head 6 -  ! Флаги
.head 6 -     Set fHead=FALSE
.head 6 -     Set strResult=strResult || sEOL
.head 6 -     Set sSqlText=
"SELECT f.code || ' - ' || f.name || ' (' || l.Value ||')' 
INTO :sCurLine 
FROM flags f, tts_flags l 
WHERE f.code=l.fcode AND l.tt=:strTT
ORDER BY 1"
.head 6 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 6 +     While SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 7 +     If NOT fHead
.head 8 -     Set strResult=strResult || sEOL || "  Флаги:"
.head 8 -     Set fHead=TRUE
.head 7 -     Set strResult=strResult || sEOL || "    " || sCurLine
.head 6 +     If NOT fHead
.head 7 -     Set strResult=strResult || sEOL || "  Флаги отсутствуют"
.head 6 -  ! Доп. реквизиты
.head 6 -     Set fHead=FALSE
.head 6 -     Set strResult=strResult || sEOL
.head 6 -     Set sSqlText=
"SELECT l.ord || ' - <' || r.tag || '> ' || r.Name, l.opt, l.used4input, l.val 
INTO :sCurLine, :s1, :n1, :s2 
FROM op_field r, op_rules l 
WHERE r.tag=l.tag AND l.tt=:strTT
ORDER BY l.ord, r.tag"
.head 6 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 6 +     While SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 7 +     If NOT fHead
.head 8 -     Set strResult=strResult || sEOL || "  Доп. реквизиты:"
.head 8 -     Set fHead=TRUE
.head 7 +     If s1="M"
.head 8 -     Set s1="Обязательный"
.head 7 +     Else 
.head 8 -     Set s1="Необязательный"
.head 7 +     If n1
.head 8 -     Set s1="Использовать для ввода," || s1
.head 7 +     Else 
.head 8 -     Set s1="Не использовать для ввода," || s1
.head 7 -     Set strResult=strResult || sEOL || "    " || sCurLine || "(" || s1 || ")"
.head 7 +     If s2
.head 8 -     Set strResult=strResult || " - " || s2
.head 6 +     If NOT fHead
.head 7 -     Set strResult=strResult || sEOL || "  Доп. реквизиты отсутствуют"
.head 6 -  ! Бал. счета
.head 6 -     Set fHead=FALSE
.head 6 -     Set sSqlText=
"SELECT s.nbs || ' ' || s.name, l.dk 
INTO :sCurLine, :n1 
FROM ps s,ps_tts l 
WHERE s.nbs=l.nbs AND l.tt=:strTT
ORDER BY 1"
.head 6 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 6 +     While SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 7 +     If NOT fHead
.head 8 -     Set strResult=strResult || sEOL
.head 8 -     Set strResult=strResult || sEOL || "  Допустимые балансовые счета:"
.head 8 -     Set fHead=TRUE
.head 7 +     If n1
.head 8 -     Set s1="Кредитовать"
.head 7 +     Else 
.head 8 -     Set s1="Дебетовать"
.head 7 -     Set strResult=strResult || sEOL || "    " || sCurLine || " (" || s1 || ")"
.head 6 -  ! Виды док-тов
.head 6 -     Set fHead=FALSE
.head 6 -     Set strResult=strResult || sEOL
.head 6 -     Set sSqlText=
"SELECT v.name || ' (' || UPPER ( v.rep_prefix ) || ')' 
INTO :sCurLine 
FROM vob v, tts_vob l 
WHERE v.vob=l.vob AND l.tt=:strTT
ORDER BY 1"
.head 6 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 6 +     While SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 7 +     If NOT fHead
.head 8 -     Set strResult=strResult || sEOL || "  Виды док-тов:"
.head 8 -     Set fHead=TRUE
.head 7 -     Set strResult=strResult || sEOL || "    " || sCurLine
.head 6 +     If NOT fHead
.head 7 -     Set strResult=strResult || sEOL || "  Виды док-тов отсутствуют"
.head 6 -  ! Визы
.head 6 -     Set fHead=FALSE
.head 6 -     Set strResult=strResult || sEOL
.head 6 -     Set sSqlText=
"SELECT l.priority || ' ' || c.name 
INTO :sCurLine 
FROM chklist c, chklist_tts l 
WHERE c.idchk=l.idchk AND l.tt=:strTT
ORDER BY l.priority"
.head 6 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 6 +     While SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 7 +     If NOT fHead
.head 8 -     Set strResult=strResult || sEOL || "  Группы контроля:"
.head 8 -     Set fHead=TRUE
.head 7 -     Set strResult=strResult || sEOL || "    " || sCurLine
.head 6 +     If NOT fHead
.head 7 -     Set strResult=strResult || sEOL || "  Группы контроля отсутствуют"
.head 6 -  ! Пользователи
.head 6 -     Set fHead=FALSE
.head 6 -     Set strResult=strResult || sEOL
.head 6 -     Set sSqlText=
"SELECT value 
INTO :nFLV
FROM tts_flags 
WHERE fcode=0 AND tt=:strTT"
.head 6 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 6 +     If SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 7 -     Set sSqlText=
"SELECT s.id || ' ' || s.fio 
INTO :sCurLine 
FROM staff s, staff_tts l 
WHERE s.id=l.id AND l.tt=:strTT
ORDER BY s.id"
.head 7 -     Call SqlPrepareAndExecute( hMainSql, sSqlText )
.head 7 +     While SqlFetchNext( hMainSql, nPiRes ) and nPiRes=FETCH_Ok
.head 8 +     If NOT fHead
.head 9 -     Set strResult=strResult || sEOL || "  Операция доступна на ввод следующим пользователям:"
.head 9 -     Set fHead=TRUE
.head 8 -     Set strResult=strResult || sEOL || "    " || sCurLine
.head 7 +     If NOT fHead
.head 8 -     Set strResult=strResult || sEOL || "  Операция доступна на ввод, но не дана ни одному пользователю"
.head 6 +     Else 
.head 7 -     Set strResult=strResult || sEOL || "  Операция недоступна на ввод"
.head 5 -     Return strResult
.head 3 +  Function: OperationInfo
.head 4 -  Description: Возвращает информацию об операции по коду
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: strTT
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sCurLine
.head 5 -  String: sCurLine1
.head 5 -  String: sSqlText
.head 5 -  Number: nPiRes
.head 5 -  String: sEOL
.head 5 -  Number: nFLV
.head 5 -  Number: nFLC
.head 5 -  Boolean: fHead
.head 5 -  Number: n1
.head 5 -  String: s1
.head 5 -  String: s2
.head 5 -  String: strResult
.head 5 -  Sql Handle: hMainSql
.head 4 +  Actions
.head 5 -  Set sEOL = SalNumberToChar(13) || SalNumberToChar(10)
.head 5 -  Set hMainSql = cMain.hSql()
.head 5 -  Set strResult = ''
.head 5 -  Set sSqlText = "SELECT a.tt || '  ' || a.name || '(' || b.name || ')' INTO :sCurLine FROM tts a, dk b WHERE a.dk=b.dk and tt=:strTT"
.head 5 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 5 +  If SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok
.head 6 -  ! Наименование
.head 6 -  Set strResult = strResult || sCurLine
.head 6 -  Set sSqlText = "SELECT b.name INTO :sCurLine FROM tts a,interbank b WHERE a.fli=b.fli and a.tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 6 +  If SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Тип Операции: ' || sCurLine
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgOperType') || ': ' || sCurLine
.head 6 -  ! Общие свойства
.head 6 -  Set sSqlText = "SELECT mfob INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 6 +  If SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    МФО Б: ' || sCurLine
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgMfoB') || ': ' || sCurLine
.head 6 -  Set strResult = strResult || sEOL
.head 6 -  !
.head 6 -  Set sSqlText = "SELECT nlsm, kv INTO :sCurLine, :sCurLine1 FROM tts WHERE tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 6 +  If SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Счет А для оплаты: '|| sCurLine
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgAccA') || ': ' || sCurLine || IifS(sCurLine1!='','('||sCurLine1||')','')
.head 6 -  !
.head 6 -  Set sSqlText = "SELECT nlsk, kvk INTO :sCurLine, :sCurLine1 FROM tts WHERE tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 6 +  If SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Счет Б для оплаты: '|| sCurLine
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgAccB') || ': '|| sCurLine || IifS(sCurLine1!='','('||sCurLine1||')','')
.head 6 -  !
.head 6 -  Set sSqlText = "SELECT nlsa INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 6 +  If SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Счет А для ввода: ' || sCurLine
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgBankA') || ': ' || sCurLine
.head 6 -  !
.head 6 -  Set sSqlText = "SELECT nlsb INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 6 +  If SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Счет Б для ввода: ' || sCurLine
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgBankB') || ': ' || sCurLine
.head 6 -  Set strResult = strResult || sEOL
.head 6 -  !
.head 6 -  Set sSqlText = "SELECT sk INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 6 +  If SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Символ кассы: ' || sCurLine
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgSKP') || ': ' || sCurLine
.head 6 -  Set strResult = strResult || sEOL
.head 6 -  !
.head 6 -  Set sSqlText = "SELECT s INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 6 +  If SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Формула суммы: ' || sCurLine
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgSum') || ': ' || sCurLine
.head 6 -  !
.head 6 -  Set sSqlText = "SELECT s2 INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 6 +  If SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Формула суммы 2: ' || sCurLine
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgSum2') || ': ' || sCurLine
.head 6 -  !
.head 6 -  Set sSqlText = "SELECT rang INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 6 +  If SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok
.head 7 -  Set strResult = strResult || sEOL
.head 7 -  ! Set strResult=strResult || sEOL || '    Приоритет: ' || sCurLine
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTPriority') || ': ' || sCurLine
.head 6 -  ! Свойства мультивалютной
.head 6 -  Set sSqlText = "SELECT flv INTO :nFLV FROM tts WHERE tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 6 +  If SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok
.head 7 +  If nFLV
.head 8 -  Set strResult = strResult || sEOL
.head 8 -  ! Set strResult=strResult || sEOL || "  Свойства мультивалютной операции"
.head 8 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMultiVal')
.head 8 -  !
.head 8 -  Set sSqlText = "SELECT s3800 INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 8 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 8 +  If SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok
.head 9 -  ! Set strResult=strResult || sEOL || '    Счет вал. позиции: '||sCurLine
.head 9 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgAccVP') || ': '||sCurLine
.head 8 -  !
.head 8 -  Set sSqlText = "SELECT b.nls || '(' || b.kv || ')' INTO :sCurLine FROM tts a, accounts b WHERE a.s6201=b.acc and a.tt=:strTT"
.head 8 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 8 +  If SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok
.head 9 -  ! Set strResult=strResult || sEOL || '    Счет доходов: ' || sCurLine
.head 9 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgAccInc') || ': ' || sCurLine
.head 8 -  !
.head 8 -  Set sSqlText = "SELECT b.nls || '(' || b.kv || ')' INTO :sCurLine FROM tts a, accounts b WHERE a.s7201=b.acc and a.tt=:strTT"
.head 8 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 8 +  If SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok
.head 9 -  ! Set strResult=strResult || sEOL || '    Счет расходов: ' || sCurLine
.head 9 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgAccExp') || ': ' || sCurLine
.head 6 -  ! Связанные операции
.head 6 -  Set sSqlText = "SELECT flc INTO :nFLC FROM tts WHERE tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 6 +  If SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok
.head 7 +  If nFLC
.head 8 -  Set strResult = strResult || sEOL
.head 8 -  ! Set strResult=strResult || sEOL || "  Связанные операции"
.head 8 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs2') || ':'
.head 8 -  !
.head 8 -  Set sSqlText =
"SELECT a.tt || ' ' || a.name, NVL(b.dk,0) 
 INTO :sCurLine, :sCurLine1  
 FROM tts a, ttsap b 
 WHERE a.tt=b.ttap and b.tt=:strTT
 ORDER BY a.tt"
.head 8 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 8 +  While SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok
.head 9 -  Set strResult = strResult || sEOL || '    ' || sCurLine || 
    ' (' || CurrentLangTable.GetAtomTitle('dlg_OperCard.cTInvDC') || '=' || sCurLine1 || ')'
.head 6 -  Set strResult = strResult || sEOL
.head 6 -  ! Флаги
.head 6 -  Set fHead = FALSE
.head 6 -  Set sSqlText =
"SELECT f.code || ' - ' || f.name || ' (' || l.Value ||')' 
 INTO :sCurLine 
 FROM flags f, tts_flags l 
 WHERE f.code=l.fcode AND l.tt=:strTT
 ORDER BY 1"
.head 6 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 6 +  While SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok
.head 7 +  If NOT fHead
.head 8 -  ! Set strResult=strResult || sEOL || "  Флаги:"
.head 8 -  Set strResult=strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTFlags') || ':'
.head 8 -  Set fHead = TRUE
.head 7 -  Set strResult = strResult || sEOL || "    " || sCurLine
.head 6 +  If NOT fHead
.head 7 -  ! Set strResult=strResult || sEOL || "  Флаги отсутствуют"
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTNotFlags')
.head 6 -  Set strResult = strResult || sEOL
.head 6 -  ! Доп. реквизиты
.head 6 -  Set fHead = FALSE
.head 6 -  Set sSqlText =
"SELECT l.ord || ' - <' || r.tag || '> ' || r.Name, l.opt, l.used4input, l.val 
 INTO :sCurLine, :s1, :n1, :s2 
 FROM op_field r, op_rules l 
 WHERE r.tag=l.tag AND l.tt=:strTT
 ORDER BY l.ord, r.tag"
.head 6 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 6 +  While SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok
.head 7 +  If NOT fHead
.head 8 -  ! Set strResult=strResult || sEOL || "  Доп. реквизиты:"
.head 8 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTDopR') || ':'
.head 8 -  Set fHead = TRUE
.head 7 +  If s1 = "M"
.head 8 -  ! Set s1="Обязательный"
.head 8 -  Set s1 = CurrentLangTable.GetAtomTitle('dlg_OperCard.cTOpt')
.head 7 +  Else
.head 8 -  ! Set s1="Необязательный"
.head 8 -  Set s1 = CurrentLangTable.GetAtomTitle('dlg_OperCard.cTNotOpt')
.head 7 +  If n1
.head 8 -  ! Set s1="Использовать для ввода," || s1
.head 8 -  Set s1 = CurrentLangTable.GetAtomTitle('dlg_OperCard.cTForInput') || "," || s1
.head 7 +  Else
.head 8 -  ! Set s1="Не использовать для ввода," || s1
.head 8 -  Set s1 = CurrentLangTable.GetAtomTitle('dlg_OperCard.cTNotForInput') || "," || s1
.head 7 -  Set strResult = strResult || sEOL || "    " || sCurLine || "(" || s1 || ")"
.head 7 +  If s2
.head 8 -  Set strResult = strResult || " - " || s2
.head 6 +  If NOT fHead
.head 7 -  ! Set strResult=strResult || sEOL || "  Доп. реквизиты отсутствуют"
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTNotDopR')
.head 6 -  ! Бал. счета
.head 6 -  Set fHead = FALSE
.head 6 -  Set sSqlText =
"SELECT s.nbs || ' ' || s.name, l.dk 
 INTO :sCurLine, :n1 
 FROM ps s,ps_tts l 
 WHERE s.nbs=l.nbs AND l.tt=:strTT
 ORDER BY 1"
.head 6 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 6 +  While SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok
.head 7 +  If NOT fHead
.head 8 -  Set strResult = strResult || sEOL
.head 8 -  ! Set strResult=strResult || sEOL || "  Допустимые балансовые счета:"
.head 8 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTBalAcc') || ':'
.head 8 -  Set fHead = TRUE
.head 7 +  If n1
.head 8 -  ! Set s1="Кредитовать"
.head 8 -  Set s1 = CurrentLangTable.GetAtomTitle('dlg_OperCard.cTCred')
.head 7 +  Else
.head 8 -  ! Set s1="Дебетовать"
.head 8 -  Set s1 = CurrentLangTable.GetAtomTitle('dlg_OperCard.cTDeb')
.head 7 -  Set strResult=strResult || sEOL || "    " || sCurLine || " (" || s1 || ")"
.head 6 -  Set strResult = strResult || sEOL
.head 6 -  ! Виды док-тов
.head 6 -  Set fHead = FALSE
.head 6 -  Set sSqlText =
"SELECT v.name || ' (' || UPPER ( v.rep_prefix ) || ')' 
 INTO :sCurLine 
 FROM vob v, tts_vob l 
 WHERE v.vob=l.vob AND l.tt=:strTT
 ORDER BY 1"
.head 6 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 6 +  While SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok
.head 7 +  If NOT fHead
.head 8 -  ! Set strResult=strResult || sEOL || "  Виды док-тов:"
.head 8 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs4') || ':'
.head 8 -  Set fHead = TRUE
.head 7 -  Set strResult = strResult || sEOL || "    " || sCurLine
.head 6 +  If NOT fHead
.head 7 -  ! Set strResult=strResult || sEOL || "  Виды док-тов отсутствуют"
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTNotVidDoc')
.head 6 -  Set strResult = strResult || sEOL
.head 6 -  ! Визы
.head 6 -  Set fHead = FALSE
.head 6 -  Set sSqlText =
"SELECT l.priority || ' ' || c.name 
 INTO :sCurLine 
 FROM chklist c, chklist_tts l 
 WHERE c.idchk=l.idchk AND l.tt=:strTT
 ORDER BY l.priority"
.head 6 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 6 +  While SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok
.head 7 +  If NOT fHead
.head 8 -  ! Set strResult=strResult || sEOL || "  Группы контроля:"
.head 8 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs5') || ':'
.head 8 -  Set fHead = TRUE
.head 7 -  Set strResult = strResult || sEOL || "    " || sCurLine
.head 6 +  If NOT fHead
.head 7 -  ! Set strResult=strResult || sEOL || "  Группы контроля отсутствуют"
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTNotGroups')
.head 6 -  Set strResult = strResult || sEOL
.head 6 -  ! Пользователи
.head 6 -  Set fHead = FALSE
.head 6 -  Set sSqlText = "SELECT value INTO :nFLV FROM tts_flags WHERE fcode=0 AND tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 6 +  If SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok and nFLV != 0
.head 7 -  Set sSqlText =
"SELECT s.id || ' ' || s.fio 
 INTO :sCurLine 
 FROM staff s, staff_tts l 
 WHERE s.id=l.id AND l.tt=:strTT
 ORDER BY s.id"
.head 7 -  Call SqlPrepareAndExecute(hMainSql, sSqlText)
.head 7 +  While SqlFetchNext(hMainSql, nPiRes) and nPiRes=FETCH_Ok
.head 8 +  If NOT fHead
.head 9 -  ! Set strResult=strResult || sEOL || "  Операция доступна на ввод следующим пользователям:"
.head 9 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTOperAccess') || ':'
.head 9 -  Set fHead = TRUE
.head 8 -  Set strResult = strResult || sEOL || "    " || sCurLine
.head 7 +  If NOT fHead
.head 8 -  ! Set strResult=strResult || sEOL || "  Операция доступна на ввод, но не дана ни одному пользователю"
.head 8 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTOperAccess1')
.head 6 +  Else
.head 7 -  ! Set strResult=strResult || sEOL || "  Операция недоступна на ввод"
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) || 
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTOperAccess2')
.head 5 -  Return strResult
.head 3 -  ! Выгрузка всех показанных операций в текстовый файл
.head 3 +  Function: DumpOperationsToFile
.head 4 -  Description: Выгрузка всех показанных операций в текстовый файл
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  !
.head 5 -  : cForSelect
.head 6 -  Class: cABSConnect
.head 5 -  : cSelect
.head 6 -  Class: cGenQuery
.head 5 -  String: strSelect
.head 5 -  Number: nFetchRes
.head 5 -  String: strCurTT
.head 5 -  String: sEOL
.head 5 -  !
.head 5 -  File Handle: hFile
.head 5 -  String: sFileName
.head 4 +  Actions
.head 5 -  Set sEOL = SalNumberToChar(13) || SalNumberToChar(10)
.head 5 -  Call WaitCursorOn()
.head 5 -  ! Делаем соед.
.head 5 -  Call XConnectGetParams(cForSelect)
.head 5 +  If cForSelect.Connect()
.head 6 -  ! Получаем SQL через фильтр
.head 6 -  Call cSelect.Init('SELECT tt INTO :strCurTT FROM tts')
.head 6 -  Set strSelect = cSelect.GetFullSQLString(frm_OperList.cF)
.head 6 -  ! Выполняем SQL
.head 6 +  If SqlPrepareAndExecute(cForSelect.hSql(), strSelect)
.head 7 -  ! Откр. файл
.head 7 -  Set sFileName = GetPrnDir() || "\\TTS" || SalNumberToStrX(SalDateHour(Date()), 0) || SalNumberToStrX(SalDateMinute(Date()), 0) || '.txt'
.head 7 +  If VisFileOpen(hFile, sFileName, OF_Create) = VTERR_Ok
.head 8 -  ! Выполняем выброс в файл
.head 8 +  Loop
.head 9 +  If SqlFetchNext(cForSelect.hSql(), nFetchRes) and (nFetchRes=FETCH_Ok)
.head 10 -  Call VisFileWriteString(hFile, SalStrRepeatX('-', 80) || sEOL)
.head 10 -  Call VisFileWriteString(hFile, OperationInfo(strCurTT))
.head 9 +  Else
.head 10 -  Break
.head 8 -  Call VisFileWriteString(hFile, SalStrRepeatX('-', 80) || sEOL)
.head 8 -  Call VisFileClose(hFile)
.head 8 -  ! Call DosDirectPrint( sFileName )
.head 8 -  ! Call SalMessageBox( 'Информация помещена в файл' || sEOL || sFileName, 'Информация', MB_Ok | MB_IconAsterisk )
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_OperList.cTMsgInfToFile') || sEOL || sFileName, 
     CurrentLangTable.GetAtomTitle('cTInfo'), MB_Ok | MB_IconAsterisk)
.head 6 -  Call cForSelect.Disconnect()
.head 5 -  Call WaitCursorOff()
.head 3 -  !
.head 3 +  Function: DoExportSelected
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  ! № строки и колонки для событий
.head 5 -  Number: nTmpRowNumber
.head 5 -  Number: nTmpPriRowNumber
.head 5 -  String: strTmpFileCont
.head 5 -  File Handle: hTmpFile
.head 5 -  Number: nTmpOptions
.head 5 -  String: strTmpFileName
.head 4 +  Actions
.head 5 +  If NOT SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 6 -  ! Call SalMessageBox( 'Ни одна операция не выбранна!', 'Ошибка', MB_IconStop | MB_Ok )
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_OperList.cTMsgOperNotSelect'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop | MB_Ok)
.head 6 -  Return FALSE
.head 5 +  If SalModalDialog(dlg_OperExpOpts, hWndForm, strTmpFileName, nTmpOptions, nFlIns, colTT)
.head 6 +  If NOT nTmpOptions
.head 7 -  ! Call SalMessageBox( 'Ничего не выбранно для экспорта!', 'Ошибка', MB_IconStop | MB_Ok )
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_OperList.cTMsgExpNotSelect'), 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop | MB_Ok)
.head 7 -  Return FALSE
.head 6 -  Set nTmpPriRowNumber = SalTblQueryContext(hWndForm)
.head 6 -  Set nTmpRowNumber = TBL_MinRow 
.head 6 -  ! Сброс массива операций - подготовка функции SG_OperToString к работе
.head 6 -  Set strTmpFileCont = SG_OperToString('', '', 0)
.head 6 -  Set strTmpFileCont = 'SET LINES 1000
SET TRIMSPOOL ON
SET SERVEROUTPUT ON SIZE 1000000
SET FEED OFF

'
.head 6 -  Call WaitCursorOn()
.head 6 +  While TRUE
.head 7 +  If SalTblFindNextRow(hWndForm, nTmpRowNumber, ROW_Selected, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nTmpRowNumber)
.head 8 -  Set strTmpFileCont = strTmpFileCont || SG_OperToString(colTT, colTT_NAME, nTmpOptions)
.head 7 +  Else
.head 8 -  Call WaitCursorOff()
.head 8 +  If strTmpFileCont
.head 9 -  Set strTmpFileCont = strTmpFileCont || "
COMMIT;

SET FEED ON
"
.head 9 +  If SalFileOpen(hTmpFile, strTmpFileName, OF_Create | OF_ReadWrite)
.head 10 -  Call SalFileWrite(hTmpFile, strTmpFileCont, SalStrLength(strTmpFileCont))
.head 10 -  Call SalFileClose(hTmpFile)
.head 10 -  ! Call SalMessageBox( 'Операции сохранены в файле: ' || strTmpFileName, '', MB_IconAsterisk | MB_Ok )
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_OperList.cTMsgOperSaveToFile') || ': ' || strTmpFileName, '', MB_IconAsterisk | MB_Ok)
.head 9 +  Else
.head 10 -  ! Call SalMessageBox( 'Не могу создать файл: ' || strTmpFileName, 'Ошибка', MB_IconStop | MB_Ok )
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_OperList.cTMsgFileNotCreate') || ': ' || strTmpFileName, 
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop | MB_Ok)
.head 10 -  Return FALSE
.head 8 -  Call SalTblSetContext(hWndForm, nTmpPriRowNumber)
.head 8 -  Return TRUE
.head 3 -  !
.head 3 +  Function: SG_OperToString
.head 4 -  Description: Выгрузка операции в строку
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Код операции
.head 5 -  String: strTT
.head 5 -  ! Наименование операции
.head 5 -  String: strNAME
.head 5 -  ! Опции экспорта
.head 5 -  ! 1 - Выдавать сообщения о несуществующих счетах или валютах
! 2 - Подменять T00
! 4 - Флаги
! 8 - Доп. реквизиты
! 16 - Включать связанные операции
! 32 - Бал. счета
! 64 - Группы контроля
! 128 - Виды документов
! 256 - Распределение по папкам
! 512 - Резерв
! 1024 - Резерв
! 2047 - Все! 
.head 5 -  Number: nOptions
.head 4 +  Static Variables
.head 5 -  String: strTT_List[*]
.head 5 -  Number: nTT_ListCount
.head 4 +  Local variables
.head 5 -  Number: i
.head 5 -  String: sEOL
.head 5 -  : hConnect
.head 6 -  Class: cABSConnect
.head 5 -  : hConnectAux
.head 6 -  Class: cABSConnect
.head 5 -  String: Result
.head 5 -  String: strProcVars
.head 5 -  String: strProcPart
.head 4 +  Actions
.head 5 -  ! Сброс имен для экспорта
.head 5 +  If NOT strTT
.head 6 -  Call SalArraySetUpperBound(strTT_List, 1, -1)
.head 6 -  Set nTT_ListCount = 0
.head 6 -  Return ''
.head 5 -  ! Проверка на необходимость экспорта (исключение повторного)
.head 5 +  Else
.head 6 +  If nTT_ListCount > 0
.head 7 -  Set i = 0
.head 7 +  While i < nTT_ListCount
.head 8 +  If strTT_List[i] = strTT
.head 9 -  ! Операция уже экспортировалась - экспортировать не надо!
.head 9 -  Return ''
.head 8 -  Set i=i+1
.head 6 -  ! Добавление текущей операциив в массив
.head 6 -  Call SalArraySetUpperBound(strTT_List, 1, nTT_ListCount)
.head 6 -  Set strTT_List[nTT_ListCount] = strTT
.head 6 -  Set nTT_ListCount=nTT_ListCount+1
.head 5 -  Set sEOL = SalNumberToChar(13) || SalNumberToChar(10)
.head 5 -  Call XConnectGetParams(hConnect)
.head 5 -  Call hConnectAux.Clone(hConnect, FALSE)
.head 5 -  Set Result = ''
.head 5 +  If hConnect.Connect() AND hConnectAux.Connect()
.head 6 -  ! Если со связ. операциями - экспортим сначала их
.head 6 +  If SG_CheckOption(nOptions,16)
.head 7 -  Set Result = Result || 
    SG_ExportRelatedOpers(
       hConnect.hSql(),
       strTT,
       nOptions)
.head 6 -  Set Result = Result || 'PROMPT СОЗДАНИЕ / ОБНОВЛЕНИЕ ОПЕРАЦИИ ' || strTT || sEOL
.head 6 -  Set Result = Result || 'PROMPT НАИМЕНОВАНИЕ ОПЕРАЦИИ: ' || strNAME || sEOL
.head 6 -  ! Уст. все переменные
.head 6 -  Set strProcVars = "  CNT_ NUMBER;"
.head 6 -  ! Строю процедурную часть
.head 6 -  Set strProcPart = ''
.head 6 -  Set strProcPart = strProcPart || 
    SG_ExportMainProps(
       hConnect.hSql(),
       hConnectAux.hSql(),
       strTT,
       SG_CheckOption(nOptions,1),
       SG_CheckOption(nOptions,2)) || sEOL
.head 6 +  If SG_CheckOption(nOptions,4)
.head 7 -  Set strProcPart = strProcPart || 
    SG_ExportFlags(
       hConnect.hSql(),
       hConnectAux.hSql(),
       strTT) || sEOL
.head 6 +  If SG_CheckOption(nOptions,8)
.head 7 -  Set strProcPart = strProcPart || 
    SG_ExportAuxs(
       hConnect.hSql(),
       hConnectAux.hSql(),
       strTT) || sEOL
.head 6 +  If SG_CheckOption(nOptions,16)
.head 7 -  Set strProcPart = strProcPart || 
    SG_ExportCmpxs(
       hConnect.hSql(),
       hConnectAux.hSql(),
       strTT) || sEOL
.head 6 +  If SG_CheckOption(nOptions,32)
.head 7 -  Set strProcPart = strProcPart || 
    SG_ExportBals(
       hConnect.hSql(),
       hConnectAux.hSql(),
       strTT) || sEOL
.head 6 +  If SG_CheckOption(nOptions,128)
.head 7 -  Set strProcPart = strProcPart || 
    SG_ExportVobs(
       hConnect.hSql(),
       hConnectAux.hSql(),
       strTT) || sEOL
.head 6 +  If SG_CheckOption(nOptions,64)
.head 7 -  Set strProcPart = strProcPart || 
    SG_ExportChks(
       hConnect.hSql(),
       hConnectAux.hSql(),
       strTT) || sEOL
.head 6 +  If SG_CheckOption(nOptions,256)
.head 7 -  Set strProcPart = strProcPart || 
    SG_ExportFlds(
       hConnect.hSql(),
       hConnectAux.hSql(),
       strTT) || sEOL
.head 6 -  Set Result = Result || SG_WrapCommand(strProcVars, strProcPart, 0) || "/" || sEOL
.head 6 -  Call hConnect.Disconnect()
.head 5 -  Return Result || sEOL
.head 3 +  Function: SG_ExportRelatedOpers
.head 4 -  Description: Экспорт связанных операций
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandle
.head 5 -  ! Код операции
.head 5 -  String: strTT
.head 5 -  ! Опции экспорта
.head 5 -  Number: nOptions
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: Result
.head 5 -  String: strRelatedTT
.head 5 -  String: strRelatedNAME
.head 5 -  Number: nFetchRes
.head 4 +  Actions
.head 5 -  Set Result = ""
.head 5 -  Set Result = Result || 'SG_ExportRelatedOpers: ' || strTT || PutCrLf()
.head 5 +  If SqlPrepareAndExecute( hSqlHandle, 
"SELECT B.TT, B.NAME INTO :strRelatedTT, :strRelatedNAME 
   FROM TTSAP A, TTS B
  WHERE A.TTAP=B.TT AND A.TT=:strTT " )
.head 6 +  While SqlFetchNext( hSqlHandle, nFetchRes )
.head 7 -  Set Result = Result || SG_OperToString(strRelatedTT, strRelatedNAME, nOptions)
.head 5 -  Return Result
.head 3 -  ! Start here
.head 3 +  Function: SG_ExportMainProps
.head 4 -  Description: Экспорт основных свойств
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandle
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandleAux
.head 5 -  ! Код операции
.head 5 -  String: strTT
.head 5 -  ! Выдавать ошибки
.head 5 -  Boolean: bErrors
.head 5 -  ! Подменять T00
.head 5 -  Boolean: bT00
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: Result
.head 5 -  String: Header
.head 5 -  !
.head 5 -  String: strColName[*]
.head 5 -  Number: nColType[*]
.head 5 -  String: strColValue[*]
.head 5 -  Number: nColValue[*]
.head 5 -  !
.head 5 -  Number: nTmpS6201
.head 5 -  Number: nTmpS7201
.head 5 -  String: strTmpTip
.head 5 -  Boolean: bTmpT00
.head 5 -  Number: nTmpKV
.head 5 -  !
.head 5 -  Number: nFetchRes
.head 4 +  Actions
.head 5 -  Set Header="------------------------------
--ОСНОВНЫЕ СВОЙСТВА ОПЕРАЦИИ--
------------------------------
"
.head 5 -  Set Result = ''
.head 5 -  Call SalArraySetUpperBound(strColName, 1, 30)
.head 5 -  Call SalArraySetUpperBound(nColType, 1, 30)
.head 5 -  Call SalArraySetUpperBound(strColValue, 1, 30)
.head 5 -  Call SalArraySetUpperBound(nColValue, 1, 30)
.head 5 -  ! Метаописание TTS
.head 5 +  If TRUE
.head 6 -  ! TT, NAME, DK, NLSM, KV, NLSK, KVK, NLSS, NLSA, NLSB, MFOB, FLC, FLI, FLV, FLR,
 S, S2, SK, PROC, S3800, S6201, S7201, RANG, FLAGS, NAZN
.head 6 -  Set strColName[0]='TT'
.head 6 -  Set strColName[1]='NAME'
.head 6 -  Set strColName[2]='DK'
.head 6 -  Set strColName[3]='NLSM'
.head 6 -  Set strColName[4]='KV'
.head 6 -  Set strColName[5]='NLSK'
.head 6 -  Set strColName[6]='KVK'
.head 6 -  Set strColName[7]='NLSS'
.head 6 -  Set strColName[8]='NLSA'
.head 6 -  Set strColName[9]='NLSB'
.head 6 -  Set strColName[10]='MFOB'
.head 6 -  Set strColName[11]='FLC'
.head 6 -  Set strColName[12]='FLI'
.head 6 -  Set strColName[13]='FLV'
.head 6 -  Set strColName[14]='FLR'
.head 6 -  Set strColName[15]='S'
.head 6 -  Set strColName[16]='S2'
.head 6 -  Set strColName[17]='SK'
.head 6 -  Set strColName[18]='PROC'
.head 6 -  Set strColName[19]='S3800'
.head 6 -  Set strColName[20]='RANG'
.head 6 -  Set strColName[21]='FLAGS'
.head 6 -  Set strColName[22]='NAZN'
.head 6 -  Set nColType[0]=1
.head 6 -  Set nColType[1]=1
.head 6 -  Set nColType[2]=2
.head 6 -  Set nColType[3]=1
.head 6 -  Set nColType[4]=2
.head 6 -  Set nColType[5]=1
.head 6 -  Set nColType[6]=2
.head 6 -  Set nColType[7]=1
.head 6 -  Set nColType[8]=1
.head 6 -  Set nColType[9]=1
.head 6 -  Set nColType[10]=1
.head 6 -  Set nColType[11]=2
.head 6 -  Set nColType[12]=2
.head 6 -  Set nColType[13]=2
.head 6 -  Set nColType[14]=2
.head 6 -  Set nColType[15]=1
.head 6 -  Set nColType[16]=1
.head 6 -  Set nColType[17]=2
.head 6 -  Set nColType[18]=2
.head 6 -  Set nColType[19]=1
.head 6 -  Set nColType[20]=2
.head 6 -  Set nColType[21]=1
.head 6 -  Set nColType[22]=1
.head 5 +  If SqlPrepareAndExecute(hSqlHandle, 
"SELECT TT, NAME, DK, NLSM,
	KV, NLSK, KVK, NLSS,
	NLSA, NLSB, MFOB, FLC,
	FLI, FLV, FLR, S,
	S2, SK, PROC, S3800,
	S6201, S7201, RANG, FLAGS, NAZN 
 INTO	:strColValue[0],:strColValue[1],:nColValue[2],:strColValue[3],
	:nColValue[4],:strColValue[5],:nColValue[6],:strColValue[7],
	:strColValue[8],:strColValue[9],:strColValue[10],:nColValue[11],
	:nColValue[12],:nColValue[13],:nColValue[14],:strColValue[15],
	:strColValue[16],:nColValue[17],:nColValue[18],:strColValue[19],
	:nTmpS6201,:nTmpS7201,:nColValue[20],:strColValue[21],:strColValue[22]
 FROM TTS
 WHERE TT=:strTT ")
.head 6 +  If SqlFetchNext(hSqlHandle, nFetchRes)
.head 7 -  Set Result = Result || 
    SG_Insert(1, 'TTS',
       strColName,
       nColType,
       strColValue,
       nColValue,
       " TT='" || strTT || "'")
.head 7 +  If bT00
.head 8 -  Set bTmpT00=FALSE
.head 8 -  ! Если в нашей БД счет для оплаты T00 [NLSM]
.head 8 +  If nColValue[4]
.head 9 -  Set nTmpKV = nColValue[4]
.head 8 +  Else
.head 9 -  Set nTmpKV = GetBaseVal()
.head 8 +  If SqlPrepareAndExecute(hSqlHandleAux, 
"SELECT TIP INTO :strTmpTip FROM ACCOUNTS WHERE NLS=:strColValue[3] AND KV=:nTmpKV" )
.head 9 +  If SqlFetchNext(hSqlHandleAux, nFetchRes)
.head 10 +  If strTmpTip = 'T00'
.head 11 -  Set bTmpT00 = TRUE
.head 11 -  Set Result = Result || SG_UpdateToT00(strTT, 'NLSM')
.head 8 -  ! Проверка на несуществ. счета выполняется только если не T00
.head 8 +  If NOT bTmpT00 AND bErrors AND strColValue[3]
.head 9 -  Set Result = Result || SG_CheckAccount(strTT, 'А для оплаты', strColValue[3], nColValue[4])
.head 8 -  Set bTmpT00 = FALSE
.head 8 -  ! Если в нашей БД счет для оплаты T00 [NLSK]
.head 8 +  If nColValue[6]
.head 9 -  Set nTmpKV = nColValue[6]
.head 8 +  Else
.head 9 -  Set nTmpKV = GetBaseVal()
.head 8 +  If SqlPrepareAndExecute(hSqlHandleAux, 
"SELECT TIP INTO :strTmpTip FROM ACCOUNTS WHERE NLS=:strColValue[5] AND KV=:nTmpKV")
.head 9 +  If SqlFetchNext(hSqlHandleAux, nFetchRes)
.head 10 +  If strTmpTip = 'T00'
.head 11 -  Set bTmpT00 = TRUE
.head 11 -  Set Result = Result || SG_UpdateToT00(strTT, 'NLSK')
.head 8 -  ! Проверка на несуществ. счета выполняется только если не T00
.head 8 +  If NOT bTmpT00 AND bErrors AND strColValue[5]
.head 9 -  Set Result=Result || SG_CheckAccount(strTT, 'Б для оплаты', strColValue[5], nColValue[6])
.head 7 +  Else If bErrors
.head 8 -  ! Всегда проверяем на несуществующие счета
.head 8 +  If strColValue[3]
.head 9 -  Set Result=Result || SG_CheckAccount(strTT, 'А для оплаты', strColValue[3], nColValue[4])
.head 8 +  If strColValue[5]
.head 9 -  Set Result=Result || SG_CheckAccount(strTT, 'Б для оплаты', strColValue[5], nColValue[6])
.head 7 +  If bErrors
.head 8 +  If strColValue[8]
.head 9 -  Set Result=Result || SG_CheckAccount(strTT, 'А для ввода', strColValue[8], nColValue[4])
.head 8 +  If strColValue[9]
.head 9 -  Set Result=Result || SG_CheckAccount(strTT, 'Б для ввода', strColValue[9], nColValue[6])
.head 8 +  If strColValue[19]
.head 9 -  Set Result=Result || SG_CheckAccount(strTT, 'валютной позиции', strColValue[19], 0)
.head 8 +  If nColValue[13]=1
.head 9 -  Set Result = Result || 
"DBMS_OUTPUT.PUT_LINE('Не забудьте указать ваши маржинальные счета доходов и расходов для операции: " || strTT || " ');
"
.head 5 +  If Result
.head 6 -  Return Header || Result
.head 5 +  Else
.head 6 -  Return Result
.head 3 +  Function: SG_CheckAccount
.head 4 -  Description: Генерация кода для проверки существования счета
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Код операции 
.head 5 -  String: strTT
.head 5 -  ! Тип счета в род. падеже
.head 5 -  String: strNLS_NAME
.head 5 -  ! № Счета
.head 5 -  String: strNLS
.head 5 -  ! Код валюты
.head 5 -  Number: nKV
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Если счет вычисляется по формуле, не проверяем
.head 5 +  If SalStrScan(strNLS, '#') != -1
.head 6 -  Return ""
.head 5 +  If SalStrScan(strNLS, '?') != -1
.head 6 -  Return ""
.head 5 +  If nKV
.head 6 -  Return 
"BEGIN
  SELECT ACC INTO CNT_ FROM ACCOUNTS WHERE NLS='"||strNLS||"' AND KV=" || SalNumberToStrX( nKV, 0 )|| ";
EXCEPTION
  WHEN NO_DATA_FOUND THEN
    DBMS_OUTPUT.PUT_LINE('Счет " || strNLS_NAME || " "|| strNLS || "(" || SalNumberToStrX( nKV, 0 ) || ") заданый в операции " || strTT || " не существует!');
END;
"
.head 5 +  Else
.head 6 -  Return 
"SELECT COUNT(*) INTO CNT_ FROM ACCOUNTS WHERE NLS='" || strNLS || "';
IF CNT_=0 THEN
  DBMS_OUTPUT.PUT_LINE('Счет " || strNLS_NAME || " "|| strNLS || " заданый в операции " || strTT || " не существует!');
END IF;
"
.head 3 +  Function: SG_UpdateToT00
.head 4 -  Description: Генерация кода для обновления счета T00
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Операция
.head 5 -  String: strTT
.head 5 -  ! Поле
.head 5 -  String: strFLD
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return SG_WrapCommandExcept(
"UPDATE TTS 
  SET "|| strFLD ||"=(SELECT MAX(NLS) FROM ACCOUNTS WHERE TIP='T00') 
  WHERE tt='" || strTT || "';",
'','',0)
.head 3 +  Function: SG_ExportFlags
.head 4 -  Description: Экспорт флагов
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandle
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandleAux
.head 5 -  ! Код операции
.head 5 -  String: strTT
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: Result
.head 5 -  String: Header
.head 5 -  !
.head 5 -  String: strColName[*]
.head 5 -  Number: nColType[*]
.head 5 -  String: strColValue[*]
.head 5 -  Number: nColValue[*]
.head 5 -  !
.head 4 +  Actions
.head 5 -  ! (MIK)   Флаги теперь не экспортим они идут в поле FLAGS(TTS)
.head 5 -  Return ''
.head 5 -  !
.head 5 -  Set Header="------------------------------
------------ФЛАГИ-------------
------------------------------
"
.head 5 -  Set Result=''
.head 5 -  Call SalArraySetUpperBound( strColName, 1, 10 )
.head 5 -  Call SalArraySetUpperBound( nColType, 1, 10 )
.head 5 -  Call SalArraySetUpperBound( strColValue, 1, 10 )
.head 5 -  Call SalArraySetUpperBound( nColValue, 1, 10 )
.head 5 -  ! Метаописание TTS_FLAGS
.head 5 +  If TRUE
.head 6 -  ! TT, FCODE, VALUE
.head 6 -  Set strColName[0]='TT'
.head 6 -  Set strColName[1]='FCODE'
.head 6 -  Set strColName[2]='VALUE'
.head 6 -  Set nColType[0]=1
.head 6 -  Set nColType[1]=2
.head 6 -  Set nColType[2]=1
.head 5 +  If SqlPrepareAndExecute( hSqlHandle, 
"SELECT TT, FCODE, VALUE
INTO
	:strColValue[0],:nColValue[1],:strColValue[2]
FROM TTS_FLAGS
WHERE TT=:strTT " )
.head 6 +  While SqlFetchNext( hSqlHandle, nFetchRes )
.head 7 -  Set Result=Result || 
SG_Insert(2, 'TTS_FLAGS',
		strColName,
		nColType,
		strColValue,
		nColValue,
		" TT='" || strTT || "' AND FCODE=" || 
		SalNumberToStrX( nColValue[1], 0 ) )
.head 5 +  If Result
.head 6 -  Return Header || Result
.head 5 +  Else
.head 6 -  Return Result
.head 3 +  Function: SG_ExportAuxs
.head 4 -  Description: Экспорт доп. реквизитов
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandle
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandleAux
.head 5 -  ! Код операции
.head 5 -  String: strTT
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: Result
.head 5 -  String: Header
.head 5 -  !
.head 5 -  String: strColName[*]
.head 5 -  Number: nColType[*]
.head 5 -  String: strColValue[*]
.head 5 -  Number: nColValue[*]
.head 5 -  !
.head 4 +  Actions
.head 5 -  Set Header="------------------------------
----------РЕКВИЗИТЫ-----------
------------------------------
"
.head 5 -  Set Result = ''
.head 5 -  Call SalArraySetUpperBound(strColName, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColType, 1, 10)
.head 5 -  Call SalArraySetUpperBound(strColValue, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColValue, 1, 10)
.head 5 -  ! Метаописание OP_FIELD
.head 5 +  If nFlIns & 8
.head 6 +  If TRUE
.head 7 -  ! TAG, NAME, FMT, BROWSER, NOMODIFY, VSPO_CHAR, CHKR
.head 7 -  Set strColName[0]='TAG'
.head 7 -  Set strColName[1]='NAME'
.head 7 -  Set strColName[2]='FMT'
.head 7 -  Set strColName[3]='BROWSER'
.head 7 -  Set strColName[4]='NOMODIFY'
.head 7 -  Set strColName[5]='VSPO_CHAR'
.head 7 -  Set strColName[6]='CHKR'
.head 7 -  Set strColName[7]=''
.head 7 -  Set nColType[0]=1
.head 7 -  Set nColType[1]=1
.head 7 -  Set nColType[2]=1
.head 7 -  Set nColType[3]=1
.head 7 -  Set nColType[4]=2
.head 7 -  Set nColType[5]=1
.head 7 -  Set nColType[6]=1
.head 6 +  If SqlPrepareAndExecute(hSqlHandle, 
"SELECT A.TAG, A.NAME, A.FMT, A.BROWSER,
	A.NOMODIFY, A.VSPO_CHAR, A.CHKR
 INTO   :strColValue[0],:strColValue[1],:strColValue[2],:strColValue[3],
	:nColValue[4],:strColValue[5],:strColValue[6]
 FROM OP_FIELD A, OP_RULES B
 WHERE A.TAG=B.TAG AND B.TT=:strTT ")
.head 7 +  While SqlFetchNext(hSqlHandle, nFetchRes)
.head 8 -  Set Result = Result || 
    SG_Insert(0, 'OP_FIELD',
       strColName,
       nColType,
       strColValue,
       nColValue, '')
.head 5 -  ! Метаописание OP_RULES
.head 5 +  If TRUE
.head 6 -  ! TAG, TT, OPT, USED4INPUT, ORD, VAL
.head 6 -  Set strColName[0]='TAG'
.head 6 -  Set strColName[1]='TT'
.head 6 -  Set strColName[2]='OPT'
.head 6 -  Set strColName[3]='USED4INPUT'
.head 6 -  Set strColName[4]='ORD'
.head 6 -  Set strColName[5]='VAL'
.head 6 -  Set strColName[6]=''
.head 6 -  Set nColType[0]=1
.head 6 -  Set nColType[1]=1
.head 6 -  Set nColType[2]=1
.head 6 -  Set nColType[3]=2
.head 6 -  Set nColType[4]=2
.head 6 -  Set nColType[6]=1
.head 5 +  If SqlPrepareAndExecute(hSqlHandle, 
"SELECT TAG, TT, OPT, 
	USED4INPUT, ORD, VAL
 INTO	:strColValue[0],:strColValue[1],:strColValue[2],
	:nColValue[3],:nColValue[4],:strColValue[5]
 FROM OP_RULES
 WHERE TT=:strTT ")
.head 6 +  While SqlFetchNext(hSqlHandle, nFetchRes)
.head 7 -  Set Result = Result || 
    SG_Insert(2, 'OP_RULES',
       strColName,
       nColType,
       strColValue,
       nColValue,
       " TT='" || strTT || "' AND TAG='" || strColValue[0] || "'")
.head 5 +  If Result
.head 6 -  Return Header || PutCrLf() || Result
.head 5 +  Else
.head 6 -  Return Result
.head 3 +  Function: SG_ExportCmpxs
.head 4 -  Description: Экспорт связей между операциями
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandle
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandleAux
.head 5 -  ! Код операции
.head 5 -  String: strTT
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: Result
.head 5 -  String: Header
.head 5 -  !
.head 5 -  String: strColName[*]
.head 5 -  Number: nColType[*]
.head 5 -  String: strColValue[*]
.head 5 -  Number: nColValue[*]
.head 5 -  !
.head 4 +  Actions
.head 5 -  Set Header="------------------------------
------СВЯЗАННЫЕ ОПЕРАЦИИ------
------------------------------
"
.head 5 -  Set Result=''
.head 5 -  Call SalArraySetUpperBound(strColName, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColType, 1, 10)
.head 5 -  Call SalArraySetUpperBound(strColValue, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColValue, 1, 10)
.head 5 -  ! Метаописание TTSAP
.head 5 +  If TRUE
.head 6 -  ! TTAP, TT, DK
.head 6 -  Set strColName[0]='TTAP'
.head 6 -  Set strColName[1]='TT'
.head 6 -  Set strColName[2]='DK'
.head 6 -  Set nColType[0]=1
.head 6 -  Set nColType[1]=1
.head 6 -  Set nColType[2]=2
.head 5 +  If SqlPrepareAndExecute(hSqlHandle, 
"SELECT TTAP, TT, DK
 INTO	:strColValue[0],:strColValue[1],:nColValue[2]
 FROM TTSAP
 WHERE TT=:strTT " )
.head 6 +  While SqlFetchNext(hSqlHandle, nFetchRes)
.head 7 -  Set Result=Result || 
    SG_Insert(2,'TTSAP',
       strColName,
       nColType,
       strColValue,
       nColValue, '')
.head 5 +  If Result
.head 6 -  Return Header || Result
.head 5 +  Else
.head 6 -  Return Result
.head 3 +  Function: SG_ExportBals
.head 4 -  Description: Экспорт бал. счетов
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandle
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandleAux
.head 5 -  ! Код операции
.head 5 -  String: strTT
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: Result
.head 5 -  String: Header
.head 5 -  !
.head 5 -  String: strColName[*]
.head 5 -  Number: nColType[*]
.head 5 -  String: strColValue[*]
.head 5 -  Number: nColValue[*]
.head 5 -  !
.head 4 +  Actions
.head 5 -  Set Header = "------------------------------
-------БАЛАНСОВЫЕ СЧЕТА-------
------------------------------
"
.head 5 -  Set Result = ''
.head 5 -  Call SalArraySetUpperBound(strColName, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColType, 1, 10)
.head 5 -  Call SalArraySetUpperBound(strColValue, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColValue, 1, 10)
.head 5 -  ! Метаописание PS_TTS
.head 5 +  If TRUE
.head 6 -  ! NBS, TT, DK
.head 6 -  Set strColName[0]='NBS'
.head 6 -  Set strColName[1]='TT'
.head 6 -  Set strColName[2]='DK'
.head 6 -  Set nColType[0]=1
.head 6 -  Set nColType[1]=1
.head 6 -  Set nColType[2]=2
.head 5 +  If SqlPrepareAndExecute(hSqlHandle, 
"SELECT NBS, TT, DK
 INTO	:strColValue[0],:strColValue[1],:nColValue[2]
 FROM PS_TTS
 WHERE TT=:strTT ")
.head 6 +  While SqlFetchNext(hSqlHandle, nFetchRes)
.head 7 -  Set Result = Result || 
    SG_Insert(2, 'PS_TTS',
       strColName,
       nColType,
       strColValue,
       nColValue, '')
.head 5 +  If Result
.head 6 -  Return Header || PutCrLf() || Result
.head 5 +  Else
.head 6 -  Return Result
.head 3 +  Function: SG_ExportVobs
.head 4 -  Description: Экспорт Видов док-тов
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandle
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandleAux
.head 5 -  ! Код операции
.head 5 -  String: strTT
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: Result
.head 5 -  String: Header
.head 5 -  !
.head 5 -  String: strColName[*]
.head 5 -  Number: nColType[*]
.head 5 -  String: strColValue[*]
.head 5 -  Number: nColValue[*]
.head 5 -  !
.head 4 +  Actions
.head 5 -  Set Header = "------------------------------
-------ВИДЫ ДОКУМЕНТОВ--------
------------------------------
"
.head 5 -  Set Result = ''
.head 5 -  Call SalArraySetUpperBound(strColName, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColType, 1, 10)
.head 5 -  Call SalArraySetUpperBound(strColValue, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColValue, 1, 10)
.head 5 -  ! Метаописание VOB
.head 5 +  If nFlIns & 128
.head 6 +  If TRUE
.head 7 -  ! VOB, NAME, FLV, REP_PREFIX
.head 7 -  Set strColName[0]='VOB'
.head 7 -  Set strColName[1]='NAME'
.head 7 -  Set strColName[2]='FLV'
.head 7 -  Set strColName[3]='REP_PREFIX'
.head 7 -  Set strColName[4]=''
.head 7 -  Set nColType[0]=2
.head 7 -  Set nColType[1]=1
.head 7 -  Set nColType[2]=2
.head 7 -  Set nColType[3]=1
.head 6 +  If SqlPrepareAndExecute(hSqlHandle, 
"SELECT A.VOB, A.NAME, A.FLV, A.REP_PREFIX
 INTO	:nColValue[0],:strColValue[1],:nColValue[2],:strColValue[3]
 FROM VOB A, TTS_VOB B
 WHERE A.VOB=B.VOB AND B.TT=:strTT ")
.head 7 +  While SqlFetchNext(hSqlHandle, nFetchRes)
.head 8 -  Set Result = Result || 
    SG_Insert(0, 'VOB',
       strColName,
       nColType,
       strColValue,
       nColValue, '')
.head 5 -  ! Метаописание TTS_VOB
.head 5 +  If TRUE
.head 6 -  ! VOB, TT
.head 6 -  Set strColName[0]='VOB'
.head 6 -  Set strColName[1]='TT'
.head 6 -  Set strColName[2]=''
.head 6 -  Set nColType[0]=2
.head 6 -  Set nColType[1]=1
.head 5 +  If SqlPrepareAndExecute(hSqlHandle, 
"SELECT VOB, TT
 INTO	:nColValue[0],:strColValue[1]
 FROM TTS_VOB
 WHERE TT=:strTT ")
.head 6 +  While SqlFetchNext(hSqlHandle, nFetchRes)
.head 7 -  Set Result = Result || 
    SG_Insert(2, 'TTS_VOB',
       strColName,
       nColType,
       strColValue,
       nColValue, '')
.head 5 +  If Result
.head 6 -  Return Header || PutCrLf() || Result
.head 5 +  Else
.head 6 -  Return Result
.head 3 +  Function: SG_ExportChks
.head 4 -  Description: Экспорт групп визирования
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandle
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandleAux
.head 5 -  ! Код операции
.head 5 -  String: strTT
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: Result
.head 5 -  String: Header
.head 5 -  !
.head 5 -  String: strColName[*]
.head 5 -  Number: nColType[*]
.head 5 -  String: strColValue[*]
.head 5 -  Number: nColValue[*]
.head 5 -  !
.head 4 +  Actions
.head 5 -  Set Header = "------------------------------
--------ГРУППЫ КОНТРОЛЯ-------
------------------------------
"
.head 5 -  Set Result = ''
.head 5 -  Call SalArraySetUpperBound(strColName, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColType, 1, 10)
.head 5 -  Call SalArraySetUpperBound(strColValue, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColValue, 1, 10)
.head 5 -  ! Метаописание CHKLIST
.head 5 +  If nFlIns & 64
.head 6 +  If TRUE
.head 7 -  ! IDCHK, NAME, COMM
.head 7 -  Set strColName[0]='IDCHK'
.head 7 -  Set strColName[1]='NAME'
.head 7 -  Set strColName[2]='COMM'
.head 7 -  Set strColName[3]=''
.head 7 -  Set nColType[0]=2
.head 7 -  Set nColType[1]=1
.head 7 -  Set nColType[2]=1
.head 6 +  If SqlPrepareAndExecute(hSqlHandle, 
"SELECT A.IDCHK, A.NAME, A.COMM
 INTO	:nColValue[0],:strColValue[1],:strColValue[2]
 FROM CHKLIST A, CHKLIST_TTS B
 WHERE A.IDCHK=B.IDCHK AND B.TT=:strTT ")
.head 7 +  While SqlFetchNext(hSqlHandle, nFetchRes)
.head 8 -  Set Result = Result || 
    SG_Insert(0, 'CHKLIST',
       strColName,
       nColType,
       strColValue,
       nColValue, '')
.head 5 -  ! Метаописание CHKLIST_TTS
.head 5 +  If TRUE
.head 6 -  ! IDCHK, TT, PRIORITY, F_BIG_AMOUNT
.head 6 -  Set strColName[0]='IDCHK'
.head 6 -  Set strColName[1]='TT'
.head 6 -  Set strColName[2]='PRIORITY'
.head 6 -  Set strColName[3]='F_BIG_AMOUNT'
.head 6 -  Set strColName[4]=''
.head 6 -  Set nColType[0]=2
.head 6 -  Set nColType[1]=1
.head 6 -  Set nColType[2]=2
.head 6 -  Set nColType[3]=2
.head 5 +  If SqlPrepareAndExecute(hSqlHandle, 
"SELECT IDCHK, TT, PRIORITY, F_BIG_AMOUNT
 INTO	:nColValue[0],:strColValue[1],:nColValue[2],:nColValue[3]
 FROM CHKLIST_TTS
 WHERE TT=:strTT ")
.head 6 +  While SqlFetchNext(hSqlHandle, nFetchRes)
.head 7 -  Set Result = Result || 
    SG_Insert(2, 'CHKLIST_TTS',
       strColName,
       nColType,
       strColValue,
       nColValue,
       " TT='" || strTT || "' AND IDCHK=" || SalNumberToStrX(nColValue[0], 0))
.head 5 +  If Result
.head 6 -  Return Header || PutCrLf() || Result
.head 5 +  Else
.head 6 -  Return Result
.head 3 +  Function: SG_ExportFlds
.head 4 -  Description: Экспорт папок
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandle
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandleAux
.head 5 -  ! Код операции
.head 5 -  String: strTT
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: Result
.head 5 -  String: Header
.head 5 -  !
.head 5 -  String: strColName[*]
.head 5 -  Number: nColType[*]
.head 5 -  String: strColValue[*]
.head 5 -  Number: nColValue[*]
.head 5 -  !
.head 4 +  Actions
.head 5 -  Set Header = "------------------------------
------------ПАПКИ-------------
------------------------------
"
.head 5 -  Set Result = ''
.head 5 -  Call SalArraySetUpperBound(strColName, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColType, 1, 10)
.head 5 -  Call SalArraySetUpperBound(strColValue, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColValue, 1, 10)
.head 5 -  ! Метаописание FOLDERS
.head 5 +  If nFlIns & 256
.head 6 +  If TRUE
.head 7 -  ! IDFO, NAME
.head 7 -  Set strColName[0]='IDFO'
.head 7 -  Set strColName[1]='NAME'
.head 7 -  Set strColName[2]=''
.head 7 -  Set nColType[0]=2
.head 7 -  Set nColType[1]=1
.head 6 +  If SqlPrepareAndExecute(hSqlHandle, 
"SELECT A.IDFO, A.NAME
 INTO	:nColValue[0],:strColValue[1] 
 FROM FOLDERS A, FOLDERS_TTS B
 WHERE A.IDFO=B.IDFO AND B.TT=:strTT ")
.head 7 +  While SqlFetchNext(hSqlHandle, nFetchRes)
.head 8 -  Set Result = Result || 
    SG_Insert(0, 'FOLDERS',
       strColName,
       nColType,
       strColValue,
       nColValue, '')
.head 5 -  ! Метаописание FOLDERS_TTS
.head 5 +  If TRUE
.head 6 -  ! IDFO, TT
.head 6 -  Set strColName[0]='IDFO'
.head 6 -  Set strColName[1]='TT'
.head 6 -  Set strColName[2]=''
.head 6 -  Set nColType[0]=2
.head 6 -  Set nColType[1]=1
.head 5 +  If SqlPrepareAndExecute(hSqlHandle, 
"SELECT IDFO, TT
 INTO	:nColValue[0],:strColValue[1]
 FROM FOLDERS_TTS
 WHERE TT=:strTT ")
.head 6 +  While SqlFetchNext(hSqlHandle, nFetchRes)
.head 7 -  Set Result = Result || 
    SG_Insert(2, 'FOLDERS_TTS',
       strColName,
       nColType,
       strColValue,
       nColValue, '')
.head 5 +  If Result
.head 6 -  Return Header || PutCrLf() || Result
.head 5 +  Else
.head 6 -  Return Result
.head 2 +  Window Parameters
.head 3 -  Number: Option
.head 2 +  Window Variables
.head 3 -  String: sEI_Path
.head 3 -  String: sCnc
.head 3 -  : cParamsFetcher
.head 4 -  Class: cABSConnect
.head 3 -  Number: nFlags
.head 3 -  Number: nFlIns
.head 3 -  Boolean: fSaved
.head 3 -  ! Имя функции (для Log'а)
.head 3 -  String: sFuncName
.head 3 -  ! № строки и колонки фокуса
.head 3 -  ! Number: nRowNumber
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 +  If Option = 9
.head 5 -  Call SalHideWindow( pbIns )
.head 5 -  Call SalHideWindow( pbDel )
.head 5 -  Call SalHideWindow( pbUpdate )
.head 5 -  Call SalHideWindow( pbToFile )
.head 5 -  Call SalHideWindow( pbExp )
.head 5 -  Call SalHideWindow( pbImp ) 
.head 5 -  Call SalHideWindow( pbExportSelected )
.head 5 -  Call SalTblSetColumnFlags ( colTT, COL_Editable, FALSE )
.head 5 -  Call SalTblSetColumnFlags ( colTT_NAME, COL_Editable, FALSE )
.head 5 -  Call SalTblSetColumnFlags ( colTT_BRANCH, COL_Editable, FALSE )
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('frm_OperList.cTWndTitle') )
.head 4 -  Set fSaved=TRUE
.head 4 -  Set strPrintFileName='opers.txt'
.head 4 -  Set strSqlPopulate = '
    SELECT tt,name
    INTO   :hWndForm.colTT,:hWndForm.colTT_NAME
    FROM   tts
    ORDER BY tt'
.head 4 -  Set strSqlInsert='
INSERT INTO tts (
        tt,
        name,
        fli)
VALUES (
        :hWndForm.colTT,
        :hWndForm.colTT_NAME,
        0)'
.head 4 -  Set strSqlDelete='DELETE FROM tts WHERE tt=:hWndForm.colTT'
.head 4 -  Set strSqlUpdate='UPDATE tts SET name=:hWndForm.colTT_NAME WHERE tt=:hWndForm.colTT'
.head 4 -  Set strFilterTblName='tts'
.head 4 -  Call SalSendClassMessage( UM_Create, 0, 0 )
.head 4 -  Set sFuncName='Конструктор операций'
.head 4 -  ! Call SaveInfoToLog( 'Запуск функции: ' || sFuncName )
.head 4 -  Call SaveInfoToLog( CurrentLangTable.GetAtomTitle('frm_OperList.cTMsgToLogExecFunc') || ': ' || sFuncName )
.head 3 +  On SAM_Close
.head 4 +  If not fSaved
.head 5 -  ! Select Case SalMessageBox( 'Настройки не сохранены!
Сохранить?', 'Настройка операций', MB_YesNoCancel | MB_IconQuestion )
.head 5 +  Select Case SalMessageBox( CurrentLangTable.GetAtomTitle('frm_OperList.cTMsgOperNotSave') || PutCrLf() ||
  CurrentLangTable.GetAtomTitle('frm_OperList.cTMsgSave'), 
  CurrentLangTable.GetAtomTitle('frm_OperList.cTMsgOper'), MB_YesNoCancel | MB_IconQuestion )
.head 6 +  Case IDYES
.head 7 -  Call SalSendMsg( frm_OperList.pbUpdate, SAM_Click, 0, 0 )
.head 7 -  Break
.head 6 +  Case IDNO
.head 7 -  Call SqlRollback( cMain.hSql() )
.head 7 -  Break
.head 6 +  Case IDCANCEL
.head 7 -  Return FALSE
.head 4 +  Else
.head 5 -  Call SqlRollback( cMain.hSql() )
.head 4 -  Set fOlCalled=FALSE
.head 4 -  ! Call SaveInfoToLog( 'Выход из функции: ' || sFuncName )
.head 4 -  Call SaveInfoToLog( CurrentLangTable.GetAtomTitle('frm_OperList.cTMsgToLogExitFunc') || ': ' || sFuncName )
.head 3 +  On UM_DoubleClick
.head 4 -  Call ShowOperDetail(hWndMDI,colTT,Option)
.head 3 +  On SAM_TblDoDetails
.head 4 +  If SalTblQueryRowFlags( hWndForm, SalTblQueryContext( hWndForm ), ROW_New )
.head 5 -  Call SalTblSetColumnFlags( colTT, COL_Editable, TRUE )
.head 4 +  Else
.head 5 -  Call SalTblSetColumnFlags( colTT, COL_Editable, FALSE )
.head 1 +  Dialog Box: dlg_OperCard
.head 2 -  Class: cQuickTabsDialog
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Свойства операции
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.713"
.head 4 -  Top:    1.354"
.head 4 -  Width:  13.033"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.552"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description: Свойства операции(Детальный диалог)
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Picture: picTabs
.data CLASSPROPS
0000: 5461624F7269656E 746174696F6E0001 000000546162546F 704D617267696E00
0020: 0200300000546162 466F726D50616765 7300080009090909 0909090000546162
0040: 447261775374796C 65000B0057696E39 355374796C650000 546162426F74746F
0060: 6D4D617267696E00 0400302C33000054 616250616765436F 756E740002003100
0080: 005461624C616265 6C73007B0020CAE0 F0F2EEF7EAE02009 D4EBE0E3E820E820
00A0: F0E5EAE2E8E7E8F2 FB200920D1E2FFE7 E0EDEDFBE520EEEF E5F0E0F6E8E82009
00C0: 20C1E0EBE0EDF1EE E2FBE520F1F7E5F2 E0200920C2E8E4FB 20E4EEEAF3ECE5ED
00E0: F2EEE2200920C3F0 F3EFEFFB20EAEEED F2F0EEEBFF2009C8 EDF4EEF0ECE0F6E8
0100: FF09CFE0EFEAE800 005461624E616D65 730045005461624F 44424F7065720954
0120: 616245504F706572 0954616243686169 6E65644F70657209 546162466C616773
0140: 094E616D6534094E 616D6535094E616D 6536094E616D6537 0000546162526967
0160: 68744D617267696E 0002003000005461 6243757272656E74 000B005461624F44
0180: 424F706572000054 61624C6566744D61 7267696E00020030 0000000000000000
01A0: 0000000000000000 0000000000000000
.enddata
.data CLASSPROPSSIZE
0000: B001
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickTabsDialog
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    0.052"
.head 5 -  Width:  8.286"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 4.7"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Yes
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 -  Call picTabs.SetLabel(0,' '||CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs0')||' ', TRUE)
.head 6 -  Call picTabs.SetLabel(1,' '||CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs1')||' ', TRUE)
.head 6 -  Call picTabs.SetLabel(2,' '||CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs2')||' ', TRUE)
.head 6 -  Call picTabs.SetLabel(3,' '||CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs3')||' ', TRUE)
.head 6 -  Call picTabs.SetLabel(4,' '||CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs4')||' ', TRUE)
.head 6 -  Call picTabs.SetLabel(5,' '||CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs5')||' ', TRUE)
.head 6 -  Call picTabs.SetLabel(6,' '||CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs6')||' ', TRUE)
.head 6 -  Call picTabs.SetLabel(7,' '||CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs7')||' ', TRUE)
.head 6 +  If Option = 9 
.head 7 -  Call picTabs.Enable(0, FALSE)
.head 7 -  Call picTabs.Enable(1, FALSE)
.head 7 -  Call picTabs.Enable(2, FALSE)
.head 7 -  Call picTabs.Enable(3, FALSE)
.head 7 -  Call picTabs.Enable(4, FALSE)
.head 7 -  Call picTabs.Enable(5, FALSE)
.head 7 -  Call picTabs.Enable(7, FALSE)
.head 3 -  ! Group Box: Тип банковской транзакции
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.464"
.head 5 -  Width:  3.783"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.607"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 -  Background Text: Тип банковской транзакции
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 49452
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.417"
.head 5 -  Top:    0.464"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgOperType
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  ! Group Box: Вид банковской транзакции
.data CLASSPROPSSIZE
0000: 1E00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 657200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.25"
.head 5 -  Top:    0.464"
.head 5 -  Width:  3.35"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.607"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 -  Background Text: Вид банковской транзакции
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 49453
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.383"
.head 5 -  Top:    0.464"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfOperType
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.483"
.head 6 -  Top:    0.679"
.head 6 -  Width:  2.883"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call Modified(  )
.head 3 +  Pushbutton: pbGetOperType
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ?
.head 4 -  Window Location and Size
.head 5 -  Left:   3.433"
.head 5 -  Top:    0.679"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! 'Виды банковских транзакций',
.head 6 +  If ShowPickList( dfOperType, 
'SELECT fli, name INTO :dlg_PickList.tbl.colID, :dlg_PickList.tbl.colName FROM interbank',
CurrentLangTable.GetAtomTitle('dlg_OperCard.cTOperType'),
'',
strFli, 
strFliName ) = 1
.head 7 -  Set dfOperType=strFliName
.head 7 -  Set nFli=SalStrToNumber( strFli )
.head 7 -  Call SqlPrepareAndExecute( hMainSql,"UPDATE tts SET fli=:nFli WHERE tt=:strOperId")
.head 7 -  Call SqlClose( hMainSql )
.head 7 -  Call Modified(  )
.head 3 -  Background Text: Счет А /для ОПЛАТЫ
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 11162
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    1.226"
.head 5 -  Width:  2.517"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgAccA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAccA
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 55
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.933"
.head 6 -  Top:    1.226"
.head 6 -  Width:  5.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call Modified(  )
.head 3 -  Background Text: Счет Б/для ОПЛАТЫ
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 11163
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    1.476"
.head 5 -  Width:  2.517"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgAccB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAccB
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 55
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.933"
.head 6 -  Top:    1.476"
.head 6 -  Width:  5.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call Modified(  )
.head 3 -  Background Text: Вал. А
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 11161
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.017"
.head 5 -  Top:    1.226"
.head 5 -  Width:  1.933"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKvA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvA
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.6"
.head 6 -  Top:    1.226"
.head 6 -  Width:  1.317"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call Modified(  )
.head 3 -  Background Text: Вал. Б
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 11164
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.017"
.head 5 -  Top:    1.56"
.head 5 -  Width:  1.933"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKvB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfKvB
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 3
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.6"
.head 6 -  Top:    1.476"
.head 6 -  Width:  1.317"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call Modified(  )
.head 3 +  Check Box: cbMulti
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Мультивалютная транзакция
.head 4 -  Window Location and Size
.head 5 -  Left:   2.933"
.head 5 -  Top:    2.786"
.head 5 -  Width:  5.217"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( cbMulti, SAM_User, 0, 0 )
.head 6 -  Call Modified(  )
.head 5 +  On SAM_User
.head 6 +  If cbMulti
.head 7 -  Call SalEnableWindow( dfAccVP )
.head 7 -  Call SalEnableWindow( dfAccInc )
.head 7 -  Call SalEnableWindow( dfAccExp )
.head 6 +  Else
.head 7 -  Call SalDisableWindow( dfAccVP )
.head 7 -  Call SalDisableWindow( dfAccInc )
.head 7 -  Call SalDisableWindow( dfAccExp )
.head 3 +  Check Box: cbComplex
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сложная транзакция
.head 4 -  Window Location and Size
.head 5 -  Left:   2.933"
.head 5 -  Top:    2.333"
.head 5 -  Width:  6.957"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg( cbComplex, SAM_User, 0, 0 )
.head 6 -  Call Modified(  )
.head 5 +  On SAM_User
.head 6 +  If Option != 9 
.head 7 -  Call picTabs.Enable( 2, cbComplex )
.head 3 -  Background Text: Сч банка А /для ВВОДА
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 11165
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    1.726"
.head 5 -  Width:  2.517"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgBankA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Сч банка Б /для ВВОДА
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 11167
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    1.976"
.head 5 -  Width:  2.517"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgBankB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfBankA
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 55
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.933"
.head 6 -  Top:    1.726"
.head 6 -  Width:  5.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call Modified(  )
.head 3 +  Data Field: dfBankB
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 55
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.933"
.head 6 -  Top:    1.976"
.head 6 -  Width:  5.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call Modified(  )
.head 3 -  Background Text: МФО банка Б
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 11166
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   10.017"
.head 5 -  Top:    2.048"
.head 5 -  Width:  1.933"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMfoB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfMfoB
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 12
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   8.6"
.head 6 -  Top:    1.976"
.head 6 -  Width:  1.317"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call Modified(  )
.head 3 -  Background Text: Счет валют. позиции
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 11171
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    3.024"
.head 5 -  Width:  2.517"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgAccVP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAccVP
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 55
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.933"
.head 6 -  Top:    3.024"
.head 6 -  Width:  5.5"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call Modified(  )
.head 3 -  Background Text: Счет маржин.доходов
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 11170
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    3.274"
.head 5 -  Width:  2.517"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgAccInc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAccInc
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 15
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.933"
.head 6 -  Top:    3.274"
.head 6 -  Width:  2.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call Modified(  )
.head 3 -  Background Text: Счет маржин.расходов
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 11169
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    3.524"
.head 5 -  Width:  2.517"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Right
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgAccExp
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfAccExp
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 15
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.933"
.head 6 -  Top:    3.524"
.head 6 -  Width:  2.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call Modified(  )
.head 3 -  Background Text: Формула суммы-А документа
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 11172
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.233"
.head 5 -  Top:    3.964"
.head 5 -  Width:  6.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSum
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Формула суммы-Б документа 
.data CLASSPROPSSIZE
0000: 1E00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 657200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 33717
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.3"
.head 5 -  Top:    3.964"
.head 5 -  Width:  6.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSum2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Символ кассплана
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 11174
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.367"
.head 5 -  Top:    0.845"
.head 5 -  Width:  3.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgSKP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfSKP
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.733"
.head 6 -  Top:    0.845"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call Modified(  )
.head 3 -  Background Text: Привилегированность транзакции
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 11173
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   8.367"
.head 5 -  Top:    0.536"
.head 5 -  Width:  3.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgPriority
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfPriority
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 2
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.733"
.head 6 -  Top:    0.536"
.head 6 -  Width:  0.6"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Right
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call Modified(  )
.head 3 -  Background Text: Умолчательное назначение платежа
.data CLASSPROPSSIZE
0000: 1E00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 657200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 46109
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.233"
.head 5 -  Top:    5.143"
.head 5 -  Width:  5.617"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.214"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgNAZN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfNAZN
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 160
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.233"
.head 6 -  Top:    5.357"
.head 6 -  Width:  12.117"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Child Table: tblOpFlags
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 54616245504F7065 720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.2"
.head 6 -  Top:    0.405"
.head 6 -  Width:  12.083"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.95"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Имя флага
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  9.083"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colValue
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значение
флага
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 2
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On WM_KeyUp
.head 8 +  If wParam=VK_Insert
.head 9 -  Call SalSendMsg( hWndForm, SAM_DoubleClick, 0, 0 )
.head 8 +  Else If colN=35
.head 9 -  Set fAddRec=( colValue=1 )
.head 9 -  Call SalSendMsg( tblOpFlags, SAM_User, 0, 0 )
.head 7 +  On SAM_AnyEdit
.head 8 -  Call Modified(  )
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strCode
.head 5 -  String: strName
.head 5 -  Number: nCheck
.head 5 -  Number: nWhatToCheck
.head 5 -  Number: nRes
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 5 -  ! Populating
.head 5 +  On UM_DoPopulate
.head 6 +  If not GetGlobalOption( 'TTSFLAGS' )
.head 7 -  Set nWhatToCheck=0
.head 7 -  Call SqlPrepareAndExecute( hMainSql, 
'SELECT COUNT(*) INTO :nCheck FROM tts_flags WHERE tt=:strOperId AND fcode=:nWhatToCheck' )
.head 7 -  Call SqlFetchNext( hMainSql, nRes )
.head 7 -  Call SqlClose( hMainSql )
.head 7 +  If nCheck=0
.head 8 -  Call SqlPrepareAndExecute( hMainSql,'INSERT INTO tts_flags (tt,fcode,value) VALUES (:strOperId,0,0)' )
.head 7 -  Set nWhatToCheck=37
.head 7 -  Call SqlPrepareAndExecute( hMainSql,'SELECT COUNT(*) INTO :nCheck FROM tts_flags WHERE tt=:strOperId AND fcode=:nWhatToCheck' )
.head 7 -  Call SqlFetchNext( hMainSql, nRes )
.head 7 -  Call SqlClose( hMainSql )
.head 7 +  If nCheck=0
.head 8 -  Call SqlPrepareAndExecute( hMainSql, 
'INSERT INTO tts_flags (tt,fcode,value) VALUES (:strOperId,37,0)' )
.head 6 -  Call SalTblPopulate( tblOpFlags,hMainSql,
'SELECT a.fcode,b.name,a.value FROM tts_flags a,flags b 
  WHERE ( (a.fcode =b.code) ) AND (a.tt=:strOperId)
  ORDER BY fcode', TBL_FillAll )
.head 5 -  ! Deleting
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 +  If NOT SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted, TRUE, ROW_Selected, ROW_MarkDeleted )
.head 7 -  Call SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted, FALSE, ROW_Selected, 0 )
.head 6 -  Call Modified(  )
.head 5 -  ! Inserting
.head 5 +  On SAM_DoubleClick
.head 6 -  ! 'Флаги транзакции'
.head 6 +  If ShowPickList( dlg_OperCard,
'SELECT code,name FROM flags WHERE code NOT IN (SELECT fcode FROM tts_flags WHERE tt=:dlg_OperCard.strOperId) ORDER BY code',
 CurrentLangTable.GetAtomTitle('dlg_OperCard.cTOpFlags'),'',strCode,strName )=1
.head 7 -  Call SalTblSetContext( hWndForm, SalTblInsertRow( hWndForm, TBL_MaxRow ) )
.head 7 -  Set colN=SalStrToNumber( strCode )
.head 7 -  Set colName=strName
.head 7 -  Set colValue=0
.head 7 -  Call SalSendMsg( tblOpFlags, UM_DoSaveChanges, 1, 0 )
.head 7 -  Call Modified(  )
.head 5 -  ! Saving changes
.head 5 +  On UM_DoSaveChanges
.head 6 -  ! Insert
.head 6 +  If not GetGlobalOption( 'TTSFLAGS' )
.head 7 +  If wParam=1
.head 8 -  Call SqlPrepare( hMainSql,
'INSERT INTO tts_flags
(tt,fcode,value)
VALUES
(:strOperId,:tblOpFlags.colN, :tblOpFlags.colValue)' )
.head 8 -  Call SalTblDoInserts( tblOpFlags,
hMainSql,
TRUE )
.head 8 -  Call SqlClose( hMainSql )
.head 7 +  Else
.head 8 -  ! Update
.head 8 -  Call SqlPrepare( hMainSql,
'UPDATE tts_flags SET
value=:tblOpFlags.colValue
WHERE
(tt=:strOperId) AND (fcode=:tblOpFlags.colN)' )
.head 8 -  Call SalTblDoUpdates( tblOpFlags, hMainSql, TRUE )
.head 8 -  Call SqlClose( hMainSql )
.head 8 -  ! Delete
.head 8 -  Call SqlPrepare( hMainSql,
'DELETE FROM tts_flags 
WHERE 
(tt=:strOperId) AND (fcode=:tblOpFlags.colN)' )
.head 8 -  Call SalTblDoDeletes( tblOpFlags, hMainSql, ROW_MarkDeleted )
.head 8 -  Call SqlClose( hMainSql )
.head 8 -  Call SqlPrepareAndExecute( hMainSql, 'DELETE FROM tts_flags WHERE (value IS NULL) OR (value=0)' )
.head 8 -  Call SqlClose( hMainSql )
.head 6 +  Else
.head 7 -  ! Update
.head 7 -  Set nRes = TBL_MinRow
.head 7 -  Set strFlags=SalStrRepeatX ('0', 64 )
.head 7 +  While SalTblFindNextRow( tblOpFlags, nRes, 0, ROW_MarkDeleted )
.head 8 -  Call SalTblSetContext( tblOpFlags, nRes )
.head 8 -  Set strFlags = SalStrReplaceX ( strFlags, colN, 1, Str(colValue) )
.head 8 -  ! Call Debug(Str(colN))
.head 7 -  Call SqlPrepareAndExecute( hMainSql,"UPDATE tts SET flags=:strFlags WHERE tt=:strOperId")
.head 7 -  Call SqlClose( hMainSql )
.head 5 -  ! Keyboard support
.head 5 +  On WM_KeyUp
.head 6 +  If wParam=VK_Insert
.head 7 -  Call SalSendMsg( hWndForm, SAM_DoubleClick, 0, 0 )
.head 6 +  Else If wParam=VK_Delete
.head 7 -  Call SalSendMsg( hWndForm, SAM_RowHeaderDoubleClick, 0, 0 )
.head 5 +  On SAM_User
.head 6 +  If fAddRec
.head 7 -  Call SalEnableWindow( tblOpRules )
.head 6 +  Else
.head 7 -  Call SalDisableWindow( tblOpRules )
.head 3 +  Child Table: tblOpRules
.data CLASSPROPSSIZE
0000: 1D00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 54616245504F7065 7200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    2.988"
.head 6 -  Width:  12.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.583"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colTag
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 5
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.95"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Имя реквизита
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOpt
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Обязательность
реквизита
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: M
.head 8 -  Uncheck Value: O
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call Modified(  )
.head 5 +  Column: colUse4In
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Использовать
для ввода
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call Modified(  )
.head 5 +  Column: colOrd
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер реквизита
(для сортировки)
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.767"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call Modified(  )
.head 5 +  Column: colVal
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значение по 
умолчанию
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.767"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call Modified(  )
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strCode
.head 5 -  String: strName
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 5 -  ! Populating
.head 5 +  On UM_DoPopulate
.head 6 -  Call SalTblPopulate( hWndForm,
hMainSql,
'SELECT a.tag,b.name,a.opt,a.used4input, a.ord, a.val FROM op_rules a,op_field b WHERE (a.tag=b.tag) AND (a.tt=:strOperId)
ORDER BY a.ord, a.tag',
TBL_FillAll )
.head 5 -  ! Deleting
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 +  If NOT SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted, TRUE, ROW_Selected, ROW_MarkDeleted )
.head 7 -  Call SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted, FALSE, ROW_Selected, 0 )
.head 6 -  Call Modified(  )
.head 5 -  ! Inserting
.head 5 +  On SAM_DoubleClick
.head 6 -  ! 'Реквизиты транзакции'
.head 6 +  If ShowPickList( dlg_OperCard,
'SELECT tag,name FROM op_field WHERE tag NOT IN (SELECT tag FROM op_rules WHERE tt=:dlg_OperCard.strOperId)
ORDER BY tag',
CurrentLangTable.GetAtomTitle('dlg_OperCard.cTOpRules'),
'',
strCode,
strName )=1
.head 7 -  Call SalTblSetContext( hWndForm, SalTblInsertRow( hWndForm, TBL_MaxRow ) )
.head 7 -  Set colTag=strCode
.head 7 -  Set colName=strName
.head 7 -  Set colOpt='O'
.head 7 -  Set colUse4In=0
.head 7 -  Call SalSendMsg( hWndForm, UM_DoSaveChanges, 1, 0 )
.head 7 -  Call Modified(  )
.head 5 -  ! Saving changes
.head 5 +  On UM_DoSaveChanges
.head 6 +  If wParam=1
.head 7 -  ! Insert
.head 7 -  Call SqlPrepare( hMainSql,
'INSERT INTO op_rules
(tag,tt,opt,used4input,ord, val)
VALUES
(:tblOpRules.colTag, :strOperId, :tblOpRules.colOpt, :tblOpRules.colUse4In, :tblOpRules.colOrd, :tblOpRules.colVal)' )
.head 7 -  Call SalTblDoInserts( hWndForm,
hMainSql,
TRUE )
.head 7 -  Call SqlClose( hMainSql )
.head 6 +  Else
.head 7 -  ! Update
.head 7 -  Call SqlPrepare( hMainSql,
'UPDATE op_rules SET
opt=:tblOpRules.colOpt,
used4input=:tblOpRules.colUse4In,
ord=:tblOpRules.colOrd,
val=:tblOpRules.colVal
WHERE
(tt=:strOperId) AND (tag=:tblOpRules.colTag)' )
.head 7 -  Call SalTblDoUpdates( hWndForm, hMainSql, TRUE )
.head 7 -  Call SqlClose( hMainSql )
.head 7 -  ! Delete
.head 7 -  Call SqlPrepare( hMainSql,
'DELETE FROM op_rules 
WHERE 
(tt=:strOperId) AND (tag=:tblOpRules.colTag)' )
.head 7 -  Call SalTblDoDeletes( hWndForm, hMainSql, ROW_MarkDeleted )
.head 7 -  Call SqlClose( hMainSql )
.head 5 -  ! Keyboard support
.head 5 +  On WM_KeyUp
.head 6 +  If wParam=VK_Insert
.head 7 -  Call SalSendMsg( hWndForm, SAM_DoubleClick, 0, 0 )
.head 6 +  Else If wParam=VK_Delete
.head 7 -  Call SalSendMsg( hWndForm, SAM_RowHeaderDoubleClick, 0, 0 )
.head 3 +  Child Table: tblRelOpers
.data CLASSPROPSSIZE
0000: 2000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000F00 546162436861696E 65644F7065720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.405"
.head 6 -  Width:  12.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 5.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colTT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
операции
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Имя связанной операции
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  8.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Инверсия
Д/К
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.117"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call Modified(  )
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strCode
.head 5 -  String: strName
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 5 -  ! Populating
.head 5 +  On UM_DoPopulate
.head 6 -  Call SalTblPopulate( hWndForm,
hMainSql,
'SELECT a.ttap,b.name,a.dk FROM ttsap a,tts b WHERE (a.ttap=b.tt) AND (a.tt=:strOperId)
ORDER BY a.ttap',
TBL_FillAll )
.head 5 -  ! Deleting
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 +  If NOT SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted, TRUE, ROW_Selected, ROW_MarkDeleted )
.head 7 -  Call SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted, FALSE, ROW_Selected, 0 )
.head 6 -  Call Modified(  )
.head 5 -  ! Inserting
.head 5 +  On SAM_DoubleClick
.head 6 -  ! 'Список операций'
.head 6 +  If ShowPickList( dlg_OperCard,
'SELECT tt,name FROM tts WHERE (tt NOT IN (SELECT ttap FROM ttsap WHERE tt=:dlg_OperCard.strOperId))
AND (tt<>:dlg_OperCard.strOperId)
ORDER BY tt',
CurrentLangTable.GetAtomTitle('dlg_OperCard.cTRelOpers'),
'',
strCode,
strName )=1
.head 7 -  Call SalTblSetContext( hWndForm, SalTblInsertRow( hWndForm, TBL_MaxRow ) )
.head 7 -  Set colTT=strCode
.head 7 -  Set colName=strName
.head 7 -  Set colDC=0
.head 7 -  Call SalSendMsg( hWndForm, UM_DoSaveChanges, 1, 0 )
.head 7 -  Call Modified(  )
.head 5 -  ! Saving changes
.head 5 +  On UM_DoSaveChanges
.head 6 +  If wParam=1
.head 7 -  ! Insert
.head 7 -  Call SqlPrepare( hMainSql,
'INSERT INTO ttsap
(ttap,tt,dk)
VALUES
(:colTT, :strOperId, :colDC)' )
.head 7 -  Call SalTblDoInserts( hWndForm,
hMainSql,
TRUE )
.head 7 -  Call SqlClose( hMainSql )
.head 6 +  Else
.head 7 -  ! Update
.head 7 -  Call SqlPrepare( hMainSql,
'UPDATE ttsap SET
dk=:colDC
WHERE
(tt=:strOperId) AND (ttap=:colTT)' )
.head 7 -  Call SalTblDoUpdates( hWndForm, hMainSql, TRUE )
.head 7 -  Call SqlClose( hMainSql )
.head 7 -  ! Delete
.head 7 -  Call SqlPrepare( hMainSql,
'DELETE FROM ttsap 
WHERE 
(tt=:strOperId) AND (ttap=:colTT)' )
.head 7 -  Call SalTblDoDeletes( hWndForm, hMainSql, ROW_MarkDeleted )
.head 7 -  Call SqlClose( hMainSql )
.head 5 -  ! Keyboard support
.head 5 +  On WM_KeyUp
.head 6 +  If wParam=VK_Insert
.head 7 -  Call SalSendMsg( hWndForm, SAM_DoubleClick, 0, 0 )
.head 6 +  If wParam=VK_Delete
.head 7 -  Call SalSendMsg( hWndForm, SAM_RowHeaderDoubleClick, 0, 0 )
.head 3 +  Child Table: tblBalAcc
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000900 546162466C616773 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.405"
.head 6 -  Width:  12.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.917"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colAccBNum
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер
счета
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 4
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.914"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAccBName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Имя балансового счета
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  9.114"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Д/К
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Click
.head 8 -  Set n0=SalTblQueryContext ( hWndForm )
.head 8 +  While TRUE
.head 9 -  Call SalTblSetContext ( hWndForm, n0 )
.head 9 -  Set colDn=not colDn
.head 9 -  Call SetColumnImage( colDC, hImage10, hImage11, colDn )
.head 9 -  Call SalTblSetRowFlags( hWndForm, n0, ROW_Selected, FALSE )
.head 9 +  If CheckItOut()
.head 10 -  Break
.head 8 -  Call SetInclExcl(0,1)
.head 8 -  Call SetInclExcl(1,1)
.head 8 -  Call SalSendMsg( hWndForm, UM_DoSaveChanges, 2, 0 )
.head 8 -  Call Modified(  )
.head 5 +  Column: colX   ! только/кроме
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вкл/
Викл
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.643"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If GetGlobalOption('XPS_TTS')='Y'
.head 9 -  Call SalShowWindow( hWndItem )
.head 8 +  Else
.head 9 -  Call SalHideWindow( hWndItem )
.head 7 +  On SAM_Click
.head 8 -  Set colXn=not colXn
.head 8 -  Call SetColumnImage( hWndItem, hImage20, hImage21, colXn )
.head 8 -  Call SalTblSetRowFlags( hWndForm, lParam, ROW_Selected, FALSE )
.head 8 -  Call SetInclExcl(colDn,colXn)
.head 8 -  Call SalSendMsg( hWndForm, UM_DoSaveChanges, 2, 0 )
.head 8 -  Call Modified(  )
.head 5 +  Column: colDn
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значение
Д/К
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On UM_ObjActivate
.head 8 +  If SalIsWindowVisible ( hWndItem )
.head 9 -  Call SalHideWindow( hWndItem )
.head 8 +  Else
.head 9 -  Call SalShowWindow( hWndItem )
.head 5 +  Column: colXn
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значение
+/-
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On UM_ObjActivate
.head 8 +  If GetGlobalOption('XPS_TTS')='Y'
.head 9 +  If SalIsWindowVisible ( hWndItem )
.head 10 -  Call SalHideWindow( hWndItem )
.head 9 +  Else
.head 10 -  Call SalShowWindow( hWndItem )
.head 5 +  Column: colRowid
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Rowid
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: SetInclExcl
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nDk
.head 7 -  Number: nXn
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 6 +  Actions
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(tblBalAcc, nRow, 0, 0)
.head 8 -  Call SalTblSetContext ( tblBalAcc, nRow )
.head 8 +  If tblBalAcc.colDn=nDk
.head 9 -  Set tblBalAcc.colXn=nXn
.head 9 -  Call SetColumnImage( tblBalAcc.colX, hImage20, hImage21, tblBalAcc.colXn )
.head 5 +  Function: SetColumnImage
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: hWndCol
.head 7 -  Number: hImage0
.head 7 -  Number: hImage1
.head 7 -  Boolean: bCheck
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If bCheck
.head 8 -  Call XSalTblSetCellImage( hWndCol, hImage1, XSalTableWindow_ImgCenterCenter )
.head 7 +  Else
.head 8 -  Call XSalTblSetCellImage( hWndCol, hImage0, XSalTableWindow_ImgCenterCenter )
.head 5 +  Function: CheckItOut
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sNbs
.head 7 -  Number: n
.head 7 -  Number: nDk
.head 7 -  Number: nRow
.head 6 +  Actions
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(tblBalAcc, nRow, 0, ROW_MarkDeleted)
.head 8 -  Call SalTblSetContext ( tblBalAcc, nRow )
.head 8 -  Set nDk  = tblBalAcc.colDn
.head 8 -  Set n=0
.head 8 -  Set sNbs = tblBalAcc.colAccBNum
.head 8 +  While TRUE
.head 9 -  Set n = VisTblFindString (tblBalAcc, n, tblBalAcc.colAccBNum, sNbs)
.head 9 +  If n = -1
.head 10 -  Break
.head 9 -  Call SalTblSetContext ( tblBalAcc, n )
.head 9 +  If n != nRow
.head 10 +  If tblBalAcc.colDn=nDk
.head 11 -  ! Плохо: Уже есть
.head 11 +  If nDk=0
.head 12 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrNbsD') || PutCrLf() ||
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgUpdate'),
  CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok |  MB_IconStop )
.head 11 +  Else
.head 12 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrNbsC') || PutCrLf() ||
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgUpdate'),
  CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok |  MB_IconStop )
.head 11 -  Return FALSE
.head 9 -  Set n=n+1
.head 8 -  Call SalTblSetContext ( tblBalAcc, nRow )
.head 7 -  Return TRUE
.head 4 +  Window Variables
.head 5 -  String: strCode
.head 5 -  String: strName
.head 5 -  Number: hImage10
.head 5 -  Number: hImage11
.head 5 -  Number: hImage20
.head 5 -  Number: hImage21
.head 5 -  Number: n
.head 5 -  Number: n0
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 6 -  Set hImage10 = XSalImageFromResource( "bmpDebet" )
.head 6 -  Set hImage11 = XSalImageFromResource( "bmpKredit" )
.head 6 -  Set hImage20 = XSalImageFromResource( "bmpNegative" )
.head 6 -  Set hImage21 = XSalImageFromResource( "bmpPositive" )
.head 5 -  ! Populating
.head 5 +  On UM_DoPopulate
.head 6 -  Call SalTblPopulate( hWndForm, hMainSql,
'SELECT a.nbs,b.name,a.dk'||IifS(GetGlobalOption('XPS_TTS')='Y',',NVL(a.x,1)',',1')||',a.rowid '||
 ' INTO :colAccBNum,:colAccBName,:colDn,:colXn,:colRowid'||
 ' FROM ps_tts a,ps b WHERE (a.nbs=b.nbs) AND (a.tt=:strOperId) ORDER BY a.dk,a.nbs',TBL_FillAll )
.head 5 -  ! Deleting
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 +  If NOT SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted, TRUE, ROW_Selected, ROW_MarkDeleted )
.head 7 -  Call SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted, FALSE,ROW_Selected, 0 )
.head 6 -  Call Modified(  )
.head 5 -  ! Inserting
.head 5 +  On SAM_DoubleClick
.head 6 -  ! 'Балансовые счета'
.head 6 +  If ShowPickList( dlg_OperCard, 'SELECT nbs,name FROM ps ORDER BY nbs',
   CurrentLangTable.GetAtomTitle('dlg_OperCard.cTBalAcc'),'ps',strCode,strName )=1
.head 7 -  Set nDC = 1
.head 7 -  Set n   = VisTblFindString (tblBalAcc,    0, tblBalAcc.colAccBNum, strCode)
.head 7 +  If n >= 0
.head 8 -  Call SalTblSetContext( hWndForm, n )
.head 8 -  Set nDC = tblBalAcc.colDn
.head 8 -  Set n   = VisTblFindString (tblBalAcc, n+1, tblBalAcc.colAccBNum, strCode)
.head 7 +  If n >= 0
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrNbsDC') || PutCrLf() ||
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgInsert'),
  CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok |  MB_IconStop )
.head 7 +  Else
.head 8 -  Call SalTblSetContext( hWndForm, SalTblInsertRow( hWndForm, TBL_MaxRow ) )
.head 8 -  Set colAccBNum =strCode
.head 8 -  Set colAccBName=strName
.head 8 -  Set colDn = not nDC
.head 8 -  Call SalSendMsg( hWndForm, SAM_FetchRowDone, 0, 0 )
.head 8 -  Call SetInclExcl(0,1)
.head 8 -  Call SetInclExcl(1,1)
.head 8 -  Call SalSendMsg( hWndForm, UM_DoSaveChanges, 1, 0 )
.head 8 -  Call Modified(  )
.head 5 -  ! Saving changes
.head 5 +  On UM_DoSaveChanges
.head 6 -  ! Update
.head 6 -  Call SqlPrepareAndExecute( hMainSql,"DELETE FROM ps_tts WHERE tt=:strOperId")
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow( hWndForm, nRow, 0, ROW_MarkDeleted )
.head 7 -  Call SalTblSetContext( hWndForm, nRow )
.head 7 +  If GetGlobalOption('XPS_TTS')='Y'
.head 8 -  Call SqlPrepareAndExecute( hMainSql,'INSERT INTO ps_tts (tt,nbs,dk,x) VALUES (:strOperId,:colAccBNum,:colDn,:colXn)' )
.head 7 +  Else
.head 8 -  Call SqlPrepareAndExecute( hMainSql,'INSERT INTO ps_tts (tt,nbs,dk) VALUES (:strOperId, :colAccBNum, :colDn)' )
.head 7 -  ! Call Debug(colAccBNum)
.head 5 -  ! Keyboard support
.head 5 +  On WM_KeyUp
.head 6 +  If wParam=VK_Insert
.head 7 -  Call SalSendMsg( hWndForm, SAM_DoubleClick, 0, 0 )
.head 6 +  If wParam=VK_Delete
.head 7 -  Call SalSendMsg( hWndForm, SAM_RowHeaderDoubleClick, 0, 0 )
.head 6 +  If wParam=VK_F12
.head 7 -  Call SalSendMsg( colXn, UM_ObjActivate, 0, 0 )
.head 7 -  Call SalSendMsg( colDn, UM_ObjActivate, 0, 0 )
.head 5 +  On SAM_FetchRowDone
.head 6 -  Call SetColumnImage( tblBalAcc.colDC, hImage10, hImage11, tblBalAcc.colDn )
.head 6 -  Call SetColumnImage( tblBalAcc.colX,  hImage20, hImage21, tblBalAcc.colXn )
.head 5 +  On SAM_Destroy
.head 6 -  Call XSalImageClose( hImage10 )
.head 6 -  Call XSalImageClose( hImage11 )
.head 6 -  Call XSalImageClose( hImage20 )
.head 6 -  Call XSalImageClose( hImage21 )
.head 3 +  Child Table: tblVOB
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.405"
.head 6 -  Width:  12.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 5.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colVOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.967"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Виды банковских документов
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  5.25"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTemplate
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Файл шаблона
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.917"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colORD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Порядок сорт
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  ! On SAM_Validate
.head 8 +     If SqlPrepareAndExecute( hMainSql, "UPDATE tts_vob SET ord=:colORD WHERE tt=:strOperId AND vob=:colVOB "  )
.head 9 -     Call SqlClose( hMainSql )
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strCode
.head 5 -  String: strName
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 5 -  ! Populating
.head 5 +  On UM_DoPopulate
.head 6 -  Call SalTblPopulate( hWndForm,hMainSql,
"SELECT a.vob, b.name, UPPER(b.rep_prefix) rep_prefix, a.ord
   FROM tts_vob a,vob b 
  WHERE a.vob=b.vob AND a.tt=:strOperId ORDER BY a.ord ",TBL_FillAll )
.head 5 -  ! Deleting
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 +  If NOT SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted, TRUE, ROW_Selected, ROW_MarkDeleted )
.head 7 -  Call SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted, FALSE, ROW_Selected, 0 )
.head 6 -  Call Modified(  )
.head 5 -  ! Inserting
.head 5 +  On SAM_DoubleClick
.head 6 -  ! 'Документы'
.head 6 +  If ShowPickList( dlg_OperCard,
'SELECT vob,name FROM vob WHERE vob NOT IN (SELECT vob FROM tts_vob WHERE tt=:dlg_OperCard.strOperId) ORDER BY name',
 CurrentLangTable.GetAtomTitle('dlg_OperCard.cTVob'),'vob',strCode,strName )=1
.head 7 -  Call SalTblSetContext( hWndForm, SalTblInsertRow( hWndForm, TBL_MaxRow ) )
.head 7 -  Set colVOB=SalStrToNumber( strCode )
.head 7 -  Set colDName=strName
.head 7 -  Call SalSendMsg( hWndForm, UM_DoSaveChanges, 1, 0 )
.head 7 -  Call Modified(  )
.head 5 -  ! Saving changes
.head 5 +  On UM_DoSaveChanges
.head 6 +  If wParam=1
.head 7 -  ! Insert
.head 7 -  Call SqlPrepare( hMainSql,"INSERT INTO tts_vob (tt,vob,ord) VALUES (:strOperId, :colVOB, :colORD ) " )
.head 7 -  Call SalTblDoInserts( hWndForm, hMainSql, TRUE )
.head 7 -  Call SqlClose( hMainSql )
.head 6 +  Else
.head 7 -  ! Delete
.head 7 -  Call SqlPrepare( hMainSql, "DELETE FROM tts_vob WHERE tt=:strOperId AND vob=:colVOB " )
.head 7 -  Call SalTblDoDeletes( hWndForm, hMainSql, ROW_MarkDeleted )
.head 7 -  Call SqlClose( hMainSql )
.head 7 -  ! Update
.head 7 -  Call SqlPrepare( hMainSql, "UPDATE tts_vob SET ord=:colORD WHERE tt=:strOperId AND vob=:colVOB " )
.head 7 -  Call SalTblDoUpdates( hWndForm, hMainSql, TRUE )
.head 7 -  Call SqlClose( hMainSql )
.head 5 -  ! Keyboard support
.head 5 +  On WM_KeyUp
.head 6 +  If wParam=VK_Insert
.head 7 -  Call SalSendMsg( hWndForm, SAM_DoubleClick, 0, 0 )
.head 6 +  If wParam=VK_Delete
.head 7 -  Call SalSendMsg( hWndForm, SAM_RowHeaderDoubleClick, 0, 0 )
.head 3 +  Child Table: tblGrps
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65350000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.405"
.head 6 -  Width:  12.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.9"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colGName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Группы контроля
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  9.267"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCharged
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Подпись
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Class Default
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? No
.head 8 -  Auto Drop Down? Yes
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 +  List Values
.head 7 -  Text: Нет
.head 7 -  Text: Внтр
.head 7 -  Text: СЕП
.head 7 -  Text: Внтр+СЕП
.head 7 -  Text: Грп
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Set nCharged=SalListQuerySelection( hWndItem )
.head 7 +  On SAM_Create
.head 8 +  If not(GetGlobalOption( 'VISASIGN' ) = '1' and
       GetGlobalOption( 'INTSIGN' ) = '2')
.head 9 -  Call SalHideWindow(hWndItem)
.head 5 +  Column: colPriority
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Приоритеты
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On WM_KeyUp
.head 8 +  If wParam=VK_Insert
.head 9 -  Call SalSendMsg( hWndForm, SAM_DoubleClick, 0, 0 )
.head 7 +  On SAM_AnyEdit
.head 8 -  Call Modified(  )
.head 5 +  Column: colSqlVal
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Условие визы
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 2048
.head 6 -  Data Type: Long String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: nCharged
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strCode
.head 5 -  String: strName
.head 5 -  ! Error Handling
.head 5 -  Sql Handle: hSqlGlobal
.head 5 -  Number: nErr
.head 5 -  Number: nPos
.head 5 -  Long String: lsTmp
.head 5 -  Boolean: bTmp
.head 5 -  ! Number: nChrgd
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 5 -  ! Populating
.head 5 +  On UM_DoPopulate
.head 6 -  Call SalTblPopulate( hWndForm,
hMainSql,
'SELECT a.idchk,b.name,NVL(a.f_in_charge,4),a.priority,a.sqlval
   INTO :colId,:colGName,:nCharged,:colPriority,:colSqlVal
   FROM chklist_tts a,chklist b WHERE (a.idchk=b.idchk) AND (a.tt=:strOperId)
  ORDER BY a.priority',
TBL_FillAll )
.head 5 +  On SAM_FetchRowDone
.head 6 -  Call SalListSetSelect ( colCharged, nCharged )
.head 5 -  ! Deleting
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 +  If NOT SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted, TRUE, ROW_Selected, ROW_MarkDeleted )
.head 7 -  Call SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted, FALSE, ROW_Selected, 0 )
.head 6 -  Call Modified(  )
.head 5 -  ! Inserting
.head 5 +  On SAM_DoubleClick
.head 6 -  ! Делаем все вставки
.head 6 -  ! Call SalSendMsg( tblGrps, UM_DoSaveChanges, 1, 0 )
.head 6 -  ! Делаем все обновления
.head 6 -  ! Call SalSendMsg( tblGrps, UM_DoSaveChanges, 0, 0 )
.head 6 -  ! 'Группы контроля'
.head 6 +  If ShowPickList( dlg_OperCard,
'SELECT idchk,name FROM chklist WHERE idchk NOT IN (SELECT idchk FROM chklist_tts WHERE tt=:dlg_OperCard.strOperId)
ORDER BY  name',
CurrentLangTable.GetAtomTitle('dlg_OperCard.cTGrps'),
'',
strCode,
strName )=1
.head 7 -  Call SalTblSetContext( hWndForm, SalTblInsertRow( hWndForm, TBL_MaxRow ) )
.head 7 -  Set colId=SalStrToNumber( strCode )
.head 7 -  Set colGName=strName
.head 7 -  Set colPriority=NUMBER_Null
.head 7 -  Set colSqlVal=STRING_Null
.head 7 -  ! Call SalSendMsg( hWndForm, UM_DoSaveChanges, 1, 0 )
.head 7 -  Call Modified(  )
.head 5 -  ! Saving changes
.head 5 +  On UM_DoSaveChanges
.head 6 +  If wParam=1
.head 7 -  ! Insert
.head 7 -  ! Error handling
.head 7 +  When SqlError
.head 8 -  Call SqlExtractArgs (wParam, lParam, hSqlGlobal, nErr, nPos)
.head 8 -  ! Call Debug( SalNumberToStrX( nErr, 0 ) )
.head 8 +  If nErr = 20001
.head 9 -  ! Call SalMessageBox( 'Группы контроля с одинаковыми приоритетами не допустимы!',
'Нарушение целостности', MB_Ok | MB_IconAsterisk )
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrGrpPriority'),
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgConstr'), MB_Ok | MB_IconAsterisk )
.head 9 -  Return FALSE
.head 7 -  Call SqlPrepare( hMainSql,
'INSERT INTO chklist_tts
(tt,idchk,priority,sqlval,f_in_charge)
VALUES
(:strOperId, :colId, :colPriority, :colSqlVal, DECODE(:nCharged,4,NULL,:nCharged))' )
.head 7 -  Call SalTblDoInserts( hWndForm,
hMainSql,
TRUE )
.head 7 -  Call SqlClose( hMainSql )
.head 6 +  Else
.head 7 -  ! Update
.head 7 -  ! Error handling
.head 7 +  When SqlError
.head 8 -  Call SqlExtractArgs (wParam, lParam, hSqlGlobal, nErr, nPos)
.head 8 -  ! Call Debug( SalNumberToStrX( nErr, 0 ) )
.head 8 +  If nErr = 20001
.head 9 -  ! Call SalMessageBox( 'Группы контроля с одинаковыми приоритетами не допустимы!',
'Нарушение целостности',  MB_Ok | MB_IconAsterisk )
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrGrpPriority'),
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgConstr'), MB_Ok | MB_IconAsterisk )
.head 9 -  Return FALSE
.head 7 -  Call SqlPrepare( hMainSql,
'UPDATE chklist_tts 
    SET priority=:colPriority,sqlval=:colSqlVal,
     f_in_charge=DECODE(:nCharged,4,NULL,:nCharged) 
  WHERE (tt=:strOperId) AND (idchk=:colId)' )
.head 7 -  Call SalTblDoUpdates( hWndForm, hMainSql, TRUE )
.head 7 -  Call SqlClose( hMainSql )
.head 7 -  ! Delete
.head 7 -  Call SqlPrepare( hMainSql,
'DELETE FROM chklist_tts 
  WHERE (tt=:strOperId) AND (idchk=:colId)' )
.head 7 -  Call SalTblDoDeletes( hWndForm, hMainSql, ROW_MarkDeleted )
.head 7 -  Call SqlClose( hMainSql )
.head 5 -  ! Keyboard support
.head 5 +  On WM_KeyUp
.head 6 +  If wParam=VK_Insert
.head 7 -  Call SalSendMsg( hWndForm, SAM_DoubleClick, 0, 0 )
.head 6 +  If wParam=VK_Delete
.head 7 -  Call SalSendMsg( hWndForm, SAM_RowHeaderDoubleClick, 0, 0 )
.head 6 +  If wParam=VK_F4
.head 7 -  Call SalSendMsg( hWndForm, WM_RbuttonDblClick, 0, 0)
.head 5 -  ! условие визы
.head 5 +  On WM_RbuttonDblClick
.head 6 +  If SalTblAnyRows( tblGrps, ROW_Selected, 0 )
.head 7 -  Set lsTmp=colSqlVal
.head 7 -  ! 'Редактирование условия визы'
.head 7 -  Call SalModalDialog( dlg_MemoEditor, 
dlg_OperCard.tblGrps, 
CurrentLangTable.GetAtomTitle('dlg_OperCard.cTGrpSqlVal'), 
bTmp,
lsTmp )
.head 7 +  If bTmp
.head 8 -  Set colSqlVal=lsTmp
.head 8 -  Call SalTblSetRowFlags( tblGrps, 
	SalTblQueryContext( tblGrps ), ROW_Edited, TRUE )
.head 8 -  ! Call SalSendMsg( hWndForm, UM_DoSaveChanges, 0, 0 )
.head 8 -  Call Modified()
.head 3 -  !
.head 3 -  ! Background Text: *Отметка в поле Д/К соответствует Кредиту
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000900 546162466C616773 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    5.429"
.head 5 -  Width:  4.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 +  ! cLabelControl: bgOtmDK
.winattr class Data Field:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  0.0"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.0"
.head 6 -  Height Editable? No
.head 5 -  Visible? No
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -    Message Actions 
.head 3 -  Background Text: F4 или двойной щелчек правой кнопкой на строке - редактирование уловия визы
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6535000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 47017
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    5.43"
.head 5 -  Width:  8.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgF4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Del или двойной щелчек на заголовке строки - пометка на удаление; Ins или двойной щелчек в области таблицы - добавление в список
.data CLASSPROPSSIZE
0000: 2200
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000F00 546162436861696E 65644F7065720000
0020: 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 41716
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    5.786"
.head 5 -  Width:  12.033"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDelIns1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Del или двойной щелчек на заголовке строки - пометка на удаление; Ins или двойной щелчек в области таблицы - добавление в список
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 54616245504F7065 720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 41719
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.117"
.head 5 -  Top:    5.726"
.head 5 -  Width:  12.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDelIns2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Del или двойной щелчек на заголовке строки - пометка на удаление; Ins или двойной щелчек в области таблицы - добавление в список
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000900 546162466C616773 00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 41717
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    5.786"
.head 5 -  Width:  11.633"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDelIns3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Del или двойной щелчек на заголовке строки - пометка на удаление; Ins или двойной щелчек в области таблицы - добавление в список
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6534000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 41715
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    5.786"
.head 5 -  Width:  12.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDelIns4
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 -  Background Text: Del или двойной щелчек на заголовке строки - пометка на удаление; Ins или двойной щелчек в области таблицы - добавление в список
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6535000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 41713
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    5.786"
.head 5 -  Width:  12.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? No
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDelIns5
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbDK
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.483"
.head 5 -  Top:    0.679"
.head 5 -  Width:  2.883"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? Yes
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call Modified(  )
.head 3 +  Multiline Field: dfSum
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 254
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   0.233"
.head 6 -  Top:    4.19"
.head 6 -  Width:  6.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.917"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call Modified(  )
.head 3 +  Multiline Field: dfSum2
.data CLASSPROPSSIZE
0000: 1E00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 657200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 254
.head 5 -  String Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   6.3"
.head 6 -  Top:    4.19"
.head 6 -  Width:  6.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.917"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call Modified(  )
.head 3 +  Multiline Field: mlInfo
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 1000000
.head 5 -  String Type: Long String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    0.738"
.head 6 -  Width:  11.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 4.833"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Courier New Cyr
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbPrintOper
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbPrint
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.405"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? No
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  ! Set strTip='Распечатать описание операции'
.head 6 -  Set strTip = CurrentLangTable.GetAtomTitle('dlg_OperCard.cBTipPrintOper')
.head 5 +  On SAM_Click
.head 6 -  Call SaveInfo()
.head 3 +  Child Table: tblFOLD
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6537000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.25"
.head 6 -  Top:    0.429"
.head 6 -  Width:  11.883"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 5.345"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colFOLD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.967"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование папки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  8.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strCode
.head 5 -  String: strName
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 5 -  ! Populating
.head 5 +  On UM_DoPopulate
.head 6 -  Call SalTblPopulate( hWndForm,hMainSql,
'SELECT a.idfo, b.name FROM folders_tts a, folders b 
WHERE a.idfo=b.idfo AND a.tt=:strOperId ORDER BY b.name',TBL_FillAll )
.head 5 -  ! Deleting
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 +  If NOT SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted, TRUE, ROW_Selected, ROW_MarkDeleted )
.head 7 -  Call SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted, FALSE, ROW_Selected, 0 )
.head 6 -  Call Modified(  )
.head 5 -  ! Inserting
.head 5 +  On SAM_DoubleClick
.head 6 -  ! 'Папки'
.head 6 +  If ShowPickList( dlg_OperCard,
'SELECT idfo,name FROM folders WHERE idfo NOT IN 
(SELECT idfo FROM folders_tts WHERE tt=:dlg_OperCard.strOperId)
ORDER BY name',
CurrentLangTable.GetAtomTitle('dlg_OperCard.cTFold'), 'idfo',
strCode, strName )=1
.head 7 -  Call SalTblSetContext( hWndForm, SalTblInsertRow( hWndForm, TBL_MaxRow ) )
.head 7 -  Set colFOLD =SalStrToNumber( strCode )
.head 7 -  Set colFName=strName
.head 7 -  Call SalSendMsg( hWndForm, UM_DoSaveChanges, 1, 0 )
.head 7 -  Call Modified(  )
.head 5 -  ! Saving changes
.head 5 +  On UM_DoSaveChanges
.head 6 +  If wParam=1
.head 7 -  ! Insert
.head 7 -  Call SqlPrepare( hMainSql,
'INSERT INTO folders_tts (tt,idfo) VALUES (:strOperId, :colFOLD)' )
.head 7 -  Call SalTblDoInserts( hWndForm, hMainSql, TRUE )
.head 7 -  Call SqlClose( hMainSql )
.head 6 +  Else
.head 7 -  ! Delete
.head 7 -  Call SqlPrepare( hMainSql,
'DELETE FROM folders_tts 
WHERE (tt=:strOperId) AND (idfo=:colFOLD)' )
.head 7 -  Call SalTblDoDeletes( hWndForm, hMainSql, ROW_MarkDeleted )
.head 7 -  Call SqlClose( hMainSql )
.head 5 -  ! Keyboard support
.head 5 +  On WM_KeyUp
.head 6 +  If wParam=VK_Insert
.head 7 -  Call SalSendMsg( hWndForm, SAM_DoubleClick, 0, 0 )
.head 6 +  If wParam=VK_Delete
.head 7 -  Call SalSendMsg( hWndForm, SAM_RowHeaderDoubleClick, 0, 0 )
.head 3 -  ! !!!!!!!!!!!
.head 3 -  Frame
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 31298
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    2.69"
.head 5 -  Width:  10.267"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Raised-Shadow
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Picture: pic2
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.536"
.head 5 -  Width:  3.783"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.536"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 3 +  Picture: pic3
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.25"
.head 5 -  Top:    0.536"
.head 5 -  Width:  3.35"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.536"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 -  ! Вызов универсального диалога выбора опций
.head 3 +  Function: ShowPickList
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Window Handle: hParent
.head 5 -  String: strSql
.head 5 -  String: strHeader
.head 5 -  String: strFilterTable
.head 5 -  Receive String: Identifier
.head 5 -  Receive String: Semantic
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strIdentifier
.head 5 -  String: strSemantic
.head 4 +  Actions
.head 5 +  If SalModalDialog( dlg_PickList, hParent, strSql, strHeader, strFilterTable, strIdentifier, strSemantic )=1
.head 6 -  Set Identifier=strIdentifier
.head 6 -  Set Semantic=strSemantic
.head 6 -  Return 1
.head 5 +  Else
.head 6 -  Return 0
.head 3 -  ! Управление событиями Табов
.head 3 +  Function: TabActivateStart
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Window Handle: hWnd
.head 5 -  Number: nTab
.head 4 +  Static Variables
.head 5 -  Number: nLastTab
.head 4 +  Local variables
.head 5 -  Boolean: fChkChanged
.head 4 +  Actions
.head 5 -  ! Реквизиты
.head 5 +  If nLastTab=1
.head 6 -  Call SalSendMsg( tblOpFlags, UM_DoSaveChanges, 0, 0 )
.head 6 -  Call SalSendMsg( tblOpRules, UM_DoSaveChanges, 0, 0 )
.head 5 +  If nTab=1
.head 6 -  Call SalSendMsg( tblOpFlags, UM_DoPopulate, 0, 0 )
.head 6 -  Call SalSendMsg( tblOpRules, UM_DoPopulate, 0, 0 )
.head 5 -  ! Связанные операции
.head 5 +  If nLastTab=2
.head 6 -  Call SalSendMsg( tblRelOpers, UM_DoSaveChanges, 0, 0 )
.head 5 +  If nTab=2
.head 6 -  Call SalSendMsg( tblRelOpers, UM_DoPopulate, 0, 0 )
.head 5 -  ! Баллансовые счета
.head 5 +  If nLastTab=3
.head 6 -  Call SalSendMsg( tblBalAcc, UM_DoSaveChanges, 0, 0 )
.head 5 +  If nTab=3
.head 6 -  Call SalSendMsg( tblBalAcc, UM_DoPopulate, 0, 0 )
.head 5 -  ! Документы
.head 5 +  If nLastTab=4
.head 6 -  Call SalSendMsg( tblVOB, UM_DoSaveChanges, 0, 0 )
.head 5 +  If nTab=4
.head 6 -  Call SalSendMsg( tblVOB, UM_DoPopulate, 0, 0 )
.head 5 -  ! Группы
.head 5 +  If nLastTab=5
.head 6 +  If SalTblAnyRows( tblGrps, ROW_New | ROW_Edited | ROW_MarkDeleted, 0 )
.head 7 -  Set fChkChanged=TRUE
.head 6 +  If fChkChanged
.head 7 -  ! If SalMessageBox( 
'Вы изменили маршрут визирования операции!
Внимание! Возможны следующие последствия:
  Потребуется время для модификации маршрута 
    визирования недовизированных документов.
  Необходимо будет визировать 
    недовизированные документы заново.
  Все недовизированные документы будут 
    заблокированны для визирования и оплаты 
    до сохранения изменений. (Рекомендуется сразу 
    же после этого сохранить изменения)
Сохранить? ', 'Подтверждение', MB_IconQuestion | MB_YesNo )=IDYES
.head 7 +  If SalMessageBox( 
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgVisa1') || PutCrLf() || 
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgVisa2') || PutCrLf() ||  
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgVisa3') || PutCrLf() || 
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgVisa4') || PutCrLf() || 
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgVisa5') || PutCrLf() || 
  CurrentLangTable.GetAtomTitle('frm_OperList.cTMsgSave'), 
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgOk'), MB_IconQuestion | MB_YesNo )=IDYES
.head 8 -  Call SalSendMsg( tblGrps, UM_DoSaveChanges, 1, 0 )
.head 8 -  Call SalSendMsg( tblGrps, UM_DoSaveChanges, 0, 0 )
.head 8 -  ! Call SqlPrepareAndExecute( hMainSql, 
"UPDATE OPER SET chk=NULL WHERE  ref IN (SELECT ref FROM ref_que) AND 
                  tt=:strOperId AND sos BETWEEN 0 AND 3 AND NEXTVISAGRP<>'!!'" )
.head 8 -  Call SqlPLSQLCommand(hMainSql,"chk.reset_visa_history(strOperId)")
.head 5 +  If nTab=5
.head 6 -  Call SalSendMsg( tblGrps, UM_DoPopulate, 0, 0 )
.head 5 -  ! Информация об операции
.head 5 +  If nTab=6
.head 6 -  Set mlInfo=frm_OperList.OperationInfo(strOperId)
.head 5 -  ! Папки
.head 5 +  If nLastTab=7
.head 6 -  Call SalSendMsg( tblFOLD, UM_DoSaveChanges, 0, 0 )
.head 5 +  If nTab=7
.head 6 -  Call SalSendMsg( tblFOLD, UM_DoPopulate, 0, 0 )
.head 5 -  Set nLastTab=nTab
.head 3 -  ! Установка флага редактирования
.head 3 +  Function: Modified
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set fModified=TRUE
.head 3 -  ! Печать информации
.head 3 +  Function: SaveInfo
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  File Handle: hFile
.head 5 -  String: sFileName
.head 4 +  Actions
.head 5 -  Set sFileName=GetPrnDir() || "\\op_" || SalNumberToStrX( SalDateHour( Date() ), 0 ) || SalNumberToStrX( SalDateMinute( Date() ), 0 ) 
.head 5 -  Call VisFileOpen( hFile, sFileName, OF_Create )
.head 5 -  Call VisFileWriteString( hFile, mlInfo )
.head 5 -  Call VisFileClose( hFile )
.head 5 -  Call DosDirectPrint( sFileName )
.head 3 -  ! Загрузка параметров из реестра
.head 3 +  Function: LoadFromReg
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nValue
.head 5 -  String: sValue
.head 4 +  Actions
.head 5 -  Call SalUseRegistry( TRUE, GetCompanyName() )
.head 5 -  Call SalGetProfileString( 'Main Menu' || '\\' || GetUserLoginName(), 'TransConstrutor', '0', sValue, GetProductName() )
.head 5 -  Set nValue = SalStrToNumber(sValue)
.head 5 -  Call picTabs.BringToTop( nValue, TRUE )
.head 5 -  Call dlg_OperCard.TabActivateStart( hWndForm, nValue )
.head 3 -  ! Выгрузка параметров в реестр
.head 3 +  Function: SaveToReg
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalUseRegistry( TRUE, 'UnityBars' )
.head 5 -  Call SalSetProfileString( 'Main Menu' || '\\' || GetUserLoginName(), 'TransConstrutor', SalNumberToStrX( nPrevTab, 0 ), GetProductName())
.head 2 +  Window Parameters
.head 3 -  String: strOperId
.head 3 -  Sql Handle: hMainSql
.head 3 -  Number: Option
.head 2 +  Window Variables
.head 3 -  Number: nDebitCredit
.head 3 -  Number: nFli
.head 3 -  String: strSql
.head 3 -  String: strFli
.head 3 -  String: strFliName
.head 3 -  Number: nComplex
.head 3 -  Number: nMulti
.head 3 -  String: strTT_NAME
.head 3 -  Number: nFetchRes
.head 3 -  Boolean: bInited
.head 3 -  ! Параметры базовой валюты
.head 3 -  Number: nBaseCur
.head 3 -  ! String: strBaseCur
.head 3 -  ! Хранение acc для маржинальных счетов
.head 3 -  Number: nS62
.head 3 -  Number: nS72
.head 3 -  ! Проверка составной операции
.head 3 -  Number: nChildCount
.head 3 -  ! Врем. переменные
.head 3 -  Number: nRowToClear
.head 3 -  Number: nDC
.head 3 -  Date/Time: dtAccClose
.head 3 -  Number: nTmp
.head 3 -  String: strTmp
.head 3 -  ! Флаг наличия доп. реквизитов
.head 3 -  Boolean: fAddRec
.head 3 -  ! Имя функции (для Log'а)
.head 3 -  String: sFuncName
.head 3 -  Boolean: fModified
.head 3 -  Number: nPrevTab
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Call SalCenterWindow( dlg_OperCard )
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('dlg_OperCard.cTWndTitle') )
.head 4 -  Set bInited=FALSE
.head 4 -  ! Set sFuncName='Карточка операции'
.head 4 -  Set sFuncName = CurrentLangTable.GetAtomTitle('dlg_OperCard.cTToLogOperCard')
.head 4 -  Call SalSetWindowLabelText( bgDelIns1, CurrentLangTable.GetAtomTitle('dlg_OperCard.bgDelIns') )
.head 4 -  Call SalSetWindowLabelText( bgDelIns2, CurrentLangTable.GetAtomTitle('dlg_OperCard.bgDelIns') )
.head 4 -  Call SalSetWindowLabelText( bgDelIns3, CurrentLangTable.GetAtomTitle('dlg_OperCard.bgDelIns') )
.head 4 -  Call SalSetWindowLabelText( bgDelIns4, CurrentLangTable.GetAtomTitle('dlg_OperCard.bgDelIns') )
.head 4 -  Call SalSetWindowLabelText( bgDelIns5, CurrentLangTable.GetAtomTitle('dlg_OperCard.bgDelIns') )
.head 3 -  ! Populating
.head 3 +  On SAM_CreateComplete
.head 4 -  ! Call SaveInfoToLog( sFuncName || ' : Начато редактирование операции ' || strOperId )
.head 4 -  Call SaveInfoToLog( sFuncName || ' : ' || 
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTToLogBeginEdit') || ' ' || strOperId )
.head 4 -  ! Население Combo видов операции
.head 4 -  Call SalListPopulate( cmbDK, hMainSql, 'SELECT name FROM dk' )
.head 4 -  ! Свойств видов операции
.head 4 -  Set strSql=T(
"SELECT a.dk   , a.kv , a.kvk , a.nlsm, a.nlsk, a.name, a.flc,
        a.fli  , a.flv, a.nlsb, a.mfob, a.s   , a.s2  , a.sk ,
        a.s3800, b.nls, c.nls , a.rang, a.nlsa, NAZN
 INTO :nDebitCredit,:dfKvA   ,:dfKvB   ,:dfAccA,:dfAccB,:strTT_NAME,:nComplex,
      :nFli,:nMulti,:dfBankB ,:dfMfoB  ,:dfSum ,:dfSum2,:dfSKP,
      :dfAccVP     ,:dfAccInc,:dfAccExp,:dfPriority,:dfBankA  ,:dfNAZN 
FROM tts a, OUTER accounts b, OUTER accounts c
WHERE a.s6201=b.acc (+) AND a.s7201=c.acc (+) AND a.tt=:strOperId")
.head 4 -  Call SqlPrepareAndExecute( hMainSql, strSql )
.head 4 -  Call SqlFetchNext( hMainSql, nFetchRes )
.head 4 -  Set dfBankA = VisStrTrim(dfBankA)
.head 4 -  Set dfBankB = VisStrTrim(dfBankB)
.head 4 -  Call SqlClose( hMainSql )
.head 4 +  If nFetchRes != FETCH_Ok
.head 5 -  Call SalEndDialog( dlg_OperCard, 0 )
.head 4 +  Else
.head 5 -  ! Флаг инициализированности
.head 5 -  Set bInited=TRUE
.head 5 -  ! Д/К
.head 5 +  If nDebitCredit=NUMBER_Null
.head 6 -  Call SqlPrepareAndExecute( hMainSql, 'SELECT name INTO :cmbDK FROM dk WHERE dk=:0' )
.head 6 -  Call SqlFetchNext( hMainSql, nFetchRes )
.head 6 -  Call SqlClose( hMainSql )
.head 5 +  Else
.head 6 -  Call SqlPrepareAndExecute( hMainSql, 'SELECT name INTO :cmbDK FROM dk WHERE dk=:nDebitCredit' )
.head 6 -  Call SqlFetchNext( hMainSql, nFetchRes )
.head 6 -  Call SqlClose( hMainSql )
.head 5 -  ! Проверка сложности
.head 5 -  Set nChildCount=0
.head 5 -  Set strSql='SELECT COUNT(*) INTO :nChildCount FROM ttsap WHERE tt=:strOperId'
.head 5 -  Call SqlPrepareAndExecute( hMainSql, strSql )
.head 5 -  Call SqlFetchNext( hMainSql, nFetchRes )
.head 5 -  Call SqlClose( hMainSql )
.head 5 -  Set cbComplex=(nChildCount>0)
.head 5 -  Call SalSendMsg( cbComplex, SAM_User, 0, 0 )
.head 5 -  ! Мультивалютность
.head 5 -  Set cbMulti=(nMulti=1)
.head 5 -  Call SalSendMsg( cbMulti, SAM_User, 0, 0 )
.head 5 -  ! Заголовок окна
.head 5 -  ! Call SalSetWindowText( dlg_OperCard, 'Свойства операции [' || strOperId || '/' || strTT_NAME || ']' )
.head 5 -  Call SalSetWindowText( dlg_OperCard, CurrentLangTable.GetAtomTitle('dlg_OperCard.cTWndTitle') || ' [' || strOperId || '/' || strTT_NAME || ']' )
.head 5 -  ! Тип транзакции
.head 5 -  Set strSql='SELECT name 
INTO :strFliName 
FROM interbank WHERE fli=:nFli'
.head 5 -  Call SqlPrepareAndExecute( hMainSql, strSql )
.head 5 -  Call SqlFetchNext( hMainSql, nFetchRes )
.head 5 -  Call SqlClose( hMainSql )
.head 5 -  Set dfOperType=strFliName
.head 5 -  ! Базовая валюта
.head 5 -  Set nBaseCur=GetBaseVal()
.head 5 -  ! Set strSql="SELECT val
INTO :strBaseCur
FROM params
WHERE par='BASEVAL'"
.head 5 -  ! Call SqlPrepareAndExecute( hMainSql, strSql )
.head 5 -  ! Call SqlFetchNext( hMainSql, nFetchRes )
.head 5 -  ! Call SqlClose( hMainSql )
.head 5 +  ! If nFetchRes = FETCH_Ok
.head 6 -     Set nBaseCur=SalStrToNumber( strBaseCur )
.head 5 -  ! Флаг доп. реквизитов
.head 5 +  If SqlPrepareAndExecute( hMainSql, 'SELECT Value INTO :nTmp FROM tts_flags WHERE tt=:strOperId and fcode=35' )
.head 6 -  Call SqlFetchNext( hMainSql, nFetchRes )
.head 6 -  Call SqlClose( hMainSql )
.head 6 -  Set fAddRec= ( (nFetchRes=FETCH_Ok) AND (nTmp=1) )
.head 5 +  If fAddRec
.head 6 -  Call SalEnableWindow( tblOpRules )
.head 5 +  Else
.head 6 -  Call SalDisableWindow( tblOpRules )
.head 5 -  Call dlg_OperCard.TabActivateStart( hWndForm, 7 )
.head 5 -  Call SalWaitCursor ( FALSE )
.head 4 +  If Option != 9 
.head 5 -  Call LoadFromReg()
.head 4 +  Else
.head 5 -  Call picTabs.BringToTop( 6, TRUE )
.head 5 -  Call dlg_OperCard.TabActivateStart( hWndForm, 6 )
.head 3 +  On SAM_Close
.head 4 +  If Option != 9 
.head 5 -  ! Сохранение таба с группами контроля
.head 5 -  Call dlg_OperCard.TabActivateStart( hWndForm, 7 )
.head 5 -  Call SalSendMsg( tblGrps, UM_DoSaveChanges, 0, 0 )
.head 5 -  ! Проверка Д/К
.head 5 -  Set nDebitCredit=NUMBER_Null
.head 5 +  If SqlPrepareAndExecute( hMainSql, 'SELECT dk INTO :nDebitCredit FROM dk WHERE name=:cmbDK' )
.head 6 -  Call SqlFetchNext( hMainSql, nFetchRes )
.head 6 -  Call SqlClose( hMainSql )
.head 5 +  If nDebitCredit=NUMBER_Null
.head 6 -  ! If SalMessageBox( 'Вид банковской транзакции введен неправильно!
Продолжить?', 'Ошибка', MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 6 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrTt') || PutCrLf() ||
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgDone'),
  CurrentLangTable.GetAtomTitle('cTErr'), MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 7 -  Return FALSE
.head 5 -  ! Проверка счета А
.head 5 +  If dfAccA AND dfKvA
.head 6 -  Set nFetchRes=1
.head 6 +  If SqlPrepareAndExecute( hMainSql, 'SELECT acc INTO :nTmp FROM accounts WHERE nls=:dfAccA AND kv=:dfKvA' )
.head 7 -  Call SqlFetchNext( hMainSql, nFetchRes )
.head 7 -  Call SqlClose( hMainSql )
.head 6 +  If nFetchRes != FETCH_Ok
.head 7 +  ! If SalMessageBox( 'Счет ' || dfAccA ||'/'|| SalNumberToStrX( dfKvA, 0 ) || ', введенный как счет А
для оплаты, не существует!Продолжить?','Ошибка',MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 8 -     Return FALSE
.head 7 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrAcc') || ' ' || dfAccA ||'/'|| SalNumberToStrX( dfKvA, 0 ) || ', ' || 
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrAccA') || PutCrLf() || 
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgDone'), 
  CurrentLangTable.GetAtomTitle('cTErr'), MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 8 -  Return FALSE
.head 5 -  ! Проверка счета Б
.head 5 +  If dfAccB AND dfKvB
.head 6 -  Set nFetchRes=1
.head 6 +  If SqlPrepareAndExecute( hMainSql, 'SELECT acc INTO :nTmp FROM accounts WHERE nls=:dfAccB AND kv=:dfKvB' )
.head 7 -  Call SqlFetchNext( hMainSql, nFetchRes )
.head 7 -  Call SqlClose( hMainSql )
.head 6 +  If nFetchRes != FETCH_Ok
.head 7 -  ! If SalMessageBox( 'Счет ' || dfAccB ||'/'|| SalNumberToStrX( dfKvB, 0 ) || ', введенный как счет B
для оплаты, не существует!
Продолжить?','Ошибка', MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 7 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrAcc') || ' ' || dfAccB ||'/'|| SalNumberToStrX( dfKvB, 0 ) || ', ' || 
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrAccB') || PutCrLf() ||
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgDone'), 
  CurrentLangTable.GetAtomTitle('cTErr'), MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 8 -  Return FALSE
.head 5 -  ! Проверка МФО Б
.head 5 +  If dfMfoB
.head 6 -  Set nFetchRes=1
.head 6 +  If SqlPrepareAndExecute( hMainSql, 'SELECT mfo INTO :strTmp FROM banks WHERE mfo=:dfMfoB' )
.head 7 -  Call SqlFetchNext( hMainSql, nFetchRes )
.head 7 -  Call SqlClose( hMainSql )
.head 6 +  If nFetchRes != FETCH_Ok
.head 7 -  ! If SalMessageBox( 'МФО банка Б ' || dfMfoB ||' не существует!
Продолжить?','Ошибка',MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 7 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrMfoB') || ' ' || dfMfoB ||' ' ||
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrMfoBNotExist') || PutCrLf() ||
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgDone'),
  CurrentLangTable.GetAtomTitle('cTErr'), MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 8 -  Return FALSE
.head 5 -  ! Проверка счета валютной позиции
.head 5 +  If cbMulti AND (dfAccVP='')
.head 6 -  ! If SalMessageBox( 'Не указан счет валютной позиции для мульнивалютной операции!
Продолжить?','Ошибка',MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 6 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrAccVP') || PutCrLf() ||
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgDone'),
  CurrentLangTable.GetAtomTitle('cTAt'),  MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 7 -  Return FALSE
.head 5 -  ! Проверка маржинальных счетов
.head 5 +  If SqlPrepareAndExecute( hMainSql, 'SELECT fcode FROM tts_flags WHERE tt=:strOperId AND fcode=59' )
.head 6 +  If SqlFetchNext( hMainSql, nFetchRes )
.head 7 +  If nFetchRes=FETCH_Ok        !Признак торговой операции
.head 8 +  If (dfAccInc='') OR (dfAccExp='')
.head 9 -  ! If SalMessageBox( 'Не указаны маржинальные счета для торговой операции!
Продолжить?','Ошибка', MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 9 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrAccM') || PutCrLf() ||
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgDone'),
  CurrentLangTable.GetAtomTitle('cTErr'), MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 10 -  Return FALSE
.head 6 -  Call SqlClose( hMainSql )
.head 5 -  ! Достаем acc по nls и baseval
.head 5 -  Set nS62=NUMBER_Null
.head 5 +  If dfAccInc
.head 6 -  Set nFetchRes=1
.head 6 +  If SqlPrepareAndExecute( hMainSql, 'SELECT acc,dazs INTO :nS62, :dtAccClose FROM accounts WHERE nls=:dfAccInc AND kv=:nBaseCur' )
.head 7 -  Call SqlFetchNext( hMainSql, nFetchRes )
.head 7 -  Call SqlClose( hMainSql )
.head 6 +  If nFetchRes = FETCH_Ok
.head 7 +  If dtAccClose!=DATETIME_Null
.head 8 -  ! If SalMessageBox( 'Счет ' || dfAccInc || ', введенный как счет 
маржинальных доходов, закрыт!
Продолжить?','Ошибка', MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 8 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrAcc') || ' ' || dfAccInc || ', ' || 
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrAccMDClose') || PutCrLf() || 
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgDone'),
  CurrentLangTable.GetAtomTitle('cTErr'), MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 9 -  Return FALSE
.head 6 +  Else
.head 7 -  ! If SalMessageBox( 'Счет ' || dfAccInc || ', введенный как счет 
маржинальных доходов, не существует!
Продолжить?','Ошибка',MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 7 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrAcc') || ' ' || dfAccInc || ', ' || 
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrAccMDNotExist') || PutCrLf() || 
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgDone'),
  CurrentLangTable.GetAtomTitle('cTErr'), MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 8 -  Return FALSE
.head 5 -  Set nS72=NUMBER_Null
.head 5 +  If dfAccExp 
.head 6 -  Set nFetchRes=1
.head 6 +  If SqlPrepareAndExecute( hMainSql, 'SELECT acc,dazs INTO :nS72, :dtAccClose FROM accounts WHERE nls=:dfAccExp AND kv=:nBaseCur' )
.head 7 -  Call SqlFetchNext( hMainSql, nFetchRes )
.head 7 -  Call SqlClose( hMainSql )
.head 6 +  If nFetchRes = FETCH_Ok
.head 7 +  If dtAccClose!=DATETIME_Null
.head 8 -  ! If SalMessageBox( 'Счет ' || dfAccExp|| ', введенный как счет 
маржинальных расходов, закрыт!
Продолжить?', 'Ошибка',MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 8 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrAcc') || ' ' || dfAccExp|| ', ' || 
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrAccMRClose') || PutCrLf() || 
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgDone'),
  CurrentLangTable.GetAtomTitle('cTErr'), MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 9 -  Return FALSE
.head 6 +  Else
.head 7 -  ! If SalMessageBox( 'Счет ' || dfAccExp || ', введенный как счет 
маржинальных расходов, не существует!
Продолжить?','Ошибка', MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 7 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrAcc') || ' ' || dfAccExp || ', ' || 
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrAccMRNotExist') || PutCrLf() || 
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgDone'),
  CurrentLangTable.GetAtomTitle('cTErr'), MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 8 -  Return FALSE
.head 5 -  ! Проверка Priority IS NULL
.head 5 +  If SqlPrepareAndExecute( hMainSql, 'SELECT count(*) INTO :nTmp FROM chklist_tts WHERE tt=:strOperId and priority IS NULL' )
.head 6 -  Call SqlFetchNext( hMainSql, nFetchRes )
.head 6 +  If nTmp>0
.head 7 +  ! If SalMessageBox( 'В группах контроля присутствует группа с пустым приоритетом!
Продолжить?','Ошибка', MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 8 -     Return FALSE
.head 7 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrGrpEmptyPriority') || PutCrLf() || 
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgDone'),
  CurrentLangTable.GetAtomTitle('cTErr'), MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 8 -  Return FALSE
.head 6 -  Call SqlClose( hMainSql )
.head 5 -  ! Проверка группы контроля для плановой операции
.head 5 -  Set nTmp=0
.head 5 +  If SqlPrepareAndExecute( hMainSql, 'SELECT value INTO :nTmp FROM tts_flags WHERE tt=:strOperId and fcode=37' )
.head 6 -  Call SqlFetchNext( hMainSql, nFetchRes )
.head 6 -  Call SqlClose( hMainSql )
.head 6 -  ! Плановая
.head 6 +  If (nFetchRes!=FETCH_Ok) OR (nTmp=0)
.head 7 -  Set nTmp=0
.head 7 +  If SqlPrepareAndExecute( hMainSql, 'SELECT count(*) INTO :nTmp FROM chklist_tts WHERE tt=:strOperId' )
.head 8 -  Call SqlFetchNext( hMainSql, nFetchRes )
.head 8 -  ! Нет групп контроля
.head 8 +  If nTmp=0
.head 9 -  ! If SalMessageBox( 'Плановая операция не имеет групп визирования!
Продолжить?', 'Ошибка', MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 9 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrOperPlan') || PutCrLf() ||
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgDone'),
  CurrentLangTable.GetAtomTitle('cTErr'), MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 10 -  Return FALSE
.head 7 -  Call SqlClose( hMainSql )
.head 5 -  ! Проверка видов документа для вводимой операции
.head 5 -  Set nTmp=0
.head 5 +  If SqlPrepareAndExecute( hMainSql, 'SELECT value INTO :nTmp FROM tts_flags WHERE tt=:strOperId and fcode=0' )
.head 6 -  Call SqlFetchNext( hMainSql, nFetchRes )
.head 6 -  Call SqlClose( hMainSql )
.head 6 -  ! Операция для ввода
.head 6 +  If (nFetchRes=FETCH_Ok) AND (nTmp=1)
.head 7 -  Set nTmp=0
.head 7 +  If SqlPrepareAndExecute( hMainSql, 'SELECT count(*) INTO :nTmp FROM tts_vob WHERE tt=:strOperId' )
.head 8 -  Call SqlFetchNext( hMainSql, nFetchRes )
.head 8 -  ! Нет видов документов
.head 8 +  If nTmp=0
.head 9 -  ! If SalMessageBox( 'Операция для ввода не имеет связанного вида документа!
Продолжить?','Ошибка', MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 9 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrOperTt') || PutCrLf() ||
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgDone'),
  CurrentLangTable.GetAtomTitle('cTErr'), MB_YesNo | MB_IconAsterisk ) !=IDYES
.head 10 -  Return FALSE
.head 7 -  Call SqlClose( hMainSql )
.head 5 -  ! Сохранение в Лог
.head 5 +  If fModified
.head 6 -  Set frm_OperList.fSaved=FALSE
.head 6 -  ! Call SaveInfoToLog( sFuncName || ' : Операция ' || strOperId || ' была изменена' )
.head 6 -  Call SaveInfoToLog( sFuncName || ' : ' || 
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTToLogOper') || ' ' || strOperId || ' ' || 
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTToLogUpdate') )
.head 5 -  ! Call SaveInfoToLog( sFuncName || ' : Закончено редактирование операции ' || strOperId )
.head 5 -  Call SaveInfoToLog( sFuncName || ' : ' || 
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTToLogEndEdit') || ' ' || strOperId )
.head 3 -  ! Saving changes
.head 3 +  On SAM_Destroy
.head 4 +  If bInited
.head 5 -  Set nPrevTab=picTabs.GetTop()
.head 5 -  Call picTabs.BringToTop( 0, TRUE )
.head 5 -  ! Меняем Таб на первый
.head 5 +  If Option != 9 
.head 6 -  ! Сохраняем содержимое первого Таба
.head 6 -  ! Проверка на сложность
.head 6 -  Set nChildCount=0
.head 6 -  Set strSql='SELECT COUNT(*) INTO :nChildCount FROM ttsap WHERE tt=:strOperId'
.head 6 -  If SqlPrepareAndExecute( hMainSql, strSql )
.head 6 -  Call SqlFetchNext( hMainSql, nFetchRes )
.head 6 -  Call SqlClose( hMainSql )
.head 6 +  If nChildCount>0
.head 7 -  Set nComplex=1
.head 6 +  Else
.head 7 -  Set nComplex=0
.head 6 -  ! Мультивалютность
.head 6 +  If cbMulti
.head 7 -  Set nMulti=1
.head 6 +  Else
.head 7 -  Set nMulti=0
.head 6 -  ! Сохранение
.head 6 -  Set strSql= "UPDATE tts SET 
dk =:nDebitCredit, nlsm=:dfAccA, kv=:dfKvA, nlsk=:dfAccB, kvk=:dfKvB, flc=:nComplex,
fli=:nFli, flv=:nMulti, nlsa =:dfBankA, nlsb=:dfBankB, mfob=:dfMfoB, s=:dfSum,
s2 =:dfSum2,sk=:dfSKP , s3800=:dfAccVP, s6201=:nS62  , s7201=:nS72 ,
rang=:dfPriority, nazn=:dfNAZN 
WHERE tt=:strOperId"
.head 6 -  Call SqlPrepareAndExecute( hMainSql, strSql )
.head 6 -  Call SqlClose( hMainSql )
.head 6 -  Set bInited=FALSE
.head 4 +  If Option != 9 
.head 5 -  Call SaveToReg()
.head 4 -  Call SalSetFocus( SalParentWindow( hWndForm ) )
.head 1 +  Dialog Box: dlg_PickList
.head 2 -  Class: cGenericTableDlg
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   2.663"
.head 4 -  Top:    2.167"
.head 4 -  Width:  9.583"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.905"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.083"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.517"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.95"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.467"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 21247
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  1.3"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  1.3"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 13
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.75"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.18"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 21248
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  1.3"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  1.3"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbOk
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.983"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.417"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 21249
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  4.3"
.head 6 -  Begin Y:  0.417"
.head 6 -  End X:  4.3"
.head 6 -  End Y:  0.0"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableDlg
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   -0.017"
.head 6 -  Top:    0.0"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 20000
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.083"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  7.567"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: strSelelection
.head 3 -  String: strHeader
.head 3 -  String: strFilterTable
.head 3 -  Receive String: strIdentifier
.head 3 -  Receive String: strSemantic
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 -  ! Население при показе
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( dlg_PickList )
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalHideWindow( pbIns )
.head 4 -  Call SalHideWindow( pbDel )
.head 4 -  Call SalHideWindow( pbRefresh )
.head 4 -  Call SalHideWindow( pbUpdate )
.head 4 -  Call SalHideWindow( pbOk )
.head 4 -  Call SalHideWindow( pbExit )
.head 4 -  Call SalSetWindowText( dlg_PickList, strHeader )
.head 4 -  Set strSqlPopulate=strSelelection
.head 4 -  Set strFilterTblName=strFilterTable
.head 4 -  Call SalSendClassMessage( UM_Create, 0, 0 )
.head 3 -  ! Выбор из списка
.head 3 +  On UM_DoubleClick
.head 4 -  Set strIdentifier=tbl.colID
.head 4 -  Set strSemantic=tbl.colName
.head 4 -  Call SalEndDialog( dlg_PickList, 1 )
.head 1 +  Dialog Box: dlg_ImpOptions
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Параметры импорта операций
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   4.075"
.head 4 -  Top:    1.688"
.head 4 -  Width:  5.25"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 1.429"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: 8
.head 3 -  Font Enhancement: Bold
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Опции импорта операции
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Check Box: cbDel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Удалять имеющиеся операции
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.155"
.head 5 -  Width:  4.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDisableWindow( cbOverwrite )
.head 6 +  If cbDel
.head 7 -  Set A01=1
.head 6 +  Else
.head 7 -  Set A01=0
.head 3 +  Check Box: cbOverwrite
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Переписывать имеющиеся операции
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.405"
.head 5 -  Width:  4.9"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDisableWindow( cbDel )
.head 6 +  If cbOverwrite
.head 7 -  Set A02=2
.head 6 +  Else
.head 7 -  Set A02=0
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Начать
.head 4 -  Window Location and Size
.head 5 -  Left:   0.783"
.head 5 -  Top:    0.738"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If cbDel
.head 7 -  Call SalEndDialog( dlg_ImpOptions, A01 | A03 )
.head 6 +  Else If cbOverwrite
.head 7 -  Call SalEndDialog( dlg_ImpOptions, A02 )
.head 6 +  Else
.head 7 -  Call SalEndDialog( dlg_ImpOptions, A01 | A02 | A03 )
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отмена
.head 4 -  Window Location and Size
.head 5 -  Left:   3.183"
.head 5 -  Top:    0.738"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( dlg_ImpOptions, -1 )
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: A01
.head 3 -  Number: A02
.head 3 -  Number: A03
.head 2 -  Message Actions
.head 1 +  Dialog Box: dlg_OperExpOpts
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Параметры экспорта операции
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.4"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Файл
.head 4 -  Resource Id: 24687
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    0.25"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgFileName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfFileName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.3"
.head 6 -  Top:    0.2"
.head 6 -  Width:  7.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Check Box: cbAll
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Все
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    0.65"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If cbAll
.head 7 -  Set cbErr = TRUE
.head 7 -  Set cbT00 = TRUE
.head 7 -  ! Set cbFlag = TRUE
.head 7 -  Set cbRelated = TRUE
.head 7 -  Set cbBal = TRUE
.head 7 -  Set cbDRec = TRUE
.head 7 -  Set cbVob = TRUE
.head 7 -  Set cbChk = TRUE
.head 7 -  Set cbFolder = TRUE
.head 7 -  Call SalEnableWindow(cbInsDRec)
.head 7 -  Call SalEnableWindow(cbInsVob)
.head 7 -  Call SalEnableWindow(cbInsChk)
.head 7 -  Call SalEnableWindow(cbInsFolder)
.head 3 +  Check Box: cbErr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выводить сообщения об ошибках
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    1.05"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If not cbErr
.head 7 -  Set cbAll = FALSE
.head 3 +  Check Box: cbT00
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Подбирать T00
.head 4 -  Window Location and Size
.head 5 -  Left:   0.417"
.head 5 -  Top:    1.45"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If not cbT00
.head 7 -  Set cbAll = FALSE
.head 3 +  ! cCheckBoxLabeled: cbFlag
.winattr class Check Box:
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: С флагами
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    1.071"
.head 5 -  Width:  6.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 4 +     Message Actions 
.head 5 +     On SAM_Click
.head 6 +     If not cbFlag
.head 7 -     Set cbAll=FALSE
.head 3 +  Check Box: cbRelated
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Со связанными операциями
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    1.85"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If not cbRelated
.head 7 -  Set cbAll = FALSE
.head 3 +  Check Box: cbBal
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: С допустимыми бал. счетами
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    2.25"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If not cbBal
.head 7 -  Set cbAll = FALSE
.head 3 +  Check Box: cbDRec
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: С доп. реквизитами
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    2.65"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If not cbDRec
.head 7 -  Set cbAll = FALSE
.head 7 -  Set cbInsDRec = FALSE
.head 7 -  Call SalDisableWindow(cbInsDRec)
.head 6 +  Else
.head 7 -  Call SalEnableWindow(cbInsDRec)
.head 3 +  Check Box: cbVob
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: С видами документов
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    3.05"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If not cbVob
.head 7 -  Set cbAll = FALSE
.head 7 -  Set cbInsVob = FALSE
.head 7 -  Call SalDisableWindow(cbInsVob)
.head 6 +  Else
.head 7 -  Call SalEnableWindow(cbInsVob)
.head 3 +  Check Box: cbChk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: С группами визирования
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    3.45"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If not cbChk
.head 7 -  Set cbAll = FALSE
.head 7 -  Set cbInsChk = FALSE
.head 7 -  Call SalDisableWindow(cbInsChk)
.head 6 +  Else
.head 7 -  Call SalEnableWindow(cbInsChk)
.head 3 +  Check Box: cbFolder
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: С папками
.head 4 -  Window Location and Size
.head 5 -  Left:   0.4"
.head 5 -  Top:    3.85"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If not cbFolder
.head 7 -  Set cbAll = FALSE
.head 7 -  Set cbInsFolder = FALSE
.head 7 -  Call SalDisableWindow(cbInsFolder)
.head 6 +  Else
.head 7 -  Call SalEnableWindow(cbInsFolder)
.head 3 +  Check Box: cbInsDRec
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Добавлять в базовый справочник
.head 4 -  Window Location and Size
.head 5 -  Left:   4.5"
.head 5 -  Top:    2.65"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbInsVob
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Добавлять в базовый справочник
.head 4 -  Window Location and Size
.head 5 -  Left:   4.5"
.head 5 -  Top:    3.05"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbInsChk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Добавлять в базовый справочник
.head 4 -  Window Location and Size
.head 5 -  Left:   4.5"
.head 5 -  Top:    3.45"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbInsFolder
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Добавлять в базовый справочник
.head 4 -  Window Location and Size
.head 5 -  Left:   4.5"
.head 5 -  Top:    3.85"
.head 5 -  Width:  4.0"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Экспорт
.head 4 -  Window Location and Size
.head 5 -  Left:   5.8"
.head 5 -  Top:    4.4"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\APPLY.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set strFileName = dfFileName
.head 6 -  Set nOptions = 0
.head 6 -  Set nFlIns   = 0
.head 6 +  If cbAll
.head 7 -  Set nOptions = 2047
.head 6 +  Else
.head 7 +  ! Расшифровка кодов
.head 8 -  ! 1 - Выдавать сообщения о несуществующих счетах или валютах
! 2 - Подменять T00
! 4 - Флаги
! 8 - Доп. реквизиты
! 16 - Включать связанные операции
! 32 - Бал. счета
! 64 - Группы контроля
! 128 - Виды документов
! 256 - Распределение по папкам
! 512 - Резерв
! 1024 - Резерв
! 2047 - Все! 
.head 7 +  If cbErr
.head 8 -  Set nOptions=nOptions | 1
.head 7 +  If cbT00
.head 8 -  Set nOptions=nOptions | 2
.head 7 +  ! If cbFlag
.head 8 -     Set nOptions=nOptions | 4
.head 7 +  If cbDRec
.head 8 -  Set nOptions=nOptions | 8
.head 7 +  If cbRelated
.head 8 -  Set nOptions=nOptions | 16
.head 7 +  If cbBal
.head 8 -  Set nOptions=nOptions | 32
.head 7 +  If cbVob
.head 8 -  Set nOptions=nOptions | 128
.head 7 +  If cbChk
.head 8 -  Set nOptions=nOptions | 64
.head 7 +  If cbFolder
.head 8 -  Set nOptions=nOptions | 256
.head 6 +  If cbInsDRec
.head 7 -  Set nFlIns = nFlIns | 8
.head 6 +  If cbInsVob
.head 7 -  Set nFlIns = nFlIns | 128
.head 6 +  If cbInsChk
.head 7 -  Set nFlIns = nFlIns | 64
.head 6 +  If cbInsFolder
.head 7 -  Set nFlIns = nFlIns | 256
.head 6 -  Call SalEndDialog(hWndForm, 1)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отменить
.head 4 -  Window Location and Size
.head 5 -  Left:   7.25"
.head 5 -  Top:    4.4"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set strFileName = ''
.head 6 -  Set nOptions = 0
.head 6 -  Call SalEndDialog(hWndForm, 0)
.head 3 -  Frame
.head 4 -  Resource Id: 34187
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    0.1"
.head 5 -  Width:  8.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 4.1"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 34188
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    0.55"
.head 5 -  Width:  8.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.4"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 34189
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    1.35"
.head 5 -  Width:  8.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.4"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 34191
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    2.15"
.head 5 -  Width:  8.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.4"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 34190
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    2.95"
.head 5 -  Width:  8.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.4"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 34193
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    3.8"
.head 5 -  Width:  8.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.4"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 34192
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.15"
.head 5 -  Top:    4.3"
.head 5 -  Width:  8.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.7"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Receive String: strFileName
.head 3 -  Receive Number: nOptions
.head 3 -  Receive Number: nFlIns
.head 3 -  String: sTT
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_OperExpOpts.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalSetWindowText(cbInsDRec,   CurrentLangTable.GetAtomTitle('dlg_OperExpOpts.cbIns'))
.head 4 -  Call SalSetWindowText(cbInsVob,    CurrentLangTable.GetAtomTitle('dlg_OperExpOpts.cbIns'))
.head 4 -  Call SalSetWindowText(cbInsChk,    CurrentLangTable.GetAtomTitle('dlg_OperExpOpts.cbIns'))
.head 4 -  Call SalSetWindowText(cbInsFolder, CurrentLangTable.GetAtomTitle('dlg_OperExpOpts.cbIns'))
.head 4 -  !
.head 4 -  ! Call Debug(sTT)
.head 4 -  !
.head 4 +  If (At(Left(sTT, 1),    '\\/:*?"<>|.,;~`'||Chr(39)) = 0 or Left(sTT, 1)    = '%' or Left(sTT, 1)    = '_') and
   (At(Subs(sTT, 2, 1), '\\/:*?"<>|.,;~`'||Chr(39)) = 0 or Subs(sTT, 2, 1) = '%' or Subs(sTT, 2, 1) = '_') and
   (At(Right(sTT, 1),   '\\/:*?"<>|.,;~`'||Chr(39)) = 0 or Right(sTT, 1)   = '%' or Right(sTT, 1)   = '_')
.head 5 -  Set dfFileName = GetPrnDir() || '\\et_' || sTT || '.SQL'
.head 4 +  Else
.head 5 -  Set dfFileName = GetPrnDir() || '\\et' || SalFmtFormatDateTime(SalDateCurrent(), 'hhmmss') || '.SQL'
.head 4 -  Set cbAll = TRUE
.head 4 -  Call SalSendMsg(cbAll, SAM_Click, 0, 0)
.head 1 -  !
.head 1 -  ! Редактирование запросов
.head 1 +  Table Window: frm_QueryEditor
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Редактирование каталогизированных запросов
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Maximized
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.575"
.head 4 -  Top:    1.094"
.head 4 -  Width:  17.267"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 8.667"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Bold
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 10000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 +  Named Menus
.head 3 +  Menu: menu_ExportOption
.head 4 -  Resource Id: 63632
.head 4 -  Title:
.head 4 -  Description:
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: Экспорт всех выделенных запросов
.head 5 -  Resource Id: 63634
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call ExportSelectedQueries(FALSE)
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Экспорт всех выделенных запросов в один файл
.head 5 -  Resource Id: 55525
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call ExportSelectedQueries(TRUE)
.head 5 -  Menu Item Name:
.head 3 +  Menu: menu_EditReport
.head 4 -  Resource Id: 54839
.head 4 -  Title: Добавление кат. запроса в разные места (отчет, функция, старт дня, расписание)
.head 4 -  Description:
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: Додати до друкованих звітів
.head 5 -  Resource Id: 54836
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call SalSendMsg( pbEditReport, SAM_Click, 0, 0 )
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Додати у вигляді функції
.head 5 -  Resource Id: 54838
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Call addReportToOperList()
.head 5 -  Menu Item Name:
.head 4 +  ! Menu Item: Додати до виконання за розкладом
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text: 
.head 5 +  Menu Settings 
.head 6 -  Enabled when: 
.head 6 -  Checked when: 
.head 5 +  Menu Actions 
.head 6 -  Call ExportSelectedQueries(TRUE)
.head 5 -  Menu Item Name: 
.head 3 +  Menu: menu_InsertOption
.head 4 -  Resource Id: 63635
.head 4 -  Title:
.head 4 -  Description:
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: Добавить связанный запрос к выбранному
.head 5 -  Resource Id: 63636
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 +  If NOT SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 7 -  ! Call SalMessageBox( 'Ни один запрос не выбран!', 'Ошибка', MB_IconStop | MB_Ok )
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgNotSelect'),
  CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
.head 7 -  Return FALSE
.head 6 -  Set nMainKod = frm_QueryEditor.colKODZ
.head 6 -  Set sMainPkey = frm_QueryEditor.colPKey
.head 6 -  Call SalSendMsg(pbIns, SAM_Click, 1, 0)
.head 6 -  Set nRefKod = frm_QueryEditor.colKODZ
.head 6 +  If not SqlPrepareAndExecute(hSql(), "update zapros set kodr=:nRefKod where kodz=:nMainKod")
.head 7 -  Call SalMessageBox('Невозможно обновить код связанного запроса',
  CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop )
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Добавить копию выбранного запроса
.head 5 -  Resource Id: 63637
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  Set i=0
.head 6 -  !
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 7 -  Set i=i+1
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 +  If i >1 
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgMultSel'),
  CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
.head 7 -  Return FALSE
.head 6 -  ! Проверим, дочерний ли это запрос
.head 6 +  ! If SqlPrepareAndExecute(hSql(), "SELECT kodr FROM zapros WHERE kodr=:frm_QueryEditor.colKODZ")
.head 7 -   If SqlFetchNext(hSql(),nTmp)
.head 6 +  If IsThisReferencedKod(frm_QueryEditor.colKODZ)
.head 7 -  ! Call SalMessageBox('Выбран связанный запрос','Внимание',0)
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgSelRef'), CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 7 -  Return FALSE
.head 6 -  !
.head 6 -  Call SalSendMsg(pbIns,SAM_Click,2,nRow)
.head 5 -  Menu Item Name:
.head 3 +  Menu: menu_VSSWork
.head 4 -  Resource Id: 33512
.head 4 -  Title:
.head 4 -  Description: Работа с VSS
.head 4 -  Enabled when:
.head 4 -  Status Text:
.head 4 -  Menu Item Name:
.head 4 +  Menu Item: Добавить запрос в  VSS
.head 5 -  Resource Id: 33515
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: VSSAlreadyExist!=1
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  !
.head 6 -  ! If CheckForCorrectSelection()=TRUE 
.head 6 -  Call VSSWork(VSS_ADD,frm_QueryEditor.colPKey)
.head 6 -  !
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Блокировать на редактирование(checkout)
.head 5 -  Resource Id: 33516
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when: VSSAlreadyChecked!=1
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  !
.head 6 -  ! If CheckForCorrectSelection()=TRUE
.head 6 -  Call VSSWork(VSS_CHECKOUT,frm_QueryEditor.colPKey)
.head 6 -  Call SalSendMsg(pbRefresh,SAM_Click, 0,0 )
.head 5 -  Menu Item Name:
.head 4 +  Menu Item: Разблокировать(checkin)
.head 5 -  Resource Id: 33514
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Status Text:
.head 5 +  Menu Settings
.head 6 -  Enabled when:
.head 6 -  Checked when:
.head 5 +  Menu Actions
.head 6 -  ! If CheckForCorrectSelection()=TRUE
.head 6 -  Call VSSWork(VSS_CHECKIN,frm_QueryEditor.colPKey)
.head 6 -  Call SalSendMsg(pbRefresh,SAM_Click, 0,0 )
.head 5 -  Menu Item Name:
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.452"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendClassMessage( SAM_Click, wParam, lParam)
.head 7 -  !
.head 7 -  ! Добавление связанного
.head 7 +  If wParam = 1
.head 8 -  Set sZaprosPkey = sMainPkey||'\\1'
.head 7 -  !
.head 7 -  ! Добавление копии или добавление копии связаннного 
.head 7 +  If wParam = 2 OR wParam = 3 
.head 8 -  ! номер строки которую копируем
.head 8 -  Set nCopiedRow = lParam
.head 8 -  Set nRow = TBL_MinRow 
.head 8 -  Set i=0
.head 8 +  While SalTblFindNextRow(hWndForm, nRow, ROW_New, 0)
.head 9 -  Set i=i+1
.head 9 +  If wParam = 2
.head 10 -  Set nNewRow=nRow
.head 9 +  If wParam = 3 AND i=2
.head 10 -  Set nNewRow=nRow
.head 8 -  !
.head 8 -  !
.head 8 -  Call SalTblSetContext(hWndForm,nCopiedRow)
.head 8 -  Set sZaprosFields[0]= SalNumberToStrX(colKODZ,0)
.head 8 -  Set sZaprosFields[1]= colNAME
.head 8 -  Set sZaprosFields[2]= colNAMEF
.head 8 -  Set sZaprosFields[3]= colRPT_TEMPLATE
.head 8 -  Set sZaprosFields[4]= colDEFAULT_VARS
.head 8 -  Set sZaprosFields[5]= colCREATE_STMT
.head 8 -  Set sZaprosFields[6]= colFORM_PROC
.head 8 -  Set sZaprosFields[7]= SalNumberToStrX(colKODR,0)
.head 8 -  Set sZaprosFields[8]= colBIND_SQL
.head 8 -  Set sZaprosFields[9]= colBINDVARS
.head 8 -  !
.head 8 -  Call SalTblSetContext(hWndForm, nNewRow)
.head 8 -  Set colNAME = sZaprosFields[1]
.head 8 -  Set colNAMEF= sZaprosFields[2]
.head 8 -  Set colRPT_TEMPLATE = sZaprosFields[3]
.head 8 -  Set colDEFAULT_VARS = sZaprosFields[4]
.head 8 -  Set colCREATE_STMT  = sZaprosFields[5]
.head 8 -  Set colFORM_PROC    = sZaprosFields[6] 
.head 8 -  ! Set colKODR         = SalStrToNumber(sZaprosFields[7])
.head 8 -  Set colBIND_SQL     = sZaprosFields[8] 
.head 8 -  Set colBINDVARS     = sZaprosFields[9]
.head 8 -  !
.head 8 -  Set lsTmp =  GetStringFromClob(hSql(), 'zapros', 'kodz', 'txt', SalStrToNumber(sZaprosFields[0]), '', '')
.head 8 -  Set colTXT = lsTmp
.head 8 -  Set colSELECT = Subs(colTXT, 1, 6)
.head 8 -  Set colFlEditTXT = 1
.head 8 -  !
.head 8 -  ! Есть дочерний запрос
.head 8 +  If SalStrLength(sZaprosFields[7])>0
.head 9 -  Set nRefKod = SalStrToNumber(sZaprosFields[7])
.head 9 -  ! Установим сначала ключ для главного
.head 9 +  If Option =EDIT_MODE_BARS
.head 10 -  Set sZaprosPkey='\\BRS\\***\\***\\'
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsEditPK'),
  CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok)
.head 9 +  Else
.head 10 -  Set sZaprosPkey=GenerateNewBankPkey()
.head 9 -  Set frm_QueryEditor.colPKey = sZaprosPkey
.head 9 -  !
.head 9 -  ! Найдем связанній в таблице
.head 9 -  Set nRow = TBL_MinRow 
.head 9 +  While SalTblFindNextRow(hWndForm, nRow, 0, 0)
.head 10 -  Call SalTblSetContext(hWndForm, nRow)
.head 10 +  If colKODZ =nRefKod
.head 11 -  Call SalSendMsg(pbIns,SAM_Click,3,nRow) 
.head 11 -  Return TRUE
.head 7 -  !
.head 7 -  ! Добавление нового
.head 7 -  If wParam = 0
.head 7 -  !
.head 7 -  !
.head 7 +  If wParam=3
.head 8 -  Set sZaprosPkey=sZaprosPkey||'\\1'
.head 7 +  Else
.head 8 +  If Option = EDIT_MODE_BARS
.head 9 -  Set sZaprosPkey=GenerateNewBarsPkey()
.head 8 +  Else
.head 9 -  Set sZaprosPkey=GenerateNewBankPkey()
.head 8 +  If sZaprosPkey != STRING_Null
.head 9 -  Set frm_QueryEditor.colPKey = sZaprosPkey
.head 8 +  Else
.head 9 -  Call SalSendMsg(pbRefresh, SAM_Click, 0,0)
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.917"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.35"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click 
.head 7 +  If Option = EDIT_MODE_BARS and bVSSuse
.head 8 -  Call VSSWork(VSS_SHOW_USERCHECKED, '')
.head 7 -  Call SalSendClassMessage(SAM_Click,wParam,lParam)
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.783"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  ! разработчики БАРС  и поле ключа пустое
.head 7 +  If Option=EDIT_MODE_BARS and frm_QueryEditor.colPKey = STRING_Null
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgNoPkey'),
  CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
.head 7 +  Else
.head 8 -  ! Если банк обновлял БАРС-овский отчет - тогда оставить барсовский
! отчет неизменным, а изменения сохранить в собственный отчет
.head 8 +  ! If Option!=3
.head 9 +   If SalStrLeftX(frm_QueryEditor.colPKey, 4)='\\BRS'
.head 10 -   Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgBrsEdit'),
  CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok)
.head 10 -   Call MakeZaprosCopy(SalTblQueryContext ( frm_QueryEditor ))
.head 10 -  !
.head 10 -  !
.head 7 -  Call SalSendClassMessage( SAM_Click, wParam, lParam)
.head 4 -  Line
.head 5 -  Resource Id: 63638
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  11.05"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  11.05"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  Line
.head 5 -  Resource Id: 63639
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  6.883"
.head 6 -  Begin Y:  0.012"
.head 6 -  End X:  6.883"
.head 6 -  End Y:  0.476"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Line
.head 5 -  Resource Id: 63640
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  8.05"
.head 6 -  Begin Y:  -0.048"
.head 6 -  End X:  8.05"
.head 6 -  End Y:  0.417"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.65"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.083"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails_old
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.217"
.head 6 -  Top:    0.738"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\OPEN.BMP
.head 5 -  Picture Transparent Color: Green
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Light Green
.head 5 +  Message Actions
.head 6 +  ! On SAM_Create
.head 7 -  ! Set strTip='Выполнить запрос'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_QueryEditor.cBTipDetails')
.head 6 +  ! On SAM_Click
.head 7 -  Call ZAPROS1(hWndMDI, colKODZ)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.95"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 63641
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  4.483"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  4.483"
.head 6 -  End Y:  0.452"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   11.117"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 63642
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  2.5"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  2.5"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Option Button: obShowSQL
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.683"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\SQL.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Button Style: Check
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! 'Показать/Спрятать тело SQL'
.head 7 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_QueryEditor.cBTipShowSQL'))
.head 6 +  ! On SAM_Click
.head 7 +     If obShowSQL
.head 8 -     Call SalShowWindow(frm_QueryEditor.colTXT)
.head 7 +     Else
.head 8 -     Call SalHideWindow(frm_QueryEditor.colTXT)
.head 6 +  On SAM_Click
.head 7 +  If obShowSQL
.head 8 -  Call SalShowWindow(frm_QueryEditor.colSELECT)
.head 7 +  Else
.head 8 -  Call SalHideWindow(frm_QueryEditor.colSELECT)
.head 4 +  Option Button: obShowBinds
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.08"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\LINKED.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Button Style: Check
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! 'Показать/Спрятать Binds-переменные'
.head 7 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_QueryEditor.cBTipShowBinds'))
.head 6 +  On SAM_Click
.head 7 +  If obShowBinds
.head 8 -  Call SalShowWindow(frm_QueryEditor.colBINDVARS)
.head 7 +  Else
.head 8 -  Call SalHideWindow(frm_QueryEditor.colBINDVARS)
.head 4 +  Option Button: obShowParams
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Attach.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Button Style: Check
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! 'Показать/Спрятать Умолч.значения Binds-переменных'
.head 7 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_QueryEditor.cBTipShowParams'))
.head 6 +  On SAM_Click
.head 7 +  If obShowParams
.head 8 -  Call SalShowWindow(frm_QueryEditor.colDEFAULT_VARS)
.head 7 +  Else
.head 8 -  Call SalHideWindow(frm_QueryEditor.colDEFAULT_VARS)
.head 4 +  Option Button: obShowCreate
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.883"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\CREATE.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Button Style: Check
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! 'Показать/Спрятать выражение для DBF'
.head 7 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_QueryEditor.cBTipShowCreate'))
.head 6 +  On SAM_Click
.head 7 +  If obShowCreate
.head 8 -  Call SalShowWindow(frm_QueryEditor.colCREATE_STMT)
.head 7 +  Else
.head 8 -  Call SalHideWindow(frm_QueryEditor.colCREATE_STMT)
.head 4 +  Option Button: obShowCreator
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\CUSTCLSD.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Button Style: Check
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! 'Показать/Спрятать автора запроса'
.head 7 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_QueryEditor.cBTipShowCreator'))
.head 6 +  On SAM_Click
.head 7 +  If obShowCreator
.head 8 -  Call SalShowWindow(frm_QueryEditor.colCREATOR)
.head 7 +  Else
.head 8 -  Call SalHideWindow(frm_QueryEditor.colCREATOR)
.head 4 +  Pushbutton: pbCopy
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.05"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\COPY.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! 'Копировать запрос в буфер'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_QueryEditor.cBTipCopy')
.head 6 +  On SAM_Click
.head 7 +  If SalTblQueryRowFlags(frm_QueryEditor, SalTblQueryContext(frm_QueryEditor), ROW_Selected)
.head 8 -  ! Set bufID = colID
.head 8 -  ! Set bufUSER_NAME = colNAME
.head 8 -  Set bufNAME = colNAME
.head 8 -  Set bufNAMEF = colNAMEF
.head 8 -  ! Set bufTXT = colTXT
.head 8 -  Set bufTXT = IifS(colTXT!='', colTXT, GetStringFromClob(hSql(), 'zapros', 'kodz', 'txt', colKODZ, '', ''))
.head 8 -  Set bufBINDVARS = colBINDVARS
.head 8 -  Set bufCREATE_STMT = colCREATE_STMT
.head 8 -  Set bufRPT_TEMPLATE = colRPT_TEMPLATE
.head 8 -  Set bufDEFAULT_VARS = colDEFAULT_VARS
.head 8 -  Set bufFORM_PROC = colFORM_PROC
.head 8 -  Set bufKODR = colKODR
.head 8 -  Call SalEnableWindow(pbPaste)
.head 7 +  Else
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgNotSelect'),
     CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 4 +  Pushbutton: pbPaste
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.483"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\PASTE.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! 'Вставить/Заменить запрос(из буфера)'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_QueryEditor.cBTipPaste')
.head 6 +  On SAM_Click
.head 7 +  If SalTblQueryRowFlags(frm_QueryEditor, SalTblQueryContext(frm_QueryEditor), ROW_Selected)
.head 8 -  Set colNAME = bufNAME
.head 8 -  Set colNAMEF = bufNAMEF
.head 8 -  Set colTXT = bufTXT
.head 8 -  Set colSELECT = Subs(colTXT,1,6)
.head 8 -  Set colBINDVARS = bufBINDVARS
.head 8 -  Set colCREATE_STMT = bufCREATE_STMT
.head 8 -  Set colRPT_TEMPLATE = bufRPT_TEMPLATE
.head 8 -  Set colDEFAULT_VARS = bufDEFAULT_VARS
.head 8 -  Set colFORM_PROC = bufFORM_PROC
.head 8 -  Set colKODR = bufKODR
.head 8 +  If colTXT
.head 9 -  Set colFlEditTXT = 1
.head 8 -  Call SalEnableWindow(pbPaste)
.head 8 -  Call SalTblSetRowFlags(frm_QueryEditor, SalTblQueryContext(frm_QueryEditor), ROW_Edited, TRUE)
.head 7 +  Else
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgNotSelect'),
     CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 4 +  Pushbutton: pbEditTemplate
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.2"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Edit.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! 'Редактирование шаблона отчета'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_QueryEditor.cBTipEditTemplate')
.head 6 +  On SAM_Click
.head 7 +  If SalTblQueryRowFlags(frm_QueryEditor, SalTblQueryContext(frm_QueryEditor), ROW_Selected)
.head 8 -  Call SalLoadApp('REPBI11.EXE', GetTemplateDir() || '\\' || colRPT_TEMPLATE)
.head 7 +  Else
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgNotSelect'),
     CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 4 +  Pushbutton: pbExportQuery
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   8.667"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\SAVED.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! 'Экспорт каталогизированного запроса'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_QueryEditor.cBTipExportQuery')
.head 6 +  On SAM_Click
.head 7 -  ! Экспорт индивидуальных отчетов
.head 7 -  ! Проверим, дочерний ли это запрос
.head 7 +  If SalTblQueryRowFlags(frm_QueryEditor, SalTblQueryContext(frm_QueryEditor), ROW_Selected)
.head 8 +  If IsThisReferencedKod(frm_QueryEditor.colKODZ)
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgSelectMain'),
     CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 9 -  Return -1
.head 8 -  ! Если не указана четкая директория выгрузки (например для добавления в VSS)
.head 8 +  If SalModalDialog(dlg_ExpQuery, hWndForm, frm_QueryEditor.colKODZ, frm_QueryEditor.colPKey,
   frm_QueryEditor.colNAME, frm_QueryEditor.colKODR, STRING_Null)
.head 9 -  Call SalMessageBox('Отчет выгружен в SQL сценарий', CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 7 +  Else
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgNotSelect'),
     CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 4 +  Pushbutton: pbExportQueryEx
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cpbAttachedButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.32"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call pbExportQueryEx.AttachButton(pbExportQuery, 'menu_ExportOption', PBA_MenuRollDown)
.head 4 +  Pushbutton: pbEitReportEx
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cpbAttachedButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.083"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.32"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call pbEitReportEx.AttachButton(pbEditReport, 'menu_EditReport', PBA_MenuRollDown)
.head 4 +  Pushbutton: pbInsEx
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cpbAttachedButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.5"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.2"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.32"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call pbInsEx.AttachButton(pbIns, 'menu_InsertOption', PBA_MenuRollDown)
.head 4 +  Pushbutton: pbEditReport
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.433"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\RETRIEVE.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! 'Добавить в <<Печатные отчеты>>'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_QueryEditor.cBTipEditReport')
.head 6 +  On SAM_Click
.head 7 +  If SalTblQueryRowFlags(frm_QueryEditor, SalTblQueryContext(frm_QueryEditor), ROW_Selected)
.head 8 -  ! Проверим, дочерний ли это запрос
.head 8 +  If IsThisReferencedKod(frm_QueryEditor.colKODZ)
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgSelectMain'),
     CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 9 -  Return -1
.head 8 -  ! Если нету шаблона
.head 8 -  Set nTmp = 0
.head 8 +  If colRPT_TEMPLATE = STRING_Null
.head 9 -  ! Если сущест. связанный, возможно у него описан формат выгрузки
.head 9 -  Set sChildQrp = STRING_Null
.head 9 +  If frm_QueryEditor.colKODR
.head 10 -  ! Call Debug('Есть связанный !')
.head 10 +  If SqlPrepareAndExecute(hSql(), "
   SELECT CREATE_STMT,RPT_TEMPLATE
   INTO   :lsChildCrStmt,:sChildQrp
   FROM zapros
   WHERE kodz=:frm_QueryEditor.colKODR")
.head 11 +  If not SqlFetchNext(hSql(), nTmp)
.head 12 -  ! Call SalMessageBox('Невозможно найти описание связанного запроса', 'Внимание', 0)
.head 12 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgNotFound'),
     CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 12 -  Return -1
.head 10 +  If sChildQrp
.head 11 -  ! Call Debug('QRP - cвязанн!')
.head 11 -  Set nTmp = 3
.head 9 +  Else
.head 10 -  ! Call Debug('Cвязанного нету!')
.head 10 -  Set sChildQrp = colRPT_TEMPLATE
.head 9 -  ! Если есть описание форматированого текста
.head 9 -  ! Call Debug('lsChildCrStmt=' || lsChildCrStmt ||' sChildQrp=' || sChildQrp)
.head 9 +  If nTmp = 0
.head 10 +  If SalStrScan(lsChildCrStmt, 'Delim') >= 0
.head 11 -  ! Call Debug('Delim exists')
.head 11 -  Set nTmp = 7
.head 10 -  ! Если нету - скорее этоо DBF файл
.head 10 +  Else
.head 11 -  ! Call Debug('DBF existts')
.head 11 -  Set nTmp = 1
.head 8 +  Else
.head 9 -  Set nTmp = 3
.head 8 -  ! Call Debug(SalNumberToStrX(nTmp, 0))
.head 8 -  Call SalModalDialog(dlg_AddReport, hWndForm, frm_QueryEditor.colNAME, frm_QueryEditor.colKODZ,
     frm_QueryEditor.colNAMEF, frm_QueryEditor.colBINDVARS,nTmp)
.head 7 +  Else
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgNotSelect'),
     CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 4 +  Multiline Field: ml1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 60000
.head 6 -  String Type: Long String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Border? Yes
.head 6 -  Word Wrap? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Window Location and Size
.head 7 -  Left:   Default
.head 7 -  Top:    Default
.head 7 -  Width:  Default
.head 7 -  Width Editable? Yes
.head 7 -  Height: Default
.head 7 -  Height Editable? Yes
.head 6 -  Visible? No
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbImportXSL
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: XSL
.head 5 -  Window Location and Size
.head 6 -  Left:   10.083"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.313"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Red
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! 'Импорт XSL-выражения для отчета'
.head 7 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_QueryEditor.cBTipImportXSL'))
.head 6 +  On SAM_Click
.head 7 -  Set nRow = SalTblQueryContext(frm_QueryEditor)
.head 7 +  If nRow >= 0 AND SalTblQueryRowFlags(frm_QueryEditor, nRow, ROW_Selected)
.head 8 +  If SalDlgOpenFile(hWndForm, 'Open File', strFilters, 2, nIndex, strFile, dfPath)
.head 9 -  ! If IDYES = SalMessageBox( 'Вы действительно хотите выполнить
импорт XSL-выражения из файла '||strFile ||'
для отчета №'||Str(frm_QueryEditor.colKODZ), 'Внимание!', MB_YesNo|MB_IconQuestion )
.head 9 +  If IDYES = SalMessageBox( CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgImpXSL') || ' '||strFile || ' ' ||
  CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgForRep') || Str(frm_QueryEditor.colKODZ),
  CurrentLangTable.GetAtomTitle(''), MB_YesNo|MB_IconQuestion )
.head 10 -  Call SalWaitCursor(TRUE)
.head 10 -  Call SalFileOpen(hF, dfPath, OF_Read|OF_Text)
.head 10 -  Set i = 0
.head 10 -  Set ml1 = ''
.head 10 +  Loop
.head 11 -  Call SalFileSeek(hF, i, FILE_SeekBegin)
.head 11 -  Set nLen = SalFileRead(hF, sStr, 2000)
.head 11 -  Set ml1 = ml1 || sStr
.head 11 +  If nLen < 2000
.head 12 -  Break
.head 11 -  Set i = i + nLen
.head 10 -  Call SalFileClose(hF)
.head 10 -  Set nKod = frm_QueryEditor.colKODZ
.head 10 +  If SqlPLSQLCommand(hSql(), "xslupdate(nKod, ml1)")
.head 11 +  If SqlCommit(hSql())
.head 12 -  ! Call SalMessageBox( 'Импорт выполнен успешно!', '', MB_OK )
.head 12 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgImpOk'), '', MB_OK)
.head 11 +  Else
.head 12 -  Call SqlRollback(hSql())
.head 12 -  ! Call SalMessageBox( 'Ошибка импорта!', 'Внимание!', MB_OK|MB_IconExclamation )
.head 12 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgImpErr'),
  CurrentLangTable.GetAtomTitle('cTAt'), MB_OK|MB_IconExclamation)
.head 10 +  Else
.head 11 -  Call SqlRollback(hSql())
.head 11 -  ! Call SalMessageBox( 'Ошибка импорта!', 'Внимание!', MB_OK|MB_IconExclamation )
.head 11 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgImpErr'),
  CurrentLangTable.GetAtomTitle('cTAt'), MB_OK|MB_IconExclamation)
.head 7 -  Call SalTblSetRowFlags(frm_QueryEditor, nRow, ROW_Selected, FALSE)
.head 7 -  Call SalWaitCursor(FALSE)
.head 4 +  Pushbutton: pbImportXSD
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: XSD
.head 5 -  Window Location and Size
.head 6 -  Left:   10.533"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.45"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.31"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Dark Blue
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_TooltipSetText
.head 7 -  ! 'Импорт XSD-файла для отчета'
.head 7 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('frm_QueryEditor.cBTipImportXSD'))
.head 6 +  On SAM_Click
.head 7 -  Set nRow = SalTblQueryContext(frm_QueryEditor)
.head 7 +  If nRow >= 0 AND SalTblQueryRowFlags(frm_QueryEditor, nRow, ROW_Selected)
.head 8 +  If SalDlgOpenFile(hWndForm, 'Open File', strFilters, 2, nIndex, strFile, dfPath)
.head 9 -  ! If IDYES = SalMessageBox( 'Вы действительно хотите выполнить
импорт XSD-файла '||strFile ||'
для отчета №'||Str(frm_QueryEditor.colKODZ), 'Внимание!', MB_YesNo|MB_IconQuestion )
.head 9 +  If IDYES = SalMessageBox( CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgImpXSD') || ' '||strFile || ' ' ||
  CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgForRep') || Str(frm_QueryEditor.colKODZ),
  CurrentLangTable.GetAtomTitle(''), MB_YesNo|MB_IconQuestion )
.head 10 -  Call SalWaitCursor(TRUE)
.head 10 -  Call SalFileOpen(hF, dfPath, OF_Read|OF_Text)
.head 10 -  Set i = 0
.head 10 -  Set ml1 = ''
.head 10 +  Loop
.head 11 -  Call SalFileSeek(hF, i, FILE_SeekBegin)
.head 11 -  Set nLen = SalFileRead(hF, sStr, 2000)
.head 11 -  Set ml1 = ml1 || sStr
.head 11 +  If nLen < 2000
.head 12 -  Break
.head 11 -  Set i = i + nLen
.head 10 -  Call SalFileClose(hF)
.head 10 -  Set nKod = frm_QueryEditor.colKODZ
.head 10 +  If SqlPLSQLCommand(hSql(), "xsdupdate(nKod, ml1)")
.head 11 +  If SqlCommit(hSql())
.head 12 -  ! Call SalMessageBox( 'Импорт выполнен успешно!', '', MB_OK )
.head 12 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgImpOk'), '', MB_OK)
.head 11 +  Else
.head 12 -  Call SqlRollback(hSql())
.head 12 -  ! Call SalMessageBox( 'Ошибка импорта!', 'Внимание!', MB_OK|MB_IconExclamation )
.head 12 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgImpErr'),
  CurrentLangTable.GetAtomTitle('cTAt'), MB_OK|MB_IconExclamation)
.head 10 +  Else
.head 11 -  Call SqlRollback(hSql())
.head 11 -  ! Call SalMessageBox( 'Ошибка импорта!', 'Внимание!', MB_OK|MB_IconExclamation )
.head 11 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgImpErr'),
  CurrentLangTable.GetAtomTitle('cTAt'), MB_OK|MB_IconExclamation)
.head 7 -  Call SalTblSetRowFlags(frm_QueryEditor, nRow, ROW_Selected, FALSE)
.head 7 -  Call SalWaitCursor(FALSE)
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.52"
.head 6 -  Top:    0.075"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\OPEN.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SalTblQueryRowFlags(frm_QueryEditor, SalTblQueryContext(frm_QueryEditor), ROW_Selected)
.head 8 +  If SqlPrepareAndExecute(hSql(), '
   select kodz
   into   :i
   from   zapros_users 
   where  (user_id=:nUserId or user_id=-1) and kodz=:colKODZ')
.head 9 +  If SqlFetchNext(hSql(), nRow)
.head 10 -  Call ZAPROS1(hWndMDI, colKODZ)
.head 9 +  Else
.head 10 -  ! Call SalMessageBox( 'У вас нету прав на выполнение данного запроса!', 'Внимание!', MB_Ok )
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgNoExecRight'),
     CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok)
.head 8 +  Else
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgUsrZaprErr'),
     CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok)
.head 7 +  Else
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgNotSelect'),
     CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('frm_QueryEditor.cBTipDetails') )
.head 2 +  Contents
.head 3 +  Column: colKODZ
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
Пользователя
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование запроса
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.633"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call ChangeCellEditingMode()
.head 3 +  Column: colNAMEF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Имя файла для
экспорта запроса
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 254
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.317"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  ! On SAM_Click
.head 6 -   Call ChangeCellEditingMode()
.head 3 +  Column: colRPT_TEMPLATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Имя файла шаблона
отчета
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 254
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.45"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call ChangeCellEditingMode()
.head 3 +  Column: colUSER_NAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Пользователи имеющие
доступ к запросу
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.4"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalCreateWindow(tbl_ZaprosUsers, hWndMDI, colKODZ)
.head 3 +  Column: colTXT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Текст SQL
выражения
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 10000
.head 4 -  Data Type: Long String
.head 4 -  Justify: Left
.head 4 -  Width:  2.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call ChangeCellEditingMode()
.head 3 +  Column: colSELECT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Текст SQL
выражения
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  ! On SAM_Click
.head 6 -   Call ChangeCellEditingMode()
.head 5 +  On SAM_DoubleClick
.head 6 -  Set lsTmp = IifS(colFlEditTXT=1, colTXT,
  IifS(colTXT!='', colTXT, GetStringFromClob(hSql(), 'zapros', 'kodz', 'txt', colKODZ, '', '')))
.head 6 +  If EditModeInCell()
.head 7 -  ! 'Редактирование текста запроса'
.head 7 -  Call SalModalDialog(dlg_MemoEditor, hWndForm,
  CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTTitleTXT'), bTmp, lsTmp)
.head 7 +  If bTmp
.head 8 -  Set colTXT = lsTmp
.head 8 -  Set colSELECT = Subs(colTXT, 1, 6)
.head 8 -  Set colFlEditTXT = 1
.head 8 -  Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE)
.head 6 +  Else
.head 7 -  Call SalModalDialog(dlg_MemoViewer, hWndForm,
  CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTTitleTXT'),lsTmp)
.head 3 +  Column: colBINDVARS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Bind
переменные
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4000
.head 4 -  Data Type: Long String
.head 4 -  Justify: Left
.head 4 -  Width:  2.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call ChangeCellEditingMode()
.head 5 +  On SAM_DoubleClick
.head 6 -  Set lsTmp = colBINDVARS
.head 6 +  If EditModeInCell()
.head 7 -  ! 'Редактирование списка Bind-переменных'
.head 7 -  Call SalModalDialog(dlg_MemoEditor, hWndForm,
  CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTTitleBINDVARS'), bTmp, lsTmp)
.head 7 +  If bTmp
.head 8 -  Set colBINDVARS = lsTmp
.head 8 -  Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE)
.head 6 +  Else
.head 7 -  Call SalModalDialog(dlg_MemoViewer, hWndForm,
  CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTTitleTXT'),lsTmp)
.head 3 +  Column: colDEFAULT_VARS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Умолч.значения
переменных
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4000
.head 4 -  Data Type: Long String
.head 4 -  Justify: Left
.head 4 -  Width:  2.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  ! On SAM_Click
.head 6 -   Call ChangeCellEditingMode()
.head 5 +  On SAM_DoubleClick
.head 6 -  Set lsTmp = colDEFAULT_VARS
.head 6 -  ! 'Редактирование умолчательных значений переменных'
.head 6 -  Call SalModalDialog(dlg_MemoEditor, frm_QueryEditor,
  CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTTitleDEFAULT_VARS'), bTmp, lsTmp)
.head 6 +  If bTmp
.head 7 -  Set colDEFAULT_VARS = lsTmp
.head 7 -  Call SalTblSetRowFlags(frm_QueryEditor, SalTblQueryContext(frm_QueryEditor), ROW_Edited, TRUE)
.head 3 +  Column: colCREATE_STMT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выражение на создание
dbf файла
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4000
.head 4 -  Data Type: Long String
.head 4 -  Justify: Left
.head 4 -  Width:  2.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call ChangeCellEditingMode()
.head 5 +  On SAM_DoubleClick
.head 6 +  If EditModeInCell()
.head 7 -  Set lsTmp = colCREATE_STMT
.head 7 -  ! 'Редактирование выражения создания dbf файла'
.head 7 -  Call SalModalDialog(dlg_MemoEditor, frm_QueryEditor,
  CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTTitleCREATE_STMT'), bTmp, lsTmp)
.head 7 +  If bTmp
.head 8 -  Set colCREATE_STMT = lsTmp
.head 8 -  Call SalTblSetRowFlags(frm_QueryEditor, SalTblQueryContext(frm_QueryEditor), ROW_Edited, TRUE)
.head 3 +  Column: colCREATE_STMT2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4000
.head 4 -  Data Type: Long String
.head 4 -  Justify: Left
.head 4 -  Width:  2.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If EditModeInCell()
.head 7 -  Set lsTmp = colCREATE_STMT
.head 7 -  ! 'Редактирование выражения создания dbf файла'
.head 7 -  Call SalModalDialog(dlg_MemoEditor, frm_QueryEditor,
  CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTTitleCREATE_STMT'), bTmp, lsTmp)
.head 7 +  If bTmp
.head 8 -  Set colCREATE_STMT = lsTmp
.head 8 -  Call SalTblSetRowFlags(frm_QueryEditor, SalTblQueryContext(frm_QueryEditor), ROW_Edited, TRUE)
.head 5 +  On SAM_Click
.head 6 -  Call ChangeCellEditingMode()
.head 3 +  Column: colFORM_PROC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Процедура
формирования
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 4000
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.15"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call ChangeCellEditingMode()
.head 3 +  Column: colKODR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Связанный
запрос
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.217"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call ChangeCellEditingMode()
.head 3 +  Column: colCREATOR
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Автор запроса
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call ChangeCellEditingMode()
.head 5 +  On SAM_DoubleClick
.head 6 +  If EditModeInCell()
.head 7 +  If Option != EDIT_MODE_USER
.head 8 -  Set bTmp = FALSE
.head 8 -  Call SalModalDialog(dlg_AllUsers, frm_QueryEditor, bTmp, nTmp, sTmp)
.head 8 +  If bTmp
.head 9 -  Set colCREATOR_ID = nTmp
.head 9 -  Set colCREATOR = sTmp
.head 9 +  If NOT SalTblQueryRowFlags(frm_QueryEditor, SalTblQueryContext(frm_QueryEditor), ROW_New)
.head 10 -  Call SalTblSetRowFlags(frm_QueryEditor, SalTblQueryContext(frm_QueryEditor), ROW_Edited, TRUE)
.head 3 +  Column: colCREATOR_ID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Автор запроса
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBIND_SQL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: SQL описание
переменной
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 2000
.head 4 -  Data Type: Long String
.head 4 -  Justify: Left
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If EditModeInCell()
.head 7 -  Set lsTmp = colBIND_SQL
.head 7 -  ! 'Редактирование текста запроса переменных'
.head 7 -  Call SalModalDialog(dlg_MemoEditor, frm_QueryEditor,
  CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTTitleBIND_SQL'), bTmp, lsTmp)
.head 7 +  If bTmp
.head 8 -  Set colBIND_SQL = lsTmp
.head 8 -  Call SalTblSetRowFlags(frm_QueryEditor, SalTblQueryContext(frm_QueryEditor), ROW_Edited, TRUE)
.head 5 +  On SAM_Click
.head 6 -  Call ChangeCellEditingMode()
.head 3 +  Column: colFlEditTXT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPKey
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ключ запроса
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.833"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call ChangeCellEditingMode()
.head 3 +  Column: colWhoChecked
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colVSSStatus
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Статус VSS
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBranch
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Відділення
.head 4 -  Visible? Class Default
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.017"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  ! Function:
.head 4 -  Description: Экспорт выбранных запросов в файлы
.head 4 -  Returns 
.head 4 +  Parameters 
.head 5 -  Number: nParam !-- =0 -  формирование в одтельные файлы, 
                   =1 -  формирование в один файл
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  ! Каталог экспорта
.head 5 -  String: sOutdir
.head 5 -  ! Вместе с отчетами
.head 5 -  Boolean: fIncludingReport
.head 5 -  ! Использовать динамические или статические коды отчетов
.head 5 -  Boolean: fUseStaticReportId
.head 5 -  ! № строки и колонки для событий
.head 5 -  Number: nTmpRowNumber
.head 5 -  Number: nTmpPriRowNumber
.head 5 -  Number: nReportId
.head 5 -  Number: nFetchRes
.head 5 -  Number: nMainRep
.head 5 -  File Handle: hExpFile
.head 5 -  String: sExpFilePath
.head 4 +  Actions 
.head 5 +  If NOT SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 6 -  ! Call SalMessageBox( 'Ни один запрос не выбран!', 'Ошибка', MB_IconStop | MB_Ok )
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgNotSelect'),
  CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
.head 6 -  Return FALSE
.head 5 +  If SalModalDialog(dlg_ExpQueryEx, hWndForm,
  sOutdir, fIncludingReport, fUseStaticReportId, nParam) = 99
.head 6 -  Call WaitCursorOn()
.head 6 -  Set nTmpPriRowNumber = SalTblQueryContext(hWndForm)
.head 6 -  Set nTmpRowNumber = TBL_MinRow
.head 6 -  !
.head 6 +  If (nParam=1)
.head 7 -  Set sExpFilePath = sOutdir
.head 7 +  If not  SalFileOpen ( hExpFile, sExpFilePath, OF_Write)
.head 8 -  Call SalMessageBox(' Невозможно открыть для записи файл '|| sExpFilePath, 'Внимание!',0)
.head 8 -  Call SalWaitCursor (FALSE )
.head 8 -  Return -1
.head 6 -  !
.head 6 +  While SalTblFindNextRow(hWndForm, nTmpRowNumber, ROW_Selected, 0)
.head 7 -  Call SalTblFetchRow( frm_QueryEditor, nTmpRowNumber )
.head 7 -  ! Если это связанный отчет - тогда НЕ выгруж
.head 7 -  Call SqlPrepareAndExecute(hSql(), 
     "select kodz into :nMainRep 
      from zapros 
      where kodz in (select unique kodr from zapros where kodr is not null) and kodz=:colKODZ")
.head 7 +  If Not SqlFetchNext (hSql(), nRow)
.head 8 -  Call SalTblSetContext(hWndForm, nTmpRowNumber)
.head 8 -  ! Выбираем оригинальный ид. отчета
.head 8 -  Set nReportId = NUMBER_Null
.head 8 +  If fUseStaticReportId
.head 9 +  If SqlPrepareAndExecute(hSqlAux2(),
"SELECT ID INTO :nReportId FROM REPORTS
 WHERE TRIM(SUBSTR(SUBSTR(PARAM,1,INSTR(PARAM,',')-1),1,5))=TO_CHAR(:colKODZ)")
.head 10 -  Call SqlFetchNext(hSqlAux2(), nFetchRes)
.head 8 -  ! Здесь мы экспортируем запрос
.head 8 +  If (nParam=1)
.head 9 +  If QE_makeExportToFile(colKODZ, colPKey, colNAME, colKODR, sOutdir, GetTemplateDir() || '\\EXPCAT.QRC',
  fIncludingReport, nReportId, FALSE, hExpFile ) != 0
.head 10 -  Call WaitCursorOff()
.head 10 -  Call SalTblSetContext(hWndForm, nTmpPriRowNumber)
.head 10 -  Call SalFileClose(hExpFile)
.head 10 -  Return FALSE
.head 8 +  Else 
.head 9 +  ! If QE_makeExport(colKODZ, colPKey, colNAME, colKODR, sOutdir||'\\'||QE_GetExportFileName(colPKey), GetTemplateDir() || '\\EXPCAT.QRC',
  fIncludingReport, nReportId, FALSE) != 0
.head 10 -  Call WaitCursorOff()
.head 10 -  Call SalTblSetContext(hWndForm, nTmpPriRowNumber)
.head 10 -  Return FALSE
.head 9 +  If QE_makeExport(colKODZ, colPKey, colNAME, colKODR, sOutdir||'\\'||QE_GetExportFileName(colPKey), GetTemplateDir() || '\\EXPCAT.QRC',
  fIncludingReport, nReportId, FALSE) != 0
.head 10 -  Call WaitCursorOff()
.head 10 -  Call SalTblSetContext(hWndForm, nTmpPriRowNumber)
.head 10 -  Return FALSE
.head 9 -  !
.head 7 -  Call WaitCursorOff()
.head 6 +  If (nParam=1)
.head 7 -  Call SalFileClose(hExpFile)
.head 3 +  Function: ExportSelectedQueries
.head 4 -  Description: Экспорт выбранных запросов в файлы
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  ! формирование в один файл или каждый в свой
.head 5 -  Boolean: bIsSingleFile
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  ! Каталог экспорта
.head 5 -  Number: sQryIds[*]
.head 5 -  String: sErrMsg
.head 5 -  Number: nQryCount
.head 5 -  Number: nRow
.head 5 -  ! если выгрузка во многие файлы - сдесь содержится путь, где их создавать
.head 5 -  String: sFilePath 
.head 5 -  Date/Time: dtDateNow
.head 4 +  Actions
.head 5 +  If NOT SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgNotSelect'),
  CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
.head 6 -  Return FALSE
.head 5 -  !
.head 5 -  Set sFilePath = GetPrnDir()
.head 5 -  Set dtDateNow = SalDateCurrent()
.head 5 -  Set sFilePath = IifS(bIsSingleFile, sFilePath||'\\_exprep'||SalFmtFormatDateTime(dtDateNow,"hhhhmm")||'.sql', sFilePath)
.head 5 -  Call SalModalDialog(dlg_ExpQueryEx, hWndForm, sFilePath)
.head 5 -  !
.head 5 -  Set nQryCount=0
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 -  Set nQryCount = nQryCount+1
.head 6 -  Set sQryIds[nQryCount] = colKODZ
.head 5 -  Call Debug('Выбрано '||SalNumberToStrX(nQryCount,0)||' запросов')
.head 5 +  If QE_ExpSelectedQueries(sQryIds, nQryCount, sFilePath, bIsSingleFile, sErrMsg)
.head 6 -  Call SalMessageBox('Выгрузка кат. запросов выполнена успешно','Внимание!',0)
.head 5 +  Else
.head 6 -  Call SalMessageBox('Ошибка выгрузки кат. запросов','Внимание!',0)
.head 5 -  Call WaitCursorOff()
.head 3 +  Function: GenerateNewBankPkey
.head 4 -  Description: Генерация уникального ключа при создании отчета в банке
.head 4 +  Returns
.head 5 -  String:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sNewZaprosPk
.head 5 -  String: sBankKod
.head 5 -  String: sCurrentBranch
.head 4 +  Actions
.head 5 -  Set sBankKod=GetGlobalOption('ZPRS_PK')
.head 5 +  If (sBankKod='')
.head 6 -  ! Если мультиМФО 
.head 6 +  If GetGlobalOption('HAVETOBO')   = '2'
.head 7 -  ! Проверим, возможно это '/'
.head 7 -  Call SqlPrepareAndExecute(hSql(),"select sys_context('bars_context','user_branch') into :sCurrentBranch from staff$base where upper(logname)=user")
.head 7 +  If SqlFetchNext(hSql(),nTmp)
.head 8 +  If sCurrentBranch = '/'
.head 9 -  Set sBankKod=GetGlobalOption('ZPRS_PKR')
.head 9 +  If (sBankKod='')
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgNoPkeyPar'),
  CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
.head 10 -  Return STRING_Null
.head 8 -  Else
.head 6 -  ! Если одно МФО 
.head 6 +  Else
.head 7 +  If (sBankKod='')
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgNoPkeyPar'),
  CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
.head 8 -  Return STRING_Null
.head 5 -  !
.head 5 -  Call SqlPrepareAndExecute(hSql(),"select substr(abs_utils.get_next_zapros_pkey,1,100) into :sNewZaprosPk from dual")
.head 5 +  If not SqlFetchNext(hSql(),nTmp)
.head 6 -  Call SalMessageBox('Невозможно выполнить запрос на последующий пк. номер для запроса',
  CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
.head 6 -  Return STRING_Null
.head 5 -  Return sNewZaprosPk
.head 3 +  Function: GenerateNewBarsPkey
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String: sPkey
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nVSSNewSequence
.head 5 -  String: sBankCode
.head 5 -  String: sModuleCode
.head 5 -  String: sPkey
.head 5 -  Boolean: bDlgResp
.head 4 +  Actions
.head 5 -  ! Запрос кода банка 
.head 5 -  Call SalModalDialog(dlg_PkeyData, hWndMDI, 'BNK', bDlgResp, sBankCode)
.head 5 +  If bDlgResp
.head 6 -  ! Запрос кода модуля
.head 6 -  Call SalModalDialog(dlg_PkeyData, hWndMDI, 'MOD', bDlgResp, sModuleCode)
.head 6 +  If bDlgResp
.head 7 -  ! Усли работаем с VSS
.head 7 +  If bVSSuse = 1
.head 8 -  Set nVSSNewSequence = getNextVSSSequence(sBankCode,sModuleCode)
.head 7 +  Else
.head 8 -  Set nVSSNewSequence = NUMBER_Null
.head 7 -  !
.head 7 -  Set sPkey='\\BRS\\'||sBankCode||'\\'||sModuleCode||'\\'
.head 7 +  If nVSSNewSequence != NUMBER_Null
.head 8 -  Set sPkey=sPkey||SalNumberToStrX(nVSSNewSequence,0)
.head 7 -  !
.head 7 -  Call SalModalDialog(dlg_Pkey, hWndMDI, nVSSNewSequence, sPkey)
.head 7 -  !
.head 7 -  !
.head 6 +  Else
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_PkeyData.msgNoMdl'),
  CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok)
.head 7 -  Set sPkey = STRING_Null
.head 5 +  Else
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_PkeyData.msgNoBnk'),
  CurrentLangTable.GetAtomTitle('cTAt'), MB_Ok)
.head 6 -  Set sPkey = STRING_Null
.head 5 -  !
.head 5 -  Return sPkey
.head 3 +  ! Function: ValidateNewBarsPkey
.head 4 -   Description: Проверка введенного уник. ключа на БАРС-е
.head 4 -   Returns
.head 4 +   Parameters
.head 5 -   String: sNewZaprosPkey
.head 4 -   Static Variables
.head 4 +   Local variables
.head 5 -   Number: nSlashCou
.head 5 -   String: sTmp
.head 4 +   Actions
.head 5 +   Loop
.head 6 -   Set nSlashCou = SalStrScan(sNewZaprosPkey,"\")
.head 6 -   Set sTmp = SalStr
.head 3 +  Function: MakeZaprosCopy
.head 4 -  Description: Создать копию каталогизированного запроса для выбранного запроса
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nRowNum
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sPkey
.head 5 -  Number: sNewKodz
.head 5 -  Number: sNewKodzR
.head 4 +  Actions
.head 5 -  ! копию строки сделаем исскуственно - сначала создадим такой же отчет но с номером -1 (для связанного -2),
! потом сохраним изменения которые сделали, а потом переназначим kodz
.head 5 -  Call SalTblSetContext(frm_QueryEditor, nRowNum)
.head 5 -  Set sPkey = GenerateNewBankPkey()
.head 5 +  If SqlPrepareAndExecute(hSql(),
  " select bars_sqnc.get_nextval('s_zapros') into :sNewKodz from dual" )
.head 6 +  If SqlPrepareAndExecute(hSql(),
  "insert into zapros(kodz, id, name, namef, bindvars, create_stmt, rpt_template, kodr, form_proc,
                      default_vars, creator, bind_sql, xsl_data, txt, xsd_data,  pkey)
   values            ( :sNewKodz, :frm_QueryEditor.colID, :frm_QueryEditor.colNAME, :frm_QueryEditor.colNAMEF,
                       :frm_QueryEditor.colBINDVARS,   :frm_QueryEditor.colCREATE_STMT,
                       :frm_QueryEditor.colRPT_TEMPLATE, :frm_QueryEditor.colKODR,:frm_QueryEditor.colFORM_PROC,
                       :frm_QueryEditor.colDEFAULT_VARS, :nUserId, :frm_QueryEditor.colBIND_SQL,
                       :colTXT, empty_clob(), empty_clob(),   :sPkey)
  ")
.head 7 -  ! Если существ связанный
.head 7 +  If (frm_QueryEditor.colKODR != NUMBER_Null)
.head 8 +  If SqlPrepareAndExecute(hSql(),
  " select bars_sqnc.get_nextval('s_zapros') into :sNewKodzR from dual" )
.head 9 -  Call SqlPrepareAndExecute(hSql(),
  "insert into zapros(kodz, id, name, namef, bindvars, create_stmt, rpt_template,
                      kodr, form_proc, default_vars, creator, bind_sql, xsl_data,
                      txt, xsd_data, xml_encoding, pkey)
   select  sNewKodzR, id, name, namef, bindvars, create_stmt, rpt_template,
                      kodr, form_proc, default_vars, creator, bind_sql, xsl_data,
                      txt, xsd_data, xml_encoding, :sPkey||'\\1'
   from zapros where kodz=:frm_QueryEditor.colKODR
  ")
.head 8 +  Else
.head 9 -  Call SalMessageBox('Невозможно создать копию связанного запроса',
  CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop )
.head 7 +  Else
.head 8 -  Call SalMessageBox('Невозможно вычитать новый номер для связанного кат.запроса',
  CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop )
.head 7 -  !
.head 7 -  !
.head 7 -  ! нужно проапдейтить поля, которых нету в окне модификации
.head 7 -  If SqlPrepareAndExecute(hSql(),
"update zapros set xml_encoding, xsl_data, xsd_data =
    (select xml_encoding, xsl_data, xsd_data from zapros where kodz = :frm_QueryEditor.colKODZ)
where kodz =:sNewKodz")
.head 6 +  Else
.head 7 +  Call SalMessageBox('Невозможно создать копию запроса',
  CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop )
.head 8 -  Return -1
.head 5 +  Else
.head 6 +  Call SalMessageBox('Невозможно вычитать новый номер для кат.запроса',
  CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop )
.head 7 -  Return -1
.head 5 -  Call SalSendMsg(pbRefresh,SAM_Click, 0,0)
.head 3 +  Function: ChangeCellEditingMode
.head 4 -  Description: Изменить редактируемость колонки в зваисимиости от владельца отчета
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! если отчет НЕ разработчиков
.head 5 +  If Option = EDIT_MODE_BANK or Option = EDIT_MODE_USER 
.head 6 +  If SalStrLeftX(colPKey,5) = '\\BRS\\'
.head 7 -  Call SalDisableWindow(hWndItem)
.head 6 +  Else
.head 7 -  Call SalEnableWindow(hWndItem)
.head 3 +  Function: EditModeInCell
.head 4 -  Description: Могу ли я редактировать колоку
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! EDIT_MODE_USE используют только в банке!
.head 5 +  If ( Option= EDIT_MODE_BANK and SalStrLeftX(colPKey,5) != '\\BRS\\' ) or
   ( Option= EDIT_MODE_USER and SalStrLeftX(colPKey,5) != '\\BRS\\' ) or
   ( Option= EDIT_MODE_BARS and SalStrLeftX(colPKey,5) = '\\BRS\\' )  
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Return FALSE
.head 3 +  Function: IsThisReferencedKod
.head 4 -  Description: Является ли данный код запроса связанным
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Number: nKodz
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Проверим, дочерний ли это запрос
.head 5 +  If SqlPrepareAndExecute(hSql(), "SELECT kodr FROM zapros WHERE kodr=:nKodz")
.head 6 +  If SqlFetchNext(hSql(),nTmp)
.head 7 -  Return TRUE
.head 6 +  Else
.head 7 -  Return FALSE
.head 3 +  Function: VSSWork
.head 4 -  Description: Работа с VSS
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nParam 
.head 5 -  String: sPkey
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  File Handle: hFile
.head 5 -  String: sExportedFileName
.head 5 -  String: sFileLine
.head 5 -  String: sFileLinePrev
.head 5 -  String: sWhoCheckedOut
.head 5 -  String: sCurrDir
.head 5 -  Number: nReturn
.head 5 -  Number: i
.head 5 -  !
.head 4 +  Actions
.head 5 -  !
.head 5 +  If nParam  = VSS_ADD
.head 6 -  !
.head 6 -  Call SalSendMsg(pbExportQuery, SAM_Click, 0, 0 )
.head 6 -  !
.head 6 -  Set sExportedFileName= QE_GetExpFileNameByPK(sPkey)
.head 6 +  If (SalLoadAppAndWait(sVSSbatFilePath||' '||sExportedFileName||' '||SalNumberToStrX(VSS_ADD,0), Window_NotVisible,nReturn)=FALSE)
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgAppFailed'), CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 7 -  Return 0
.head 6 -  !
.head 6 -  ! Проверка файла лога
.head 6 -  Set sFileLine=''
.head 6 +  If (VisFileOpen( hFile, sVSSLogsPath||'\\$vssadd.log', OF_Read) =VTERR_Ok)
.head 7 +  While VisFileReadString(hFile, sFileLine) = VTERR_Ok 
.head 8 -  Set sFileLinePrev = sFileLine
.head 7 +  If SalStrScan(sFileLine,'already exists') > 0  AND
   SalStrScan(sFileLine,sExportedFileName) > 0 
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgVSSFileExists'), CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 7 +  Else
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgVSSFileAded'), CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 7 -  Call VisFileClose(hFile)
.head 6 +  Else
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgFileOpFld')||' '|| sVSSLogsPath||'\\$vssadd.log', CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 7 -  Return 0
.head 5 -  !
.head 5 -  !
.head 5 +  If nParam  = VSS_CHECKOUT
.head 6 -  !
.head 6 -  ! TO_DO сделать проверку, что такого файла вообще нету
.head 6 -  !
.head 6 -  Set sExportedFileName= QE_GetExpFileNameByPK(sPkey)
.head 6 -  ! Если такой файл существует  Удалим  
.head 6 +  ! If (VisFileFind(GetPrnDir()||'\\'||sExportedFileName)!=STRING_Null)
.head 7 -   Call VisFileDelete(GetPrnDir()||'\\'||sExportedFileName)
.head 6 -  !
.head 6 +  If (SalLoadAppAndWait(sVSSbatFilePath||' '||sExportedFileName||' '||SalNumberToStrX(VSS_CHECKOUT,0), Window_NotVisible,nReturn)=FALSE )
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgAppFailed'), CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 7 -  Return 0
.head 6 -  !
.head 6 -  ! Проверка файла лога
.head 6 -  Set sFileLine=''
.head 6 +  If (VisFileOpen( hFile, sVSSLogsPath||'\\$vsschecko.log', OF_Read) =VTERR_Ok)
.head 7 +  While VisFileReadString(hFile, sFileLine) = VTERR_Ok 
.head 8 -  Set sFileLinePrev = sFileLine
.head 7 +  If SalStrScan(sFileLine,'is checked out by') > 0 AND 
   SalStrScan(sFileLine,sExportedFileName) > 0 
.head 8 -  Set sWhoCheckedOut=SalStrRightX(sFileLine, SalStrLength(sFileLine) - SalStrScan(sFileLine,'by') - 3)
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgVSSFileChecked')||' '||sWhoCheckedOut, CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 7 +  Else
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgVSSFileCheckout'), CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 7 -  Call VisFileClose(hFile)
.head 6 +  Else
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgFileOpFld')||' '||sVSSLogsPath||'\\$vsschecko.log', CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 7 -  Return 0
.head 5 -  !
.head 5 -  !
.head 5 +  If nParam  = VSS_CHECKIN
.head 6 -  !
.head 6 -  ! TO_DO сделать проверку, что такого файла вообще нету
.head 6 -  !
.head 6 -  !
.head 6 -  Set sExportedFileName= QE_GetExpFileNameByPK(sPkey)
.head 6 -  !
.head 6 -  Call SalModalDialog(dlg_ExpQuery, hWndForm,
  frm_QueryEditor.colKODZ, frm_QueryEditor.colPKey, frm_QueryEditor.colNAME, frm_QueryEditor.colKODR, sVSSWorkFolder)
.head 6 -  !
.head 6 -  ! Перепишем тоько что выгруженный файл в директорию VSS для того, что б потом checkin-ить 
.head 6 -  !
.head 6 +  If (SalLoadAppAndWait(sVSSbatFilePath||' '||sExportedFileName||' '||SalNumberToStrX(VSS_CHECKIN,0), Window_NotVisible,nReturn)=FALSE )
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgAppFailed'), CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 7 -  Return 0
.head 6 -  !
.head 6 -  ! Проверка файла лога
.head 6 -  Set sFileLine=''
.head 6 +  If (VisFileOpen( hFile, sVSSLogsPath||'\\$vsschecki.log', OF_Read) =VTERR_Ok)
.head 7 +  While VisFileReadString(hFile, sFileLine) = VTERR_Ok 
.head 8 -  Set sFileLinePrev = sFileLine
.head 7 +  If SalStrScan(sFileLine,'You do not have file') > 0 AND 
   SalStrScan(sFileLine,sExportedFileName) > 0 
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgVSSFileNotYour')||' '||sWhoCheckedOut, CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 7 -  Call VisFileClose(hFile)
.head 6 +  Else
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgFileOpFld')||' '||sVSSLogsPath||'\\$vsschecki.log', CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 7 -  Return 0
.head 6 -  !
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgVSSFileCheckin'), CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 5 -  !
.head 5 -  !
.head 5 +  If nParam  = VSS_SHOW_USERCHECKED
.head 6 -  !
.head 6 -  ! удаление файла лога
.head 6 +  If SalStrLength(VisFileFind(sVSSLogsPath||'\\$vssstatus.log'))>0
.head 7 +  If VisFileDelete(sVSSLogsPath||'\\$vssstatus.log')<0
.head 8 -  Call SalMessageBox('Ошибка удаления файла '||sVSSLogsPath||'\\$vssstatus.log', CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 8 -  Return 0
.head 6 -  !
.head 6 +  If (SalLoadAppAndWait(sVSSbatFilePath||' 1 5', Window_NotVisible,nReturn)=FALSE )
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgAppFailed'), CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 7 -  Return 0
.head 6 -  !
.head 6 -  ! Проверка файла лога
.head 6 -  Set sFileLine=''
.head 6 +  If (VisFileOpen( hFile, sVSSLogsPath||'\\$vssstatus.log', OF_Read) =VTERR_Ok)
.head 7 -  ! первая строка - это путь проэкта
.head 7 +  If VisFileReadString(hFile, sFileLine) = VTERR_Ok 
.head 8 -  Set i=0
.head 8 -  ! в логе длина имени файла - фиксированая (иногда файл может не вместиться), поэтому читаем до знака  - точка.
.head 8 +  While VisFileReadString(hFile, sFileLine) = VTERR_Ok 
.head 9 -  Set sCheckedFiles[i] = SalStrLeftX(sFileLine, SalStrScan(sFileLine,'.') )
.head 9 -  Set sCheckedUsers[i] = SalStrTrimX( SalStrMidX(sFileLine,20, 14))
.head 9 -  Set i=i+1
.head 8 -  Set nCheckedCnt = i
.head 7 -  !
.head 7 -  Call VisFileClose(hFile)
.head 7 -  !
.head 6 +  Else
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgFileOpFld')||' '||sVSSLogsPath||'\\$vssstatus.log', CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 7 -  Return 0
.head 6 -  !
.head 6 -  !
.head 5 -  !
.head 5 -  ! Проверить статус файла (так же сдесь проверяем на наличие)
.head 5 +  If nParam  = VSS_CHECK_STATUS
.head 6 -  !
.head 6 -  ! удаление файла лога
.head 6 +  If SalStrLength(VisFileFind(sVSSLogsPath||'\\$vssstatus.log'))>0
.head 7 +  If VisFileDelete(sVSSLogsPath||'\\$vssstatus.log')<0
.head 8 -  Call SalMessageBox('Ошибка удаления файла '||sVSSLogsPath||'\\$vssstatus.log', CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 8 -  Return 0
.head 6 -  !
.head 6 -  Set sExportedFileName= QE_GetExpFileNameByPK(sPkey)
.head 6 +  If SalLoadAppAndWait(sVSSbatFilePath||' '||sExportedFileName||' '||SalNumberToStrX(VSS_CHECK_STATUS,0), Window_NotVisible,nReturn)=FALSE 
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgAppFailed'), CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 7 -  Return 0
.head 6 -  !
.head 6 -  ! Проверка файла лога
.head 6 -  Set nVSSStatus = VSS_STATUS_UNKNOWN
.head 6 -  Set sFileLine=''
.head 6 +  If (VisFileOpen( hFile, sVSSLogsPath||'\\$vssstatus.log', OF_Read) =VTERR_Ok)
.head 7 -  ! первая строка - это путь проэкта
.head 7 +  If VisFileReadString(hFile, sFileLine) = VTERR_Ok 
.head 8 -  ! в логе длина имени файла - фиксированая (иногда файл может не вместиться), поэтому читаем до знака  - точка.
.head 8 +  While VisFileReadString(hFile, sFileLine) = VTERR_Ok 
.head 9 -  Set sFileLinePrev = sFileLine
.head 8 -  !
.head 8 -  ! No checked out files found
.head 8 +  If SalStrScan(sFileLine,'checked out') > 0 
.head 9 -  ! Call Debug ('нашли ='||'<No checked out files found>, ставим статус VSS_STATUS_FREE='||SalNumberToStrX(nVSSStatus,0))
.head 9 -  Set nVSSStatus = VSS_STATUS_FREE
.head 8 +  If SalStrScan(sFileLine,'is not an existing filename') > 0 
.head 9 -  Set nVSSStatus = VSS_STATUS_NOT_FOUND
.head 9 -  ! Call Debug ('нашли ='||'<is not an existing filename>, ставим статус VSS_STATUS_NOT_FOUND='||SalNumberToStrX(nVSSStatus,0))
.head 8 +  If SalStrScan(sFileLine,sExportedFileName) > 0 
.head 9 -  Set nVSSStatus = VSS_STATUS_CHECKED
.head 9 -  ! Call Debug ('нашли ='||'<'||sExportedFileName||'>, ставим статус VSS_STATUS_CHECKED='||SalNumberToStrX(nVSSStatus,0))
.head 8 -  !
.head 7 -  !
.head 7 -  Call VisFileClose(hFile)
.head 7 -  !
.head 6 +  Else
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgFileOpFld')||' '||sVSSLogsPath||'\\$vssstatus.log', CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 7 -  Return 0
.head 6 -  !
.head 6 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 3 +  Function: VSSinitParams
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sFileLine
.head 5 -  String: sVSSexe
.head 5 -  File Handle: hFile
.head 4 +  Actions
.head 5 -  Call SalUseRegistry( TRUE, INI_CompanyName )
.head 5 -  Call SalGetProfileString(INI_CommonParameters, 'VSSbatfile', '', sVSSbatFilePath, INI_ProductName)
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  !
.head 5 -  Set sVSSbatFilePath = SalStrTrimX(sVSSbatFilePath)
.head 5 -  !
.head 5 -  ! не работаем с VSS
.head 5 +  If sVSSbatFilePath='' or VisFileFind(sVSSbatFilePath) = '' or  VisFileFind(sVSSbatFilePath) = STRING_Null
.head 6 -  Set bVSSuse = 0
.head 5 +  Else
.head 6 -  !
.head 6 -  ! Директория логов для VSS - это директория, где находится vsswork.bat
.head 6 -  Set sVSSLogsPath = SalStrLeftX(sVSSbatFilePath, SalStrScan(sVSSbatFilePath, '\vsswork')-1)
.head 6 -  !
.head 6 -  Set sFileLine=''
.head 6 +  If (VisFileOpen( hFile, sVSSbatFilePath, OF_Read) =VTERR_Ok)
.head 7 +  While VisFileReadString(hFile, sFileLine) = VTERR_Ok 
.head 8 +  If SalStrScan(sFileLine,'VSSUSER') > 0
.head 9 -  Set sVSSUser= SalStrRightX(sFileLine, SalStrLength(sFileLine) - SalStrScan(sFileLine,'=')-1)
.head 9 -  Set sVSSUser = SalStrTrimX(sVSSUser)
.head 8 +  If SalStrScan(sFileLine,'VSSREPORTSDIR') >0
.head 9 -  Set sVSSWorkFolder= SalStrRightX(sFileLine, SalStrLength(sFileLine) - SalStrScan(sFileLine,'=')-1)
.head 9 -  Set sVSSWorkFolder = SalStrTrimX(sVSSWorkFolder)
.head 8 -  ! Проверим на правильность указания директории
.head 8 +  If SalStrScan(sFileLine,'VSSDIR') >0
.head 9 -  Set sVSSexe = SalStrRightX(sFileLine, SalStrLength(sFileLine) - SalStrScan(sFileLine,'=')-1)
.head 9 -  Set sVSSexe = SalStrTrimX(sVSSexe)
.head 9 -  ! в батнике неправильно указан путь к vss.exe
.head 9 +  If VisFileFind(sVSSexe||'\\ss.exe')='' or VisFileFind(sVSSexe||'\\ss.exe')=STRING_Null
.head 10 -  Call SalMessageBox('В файле '||sVSSbatFilePath||' неправильно указана переменная VSSDIR - по данному пути не существует файла ss.exe.', CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 10 -  Set bVSSuse = 0
.head 10 -  Return 0
.head 9 -  Break
.head 7 -  Call VisFileClose(hFile)
.head 7 -  !
.head 6 +  Else
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgFileOpFld')||' '||sVSSbatFilePath, CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 7 -  Set bVSSuse = 0
.head 7 -  Return 0
.head 5 -  !
.head 3 +  Function: CheckForCorrectSelection
.head 4 -  Description: Выбранный запрос должен быть выбрпанным и не связанным 
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If NOT SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 6 -  ! Call SalMessageBox( 'Ни один запрос не выбран!', 'Ошибка', MB_IconStop | MB_Ok )
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgNotSelect'),
  CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
.head 6 -  Return FALSE
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 6 -  Set i=i+1
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 5 +  If i >1 
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgMultSel'),
  CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
.head 6 -  Return FALSE
.head 5 -  ! Проверим, дочерний ли это запрос
.head 5 +  If IsThisReferencedKod(frm_QueryEditor.colKODZ)
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgSelRef'), CurrentLangTable.GetAtomTitle('cTAt'), 0)
.head 6 -  Return FALSE
.head 3 +  Function: UsedByTasks
.head 4 -  Description: Ф-ция отдает строку последовательность номеров отчетов, кот. ссылаются на данный кат
запрос и через '/' имена и номера ф-ций (ShowExportCatQuery) 
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Number: nKodz
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sUsedByLst 
.head 5 -  String: sObjId 
.head 5 -  String: sObjName 
.head 5 -  Number: nStep
.head 4 +  Actions
.head 5 -  Set sUsedByLst=''
.head 5 -  Set sObjId=''
.head 5 -  Set nStep=0
.head 5 -  ! Номера отчетов
.head 5 +  If SqlPrepareAndExecute(hSql(),
  T("select id into :sObjId from reports
     where substr(param, 1, instr(param,',')-1 )=:frm_QueryEditor.colKODZ
           and form='frm_UniReport'"
    ))
.head 6 +  While SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Set sUsedByLst =sUsedByLst||IifS(SalStrLength(sUsedByLst )=0, '',',')||sObjId
.head 5 -  !
.head 5 -  !
.head 5 -  ! список функций
.head 5 -  !
.head 5 +  If SqlPrepareAndExecute(hSql(),
  T("select codeoper, name into  :sObjId, :sObjName  
     from operlist
     where substr(funcname, instr(funcname,'(')+1,instr(funcname,',')-instr(funcname,'(') -1)=:nKodz
           and funcname like 'ExportCatQuery%' "
    ))
.head 6 +  While SqlFetchNext(hSql(), nFetchRes)
.head 7 +  If nStep=0
.head 8 -  Set sUsedByLst=sUsedByLst||IifS(SalStrLength(sUsedByLst)=0, '(нет отчетов)','')||'/'
.head 7 -  Set sUsedByLst=sUsedByLst||IifS(SalStrRightX(sUsedByLst,1)='/', '',',')||sObjId||'('||sObjName||')'  
.head 7 -  Set nStep=1
.head 5 -  !
.head 5 -  Return sUsedByLst
.head 5 -  !
.head 3 +  Function: getNextVSSSequence
.head 4 -  Description: Найти из VSS последующий номер для данного модуля и банка
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  String: sBankCode
.head 5 -  String: sModuleCode
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sPkey
.head 5 -  Number: i
.head 4 +  Actions
.head 5 -  Set i=1
.head 5 +  Loop
.head 6 -  Set sPkey = '\\BRS\\'||sBankCode||'\\'||sModuleCode||'\\'
.head 6 -  Set sPkey=sPkey||SalNumberToStrX(i,0)
.head 6 -  Call VSSWork(VSS_CHECK_STATUS, sPkey)
.head 6 -  !
.head 6 -  ! Call Debug ('Получили статус ='||SalNumberToStrX(nVSSStatus,0)||' для номера-'|| SalNumberToStrX(i,0))
.head 6 -  ! Если такого файла не существует
.head 6 +  If nVSSStatus = VSS_STATUS_NOT_FOUND  or  VSS_STATUS_UNKNOWN
.head 7 -  Return i
.head 6 +  If i >= 1000
.head 7 -  Set nVSSStatus = VSS_STATUS_UNKNOWN
.head 7 -  Return i
.head 6 -  Set i = i + 1
.head 3 +  Function: getColorForRow
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Number: nststus
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nststus = VSS_STATUS_CHECKED_BY_USER
.head 6 -  Return SalColorFromRGB( 190, 200, 255 )
.head 5 +  If nststus = VSS_STATUS_CHECKED
.head 6 -  Return SalColorFromRGB( 255, 190, 255 )
.head 5 +  If nststus = VSS_STATUS_UNKNOWN or   nststus = VSS_STATUS_NOT_FOUND
.head 6 -  Return SalColorFromRGB( 255,220,190 )
.head 3 +  Function: addReportToOperList
.head 4 -  Description: Добавить в функции
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If NOT SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTMsgNotSelect'),
  CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop | MB_Ok)
.head 6 -  Return FALSE
.head 5 -  Set nRow = TBL_MinRow
.head 5 +  If SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 6 -  Call SalTblSetContext(hWndForm, nRow)
.head 6 -  Call SalModalDialog(dlg_addToFunc, hWndForm, colKODZ)
.head 2 +  Window Parameters
.head 3 -  Number: Option
.head 2 +  Window Variables
.head 3 -  ! Connect
.head 3 -  : cAux
.head 4 -  Class: cABSConnect
.head 3 -  String: sInsert
.head 3 -  String: sUpdate
.head 3 -  String: sDeleteConstrSql
.head 3 -  ! Temporary
.head 3 -  Number: nTmp
.head 3 -  Number: nCLOBLength
.head 3 -  String: sTmp
.head 3 -  Long String: lsTmp
.head 3 -  Boolean: bTmp
.head 3 -  !
.head 3 -  ! Buffer
.head 3 -  Number: bufID
.head 3 -  String: bufUSER_NAME
.head 3 -  !
.head 3 -  String: bufNAME
.head 3 -  String: bufNAMEF
.head 3 -  String: bufRPT_TEMPLATE
.head 3 -  String: bufTXT
.head 3 -  String: bufBINDVARS
.head 3 -  String: bufDEFAULT_VARS
.head 3 -  String: bufCREATE_STMT
.head 3 -  String: bufFORM_PROC
.head 3 -  Number: bufKODR
.head 3 -  Long String: lsChildCrStmt
.head 3 -  String: sChildQrp
.head 3 -  Long String: lsSqlText
.head 3 -  ! Common
.head 3 -  Number: nUserId
.head 3 -  !
.head 3 -  Number: nRow
.head 3 -  String: strFilters[2]
.head 3 -  Number: nIndex
.head 3 -  String: strFile
.head 3 -  String: dfPath
.head 3 -  Number: i
.head 3 -  Number: nLen
.head 3 -  Long String: sStr
.head 3 -  File Handle: hF
.head 3 -  Number: nKod
.head 3 -  Number: nMainKod
.head 3 -  Number: nRefKod
.head 3 -  String: sMainPkey
.head 3 -  String: sZaprosPkey
.head 3 -  Number: nNewRow
.head 3 -  Number: nCopiedRow
.head 3 -  String: sZaprosFields[10]
.head 3 -  String: sExportDir
.head 3 -  !
.head 3 -  String: sCheckedFiles[*]
.head 3 -  String: sCheckedUsers[*]
.head 3 -  Number: nCheckedCnt
.head 3 -  Boolean: VSSAlreadyChecked
.head 3 -  Boolean: VSSAlreadyExist
.head 3 -  String: sVSSUser
.head 3 -  String: sVSSbatFilePath
.head 3 -  String: sVSSLogsPath
.head 3 -  String: sVSSWorkFolder
.head 3 -  Number: nVSSStatus
.head 3 -  Boolean: bVSSuse
.head 3 -  !
.head 3 -  String: sToolTipText
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_QueryEditor.cTWndTitle'))
.head 4 -  Call SalTblSetColumnTitle(hWndForm.frm_QueryEditor.colSELECT, CurrentLangTable.GetAtomTitle('frm_QueryEditor.colTXT'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SalTblSetLockedColumns(hWndForm, 1)
.head 4 -  Call SalDisableWindow(pbPaste)
.head 4 -  !
.head 4 +  If Option = EDIT_MODE_BARS
.head 5 -  Call SalEnableWindow(frm_QueryEditor.colPKey)
.head 4 -  !
.head 4 +  If GetGlobalOption('XMLAPPLY') != '1'
.head 5 -  Call SalHideWindow(pbImportXSL)
.head 5 -  Call SalHideWindow(pbImportXSD)
.head 4 -  ! Создаем доп. соединение
.head 4 -  Call XConnectGetParams(cAux)
.head 4 +  If NOT cAux.Connect()
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Call SalDestroyWindow(hWndForm)
.head 4 -  !
.head 4 -  Set nUserId = GetUserId()
.head 4 -  Set fFilterAtStart  = TRUE
.head 4 -  Set strFilterTblName = 'ZAPROS'
.head 4 -  Set strPrintFileName = 'ZAPROS'
.head 4 -  Set frm_QueryEditor.nTabInstance = 1
.head 4 -  ! Основные SQL`и
.head 4 -  Set strSqlPopulate =
"SELECT
   ZAPROS.KODZ,
   ZAPROS.ID,
   ZAPROS.NAME,
   ZAPROS.BINDVARS,
   ZAPROS.DEFAULT_VARS,
   ZAPROS.NAMEF,
   SUBSTR(ZAPROS.CREATE_STMT,1,2000),
   SUBSTR(ZAPROS.CREATE_STMT,2001, 2000),
   ZAPROS.RPT_TEMPLATE,   
   ZAPROS.FORM_PROC,
   ZAPROS.KODR,
   NVL(c.FIO,'Все пользователи'),
   c.ID,
   substr(f_getc(ZAPROS.KODZ,1,6),1,6),
   ZAPROS.BIND_SQL,
   zapros.pkey,
   zapros.branch
 INTO
   :frm_QueryEditor.colKODZ,
   :frm_QueryEditor.colID,
   :frm_QueryEditor.colNAME,
   :frm_QueryEditor.colBINDVARS,
   :frm_QueryEditor.colDEFAULT_VARS,
   :frm_QueryEditor.colNAMEF,
   :frm_QueryEditor.colCREATE_STMT,
   :frm_QueryEditor.colCREATE_STMT2,
   :frm_QueryEditor.colRPT_TEMPLATE,
   :frm_QueryEditor.colFORM_PROC,
   :frm_QueryEditor.colKODR,
   :frm_QueryEditor.colCREATOR,
   :frm_QueryEditor.colCREATOR_ID,
   :frm_QueryEditor.colSELECT,
   :frm_QueryEditor.colBIND_SQL,
   :frm_QueryEditor.colPKey,
   :frm_QueryEditor.colBranch from
   zapros, staff s, staff c
 where
   zapros.id=s.id(+) and zapros.creator=C.id(+) " ||
   IifS(Option=EDIT_MODE_USER, " and (creator=:frm_QueryEditor.nUserId or creator is null)", "") || "
 order by zapros.kodz DESC, zapros.name"
.head 4 -  Set strSqlDelete = "delete from zapros where kodz=:frm_QueryEditor.colKODZ"
.head 4 -  Call SalSendClassMessage(UM_Create, 0, 0)
.head 4 -  ! Insert и Update делаем отдельно в UM_Update
.head 4 -  Set sInsert =
"INSERT INTO ZAPROS (
   KODZ,
   ID,
   NAME,
   BINDVARS,
   DEFAULT_VARS,
   FORM_PROC,
   KODR,
   NAMEF,
   CREATE_STMT,
   RPT_TEMPLATE,
   CREATOR,
   BIND_SQL,
   TXT,
   PKEY
)
 VALUES (
   :frm_QueryEditor.colKODZ,
   :frm_QueryEditor.colID,
   :frm_QueryEditor.colNAME,
   :frm_QueryEditor.colBINDVARS,
   :frm_QueryEditor.colDEFAULT_VARS,
   :frm_QueryEditor.colFORM_PROC,
   :frm_QueryEditor.colKODR,
   :frm_QueryEditor.colNAMEF,
   :frm_QueryEditor.colCREATE_STMT,
   :frm_QueryEditor.colRPT_TEMPLATE,
   :frm_QueryEditor.nUserId,
   :frm_QueryEditor.colBIND_SQL,
   empty_clob(),
   :frm_QueryEditor.colPKey)"
.head 4 -  Set sUpdate =
"UPDATE ZAPROS SET  
   NAME         = :frm_QueryEditor.colNAME,
   BINDVARS     = :frm_QueryEditor.colBINDVARS,
   DEFAULT_VARS = :frm_QueryEditor.colDEFAULT_VARS,
   FORM_PROC    = :frm_QueryEditor.colFORM_PROC,
   KODR         = :frm_QueryEditor.colKODR,
   NAMEF        = :frm_QueryEditor.colNAMEF,
   CREATE_STMT  = :frm_QueryEditor.colCREATE_STMT,
   RPT_TEMPLATE = :frm_QueryEditor.colRPT_TEMPLATE,
   CREATOR      = :frm_QueryEditor.colCREATOR_ID ,
   BIND_SQL     = :frm_QueryEditor.colBIND_SQL,
   PKEY         = :frm_QueryEditor.colPKey
 WHERE
   KODZ = :frm_QueryEditor.colKODZ"
.head 4 -  !
.head 4 -  ! удаление строк из связанных таблиц
.head 4 -  Set sDeleteConstrSql = 
  "delete from zapros_users where kodz=:frm_QueryEditor.colKODZ"
.head 4 -  !
.head 4 +  If Option = EDIT_MODE_BARS
.head 5 -  Set bVSSuse=1
.head 5 -  Call VSSinitParams()
.head 5 +  If bVSSuse = 1
.head 6 -  Call VSSWork(VSS_SHOW_USERCHECKED, '')
.head 4 -  !
.head 4 -  !
.head 3 +  On SAM_FetchRowDone
.head 4 -  ! Здесь мы сливаем значение CREATE_STMT в одну колонку
.head 4 -  Set colCREATE_STMT  = colCREATE_STMT || colCREATE_STMT2
.head 4 -  Set colCREATE_STMT2 = ''
.head 4 -  !
.head 4 -  !
.head 4 +  If Option = EDIT_MODE_BARS and bVSSuse
.head 5 -  Set i=0
.head 5 +  While i<nCheckedCnt
.head 6 +  If colPKey = QE_GetPKeyFormFileName(sCheckedFiles[i])
.head 7 -  Set frm_QueryEditor.colWhoChecked = sCheckedUsers[i]
.head 7 +  If SalStrUpperX(sVSSUser) = SalStrUpperX(sCheckedUsers[i])
.head 8 -  Call XSalTblSetRowBackColor( hWndForm, lParam, getColorForRow(VSS_STATUS_CHECKED_BY_USER) )
.head 7 +  Else
.head 8 -  Call XSalTblSetRowBackColor( hWndForm, lParam, getColorForRow(VSS_STATUS_CHECKED))
.head 7 -  Break
.head 6 +  Else
.head 7 -  Set frm_QueryEditor.colWhoChecked = ''
.head 6 -  Set i=i+1
.head 5 -  !
.head 5 -  !
.head 5 -  ! Покрасим файлы, которых нету в VSS
.head 5 -  ! Call VSSWork(VSS_CHECK_STATUS, colPKey)
.head 5 -  ! Set colVSSStatus = nVSSStatus
.head 5 +  ! If nVSSStatus = VSS_STATUS_UNKNOWN or VSS_STATUS_NOT_FOUND
.head 6 -   Call XSalTblSetRowBackColor( hWndForm, lParam, getColorForRow(VSS_STATUS_NOT_FOUND))
.head 4 -  !
.head 4 -  ! Call Debug(colBIND_SQL)
.head 3 +  On UM_Insert
.head 4 -  ! Получаем значение PK из последовательности
.head 4 -  Call SalSendClassMessage(UM_Insert, 0, 0)
.head 4 -  Call SqlPrepareAndExecute(cAux.hSql(), "SELECT bars_sqnc.get_nextval('s_zapros') INTO :colKODZ FROM dual")
.head 4 -  Call SqlFetchNext(cAux.hSql(), nTmp)
.head 4 -  Call SqlClose(cAux.hSql())
.head 3 +  On UM_Update
.head 4 -  Set nRow = TBL_MinRow
.head 4 +  While SalTblFindNextRow(hWndForm, nRow, ROW_New | ROW_Edited, 0)
.head 5 -  Call SalTblSetContext(hWndForm, nRow)
.head 5 +  If SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
.head 6 -  Call SqlPrepareAndExecute(hSql(), sInsert)
.head 5 +  Else If SalTblQueryRowFlags(hWndForm, nRow, ROW_Edited)
.head 6 -  Call SqlPrepareAndExecute(hSql(), sUpdate)
.head 5 +  If colFlEditTXT
.head 6 +  If colTXT
.head 7 -  Call PutStringToClob(hSql(), colTXT, 'zapros', 'kodz', 'txt', colKODZ, '', '', 0)
.head 6 +  Else
.head 7 -  Call SqlPrepareAndExecute(hSql(), "update zapros set txt=empty_clob() where kodz=:colKODZ")
.head 4 -  !
.head 4 -  ! если удаление - удалить строки из связанных таблиц
.head 4 -  Set nRow = TBL_MinRow
.head 4 +  While SalTblFindNextRow(hWndForm, nRow, ROW_MarkDeleted, 0)
.head 5 -  Call SalTblSetContext(hWndForm, nRow)
.head 5 -  Call SqlPrepareAndExecute(hSql(), sDeleteConstrSql)
.head 4 -  !
.head 4 -  Call SalSendClassMessage(UM_Update, 0, 0)
.head 3 +  On WM_KeyDown
.head 4 -  ! Ctrl pressed
.head 4 +  If lParam & 24
.head 5 -  ! Ctrl+C
.head 5 +  If wParam = 67
.head 6 -  Call Debug('Ctrl+C')
.head 5 -  ! Ctrl+V
.head 5 +  If wParam = 86
.head 6 -  Call Debug('Ctrl+V')
.head 3 +  On SAM_Destroy
.head 4 -  Set fEditorStarted = FALSE
.head 3 +  On SAM_RowHeaderClick
.head 4 -  Call XSalTooltipSetColors(COLOR_Blue, COLOR_LightGray)
.head 4 -  Set sToolTipText = UsedByTasks(frm_QueryEditor.colKODZ)
.head 4 +  If Option = EDIT_MODE_BARS 
.head 5 +  If SalStrUpperX(frm_QueryEditor.colWhoChecked) = SalStrUpperX(sVSSUser)
.head 6 -  Set sToolTipText  = sToolTipText||' (запрос блокирован вами)'
.head 5 +  Else
.head 6 +  If frm_QueryEditor.colWhoChecked != STRING_Null 
.head 7 -  Set sToolTipText  = sToolTipText||' (запрос блокирован пользователем '||frm_QueryEditor.colWhoChecked||')'
.head 4 -  Call XSalTooltipShow(hWndForm, sToolTipText)
.head 4 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 3 +  On SAM_ContextMenu
.head 4 +  If Option = EDIT_MODE_BARS and bVSSuse
.head 5 -  Set VSSAlreadyChecked=0
.head 5 -  Set VSSAlreadyExist=0
.head 5 +  If SalStrLength(colWhoChecked)>0
.head 6 +  If SalStrUpperX(sVSSUser) = SalStrUpperX(colWhoChecked)
.head 7 -  Set VSSAlreadyChecked=1
.head 7 -  Set VSSAlreadyExist=1
.head 7 -  Call SalTrackPopupMenu (frm_QueryEditor, 'menu_VSSWork', TPM_CursorX | TPM_CursorY | TPM_CenterAlign, 0,0)
.head 6 +  Else
.head 7 -  Call XSalTooltipSetColors(COLOR_Blue, COLOR_LightGray)
.head 7 -  Call XSalTooltipShow(hWndForm, 'Запрос блокирован пользователем '||colWhoChecked)
.head 7 -  Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
.head 5 +  Else
.head 6 -  Call SalTrackPopupMenu (frm_QueryEditor, 'menu_VSSWork', TPM_CursorX | TPM_CursorY | TPM_CenterAlign, 0,0)
.head 1 +  Dialog Box: dlg_ExpQuery
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Параметры экспорта кат. запроса
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  5.567"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.976"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Check Box: cbIsReportInset
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Создать запись в табл. отчетов
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.655"
.head 5 -  Width:  3.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If cbIsReportInset=1
.head 7 -  Call SalEnableWindow(rbDynRepNumber)
.head 7 -  Call SalEnableWindow(rbFixRepNumber)
.head 7 -  Call SalEnableWindow(rbRepTypeFromExists)
.head 7 -  Call SalEnableWindow(rbRepTypeChoose)
.head 7 +  If rbRepTypeFromExists
.head 8 -  Call SalDisableWindow(cmbRepType)
.head 7 +  Else
.head 8 -  Call SalEnableWindow(cmbRepType)
.head 7 -  !
.head 7 +  If rbDynRepNumber
.head 8 -  Call SalDisableWindow(dfRepNumber)
.head 7 +  Else
.head 8 -  Call SalEnableWindow(dfRepNumber)
.head 6 +  Else
.head 7 -  Call SalDisableWindow(rbDynRepNumber)
.head 7 -  Call SalDisableWindow(rbFixRepNumber)
.head 7 -  Call SalDisableWindow(dfRepNumber)
.head 7 -  Call SalDisableWindow(cmbRepType)
.head 7 -  Call SalDisableWindow(rbRepTypeFromExists)
.head 7 -  Call SalDisableWindow(rbRepTypeChoose)
.head 3 +  Radio Button: rbDynRepNumber
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: динамический № отчета
.head 4 -  Window Location and Size
.head 5 -  Left:   0.433"
.head 5 -  Top:    1.202"
.head 5 -  Width:  3.25"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If rbDynRepNumber
.head 7 -  Call SalDisableWindow (dfRepNumber)
.head 7 -  ! Call SalDisableWindow (cbIsReplace)
.head 7 -  Set dfRepNumber=NUMBER_Null
.head 3 +  Radio Button: rbFixRepNumber
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: фиксированный № отчета
.head 4 -  Window Location and Size
.head 5 -  Left:   0.433"
.head 5 -  Top:    1.417"
.head 5 -  Width:  3.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If rbFixRepNumber
.head 7 -  Call SalEnableWindow (dfRepNumber)
.head 7 -  ! Call SalEnableWindow (cbIsReplace)
.head 6 +  Else
.head 7 -  Set dfRepNumber=NUMBER_Null
.head 7 -  Call SalDisableWindow (dfRepNumber)
.head 3 +  Data Field: dfRepNumber
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.683"
.head 6 -  Top:    1.75"
.head 6 -  Width:  2.2"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Имя файла експорта
.head 4 -  Resource Id: 63643
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.119"
.head 5 -  Width:  1.85"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfExpFileName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.1"
.head 6 -  Top:    0.31"
.head 6 -  Width:  5.083"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отменить
.head 4 -  Window Location and Size
.head 5 -  Left:   2.783"
.head 5 -  Top:    4.071"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog ( hWndForm, nRet )
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ок
.head 4 -  Window Location and Size
.head 5 -  Left:   1.283"
.head 5 -  Top:    4.071"
.head 5 -  Width:  1.317"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\APPLY.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set sPrnPath = dfExpFileName
.head 6 -  Set nRet = TRUE
.head 6 +  If rbRepTypeFromExists = 1
.head 7 +  If SqlPrepareAndExecute(hSql(),"
select bars_report.get_report_type(:nExpQry)
 into :nRepType
 from dual")
.head 8 -  Call SqlFetchNext(hSql(),nTmp)
.head 7 +  Else
.head 8 -  Set nRet = FALSE
.head 8 -  Call SalMessageBox('Ошибка получения  типа отчета','Внимание!',0)
.head 6 +  Else
.head 7 -  Set nRepType = cmbRepType.GetKey( SalListQuerySelection( cmbRepType))
.head 6 -  !
.head 6 +  If nRet
.head 7 -  Set nRet = QE_ExpOneQuery(nExpQry, cbIsReportInset, dfRepNumber, nRepType, nRepFolder, OF_Create,  sPrnPath,  sErrMsg)
.head 6 -  Call SalEndDialog(hWndForm, nRet)
.head 6 -  !
.head 3 -  Frame
.head 4 -  Resource Id: 63646
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.017"
.head 5 -  Top:    -0.012"
.head 5 -  Width:  5.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 4.0"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Папка отчета:
.head 4 -  Resource Id: 54377
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.35"
.head 5 -  Top:    3.202"
.head 5 -  Width:  2.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Combo Box: cmbRepFolder
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.783"
.head 5 -  Top:    3.44"
.head 5 -  Width:  4.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.345"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 -  Call SalSendMsg( hWndItem, SAM_User, 0, 0 )
.head 5 +  ! On SAM_User
.head 6 -  Call cmbRepType.Init( hWndItem )
.head 6 -  Call SalListClear( hWndItem )
.head 6 -  ! Call cmbRepType.Add( 1, 'DBF-DOS формат(пересоздание файла)' )
.head 6 -  ! Call cmbRepType.Add( 2, 'DBF-WIN формат(пересоздание файла)' )
.head 6 -  ! Call cmbRepType.Add( 3, 'Текстовый отчет по шаблону QRP' )
.head 6 -  ! Call cmbRepType.Add( 4, 'DBF-DOS формат(дополнение файла)' )
.head 6 -  ! Call cmbRepType.Add( 5, 'DBF-WIN формат(дополнение файла)' )
.head 6 -  ! Call cmbRepType.Add( 6, 'RTF формат по шаблону QRP' )
.head 6 -  ! Call cmbRepType.Add( 7, 'Форматированный с разделителями' )
.head 6 -  Call cmbRepType.Add( 1, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType1') )
.head 6 -  Call cmbRepType.Add( 2, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType2') )
.head 6 -  Call cmbRepType.Add( 3, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType3') )
.head 6 -  Call cmbRepType.Add( 4, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType4') )
.head 6 -  Call cmbRepType.Add( 5, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType5') )
.head 6 -  Call cmbRepType.Add( 6, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType6') )
.head 6 -  Call cmbRepType.Add( 7, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType7') )
.head 6 -  Call cmbRepType.Add( 11, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType11') )
.head 6 -  Call cmbRepType.Add( 12, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType12') )
.head 6 -  Call cmbRepType.Add( 13, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType13') )
.head 6 -  Call cmbRepType.SetSelectById( nType )
.head 6 -  !
.head 5 +  ! On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, 0, 0 )
.head 6 -  Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 5 +  On SAM_Create
.head 6 +  If cmbRepFolder.Init( hWndItem )
.head 7 -  Call cmbRepFolder.Populate(hSql(), 'IDF','NAME', 'REPORTSF','ORDER BY IDF' )
.head 5 +  On SAM_Click
.head 6 -  Set nRepFolder = cmbRepFolder.GetKey( SalListQuerySelection(cmbRepFolder) )
.head 3 +  Combo Box: cmbRepType
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.75"
.head 5 -  Top:    2.81"
.head 5 -  Width:  4.533"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.655"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsg( hWndItem, SAM_User, 0, 0 )
.head 5 +  On SAM_User
.head 6 -  Call cmbRepType.Init( hWndItem )
.head 6 -  Call SalListClear( hWndItem )
.head 6 -  Call cmbRepType.Add( 1, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType1') )
.head 6 -  Call cmbRepType.Add( 2, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType2') )
.head 6 -  Call cmbRepType.Add( 3, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType3') )
.head 6 -  Call cmbRepType.Add( 4, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType4') )
.head 6 -  Call cmbRepType.Add( 5, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType5') )
.head 6 -  Call cmbRepType.Add( 6, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType6') )
.head 6 -  Call cmbRepType.Add( 7, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType7') )
.head 6 -  Call cmbRepType.Add( 11, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType11') )
.head 6 -  Call cmbRepType.Add( 12, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType12') )
.head 6 -  !
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, 0, 0 )
.head 6 -  Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 3 -  Background Text: Номер отчета:
.head 4 -  Resource Id: 24549
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.35"
.head 5 -  Top:    0.952"
.head 5 -  Width:  2.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 63647
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.117"
.head 5 -  Top:    3.988"
.head 5 -  Width:  5.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.667"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Тип отчета:
.head 4 -  Resource Id: 24550
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    2.012"
.head 5 -  Width:  2.6"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbRepTypeFromExists
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Существующий из печатного отчета
.head 4 -  Window Location and Size
.head 5 -  Left:   0.433"
.head 5 -  Top:    2.226"
.head 5 -  Width:  4.25"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If rbRepTypeFromExists
.head 7 -  Call SalDisableWindow (cmbRepType)
.head 3 +  Radio Button: rbRepTypeChoose
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выбрать:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.433"
.head 5 -  Top:    2.44"
.head 5 -  Width:  3.15"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If rbRepTypeChoose
.head 7 -  Call SalEnableWindow (cmbRepType)
.head 6 +  Else
.head 7 -  Call SalDisableWindow (cmbRepType)
.head 2 +  Functions
.head 3 +  Function: InitOnCreate
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call SalEnableWindow (dfRepNumber)
.head 2 +  Window Parameters
.head 3 -  Number: nExpQry
.head 3 -  String: sExpPKey
.head 3 -  String: sExpQryName
.head 3 -  Number: nExpConstrQry  !-- номер связанного запроса
.head 3 -  String: sExportDirectory  ! Если указана директория выгрузки - значит убрать возможность редактировать ее
.head 2 +  Window Variables
.head 3 -  String: sPrnPath
.head 3 -  String: sErrMsg
.head 3 -  Number: nRet
.head 3 -  Number: nRepType
.head 3 -  Number: nRepFolder
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText ( hWndForm, CurrentLangTable.GetAtomTitle('dlg_ExpQuery.cTWndTitle'))
.head 4 -  Set rbRepTypeFromExists = 1
.head 4 -  ! Call SalDisableWindow(cbIsReplace)
.head 4 -  !
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalDisableWindow (dfRepNumber)
.head 4 -  Call SalDisableWindow (cmbRepType)
.head 4 +  If (SalStrLength(sExportDirectory)>0)
.head 5 -  Set sPrnPath= sExportDirectory
.head 5 -  Call SalDisableWindow ( dfExpFileName)
.head 4 +  Else
.head 5 -  Set sPrnPath=  GetPrnDir()
.head 4 -  Set dfExpFileName=sPrnPath||'\\'||QE_GetExpFileNameByPK(sExpPKey)
.head 4 -  Set cbIsReportInset=1
.head 4 -  !
.head 4 -  !
.head 4 +  If SqlPrepareAndExecute(hSql(),"
select bars_report.get_report_folder(:nExpQry)
 into :nRepFolder from dual")
.head 5 -  Call SqlFetchNext(hSql(),nTmp)
.head 4 -  !
.head 4 +  If nRepFolder != NUMBER_Null
.head 5 -  Call cmbRepFolder.SetSelectById(nRepFolder)
.head 4 -  !
.head 4 -  !
.head 4 -  Call SalCenterWindow(hWndForm)
.head 1 +  Dialog Box: dlg_MemoEditor
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.975"
.head 4 -  Top:    1.354"
.head 4 -  Width:  11.133"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.512"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Multiline Field: mlEditor
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10000
.head 5 -  String Type: Long String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   -0.017"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  11.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 5.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Courier New
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Set fEdited = TRUE
.head 3 +  Pushbutton: pb1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ok
.head 4 -  Window Location and Size
.head 5 -  Left:   6.633"
.head 5 -  Top:    9.0"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(dlg_MemoEditor, SAM_Close, 0, 0)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: Title
.head 3 -  Receive Boolean: fEdited
.head 3 -  Receive Long String: SQLText
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowText(hWndForm, Title)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set mlEditor = SQLText
.head 4 -  Set fEdited  = FALSE
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSetFocus(pb1)
.head 3 +  On SAM_Close
.head 4 +  If fEdited
.head 5 -  ! If SalMessageBox( 'Сохранить изменения?', 'Редактирование', 
MB_YesNo | MB_IconQuestion | MB_DefButton1 ) = IDYES
.head 5 +  If SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_MemoEditor.cTSave'), 
  CurrentLangTable.GetAtomTitle('dlg_MemoEditor.cTEdit'), 
  MB_YesNo | MB_IconQuestion | MB_DefButton1) = IDYES
.head 6 -  Set SQLText = mlEditor
.head 5 +  Else
.head 6 -  Set fEdited = FALSE
.head 1 +  Dialog Box: dlg_MemoViewer
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.975"
.head 4 -  Top:    1.354"
.head 4 -  Width:  11.133"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.512"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Multiline Field: mlEditor
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 10000
.head 5 -  String Type: Long String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   -0.017"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  11.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 5.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Courier New
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Gray
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set SQLText = mlEditor 
.head 5 +  On SAM_AnyEdit
.head 6 -  Set mlEditor =SQLText 
.head 3 +  Pushbutton: pb1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ok
.head 4 -  Window Location and Size
.head 5 -  Left:   6.633"
.head 5 -  Top:    9.0"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalSendMsg(dlg_MemoViewer, SAM_Close, 0, 0)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: Title
.head 3 -  Receive Long String: SQLText
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowText(hWndForm, Title)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set mlEditor = SQLText
.head 4 -  ! Call SalDisableWindow(mlEditor)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSetFocus(pb1)
.head 1 +  ! cGenericTableDlg: dlg_ZaprosUsers
.winattr class Dialog Box:
.head 2 -  Class: cGenericTableDlg
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Пользователи,  имеющие доступ к выполнению
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   1.963"
.head 4 -  Top:    2.188"
.head 4 -  Width:  9.55"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.869"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.end
.head 2 -   Description: 
.head 2 +   Tool Bar 
.head 3 +   Contents 
.head 4 +   Pushbutton: pbIns
.head 5 -   Message Actions 
.head 4 +   Pushbutton: pbDel
.head 5 -   Message Actions 
.head 4 +   Pushbutton: pbRefresh
.head 5 -   Message Actions 
.head 4 +   Pushbutton: pbUpdate
.head 5 -   Message Actions 
.head 4 -   Line 
.head 4 +   Pushbutton: pbSearch
.head 5 -   Message Actions 
.head 4 +   Pushbutton: pbFilter
.head 5 -   Message Actions 
.head 4 +   Pushbutton: pbPrint
.head 5 -   Message Actions 
.head 4 -   Line 
.head 4 +   Pushbutton: pbOk
.head 5 +   Message Actions 
.head 6 +   On SAM_Click
.head 7 -   Call SalSendClassMessage(SAM_Click, 0, 0)
.head 4 +   Pushbutton: pbExit
.head 5 -   Message Actions 
.head 4 -   Line 
.head 2 +   Contents 
.head 3 +   Child Table: tbl
.head 4 +   Contents 
.head 5 +   Column: colID
.head 6 -   List Values 
.head 6 -   Message Actions 
.head 5 +   Column: colFIO
.head 6 -   List Values 
.head 6 -   Message Actions 
.head 4 -   Functions 
.head 4 -   Window Variables 
.head 4 +   Message Actions 
.head 5 +  ! On UM_Populate
.head 6 -   Call SalSendClassMessage(UM_Populate, 0, 0)
.head 6 -   Set nTmp = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 6 -   Call SalTblSetContext(hWndForm, nTmp)
.head 6 -   Call SalTblSetRowFlags(hWndForm, nTmp, ROW_New, FALSE)
.head 6 -   Call SalTblSetContext(hWndForm, 0)
.head 2 -   Functions 
.head 2 +   Window Parameters 
.head 3 -   Number: nKodz
.head 2 +   Window Variables 
.head 3 -   Number: nTmp
.head 2 +   Message Actions 
.head 3 +   On SAM_Create
.head 4 -   Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -   Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_Users.cTWndTitle'))
.head 4 -   Call PrepareWindowEx(hWndForm)
.head 4 -   Call DebugN(nKodz)
.head 4 -   Set strSqlPopulate = 
"select id, fio into :dlg_Users.tbl.colID, :dlg_Users.tbl.colFIO 
 from staff s, zapros_users zu 
 where s.id=zu.user_id and kodz="||SalNumberToStrX(nKodz,0)
.head 4 -   Set strSqlInsert = ""
.head 4 -   Set strSqlUpdate = ""
.head 4 -   Set strSqlDelete = "delete from zapros_users where kodz=:nKodz and user_id=:tbl.colID"
.head 4 -   Set strFilterTblName = "STAFF"
.head 4 -   Set strPrintFileName = ""
.head 4 -   Set nFlags = GT_ReadOnly
.head 4 -   Call SalSendClassMessage(UM_Create, 0, 0)
.head 1 +  ! Dialog Box: dlg_ExpQuery
.winattr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Параметры экспорта кат. запроса
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  4.567"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.25"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.end
.head 2 -     Description: 
.head 2 +     Tool Bar 
.head 3 -     Contents 
.head 2 +     Contents 
.head 3 +     Check Box: cbIsReportInset
.head 4 +     Message Actions 
.head 5 +     On SAM_Click
.head 6 +     If cbIsReportInset=1
.head 7 -     Call SalEnableWindow(rbDynRepNumber)
.head 7 -     Call SalEnableWindow(rbFixRepNumber)
.head 7 +     If not rbFixRepNumber
.head 8 -     Call SalDisableWindow(dfRepNumber)
.head 7 +     Else 
.head 8 -     Call SalEnableWindow(dfRepNumber)
.head 6 +     Else 
.head 7 -     Call SalDisableWindow(rbDynRepNumber)
.head 7 -     Call SalDisableWindow(rbFixRepNumber)
.head 7 -     Call SalDisableWindow(dfRepNumber)
.head 3 +     Radio Button: rbDynRepNumber
.head 4 +     Message Actions 
.head 5 +     On SAM_Click
.head 6 +     If rbDynRepNumber
.head 7 -     Call SalDisableWindow (dfRepNumber) 
.head 7 -     Set dfRepNumber=NUMBER_Null 
.head 3 +     Radio Button: rbFixRepNumber
.head 4 +     Message Actions 
.head 5 +     On SAM_Click
.head 6 +     If rbFixRepNumber
.head 7 -     Call SalEnableWindow (dfRepNumber) 
.head 6 +     Else 
.head 7 -     Set dfRepNumber=NUMBER_Null 
.head 7 -     Call SalDisableWindow (dfRepNumber) 
.head 3 +     Data Field: dfRepNumber
.head 4 -     Message Actions 
.head 3 -     Background Text: Имя файла експорта
.head 3 +     Data Field: bgExpFileName
.head 4 -     Message Actions 
.head 3 +     Data Field: dfExpFileName
.head 4 -     Message Actions 
.head 3 -     Background Text: Имя файла шаблона для експорта
.head 3 +     Data Field: bgExpTemplateName
.head 4 -     Message Actions 
.head 3 +     Data Field: dfExpTemplateName
.head 4 -     Message Actions 
.head 3 +     Pushbutton: pbCancel
.head 4 +     Message Actions 
.head 5 +     On SAM_Click
.head 6 -     Call SalEndDialog ( hWndForm, nRet )
.head 3 +     Pushbutton: pbOk
.head 4 +     Message Actions 
.head 5 +     On SAM_Click
.head 6 -     Set sPrnPath = dfExpFileName
.head 6 -     Set sTmplPath = dfExpTemplateName
.head 6 -     Call QE_makeExport( 
  nExpQry, sExpQryName, nExpConstrQry, sPrnPath, 
  sTmplPath, (cbIsReportInset=1), dfRepNumber)
.head 6 -     Call SalEndDialog(hWndForm, nRet)
.head 3 -     Frame 
.head 3 -     Frame 
.head 3 -     Frame 
.head 2 +     Functions 
.head 3 +     Function: InitOnCreate
.head 4 -     Description: 
.head 4 -     Returns 
.head 4 -     Parameters 
.head 4 -     Static Variables 
.head 4 -     Local variables 
.head 4 +     Actions 
.head 5 -     Call SalEnableWindow (dfRepNumber) 
.head 2 +     Window Parameters 
.head 3 -     Number: nExpQry
.head 3 -     String: sExpQryName
.head 3 -     Number: nExpConstrQry  !-- номер связанного запроса
.head 2 +     Window Variables 
.head 3 -     String: sPrnPath
.head 3 -     String: sTmplPath
.head 3 -     Number: nRet
.head 2 +     Message Actions 
.head 3 +     On SAM_Create
.head 4 -     Call SetWindowFont( hWndForm )
.head 4 -     Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -     Call SalSetWindowText ( hWndForm, CurrentLangTable.GetAtomTitle('dlg_ExpQuery.cTWndTitle'))
.head 3 +     On SAM_CreateComplete
.head 4 -     Call SalDisableWindow (dfRepNumber) 
.head 4 -     Set sPrnPath=GetPrnDir() || '\\expc' || QE_NumberToStrFormat(nExpQry,4) || '.sql'
.head 4 -     Set sTmplPath=GetTemplateDir()||'\\EXPCAT.QRC' 
.head 4 -     Set dfExpFileName=sPrnPath
.head 4 -     Set dfExpTemplateName=sTmplPath
.head 4 -     Set cbIsReportInset=1    
.head 4 -     Call SalCenterWindow(hWndForm)
.head 1 +  Dialog Box: dlg_ExpQueryEx
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Параметры экспорта кат. запроса
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  5.183"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 1.75"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Путь для сценариев отчетов
.head 4 -  Resource Id: 31420
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    0.119"
.head 5 -  Width:  4.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgExpPath
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfExpPath
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    0.31"
.head 6 -  Width:  4.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ок
.head 4 -  Window Location and Size
.head 5 -  Left:   1.1"
.head 5 -  Top:    0.81"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\APPLY.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set sPrnDir=dfExpPath
.head 6 -  Call SalEndDialog ( hWndForm, 99 )
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отменить
.head 4 -  Window Location and Size
.head 5 -  Left:   2.6"
.head 5 -  Top:    0.81"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog ( hWndForm, 0 )
.head 3 -  Frame
.head 4 -  Resource Id: 31421
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.017"
.head 5 -  Top:    0.024"
.head 5 -  Width:  5.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.631"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 31423
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.017"
.head 5 -  Top:    0.655"
.head 5 -  Width:  5.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.798"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  ! Каталог экспорта
.head 3 -  Receive String: sPrnDir
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText ( hWndForm, CurrentLangTable.GetAtomTitle('dlg_ExpQueryEx.cTWndTitle'))
.head 4 -  Set dfExpPath = sPrnDir
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalCenterWindow(hWndForm)
.head 1 +  Dialog Box: dlg_AddReport
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Добавить в отчеты
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  6.533"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.774"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Frame
.head 4 -  Resource Id: 14690
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.117"
.head 5 -  Top:    0.0"
.head 5 -  Width:  6.55"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 4.78"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Combo Box: cmbRepFolder
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    1.833"
.head 5 -  Width:  5.95"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.81"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  ! On SAM_Create
.head 6 -  Call SalSendMsg( hWndItem, SAM_User, 0, 0 )
.head 5 +  ! On SAM_User
.head 6 -  Call cmbRepType.Init( hWndItem )
.head 6 -  Call SalListClear( hWndItem )
.head 6 -  ! Call cmbRepType.Add( 1, 'DBF-DOS формат(пересоздание файла)' )
.head 6 -  ! Call cmbRepType.Add( 2, 'DBF-WIN формат(пересоздание файла)' )
.head 6 -  ! Call cmbRepType.Add( 3, 'Текстовый отчет по шаблону QRP' )
.head 6 -  ! Call cmbRepType.Add( 4, 'DBF-DOS формат(дополнение файла)' )
.head 6 -  ! Call cmbRepType.Add( 5, 'DBF-WIN формат(дополнение файла)' )
.head 6 -  ! Call cmbRepType.Add( 6, 'RTF формат по шаблону QRP' )
.head 6 -  ! Call cmbRepType.Add( 7, 'Форматированный с разделителями' )
.head 6 -  Call cmbRepType.Add( 1, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType1') )
.head 6 -  Call cmbRepType.Add( 2, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType2') )
.head 6 -  Call cmbRepType.Add( 3, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType3') )
.head 6 -  Call cmbRepType.Add( 4, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType4') )
.head 6 -  Call cmbRepType.Add( 5, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType5') )
.head 6 -  Call cmbRepType.Add( 6, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType6') )
.head 6 -  Call cmbRepType.Add( 7, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType7') )
.head 6 -  Call cmbRepType.Add( 11, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType11') )
.head 6 -  Call cmbRepType.Add( 12, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType12') )
.head 6 -  Call cmbRepType.Add( 13, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType13') )
.head 6 -  Call cmbRepType.SetSelectById( nType )
.head 6 -  !
.head 5 +  ! On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, 0, 0 )
.head 6 -  Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 5 +  On SAM_Create
.head 6 +  If cmbRepFolder.Init( hWndItem )
.head 7 -  Call cmbRepFolder.Populate(hSql(), 'IDF','NAME', 'REPORTSF','ORDER BY IDF' )
.head 5 +  On SAM_Click
.head 6 -  Set nRepFolder = cmbRepFolder.GetKey( SalListQuerySelection(cmbRepFolder) )
.head 3 -  Background Text: Папка отчета
.head 4 -  Resource Id: 54944
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    1.643"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Наименование отчета
.head 4 -  Resource Id: 14695
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.155"
.head 5 -  Width:  2.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: sName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.31"
.head 6 -  Width:  5.95"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Номер отчета
.head 4 -  Resource Id: 14696
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.619"
.head 5 -  Width:  2.1"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgKod
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: nKod
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.774"
.head 6 -  Width:  2.133"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Маска файла отчета
.head 4 -  Resource Id: 14693
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    1.119"
.head 5 -  Width:  3.267"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgMask
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: sMask
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    1.274"
.head 6 -  Width:  5.95"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  ! Group Box: Отчет
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.233"
.head 5 -  Top:    1.631"
.head 5 -  Width:  5.95"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.536"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.end
.head 3 -  Background Text: Отчет
.head 4 -  Resource Id: 49451
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.233"
.head 5 -  Top:    2.119"
.head 5 -  Width:  1.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgRep
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbPeriod
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: За период
.head 4 -  Window Location and Size
.head 5 -  Left:   0.333"
.head 5 -  Top:    2.476"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbNoDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Без дат
.head 4 -  Window Location and Size
.head 5 -  Left:   4.233"
.head 5 -  Top:    2.476"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbByDay
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: За день
.head 4 -  Window Location and Size
.head 5 -  Left:   2.283"
.head 5 -  Top:    2.476"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Background Text: Умолчательные параметры 
.head 4 -  Resource Id: 14692
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    2.917"
.head 5 -  Width:  3.267"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDefParams
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Data Field: dfDefParams
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    3.071"
.head 6 -  Width:  5.95"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 14699
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    3.393"
.head 5 -  Width:  5.95"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.643"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Check Box: cbShowWnd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Воспроизводить окно ввода параметров
.head 4 -  Window Location and Size
.head 5 -  Left:   0.333"
.head 5 -  Top:    3.464"
.head 5 -  Width:  4.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbFileName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Испоьзовать заданное имя файла отчета
.head 4 -  Window Location and Size
.head 5 -  Left:   0.333"
.head 5 -  Top:    3.714"
.head 5 -  Width:  4.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 -  Background Text: Формат исходящего файла отчета
.head 4 -  Resource Id: 14691
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    4.167"
.head 5 -  Width:  3.267"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.179"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgRepType
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbRepType
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    4.393"
.head 5 -  Width:  5.95"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.19"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsg( hWndItem, SAM_User, 0, 0 )
.head 5 +  On SAM_User
.head 6 -  Call cmbRepType.Init( hWndItem )
.head 6 -  Call SalListClear( hWndItem )
.head 6 -  Call cmbRepType.Add( 1, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType1') )
.head 6 -  Call cmbRepType.Add( 2, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType2') )
.head 6 -  Call cmbRepType.Add( 3, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType3') )
.head 6 -  Call cmbRepType.Add( 4, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType4') )
.head 6 -  Call cmbRepType.Add( 5, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType5') )
.head 6 -  Call cmbRepType.Add( 6, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType6') )
.head 6 -  Call cmbRepType.Add( 7, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType7') )
.head 6 -  Call cmbRepType.Add( 11, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType11') )
.head 6 -  Call cmbRepType.Add( 12, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType12') )
.head 6 -  Call cmbRepType.Add( 13, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTRepType13') )
.head 6 -  Call cmbRepType.SetSelectById( nType )
.head 6 -  !
.head 5 +  On SAM_Click
.head 6 -  Call SalSendClassMessage( SAM_Click, 0, 0 )
.head 6 -  Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 3 -  Frame
.head 4 -  Resource Id: 14694
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.017"
.head 5 -  Top:    4.786"
.head 5 -  Width:  6.45"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.68"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ок
.head 4 -  Window Location and Size
.head 5 -  Left:   1.483"
.head 5 -  Top:    4.893"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\APPLY.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! ! Найти строку params для печатного отчета
.head 6 -  Set nRepType = cmbRepType.GetKey( SalListQuerySelection( cmbRepType))
.head 6 +  If SqlPrepareAndExecute(hSql(),"
select substr(:nKodZ ||','||bars_report.get_report_param(kodz ,:nRepType),1,254)
into  :sParamLine
from zapros where kodz = :nKodZ")
.head 7 +  If not SqlFetchNext(hSql(),nTmp)
.head 8 -  Call SalMessageBox('Ошибка получения параметров для выгрузки кат. запроса - номер запроса не найден', 'Внимание!', MB_Ok)
.head 6 +  Else
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_AddReport.cTErrRepKod'),
  CurrentLangTable.GetAtomTitle('cTAt'),0)
.head 7 -  Return -1
.head 6 -  !
.head 6 -  !
.head 6 +  If not SqlPrepareAndExecute(hSql(), 
    "INSERT INTO reports(id, name, description, form, param, ndat, mask, idf)
     VALUES(:nKod, 'Empty' ,:sName, 'frm_UniReport', :sParamLine, :nDatNum ,:sMask, :nRepFolder) ")
.head 7 -  ! Call SalMessageBox('Невозможно создать запись для отчета','Внимание!',0)
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_AddReport.cTErrRepRow'),
  CurrentLangTable.GetAtomTitle('cTAt'),0)
.head 6 +  Else
.head 7 -  Call SqlCommit(hSql())
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_AddReport.cTMsgRepCreate'),
  CurrentLangTable.GetAtomTitle('cTAt'),0)
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cPushButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отменить
.head 4 -  Window Location and Size
.head 5 -  Left:   3.333"
.head 5 -  Top:    4.893"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.452"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog ( hWndForm, nTmp )
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    2.345"
.head 5 -  Width:  5.95"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.488"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name:
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: None
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: sRepName
.head 3 -  Number: nKodZ
.head 3 -  String: sRepMask
.head 3 -  String: sBinds
.head 3 -  Number: nType
.head 2 +  Window Variables
.head 3 -  Number: nDatNum
.head 3 -  String: sParamLine
.head 3 -  String: sVisualDlg
.head 3 -  Number: nRepType
.head 3 -  Number: nRepFolder
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( dlg_AddReport )
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText ( hWndForm, CurrentLangTable.GetAtomTitle('dlg_AddReport.cTWndTitle') || ' №'||SalNumberToStrX(nKodZ,0))
.head 4 -  Set sName=sRepName
.head 4 -  !
.head 4 -  !
.head 4 -  !
.head 4 -  ! ! Найти параметры для отчета
.head 4 +  If SqlPrepareAndExecute(hSql(),"
select
       bars_report.next_reportid,
       substr(bars_report.get_report_filemask(namef),1,50),
       bars_report.get_dates_count(bindvars),
       substr(bars_report.is_visual_dlg(bindvars),1,5),
       bars_report.get_report_folder(kodz) 
into   :nKod,
       :sMask,
       :nDatNum,
       :sVisualDlg,
       :nRepFolder
from zapros where kodz = :nKodZ")
.head 5 +  If not SqlFetchNext(hSql(),nTmp)
.head 6 -  Call SalMessageBox('Ошибка получения параметров для выгрузки кат. запроса - номер запроса не найден', 'Внимание!', MB_Ok)
.head 4 +  Else
.head 5 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_AddReport.cTErrRepKod'),
  CurrentLangTable.GetAtomTitle('cTAt'),0)
.head 5 -  Return -1
.head 4 -  !
.head 4 -  ! Период дат
.head 4 +  If nDatNum = 0
.head 5 -  Set rbNoDate = 1
.head 4 +  If nDatNum = 1
.head 5 -  Set rbByDay = 1
.head 4 +  If nDatNum = 2
.head 5 -  Set rbPeriod = 1
.head 4 -  !
.head 4 +  If nRepFolder != NUMBER_Null
.head 5 -  Call cmbRepFolder.SetSelectById(nRepFolder)
.head 4 -  !
.head 4 -  ! Диалог параметров
.head 4 +  If sVisualDlg ='TRUE'
.head 5 -  Set cbShowWnd = 1
.head 4 +  Else
.head 5 -  Set cbShowWnd = 0
.head 4 -  !
.head 1 -  ! Валютні позиції
.head 1 +  Form Window: splVal
.data CLASSPROPS
0000: 56543A53706C6974 746572002B000100 00000000000090B0 A800C8D8D8005880
0020: 7800020000000000 0000010000000100 0000000000000001 00000000
.enddata
.data CLASSPROPSSIZE
0000: 3C00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 2 -  Class: cGenericTableSpl
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Валютні позиції та еквіваленти
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.863"
.head 4 -  Top:    0.719"
.head 4 -  Width:  13.833"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 7.226"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndLost, UM_Insert, 0, 0)
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndLost, UM_Delete, 0, 0)
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 18
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 12464
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(hWndLost, UM_Clear, 0, 0)
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 31
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 12465
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 25
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 12466
.head 5 -  Class Child Ref Key: 26
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableSpl
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbUp
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.883"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \Bars98\RESOURCE\BMP\Arr1tou.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set nRow = SalTblQueryContext( tbl)
.head 7 -  Call TblCopyRow(tbl,nRow,nRow-1)
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'Переместить вверх'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('splVal.cBTipUp')
.head 4 +  Pushbutton: pbDown
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cTBarButton
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.333"
.head 6 -  Top:    0.06"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \Bars98\RESOURCE\BMP\Arr1tod.bmp
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set nRow = SalTblQueryContext( tbl )
.head 7 -  Call TblCopyRow(tbl,nRow,nRow+1)
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip = 'Переместить вниз'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('splVal.cBTipDown')
.head 2 +  Contents
.head 3 +  Custom Control: ccSplitter
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    3.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Yes
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 28
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colLcv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
ISO
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.633"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNam
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назва
валюти
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  2.683"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colUnits
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назва
коп
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 5
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.917"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colKv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
числ
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.667"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colGender
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Род
M / F
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.467"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colBas
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Базова
сума
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 15
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.183"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDig
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Коп

.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.817"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCntry
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
країни
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colGrp
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: №
групи
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.883"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colBasey
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код 
% базы
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.983"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  If SqlPrepareAndExecute( hSql(),
  "SELECT name INTO :colBaseyName FROM basey WHERE basey=:colBasey" )
.head 9 -  Return IifN( SqlFetchNext( hSql(), nFetchRes ), VALIDATE_Ok, VALIDATE_Cancel )
.head 5 +  Column: colBaseyName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наимен. 
% базы
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.333"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSortOrd
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Порядок
сортування
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS0000
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рах техн
переоцінки
бал (АП)
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.083"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS3800
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рах техн
переоцінки
бал (АКТ)
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.083"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS3801
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рах техн
переоцінки
бал (ПАС)
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.083"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS0009
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Рах техн
переоцінки
позабал(АП)
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.083"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nMinRow
.head 5 -  Number: nMaxRow
.head 5 -  Number: nTmp
.head 5 -  Number: nCurRow
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 5 +  On UM_Populate
.head 6 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 6 -  Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
.head 6 -  ! ! ! Установить на старое место
.head 6 -  Call SalTblQueryScroll(hWndForm, nTmp, nMinRow, nMaxRow)
.head 6 +  If nCurRow > nMaxRow 
.head 7 -  Set nCurRow = nMaxRow
.head 6 +  If nCurRow < 0
.head 7 -  Set nCurRow = nMinRow
.head 6 -  Call SalTblSetContext(hWndForm, nCurRow)
.head 6 -  Call SalTblSetRowFlags(hWndForm, nCurRow, ROW_Selected, TRUE)
.head 6 -  Call SalTblSetFocusRow(hWndForm, nCurRow)
.head 6 -  Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
.head 5 +  On SAM_FetchRowDone
.head 6 +  If SqlPrepareAndExecute( hSqlAux2(), 
  "SELECT acc FROM accounts where kv=:colKv and nls=:colS0000 and dazs is null" )
and not SqlFetchNext(  hSqlAux2(),  nFetchRes )
.head 7 -  Call SalTblSetCellTextColor(colS0000, COLOR_DarkRed, FALSE)
.head 6 +  If SqlPrepareAndExecute( hSqlAux2(), 
  "SELECT acc FROM accounts where kv=:colKv and nls=:colS3800 and dazs is null" )
and not SqlFetchNext(  hSqlAux2(),  nFetchRes )
.head 7 -  Call SalTblSetCellTextColor(colS3800, COLOR_DarkRed, FALSE)
.head 6 +  If SqlPrepareAndExecute( hSqlAux2(), 
  "SELECT acc FROM accounts where kv=:colKv and nls=:colS3801 and dazs is null" )
and not SqlFetchNext(  hSqlAux2(),  nFetchRes )
.head 7 -  Call SalTblSetCellTextColor(colS3801, COLOR_DarkRed, FALSE)
.head 6 +  If SqlPrepareAndExecute( hSqlAux2(), 
  "SELECT acc FROM accounts where kv=:colKv and nls=:colS0009 and dazs is null" )
and not SqlFetchNext(  hSqlAux2(),  nFetchRes )
.head 7 -  Call SalTblSetCellTextColor(colS0009, COLOR_DarkRed, FALSE)
.head 5 +  On SAM_TblDoDetails
.head 6 -  Call SalSendMsg(tbl2, UM_Populate, colKv, 0)
.head 5 +  On UM_Update
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow( hWndItem, nRow, 0, 0 )
.head 7 -  Call SalTblSetContext( hWndItem, nRow )
.head 7 +  If nRow != colSortOrd
.head 8 -  Call SqlPrepareAndExecute( cMain.hSql(),' UPDATE tabval SET skv=:nRow WHERE kv=:colKv ' )
.head 6 +  If splVal.strSqlDelete != ''
.head 7 -  Call SqlPrepare(cMain.hSql(), T(splVal.strSqlDelete))
.head 7 -  Call SalTblDoDeletes(hWndForm, cMain.hSql(), ROW_MarkDeleted)
.head 6 +  If splVal.strSqlInsert != ''
.head 7 -  Call SqlPrepare(cMain.hSql(), T(splVal.strSqlInsert))
.head 7 -  Call SalTblDoInserts(hWndForm, cMain.hSql(), TRUE)
.head 6 +  If splVal.strSqlUpdate != ''
.head 7 -  Call SqlPrepare(cMain.hSql(), T(splVal.strSqlUpdate))
.head 7 -  Call SalTblDoUpdates(hWndForm, cMain.hSql(), TRUE)
.head 6 -  Call SqlCommit(cMain.hSql())
.head 6 -  Call SalTblDefineSplitWindow(hWndForm, 0, FALSE)
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Call SalSendMsg( tbl2, UM_Update, 0, 0 )
.head 5 +  On SAM_KillFocus
.head 6 -  Set nCurRow = SalTblQueryContext(hWndForm)
.head 6 -  Set hWndLost = hWndForm
.head 5 -  ! Фильтр
.head 5 +  On UM_Clear
.head 6 +  If SetQueryFilter(tbl.cF)
.head 7 -  Call SalPostMsg(tbl, UM_Populate, 0, 0)
.head 3 +  Child Table: tbl2
.head 4 -  Class Child Ref Key: 27
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableSpl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.083"
.head 6 -  Top:    0.774"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 10000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colKv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Числ
код
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.667"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colBranch
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Отделение
.head 6 -  Visible? No
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  1.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colS3800
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Валютна
позиція
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.917"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Return IfAccExists(colS3800,colKv,colAcc3800)
.head 5 +  Column: colS3801
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Еквівалент
Вал.Поз.
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Return IfAccExists(colS3801,n980,colAcc3801)
.head 5 +  Column: colS6204
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: НКР
(переоцінка ВП
по оф.курсу)
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.65"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Return IfAccExists(colS6204,n980,colAcc6204)
.head 5 -  !
.head 5 +  Column: colS_RRD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: НКР
(дооцінка операцій
до оф.курсу) (+)
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.783"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Return IfAccExists(colS_RRD,n980,colAccRRD)
.head 5 +  Column: colS_RRR
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: НКР
(дооцінка операцій
до оф.курсу) (-)
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.733"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Return IfAccExists(colS_RRR,n980,colAccRRR)
.head 5 +  Column: colS_RRS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Реалізована
Курсова Різниця
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 14
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.883"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Return IfAccExists(colS_RRS,n980,colAccRRS)
.head 5 -  !
.head 5 +  Column: colComm
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Коментар
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.15"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAcc3800
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ID
ВП
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAcc3801
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ID
ЕКВ ВП
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAcc6204
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ID
МАРЖИ
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Return VALIDATE_Ok
.head 5 -  !
.head 5 +  Column: colAccRRD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ID
реал.МАРЖИ- дох
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAccRRR       
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ID
реал.МАРЖИ- расх
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAccRRS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: ID
МАРЖИ-спрот
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: CheckVPL
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  !
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow( tbl2, nRow, 0, ROW_MarkDeleted )
.head 8 -  Call SalTblSetContext( tbl2, nRow )
.head 8 +  If colS3800=STRING_Null or colS3801=STRING_Null or colS6204=STRING_Null
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('splVal.cTErrVP'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation)
.head 9 -  Call SalTblSetRowFlags( tbl2, nRow, ROW_Selected, TRUE )
.head 9 -  Call SalTblSetFocusRow( tbl2, nRow )
.head 9 -  Return FALSE
.head 8 +  ! If colS_RRS
.head 9 +  If colS6204 != colS_RRD
or colS6204 != colS_RRR
or colS6204  = colS_RRS
.head 10 -  ! Неверно заполнены счета курс.разниц для новой медодики расчета реализ.результата
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('splVal.cTErrRKR'), 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation)
.head 10 -  Return FALSE
.head 7 -  Return TRUE
.head 5 +  Function: IfAccExists
.head 6 -  Description: Check to see if input account in GL
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sNls
.head 7 -  Number: nKv
.head 7 -  Receive Number: nAcc
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nAccN
.head 6 +  Actions
.head 7 -  Set nAcc = NUMBER_Null
.head 7 +  If sNls = STRING_Null
.head 8 -  Return TRUE
.head 7 +  If SqlPrepareAndExecute(hSql(),"SELECT acc INTO :nAcc FROM accounts WHERE kv=:nKv AND nls=:sNls") 
and SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Return TRUE
.head 7 -  ! Не открыт счет
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('splVal.cTMsgAccNotOpen') || ' '|| sNls ||'('|| Str(nKv) ||')', 
     CurrentLangTable.GetAtomTitle('cTAt'), MB_IconExclamation )
.head 7 -  Return FALSE
.head 4 +  Window Variables
.head 5 -  String: strSqlPopulate	! Строка SQL SELECT
.head 5 -  String: strSqlInsert	! Строка SQL INSERT
.head 5 -  String: strSqlDelete	! Строка SQL DELETE
.head 5 -  String: strSqlUpdate	! Строка SQL UPDATE
.head 5 -  String: strTitleAux
.head 5 -  Number: nRow
.head 5 -  Number: n980
.head 5 -  : cMain
.head 6 -  Class: cABSConnect
.head 5 -  Number: nMinRow
.head 5 -  Number: nMaxRow
.head 5 -  Number: nTmp
.head 5 -  Number: nCurRow
.head 5 -  : cF
.head 6 -  Class: cGenFilter
.head 5 -  : cQ
.head 6 -  Class: cGenQuery
.head 5 -  String: strDSql
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call XConnectGetParams(tbl2.cMain)
.head 6 -  Set n980 = GetBaseVal()
.head 6 +  If NOT tbl2.cMain.Connect()
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call SalDestroyWindow(splVal)
.head 6 -  ! Инициализация фильтра
.head 6 -  Call tbl2.cF.Init('v_vplist', 'v_vplist')
.head 6 -  Set strSqlDelete = "DELETE FROM vp_list WHERE acc3800=:colAcc3800"
.head 6 -  Set strSqlInsert = 
"INSERT INTO vp_list(acc3800, acc3801, acc6204, comm, ACC_RRD, ACC_RRR, ACC_RRS )
 VALUES (:colAcc3800, :colAcc3801, :colAcc6204, :colComm, :colAccRRD, :colAccRRR, :colAccRRS)"
.head 6 -  Set strSqlUpdate = 
"UPDATE vp_list 
    SET acc3801=:colAcc3801, acc6204=:colAcc6204, comm=:colComm, 
        ACC_RRD=:colAccRRD, ACC_RRR=:colAccRRR, ACC_RRS=:colAccRRS 
  WHERE acc3800=:colAcc3800"
.head 5 +  On UM_Populate
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Call SalTblDefineSplitWindow(hWndItem, 0, FALSE)
.head 6 -  Set strSqlPopulate =
"SELECT kv, nls3800, nls3801, nls6204, comm, 
        acc3800,     acc3801, acc6204,
        acc_rrd, acc_rrr, acc_rrs " || IifS(nHaveTobo=2, ", branch", "") || "
   INTO :colKv,:colS3800, :colS3801, :colS6204, :colComm,
        :colAcc3800, :colAcc3801, :colAcc6204,
        :colAccRRD,  :colAccRRR,  :colAccRRS " || IifS(nHaveTobo=2, ", :colBranch", "") || "
   FROM v_vplist
  WHERE kv=" || Str(wParam) || " 
  ORDER BY " || IifS(nHaveTobo=2, "branch, ", "") || "nls3800"
.head 6 -  Call cQ.Init(strSqlPopulate)
.head 6 -  Set strDSql = cQ.GetFullSQLString(cF)
.head 6 -  Call SalTblPopulate(hWndItem, cMain.hSql(), T(strDSql), TBL_FillAll)
.head 6 -  Call VisTblAutoSizeColumn(hWndItem, hWndNULL)
.head 6 -  ! ! ! Установить на старое место
.head 6 -  Call SalTblQueryScroll(hWndItem, nTmp, nMinRow, nMaxRow)
.head 6 +  If nCurRow > nMaxRow
.head 7 -  Set nCurRow=nMaxRow
.head 6 +  If nCurRow < 0
.head 7 -  Set nCurRow=nMinRow
.head 6 -  Call SalTblSetContext(hWndItem, nCurRow)
.head 6 -  Call SalTblSetRowFlags(hWndItem, nCurRow, ROW_Selected, TRUE)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On SAM_FetchRowDone
.head 6 +  If colAccRRD != NUMBER_Null 
.head 7 -  If SqlPrepareAndExecute( hSql(),
  "SELECT nls INTO :colS_RRD from accounts where acc=:colAccRRD" )
and SqlFetchNext(hSql(), nFetchRes )
.head 6 +  If colAccRRR != NUMBER_Null 
.head 7 -  If SqlPrepareAndExecute( hSql(),
  "SELECT nls INTO :colS_RRR from accounts where acc=:colAccRRR" )
and SqlFetchNext(hSql(), nFetchRes )
.head 6 +  If colAccRRS != NUMBER_Null 
.head 7 -  If SqlPrepareAndExecute( hSql(),
  "SELECT nls INTO :colS_RRS from accounts where acc=:colAccRRS" )
and SqlFetchNext(hSql(), nFetchRes )
.head 5 +  On UM_Insert
.head 6 +  If not SalTblAnyRows(hWndItem, ROW_New, 0)
.head 7 -  Call SalTblDefineSplitWindow(hWndItem, 3, TBL_Split_Adjustable)
.head 6 -  Set nRow = SalTblInsertRow(hWndItem, TBL_MinRow)
.head 6 -  Call SalTblSetContext(hWndItem, nRow)
.head 6 -  Set colKv = tbl.colKv
.head 6 -  Call SalTblSetFocusCell(hWndItem, nRow, tbl.GetFirstEditableColumn(hWndItem), 0, 1)
.head 5 +  On UM_Delete
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
.head 7 +  If NOT SalTblQueryRowFlags(hWndItem, nRow, ROW_New)
.head 8 -  Call SalTblSetRowFlags(hWndItem, nRow, ROW_MarkDeleted,
     not SalTblQueryRowFlags(hWndItem, nRow, ROW_MarkDeleted))
.head 7 +  Else
.head 8 -  Call SalTblDeleteRow(hWndItem, nRow, TBL_NoAdjust)
.head 5 +  On UM_Update
.head 6 +  If CheckVPL()
.head 7 -  Call SaveInfoToLog(MSG_SaveDataRef() || ' ' || strTitleAux)
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 +  If strSqlDelete != ''
.head 8 -  Call SqlPrepare(cMain.hSql(), T(strSqlDelete))
.head 8 -  Call SalTblDoDeletes(hWndItem, cMain.hSql(), ROW_MarkDeleted)
.head 7 +  If strSqlInsert != ''
.head 8 -  Call SqlPrepare(cMain.hSql(), T(strSqlInsert))
.head 8 -  Call SalTblDoInserts(hWndItem, cMain.hSql(), TRUE)
.head 7 +  If strSqlUpdate != ''
.head 8 -  Call SqlPrepare(cMain.hSql(), T(strSqlUpdate))
.head 8 -  Call SalTblDoUpdates(hWndItem, cMain.hSql(), TRUE)
.head 7 -  Call SqlCommit(cMain.hSql())
.head 7 -  !
.head 6 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  On SAM_KillFocus
.head 6 -  Set hWndLost = hWndForm
.head 6 -  Set nCurRow  = SalTblQueryContext(hWndForm)
.head 5 -  ! Фильтр
.head 5 +  On UM_Clear
.head 6 +  If SetQueryFilter(cF)
.head 7 -  Call SalPostMsg(hWndForm, UM_Populate, tbl.colKv, 0)
.head 2 +  Functions
.head 3 +  Function: TblCopyRow
.head 4 -  Description: Копировать один ROW в другой
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTbl
.head 5 -  Number: nRow1
.head 5 -  Number: nRow2
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndCol
.head 5 -  Number: nCol
.head 5 -  String: sTmp1[*]
.head 5 -  String: sTmp2[*]
.head 5 -  Number: nRow1Flags
.head 5 -  Number: nRow2Flags
.head 4 +  Actions
.head 5 -  Set nCol=1
.head 5 -  Call SalTblSetContext( hWndTbl, nRow1 )
.head 5 -  Set nRow1Flags=0
.head 5 +  If SalTblQueryRowFlags( hWndTbl, nRow1, ROW_Edited )
.head 6 -  Set nRow1Flags=nRow1Flags | ROW_Edited
.head 5 +  If SalTblQueryRowFlags( hWndTbl, nRow1, ROW_New )
.head 6 -  Set nRow1Flags=nRow1Flags | ROW_New
.head 5 +  If SalTblQueryRowFlags( hWndTbl, nRow1, ROW_MarkDeleted )
.head 6 -  Set nRow1Flags=nRow1Flags | ROW_MarkDeleted
.head 5 -  Call SalTblSetRowFlags( hWndTbl, nRow1, 0xFFFF, FALSE )
.head 5 +  Loop
.head 6 -  Set hWndCol = SalTblGetColumnWindow( hWndTbl, nCol, COL_GetID )
.head 6 +  If hWndCol=hWndNULL
.head 7 -  Break
.head 6 -  Call SalFmtFieldToStr( hWndCol, sTmp1[nCol], TRUE )
.head 6 -  Set nCol=nCol+1
.head 5 -  !
.head 5 -  Set nCol=1
.head 5 -  Call SalTblSetContext( hWndTbl, nRow2 )
.head 5 -  Set nRow2Flags=0
.head 5 +  If SalTblQueryRowFlags( hWndTbl, nRow2, ROW_Edited )
.head 6 -  Set nRow2Flags=nRow2Flags | ROW_Edited
.head 5 +  If SalTblQueryRowFlags( hWndTbl, nRow2, ROW_New )
.head 6 -  Set nRow2Flags=nRow2Flags | ROW_New
.head 5 +  If SalTblQueryRowFlags( hWndTbl, nRow2, ROW_MarkDeleted )
.head 6 -  Set nRow2Flags=nRow2Flags | ROW_MarkDeleted
.head 5 -  Call SalTblSetRowFlags( hWndTbl, nRow2, 0xFFFF, FALSE )
.head 5 +  Loop
.head 6 -  Set hWndCol = SalTblGetColumnWindow( hWndTbl, nCol, COL_GetID )
.head 6 +  If hWndCol=hWndNULL
.head 7 -  Break
.head 6 -  Call SalFmtFieldToStr( hWndCol, sTmp2[nCol], TRUE )
.head 6 -  Set nCol=nCol+1
.head 5 -  !
.head 5 -  Set nCol=1
.head 5 -  Call SalTblSetContext( hWndTbl, nRow1 )
.head 5 -  Call SalTblSetRowFlags( hWndTbl, nRow1, nRow2Flags, TRUE )
.head 5 +  Loop
.head 6 -  Set hWndCol = SalTblGetColumnWindow( hWndTbl, nCol, COL_GetID )
.head 6 +  If hWndCol=hWndNULL
.head 7 -  Break
.head 6 -  Call SalFmtStrToField( hWndCol, sTmp2[nCol], TRUE )
.head 6 -  Set nCol=nCol+1
.head 5 -  !
.head 5 -  Set nCol=1
.head 5 -  Call SalTblSetContext( hWndTbl, nRow2 )
.head 5 +  Loop
.head 6 -  Set hWndCol = SalTblGetColumnWindow( hWndTbl, nCol, COL_GetID )
.head 6 +  If hWndCol=hWndNULL
.head 7 -  Break
.head 6 -  Call SalFmtStrToField( hWndCol, sTmp1[nCol], TRUE )
.head 6 -  Set nCol=nCol+1
.head 5 -  Call SalTblSetFocusRow( hWndTbl, nRow2 )
.head 5 -  Call SalTblSetRowFlags( hWndTbl, nRow2, ROW_Selected | nRow1Flags, TRUE )
.head 3 +  Function: TblHideCol
.head 4 -  Description: Hide/Show columns
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndTbl
.head 5 -  Number: nMode
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Window Handle: hWndCol
.head 5 -  Number: nCol
.head 5 -  Number: nFix
.head 4 +  Actions
.head 5 -  Set nCol=1
.head 5 -  Set nFix=SalTblQueryLockedColumns ( hWndTbl )
.head 5 +  Loop
.head 6 -  Set hWndCol = SalTblGetColumnWindow( hWndTbl, nCol, COL_GetID )
.head 6 +  If hWndCol=hWndNULL
.head 7 -  Break
.head 6 +  If nCol>nFix
.head 7 +  If nMode
.head 8 -  Call SalHideWindow( hWndCol )
.head 7 +  Else
.head 8 -  Call SalShowWindow( hWndCol )
.head 6 -  Set nCol=nCol+1
.head 2 +  Window Parameters
.head 3 -  String: strRefAccess
.head 2 +  Window Variables
.head 3 -  Number: nHaveTobo
.head 3 -  Number: nFetchRes
.head 3 -  Number: nCountry
.head 3 -  Number: nGrp
.head 3 -  Window Handle: hNextDF
.head 3 -  Number: nCol
.head 3 -  Number: nRow
.head 3 -  Number: nNkv
.head 3 -  Window Handle: hWndLost
.head 3 -  Number: nKv
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('splVal.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalTblSetTableFlags(tbl,  TBL_Flag_SingleSelection, TRUE)
.head 4 -  Call SalTblSetTableFlags(tbl2, TBL_Flag_SingleSelection, TRUE)
.head 4 -  Set nHaveTobo = GetGlobalOptionEx('HAVETOBO')
.head 4 +  If nHaveTobo = 2
.head 5 -  Call SalShowWindow(tbl2.colBranch)
.head 5 -  ! Call SalEnableWindow(tbl2.colBranch)
.head 4 -  Call tbl.cF.Init("tabval", "t")
.head 4 -  Set strSqlPopulate =
"SELECT t.KV, t.GRP, t.LCV, t.NAME, t.NOMINAL, t.DIG, t.UNIT,  t.SKV, 
        t.COUNTRY,  nvl(t.basey,0),  y.name, t.S0000, t.S3800, t.S3801, t.S0009, t.Gender
 INTO :splVal.tbl.colKv, :splVal.tbl.colGrp, :splVal.tbl.colLcv,
      :splVal.tbl.colNam,:splVal.tbl.colBas, :splVal.tbl.colDig,
      :splVal.tbl.colUnits,:splVal.tbl.colSortOrd,:splVal.tbl.colCntry,
      :splVal.tbl.colBasey, :splVal.tbl.colBaseyName, 
      :splVal.tbl.colS0000,:splVal.tbl.colS3800, :splVal.tbl.colS3801, :splVal.tbl.colS0009, 
      :splVal.tbl.colGender
 FROM tabval t, basey y 
 WHERE nvl(t.basey,0)=y.basey 
 ORDER by t.skv "
.head 4 -  Set strSqlInsert =
"INSERT INTO tabval(KV,GRP,LCV,NAME,NOMINAL,DIG,UNIT,SKV,COUNTRY, basey, 
     S0000, S3800, S3801, S0009,Gender )
 VALUES (:splVal.tbl.colKv,  :splVal.tbl.colGrp, :splVal.tbl.colLcv,
         :splVal.tbl.colNam, :splVal.tbl.colBas, :splVal.tbl.colDig,
         :splVal.tbl.colUnits,:splVal.tbl.colSortOrd,:splVal.tbl.colCntry,
         :splVal.tbl.colBasey,:splVal.tbl.colS0000, :splVal.tbl.colS3800, :splVal.tbl.colS3801, 
         :splVal.tbl.colS0009,:splVal.tbl.colGender )"
.head 4 -  Set strSqlUpdate =
"UPDATE tabval SET GRP=:splVal.tbl.colGrp,
        LCV=:splVal.tbl.colLcv,   NAME =:splVal.tbl.colNam,
    NOMINAL=:splVal.tbl.colBas,    DIG =:splVal.tbl.colDig,
       UNIT=:splVal.tbl.colUnits,  SKV =:splVal.tbl.colSortOrd,
    COUNTRY=:splVal.tbl.colCntry, basey=:splVal.tbl.colBasey,
      S0000=:splVal.tbl.colS0000, S3800=:splVal.tbl.colS3800, S3801=:splVal.tbl.colS3801,
      S0009=:splVal.tbl.colS0009,Gender=:splVal.tbl.colGender
 WHERE kv=:splVal.tbl.colKv"
.head 4 -  Set strSqlDelete =
"DELETE FROM tabval WHERE kv=:splVal.tbl.colKv"
.head 4 -  Call SalTblSetLockedColumns(hWndForm, 2)
.head 4 +  If strRefAccess = 'RO'
.head 5 -  Call TblHideCol(hWndForm, TRUE)
.head 5 -  Set nFlags = GT_NoRet | GT_ReadOnly
.head 5 -  Call SalTblSetColumnFlags(SalTblGetColumnWindow(tbl, 1, COL_GetID), COL_Editable, FALSE)
.head 5 -  Call SalTblSetColumnFlags(SalTblGetColumnWindow(tbl, 2, COL_GetID), COL_Editable, FALSE)
.head 5 -  Call SalDisableWindow(pbUp)
.head 5 -  Call SalDisableWindow(pbDown)
.head 4 +  Else
.head 5 -  ! Call TblHideCol(tbl,FALSE)
.head 5 -  Set nFlags = GT_NoRet
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call SalEnableWindow(pbFilter)
.head 3 +  ! On UM_DoubleClick
.head 4 -       Call SalModalDialog(dlgValut,hWndForm,colKv,strRefAccess)
.head 4 -       Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 1 -  ! Редактирование синхронизируемых таблиц
.head 1 +  Table Window: frm_DBFSyncEdit
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Редактирование синхронизируемых таблиц
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  17.267"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.369"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 10000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.452"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 53252
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  7.45"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  7.45"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 53255
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   7.617"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 53256
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 -  !
.head 4 +  Pushbutton: pbCheckNew
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.99"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Синхронизировать все таблицы'
.head 6 +  On SAM_Click
.head 7 -  Call SyncNew()
.head 4 -  !
.head 4 +  Pushbutton: pbImport
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.41"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Импортировать DBF файл в промежуточную таблицу'
.head 6 +  On SAM_Click
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 -  Call SalUseRegistry(FALSE, '' )
.head 7 -  Call SalGetProfileString('Import', 'Kl_Nbu', '', strPath,  GetIniFileName())
.head 7 -  Set sFilePath = strPath
.head 7 -  Set sFileName = colTBLNAMENBU || '.dbf'
.head 7 -  Set sFilePathName = sFilePath || '\\' || sFileName
.head 7 +  If VisFileFind (sFilePathName) = STRING_Null
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_DBFSyncEdit.msg.NoDBFFile')||' '||sFilePathName,
                   CurrentLangTable.GetAtomTitle('cTAt'), 
                   MB_Ok|MB_IconStop)
.head 7 +  Else
.head 8 -  Call SalFileGetDateTime(sFilePathName, dFileDate )
.head 8 -  ! Узнать последнюю дату обновления и кодироку для вібранного справочника
.head 8 +  If SqlPrepareAndExecute( cExecutor.hSql(), 
'select file_date, encode 
   into :dFileDateDB, :sDbfEncode 
   from dbf_sync_tabs where tabid=:colTABID' )
.head 9 +  If SqlFetchNext( cExecutor.hSql(), nFetchRes )
.head 10 +  If dFileDateDB != DATETIME_Null
.head 11 +  If dFileDateDB>dFileDate
.head 12 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('frm_DBFSyncEdit.msg.OldFile'),
 CurrentLangTable.GetAtomTitle('cTAt'), MB_IconQuestion | MB_YesNo )=IDNO
.head 13 -  Call SalWaitCursor(FALSE)
.head 13 -  Return FALSE
.head 11 +  Else If dFileDateDB=dFileDate
.head 12 +  If SalMessageBox( CurrentLangTable.GetAtomTitle('frm_DBFSyncEdit.msg.SameFile'),
 CurrentLangTable.GetAtomTitle('cTAt'), MB_IconQuestion | MB_YesNo )=IDNO
.head 13 -  Call SalWaitCursor(FALSE)
.head 13 -  Return FALSE
.head 8 -  !
.head 8 -  ! Создание таблицы
.head 8 +  ! If CreTabSqlFromDbf(sFilePathName, colTBLNAMENBU, TRUE, sDbfEncode)
.head 9 -  ! Модиф. дату обновления в промежуточной таблице
.head 9 +  If SqlPrepareAndExecute( cExecutor.hSql(), 
 'update dbf_sync_tabs
     set file_date = :dFileDate 
   where tabid = :colTABID' )
.head 10 -  Call SqlCommitEx( cExecutor.hSql(), 'Импорт ' ||
SalStrUpperX( colTBLNAMENBU ) || '.DBF завершен')
.head 10 +  If cFileLog.Create( strPath || '\\Import.log' )
.head 11 -  Call cFileLog.PutLog( 'Данные из ' || 
SalStrUpperX( colTBLNAMENBU ) || '.DBF проимпортированны в промежуточную таблицу!', TRUE )
.head 11 -  Call cFileLog.Free()
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_DBFSyncEdit.msg.ImpOk'),
                    CurrentLangTable.GetAtomTitle('cTAt'),
                    MB_IconExclamation )
.head 8 +  If InsertDbfDataToTable(sFileName, sFilePath, colTBLNAMENBU, sDbfEncode)
.head 9 -  ! Модиф. дату обновления в промежуточной таблице
.head 9 +  If SqlPrepareAndExecute( cExecutor.hSql(), 
 'update dbf_sync_tabs
     set file_date = :dFileDate 
   where tabid = :colTABID' )
.head 10 -  Call SqlCommitEx( cExecutor.hSql(), 'Импорт ' ||SalStrUpperX( colTBLNAMENBU ) || '.DBF завершен')
.head 10 +  If cFileLog.Create( strPath || '\\Import.log' )
.head 11 -  Call cFileLog.PutLog( 'Данные из ' || 
SalStrUpperX( colTBLNAMENBU ) || '.DBF проимпортированны в промежуточную таблицу!', TRUE )
.head 11 -  Call cFileLog.Free()
.head 10 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_DBFSyncEdit.msg.ImpOk'),
                    CurrentLangTable.GetAtomTitle('cTAt'),
                    MB_IconAsterisk)
.head 8 +  Else
.head 9 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_DBFSyncEdit.msg.ImpBad'), 
                    CurrentLangTable.GetAtomTitle('cTAt'),
                    MB_IconExclamation )
.head 7 -  Call SalWaitCursor(FALSE)
.head 4 +  Pushbutton: pbDiff
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbBrowse
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.85"
.head 6 -  Top:    0.071"
.head 6 -  Width:  0.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Просмотреть изменения между данными в основной и промежуточной таблицах'
.head 6 +  On SAM_Click
.head 7 -  Call SalWaitCursor(TRUE)
.head 7 +  If colS_SELECT
.head 8 -  Call SalCreateWindow( frm_DBFSyncDiff, hWndForm, colS_SELECT, colSEMANTIC )
.head 7 -  Call SalWaitCursor(FALSE)
.head 4 +  Pushbutton: pbSync
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSynchro
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.25"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Синхронизировать данные в основной и промежуточной таблицах'
.head 6 +  On SAM_Click
.head 7 -  Call DoSync()
.head 4 -  !
.head 4 +  Pushbutton: pbEditWithWizard
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbInsert
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.983"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\EDIT.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Редактировать синхронизируемую таблицу с помощью МАСТЕРА'
.head 6 +  On SAM_Click
.head 7 -  Call InvokeWizard(colTABID)
.head 4 +  Pushbutton: pbAddWithWizard
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbInsert
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.43"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Create.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Добавить новую синхронизируемую таблицу с помощью МАСТЕРА'
.head 6 +  On SAM_Click
.head 7 -  Call InvokeWizard(0)
.head 4 +  Pushbutton: pbExportTable
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.867"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\SAVED.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip='Экспорт выбранных таблиц в SQL сценарий'
.head 6 +  On SAM_Click
.head 7 -  ! Экспорт всех выбранных таблиц
.head 7 -  Call DoExportSelectedTables()
.head 4 -  Line
.head 5 -  Resource Id: 43988
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  5.8"
.head 6 -  Begin Y:  0.036"
.head 6 -  End X:  5.8"
.head 6 -  End Y:  0.5"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 2 +  Contents
.head 3 +  Column: colTABID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
таблицы
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.9"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colBranch
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Подразделение
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.083"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSEMANTIC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование таблицы
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 80
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.633"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If FunNSIGet( 'META_TABLES', 'SEMANTIC', sCode, sSemantic )
.head 7 -  Set colTABID=SalStrToNumber( sCode )
.head 7 -  Set colSEMANTIC=sSemantic
.head 7 -  Call SalSendMsg( frm_DBFSyncEdit, SAM_User, 0, 0 )
.head 3 +  Column: colTABNAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Имя таблицы
БД
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 38
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.733"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 +  If FunNSIGet( 'META_TABLES', 'SEMANTIC', sCode, sSemantic )
.head 7 -  Set colTABID=SalStrToNumber( sCode )
.head 7 -  Set colSEMANTIC=sSemantic
.head 7 -  Call SalSendMsg( frm_DBFSyncEdit, SAM_User, 0, 0 )
.head 3 +  Column: colTBLNAMENBU
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Имя DBF
файла
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 16
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  ! On SAM_DoubleClick
.head 6 +  If FunNSIGet( 'META_TABLES', 'SEMANTIC', sCode, sSemantic )
.head 7 -  Set colTABID=SalStrToNumber( sCode )
.head 7 -  Set colSEMANTIC=sSemantic
.head 7 -  Call SalSendMsg( frm_DBFSyncEdit, SAM_User, 0, 0 )
.head 3 +  Column: colEncode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Кодировка
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 +  List Values
.head 5 -  Text: DOS
.head 5 -  Text: WIN
.head 5 -  Text: UKG
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SalListQueryText ( hWndItem, SalListQuerySelection( hWndItem ), colEncode)
.head 3 +  Column: colS_SELECT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выражение
SQL SELECT
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4000
.head 4 -  Data Type: Long String
.head 4 -  Justify: Left
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Set lsTmp=colS_SELECT
.head 6 -  Call SalModalDialog( dlg_MemoEditor,
frm_DBFSyncEdit,
'Редактирование SQL SELECT', 
bTmp,
lsTmp )
.head 6 +  If bTmp
.head 7 -  Set colS_SELECT=lsTmp
.head 7 -  Call SalSendMsg( frm_DBFSyncEdit, SAM_User, 0, 0 )
.head 3 +  Column: colS_SELECT2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выражение
SQL SELECT
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4000
.head 4 -  Data Type: Long String
.head 4 -  Justify: Left
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS_INSERT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выражение
SQL INSERT
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4000
.head 4 -  Data Type: Long String
.head 4 -  Justify: Left
.head 4 -  Width:  1.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Set lsTmp=colS_INSERT
.head 6 -  Call SalModalDialog( dlg_MemoEditor,
frm_DBFSyncEdit,
'Редактирование SQL INSERT', 
bTmp,
lsTmp )
.head 6 +  If bTmp
.head 7 -  Set colS_INSERT=lsTmp
.head 7 -  Call SalSendMsg( frm_DBFSyncEdit, SAM_User, 0, 0 )
.head 3 +  Column: colS_INSERT2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выражение
SQL INSERT
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4000
.head 4 -  Data Type: Long String
.head 4 -  Justify: Left
.head 4 -  Width:  1.467"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Set lsTmp=colS_INSERT
.head 6 -  Call SalModalDialog( dlg_MemoEditor,
frm_DBFSyncEdit,
'Редактирование SQL INSERT', 
bTmp,
lsTmp )
.head 6 +  If bTmp
.head 7 -  Set colS_INSERT=lsTmp
.head 7 -  Call SalSendMsg( frm_DBFSyncEdit, SAM_User, 0, 0 )
.head 3 +  Column: colS_UPDATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выражение
SQL UPDATE
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4000
.head 4 -  Data Type: Long String
.head 4 -  Justify: Left
.head 4 -  Width:  1.4"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Set lsTmp=colS_UPDATE
.head 6 -  Call SalModalDialog( dlg_MemoEditor,
frm_DBFSyncEdit,
'Редактирование SQL UPDATE', 
bTmp,
lsTmp )
.head 6 +  If bTmp
.head 7 -  Set colS_UPDATE=lsTmp
.head 7 -  Call SalSendMsg( frm_DBFSyncEdit, SAM_User, 0, 0 )
.head 3 +  Column: colS_UPDATE2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выражение
SQL UPDATE
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4000
.head 4 -  Data Type: Long String
.head 4 -  Justify: Left
.head 4 -  Width:  1.4"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Set lsTmp=colS_UPDATE
.head 6 -  Call SalModalDialog( dlg_MemoEditor,
frm_DBFSyncEdit,
'Редактирование SQL UPDATE', 
bTmp,
lsTmp )
.head 6 +  If bTmp
.head 7 -  Set colS_UPDATE=lsTmp
.head 7 -  Call SalSendMsg( frm_DBFSyncEdit, SAM_User, 0, 0 )
.head 3 +  Column: colS_DELETE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выражение
SQL DELETE
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4000
.head 4 -  Data Type: Long String
.head 4 -  Justify: Left
.head 4 -  Width:  1.35"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Set lsTmp=colS_DELETE
.head 6 -  Call SalModalDialog( dlg_MemoEditor, 
frm_DBFSyncEdit,
'Редактирование SQL DELETE',
bTmp,
lsTmp )
.head 6 +  If bTmp
.head 7 -  Set colS_DELETE=lsTmp
.head 7 -  Call SalSendMsg( frm_DBFSyncEdit, SAM_User, 0, 0 )
.head 3 +  Column: colS_DELETE2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выражение
SQL DELETE
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4000
.head 4 -  Data Type: Long String
.head 4 -  Justify: Left
.head 4 -  Width:  1.35"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Set lsTmp=colS_DELETE
.head 6 -  Call SalModalDialog( dlg_MemoEditor, 
frm_DBFSyncEdit,
'Редактирование SQL DELETE',
bTmp,
lsTmp )
.head 6 +  If bTmp
.head 7 -  Set colS_DELETE=lsTmp
.head 7 -  Call SalSendMsg( frm_DBFSyncEdit, SAM_User, 0, 0 )
.head 3 +  Column: colFILE_DATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.35"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colSYNC_FLAG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.35"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: InsertDbfDataToTable
.head 4 -  Description: Создание таблиы из DBF-файла
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sFileName   ! имя dbf-файла
.head 5 -  String: sFilePath   ! путь к DBF файлу
.head 5 -  String: sTableName  ! Имя таблицы для импорта
.head 5 -  String: sEncode     !(DOS-cp866, WIN-win, UKG-укр.гост)
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nIsRecreate
.head 5 -  Number: nExists
.head 5 -  String: sErrMsg
.head 4 +  Actions
.head 5 -  ! Проверка на на наличие таблицы в БД
.head 5 +  If not SqlPLSQLCommand(hSql(), "bars_ies.tab_exists(sTableName, nExists)")
.head 6 -  Return FALSE
.head 5 +  If nExists = 1
.head 6 -  ! таблицу не пересоздавать, удалить предидущие данные
.head 6 -  Set nIsRecreate = 2  
.head 5 +  Else
.head 6 -  ! Создать новую таблицу (пересоздать)
.head 6 -  Set nIsRecreate = 1
.head 5 -  !
.head 5 -  !
.head 5 +  If ImportDbf(sFilePath,
             sFileName,
             sTableName,
             sEncode,
             nIsRecreate,
             1,
             0,            
             sErrMsg)
.head 6 -  Call SqlCommitEx(hSql(),'Выполнен импорт данных файла '||sFilePath||'\\'||sFileName||' в таблицу '||sTableName)
.head 6 -  Return TRUE
.head 5 +  Else
.head 6 -  Return FALSE
.head 3 +  Function: RemoveShit
.head 4 -  Description: Убирает переносы и лишние пробелы
в строках классификаторов
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sOri
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: Result
.head 5 -  Number: i
.head 5 -  Boolean: fWasReturn
.head 5 -  Boolean: fWasSpace
.head 5 -  Boolean: fInc
.head 4 +  Actions
.head 5 +  If SalStrLength( sOri )<15
.head 6 -  Return sOri
.head 5 -  Set i=0
.head 5 -  Set Result=''
.head 5 -  Set fWasSpace=FALSE
.head 5 -  Set fWasReturn=FALSE
.head 5 +  Loop
.head 6 +  If i>=SalStrLength( sOri )
.head 7 -  Break
.head 6 -  !
.head 6 -  Set fInc=TRUE
.head 6 -  ! If fWasReturn (i+1)<SalStrLength( sOri )
.head 6 +  If (fWasSpace OR fWasReturn) AND SalStrMidX( sOri, i, 1 )=' '
.head 7 -  Set fInc=FALSE
.head 6 +  Else If SalStrMidX( sOri, i, 1 )=' '
.head 7 -  Set fWasSpace=TRUE
.head 6 +  Else If SalStrMidX( sOri, i, 1 )='-' AND (i+1)<SalStrLength( sOri ) AND
SalStrMidX( sOri, i+1, 1 )=' '
.head 7 -  Set fWasReturn=TRUE
.head 7 -  Set fInc=FALSE
.head 6 +  Else
.head 7 -  Set fWasSpace=FALSE
.head 7 -  Set fWasReturn=FALSE
.head 6 +  If fInc
.head 7 -  Set Result = Result || SalStrMidX( sOri, i, 1 )
.head 6 -  Set i=i+1
.head 5 -  Return Result
.head 3 +  Function: DoSync
.head 4 -  Description: Выполнить синхронизацию таблицы с временной
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Boolean: fErrors
.head 5 -  : cFileLog
.head 6 -  Class: cLog
.head 5 -  String: strPath
.head 5 -  String: sErrMsg
.head 4 +  Actions
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Set fErrors=FALSE
.head 5 -  Set sErrMsg = STRING_Null
.head 5 +  Loop
.head 6 +  If colS_DELETE
.head 7 -  Set fErrors = NOT SqlPrepareAndExecute( cExecutor.hSql(), colS_DELETE )
.head 6 +  If fErrors
.head 7 -  Set sErrMsg = CurrentLangTable.GetAtomTitle('frm_DBFSyncEdit.msg.ErrDel')
.head 7 -  Break
.head 6 -  !
.head 6 -  !
.head 6 +  If colS_UPDATE
.head 7 -  Set fErrors = NOT SqlPrepareAndExecute( cExecutor.hSql(), colS_UPDATE )
.head 6 +  If fErrors
.head 7 -  Set sErrMsg = CurrentLangTable.GetAtomTitle('frm_DBFSyncEdit.msg.ErrUpd')
.head 7 -  Break
.head 6 -  !
.head 6 -  !
.head 6 +  If colS_INSERT
.head 7 -  Set fErrors = NOT SqlPrepareAndExecute( cExecutor.hSql(), colS_INSERT )
.head 6 +  If fErrors
.head 7 -  Set sErrMsg = CurrentLangTable.GetAtomTitle('frm_DBFSyncEdit.msg.ErrIns')
.head 7 -  Break
.head 6 -  Break
.head 5 -  !
.head 5 -  !
.head 5 +  If fErrors
.head 6 -  Call SalMessageBox( sErrMsg, CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop )
.head 6 -  Call SqlRollback( cExecutor.hSql() )
.head 6 -  Call SalWaitCursor(FALSE)
.head 5 +  Else
.head 6 +  If SqlPrepareAndExecute( cExecutor.hSql(), 
           'UPDATE DBF_SYNC_TABS 
               SET SYNC_FLAG = 1 
             WHERE TABID= :colTABID' )
.head 7 -  Call SqlCommitEx( cExecutor.hSql(), 'Синхронизация таблицы ' || colTABNAME || ' с dbf завершена' )
.head 7 -  Call SalUseRegistry( FALSE, '' )
.head 7 -  Call SalGetProfileString('Import', 'Kl_Nbu', '', strPath,
     GetIniFileName())
.head 7 -  Call SalUseRegistry( TRUE, '' )
.head 7 +  If cFileLog.Create( strPath || '\\Import.log' )
.head 8 -  Call cFileLog.PutLog( 'Синхронизация таблицы ' || 
colSEMANTIC || ' (' || colTABNAME || ') завершена!', TRUE )
.head 8 -  Call cFileLog.Free()
.head 7 -  Call SalWaitCursor(FALSE)
.head 7 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_DBFSyncEdit.msg.RenewOk'), 
                    CurrentLangTable.GetAtomTitle('cTAt'),  0 )
.head 3 +  Function: InvokeWizard
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nTabId
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Выбор таблицы
.head 5 +  If SalModalDialog( dlg_SyncWiz1, frm_DBFSyncEdit, nTabId )=99
.head 6 -  ! Выбор первичного ключа
.head 6 +  If SalModalDialog( dlg_SyncWiz2, frm_DBFSyncEdit )=99
.head 7 -  ! Выбор обновляемых полей
.head 7 +  If SalModalDialog( dlg_SyncWiz3, frm_DBFSyncEdit )=99
.head 8 -  ! Выбор сответствий между полями
.head 8 +  If SalModalDialog( dlg_SyncWiz4, frm_DBFSyncEdit )=99
.head 9 -  ! Выбор сответствий между полями
.head 9 +  If SalModalDialog( dlg_SyncWiz5, frm_DBFSyncEdit )=99
.head 10 -  ! Показ изменений
.head 5 -  Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 3 +  Function: SyncNew
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRow
.head 5 -  File Handle: hFile
.head 5 -  String: sDbfFilename
.head 5 -  Date/Time: dActualDate
.head 4 +  Actions
.head 5 -  Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 5 -  Set nRow=0
.head 5 +  Loop
.head 6 +  If SalTblSetContext( hWndForm, nRow )
.head 7 -  Call SalTblSetRowFlags( hWndForm, nRow, ROW_Selected, TRUE )
.head 7 -  Call SalUpdateWindow( hWndForm )
.head 7 -  ! Закачан, но не синхронизирован
.head 7 +  If NOT colSYNC_FLAG
.head 8 -  ! Синхронизируем
.head 8 -  Call SalSendMsg( pbSync, SAM_Click, 0, 0 )
.head 7 +  Else
.head 8 -  Set sDbfFilename=strPath || '\\' || colTBLNAMENBU
     || '.dbf'
.head 8 +  If SalFileGetDateTime( sDbfFilename, dActualDate )
.head 9 +  If (colFILE_DATE = DATETIME_Null) OR (colFILE_DATE<dActualDate)
.head 10 -  ! Синхронизируем
.head 10 -  Call SalSendMsg( pbImport, SAM_Click, 0, 0 )
.head 10 -  Call SalSendMsg( pbSync, SAM_Click, 0, 0 )
.head 7 -  Call SalTblSetRowFlags( hWndForm, nRow, ROW_Selected, FALSE )
.head 6 +  Else
.head 7 -  Break
.head 6 -  Set nRow=nRow+1
.head 3 +  Function: DebugD
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Date/Time: dDate
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sDate
.head 4 +  Actions
.head 5 -  Call SalDateToStr( dDate, sDate )
.head 5 -  Call Debug( sDate )
.head 3 -  !
.head 3 +  Function: DoExportSelectedTables
.head 4 -  Description: Экспорт выбранных строк в SQL сценарий
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  ! № строки и колонки для событий
.head 5 -  Number: nTmpRowNumber
.head 5 -  Number: nTmpPriRowNumber
.head 5 -  String: strTmpFileCont
.head 5 -  File Handle: hTmpFile
.head 5 -  String: strTmpFileName
.head 4 +  Actions
.head 5 +  If NOT SalTblAnyRows(hWndForm, ROW_Selected, 0)
.head 6 -  Call SalMessageBox('Ни одна строка не выбранна!', 'Ошибка', MB_IconStop | MB_Ok)
.head 6 -  Return FALSE
.head 5 -  Set nTmpPriRowNumber = SalTblQueryContext(hWndForm)
.head 5 -  Set strTmpFileName   = GetPrnDir()|| '\\exp' || SalFmtFormatDateTime( SalDateCurrent(), 'mmss' ) || '.sql'
.head 5 -  Set nTmpRowNumber = TBL_MinRow 
.head 5 -  ! Сброс массива операций - подготовка функции SG_OperToString к работе
.head 5 -  Set strTmpFileCont='SET LINES 1000
SET TRIMSPOOL ON
SET SERVEROUTPUT ON SIZE 1000000
SET FEED OFF
'
.head 5 -  Call WaitCursorOn()
.head 5 +  While TRUE
.head 6 +  If SalTblFindNextRow( hWndForm, nTmpRowNumber, ROW_Selected, 0 )
.head 7 -  Call SalTblSetContext( hWndForm, nTmpRowNumber )
.head 7 -  Set strTmpFileCont = strTmpFileCont || "

" ||
TableToString(colTABNAME, colTBLNAMENBU, colS_SELECT,
colS_INSERT, colS_UPDATE, colS_DELETE, colEncode)
.head 6 +  Else
.head 7 -  Call WaitCursorOff()
.head 7 +  If strTmpFileCont
.head 8 -  Set strTmpFileCont=strTmpFileCont || "
COMMIT;

SET FEED ON
"
.head 8 +  If SalFileOpen( hTmpFile, strTmpFileName, OF_Create | OF_ReadWrite )
.head 9 -  Call SalFileWrite( hTmpFile, strTmpFileCont, SalStrLength( strTmpFileCont ) )
.head 9 -  Call SalFileClose( hTmpFile )
.head 9 -  Call SalMessageBox( 'Строки сохранены в файле: ' || strTmpFileName, '', MB_IconAsterisk | MB_Ok )
.head 8 +  Else
.head 9 -  Call SalMessageBox( 'Не могу создать файл: ' || strTmpFileName, 'Ошибка', MB_IconStop | MB_Ok )
.head 9 -  Return FALSE
.head 7 -  Call SalTblSetContext( hWndForm, nTmpPriRowNumber )
.head 7 -  Return TRUE
.head 3 +  Function: TableToString
.head 4 -  Description: Экспорт синхр. тьаблицы в сценарий
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sTableName
.head 5 -  String: sDbfName
.head 5 -  String: sSELECT
.head 5 -  String: sINSERT
.head 5 -  String: sUPDATE
.head 5 -  String: sDELETE
.head 5 -  String: sEnCode
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sTabIdFunction
.head 5 -  String: sVariables
.head 5 -  String: sBody
.head 5 -  String: sExec
.head 4 +  Actions
.head 5 -  ! Подготовка переменных
.head 5 +  If TRUE
.head 6 -  Set sBody=''
.head 6 -  Set sExec=''
.head 6 -  Set sTabIdFunction = "FUNCTION GET_TABID (TABNAME_ VARCHAR2) RETURN NUMBER IS 
  TABID_ NUMBER;
BEGIN
  BEGIN
    SELECT TABID INTO TABID_ 
    FROM META_TABLES
    WHERE TABNAME=TABNAME_;
  EXCEPTION WHEN NO_DATA_FOUND THEN TABID_:=NULL;
  END;
  RETURN TABID_;
END;
"
.head 6 -  Set sVariables="NEW_TABID_ NUMBER;
TMP_ NUMBER;
STR_SELECT VARCHAR2(4000);
STR_INSERT VARCHAR2(4000);
STR_UPDATE VARCHAR2(4000);
STR_DELETE VARCHAR2(4000);
STR_FNAME  VARCHAR2(100);
STR_ENCODE VARCHAR2(3);
" || sTabIdFunction
.head 5 -  ! Обновление имени DBF в таблице REFERENCES
.head 5 +  ! If TRUE
.head 6 -  Set sExec=sExec || 
"-- Обновление имени DBF в таблице REFERENCES
BEGIN
  SELECT TABID INTO TMP_ FROM REFERENCES WHERE TABID=NEW_TABID_;
  UPDATE REFERENCES SET TBLNAMENBU='" || sDbfName || "' WHERE TABID=NEW_TABID_;
EXCEPTION
  WHEN NO_DATA_FOUND THEN
    INSERT INTO REFERENCES (TABID, TBLNAMENBU, TYPE, ROLE2EDIT) 
    VALUES ( NEW_TABID_, '" || sDbfName || "', 99, '" || sTableName || "');
END;
"
.head 5 -  ! Вставка или обновление синхронизируемых таблиц
.head 5 +  If TRUE
.head 6 -  ! Подготовка переменных
.head 6 -  Set sSELECT="'" || SG_CorrectScriptStr( sSELECT )
.head 6 -  Set sINSERT="'" || SG_CorrectScriptStr( sINSERT )
.head 6 -  Set sUPDATE="'" || SG_CorrectScriptStr( sUPDATE )
.head 6 -  Set sDELETE="'" || SG_CorrectScriptStr( sDELETE )
.head 6 -  Set sExec=sExec || 
"
-- Присвоение переменных

STR_SELECT:=
" || SG_IndentedResult( sSELECT,2 ) || "';

STR_INSERT:=
" || SG_IndentedResult( sINSERT,2 ) || "';

STR_UPDATE:=
" || SG_IndentedResult( sUPDATE,2 ) || "';

STR_DELETE:=
" || SG_IndentedResult( sDELETE,2 ) || "';

STR_FNAME := '" || sDbfName || "';

STR_ENCODE := '" || sEnCode || "';

"
.head 6 -  Set sExec=sExec || 
"-- Обновление выражений в DBF_SYNC_TABS
BEGIN
  SELECT TABID INTO TMP_ FROM DBF_SYNC_TABS WHERE TABID=NEW_TABID_;
  UPDATE DBF_SYNC_TABS SET 
    S_SELECT  = STR_SELECT,
    S_INSERT  = STR_INSERT,
    S_UPDATE  = STR_UPDATE,
    S_DELETE  = STR_DELETE,
    FILE_NAME = STR_FNAME,
    ENCODE    = STR_ENCODE
  WHERE TABID = NEW_TABID_;
EXCEPTION
  WHEN NO_DATA_FOUND THEN
    INSERT INTO DBF_SYNC_TABS (TABID, S_SELECT, S_INSERT, S_UPDATE, S_DELETE, FILE_NAME, ENCODE) 
    VALUES (NEW_TABID_, STR_SELECT, STR_INSERT, STR_UPDATE, STR_DELETE, STR_FNAME, STR_ENCODE);
END;
"
.head 6 -  Set sExec=sExec || 
"DBMS_OUTPUT.PUT_LINE('Таблица " || sTableName ||" внесена/обновлена в редактировании синхронизируемых таблиц');
"
.head 5 -  ! Сборка тела
.head 5 +  If TRUE
.head 6 -  ! Поиск кода таблицы
.head 6 -  Set sBody=sBody || SG_IndentedResult( 
"-- Поиск кода таблицы
NEW_TABID_ :=GET_TABID('" || sTableName || "');
IF NEW_TABID_ IS NULL THEN
  DBMS_OUTPUT.PUT_LINE('Таблица " || sTableName || " не описана в БМД!');
ELSE
" || SG_IndentedResult( sExec, 2 ) ||
"
END IF;",
2)
.head 5 -  ! Результат
.head 5 -  Return SG_WrapCommand( sVariables, sBody, 0 ) || "/
"
.head 3 +  Function: SetEditMode
.head 4 -  Description:
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Number: nTollBarEditMode
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If nTollBarEditMode = 1
.head 6 -  Call SalSetWindowText(hWndForm, 'Синхронизация справочников')
.head 6 -  Call SalDisableWindow(pbIns)
.head 6 -  Call SalDisableWindow(pbDel)
.head 6 -  Call SalDisableWindow(pbUpdate)
.head 6 -  Call SalDisableWindow(pbCheckNew)
.head 6 -  Call SalDisableWindow(pbEditWithWizard)
.head 6 -  Call SalDisableWindow(pbAddWithWizard)
.head 6 -  !
.head 6 -  Call SalHideWindow(frm_DBFSyncEdit.colS_SELECT)
.head 6 -  Call SalHideWindow(frm_DBFSyncEdit.colS_INSERT)
.head 6 -  Call SalHideWindow(frm_DBFSyncEdit.colS_UPDATE)
.head 6 -  Call SalHideWindow(frm_DBFSyncEdit.colS_DELETE)
.head 6 -  Call SalHideWindow(frm_DBFSyncEdit.colEncode)
.head 2 +  Window Parameters
.head 3 -  Number: nEditMode ! =0 -  редактирование, =1 - просто синхронизация справочника
.head 2 +  Window Variables
.head 3 -  ! Connect
.head 3 -  : cExecutor
.head 4 -  Class: cABSConnect
.head 3 -  !
.head 3 -  Long String: lsTmp
.head 3 -  String: sCode
.head 3 -  String: sSemantic
.head 3 -  Boolean: bTmp
.head 3 -  !
.head 3 -  String: strPath
.head 3 -  !
.head 3 -  Date/Time: dFileDate
.head 3 -  Date/Time: dFileDateDB
.head 3 -  !
.head 3 -  Number: nFetchRes
.head 3 -  !
.head 3 -  : cFileLog
.head 4 -  Class: cLog
.head 3 -  String: sDbfEncode
.head 3 -  String: sFilePathName
.head 3 -  String: sFileName
.head 3 -  String: sFilePath
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set fDbfSync=TRUE
.head 4 -  ! Создаем доп. соединение
.head 4 -  Call XConnectGetParams(cExecutor)
.head 4 +  If NOT cExecutor.Connect()
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Call SalDestroyWindow( frm_DBFSyncEdit )
.head 4 -  ! Основные SQL`и
.head 4 -  ! Set strSqlPopulate="
SELECT 
  DBF_SYNC_TABS.TABID, 
  META_TABLES.SEMANTIC, 
  META_TABLES.TABNAME, 
  DBF_SYNC_TABS.FILE_NAME, 
  substr(DBF_SYNC_TABS.S_SELECT,1,2000), 
  substr(DBF_SYNC_TABS.S_SELECT,2001,2000), 
  substr(DBF_SYNC_TABS.S_INSERT,1,2000), 
  substr(DBF_SYNC_TABS.S_INSERT,2001,2000), 
  substr(DBF_SYNC_TABS.S_UPDATE,1,2000), 
  substr(DBF_SYNC_TABS.S_UPDATE,2001,2000), 
  substr(DBF_SYNC_TABS.S_DELETE,1,2000), 
  substr(DBF_SYNC_TABS.S_DELETE,2001,2000), 
  DBF_SYNC_TABS.FILE_DATE, 
  DBF_SYNC_TABS.SYNC_FLAG,
  DBF_SYNC_TABS.encode,
  DBF_SYNC_TABS.branch    
INTO
  :frm_DBFSyncEdit.colTABID, 
  :frm_DBFSyncEdit.colSEMANTIC, 
  :frm_DBFSyncEdit.colTABNAME, 
  :frm_DBFSyncEdit.colTBLNAMENBU, 
  :frm_DBFSyncEdit.colS_SELECT, 
  :frm_DBFSyncEdit.colS_SELECT2, 
  :frm_DBFSyncEdit.colS_INSERT, 
  :frm_DBFSyncEdit.colS_INSERT2, 
  :frm_DBFSyncEdit.colS_UPDATE, 
  :frm_DBFSyncEdit.colS_UPDATE2, 
  :frm_DBFSyncEdit.colS_DELETE, 
  :frm_DBFSyncEdit.colS_DELETE2, 
  :frm_DBFSyncEdit.colFILE_DATE, 
  :frm_DBFSyncEdit.colSYNC_FLAG,
  :frm_DBFSyncEdit.colEncode,  
  :frm_DBFSyncEdit.colBranch
FROM 
  DBF_SYNC_TABS, 
  META_TABLES  
WHERE 
  DBF_SYNC_TABS.TABID = META_TABLES.TABID ORDER BY DBF_SYNC_TABS.TABID "
.head 4 -  Set strSqlPopulate="
SELECT 
  DBF_SYNC_TABS.TABID, 
  META_TABLES.SEMANTIC, 
  META_TABLES.TABNAME, 
  DBF_SYNC_TABS.FILE_NAME, 
  substr(DBF_SYNC_TABS.S_SELECT,1,2000), 
  substr(DBF_SYNC_TABS.S_SELECT,2001,2000), 
  substr(DBF_SYNC_TABS.S_INSERT,1,2000), 
  substr(DBF_SYNC_TABS.S_INSERT,2001,2000), 
  substr(DBF_SYNC_TABS.S_UPDATE,1,2000), 
  substr(DBF_SYNC_TABS.S_UPDATE,2001,2000), 
  substr(DBF_SYNC_TABS.S_DELETE,1,2000), 
  substr(DBF_SYNC_TABS.S_DELETE,2001,2000), 
  DBF_SYNC_TABS.FILE_DATE, 
  DBF_SYNC_TABS.SYNC_FLAG,
  DBF_SYNC_TABS.encode,
  DBF_SYNC_TABS.branch  
INTO
  :frm_DBFSyncEdit.colTABID, 
  :frm_DBFSyncEdit.colSEMANTIC, 
  :frm_DBFSyncEdit.colTABNAME, 
  :frm_DBFSyncEdit.colTBLNAMENBU, 
  :frm_DBFSyncEdit.colS_SELECT, 
  :frm_DBFSyncEdit.colS_SELECT2, 
  :frm_DBFSyncEdit.colS_INSERT, 
  :frm_DBFSyncEdit.colS_INSERT2, 
  :frm_DBFSyncEdit.colS_UPDATE, 
  :frm_DBFSyncEdit.colS_UPDATE2, 
  :frm_DBFSyncEdit.colS_DELETE, 
  :frm_DBFSyncEdit.colS_DELETE2, 
  :frm_DBFSyncEdit.colFILE_DATE, 
  :frm_DBFSyncEdit.colSYNC_FLAG,
  :frm_DBFSyncEdit.colEncode,  
  :frm_DBFSyncEdit.colBranch    
FROM 
  DBF_SYNC_TABS, 
  META_TABLES  
WHERE 
  DBF_SYNC_TABS.TABID = META_TABLES.TABID ORDER BY DBF_SYNC_TABS.TABID "
.head 4 -  Set strSqlInsert="
INSERT INTO DBF_SYNC_TABS ( 
  TABID, 
  S_SELECT, 
  S_INSERT, 
  S_UPDATE, 
  S_DELETE,
  ENCODE,
  FILE_NAME 
 ) 
VALUES ( 
  :frm_DBFSyncEdit.colTABID, 
  :frm_DBFSyncEdit.colS_SELECT, 
  :frm_DBFSyncEdit.colS_INSERT, 
  :frm_DBFSyncEdit.colS_UPDATE, 
  :frm_DBFSyncEdit.colS_DELETE,
  :frm_DBFSyncEdit.colEncode,
  :frm_DBFSyncEdit.colTBLNAMENBU)"
.head 4 -  Set strSqlUpdate="
UPDATE DBF_SYNC_TABS SET 
  S_SELECT = :frm_DBFSyncEdit.colS_SELECT, 
  S_INSERT = :frm_DBFSyncEdit.colS_INSERT, 
  S_UPDATE = :frm_DBFSyncEdit.colS_UPDATE, 
  S_DELETE = :frm_DBFSyncEdit.colS_DELETE,
  ENCODE   = :frm_DBFSyncEdit.colEncode,
  FILE_NAME= :frm_DBFSyncEdit.colTBLNAMENBU
WHERE TABID = :frm_DBFSyncEdit.colTABID "
.head 4 -  Set strSqlDelete="DELETE FROM DBF_SYNC_TABS WHERE TABID = :frm_DBFSyncEdit.colTABID and nvl(branch,'') = nvl(:frm_DBFSyncEdit.colBranch,'')"
.head 4 -  Set strFilterTblName='DBF_SYNC_TABS'
.head 4 -  Set strPrintFileName='DBF_SYNC_TABS'
.head 4 -  !
.head 4 -  !
.head 4 -  !
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SetEditMode(nEditMode)
.head 4 -  Call SalSendClassMessage( UM_Create, 0, 0 )
.head 3 +  On SAM_FetchRowDone
.head 4 -  Set colS_SELECT = colS_SELECT || colS_SELECT2
.head 4 -  Set colS_INSERT = colS_INSERT || colS_INSERT2
.head 4 -  Set colS_UPDATE = colS_UPDATE || colS_UPDATE2
.head 4 -  Set colS_DELETE = colS_DELETE || colS_DELETE2
.head 3 +  On SAM_User
.head 4 -  ! УСТАНОВКА ФЛАГА РЕДАКИРОВАНИЯ СТРОКИ ТАБЛИЦЫ
.head 4 +  If NOT SalTblQueryRowFlags( frm_DBFSyncEdit, SalTblQueryContext( frm_DBFSyncEdit ), ROW_New )
.head 5 -  Call SalTblSetRowFlags( frm_DBFSyncEdit,
	SalTblQueryContext( frm_DBFSyncEdit ), ROW_Edited, TRUE )
.head 3 +  On SAM_Destroy
.head 4 +  Call cExecutor.Disconnect()
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Call SalDestroyWindow( frm_DBFSyncEdit )
.head 4 -  Set fDbfSync=FALSE
.head 1 +  Dialog Box: dlg_SyncWiz1
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Мастер обновления таблиц
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.733"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.012"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Выбор таблицы
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Frame
.head 4 -  Resource Id: 18190
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    0.083"
.head 5 -  Width:  9.383"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.548"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 2
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Шаг №1 Выбор синхронизируемой таблицы
.head 4 -  Resource Id: 18191
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.317"
.head 5 -  Top:    0.238"
.head 5 -  Width:  8.95"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfTABNAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 38
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.867"
.head 6 -  Top:    0.845"
.head 6 -  Width:  2.317"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfTABID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.867"
.head 6 -  Top:    0.845"
.head 6 -  Width:  2.317"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfSEMANTIC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.867"
.head 6 -  Top:    1.131"
.head 6 -  Width:  6.067"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfTBLNAMENBU
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 16
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   2.867"
.head 6 -  Top:    1.56"
.head 6 -  Width:  2.317"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Имя таблицы:
.head 4 -  Resource Id: 18192
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.317"
.head 5 -  Top:    0.893"
.head 5 -  Width:  1.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Семантическое наименование
.head 4 -  Resource Id: 18193
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.317"
.head 5 -  Top:    1.202"
.head 5 -  Width:  1.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.357"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Имя dbf файла
.head 4 -  Resource Id: 18194
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.333"
.head 5 -  Top:    1.595"
.head 5 -  Width:  1.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbChoose
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbHelp
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   5.233"
.head 5 -  Top:    0.762"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If FunNSIGet( 'META_TABLES', 'SEMANTIC', sCode, sSemantic )
.head 7 -  Set dfTABID=0
.head 7 -  Set dfSEMANTIC=''
.head 7 -  Set dfTABNAME=''
.head 7 -  Set dfTBLNAMENBU=''
.head 7 -  Call SalDisableWindow( pbNext )
.head 7 +  If SqlPrepareAndExecute( cCnc.hSql(),
'SELECT
  META_TABLES.TABID,
  META_TABLES.SEMANTIC,
  META_TABLES.TABNAME
INTO
  :dfTABID,
  :dfSEMANTIC,
  :dfTABNAME
FROM
  META_TABLES
WHERE  META_TABLES.TABID = ' || sCode )
.head 8 +  If SqlFetchNext( cCnc.hSql(), nFetchRes )
.head 9 -  Call SalEnableWindow( pbNext )
.head 7 -  Call SalSendMsg( frm_DBFSyncEdit, SAM_User, 0, 0 )
.head 3 +  Pushbutton: pbNext
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Далее >>
.head 4 -  Window Location and Size
.head 5 -  Left:   8.133"
.head 5 -  Top:    4.25"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If dfTABID and dfTBLNAMENBU 
.head 7 -  Set nSWTabId=dfTABID
.head 7 -  Set sSWTabname=dfTABNAME
.head 7 -  Set sSWTabnameDBF=dfTBLNAMENBU
.head 7 -  Set sSWTabnameInt=dfTBLNAMENBU ||
     IifS(dfTBLNAMENBU=dfTABNAME, '_', '')
.head 7 -  Call SalEndDialog( hWndForm, 99 )
.head 6 +  Else
.head 7 -  Call SalMessageBox( 'Нельзя перейти с следующему шагу не выбрав таблицу или н указано имя dbf файла!',
       'Шаг №1', MB_IconStop )
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отмена
.head 4 -  Window Location and Size
.head 5 -  Left:   6.833"
.head 5 -  Top:    4.25"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, 0 )
.head 3 -  Frame
.head 4 -  Resource Id: 18195
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.117"
.head 5 -  Top:    3.333"
.head 5 -  Width:  9.417"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.833"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: На даном шаге вы можете выбрать имя синхронизируемой таблицы. Синхронизируемая таблица должна быть описана в базе метаданых. Используйте клавишу с "?" для выбора имени таблицы из справочника.
.head 4 -  Resource Id: 18196
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    3.44"
.head 5 -  Width:  9.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.381"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nTabId
.head 2 +  Window Variables
.head 3 -  : cCnc
.head 4 -  Class: cABSConnect
.head 3 -  !
.head 3 -  Number: nFetchRes
.head 3 -  String: sCode
.head 3 -  String: sSemantic
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set nSWTabId=0
.head 4 -  Set sSWTabname=''
.head 4 -  Set sSWTabnameDBF=''
.head 4 -  Set sSWTabnameInt=''
.head 4 -  ! Создаем соединение
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call XConnectGetParams(cCnc)
.head 4 +  If NOT cCnc.Connect()
.head 5 -  Call SalEndDialog( hWndForm, 0 )
.head 4 -  Call SalDisableWindow( pbNext )
.head 4 +  If nTabId
.head 5 +  If SqlPrepareAndExecute( cCnc.hSql(),
'SELECT
  META_TABLES.TABID,
  META_TABLES.SEMANTIC,
  META_TABLES.TABNAME,
  d.file_name
INTO
  :dfTABID,
  :dfSEMANTIC,
  :dfTABNAME,
  :dfTBLNAMENBU
FROM
  META_TABLES,
  dbf_sync_tabs d 
WHERE
  META_TABLES.TABID = d.TABID AND
  META_TABLES.TABID = ' || SalNumberToStrX( nTabId, 0 ) )
.head 6 +  If SqlFetchNext( cCnc.hSql(), nFetchRes )
.head 7 -  Set nSWTabId=nTabId
.head 7 -  Set sSWTabname=dfTABNAME
.head 7 -  Set sSWTabnameDBF=dfTBLNAMENBU
.head 7 -  Set sSWTabnameInt=dfTBLNAMENBU ||
     IifS(dfTBLNAMENBU=dfTABNAME, '_', '')
.head 7 -  Call SalEndDialog( hWndForm, 99 )
.head 3 +  On SAM_Destroy
.head 4 -  Call cCnc.Disconnect()
.head 1 +  Dialog Box: dlg_SyncWiz2
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Мастер обновления таблиц
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.733"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.036"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Выбор PK
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Frame
.head 4 -  Resource Id: 18197
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    0.083"
.head 5 -  Width:  9.383"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.548"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 2
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Шаг №2 Выбор первичного ключа таблицы
.head 4 -  Resource Id: 18198
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.317"
.head 5 -  Top:    0.238"
.head 5 -  Width:  8.95"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  List Box: lbAll
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    1.071"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.083"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Multiple selection? Yes
.head 4 -  Sorted? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Horizontal Scroll? No
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg( pbAdd, SAM_Click, 0, 0 )
.head 3 +  List Box: lbPK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.667"
.head 5 -  Top:    1.071"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.083"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Multiple selection? Yes
.head 4 -  Sorted? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Horizontal Scroll? No
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg( pbDel, SAM_Click, 0, 0 )
.head 5 +  On SAM_User
.head 6 +  If SalListQueryCount( lbPK )
.head 7 -  Call SalEnableWindow( pbNext )
.head 3 -  Background Text: Список полей таблицы
.head 4 -  Resource Id: 18199
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    0.655"
.head 5 -  Width:  2.567"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Список полей таблицы, образующих первичный ключ
.head 4 -  Resource Id: 18200
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.7"
.head 5 -  Top:    0.655"
.head 5 -  Width:  2.65"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.31"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbAddAll
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: >>
.head 4 -  Window Location and Size
.head 5 -  Left:   3.1"
.head 5 -  Top:    1.393"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nIndex=0
.head 6 +  Loop
.head 7 -  Set sTmp=SalListQueryTextX( lbAll, nIndex )
.head 7 +  If SalListQueryCount( lbAll )
.head 8 -  Call SalListDelete( lbAll, nIndex )
.head 8 -  Call SalListAdd( lbPK, sTmp )
.head 7 +  Else
.head 8 -  Break
.head 6 -  Call SalSendMsg( lbPK, SAM_User, 0, 0 )
.head 3 +  Pushbutton: pbAdd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: >
.head 4 -  Window Location and Size
.head 5 -  Left:   3.1"
.head 5 -  Top:    1.774"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nIndex=0
.head 6 +  Loop
.head 7 +  If SalListQueryState( lbAll, nIndex )
.head 8 -  Set sTmp=SalListQueryTextX( lbAll, nIndex )
.head 8 -  Call SalListDelete( lbAll, nIndex )
.head 8 -  Call SalListAdd( lbPK, sTmp )
.head 7 +  Else
.head 8 +  If nIndex<SalListQueryCount( lbAll )
.head 9 -  Set nIndex=nIndex+1
.head 8 +  Else
.head 9 -  Break
.head 6 -  Call SalSendMsg( lbPK, SAM_User, 0, 0 )
.head 3 +  Pushbutton: pbDel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: <
.head 4 -  Window Location and Size
.head 5 -  Left:   3.1"
.head 5 -  Top:    2.155"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nIndex=0
.head 6 +  Loop
.head 7 +  If SalListQueryState( lbPK, nIndex )
.head 8 -  Set sTmp=SalListQueryTextX( lbPK, nIndex )
.head 8 -  Call SalListDelete( lbPK, nIndex )
.head 8 -  Call SalListAdd( lbAll, sTmp )
.head 7 +  Else
.head 8 +  If nIndex<SalListQueryCount( lbPK )
.head 9 -  Set nIndex=nIndex+1
.head 8 +  Else
.head 9 -  Break
.head 6 -  Call SalSendMsg( lbPK, SAM_User, 0, 0 )
.head 3 +  Pushbutton: pbDelAll
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: <<
.head 4 -  Window Location and Size
.head 5 -  Left:   3.1"
.head 5 -  Top:    2.536"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nIndex=0
.head 6 +  Loop
.head 7 -  Set sTmp=SalListQueryTextX( lbPK, nIndex )
.head 7 +  If SalListQueryCount( lbPK )
.head 8 -  Call SalListDelete( lbPK, nIndex )
.head 8 -  Call SalListAdd( lbAll, sTmp )
.head 7 +  Else
.head 8 -  Break
.head 6 -  Call SalSendMsg( lbPK, SAM_User, 0, 0 )
.head 3 -  Frame
.head 4 -  Resource Id: 18201
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.117"
.head 5 -  Top:    3.333"
.head 5 -  Width:  9.417"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.833"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: На даном шаге вы можете выбрать список полей таблицы, образующих первичный ключ. Первичный ключ используется для модификации таблицы.
Комбинация значений полей первичного ключа в таблице должна быть уникальна для однозначной идентификации записи.
.head 4 -  Resource Id: 18202
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    3.44"
.head 5 -  Width:  9.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.631"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbNext
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Далее >>
.head 4 -  Window Location and Size
.head 5 -  Left:   8.133"
.head 5 -  Top:    4.25"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalListQueryCount( lbPK )
.head 7 -  Set nIndex=0
.head 7 -  Set nIndex2=0
.head 7 +  Loop
.head 8 -  Set sTmp=SalListQueryTextX( lbPK, nIndex )
.head 8 +  If sTmp
.head 9 -  Set sPK[nIndex2]=sTmp
.head 9 -  Set nIndex2=nIndex2+1
.head 8 +  If nIndex<SalListQueryCount( lbPK )
.head 9 -  Set nIndex=nIndex+1
.head 8 +  Else
.head 9 -  Break
.head 7 -  Call SalEndDialog( hWndForm, 99 )
.head 6 +  Else
.head 7 -  Call SalMessageBox( 'Нельзя перейти с следующему шагу не выбрав первичный ключ!', 'Шаг №2', MB_IconStop )
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отмена
.head 4 -  Window Location and Size
.head 5 -  Left:   6.833"
.head 5 -  Top:    4.25"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, 0 )
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  : cCnc
.head 4 -  Class: cABSConnect
.head 3 -  !
.head 3 -  Number: nFetchRes
.head 3 -  !
.head 3 -  Number: nIndex
.head 3 -  Number: nIndex2
.head 3 -  String: sTmp
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call EmptyArrays( sPK )
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  ! Создаем соединение
.head 4 -  Call XConnectGetParams(cCnc)
.head 4 +  If NOT cCnc.Connect()
.head 5 -  Call SalEndDialog( hWndForm, 0 )
.head 4 -  Call SalDisableWindow( pbNext )
.head 4 -  ! Население списка колонок
.head 4 -  Call SalListPopulate( lbAll, cCnc.hSql(),
'SELECT COLNAME
FROM META_COLUMNS
WHERE TABID = :nSWTabId
ORDER BY SHOWPOS ' )
.head 3 +  On SAM_Destroy
.head 4 -  Call cCnc.Disconnect()
.head 1 +  Dialog Box: dlg_SyncWiz3
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Мастер обновления таблиц
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.733"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.036"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Выбор полей используемых для обновления
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Frame
.head 4 -  Resource Id: 57445
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    0.083"
.head 5 -  Width:  9.383"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.548"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 2
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Шаг №3 Выбор полей обновления
.head 4 -  Resource Id: 57446
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.317"
.head 5 -  Top:    0.238"
.head 5 -  Width:  8.95"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  List Box: lbAll
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    1.071"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.083"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Multiple selection? Yes
.head 4 -  Sorted? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Horizontal Scroll? No
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg( pbAdd, SAM_Click, 0, 0 )
.head 3 +  List Box: lbPK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.667"
.head 5 -  Top:    1.071"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.083"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Multiple selection? Yes
.head 4 -  Sorted? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Horizontal Scroll? No
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg( pbDel, SAM_Click, 0, 0 )
.head 5 +  On SAM_User
.head 6 +  If SalListQueryCount( lbPK )
.head 7 -  Call SalEnableWindow( pbNext )
.head 3 -  Background Text: Список полей таблицы
.head 4 -  Resource Id: 57447
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    0.655"
.head 5 -  Width:  2.567"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Список полей таблицы, используемых для обновления
.head 4 -  Resource Id: 57448
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.7"
.head 5 -  Top:    0.655"
.head 5 -  Width:  3.083"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.31"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbAddAll
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: >>
.head 4 -  Window Location and Size
.head 5 -  Left:   3.1"
.head 5 -  Top:    1.393"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nIndex=0
.head 6 +  Loop
.head 7 -  Set sTmp=SalListQueryTextX( lbAll, nIndex )
.head 7 +  If SalListQueryCount( lbAll )
.head 8 -  Call SalListDelete( lbAll, nIndex )
.head 8 -  Call SalListAdd( lbPK, sTmp )
.head 7 +  Else
.head 8 -  Break
.head 6 -  Call SalSendMsg( lbPK, SAM_User, 0, 0 )
.head 3 +  Pushbutton: pbAdd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: >
.head 4 -  Window Location and Size
.head 5 -  Left:   3.1"
.head 5 -  Top:    1.774"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nIndex=0
.head 6 +  Loop
.head 7 +  If SalListQueryState( lbAll, nIndex )
.head 8 -  Set sTmp=SalListQueryTextX( lbAll, nIndex )
.head 8 -  Call SalListDelete( lbAll, nIndex )
.head 8 -  Call SalListAdd( lbPK, sTmp )
.head 7 +  Else
.head 8 +  If nIndex<SalListQueryCount( lbAll )
.head 9 -  Set nIndex=nIndex+1
.head 8 +  Else
.head 9 -  Break
.head 6 -  Call SalSendMsg( lbPK, SAM_User, 0, 0 )
.head 3 +  Pushbutton: pbDel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: <
.head 4 -  Window Location and Size
.head 5 -  Left:   3.1"
.head 5 -  Top:    2.155"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nIndex=0
.head 6 +  Loop
.head 7 +  If SalListQueryState( lbPK, nIndex )
.head 8 -  Set sTmp=SalListQueryTextX( lbPK, nIndex )
.head 8 -  Call SalListDelete( lbPK, nIndex )
.head 8 -  Call SalListAdd( lbAll, sTmp )
.head 7 +  Else
.head 8 +  If nIndex<SalListQueryCount( lbPK )
.head 9 -  Set nIndex=nIndex+1
.head 8 +  Else
.head 9 -  Break
.head 6 -  Call SalSendMsg( lbPK, SAM_User, 0, 0 )
.head 3 +  Pushbutton: pbDelAll
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: <<
.head 4 -  Window Location and Size
.head 5 -  Left:   3.1"
.head 5 -  Top:    2.536"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nIndex=0
.head 6 +  Loop
.head 7 -  Set sTmp=SalListQueryTextX( lbPK, nIndex )
.head 7 +  If SalListQueryCount( lbPK )
.head 8 -  Call SalListDelete( lbPK, nIndex )
.head 8 -  Call SalListAdd( lbAll, sTmp )
.head 7 +  Else
.head 8 -  Break
.head 6 -  Call SalSendMsg( lbPK, SAM_User, 0, 0 )
.head 3 -  Frame
.head 4 -  Resource Id: 57449
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.117"
.head 5 -  Top:    3.333"
.head 5 -  Width:  9.417"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.833"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: На даном шаге вы можете выбрать список полей таблицы, используемых для обновления записей.
Эти поля составляют подмножество полей иcпользуемых для обновления, т.е. обновляться будут только они.
.head 4 -  Resource Id: 57450
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    3.44"
.head 5 -  Width:  9.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.631"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbNext
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Далее >>
.head 4 -  Window Location and Size
.head 5 -  Left:   8.133"
.head 5 -  Top:    4.25"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalListQueryCount( lbPK )
.head 7 -  Set nIndex=0
.head 7 -  Set nIndex2=0
.head 7 +  Loop
.head 8 -  Set sTmp=SalListQueryTextX( lbPK, nIndex )
.head 8 +  If sTmp
.head 9 -  Set sCompare[nIndex2]=sTmp
.head 9 -  Set nIndex2=nIndex2+1
.head 8 +  If nIndex<SalListQueryCount( lbPK )
.head 9 -  Set nIndex=nIndex+1
.head 8 +  Else
.head 9 -  Break
.head 6 -  Call SalEndDialog( hWndForm, 99 )
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отмена
.head 4 -  Window Location and Size
.head 5 -  Left:   6.833"
.head 5 -  Top:    4.25"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, 0 )
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  : cCnc
.head 4 -  Class: cABSConnect
.head 3 -  !
.head 3 -  Number: nFetchRes
.head 3 -  !
.head 3 -  Number: nIndex
.head 3 -  Number: nIndex2
.head 3 -  String: sTmp
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call EmptyArrays( sCompare )
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  ! Создаем соединение
.head 4 -  Call XConnectGetParams(cCnc)
.head 4 +  If NOT cCnc.Connect()
.head 5 -  Call SalEndDialog( hWndForm, 0 )
.head 4 -  Call SalDisableWindow( pbNext )
.head 4 -  ! Население списка колонок
.head 4 -  Call SalListPopulate( lbAll, cCnc.hSql(),
'SELECT COLNAME
FROM META_COLUMNS
WHERE TABID = :nSWTabId
ORDER BY SHOWPOS ' )
.head 3 +  On SAM_Destroy
.head 4 -  Call cCnc.Disconnect()
.head 1 +  Dialog Box: dlg_SyncWiz4
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Мастер обновления таблиц
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.733"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.036"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Выбор соответствий полей
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Frame
.head 4 -  Resource Id: 18203
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    0.083"
.head 5 -  Width:  9.383"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.548"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 2
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Шаг №4 Выбор соответствий полей
.head 4 -  Resource Id: 18204
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.317"
.head 5 -  Top:    0.238"
.head 5 -  Width:  8.95"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  List Box: lbDB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    1.071"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.083"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Multiple selection? No
.head 4 -  Sorted? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Horizontal Scroll? No
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 +  List Box: lbFL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.833"
.head 5 -  Top:    1.071"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.083"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Multiple selection? No
.head 4 -  Sorted? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Horizontal Scroll? No
.head 4 -  List Initialization
.head 4 -  Message Actions
.head 3 +  List Box: lbCorr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.683"
.head 5 -  Top:    1.071"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.083"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Multiple selection? No
.head 4 -  Sorted? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Horizontal Scroll? No
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Set nIndex=SalListQuerySelection( lbCorr )
.head 6 +  If nIndex != LB_Err
.head 7 -  Set sTmp=SalListQueryTextX( lbCorr, nIndex )
.head 7 +  If SalStrTokenize( sTmp, '=', '=', sTmp3 )=2
.head 8 -  Call SalListDelete( lbCorr, nIndex )
.head 8 -  Call SalListAdd( lbDB, sTmp3[0] )
.head 8 -  Call SalListAdd( lbFL, sTmp3[1] )
.head 6 -  Call SalSendMsg( pbNext, SAM_User, 0, 0 )
.head 3 -  Background Text: Список полей таблицы БД
.head 4 -  Resource Id: 18205
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    0.81"
.head 5 -  Width:  2.567"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Список полей DBF таблицы
.head 4 -  Resource Id: 18206
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.867"
.head 5 -  Top:    0.81"
.head 5 -  Width:  2.467"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Список соответствий полей
.head 4 -  Resource Id: 18207
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   6.7"
.head 5 -  Top:    0.81"
.head 5 -  Width:  2.467"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.19"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbCreate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: -->><<--
.head 4 -  Window Location and Size
.head 5 -  Left:   2.95"
.head 5 -  Top:    1.964"
.head 5 -  Width:  0.733"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set nIndex=SalListQuerySelection( lbDB )
.head 6 -  Set nIndex2=SalListQuerySelection( lbFL )
.head 6 +  If nIndex != LB_Err AND nIndex2 != LB_Err
.head 7 -  Set sTmp=SalListQueryTextX( lbDB, nIndex )
.head 7 -  Set sTmp2=SalListQueryTextX( lbFL, nIndex2 )
.head 7 -  Call SalListDelete( lbDB, nIndex )
.head 7 -  Call SalListDelete( lbFL, nIndex2 )
.head 7 -  Call SalListAdd( lbCorr, sTmp || '=' || sTmp2 )
.head 6 -  Call SalSendMsg( pbNext, SAM_User, 0, 0 )
.head 3 -  Frame
.head 4 -  Resource Id: 18208
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.117"
.head 5 -  Top:    3.238"
.head 5 -  Width:  9.417"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.929"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: На даном шаге вы можете выбрать соответствия полей в dbf файле и в БД. Для образования связки выберите оба поля и нажмите кнопку "-->><<--".
Удаление связок производится с помощью двойного щелчка мышкой. 
На данном шаге необходимо задать соответствия всем полям, которые будут использоваться при обновлении.
.head 4 -  Resource Id: 18209
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    3.321"
.head 5 -  Width:  9.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.75"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbNext
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Далее >>
.head 4 -  Window Location and Size
.head 5 -  Left:   8.133"
.head 5 -  Top:    4.25"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If SalListQueryCount( lbCorr )
.head 7 -  Set nIndex=0
.head 7 -  Set nIndex2=0
.head 7 +  Loop
.head 8 -  Set sTmp=SalListQueryTextX( lbCorr, nIndex )
.head 8 +  If sTmp
.head 9 +  If SalStrTokenize( sTmp, '=', '=', sTmp3 )=2
.head 10 -  Set sDbFileds[nIndex2]=sTmp3[0]
.head 10 -  Set sFlFields[nIndex2]=sTmp3[1]
.head 9 -  Set nIndex2=nIndex2+1
.head 8 +  If nIndex<SalListQueryCount( lbCorr )
.head 9 -  Set nIndex=nIndex+1
.head 8 +  Else
.head 9 -  Break
.head 7 -  Call SalEndDialog( hWndForm, 99 )
.head 6 +  Else
.head 7 -  Call SalMessageBox( 'Нельзя перейти с следующему шагу не задав соответствия полей!', 'Шаг №4', MB_IconStop )
.head 5 +  On SAM_User
.head 6 +  If SalListQueryCount( lbCorr ) > 0
.head 7 -  Call SalEnableWindow( pbNext )
.head 6 +  Else
.head 7 -  Call SalDisableWindow( pbNext )
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отмена
.head 4 -  Window Location and Size
.head 5 -  Left:   6.833"
.head 5 -  Top:    4.25"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, 0 )
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  : cCnc
.head 4 -  Class: cABSConnect
.head 3 -  Sql Handle: hCnc
.head 3 -  File Handle: hFile
.head 3 -  !
.head 3 -  Number: nFetchRes
.head 3 -  !
.head 3 -  Number: nIndex
.head 3 -  Number: nIndex2
.head 3 -  String: sTmp
.head 3 -  String: sTmp2
.head 3 -  String: sTmp3[*]
.head 3 -  : cColumns[*]
.head 4 -  Class: cSqlColumnDescriptor
.head 3 -  String: strPath
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call EmptyArrays( sDbFileds )
.head 4 -  Call EmptyArrays( sFlFields )
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  ! Создаем соединение
.head 4 -  Call XConnectGetParams(cCnc)
.head 4 +  If NOT cCnc.Connect()
.head 5 -  Call SalEndDialog( hWndForm, 0 )
.head 4 -  Call SalDisableWindow( pbNext )
.head 4 -  ! Население списка колонок таблицы БД
.head 4 -  Call SalListPopulate( lbDB, cCnc.hSql(),
'SELECT COLNAME
FROM META_COLUMNS
WHERE TABID = :nSWTabId
ORDER BY SHOWPOS ' )
.head 4 -  ! Население списка колонок таблицы DBF
.head 4 -  Call SalUseRegistry( FALSE, '' )
.head 4 -  Call SalGetProfileString('Import', 'Kl_Nbu', '', strPath,
     GetIniFileName())
.head 4 +  If SalFileOpen(hFile, strPath || '\\' || sSWTabnameDBF
     || '.dbf', OF_Exist )
.head 5 -  Set SqlDatabase = 'dBase_Files'
.head 5 -  Call SalFileSetCurrentDirectory( strPath )
.head 5 +  If SqlConnect(hCnc)
.head 6 +  If SqlPrepare( hCnc, 'SELECT * FROM ' || sSWTabnameDBF )
.head 7 -  Call SqlDescribe( hCnc, cColumns )
.head 7 -  Call SalArrayGetLowerBound( cColumns, 1, nIndex )
.head 7 -  Call SalArrayGetUpperBound( cColumns, 1, nIndex2 )
.head 7 +  Loop
.head 8 +  If nIndex>nIndex2
.head 9 -  Break
.head 8 +  Else
.head 9 -  Call SalListAdd( lbFL, SalStrUpperX( cColumns[nIndex].strColName ) )
.head 9 -  Set nIndex=nIndex+1
.head 4 +  Else
.head 5 -  Call SalMessageBox( 'Файл не найден: ' || strPath || '\\' || sSWTabnameDBF
     || '.dbf!', 'Ошибка', MB_IconStop )
.head 5 -  Call SalEndDialog( hWndForm, 0 )
.head 3 +  On SAM_Destroy
.head 4 -  Call cCnc.Disconnect()
.head 1 +  Dialog Box: dlg_SyncWiz5
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Мастер обновления таблиц
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  9.733"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.036"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Выбор выражений
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Frame
.head 4 -  Resource Id: 57451
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.133"
.head 5 -  Top:    0.083"
.head 5 -  Width:  9.383"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.548"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Round
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 2
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Шаг №5 Выбор генерируемых выражений
.head 4 -  Resource Id: 57452
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.317"
.head 5 -  Top:    0.238"
.head 5 -  Width:  8.95"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.226"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: 12
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 57453
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.117"
.head 5 -  Top:    3.238"
.head 5 -  Width:  9.417"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.929"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Solid
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: На даном шаге вы можете выбрать, какие именно SQL выражения генерировать мастеру. 
.head 4 -  Resource Id: 57454
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.267"
.head 5 -  Top:    3.321"
.head 5 -  Width:  9.133"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.75"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbNext
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Закончить
.head 4 -  Window Location and Size
.head 5 -  Left:   8.133"
.head 5 -  Top:    4.25"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If Generate()
.head 7 -  Set fExists=FALSE
.head 7 +  If SqlPrepareAndExecute( cCnc.hSql(), 'SELECT TABID INTO :nTMP FROM DBF_SYNC_TABS WHERE TABID=:nSWTabId' )
.head 8 +  If SqlFetchNext( cCnc.hSql(), nFetchRes )
.head 9 -  Set fExists=(nFetchRes=FETCH_Ok)
.head 7 +  Else
.head 8 -  Return FALSE
.head 7 +  If fExists
.head 8 +  If SalMessageBox( 'Вы уверены, что хотите перезаписать выражения для таблицы ' || sSWTabname || '? 
Перезаписаны будут только отмеченные вами выражения!', 'Подтверждение', MB_IconQuestion | MB_YesNo )
.head 9 -  Set sINSERT_L=sINSERT_
.head 9 -  Set sUPDATE_L=sUPDATE_
.head 9 -  Set sDELETE_L=sDELETE_
.head 9 -  Set sSELECT_L=sSELECT_
.head 9 -  Set fError=FALSE
.head 9 +  If NOT fError AND cbSELECT
.head 10 -  Set fError= NOT SqlPrepareAndExecute( cCnc.hSql(), 
'UPDATE DBF_SYNC_TABS SET 
  S_SELECT=:sSELECT_L 
WHERE TABID=:nSWTabId ' )
.head 9 +  If NOT fError AND cbINSERT
.head 10 -  Set fError= NOT SqlPrepareAndExecute( cCnc.hSql(), 
'UPDATE DBF_SYNC_TABS SET 
  S_INSERT=:sINSERT_L 
WHERE TABID=:nSWTabId ' )
.head 9 +  If NOT fError AND cbUPDATE
.head 10 -  Set fError= NOT SqlPrepareAndExecute( cCnc.hSql(), 
'UPDATE DBF_SYNC_TABS SET 
  S_UPDATE=:sUPDATE_L 
WHERE TABID=:nSWTabId ' )
.head 9 +  If NOT fError AND cbDELETE
.head 10 -  Set fError= NOT SqlPrepareAndExecute( cCnc.hSql(), 
'UPDATE DBF_SYNC_TABS SET 
  S_DELETE=:sDELETE_L 
WHERE TABID=:nSWTabId ' )
.head 9 +  If NOT fError
.head 10 -  Call SqlCommit( cCnc.hSql() )
.head 9 +  Else
.head 10 -  Call SqlRollback( cCnc.hSql() )
.head 7 +  Else
.head 8 +  If SqlPrepareAndExecute( cCnc.hSql(), 
'INSERT INTO DBF_SYNC_TABS ( TABID, S_INSERT, S_UPDATE, S_DELETE, S_SELECT ) 
VALUES (:nSWTabId,:sINSERT_,:sUPDATE_,:sDELETE_,:sSELECT_)' )
.head 9 -  Call SqlCommit( cCnc.hSql() )
.head 8 +  Else
.head 9 -  Call SqlRollback( cCnc.hSql() )
.head 6 -  Call SalEndDialog( hWndForm, 99 )
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Отмена
.head 4 -  Window Location and Size
.head 5 -  Left:   6.833"
.head 5 -  Top:    4.25"
.head 5 -  Width:  1.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.298"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, 0 )
.head 3 +  Check Box: cbSELECT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выражение для показа различий
.head 4 -  Window Location and Size
.head 5 -  Left:   0.383"
.head 5 -  Top:    1.655"
.head 5 -  Width:  5.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbINSERT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выражение на вставку новых записей
.head 4 -  Window Location and Size
.head 5 -  Left:   0.383"
.head 5 -  Top:    0.905"
.head 5 -  Width:  5.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbUPDATE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выражение на обновление существующих записей
.head 4 -  Window Location and Size
.head 5 -  Left:   0.383"
.head 5 -  Top:    1.155"
.head 5 -  Width:  5.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbDELETE
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выражение на удаление записей
.head 4 -  Window Location and Size
.head 5 -  Left:   0.383"
.head 5 -  Top:    1.405"
.head 5 -  Width:  5.2"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: Generate
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nIndex
.head 5 -  Number: nIndex2
.head 5 -  String: sTmp
.head 5 -  String: sEOL
.head 4 +  Actions
.head 5 -  ! End-of-Line
.head 5 -  Set sSELECT_=''
.head 5 -  Set sINSERT_=''
.head 5 -  Set sUPDATE_=''
.head 5 -  Set sDELETE_=''
.head 5 -  Set sEOL=SalNumberToChar( 13 ) || SalNumberToChar( 10 )
.head 5 +  If cbSELECT
.head 6 -  ! Выбрать новые
.head 6 +  Loop
.head 7 -  Set sSELECT_=
'SELECT 
  1, ' || sEOL
.head 7 -  ! Что
.head 7 -  Set nIndex=0
.head 7 +  Loop
.head 8 +  If nIndex>99
.head 9 -  Break
.head 8 +  If sFlFields[nIndex]
.head 9 +  If nIndex=0
.head 10 -  Set sSELECT_=sSELECT_ || '  ' || sFlFields[nIndex]
.head 9 +  Else
.head 10 -  Set sSELECT_=sSELECT_ || ', ' || sEOL || '  ' || sFlFields[nIndex]
.head 8 +  Else
.head 9 -  Break
.head 8 -  Set nIndex=nIndex+1
.head 7 -  ! Откуда
.head 7 -  Set sSELECT_=sSELECT_ || ' ' || sEOL || 'FROM ' || sSWTabnameInt || ' WHERE ( ' || sEOL
.head 7 -  ! Когда
.head 7 -  Set nIndex=0
.head 7 +  Loop
.head 8 +  If nIndex>99
.head 9 -  Break
.head 8 +  If sPK[nIndex]
.head 9 -  Set nIndex2=IndexOf( sDbFileds, sPK[nIndex] )
.head 9 +  If nIndex2 != -1
.head 10 +  If nIndex=0
.head 11 -  Set sSELECT_=sSELECT_ || '  ' || sFlFields[nIndex2]
.head 10 +  Else
.head 11 -  Set sSELECT_=sSELECT_ || ', ' || sEOL || '  ' || sFlFields[nIndex2]
.head 9 +  Else
.head 10 -  Call SalMessageBox( 'Не найдено соответствие полю первичного ключа ' || sPK[nIndex], 'Ощибка', MB_IconStop )
.head 10 -  Return FALSE
.head 8 +  Else
.head 9 -  Break
.head 8 -  Set nIndex=nIndex+1
.head 7 -  Set sSELECT_=sSELECT_ || ' ) '  || sEOL || '  NOT IN ' || sEOL || '  (SELECT ' || sEOL
.head 7 -  Set nIndex=0
.head 7 +  Loop
.head 8 +  If nIndex>99
.head 9 -  Break
.head 8 +  If sPK[nIndex]
.head 9 +  If nIndex=0
.head 10 -  Set sSELECT_=sSELECT_ || '    ' || sPK[nIndex]
.head 9 +  Else
.head 10 -  Set sSELECT_=sSELECT_ || ', ' || sEOL || '    ' || sPK[nIndex]
.head 8 +  Else
.head 9 -  Break
.head 8 -  Set nIndex=nIndex+1
.head 7 -  Set sSELECT_=sSELECT_ || '  ' || sEOL || '   FROM ' || sSWTabname || ')'
.head 7 -  !
.head 7 -  Break
.head 6 -  Set sSELECT_=sSELECT_ || ' ' || sEOL || 'UNION ALL ' || sEOL
.head 6 -  ! Выбрать обновленные
.head 6 +  Loop
.head 7 -  Set sSELECT_=sSELECT_ || 
'SELECT 
  2, ' || sEOL
.head 7 -  ! Что
.head 7 -  ! DB
.head 7 -  Set nIndex=0
.head 7 +  Loop
.head 8 +  If nIndex>99
.head 9 -  Break
.head 8 +  If sDbFileds[nIndex]
.head 9 +  If nIndex=0
.head 10 -  Set sSELECT_=sSELECT_ || '  ' || sSWTabname || '.' || sDbFileds[nIndex]
.head 9 +  Else
.head 10 -  Set sSELECT_=sSELECT_ || ', ' || sEOL || '  ' || sSWTabname || '.' || sDbFileds[nIndex]
.head 8 +  Else
.head 9 -  Break
.head 8 -  Set nIndex=nIndex+1
.head 7 -  ! Int
.head 7 -  Set nIndex=0
.head 7 +  Loop
.head 8 +  If nIndex>99
.head 9 -  Break
.head 8 +  If sFlFields[nIndex]
.head 9 -  Set sSELECT_=sSELECT_ || ', ' || sEOL || '  ' || sSWTabnameInt || '.' || sFlFields[nIndex]
.head 8 +  Else
.head 9 -  Break
.head 8 -  Set nIndex=nIndex+1
.head 7 -  ! Откуда
.head 7 -  Set sSELECT_=sSELECT_ || ' ' || sEOL || 'FROM ' || sSWTabname || ', ' || sSWTabnameInt || ' WHERE ' || sEOL
.head 7 -  ! Когда
.head 7 -  ! PK
.head 7 -  Set nIndex=0
.head 7 +  Loop
.head 8 +  If nIndex>99
.head 9 -  Break
.head 8 +  If sPK[nIndex]
.head 9 -  Set nIndex2=IndexOf( sDbFileds, sPK[nIndex] )
.head 9 +  If nIndex2 != -1
.head 10 +  If nIndex=0
.head 11 -  Set sSELECT_=sSELECT_ || 
sSWTabnameInt || '.' || sFlFields[nIndex2] || '=' || sSWTabname || '.' || sPK[nIndex]
.head 10 +  Else
.head 11 -  Set sSELECT_=sSELECT_ || ' AND ' ||  
sSWTabnameInt || '.' || sFlFields[nIndex2] || '=' || sSWTabname || '.' || sPK[nIndex]
.head 9 +  Else
.head 10 -  Call SalMessageBox( 'Не найдено соответствие полю первичного ключа ' || sPK[nIndex], 'Ощибка', MB_IconStop )
.head 10 -  Return FALSE
.head 8 +  Else
.head 9 -  Break
.head 8 -  Set nIndex=nIndex+1
.head 7 -  ! Др. поля
.head 7 -  Set nIndex=0
.head 7 +  Loop
.head 8 +  If nIndex>99
.head 9 -  Break
.head 8 +  If sCompare[nIndex]
.head 9 -  Set nIndex2=IndexOf( sDbFileds, sCompare[nIndex] )
.head 9 +  If nIndex2 != -1
.head 10 -  Set sSELECT_=sSELECT_ || ' AND ' ||  
sSWTabnameInt || '.' || sFlFields[nIndex2] || '<>' || sSWTabname || '.' || sCompare[nIndex]
.head 9 +  Else
.head 10 -  Call SalMessageBox( 'Не найдено соответствие полю обновления ' || sCompare[nIndex], 'Ощибка', MB_IconStop )
.head 10 -  Return FALSE
.head 8 +  Else
.head 9 -  Break
.head 8 -  Set nIndex=nIndex+1
.head 7 -  !
.head 7 -  Break
.head 6 -  Set sSELECT_=sSELECT_ || ' ' || sEOL || 'UNION ALL ' || sEOL
.head 6 -  ! Выбрать удаленные
.head 6 +  Loop
.head 7 -  Set sSELECT_=sSELECT_ || 
'SELECT 
  3, ' || sEOL
.head 7 -  ! Что
.head 7 -  Set nIndex=0
.head 7 +  Loop
.head 8 +  If nIndex>99
.head 9 -  Break
.head 8 +  If sDbFileds[nIndex]
.head 9 +  If nIndex=0
.head 10 -  Set sSELECT_=sSELECT_ || '  ' || sDbFileds[nIndex]
.head 9 +  Else
.head 10 -  Set sSELECT_=sSELECT_ || ', ' || sEOL || '  ' || sDbFileds[nIndex]
.head 8 +  Else
.head 9 -  Break
.head 8 -  Set nIndex=nIndex+1
.head 7 -  ! Откуда
.head 7 -  Set sSELECT_=sSELECT_ || ' ' || sEOL || 'FROM ' || sSWTabname || ' WHERE ( ' || sEOL
.head 7 -  ! Когда
.head 7 -  Set nIndex=0
.head 7 +  Loop
.head 8 +  If nIndex>99
.head 9 -  Break
.head 8 +  If sPK[nIndex]
.head 9 +  If nIndex=0
.head 10 -  Set sSELECT_=sSELECT_ || '  ' || sPK[nIndex]
.head 9 +  Else
.head 10 -  Set sSELECT_=sSELECT_ || ', ' || sEOL || '  ' || sPK[nIndex]
.head 8 +  Else
.head 9 -  Break
.head 8 -  Set nIndex=nIndex+1
.head 7 -  Set sSELECT_=sSELECT_ || ' ) '  || sEOL || '  NOT IN ' || sEOL || '  (SELECT ' || sEOL
.head 7 -  Set nIndex=0
.head 7 +  Loop
.head 8 +  If nIndex>99
.head 9 -  Break
.head 8 +  If sPK[nIndex]
.head 9 -  Set nIndex2=IndexOf( sDbFileds, sPK[nIndex] )
.head 9 +  If nIndex2 != -1
.head 10 +  If nIndex=0
.head 11 -  Set sSELECT_=sSELECT_ || '  ' || sFlFields[nIndex2]
.head 10 +  Else
.head 11 -  Set sSELECT_=sSELECT_ || ', ' || sEOL || '  ' || sFlFields[nIndex2]
.head 9 +  Else
.head 10 -  Call SalMessageBox( 'Не найдено соответствие полю первичного ключа ' || sPK[nIndex], 'Ощибка', MB_IconStop )
.head 10 -  Return FALSE
.head 8 +  Else
.head 9 -  Break
.head 8 -  Set nIndex=nIndex+1
.head 7 -  Set sSELECT_=sSELECT_ || '  ' || sEOL || '   FROM ' || sSWTabnameInt || ')'
.head 7 -  !
.head 7 -  Break
.head 5 +  If cbINSERT
.head 6 -  Set sINSERT_='INSERT INTO ' || sSWTabname || ' ( ' || sEOL
.head 6 -  ! Что
.head 6 -  Set nIndex=0
.head 6 +  Loop
.head 7 +  If nIndex>99
.head 8 -  Break
.head 7 +  If sDbFileds[nIndex]
.head 8 +  If nIndex=0
.head 9 -  Set sINSERT_=sINSERT_ || sDbFileds[nIndex]
.head 8 +  Else
.head 9 -  Set sINSERT_=sINSERT_ || ', ' || sEOL || sDbFileds[nIndex]
.head 7 +  Else
.head 8 -  Break
.head 7 -  Set nIndex=nIndex+1
.head 6 -  Set sINSERT_=sINSERT_ || ') ' || sEOL || '  SELECT ' || sEOL
.head 6 -  ! Что
.head 6 -  Set nIndex=0
.head 6 +  Loop
.head 7 +  If nIndex>99
.head 8 -  Break
.head 7 +  If sFlFields[nIndex]
.head 8 +  If nIndex=0
.head 9 -  Set sINSERT_=sINSERT_ || '    ' || sFlFields[nIndex]
.head 8 +  Else
.head 9 -  Set sINSERT_=sINSERT_ || ', ' || sEOL || '    ' || sFlFields[nIndex]
.head 7 +  Else
.head 8 -  Break
.head 7 -  Set nIndex=nIndex+1
.head 6 -  ! Откуда
.head 6 -  Set sINSERT_=sINSERT_ || ' ' || sEOL || '  FROM ' || sSWTabnameInt || ' WHERE ( ' || sEOL
.head 6 -  ! Когда
.head 6 -  Set nIndex=0
.head 6 +  Loop
.head 7 +  If nIndex>99
.head 8 -  Break
.head 7 +  If sPK[nIndex]
.head 8 -  Set nIndex2=IndexOf( sDbFileds, sPK[nIndex] )
.head 8 +  If nIndex2 != -1
.head 9 +  If nIndex=0
.head 10 -  Set sINSERT_=sINSERT_ || '    ' || sFlFields[nIndex2]
.head 9 +  Else
.head 10 -  Set sINSERT_=sINSERT_ || ', ' || sEOL || '    ' || sFlFields[nIndex2]
.head 8 +  Else
.head 9 -  Call SalMessageBox( 'Не найдено соответствие полю первичного ключа ' || sPK[nIndex], 'Ощибка', MB_IconStop )
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 -  Break
.head 7 -  Set nIndex=nIndex+1
.head 6 -  Set sINSERT_=sINSERT_ || ' ) '  || sEOL || '    NOT IN ' || sEOL || '    (SELECT ' || sEOL
.head 6 -  Set nIndex=0
.head 6 +  Loop
.head 7 +  If nIndex>99
.head 8 -  Break
.head 7 +  If sPK[nIndex]
.head 8 +  If nIndex=0
.head 9 -  Set sINSERT_=sINSERT_ || '      ' || sPK[nIndex]
.head 8 +  Else
.head 9 -  Set sINSERT_=sINSERT_ || ', ' || sEOL || '      ' || sPK[nIndex]
.head 7 +  Else
.head 8 -  Break
.head 7 -  Set nIndex=nIndex+1
.head 6 -  Set sINSERT_=sINSERT_ || '  ' || sEOL || '     FROM ' || sSWTabname || ')'
.head 5 +  If cbUPDATE
.head 6 -  Set sUPDATE_='UPDATE ' || sSWTabname || ' SET ' || sEOL
.head 6 -  ! Что
.head 6 -  Set nIndex=0
.head 6 +  Loop
.head 7 +  If nIndex>99
.head 8 -  Break
.head 7 +  If sCompare[nIndex]
.head 8 +  If nIndex=0
.head 9 -  Set sUPDATE_=sUPDATE_ || '  ' ||
sCompare[nIndex] || ' = (' || GetSelectData( sCompare[nIndex] ) || ') '
.head 8 +  Else
.head 9 -  Set sUPDATE_=sUPDATE_ || ', ' || sEOL || '  ' ||
sCompare[nIndex] || ' = (' || GetSelectData( sCompare[nIndex] ) || ') '
.head 7 +  Else
.head 8 -  Break
.head 7 -  Set nIndex=nIndex+1
.head 6 -  ! Когда
.head 6 -  Set sUPDATE_=sUPDATE_ || sEOL || 'WHERE ( ' || sEOL
.head 6 -  Set nIndex=0
.head 6 +  Loop
.head 7 +  If nIndex>99
.head 8 -  Break
.head 7 +  If sPK[nIndex]
.head 8 +  If nIndex=0
.head 9 -  Set sUPDATE_=sUPDATE_ || '  ' || sPK[nIndex]
.head 8 +  Else
.head 9 -  Set sUPDATE_=sUPDATE_ || ', ' || sEOL || '  ' || sPK[nIndex]
.head 7 +  Else
.head 8 -  Break
.head 7 -  Set nIndex=nIndex+1
.head 6 -  Set sUPDATE_=sUPDATE_ || ' ) '  || sEOL || '    IN ' || sEOL || '  (SELECT ' || sEOL
.head 6 -  Set nIndex=0
.head 6 +  Loop
.head 7 +  If nIndex>99
.head 8 -  Break
.head 7 +  If sPK[nIndex]
.head 8 +  ! If nIndex=0
.head 9 -       Set sUPDATE_=sUPDATE_ || sPK[nIndex]
.head 8 +  ! Else
.head 9 -       Set sUPDATE_=sUPDATE_ || ', ' || sEOL || sPK[nIndex]
.head 8 -  Set nIndex2=IndexOf( sDbFileds, sPK[nIndex] )
.head 8 +  If nIndex2 != -1
.head 9 +  If nIndex=0
.head 10 -  Set sUPDATE_=sUPDATE_ || '    ' || sFlFields[nIndex2]
.head 9 +  Else
.head 10 -  Set sUPDATE_=sUPDATE_ || ', ' || sEOL || '    ' || sFlFields[nIndex2]
.head 8 +  Else
.head 9 -  Call SalMessageBox( 'Не найдено соответствие полю первичного ключа ' || sPK[nIndex], 'Ощибка', MB_IconStop )
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 -  Break
.head 7 -  Set nIndex=nIndex+1
.head 6 -  Set sUPDATE_=sUPDATE_ || sEOL || '   FROM ' || sSWTabnameInt || ')'
.head 5 +  If cbDELETE
.head 6 -  Set sDELETE_='DELETE FROM ' || sSWTabname || sEOL
.head 6 -  ! Когда
.head 6 -  Set sDELETE_=sDELETE_ || 'WHERE ( ' || sEOL
.head 6 -  Set nIndex=0
.head 6 +  Loop
.head 7 +  If nIndex>99
.head 8 -  Break
.head 7 +  If sPK[nIndex]
.head 8 +  If nIndex=0
.head 9 -  Set sDELETE_=sDELETE_ || '  ' || sPK[nIndex]
.head 8 +  Else
.head 9 -  Set sDELETE_=sDELETE_ || ', ' || sEOL || '  ' || sPK[nIndex]
.head 7 +  Else
.head 8 -  Break
.head 7 -  Set nIndex=nIndex+1
.head 6 -  Set sDELETE_=sDELETE_ || ' ) '  || sEOL || '  NOT IN ' || sEOL || '  (SELECT ' || sEOL
.head 6 -  Set nIndex=0
.head 6 +  Loop
.head 7 +  If nIndex>99
.head 8 -  Break
.head 7 +  If sPK[nIndex]
.head 8 -  Set nIndex2=IndexOf( sDbFileds, sPK[nIndex] )
.head 8 +  If nIndex2 != -1
.head 9 +  If nIndex=0
.head 10 -  Set sDELETE_=sDELETE_ || '    ' || sFlFields[nIndex2]
.head 9 +  Else
.head 10 -  Set sDELETE_=sDELETE_ || ', ' || sEOL || '    ' || sFlFields[nIndex2]
.head 8 +  Else
.head 9 -  Call SalMessageBox( 'Не найдено соответствие полю первичного ключа ' || sPK[nIndex], 'Ощибка', MB_IconStop )
.head 9 -  Return FALSE
.head 7 +  Else
.head 8 -  Break
.head 7 -  Set nIndex=nIndex+1
.head 6 -  Set sDELETE_=sDELETE_ || sEOL || '   FROM ' || sSWTabnameInt || ')'
.head 5 -  Return TRUE
.head 3 +  Function: IndexOf
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  String: sArray[100]
.head 5 -  String: Value
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: i
.head 5 -  Number: Result
.head 4 +  Actions
.head 5 -  Set i=0
.head 5 -  Set Result=-1
.head 5 +  Loop
.head 6 +  If i>99
.head 7 -  Break
.head 6 +  If sArray[i]=Value
.head 7 -  Set Result=i
.head 7 -  Break
.head 6 -  Set i=i+1
.head 5 -  Return Result
.head 3 +  Function: GetSelectData
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: sField
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nIndex
.head 5 -  Number: nIndex2
.head 5 -  String: Result
.head 4 +  Actions
.head 5 -  Set Result='SELECT ' || sFlFields[ IndexOf( sDbFileds, sField ) ] || 
' FROM ' || sSWTabnameInt || ' WHERE '
.head 5 -  ! Когда
.head 5 -  Set nIndex=0
.head 5 +  Loop
.head 6 +  If nIndex>99
.head 7 -  Break
.head 6 +  If sPK[nIndex]
.head 7 -  Set nIndex2=IndexOf( sDbFileds, sPK[nIndex] )
.head 7 +  If nIndex2 != -1
.head 8 +  If nIndex=0
.head 9 -  Set Result=Result || 
sFlFields[nIndex2] || '=' || sSWTabname || '.' || sPK[nIndex]
.head 8 +  Else
.head 9 -  Set Result=Result || ' AND ' ||  
sFlFields[nIndex2] || '=' || sSWTabname || '.' || sPK[nIndex]
.head 7 +  Else
.head 8 -  Call SalMessageBox( 'Не найдено соответствие полю первичного ключа ' || sPK[nIndex], 'Ощибка', MB_IconStop )
.head 8 -  Return ''
.head 6 +  Else
.head 7 -  Break
.head 6 -  Set nIndex=nIndex+1
.head 5 -  Return Result
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  : cCnc
.head 4 -  Class: cABSConnect
.head 3 -  Boolean: fExists
.head 3 -  Number: nFetchRes
.head 3 -  Number: nTMP
.head 3 -  Long String: sSELECT_L
.head 3 -  Long String: sINSERT_L
.head 3 -  Long String: sUPDATE_L
.head 3 -  Long String: sDELETE_L
.head 3 -  Boolean: fError
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  ! Создаем соединение
.head 4 -  Call XConnectGetParams(cCnc)
.head 4 +  If NOT cCnc.Connect()
.head 5 -  Call SalEndDialog( hWndForm, 0 )
.head 3 +  On SAM_Destroy
.head 4 -  Call cCnc.Disconnect()
.head 1 +  Table Window: frm_DBFSyncDiff
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Изменения доступные для синхронизации
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  10.6"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.012"
.head 4 -  Height Editable? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  View: Table
.head 3 -  Allow Row Sizing? No
.head 3 -  Lines Per Row: Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Default
.head 3 -  Discardable? Yes
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.405"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 -  Frame
.head 5 -  Resource Id: 56624
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.233"
.head 6 -  Top:    0.063"
.head 6 -  Width:  4.25"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.262"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Corners: Square
.head 5 -  Border Style: Solid
.head 5 -  Border Thickness: 1
.head 5 -  Border Color: Default
.head 5 -  Background Color: System Window Color
.head 4 -  Background Text: Новые
.head 5 -  Resource Id: 56625
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.333"
.head 6 -  Top:    0.083"
.head 6 -  Width:  1.15"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Center
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Dark Green
.head 5 -  Background Color: System Window Color
.head 4 -  Background Text: Измененные
.head 5 -  Resource Id: 56626
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.533"
.head 6 -  Top:    0.083"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Center
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Midnight Blue
.head 5 -  Background Color: System Window Color
.head 4 -  Background Text: Удаленные
.head 5 -  Resource Id: 56627
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.933"
.head 6 -  Top:    0.083"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Center
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: None
.head 5 -  Text Color: Dark Red
.head 5 -  Background Color: System Window Color
.head 4 -  Background Text: Количество расхождений:
.head 5 -  Resource Id: 56628
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.583"
.head 6 -  Top:    0.095"
.head 6 -  Width:  2.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dfCount
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   7.583"
.head 7 -  Top:    0.12"
.head 7 -  Width:  1.1"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.179"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 -  Contents
.head 2 +  Functions
.head 3 +  Function: GetCount
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  String: sSql
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sSqlS
.head 5 -  Number: nRCount
.head 5 -  Number: nFetchRes
.head 4 +  Actions
.head 5 -  ! Заменить на Сount(*) 
.head 5 -  Set sSqlS = 'SELECT  COUNT(*) INTO :nRCount FROM ( ' ||
	    sSql || ')'
.head 5 +  If SqlPrepareAndExecute( cCnc.hSql(), sSqlS )
.head 6 +  If SqlFetchNext( cCnc.hSql(), nFetchRes )
.head 7 -  Return nRCount
.head 6 +  Else
.head 7 -  Return -1
.head 5 +  Else
.head 6 -  Return -1
.head 5 -  Return 0
.head 2 +  Window Parameters
.head 3 -  String: sSqlSelect
.head 3 -  String: sTitle
.head 2 +  Window Variables
.head 3 -  : cCnc
.head 4 -  Class: cABSConnect
.head 3 -  Boolean: fRowHidden
.head 3 -  String: sColData
.head 3 -  Number: nColData
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set fRowHidden = FALSE
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call XConnectGetParams( cCnc )
.head 4 -  Call SalSetWindowText( hWndForm, 'Изменения доступные для синхронизации[' || 
sTitle || ']' )
.head 4 +  If not cCnc.Connect()
.head 5 -  Call SalDestroyWindow( hWndForm )
.head 4 -  Set dfCount = GetCount( sSqlSelect )
.head 4 +  If dfCount > 0
.head 5 -  Set sSqlSelect=sSqlSelect || ' 
ORDER BY 1,2'
.head 5 +  If SalTblPopulate( hWndForm, cCnc.hSql(), sSqlSelect, TBL_FillAll )
.head 6 -  Call VisTblAutoSizeColumn( hWndForm, hWndNULL )
.head 4 +  Else
.head 5 -  Call SalDestroyWindow( hWndForm )
.head 5 +  If dfCount=0
.head 6 -  Call SalMessageBox( 'Таблицы идентичны!', 'Синхронизация', 0 )
.head 3 +  On SAM_FetchRowDone
.head 4 -  ! Прячем первую колонку (она определяет тип)
1 - новые записи
2 - измененные записи
3 - удаленные записи
.head 4 +  If not fRowHidden
.head 5 -  Call SalHideWindow( SalTblGetColumnWindow( hWndForm, 1, COL_GetID ) )
.head 5 -  Set fRowHidden=TRUE
.head 4 +  If SalTblGetColumnText( 
	hWndForm, 
	1, 
	sColData )
.head 5 -  Set nColData = SalStrToNumber( sColData )
.head 5 +  Select Case nColData
.head 6 +  Case 1 
.head 7 -  Call VisTblSetRowColor( hWndForm, lParam, COLOR_DarkGreen )
.head 7 -  Break
.head 6 +  Case 2
.head 7 -  Call VisTblSetRowColor( hWndForm, lParam, COLOR_DarkBlue )
.head 7 -  Break
.head 6 +  Case 3
.head 7 -  Call VisTblSetRowColor( hWndForm, lParam, COLOR_DarkRed )
.head 7 -  Break
.head 1 +  Form Window: Frm_SPar
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  5.2"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.393"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tblSPAll
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.667"
.head 6 -  Top:    0.0"
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.781"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: №
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCode
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Доступные параметры
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nOrderBy
.head 5 -  Window Handle: hColumn
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndItem, TBL_Flag_SelectableCols, TRUE)
.head 6 -  Set nOrderBy = 1
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 6 -  Set nOrderBy = Not nOrderBy
.head 6 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(hColumn), nOrderBy)
.head 6 -  Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 +  Pushbutton: pbAdd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbBrowse
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.524"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Undo.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(tblSPAll, nRow, ROW_Selected, 0)
.head 7 -  Call SalTblSetContext(tblSPAll, nRow)
.head 7 +  If SqlPrepareAndExecute(hSql(), 
"INSERT INTO ps_sparam(nbs, spid)
 VALUES(:pNBS, :tblSPAll.colId) ")
.head 8 -  Call SqlCommit(hSql())
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 6 -  Call SalSendMsg(Frm_PSSP.tblSP, UM_Populate, 0, 0)
.head 6 -  Call SalWaitCursor(FALSE)
.head 3 +  Pushbutton: pbDrop
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: ctb_pbBrowse
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    1.012"
.head 5 -  Width:  0.433"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.321"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\Undo1.bmp
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Call SqlPrepareAndExecute(hSql(), 
"SELECT count(nbs) 
 INTO :nCount 
 FROM ps_sparam 
 WHERE nbs=:tblPS.colNBS ")
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If nCount = 0 AND SalTblAnyRows(Frm_PSSP.tblSP, ROW_Selected, 0)
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(Frm_PSSP.tblSP, nRow, 0, 0)
.head 8 -  Call SalTblSetContext(Frm_PSSP.tblSP, nRow)
.head 8 -  Call SqlPrepareAndExecute(hSql(), 
"INSERT INTO ps_sparam(nbs,spid) 
 VALUES(:Frm_PSSP.tblPS.colNBS,:Frm_PSSP.tblSP.colId)")
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(Frm_PSSP.tblSP, nRow, ROW_Selected, 0)
.head 7 -  Call SalTblSetContext(Frm_PSSP.tblSP, nRow)
.head 7 +  If SqlPrepareAndExecute(hSql(), 
"DELETE FROM ps_sparam
 WHERE nbs=:pNBS AND spid=:tblSP.colId")
.head 8 -  Call SqlCommit(hSql())
.head 7 +  Else
.head 8 -  Call SqlRollback(hSql())
.head 6 -  Call SalSendMsg(Frm_PSSP.tblSP, UM_Populate, 0, 0)
.head 6 -  Call SalWaitCursor(FALSE)
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nRow
.head 3 -  Number: nTblRow
.head 3 -  String: sNBS
.head 3 -  Number: nCount
.head 3 -  !
.head 3 -  Number: nWinX0
.head 3 -  Number: nWinY0
.head 3 -  Number: nWinWidth
.head 3 -  Number: nWinHeigh
.head 3 -  Number: nTblX0
.head 3 -  Number: nTblY0
.head 3 -  Number: nTblWidth
.head 3 -  Number: nTblHeigh
.head 3 -  Number: nX
.head 3 -  Number: nY
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeigh)
.head 4 -  Call SalSetWindowSize(hWndForm.Frm_SPar.tblSPAll, 
	SalPixelsToFormUnits(hWndForm.Frm_SPar.tblSPAll, nWinWidth, FALSE) - 0.7,
	SalPixelsToFormUnits(hWndForm.Frm_SPar.tblSPAll, nWinHeigh, TRUE) - 0.01)
.head 4 -  Call GetClientRect(hWndForm.Frm_SPar.tblSPAll, nTblX0, nTblY0, nTblWidth, nTblHeigh)
.head 4 +  If SalPixelsToFormUnits(hWndForm.Frm_SPar.tblSPAll, nTblWidth, FALSE) > 3.5
.head 5 -  Call SalTblSetColumnWidth(hWndForm.Frm_SPar.tblSPAll.colName,
	SalPixelsToFormUnits(hWndForm.Frm_SPar.tblSPAll, nTblWidth, FALSE) - 0.7 - 1.2)
.head 4 +  Else
.head 5 -  Call SalTblSetColumnWidth(hWndForm.Frm_SPar.tblSPAll.colName, 3.1 - 1.2)
.head 4 -  Call SalGetWindowLoc(hWndForm.Frm_SPar.tblSPAll, nX, nY)
.head 4 -  Call SalSetWindowLoc(hWndForm.Frm_SPar.pbAdd, nX-0.6,
              SalPixelsToFormUnits(hWndForm, nWinHeigh, TRUE)/2 - 0.6)
.head 4 -  Call SalSetWindowLoc(hWndForm.Frm_SPar.pbDrop, nX-0.6,
              SalPixelsToFormUnits(hWndForm, nWinHeigh, TRUE)/2 - 0.1)
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 1 +  ! Form Window: frm_UDBD
.winattr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Управление доступом к банковским дням
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  8.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.6"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.end
.head 2 -      Description: 
.head 2 -      Named Menus 
.head 2 -      Menu 
.head 2 +      Tool Bar 
.head 3 -      Contents 
.head 2 +      Contents 
.head 3 +      Custom Control: cCal
.data CLASSPROPSSIZE
0000: 2C00
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172001B000100 0000000100010000 0200000001000101
0020: 0101000000000001 00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 +      Message Actions 
.head 5 +      On SAM_CustControlCmd
.head 6 -  ! Call cCal.GetFocusDate( dFD )
.head 6 +  ! If cCal.IsSpecialDate(SPECIAL_OneTime, dFD, DAY_Unset,
   SEQ_Unset)
.head 7 -      Call cCal.SpecialDate(SPECIAL_OneTime, dBD,
     DAY_Unset, SEQ_Unset, COLOR_Blue,
     COLOR_Cyan, TRUE)
.head 7 -      Set dBD = dFD
.head 7 -      Call cCal.SpecialDate(SPECIAL_OneTime, dBD,
     DAY_Unset, SEQ_Unset, COLOR_Blue,
     COLOR_Yellow, TRUE)
.head 5 +      On SAM_Create
.head 6 -      Call cCal.WeekStartSet(2)
.head 3 +      Radio Button: rbD
.head 4 -      Message Actions 
.head 3 +      Radio Button: rbZ
.head 4 -      Message Actions 
.head 3 -      Group Box: Статус дня
.head 3 +      Pushbutton: pbEx
.head 4 +      Message Actions 
.head 5 +      On SAM_Click
.head 6 -      Call cCal.GetFocusDate( dFD )
.head 6 +      If rbD
.head 7 -      Set nStat=0
.head 6 +      If rbZ
.head 7 -      Set nStat=9
.head 6 -      Call SqlPrepareAndExecute( hSql(), '
   SELECT count(*) INTO :nCount
   FROM fdat WHERE fdat=:dFD' )
.head 6 +      If SqlFetchNext( hSql(), nFetchRes )
.head 7 +      If nCount=0
.head 8 -      Call SqlPrepareAndExecute( hSql(), '
   INSERT INTO fdat VALUES(:dFD,:nStat)' )
.head 7 +      Else 
.head 8 -      Call SqlPrepareAndExecute( hSql(), '
   UPDATE fdat SET stat=:nStat WHERE fdat=:dFD' )
.head 6 -      Call SalSendMsg( hWndForm, SAM_User, 0, 0 )
.head 3 +      Pushbutton: pbClose
.head 4 +      Message Actions 
.head 5 +      On SAM_Click
.head 6 -      Call SalDestroyWindow( hWndForm )
.head 2 -      Functions 
.head 2 -      Window Parameters 
.head 2 +      Window Variables 
.head 3 -      String: smWeek[7]
.head 3 -      String: smMonth[12]
.head 3 -      Date/Time: dBD
.head 3 -      Date/Time: dFD
.head 3 -      Number: nFetchRes
.head 3 -  ! Number: i
.head 3 -      Number: nStat
.head 3 -      Number: nCount
.head 2 +      Message Actions 
.head 3 +      On SAM_Create
.head 4 -      Call SalCenterWindow( hWndForm )
.head 4 -      Set rbD = TRUE
.head 4 -      Set rbZ = FALSE
.head 4 -  ! Set nUid = GetUserId()
.head 4 -      Set dBD = GetBankDate()
.head 4 -      Call SalWaitCursor( TRUE )
.head 4 -      Call cCal.ClearSpecials()
.head 4 -      Call SalSetFocus( cCal )
.head 4 -      Call GetMonthArrayRus( smMonth )
.head 4 -      Call GetWeekDayArray( smWeek )
.head 4 -      Call cCal.SetMonthText( smMonth )
.head 4 -      Call cCal.SetWeekDayText( smWeek )
.head 4 -      Call cCal.SpecialDate(SPECIAL_Weekly,
     DATETIME_Null, DAY_Sunday, SEQ_Unset,
     COLOR_Black, COLOR_Gray, TRUE)
.head 4 -      Call cCal.SpecialDate(SPECIAL_Weekly,
     DATETIME_Null, DAY_Monday, SEQ_Unset,
     COLOR_Black, COLOR_Gray, TRUE)
.head 4 -      Call cCal.SpecialDate(SPECIAL_Weekly,
     DATETIME_Null, DAY_Tuesday, SEQ_Unset,
     COLOR_Black, COLOR_Gray, TRUE)
.head 4 -      Call cCal.SpecialDate(SPECIAL_Weekly,
     DATETIME_Null, DAY_Wednesday, SEQ_Unset,
     COLOR_Black, COLOR_Gray, TRUE)
.head 4 -      Call cCal.SpecialDate(SPECIAL_Weekly,
     DATETIME_Null, DAY_Thursday, SEQ_Unset,
     COLOR_Black, COLOR_Gray, TRUE)
.head 4 -      Call cCal.SpecialDate(SPECIAL_Weekly,
     DATETIME_Null, DAY_Friday, SEQ_Unset,
     COLOR_Black, COLOR_Gray, TRUE)
.head 4 -      Call cCal.SpecialDate(SPECIAL_Weekly,
     DATETIME_Null, DAY_Saturday, SEQ_Unset,
     COLOR_Black, COLOR_Gray, TRUE)
.head 4 -      Call SalSendMsg( hWndForm, SAM_User, 0, 0 )
.head 3 +      On SAM_User
.head 4 -      Call SqlPrepareAndExecute(hSql(), T("
     SELECT fdat, stat
     INTO :dFD, :nStat
     FROM fdat"))
.head 4 -  ! Set i = 0
.head 4 +      While SqlFetchNext( hSql(), nFetchRes )
.head 5 -  ! Call cCal.SpecialDate(SPECIAL_OneTime, dSelect,
     DAY_Unset, SEQ_Unset, COLOR_Blue,
     COLOR_Cyan, TRUE)
.head 5 +      If nStat=9
.head 6 -      Call cCal.SpecialDate(SPECIAL_OneTime, dFD,
     DAY_Unset, SEQ_Unset, COLOR_Black,
     COLOR_Red, TRUE)
.head 5 +      Else If nStat=0
.head 6 -      Call cCal.SpecialDate(SPECIAL_OneTime, dFD,
     DAY_Unset, SEQ_Unset, COLOR_Black,
     COLOR_DarkGreen, TRUE)
.head 5 +      Else 
.head 6 -      Call cCal.SpecialDate(SPECIAL_OneTime, dFD,
     DAY_Unset, SEQ_Unset, COLOR_Black,
     COLOR_White, TRUE)
.head 5 -  ! Set i = i + 1
.head 4 +  ! If i = 0
.head 5 -      Call SalHideWindow( cCal )
.head 5 -      Call SalHideWindow( pbEx )
.head 5 -      Call SalSetFocus( pbClose )
.head 4 +  ! Else
.head 5 -      Call cCal.SetFocusDate( dBD )
.head 4 -      Call cCal.SetFocusDate( dBD )
.head 4 -      Call SalWaitCursor(FALSE)
.head 1 +  Table Window: tbl_RefRRP
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.28"
.head 4 -  Top:    1.067"
.head 4 -  Width:  10.7"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.0"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 30000
.head 3 -  Discardable? Class Default
.head 2 -  Description: Справочник к/с банков
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 37012
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 37013
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 37014
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: colMFO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование банка
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  4.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SqlPrepareAndExecute(hSql(), 
"SELECT mfo INTO :s1
 FROM banks WHERE nb=:colName")
.head 6 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalMessageBox('Неверное наименование банка', 'Внимание!' , 0)
.head 7 -  Set colName = ''
.head 6 +  Else
.head 7 -  Set colAccK = nAcc
.head 6 -  Return VALIDATE_Ok
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalStatusSetText(hWndForm, 'F4 - справочник')
.head 5 +  On SAM_DoubleClick
.head 6 +  If FunNSIGet('BANKS', '', sMFO, sName)
.head 7 -  Set nRow = SalTblQueryContext(tbl_RefRRP)
.head 7 -  Call SalTblSetRowFlags(tbl_RefRRP, nRow, ROW_Edited, TRUE)
.head 7 -  Set colName = sName
.head 7 -  Set colMFO  = sMFO
.head 5 +  On VTM_KeyDown
.head 6 +  If wParam = VK_F4
.head 7 -  Call SalSendMsg(hWndItem, SAM_DoubleClick, 0, 0)
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalStatusSetText(hWndForm, '')
.head 3 +  Column: colTS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Тип
счета
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал.
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If colNLSK != ''
.head 7 -  Call SqlPrepareAndExecute(hSql(), 
"SELECT acc FROM accounts WHERE nls=:colNLSK and kv=:colKV")
.head 7 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SalMessageBox('Счет ' || colNLSK || '/' || Str(colKV) || ' не найден.', 'Внимание!' , 0)
.head 8 -  Set colKV = NUMBER_Null
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: colAccK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: acc (Кредит)
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNLSK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
(Кредит)
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If colKV = NUMBER_Null
.head 7 -  Call SqlPrepareAndExecute(hSql(), 
"SELECT acc,kv INTO :nAcc, :nKV FROM accounts WHERE nls=:colNLSK")
.head 7 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SalMessageBox('Неверный номер счета', 'Внимание!' , 0)
.head 8 -  Set colNLSK = ''
.head 8 -  Set colKV = NUMBER_Null
.head 7 +  Else
.head 8 -  Set colAccK = nAcc
.head 8 -  Set colKV = nKV
.head 6 +  Else
.head 7 -  Call SqlPrepareAndExecute(hSql(), 
"SELECT acc INTO :nAcc FROM accounts WHERE nls=:colNLSK and kv=:colKV")
.head 7 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SalMessageBox('Счет ' || colNLSK || '/' || Str(colKV) || ' не найден.', 'Внимание!' , 0)
.head 8 -  Set colNLSK = ''
.head 8 -  Set colKV = NUMBER_Null
.head 8 -  Set colAccK = NUMBER_Null
.head 7 +  Else
.head 8 -  Set colAccK = nAcc
.head 6 -  Call SalSendMsg(hWndItem, SAM_User, 0, 0)
.head 5 +  On SAM_User
.head 6 -  Call SqlPrepareAndExecute(hSql(), 
"SELECT mfo,ts INTO :sMFO, :nTS 
 FROM rrp
 WHERE acck=:colAccK and mfo<>:cMFO and ts<>:cTS")
.head 6 +  If SqlFetchNext(hSql(), nFetchRes)
.head 7 +  If SalMessageBox('Счет '|| colNLSK ||' уже используется (' || sMFO || '/' || Str(nTS) || ').
Заменить ?', 'Внимание', MB_YesNo) = IDNO
.head 8 -  Set colNLSK = ''
.head 8 -  Set colAccK = NUMBER_Null
.head 8 -  Set colKV = NUMBER_Null
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalStatusSetText(hWndForm, 'F4 - справочник')
.head 5 +  On SAM_DoubleClick
.head 6 +  If FunNSIGet('ACCOUNTS', '', sAcc, sNLS)
.head 7 -  Set nRow = SalTblQueryContext(tbl_RefRRP)
.head 7 -  Call SalTblSetRowFlags(tbl_RefRRP, nRow, ROW_Edited, TRUE)
.head 7 -  Set colNLSK = sNLS
.head 7 -  Set colAccK = Val(sAcc)
.head 7 +  If SqlPrepareAndExecute(hSql(), 
"SELECT kv INTO :nKV FROM accounts WHERE acc=:colAccK") 
and SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Set colKV = nKV
.head 7 -  Call SalSendMsg(hWndItem, SAM_User, 0, 0)
.head 5 +  On VTM_KeyDown
.head 6 +  If wParam = VK_F4
.head 7 -  Call SalSendMsg(hWndItem, SAM_DoubleClick, 0, 0)
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalStatusSetText(hWndForm, '')
.head 3 +  Column: colAccD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: acc (Дебет)
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNLSD
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Счет
(Дебет)
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.5"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SqlPrepareAndExecute(hSql(), 
"SELECT acc INTO :nAcc FROM accounts WHERE nls=:colNLSD and kv=:colKV")
.head 6 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 7 +  If colNLSD != ''
.head 8 -  Call SalMessageBox('Неверный номер счета.', 'Внимание!' , 0)
.head 8 -  Set colNLSD = ''
.head 7 -  Set colAccD = NUMBER_Null
.head 6 +  Else
.head 7 -  Set colAccD = nAcc
.head 7 +  If colAccK = colAccD
.head 8 -  Set colNLSD = ''
.head 8 -  Set colAccD = NUMBER_Null
.head 6 -  Call SalSendMsg(hWndItem, SAM_User, 0, 0)
.head 5 +  On SAM_User
.head 6 -  Call SqlPrepareAndExecute(hSql(), 
"SELECT a.nls INTO :sNLS
 FROM acc_over o, accounts a
 WHERE o.acc=a.acc and o.acco=:colAccD")
.head 6 +  If SqlFetchNext(hSql(), nFetchRes)
.head 7 +  If SalMessageBox('Счет '|| colNLSD ||' уже используется (счет ' || sNLS || ')).
Заменить ?', 'Внимание', MB_YesNo) = IDNO
.head 8 -  Set colNLSD = ''
.head 8 -  Set colAccD = NUMBER_Null
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalStatusSetText(hWndForm, 'F4 - справочник')
.head 5 +  On SAM_DoubleClick
.head 6 +  If FunNSIGet('ACCOUNTS', '', sAcc, sNLS)
.head 7 -  Set nRow = SalTblQueryContext(tbl_RefRRP)
.head 7 -  Call SalTblSetRowFlags(tbl_RefRRP, nRow, ROW_Edited, TRUE)
.head 7 -  Set colNLSD = sNLS
.head 7 -  Set colAccD = Val(sAcc)
.head 7 +  If SqlPrepareAndExecute(hSql(), 
"SELECT kv INTO :nKV FROM accounts WHERE acc=:colAccD") 
and SqlFetchNext(hSql(), nFetchRes)
.head 8 +  If colKV != nKV
.head 9 -  Call SalMessageBox('Неверный номер счета
( не совпадает код валюты ).', 'Внимание!' , 0)
.head 9 -  Set colNLSD = ''
.head 7 -  Call SalSendMsg(hWndItem, SAM_User, 0, 0)
.head 5 +  On VTM_KeyDown
.head 6 +  If wParam = VK_F4
.head 7 -  Call SalSendMsg(hWndItem, SAM_DoubleClick, 0, 0)
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalStatusSetText(hWndForm, '')
.head 3 +  Column: colRP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
РП
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNumRP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Номер
РП
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.7"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  Call SqlPrepareAndExecute(hSql(), 
"SELECT rp INTO :sRP FROM rrp WHERE substr(rp,1,1)=:colNumRP")
.head 6 +  If not SqlFetchNext(hSql(), nFetchRes)
.head 7 -  Call SalMessageBox('Неверный номер РП', 'Внимание!' , 0)
.head 7 -  Set colNumRP = ''
.head 6 +  Else
.head 7 -  Set colRP = sRP
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalStatusSetText(hWndForm, 'F4 - справочник')
.head 5 +  On SAM_DoubleClick
.head 6 +  If FunNSIGet('RRP_SAB', '', sRP, sNumRP)
.head 7 -  Set nRow = SalTblQueryContext(tbl_RefRRP)
.head 7 -  Call SalTblSetRowFlags(tbl_RefRRP, nRow, ROW_Edited, TRUE)
.head 7 -  ! Set colNumRP = sNumRP
.head 7 -  Set colNumRP = Subs(sRP, 1, 1)
.head 7 -  Set colRP = sRP
.head 5 +  On VTM_KeyDown
.head 6 +  If wParam = VK_F4
.head 7 -  Call SalSendMsg(hWndItem, SAM_DoubleClick, 0, 0)
.head 5 +  On SAM_KillFocus
.head 6 -  Call SalStatusSetText(hWndForm, '')
.head 3 +  Column: cMFO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: cTS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Тип
счета
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: strPopulate
.head 3 -  String: strFilter
.head 3 -  Number: nN
.head 3 -  String: sRP
.head 3 -  String: sNumRP
.head 3 -  String: sNLS
.head 3 -  String: sAcc
.head 3 -  Number: nRow
.head 3 -  Window Handle: hCol
.head 3 -  Number: nAcc
.head 3 -  Number: nKV
.head 3 -  String: sMFO
.head 3 -  Number: nTS
.head 3 -  String: sName
.head 3 -  Number: nLastSortRow
.head 3 -  Number: nSortOrder
.head 3 -  Window Handle: hColumn
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call SalSetWindowText(hWndForm, 'Справочник к/с банков')
.head 4 -  Call PrepareWindow(hWndForm)
.head 4 -  Set nLastSortRow = -1
.head 4 -  Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols, TRUE)
.head 4 -  Set tbl_RefRRP.strPrintFileName = 'KORS' || SalStrMidX(GetBankDateEx(),0,2) || SalStrMidX(GetBankDateEx(),3,2) || '.TXT'
.head 4 -  Set tbl_RefRRP.strFilterTblName = 'RRP'
.head 4 -  Set tbl_RefRRP.fFilterAtStart   = FALSE
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 4 -  Call cF.Init('RRP', 'r')
.head 3 +  On UM_Populate
.head 4 +  If fFilterAtStart
.head 5 -  Set fFilterAtStart = NOT fFilterAtStart
.head 5 +  If NOT SetQueryFilter(cF)
.head 6 -  Call SalDestroyWindow(hWndForm)
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Set strFilter = cF.GetFilterWhereClause(TRUE)
.head 4 -  Set strPopulate = 
"SELECT a.mfo, s.nb, a.ts, a.kv, a.acck, a.nls, b.acco, b.nls, a.rp, a.nrp, a.mfo, a.ts
 INTO :colMFO, :colName, :colTS, :colKV, :colAccK :colNLSK, :colAccD, :colNLSD, :colRP, :colNumRP, :cMFO, :cTS
 FROM (SELECT r.acck, r.mfo, r.ts, a.kv, a.nls, r.rp rp, SUBSTR(r.rp,1,1) nrp
       FROM rrp r, accounts a
       WHERE r.acck=a.acc "|| IifS(strFilter="",""," AND "||strFilter) ||" ) a,
      (SELECT o.acc, o.acco, a.nls
       FROM acc_over o, accounts a
       WHERE o.acco=a.acc) b,
      banks s
 WHERE a.acck=b.acc(+) AND a.mfo=s.mfo
 ORDER BY a.mfo, a.ts"
.head 4 -  Call SalTblPopulate(hWndForm, hSql(), strPopulate, TBL_FillAll)
.head 4 -  Call SalTblSetContext(hWndForm, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On UM_Update
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 -  Call SaveInfoToLog(MSG_SaveDataRef() || ' ' || strTitleAux)
.head 4 -  Set nRow = TBL_MinRow
.head 4 +  While SalTblFindNextRow(hWndForm, nRow, 0, 0)
.head 5 -  Call SalTblSetContext(hWndForm, nRow)
.head 5 -  ! ----- INSERT -----
.head 5 +  If SalTblQueryRowFlags(hWndForm, nRow, ROW_New)
.head 6 +  If colNLSD != ''
.head 7 -  Call SqlPrepareAndExecute(hSql(), "SELECT acco FROM acc_over WHERE acco=:colAccD")
.head 7 +  If SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SqlPrepareAndExecute(hSql(), 
"UPDATE acc_over SET acc=:colAccK WHERE acco=:colAccD")
.head 7 +  Else
.head 8 -  Call SqlPrepareAndExecute(hSql(), 
"INSERT INTO acc_over(acc,acco,tipo) VALUES (:colAccK, :colAccD, 14)")
.head 6 -  Call SqlPrepareAndExecute(hSql(), 
"INSERT INTO rrp(mfo,ts,acck,rp)
 VALUES (:colMFO, :colTS, :colAccK, :colRP)")
.head 5 -  ! ----- UPDATE -----
.head 5 +  If SalTblQueryRowFlags(hWndForm, nRow, ROW_Edited)
.head 6 +  If colAccK = colAccD
.head 7 -  Set colNLSD = ''
.head 7 -  Set colAccD = NUMBER_Null
.head 6 +  Else
.head 7 -  Call SqlPrepareAndExecute(hSql(), "SELECT acco FROM acc_over WHERE acco=:colAccD")
.head 7 +  If SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SqlPrepareAndExecute(hSql(), 
"UPDATE acc_over SET acc=:colAccK WHERE acco=:colAccD")
.head 8 -  Call SqlPrepareAndExecute(hSql(), 
"DELETE FROM acc_over WHERE acc=:colAccK and acco<>:colAccD")
.head 7 +  Else
.head 8 -  Call SqlPrepareAndExecute(hSql(), "SELECT acc FROM acc_over WHERE acc=:colAccK")
.head 8 +  If SqlFetchNext(hSql(), nFetchRes)
.head 9 +  If colNLSD != ''
.head 10 -  Call SqlPrepareAndExecute(hSql(), 
"UPDATE acc_over SET acco=:colAccD WHERE acc=:colAccK")
.head 9 +  Else
.head 10 -  Call SqlPrepareAndExecute(hSql(), 
"DELETE FROM acc_over WHERE acc=:colAccK")
.head 8 +  Else
.head 9 +  If colNLSD != ''
.head 10 -  Call SqlPrepareAndExecute(hSql(), 
"INSERT INTO acc_over(acc,acco,tipo) VALUES(:colAccK, :colAccD, 14)")
.head 6 -  Call SqlPrepareAndExecute(hSql(), 
"UPDATE rrp
 SET mfo=:colMFO, ts=:colTS, rp=:colRP, acck=:colAccK
 WHERE mfo=:cMFO and ts=:cTS")
.head 5 -  ! ----- DELETE -----
.head 5 +  If SalTblQueryRowFlags(tbl_RefRRP, nRow, ROW_MarkDeleted)
.head 6 -  Call SqlPrepareAndExecute(hSql(), 
"DELETE FROM rrp WHERE mfo=:cMFO and ts=:cTS")
.head 4 -  Call SqlCommit(hSql())
.head 4 -  Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 3 +  On SAM_ColumnSelectClick
.head 4 -  Call SalWaitCursor(TRUE)
.head 4 +  If wParam != nLastSortRow
.head 5 -  Set nLastSortRow = wParam
.head 5 -  Set nSortOrder = TBL_SortIncreasing
.head 4 +  Else
.head 5 -  Set nSortOrder = 1 - nSortOrder
.head 4 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 4 -  Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
.head 4 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(hColumn), nSortOrder)
.head 4 -  Call SalSendMsg(hWndForm, SAM_RowSetContext, 0, 0)
.head 4 -  Call SalWaitCursor(FALSE)
.head 1 +  Table Window: tblBanks
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Справочник участников Межбанковских расчетов
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.275"
.head 4 -  Top:    0.229"
.head 4 -  Width:  12.8"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 6.393"
.head 4 -  Height Editable? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 3 -  View: Table
.head 3 -  Allow Row Sizing? No
.head 3 -  Lines Per Row: Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 3000
.head 3 -  Discardable? No
.head 2 -  Description: Справочник участников Межбанковских расчетов (новая версия MIK)
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.536"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 -  !
.head 4 -  Background Text: МФО:
.head 5 -  Resource Id: 27319
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.233"
.head 6 -  Top:    0.198"
.head 6 -  Width:  0.55"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.179"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Bold
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Data Field: dfSeekMfo
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: 6
.head 6 -  Data Type: String
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.933"
.head 7 -  Top:    0.156"
.head 7 -  Width:  1.0"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFind
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSearch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.957"
.head 6 -  Top:    0.125"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set pbFind.strTip='Искать участника с заданым МФО'
.head 6 +  On SAM_Click
.head 7 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 7 -  !
.head 7 +  If bDirectAccess
.head 8 -  Set strSqlTxt="SELECT a.mfo, a.sab, a.nb, a.blk, a.fmi, 
a.fmo, a.pm, a.kodn, a.kodg, g.namg, a.nmo "
.head 8 -  Set strSqlTxt = strSqlTxt || "INTO :tblBanks.MFO, 
 :tblBanks.SAB, :tblBanks.NB, :tblBanks.BLK, :tblBanks.FMI,
 :tblBanks.FMO, :tblBanks.PM, :tblBanks.KODN, 
 :tblBanks.KODG, :tblBanks.KODGN, :tblBanks.NMO "
.head 7 +  Else
.head 8 -  Set strSqlTxt="SELECT a.mfo, a.mfop, a.sab, a.nb,
a.blk, a.kodg, g.namg, a.nmo "
.head 8 -  Set strSqlTxt = strSqlTxt || "INTO :tblBanks.MFO, 
:tblBanks.MFOP, :tblBanks.SAB, :tblBanks.NB,
:tblBanks.BLK,  :tblBanks.KODG, :strGrName,
:tblBanks.NMO "
.head 7 -  Set strSqlTxt=strSqlTxt || "FROM Banks a, OUTER Groupsb g WHERE "
.head 7 -  Set strSqlTxt=strSqlTxt || "g.kodg (+) = a.kodg AND "
.head 7 +  If dfSeekMfo != ''
.head 8 -  Set strSqlTxt = strSqlTxt || "a.mfo LIKE '" || StrMatches2Like( dfSeekMfo ) || "' AND "
.head 7 +  If bDirectAccess
.head 8 -  Set strSqlTxt = strSqlTxt || " a.mfop = :strBankMfo AND a.mfop IS NOT NULL "
.head 7 +  Else
.head 8 +  If strSeniorMfo != ''
.head 9 -  Set strSqlTxt = strSqlTxt || " a.mfop = :strSeniorMfo "
.head 8 +  Else
.head 9 -  Set strSqlTxt = strSqlTxt || "  a.mfop IS NULL "
.head 7 -  !
.head 7 -  Set strSqlTxt = strSqlTxt || "ORDER BY 1"
.head 7 -  !
.head 7 -  Call WaitCursorOn()
.head 7 -  Call SalTblPopulate( tblBanks, hSql(), T( strSqlTxt ), TBL_FillAll )
.head 7 -  Call WaitCursorOff()
.head 7 -  !
.head 7 -  Call SalTblSetFocusRow( tblBanks, 0 )
.head 7 -  !
.head 7 -  ! ////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.386"
.head 6 -  Top:    0.125"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Перечитать'
.head 6 +  On SAM_Click
.head 7 -  Call WaitCursorOn()
.head 7 -  Call SalTblPopulate( tblBanks, hSql(), T( strSqlTxt ), TBL_FillAll )
.head 7 -  Call WaitCursorOff()
.head 7 -  !
.head 7 -  Call SalTblSetFocusRow( tblBanks, 0 )
.head 4 -  Line
.head 5 -  Resource Id: 27320
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  5.443"
.head 6 -  Begin Y:  0.083"
.head 6 -  End X:  5.443"
.head 6 -  End Y:  0.469"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  !
.head 4 +  Pushbutton: pbBack
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: &<<
.head 5 -  Window Location and Size
.head 6 -  Left:   2.986"
.head 6 -  Top:    0.125"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.313"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If NOT bDirectAccess
.head 8 -  Call SalSendMsg( hWndForm, SAM_Create, 0, 0 )
.head 8 -  Call SalSendMsg( tblBanks, UM_Populate, 0, 0 )
.head 8 -  !
.head 8 -  Set bDirectAccess=TRUE
.head 8 -  Call SalEnableWindow( pbDown )
.head 8 -  Call SalEnableWindow( pbExit )
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Вернуться к "родительскому" МФО' )
.head 4 +  Pushbutton: pbDown
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: >&>
.head 5 -  Window Location and Size
.head 6 -  Left:   3.414"
.head 6 -  Top:    0.125"
.head 6 -  Width:  0.429"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.313"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: MS Sans Serif
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If bDirectAccess
.head 8 -  Call SalSendMsg( tblBanks, SAM_DoubleClick, 0, 0 )
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Показать "дочерние" МФО' )
.head 4 -  !
.head 4 +  Pushbutton: pbAdd
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbInsert
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.043"
.head 6 -  Top:    0.125"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set pbAdd.strTip='Добавить запись об участнике'
.head 6 +  On SAM_Click
.head 7 -  Set nNewRow =  SalTblInsertRow( tblBanks, TBL_MaxRow )
.head 7 +  If nNewRow != TBL_Error
.head 8 -  Call SalTblSetFocusCell( tblBanks, nNewRow, tblBanks.MFO, 0, -1 )
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDelete
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.486"
.head 6 -  Top:    0.125"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set pbDel.strTip='Удалить запись об участнике'
.head 6 +  On SAM_Click
.head 7 -  Call SalTblSetFlagsAnyRows( tblBanks, ROW_MarkDeleted, TRUE, ROW_Selected, 0 )
.head 4 +  Pushbutton: pbAccounts
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDetail
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.929"
.head 6 -  Top:    0.125"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set pbAccounts.strTip='Показать процессинговые счета учасника'
.head 7 +  If Not bDirectAccess
.head 8 -  Call SalDisableWindow( hWndItem )
.head 6 +  On SAM_Click
.head 7 -  Call ShowTechAccountsEx( SalStrToNumber( tblBanks.MFO ) )
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.571"
.head 6 -  Top:    0.125"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set pbSave.strTip='Внести изменения в БД'
.head 6 +  On SAM_Click
.head 7 +  If fReadWrite
.head 8 +  If not BanksApplyChanges()
.head 9 -  Call SqlRollback(hSql())
.head 8 -  Call SalSendMsg( tblBanks, UM_Populate, 0, 0 )
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.017"
.head 6 -  Top:    0.125"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set pbExit.strTip='Завершить работу'
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow(hWndForm)
.head 4 -  !
.head 4 +  Pushbutton: pbSystem
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Дополнительно
.head 5 -  Window Location and Size
.head 6 -  Left:   25.0"
.head 6 -  Top:    0.131"
.head 6 -  Width:  1.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.292"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: F12
.head 5 -  Font Name: Default
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: None
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SalIsWindowVisible( tblBanks.KODGN )
.head 8 -  Call SalHideWindow( tblBanks.KODGN )
.head 8 -  Call SalHideWindow( tblBanks.FMINAME )
.head 8 -  Call SalHideWindow( tblBanks.FMONAME )
.head 8 -  Call SalHideWindow( tblBanks.PMNAME )
.head 8 -  Call SalHideWindow( tblBanks.KODNNAME )
.head 7 +  Else
.head 8 +  If ShowInputPassword() = FALSE
.head 9 -  Return SalDestroyWindow(hWndForm)
.head 8 -  !
.head 8 -  Call SalShowWindow( tblBanks.KODGN )
.head 8 -  Call SalShowWindow( tblBanks.FMINAME )
.head 8 -  Call SalShowWindow( tblBanks.FMONAME )
.head 8 -  Call SalShowWindow( tblBanks.PMNAME )
.head 8 -  Call SalShowWindow( tblBanks.KODNNAME )
.head 8 -  !
.head 8 +  If fReadWrite
.head 9 -  Call SalEnableWindow( tblBanks.KODGN )
.head 9 -  Call SalEnableWindow( tblBanks.FMINAME )
.head 9 -  Call SalEnableWindow( tblBanks.FMONAME )
.head 9 -  Call SalEnableWindow( tblBanks.PMNAME )
.head 9 -  Call SalEnableWindow( tblBanks.KODNNAME )
.head 4 -  !
.head 4 -  Line
.head 5 -  Resource Id: 27321
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  2.886"
.head 6 -  Begin Y:  0.083"
.head 6 -  End X:  2.886"
.head 6 -  End Y:  0.479"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 -  Line
.head 5 -  Resource Id: 27322
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  3.929"
.head 6 -  Begin Y:  0.083"
.head 6 -  End X:  3.929"
.head 6 -  End Y:  0.479"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 2 +  Contents
.head 3 +  Column: MFO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
банка
участника
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 6
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  1.043"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalSetFieldEdit( hWndItem, TRUE )
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull( hWndItem )
.head 7 +  If SalMessageBox( MSG_NeedFillField(), MSG_EmptyField(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 8 -  Return VALIDATE_OkClearFlag
.head 7 +  Else
.head 8 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 +  If SalStrLength( SalStrTrimX( tblBanks.MFO ) )=6 and NOT IsValidMFO( tblBanks.MFO )
.head 8 +  If SalMessageBox( MSG_ErrorKeyByte(), MSG_Attention(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 9 -  Return VALIDATE_OkClearFlag
.head 8 +  Else
.head 9 -  Return VALIDATE_Cancel
.head 7 +  Else
.head 8 -  Call SqlPrepareAndExecute( hSql(), T( 'SELECT mfo INTO :sTmp FROM Banks WHERE trim( mfo ) = trim(:tblBanks.MFO) ' ) )
.head 8 +  If SqlFetchNext( hSql(), nFetchRes )
.head 9 +  If SalMessageBox( 'Поле хранит дублирующие значение', MSG_Attention(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 10 -  Return VALIDATE_OkClearFlag
.head 9 +  Else
.head 10 -  Return VALIDATE_Cancel
.head 8 +  Else
.head 9 -  Return VALIDATE_Ok
.head 3 +  Column: SAB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Элект-
ронный
адрес
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 4
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.914"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Uppercase
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull( hWndItem )
.head 7 +  If SalMessageBox( MSG_NeedFillField(), MSG_EmptyField(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 8 -  Return VALIDATE_OkClearFlag
.head 7 +  Else
.head 8 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Return VALIDATE_Ok
.head 5 +  On SAM_SetFocus
.head 6 -  Call SalSetFieldEdit( hWndItem, TRUE )
.head 3 +  Column: MFOP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: МФО
расчетного
центра
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 6
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull( hWndItem )
.head 7 +  If SalMessageBox( MSG_NeedFillField(), MSG_EmptyField(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 8 -  Return VALIDATE_OkClearFlag
.head 7 +  Else
.head 8 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 +  If NOT IsValidMFO( tblBanks.MFOP )
.head 8 +  If SalMessageBox( MSG_ErrorKeyByte(), MSG_Attention(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 9 -  Return VALIDATE_OkClearFlag
.head 8 +  Else
.head 9 -  Return VALIDATE_Cancel
.head 7 +  Else
.head 8 -  Return VALIDATE_Ok
.head 5 +  On SAM_KillFocus
.head 6 +  If NOT SalSendMsg( hWndItem, SAM_Validate, 0, 0 )
.head 7 -  Set wParam = SalWindowHandleToNumber( hWndItem )
.head 3 +  Column: NB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Наименование банка
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 70
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  6.243"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull( hWndItem )
.head 7 +  If SalMessageBox( MSG_NeedFillField(), MSG_EmptyField(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 8 -  Return VALIDATE_OkClearFlag
.head 7 +  Else
.head 8 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Return VALIDATE_Ok
.head 3 +  Column: BLKNAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Состояние банка:
Рабочий либо
Ликвидирован
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 20
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  1.717"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SalIsNull( hWndItem )
.head 7 +  If SalMessageBox( MSG_NeedFillField(), MSG_EmptyField(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 8 -  Return VALIDATE_OkClearFlag
.head 7 +  Else
.head 8 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Return VALIDATE_Ok
.head 3 +  Column: KODGN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Группа банков
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.3"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalListPopulate( hWndItem, hSql(), T( 'SELECT namg FROM Groupsb' ) )
.head 5 +  On SAM_Validate
.head 6 +  If SalListQuerySelection( hWndItem ) = LB_Err
.head 7 +  If SalMessageBox( MSG_NeedFillField(), MSG_EmptyField(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 8 -  Return VALIDATE_OkClearFlag
.head 7 +  Else
.head 8 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Call SqlPrepareAndExecute (hSql (), T( 'SELECT kodg FROM Groupsb INTO :tblBanks.KODG WHERE trim(NAMG) = trim(:tblBanks.KODGN)' ) )
.head 7 -  Call SqlFetchNext (hSql (), nErr)
.head 7 -  Return VALIDATE_Ok
.head 3 +  Column: FMI
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
FMI
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 2
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.414"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: FMINAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Формат
входных 
сообщений
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 40
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? No
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalListPopulate( hWndItem, hSql(), T( 'SELECT name FROM Msf' ) )
.head 5 +  On SAM_Validate
.head 6 +  If SalListQuerySelection( FMINAME ) = LB_Err
.head 7 +  If SalMessageBox( MSG_NeedFillField(), MSG_EmptyField(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 8 -  Return VALIDATE_OkClearFlag
.head 7 +  Else
.head 8 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Call SqlPrepareAndExecute (hSql (), T( 'SELECT fm FROM Msf INTO :FMI WHERE name=:FMINAME' ) )
.head 7 -  Call SqlFetchNext (hSql (), nErr)
.head 7 -  Return VALIDATE_Ok
.head 3 +  Column: FMO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
FMO
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 2
.head 4 -  Data Type: String
.head 4 -  Justify: Right
.head 4 -  Width:  0.483"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: FMONAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Формат
выходных
сообщений
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 40
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? No
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalListPopulate( hWndItem, hSql(), T( 'SELECT name FROM Msf' ) )
.head 5 +  On SAM_Validate
.head 6 -  ! //////////////////////////////////////////////////////////////////////////////////////////////////////
.head 6 -  !
.head 6 +  If SalListQuerySelection( FMONAME ) = LB_Err
.head 7 +  If SalMessageBox( MSG_NeedFillField(), MSG_EmptyField(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 8 -  Return VALIDATE_OkClearFlag
.head 7 +  Else
.head 8 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Call SqlPrepareAndExecute (hSql (), T( 'SELECT fm FROM Msf INTO :FMO WHERE name=:FMONAME' ) )
.head 7 -  Call SqlFetchNext (hSql (), nErr)
.head 7 -  Return VALIDATE_Ok
.head 6 -  !
.head 6 -  ! //////////////////////////////////////////////////////////////////////////////////////////////////////
.head 3 +  Column: PM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
PM
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 2
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.386"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: PMNAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
Метод оплаты файлов СЭП
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.957"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? No
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalListPopulate( hWndItem, hSql(), T( 'SELECT name FROM Pm_rrp' ) )
.head 5 +  On SAM_Validate
.head 6 +  If SalListQuerySelection( hWndItem ) = LB_Err
.head 7 +  If SalMessageBox( MSG_NeedFillField(), MSG_EmptyField(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 8 -  Return VALIDATE_OkClearFlag
.head 7 +  Else
.head 8 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Call SqlPrepareAndExecute (hSql (), T( 'SELECT pm FROM Pm_rrp INTO :PM WHERE name=:PMNAME' ) )
.head 7 -  Call SqlFetchNext (hSql (), nErr)
.head 7 -  !
.head 7 -  Return VALIDATE_Ok
.head 3 +  Column: KODN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: 
KODN
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 2
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.633"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KODNNAME
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Маршрут прохождения
электронных платежей
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 40
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.4"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? No
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalListPopulate( hWndItem, hSql(), T( 'SELECT name FROM Dir_rrp' ) )
.head 5 +  On SAM_Validate
.head 6 +  If SalListQuerySelection( hWndItem ) = LB_Err
.head 7 +  If SalMessageBox( MSG_NeedFillField(), MSG_EmptyField(), MB_IconStop | MB_OkCancel | MB_DefButton1 ) = IDCANCEL
.head 8 -  Return VALIDATE_OkClearFlag
.head 7 +  Else
.head 8 -  Return VALIDATE_Cancel
.head 6 +  Else
.head 7 -  Call SqlPrepareAndExecute (hSql (), T( 'SELECT kodn FROM Dir_rrp INTO :KODN WHERE name=:KODNNAME' ) )
.head 7 -  Call SqlFetchNext (hSql (), nErr)
.head 7 -  !
.head 7 -  Return VALIDATE_Ok
.head 3 +  Column: KODG
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: KODG
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.967"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: BLK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: BLK
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 2
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.433"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? No
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value: 1
.head 6 -  Uncheck Value: 0
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: #
МОД
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 1
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  0.483"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: BanksApplyChanges
.head 4 -  Description: Сохраняет изменения в таблице BANKS
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  File Handle: hFile
.head 4 +  Actions
.head 5 -  ! ///////////////////////////////////////////////////////////////////////////////////////////////////////////////
.head 5 -  !
.head 5 -  Call WaitCursorOn()
.head 5 -  Call SqlIsolationExclusive( hSql() )
.head 5 -  !
.head 5 +  If SalTblAnyRows( tblBanks, ROW_MarkDeleted, 0 )
.head 6 -  Call SaveInfoToLog( 'Удаление участника(ов) расчетов' )
.head 6 -  !
.head 6 -  Set nRow = TBL_MinRow
.head 6 -  !
.head 6 +  If bDirectAccess
.head 7 +  While SalTblFindNextRow( tblBanks, nRow, ROW_MarkDeleted, 0 )
.head 8 -  Call SalTblFetchRow( tblBanks, nRow )
.head 8 -  Call SalStrTrim( tblBanks.MFO, tblBanks.MFO )
.head 8 +  If not  SqlPrepareAndExecute( hSql(), T(
"UPDATE Accounts SET tip ='ODB' 
 WHERE Accounts.tip <> 'T00' AND Accounts.acc
    IN (SELECT b.acc FROM Bank_acc b WHERE trim(b.mfo)=:tblBanks.MFO )" ) )
.head 9 -  Return FALSE
.head 8 +  If not SqlPrepareAndExecute( hSql(), T( "DELETE FROM Bank_acc WHERE trim(mfo) = :tblBanks.MFO" ) )
.head 9 -  Return FALSE
.head 6 -  !
.head 6 -  Set strSqlTxt= " DELETE FROM Banks WHERE mfo=:tblBanks.MFO"
.head 6 -  !
.head 6 -  Call SqlPrepare( hSql(), T( strSqlTxt ) )
.head 6 +  If not SalTblDoDeletes( tblBanks, hSql(), ROW_MarkDeleted )
.head 7 -  Return FALSE
.head 6 -  Call SqlCommitEx( hSql(), MSG_SaveDataRef() )
.head 6 -  !
.head 6 -  Call SalTblSetFlagsAnyRows( tblBanks, ROW_MarkDeleted, FALSE, ROW_MarkDeleted, 0 )
.head 5 -  !
.head 5 +  If SalTblAnyRows( tblBanks, ROW_New, 0 )
.head 6 -  Call SaveInfoToLog( 'Добавление участника(ов) расчетов' )
.head 6 -  !
.head 6 -  Set nRow=TBL_MinRow
.head 6 -  !
.head 6 +  While SalTblFindNextRow( tblBanks, nRow, ROW_New, 0 )
.head 7 -  Call SalTblFetchRow( tblBanks, nRow )
.head 7 -  !
.head 7 -  Set InsFld = "( mfo, sab, nb, blk, nmo "
.head 7 -  Set InsTbl = "( :tblBanks.MFO, :tblBanks.SAB, :tblBanks.NB, :tblBanks.BLK, :tblBanks.NMO "
.head 7 -  !
.head 7 +  If bDirectAccess
.head 8 +  If Not SalIsNull ( tblBanks.FMI )
.head 9 -  Set InsFld = InsFld || ', fmi'
.head 9 -  Set InsTbl = InsTbl || ', :tblBanks.FMI'
.head 8 +  If Not SalIsNull ( tblBanks.FMO )
.head 9 -  Set InsFld = InsFld || ', fmo'
.head 9 -  Set InsTbl = InsTbl || ', :tblBanks.FMO'
.head 8 +  If Not SalIsNull ( tblBanks.PM )
.head 9 -  Set InsFld = InsFld || ', pm'
.head 9 -  Set InsTbl = InsTbl || ', :tblBanks.PM'
.head 8 +  If Not SalIsNull ( tblBanks.KODN )
.head 9 -  Set InsFld = InsFld || ', kodn'
.head 9 -  Set InsTbl = InsTbl || ', :tblBanks.KODN'
.head 8 -  !
.head 8 -  Set InsFld = InsFld || ', mfop'
.head 8 -  Set InsTbl = InsTbl || ', :strBankMfo'
.head 7 +  Else
.head 8 +  If NOT SalIsNull ( tblBanks.MFOP )
.head 9 -  Set InsFld = InsFld || ', mfop'
.head 9 -  Set InsTbl = InsTbl || ', :tblBanks.MFOP'
.head 7 -  !
.head 7 +  If Not SalIsNull ( tblBanks.KODG )
.head 8 -  Set InsFld = InsFld || ', kodg'
.head 8 -  Set InsTbl = InsTbl || ', :tblBanks.KODG'
.head 7 -  !
.head 7 -  Set strSqlTxt = "INSERT INTO Banks " || InsFld || ") VALUES " || InsTbl || ")"
.head 7 -  !
.head 7 -  ! Call Debug( T(strSqlTxt) )
.head 7 +  If not SqlPrepareAndExecute( hSql(), T( strSqlTxt ) )
.head 8 -  Return FALSE
.head 6 -  !
.head 6 -  Call SqlCommitEx( hSql(), MSG_SaveDataRef() )
.head 6 -  !
.head 6 -  Call SalTblSetFlagsAnyRows( tblBanks, ROW_New, FALSE, ROW_New, 0 )
.head 6 -  !
.head 6 +  If bDirectAccess
.head 7 -  ! Call SalModalDialog( dlgAccReg, hWndForm )
.head 5 -  !
.head 5 +  If SalTblAnyRows( tblBanks, ROW_Edited, 0 )
.head 6 -  Set nRow=TBL_MinRow
.head 6 -  !
.head 6 +  While SalTblFindNextRow( tblBanks, nRow, ROW_Edited, 0 )
.head 7 -  Call SalTblFetchRow( tblBanks, nRow )
.head 7 -  !
.head 7 -  Set strSqlTxt = "UPDATE Banks SET mfo=:tblBanks.MFO, sab=:tblBanks.SAB, nb=:tblBanks.NB, blk=:tblBanks.BLK, nmo=:tblBanks.NMO"
.head 7 -  !
.head 7 +  If bDirectAccess
.head 8 +  If Not SalIsNull ( tblBanks.FMI )
.head 9 -  Set strSqlTxt = strSqlTxt || ', fmi=:tblBanks.FMI'
.head 8 +  If Not SalIsNull ( tblBanks.FMO )
.head 9 -  Set strSqlTxt = strSqlTxt || ', fmo=:tblBanks.FMO'
.head 8 +  If Not SalIsNull ( tblBanks.PM )
.head 9 -  Set strSqlTxt = strSqlTxt || ', pm=:tblBanks.PM'
.head 8 +  If Not SalIsNull (tblBanks.KODN)
.head 9 -  Set strSqlTxt = strSqlTxt || ', kodn = :tblBanks.KODN'
.head 7 +  Else
.head 8 +  If Not SalIsNull (tblBanks.MFOP)
.head 9 -  Set strSqlTxt = strSqlTxt || ', mfop=:tblBanks.MFOP'
.head 7 +  If Not SalIsNull ( tblBanks.KODG )
.head 8 -  Set strSqlTxt = strSqlTxt || ', kodg = :tblBanks.KODG'
.head 7 -  !
.head 7 -  Set strSqlTxt = strSqlTxt || ' WHERE mfo=:tblBanks.MFO' 
.head 7 -  ! Call Debug(strSqlTxt) 
.head 7 +  If not SqlPrepareAndExecute( hSql(),  T(strSqlTxt)) 
.head 8 -  Return FALSE
.head 6 -  !
.head 6 -  Call SalTblSetFlagsAnyRows( tblBanks, ROW_Edited, FALSE, ROW_Edited, 0 )
.head 6 -  !
.head 6 -  Call SqlCommitEx( hSql(), MSG_SaveDataRef() )
.head 5 -  !
.head 5 -  Call SqlIsolationNormal( hSql() )
.head 5 -  !
.head 5 +  If fBlkRedirect
.head 6 +  If MessageQuestion( 'Формировать файлы СЭП K с новыми признаками блокировки на участников?' ) = IDYES
.head 7 +  If SalFileOpen( hFile, GetIntDir() || FILE_K(), OF_Create | OF_Binary | OF_Write ) = TRUE
.head 8 -  Call SalFileClose( hFile )
.head 6 -  Set fBlkRedirect = FALSE
.head 5 -  Call WaitCursorOff()
.head 5 -  Return TRUE
.head 2 +  Window Parameters
.head 3 -  Boolean: fReadWrite
.head 2 +  Window Variables
.head 3 -  String: tempN
.head 3 -  Number: nCnt
.head 3 -  String: strBankMfo
.head 3 -  !
.head 3 -  Boolean: bDirectAccess
.head 3 -  String: strSeniorMfo
.head 3 -  !
.head 3 -  Number: maxRNK
.head 3 -  String: InsFld
.head 3 -  String: InsTbl
.head 3 -  String: strGrName
.head 3 -  String: strSqlTxt
.head 3 -  String: sTmp
.head 3 -  Boolean: fBlkRedirect
.head 2 +  Message Actions
.head 3 +  On UM_Populate
.head 4 -  Call SalTblSetLockedColumns( tblBanks, 2 )
.head 4 -  !
.head 4 -  Set fBlkRedirect=FALSE
.head 4 -  !
.head 4 +  If bDirectAccess
.head 5 -  Call SalHideWindow( MFOP )
.head 5 -  Call SalShowWindow( FMINAME )
.head 5 -  Call SalShowWindow( FMONAME )
.head 5 -  Call SalShowWindow( PMNAME )
.head 5 -  Call SalShowWindow( KODNNAME )
.head 5 -  !
.head 5 -  Set strSqlTxt="
SELECT a.mfo, a.sab, a.nb, a.blk, a.fmi, fi.name, a.fmo, fo.name, 
       a.pm, p.name, a.kodn, k.name, a.kodg, g.namg, a.nmo 
  INTO :MFO, :SAB, :NB, :BLK, :FMI, :FMINAME, :FMO, :FMONAME, 
       :PM, :PMNAME, :KODN, :KODNNAME, :KODG, :KODGN, :NMO  
  FROM Banks a, OUTER Groupsb g, OUTER Msf fi, OUTER Msf fo, OUTER Pm_rrp p,
       OUTER Dir_rrp k
 WHERE a.kodg=g.kodg (+) AND
       a.fmi=fi.fm (+)   AND
       a.fmo=fo.fm (+)   AND
       a.pm=p.pm (+)     AND
       a.kodn=k.kodn (+) AND
       a.mfop = :strBankMfo AND 
       a.mfop IS NOT NULL 
ORDER BY a.mfo"
.head 4 +  Else
.head 5 -  Call SalShowWindow( MFOP )
.head 5 -  Call SalHideWindow( FMINAME )
.head 5 -  Call SalHideWindow( FMONAME )
.head 5 -  Call SalHideWindow( PMNAME )
.head 5 -  Call SalHideWindow( KODNNAME )
.head 5 -  !
.head 5 -  Set strSqlTxt="
SELECT a.mfo, a.mfop, a.sab, a.nb, a.blk, a.kodg, g.namg, a.nmo 
  INTO :MFO, :MFOP, :SAB, :NB, :BLK, :KODG, :KODGN, :NMO  
  FROM Banks a, OUTER Groupsb g
 WHERE a.kodg=g.kodg (+) AND "
.head 5 +  If strSeniorMfo != ''
.head 6 -  Set strSqlTxt=strSqlTxt || ' a.mfop = :strSeniorMfo '
.head 5 +  Else
.head 6 -  Set strSqlTxt=strSqlTxt || ' a.mfop IS NULL '
.head 5 -  Set strSqlTxt=strSqlTxt || ' ORDER BY a.mfo'
.head 4 -  !
.head 4 -  Call WaitCursorOn()
.head 4 -  Call SalTblPopulate( tblBanks, hSqlAux(), T( strSqlTxt ), TBL_FillAll )
.head 4 -  Call WaitCursorOff()
.head 4 -  Call SalTblSetFocusRow( tblBanks, 0 )
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow( hWndForm )
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Call XSalTooltipSetUserDefault( )
.head 4 -  !
.head 4 -  Set strBankMfo=GetBankMfo()
.head 4 -  !
.head 4 -  Set bDirectAccess=TRUE
.head 4 -  Set strSeniorMfo=''
.head 4 -  Set dfSeekMfo=''
.head 4 -  !
.head 4 -  Call SalSetWindowText( hWndForm, 'Прямые Участники Расчетной Палаты' )
.head 4 -  !
.head 4 +  If NOT fReadWrite
.head 5 -  Call SalDisableWindow( pbAdd )
.head 5 -  Call SalDisableWindow( pbDel )
.head 5 -  Call SalDisableWindow( pbSave )
.head 5 -  !
.head 5 -  Call SalDisableWindow( tblBanks.MFO )
.head 5 -  Call SalDisableWindow( tblBanks.SAB )
.head 5 -  Call SalDisableWindow( tblBanks.MFOP )
.head 5 -  Call SalDisableWindow( tblBanks.NB )
.head 5 -  Call SalDisableWindow( tblBanks.KODGN )
.head 5 -  Call SalDisableWindow( tblBanks.FMINAME )
.head 5 -  Call SalDisableWindow( tblBanks.FMONAME )
.head 5 -  Call SalDisableWindow( tblBanks.PMNAME )
.head 5 -  Call SalDisableWindow( tblBanks.KODNNAME )
.head 5 -  Call SalDisableWindow( tblBanks.NMO )
.head 4 -  !
.head 4 -  Call SalDisableWindow( pbBack )
.head 4 -  Call SalDisableWindow( pbAccounts )
.head 4 -  !
.head 4 -  Call SalSendMsg( tblBanks, UM_Populate, 0, 0 )
.head 3 +  On SAM_CreateComplete
.head 4 -  Call WaitCursorOff()
.head 3 +  On SAM_FetchRowDone
.head 4 +  If bDirectAccess
.head 5 +  If BLK=4
.head 6 -  Set BLKNAME = 'Ликвидирован'
.head 5 +  Else If BLK=0
.head 6 -  Set BLKNAME = 'Рабочий'
.head 5 +  Else
.head 6 -  Set BLKNAME = 'Неизвестный код'
.head 4 +  Else
.head 5 -  Call SalListSelectString( KODGN, -1, strGrName )
.head 5 -  !
.head 5 +  If BLK=4
.head 6 -  Set BLKNAME = 'Ликвидирован'
.head 5 +  Else If BLK=0
.head 6 -  Set BLKNAME = 'Рабочий'
.head 5 +  Else
.head 6 -  Set BLKNAME = 'Неизвестный код'
.head 3 +  On SAM_TblDoDetails
.head 4 +  If NOT SalIsWindowEnabled( pbAccounts )
.head 5 -  Call SalEnableWindow( pbAccounts )
.head 3 +  On SAM_DoubleClick
.head 4 +  If Not SalIsNull( tblBanks.MFO )
.head 5 -  !
.head 5 -  Set bDirectAccess=FALSE
.head 5 -  Set strSeniorMfo=tblBanks.MFO
.head 5 -  !
.head 5 -  Call SalSetWindowText( hWndForm, 'Участники Расчетной Палаты: ' || MFO || '   ' || NB )
.head 5 -  Call SalEnableWindow( pbBack )
.head 5 -  Call SalDisableWindow( pbDown )
.head 5 -  Call SalDisableWindow( pbAccounts )
.head 5 -  !
.head 5 -  Call SalSendMsg( tblBanks, UM_Populate, 0, 0 )
.head 1 +  Table Window: frm_TPar
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Справочник переменных для тикетов
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  12.867"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.786"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 2000
.head 3 -  Discardable? Class Default
.head 2 -  Description: Справочник переменных для тикетов
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 3492
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg(frm_TPar.colTxt, SAM_DoubleClick, 0, 0)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 3493
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 3494
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: colRepPrefix
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Имя
файла шаблона
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 8
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPar
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Имя
переменной
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTxt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: SQL-выражение
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 4000
.head 4 -  Data Type: Long String
.head 4 -  Justify: Left
.head 4 -  Width:  4.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Set lsTmp = colTxt
.head 6 -  Call SalModalDialog(dlg_MemoEditor, hWndForm,
  'Редактирование текста запроса', bTmp, lsTmp)
.head 6 +  If bTmp
.head 7 -  Set colTxt = lsTmp
.head 7 -  Call SalTblSetRowFlags(hWndForm, SalTblQueryContext(hWndForm), ROW_Edited, TRUE)
.head 3 +  Column: colComm
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Комментарий
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 70
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.0"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nMode
.head 3 -  Number: nPar
.head 3 -  String: strPar01
.head 3 -  String: strPar02
.head 2 +  Window Variables
.head 3 -  Boolean: bTmp
.head 3 -  Long String: lsTmp
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Set frm_TPar.strFilterTblName = "TICKETS_PAR"
.head 4 -  Set frm_TPar.strPrintFileName = "TICK_PAR"
.head 4 -  ! upper(:sRepPrefix) like upper(rep_prefix)||'%' and
.head 4 -  Set frm_TPar.strSqlPopulate = 
"SELECT rep_prefix, par, txt, comm 
 INTO :frm_TPar.colRepPrefix, :frm_TPar.colPar, 
      :frm_TPar.colTxt, :frm_TPar.colComm 
 FROM tickets_par 
 ORDER BY rep_prefix"
.head 4 -  Set frm_TPar.strSqlInsert = 
"INSERT INTO tickets_par(rep_prefix,par, txt, comm) 
 VALUES(:frm_TPar.colRepPrefix, :frm_TPar.colPar, 
        :frm_TPar.colTxt, :frm_TPar.colComm)"
.head 4 -  Set frm_TPar.strSqlUpdate = 
"UPDATE tickets_par 
 SET txt=:frm_TPar.colTxt, comm=:frm_TPar.colComm 
 WHERE rep_prefix=:frm_TPar.colRepPrefix AND par=:frm_TPar.colPar"
.head 4 -  Set frm_TPar.strSqlDelete = 
"DELETE FROM tickets_par 
 WHERE rep_prefix=:frm_TPar.colRepPrefix AND par=:frm_TPar.colPar"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 1 +  Form Window: Frm_PSSP
.head 2 -  Class: cGenericTableFrm
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Распределение  спецпараметров по балансовым счетам
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  10.75"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.607"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 36015
.head 5 -  Class Child Ref Key: 18
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 36016
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 24
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 36017
.head 5 -  Class Child Ref Key: 25
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableFrm
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Custom Control: cMainSpl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalHSplitter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  8.4"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.104"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Custom Control: cSplV
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalVSplitterInvisible
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tblPS
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableFrm
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  8.233"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 1.952"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 10000
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colNBS
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: № БС
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.7"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование БС
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.957"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_RowSetContext
.head 6 -  Set pNBS = colNBS
.head 6 -  Call SalSendMsg(tblSP, UM_Populate, 0, 0)
.head 5 +  On UM_Update
.head 6 -  Call SalSendMsg(tblSP, UM_Update, 0, 0)
.head 3 +  Child Table: tblSP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.35"
.head 6 -  Top:    2.202"
.head 6 -  Width:  3.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.781"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: №
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCode
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Выбранные параметры
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  4.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOpt
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Признак
обязат.
заполнения
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSqlVal
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: SQL-выражение для умолч.значения
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 500
.head 6 -  Data Type: Long String
.head 6 -  Justify: Left
.head 6 -  Width:  4.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nOrderBy
.head 5 -  Window Handle: hColumn
.head 5 -  Number: nCount
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 6 -  Call SalTblSetTableFlags(hWndItem, TBL_Flag_SelectableCols, TRUE)
.head 6 -  Set nOrderBy = 1
.head 5 +  On UM_Populate
.head 6 -  Call SalTblReset(hWndForm)
.head 6 -  Call SalTblReset(Frm_SPar.tblSPAll)
.head 6 -  Set nTblRow = 0
.head 6 -  Call SalTblPopulate(hWndForm, hSql(), 
"SELECT l.spid, decode(l.name,'VALUE',l.tag,l.name), l.semantic, s.opt, s.sqlval 
   INTO :colId, :colCode, :colName, :colOpt, :colSqlVal 
   FROM sparam_list l, ps_sparam s, ps p 
  WHERE l.spid = s.spid and s.nbs = p.nbs and p.nbs = :pNBS
    and l.inuse = 1
  order by l.semantic", TBL_FillAll)
.head 6 -  Set sSql = 
"SELECT DISTINCT l.spid, decode(l.name,'VALUE',l.tag,l.name), l.semantic 
   FROM sparam_list l, ps_sparam s, ps p 
  WHERE p.nbs = :pNBS and p.nbs = s.nbs(+)
    and l.spid NOT IN (SELECT spid FROM ps_sparam WHERE nbs = :pNBS)
    and l.inuse = 1 "
.head 6 +  If nTblRow = 0
.head 7 -  Set hWnd = tblSP
.head 7 -  Set sSql = sSql || "INTO :tblSP.colId, :tblSP.colCode, :tblSP.colName " || " order by l.semantic"
.head 6 +  Else
.head 7 -  Set hWnd = Frm_SPar.tblSPAll
.head 7 -  Set sSql = sSql || "INTO :Frm_SPar.tblSPAll.colId, :Frm_SPar.tblSPAll.colCode, :Frm_SPar.tblSPAll.colName " || " order by l.semantic"
.head 6 -  Call SalTblPopulate(hWnd, hSql(), sSql, TBL_FillAll)
.head 6 -  Call SalSetFocus(Frm_PSSP.tblPS)
.head 5 +  On SAM_FetchRowDone
.head 6 -  Set nTblRow = nTblRow + 1
.head 5 +  On UM_Update
.head 6 -  Call SqlPrepareAndExecute(hSql(), 
"SELECT count(nbs) 
 INTO :nCount 
 FROM ps_sparam 
 WHERE nbs=:tblPS.colNBS ")
.head 6 -  Call SqlFetchNext(hSql(), nFetchRes)
.head 6 +  If nCount = 0 AND SalTblAnyRows(hWndForm, ROW_Edited, 0)
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(hWndForm, nRow, 0, 0)
.head 8 -  Call SalTblSetContext(hWndForm, nRow)
.head 8 -  Call SqlPrepareAndExecute(hSql(), 
"INSERT INTO ps_sparam(nbs,spid) 
 VALUES(:tblPS.colNBS,:tblSP.colId)")
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, ROW_Edited, 0)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 -  Call SqlPrepareAndExecute(hSql(), 
"UPDATE ps_sparam 
 SET opt=:tblSP.colOpt, sqlval=:tblSP.colSqlVal 
 WHERE nbs=:tblPS.colNBS AND spid=:tblSP.colId")
.head 6 -  Call SqlCommit(hSql())
.head 6 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalWaitCursor(TRUE)
.head 6 -  Set hColumn = SalNumberToWindowHandle(wParam)
.head 6 -  Set nOrderBy = Not nOrderBy
.head 6 -  Call SalTblSortRows(hWndForm, SalTblQueryColumnID(hColumn), nOrderBy)
.head 6 -  Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
.head 6 -  Call SalWaitCursor(FALSE)
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: num
.head 3 -  String: sNBS
.head 3 -  String: sName
.head 3 -  Window Handle: hWnd
.head 3 -  String: sSql
.head 3 -  Number: nTblRow
.head 3 -  !
.head 3 -  Number: nWinX0
.head 3 -  Number: nWinY0
.head 3 -  Number: nWinWidth
.head 3 -  Number: nWinHeigh
.head 3 -  Number: nTblX0
.head 3 -  Number: nTblY0
.head 3 -  Number: nTblWidth
.head 3 -  Number: nTblHeigh
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('Frm_PSSP.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Call SetWindowFullSize(hWndForm)
.head 4 -  Call cMainSpl.setBarPosition(300)
.head 4 -  Call cMainSpl.setTopFrame(tblPS)
.head 4 -  Call cMainSpl.setBottomFrame(cSplV)
.head 4 -  Call cSplV.setBarPosition(600)
.head 4 -  Call cSplV.setLeftFrame(tblSP)
.head 4 -  Call cSplV.setRightFrame(SalCreateWindowEx(Frm_SPar, hWndForm, 0,0,0,0, CREATE_AsChild))
.head 4 -  Set hWndForm.Frm_PSSP.nFlags = GT_NoIns | GT_NoDel
.head 4 -  Set hWndForm.Frm_PSSP.fFilterAtStart = TRUE
.head 4 -  Set hWndForm.Frm_PSSP.strFilterTblName = 'PS'
.head 4 -  Set hWndForm.Frm_PSSP.strSqlPopulate = 
"SELECT nbs, name
   INTO :tblPS.colNBS, :tblPS.colName 
   FROM PS 
  WHERE nbs > 1000 
  ORDER BY nbs "
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeigh)
.head 4 -  Call SalSetWindowSize(hWndForm.Frm_PSSP.cMainSpl,
     SalPixelsToFormUnits(hWndForm, nWinWidth, FALSE) - 0.01,
     SalPixelsToFormUnits(hWndForm, nWinHeigh, TRUE) - 0.01)
.head 4 -  Call GetClientRect(hWndForm.Frm_PSSP.tblPS, nTblX0, nTblY0, nTblWidth, nTblHeigh)
.head 4 +  If SalPixelsToFormUnits(hWndForm.Frm_PSSP.tblPS, nTblWidth, FALSE) > 7.5
.head 5 -  Call SalTblSetColumnWidth(hWndForm.Frm_PSSP.tblPS.colName,
     SalPixelsToFormUnits(hWndForm.Frm_PSSP.tblPS, nTblWidth, FALSE) - 2.8)
.head 4 +  Else
.head 5 -  Call SalTblSetColumnWidth(hWndForm.Frm_PSSP.tblPS.colName, 5)
.head 1 +  Table Window: frm_F13_ZBSK
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.62"
.head 4 -  Top:    0.3"
.head 4 -  Width:  13.533"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.469"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 150000
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Top
.head 4 -  Visible? Class Default
.head 4 -  Size: 1.44"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Data Field: REF
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.986"
.head 7 -  Top:    0.405"
.head 7 -  Width:  1.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: TT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.786"
.head 7 -  Top:    0.405"
.head 7 -  Width:  0.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.229"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: STT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.386"
.head 7 -  Top:    0.427"
.head 7 -  Width:  8.3"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.229"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: NLSA
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.986"
.head 7 -  Top:    0.656"
.head 7 -  Width:  1.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.229"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 8
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: KVA
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.786"
.head 7 -  Top:    0.656"
.head 7 -  Width:  0.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.229"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: NAMA
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.386"
.head 7 -  Top:    0.656"
.head 7 -  Width:  8.3"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.229"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: NLSB
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.986"
.head 7 -  Top:    0.906"
.head 7 -  Width:  1.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.229"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: KVB
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.786"
.head 7 -  Top:    0.906"
.head 7 -  Width:  0.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.229"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: NAMB
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.386"
.head 7 -  Top:    0.906"
.head 7 -  Width:  8.3"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.229"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: NAZN
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.986"
.head 7 -  Top:    1.146"
.head 7 -  Width:  10.714"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.229"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.517"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 23416
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Оригинал документа ...'
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
.head 8 -  Call DocViewContentsEx(hWndMDI, frm_F13_ZBSK.colREF)
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   5.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Напечатать файл'
.head 6 +  On SAM_Click
.head 7 -  Call TablePrint( frm_F13_ZBSK, 'Выборка для заполнения внебалансовых символов ', GetPrnDir() ||  '/p13ZBSK.TXT', ''  )
.head 4 -  Line
.head 5 -  Resource Id: 23417
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   6.283"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 23418
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.95"
.head 6 -  Begin Y:  -0.024"
.head 6 -  End X:  1.95"
.head 6 -  End Y:  0.44"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dDATA1
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.383"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Validate
.head 7 -  Set sdat=SalFmtFormatDateTime( dDATA1,'MM-dd-yyyy' )
.head 7 +  If SqlPrepareAndExecute( hSql(),
  "SELECT val INTO :sTmp FROM params WHERE par ='D_POROG' " )
and not SqlFetchNext( hSql(), nFetchRes )
.head 8 -  Set sTmp ='840,5000000'
.head 7 -  If SqlPrepareAndExecute( hSql(),
  "SELECT gl.p_icurval(" || sTmp ||",:dDATA1 ) INTO :nPorog  FROM dual" )
and SqlFetchNext( hSql(), nFetchRes )
.head 7 -  ! Call DebugN(nPorog)
.head 7 -  ! Call SalSendMsg( pbRefresh, SAM_Click,0, 0 )
.head 6 +  On SAM_Create
.head 7 -  Call SalSendMsg( dDATA1, SAM_Validate, 0, 0 )
.head 4 +  Data Field: dDATA2
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.783"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.4"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Validate
.head 7 -  Set sdat=SalFmtFormatDateTime( dDATA2,'MM-dd-yyyy' )
.head 7 +  If SqlPrepareAndExecute( hSql(),
  "SELECT val INTO :sTmp FROM params WHERE par ='D_POROG' " )
and not SqlFetchNext( hSql(), nFetchRes )
.head 8 -  Set sTmp ='840,5000000'
.head 7 -  If SqlPrepareAndExecute( hSql(),
  "SELECT gl.p_icurval(" || sTmp ||",:dDATA2 ) INTO :nPorog  FROM dual" )
and SqlFetchNext( hSql(), nFetchRes )
.head 7 -  ! Call DebugN(nPorog)
.head 7 -  ! Call SalSendMsg( pbRefresh, SAM_Click,0, 0 )
.head 6 +  On SAM_Create
.head 7 -  Call SalSendMsg( dDATA2, SAM_Validate, 0, 0 )
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.783"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Background Text: Референс
.head 5 -  Resource Id: 23419
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.983"
.head 6 -  Top:    0.427"
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.229"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: Рахунок А
.head 5 -  Resource Id: 23420
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.983"
.head 6 -  Top:    0.677"
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: Рахунок Б
.head 5 -  Resource Id: 23421
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.983"
.head 6 -  Top:    0.927"
.head 6 -  Width:  0.917"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.229"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: Признач.
.head 5 -  Resource Id: 23422
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.983"
.head 6 -  Top:    1.177"
.head 6 -  Width:  0.933"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.167"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 2 +  Contents
.head 3 +  Column: colKO
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код 
області
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.883"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  ! If colSkZb != STRING_Null
.head 7 +     If SqlPrepareAndExecute( hSqlAux(),
"SELECT name INTO :colTEX_B FROM bopbank WHERE regnum=:colKOD_B" )
and not SqlFetchNext( hSqlAux(), nFetchRes  )
.head 8 -     Call Debug('Ош. код')
.head 8 -     Set colSkZb=STRING_Null
.head 8 -     Return VALIDATE_Ok
.head 6 -  Set colEd=1
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: colTobo
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
ТОБО
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 12
.head 4 -  Data Type: String
.head 4 -  Justify: Center
.head 4 -  Width:  1.817"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  ! If colSkZb != STRING_Null
.head 7 +     If SqlPrepareAndExecute( hSqlAux(),
"SELECT name INTO :colTEX_B FROM bopbank WHERE regnum=:colKOD_B" )
and not SqlFetchNext( hSqlAux(), nFetchRes  )
.head 8 -     Call Debug('Ош. код')
.head 8 -     Set colSkZb=STRING_Null
.head 8 -     Return VALIDATE_Ok
.head 6 -  Set colEd=1
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: colSkZb
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Позабал.
символ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Center
.head 4 -  Width:  0.883"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  ! If colSkZb != STRING_Null
.head 7 +     If SqlPrepareAndExecute( hSqlAux(),
"SELECT name INTO :colTEX_B FROM bopbank WHERE regnum=:colKOD_B" )
and not SqlFetchNext( hSqlAux(), nFetchRes  )
.head 8 -     Call Debug('Ош. код')
.head 8 -     Set colSkZb=STRING_Null
.head 8 -     Return VALIDATE_Ok
.head 6 -  Set colEd=1
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: colFDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
проводки
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Center
.head 4 -  Width:  1.35"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 -  !
.head 3 -  !
.head 3 -  !
.head 3 +  Column: colREF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: РЕФ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОП
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  0.667"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNLSA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рахунок 
дебету
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKv
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.486"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNLSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рахунок 
кредиту
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.65"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: nSum
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сума, коп.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.486"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNAZN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Призначення платежу
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  5.567"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? Yes
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colISP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код 
виконавця
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.35"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNAMA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Призначення платежу
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  5.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? Yes
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNAMB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Призначення платежу
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  5.067"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? Yes
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKVA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.486"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKVB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.486"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colRECID
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Вал
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  0.486"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colEd
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ДК
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: FLAGI
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number: FLAG
.head 4 +  Parameters
.head 5 -  Number: FLAG1
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: FLAG2
.head 4 +  Actions
.head 5 +  If FLAG1=NUMBER_Null !! вставка
.head 6 -  Set FLAG2=3
.head 5 +  Else If FLAG1=1 !! обновление
.head 6 -  Set FLAG2=2
.head 5 +  Else !! сохранить состояние флага
.head 6 -  Set FLAG2=FLAG1
.head 5 -  Return FLAG2
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nPorog  !!! Сума - порог для десларування
.head 3 -  Number: nRow
.head 3 -  Number: nNBU  !!! Признак НБУ
.head 3 -  String: sTmp
.head 3 -  String: sNBSk
.head 3 -  !
.head 3 -  Number: nKV
.head 3 -  Number: nD0
.head 3 -  Number: nD1
.head 3 -  Number: nD
.head 3 -  String: sD
.head 3 -  String: ss1
.head 3 -  String: fs
.head 3 -  String: s1D
.head 3 -  String: sdat
.head 3 -  Number: i
.head 3 -  String: mG[*]
.head 3 -  ! Number: mN[*]
.head 3 -  Number: mB[*]
.head 3 -  Boolean: bFlag
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Call SalTblSetLockedColumns( hWndForm, 5)
.head 4 -  Call SalSetWindowText( hWndForm, 'Заповнення позабалансових символів' )
.head 4 -  Call SetWindowFullSize( hWndForm )
.head 4 -  !
.head 4 -  Call frm_F13_ZBSK.cF.Init( 'OTCN_F13_ZBSK', 'o' )
.head 4 -  !
.head 4 -  Set nKV=GetBaseVal()
.head 4 -  Set dDATA2=GetBankDate()
.head 4 -  Set sdat=SalFmtFormatDateTime( dDATA2,'MM-dd-yyyy' )
.head 4 +  If SqlPrepareAndExecute( hSqlAux(),"SELECT trunc(to_date('"||sdat||"', 'MM-dd-yyyy'), 'mm') INTO :dDATA1 FROM dual ")
and  SqlFetchNext( hSqlAux(), nFetchRes )
.head 5 -  Set sdat=SalFmtFormatDateTime( dDATA1,'MM-dd-yyyy' )
.head 4 +  Else
.head 5 -  Set dDATA1=GetBankDate()
.head 5 -  Set sdat=SalFmtFormatDateTime( dDATA1,'MM-dd-yyyy' )
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Set nD0=0
.head 4 -  Set nD1=1
.head 4 -  Set bFlag=FALSE
.head 3 +  On UM_Populate
.head 4 +  If bFlag
.head 5 -  Call SalWaitCursor( TRUE )
.head 5 +  If SqlPrepareAndExecute( hSql(), "begin  
bars.P_Pop_F13zb(to_date('"|| SalFmtFormatDateTime( dDATA1,'MM-dd-yyyy' ) ||"', 'MM-dd-yyyy'), 
to_date('"|| SalFmtFormatDateTime( dDATA2, 'MM-dd-yyyy' ) ||"', 'MM-dd-yyyy' ), 1); 
end;" )
.head 6 -  Call SqlCommit( hSql() )
.head 5 -  Set fs = cF.GetFilterWhereClause( FALSE )
.head 5 -  Set frm_F13_ZBSK.strSqlPopulate =
"SELECT o.REF, o.TT, o.FDAT, o.NLSD, o.KV, o.NLSK, o.S, o.NAZN, o.ISP, o.SK_ZB,a.nms,  a.kv, b.nms, b.kv, o.recid, 0, o.ko, o.tobo
 INTO :frm_F13_ZBSK.colREF, :frm_F13_ZBSK.colTT, :frm_F13_ZBSK.colFDAT 
      :frm_F13_ZBSK.colNLSA,:frm_F13_ZBSK.colKv,:frm_F13_ZBSK.colNLSB,
      :frm_F13_ZBSK.nSum,:frm_F13_ZBSK.colNAZN,:frm_F13_ZBSK.colISP,:frm_F13_ZBSK.colSkZb,
      :frm_F13_ZBSK.colNAMA,:frm_F13_ZBSK.colKVA,:frm_F13_ZBSK.colNAMB,:frm_F13_ZBSK.colKVB,
      :frm_F13_ZBSK.colRECID, :frm_F13_ZBSK.colEd,:frm_F13_ZBSK.colKO,:frm_F13_ZBSK.colTobo
  FROM OTCN_F13_ZBSK o, accounts a, accounts b 
where "||IifS(fs !="",fs||" and ","")||
       " o.fdat between :dDATA1 and :dDATA2 and
           o.accd=a.acc and o.acck=b.acc
 order by o.fdat, o.ko, o.tobo, o.ref "
.head 5 -  !
.head 5 -  Call SalTblPopulate( hWndForm, hSql(), frm_F13_ZBSK.strSqlPopulate, TBL_FillAll )
.head 5 -  Call SalTblSetContext( hWndForm, 0 )
.head 5 -  Call SalTblSetRowFlags( hWndForm, 0, ROW_Selected, TRUE )
.head 5 -  Call SalSendMsg( hWndForm, SAM_TblDoDetails, 0,0)
.head 5 -  Call SalWaitCursor( FALSE )
.head 4 +  Else
.head 5 -  Set bFlag=TRUE
.head 3 +  On UM_Update
.head 4 -  Set i = TBL_MinRow
.head 4 +  While SalTblFindNextRow( frm_F13_ZBSK, i, 0, 0 )
.head 5 -  Call SalTblFetchRow( frm_F13_ZBSK, i )
.head 5 +  If colEd=1 and
   SqlPrepareAndExecute( hSql(), "
     UPDATE OTCN_F13_ZBSK SET SK_ZB=:colSkZb WHERE recid=:colRECID" )
.head 6 -  Call SqlCommit( hSql() )
.head 4 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 3 +  On SAM_TblDoDetails
.head 4 +  ! If SalListSelectString( colTEX_N, 0, colKOD_N ) = LB_Err
.head 5 -     If SalListSelectString( colTEX_N, 0, Subs(colKOD_N,1,4) ) =LB_Err
.head 4 -  Set REF=colREF
.head 4 -  Set TT=colTT
.head 4 +  If SqlPrepareAndExecute( hSqlAux(),"SELECT t.name INTO :STT FROM tts t WHERE tt=:colTT ")
and  SqlFetchNext( hSqlAux(), nFetchRes )
.head 5 -  Set NLSA=colNLSA
.head 5 -  Set NAZN=colNAZN
.head 5 -  Set NLSB=colNLSB
.head 5 -  Set NAMA=colNAMA
.head 5 -  Set KVA=colKVA
.head 5 -  Set NAMB=colNAMB
.head 5 -  Set KVB=colKVB
.head 1 -  ! ! MIK
.head 1 +  Form Window: frm_OperCard  ! Новый боа-конструктор операций
.head 2 -  Class: cQuickTabsForm
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.27"
.head 4 -  Top:    1.275"
.head 4 -  Width:  14.029"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.271"
.head 4 -  Height Editable? Class Default
.head 3 -  Form Size
.head 4 -  Width:  Class Default
.head 4 -  Height: Class Default
.head 4 -  Number of Pages: Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: 0.469"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbInsert
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.086"
.head 6 -  Top:    0.052"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\Insert.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('cGTTipIns')
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( hWndForm, UM_Insert, 0, 0 )
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDelete
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.514"
.head 6 -  Top:    0.052"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('cGTTipDel')
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( hWndForm, UM_Delete, 0, 0 )
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.943"
.head 6 -  Top:    0.052"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('cGTTipRefresh')
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.383"
.head 6 -  Top:    0.052"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('cGTTipUpdate')
.head 7 -  Call SalDisableWindow( hWndItem )
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( hWndForm, UM_Update, 0, 0 )
.head 4 -  Line
.head 5 -  Resource Id: 50497
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  1.9"
.head 6 -  Begin Y:  0.417"
.head 6 -  End X:  1.9"
.head 6 -  End Y:  0.0"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbSearch
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.043"
.head 6 -  Top:    0.052"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('cGTTipSearch')
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( hWndForm, UM_Search, 0, 0 )
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbFilter
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.483"
.head 6 -  Top:    0.052"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('cGTTipFilter')
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( hWndForm, UM_Choose, 0, 0 )
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbPrint
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.917"
.head 6 -  Top:    0.052"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: F5
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\print.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('cGTTipPrint')
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('dlg_OperCard.cBTipPrintOper')
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( hWndForm, UM_Print, 0, 0 )
.head 4 -  Line
.head 5 -  Resource Id: 50498
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  3.486"
.head 6 -  Begin Y:  0.406"
.head 6 -  End X:  3.486"
.head 6 -  End Y:  -0.01"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbToFile
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRelation
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.586"
.head 6 -  Top:    0.052"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \Bars98\RESOURCE\BMP\DOC_IN.BMP
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip='Экспорт операций в текстовый файл'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_OperList.cBTipToFile')
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( hWndForm, UM_CreateDoc, 0, 1 )
.head 4 +  Pushbutton: pbExportSelected
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbOk
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.02"
.head 6 -  Top:    0.052"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\todisk.bmp
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  ! Set strTip='Экспорт выбранных операций в SQL сценарий'
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('frm_OperList.cBTipExportSelected')
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( hWndForm, UM_CreateDoc, 0, 2 )
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.467"
.head 6 -  Top:    0.052"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Esc
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = CurrentLangTable.GetAtomTitle('cGTTipExit')
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( hWndForm, UM_Close, 0, 0 )
.head 4 -  Line
.head 5 -  Resource Id: 50499
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  4.986"
.head 6 -  Begin Y:  0.406"
.head 6 -  End X:  4.986"
.head 6 -  End Y:  -0.01"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Data Field: dfOpDesc
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   5.086"
.head 7 -  Top:    0.094"
.head 7 -  Width:  8.2"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.313"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? No
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 12
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: 3D Face Color
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Picture: picTabs
.data CLASSPROPS
0000: 5461624C6566744D 617267696E000200 3000005461624375 7272656E74000600
0020: 4E616D6530000054 6162426F74746F6D 4D617267696E0002 0030000054616250
0040: 616765436F756E74 0002003100005461 624C6162656C7300 3F004C6162656C30
0060: 094C6162656C3109 4C6162656C32094C 6162656C33094C61 62656C34094C6162
0080: 656C35094C616265 6C36094C6162656C 37094C6162656C38 00005461624E616D
00A0: 65730036004E616D 6530094E616D6531 094E616D6532094E 616D6533094E616D
00C0: 6534094E616D6535 094E616D6536094E 616D6537094E616D 6538000054616252
00E0: 696768744D617267 696E000200300000 5461624472617753 74796C65000B0057
0100: 696E39355374796C 650000546162466F 726D506167657300 D800446C675F4F70
0120: 6572547473202020 2020212054414223 3009446C675F4F70 4361727420202020
0140: 2020212054414223 3109446C675F4F70 466C677320202020 2020212054414223
0160: 3209446C675F4F70 52656C7320202020 2020212054414223 3309446C675F4F70
0180: 4E62737320202020 2020212054414223 3409446C675F4F70 566F627320202020
01A0: 2020212054414223 3509446C675F4F70 4772707320202020 2020212054414223
01C0: 3609446C675F4F70 496E666F20202020 2020212054414223 3709446C675F4F70
01E0: 466F6C6420202020 2020212054414223 380000546162546F 704D617267696E00
0200: 0200300000000000 0000000000000000 0000000000000000 00
.enddata
.data CLASSPROPSSIZE
0000: 1902
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 1
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cQuickTabsForm
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   Class Default
.head 5 -  Top:    Class Default
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  File Name:
.head 4 -  Storage: Class Default
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Fit: Class Default
.head 4 -  Scaling
.head 5 -  Width:  Class Default
.head 5 -  Height:  Class Default
.head 4 -  Corners: Class Default
.head 4 -  Border Style: Class Default
.head 4 -  Border Thickness: Class Default
.head 4 -  Tile To Parent? Class Default
.head 4 -  Border Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendClassMessage( SAM_Create, wParam, lParam )
.head 6 -  ! Операции
.head 6 -  Call picTabs.SetLabel(0,' '||CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabsTts')||' ', TRUE)
.head 6 -  Call picTabs.SetLabel(0+1,' '||CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs0')||' ', TRUE)
.head 6 -  Call picTabs.SetLabel(1+1,' '||CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs1')||' ', TRUE)
.head 6 -  Call picTabs.SetLabel(2+1,' '||CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs2')||' ', TRUE)
.head 6 -  Call picTabs.SetLabel(3+1,' '||CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs3')||' ', TRUE)
.head 6 -  Call picTabs.SetLabel(4+1,' '||CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs4')||' ', TRUE)
.head 6 -  Call picTabs.SetLabel(5+1,' '||CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs5')||' ', TRUE)
.head 6 -  Call picTabs.SetLabel(6+1,' '||CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs6')||' ', TRUE)
.head 6 -  Call picTabs.SetLabel(7+1,' '||CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs7')||' ', TRUE)
.head 6 +  If Option = 9
.head 7 -  Call picTabs.Enable(0, FALSE)
.head 7 -  Call picTabs.Enable(1, FALSE)
.head 7 -  Call picTabs.Enable(2, FALSE)
.head 7 -  Call picTabs.Enable(3, FALSE)
.head 7 -  Call picTabs.Enable(4, FALSE)
.head 7 -  Call picTabs.Enable(5, FALSE)
.head 7 -  Call picTabs.Enable(7, FALSE)
.head 6 -  Call picTabs.InitializeFormPages(Str(SalWindowHandleToNumber(hWndForm)) || ';' || TT )
.head 2 +  Functions
.head 3 +  Function: Modified
.head 4 -  Description: Высталяет признак наличия изменений
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 +  If NOT IsEdited
.head 6 -  Set IsEdited = TRUE
.head 6 -  Call SalEnableWindow( pbUpdate )
.head 3 +  Function: ShowPickList
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Window Handle: hParent
.head 5 -  String: strSql
.head 5 -  String: strHeader
.head 5 -  String: strFilterTable
.head 5 -  Receive String: Identifier
.head 5 -  Receive String: Semantic
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strIdentifier
.head 5 -  String: strSemantic
.head 4 +  Actions
.head 5 +  If SalModalDialog( dlg_PickList, hParent, strSql, strHeader, strFilterTable, strIdentifier, strSemantic )=1
.head 6 -  Set Identifier=strIdentifier
.head 6 -  Set Semantic=strSemantic
.head 6 -  Return 1
.head 5 +  Else
.head 6 -  Return 0
.head 3 +  Function: OperationInfo
.head 4 -  Description: Возвращает информацию об операции по коду
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  String: strTT
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: sCurLine
.head 5 -  String: sCurLine1
.head 5 -  String: sSqlText
.head 5 -  Number: nPiRes
.head 5 -  String: sEOL
.head 5 -  Number: nFLV
.head 5 -  Number: nFLC
.head 5 -  Boolean: fHead
.head 5 -  Number: n1
.head 5 -  String: s1
.head 5 -  String: s2
.head 5 -  String: strResult
.head 4 +  Actions
.head 5 -  Set sEOL = SalNumberToChar(13) || SalNumberToChar(10)
.head 5 -  Set strResult = ''
.head 5 -  Set sSqlText = "SELECT a.tt || '  ' || a.name || '(' || b.name || ')' INTO :sCurLine FROM tts a, dk b WHERE a.dk=b.dk and tt=:strTT"
.head 5 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 5 +  If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 6 -  ! Наименование
.head 6 -  Set strResult = strResult || sCurLine
.head 6 -  Set sSqlText = "SELECT b.name INTO :sCurLine FROM tts a,interbank b WHERE a.fli=b.fli and a.tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +  If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Тип Операции: ' || sCurLine
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgOperType') || ': ' || sCurLine
.head 6 -  ! Общие свойства
.head 6 -  Set sSqlText = "SELECT mfob INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +  If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    МФО Б: ' || sCurLine
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgMfoB') || ': ' || sCurLine
.head 6 -  Set strResult = strResult || sEOL
.head 6 -  !
.head 6 -  Set sSqlText = "SELECT nlsm, kv INTO :sCurLine, :sCurLine1 FROM tts WHERE tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +  If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Счет А для оплаты: '|| sCurLine
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgAccA') || ': ' || sCurLine || IifS(sCurLine1!='','('||sCurLine1||')','')
.head 6 -  !
.head 6 -  Set sSqlText = "SELECT nlsk, kvk INTO :sCurLine, :sCurLine1 FROM tts WHERE tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +  If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Счет Б для оплаты: '|| sCurLine
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgAccB') || ': '|| sCurLine || IifS(sCurLine1!='','('||sCurLine1||')','')
.head 6 -  !
.head 6 -  Set sSqlText = "SELECT nlsa INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +  If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Счет А для ввода: ' || sCurLine
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgBankA') || ': ' || sCurLine
.head 6 -  !
.head 6 -  Set sSqlText = "SELECT nlsb INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +  If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Счет Б для ввода: ' || sCurLine
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgBankB') || ': ' || sCurLine
.head 6 -  Set strResult = strResult || sEOL
.head 6 -  !
.head 6 -  Set sSqlText = "SELECT sk INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +  If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Символ кассы: ' || sCurLine
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgSKP') || ': ' || sCurLine
.head 6 -  Set strResult = strResult || sEOL
.head 6 -  !
.head 6 -  Set sSqlText = "SELECT s INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +  If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Формула суммы: ' || sCurLine
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgSum') || ': ' || sCurLine
.head 6 -  !
.head 6 -  Set sSqlText = "SELECT s2 INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +  If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Формула суммы 2: ' || sCurLine
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgSum2') || ': ' || sCurLine
.head 6 -  !
.head 6 -  Set sSqlText = "SELECT rang INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +  If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 -  Set strResult = strResult || sEOL
.head 7 -  ! Set strResult=strResult || sEOL || '    Приоритет: ' || sCurLine
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTPriority') || ': ' || sCurLine
.head 6 -  ! Свойства мультивалютной
.head 6 -  Set sSqlText = "SELECT flv INTO :nFLV FROM tts WHERE tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +  If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 +  If nFLV
.head 8 -  Set strResult = strResult || sEOL
.head 8 -  ! Set strResult=strResult || sEOL || "  Свойства мультивалютной операции"
.head 8 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMultiVal')
.head 8 -  !
.head 8 -  Set sSqlText = "SELECT s3800 INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 8 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 8 +  If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 9 -  ! Set strResult=strResult || sEOL || '    Счет вал. позиции: '||sCurLine
.head 9 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgAccVP') || ': '||sCurLine
.head 8 -  !
.head 8 -  Set sSqlText = "SELECT b.nls || '(' || b.kv || ')' INTO :sCurLine FROM tts a, accounts b WHERE a.s6201=b.acc and a.tt=:strTT"
.head 8 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 8 +  If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 9 -  ! Set strResult=strResult || sEOL || '    Счет доходов: ' || sCurLine
.head 9 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgAccInc') || ': ' || sCurLine
.head 8 -  !
.head 8 -  Set sSqlText = "SELECT b.nls || '(' || b.kv || ')' INTO :sCurLine FROM tts a, accounts b WHERE a.s7201=b.acc and a.tt=:strTT"
.head 8 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 8 +  If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 9 -  ! Set strResult=strResult || sEOL || '    Счет расходов: ' || sCurLine
.head 9 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgAccExp') || ': ' || sCurLine
.head 6 -  ! Связанные операции
.head 6 -  Set sSqlText = "SELECT flc INTO :nFLC FROM tts WHERE tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +  If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 +  If nFLC
.head 8 -  Set strResult = strResult || sEOL
.head 8 -  ! Set strResult=strResult || sEOL || "  Связанные операции"
.head 8 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs2') || ':'
.head 8 -  !
.head 8 -  Set sSqlText =
"SELECT a.tt || ' ' || a.name, NVL(b.dk,0)
 INTO :sCurLine, :sCurLine1
 FROM tts a, ttsap b
 WHERE a.tt=b.ttap and b.tt=:strTT
 ORDER BY a.tt"
.head 8 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 8 +  While SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 9 -  Set strResult = strResult || sEOL || '    ' || sCurLine ||
    ' (' || CurrentLangTable.GetAtomTitle('dlg_OperCard.cTInvDC') || '=' || sCurLine1 || ')'
.head 6 -  Set strResult = strResult || sEOL
.head 6 -  ! Флаги
.head 6 -  Set fHead = FALSE
.head 6 -  Set sSqlText =
"SELECT f.code || ' - ' || f.name || ' (' || l.Value ||')'
 INTO :sCurLine
 FROM flags f, tts_flags l
 WHERE f.code=l.fcode AND l.tt=:strTT
 ORDER BY 1"
.head 6 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +  While SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 +  If NOT fHead
.head 8 -  ! Set strResult=strResult || sEOL || "  Флаги:"
.head 8 -  Set strResult=strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTFlags') || ':'
.head 8 -  Set fHead = TRUE
.head 7 -  Set strResult = strResult || sEOL || "    " || sCurLine
.head 6 +  If NOT fHead
.head 7 -  ! Set strResult=strResult || sEOL || "  Флаги отсутствуют"
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTNotFlags')
.head 6 -  Set strResult = strResult || sEOL
.head 6 -  ! Доп. реквизиты
.head 6 -  Set fHead = FALSE
.head 6 -  Set sSqlText =
"SELECT l.ord || ' - <' || r.tag || '> ' || r.Name, l.opt, l.used4input, l.val
 INTO :sCurLine, :s1, :n1, :s2
 FROM op_field r, op_rules l
 WHERE r.tag=l.tag AND l.tt=:strTT
 ORDER BY l.ord, r.tag"
.head 6 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +  While SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 +  If NOT fHead
.head 8 -  ! Set strResult=strResult || sEOL || "  Доп. реквизиты:"
.head 8 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTDopR') || ':'
.head 8 -  Set fHead = TRUE
.head 7 +  If s1 = "M"
.head 8 -  ! Set s1="Обязательный"
.head 8 -  Set s1 = CurrentLangTable.GetAtomTitle('dlg_OperCard.cTOpt')
.head 7 +  Else
.head 8 -  ! Set s1="Необязательный"
.head 8 -  Set s1 = CurrentLangTable.GetAtomTitle('dlg_OperCard.cTNotOpt')
.head 7 +  If n1
.head 8 -  ! Set s1="Использовать для ввода," || s1
.head 8 -  Set s1 = CurrentLangTable.GetAtomTitle('dlg_OperCard.cTForInput') || "," || s1
.head 7 +  Else
.head 8 -  ! Set s1="Не использовать для ввода," || s1
.head 8 -  Set s1 = CurrentLangTable.GetAtomTitle('dlg_OperCard.cTNotForInput') || "," || s1
.head 7 -  Set strResult = strResult || sEOL || "    " || sCurLine || "(" || s1 || ")"
.head 7 +  If s2
.head 8 -  Set strResult = strResult || " - " || s2
.head 6 +  If NOT fHead
.head 7 -  ! Set strResult=strResult || sEOL || "  Доп. реквизиты отсутствуют"
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTNotDopR')
.head 6 -  ! Бал. счета
.head 6 -  Set fHead = FALSE
.head 6 -  Set sSqlText =
"SELECT s.nbs || ' ' || s.name, l.dk
 INTO :sCurLine, :n1
 FROM ps s,ps_tts l
 WHERE s.nbs=l.nbs AND l.tt=:strTT
 ORDER BY 1"
.head 6 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +  While SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 +  If NOT fHead
.head 8 -  Set strResult = strResult || sEOL
.head 8 -  ! Set strResult=strResult || sEOL || "  Допустимые балансовые счета:"
.head 8 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTBalAcc') || ':'
.head 8 -  Set fHead = TRUE
.head 7 +  If n1
.head 8 -  ! Set s1="Кредитовать"
.head 8 -  Set s1 = CurrentLangTable.GetAtomTitle('dlg_OperCard.cTCred')
.head 7 +  Else
.head 8 -  ! Set s1="Дебетовать"
.head 8 -  Set s1 = CurrentLangTable.GetAtomTitle('dlg_OperCard.cTDeb')
.head 7 -  Set strResult=strResult || sEOL || "    " || sCurLine || " (" || s1 || ")"
.head 6 -  Set strResult = strResult || sEOL
.head 6 -  ! Виды док-тов
.head 6 -  Set fHead = FALSE
.head 6 -  Set sSqlText =
"SELECT v.name || ' (' || UPPER ( v.rep_prefix ) || ')'
 INTO :sCurLine
 FROM vob v, tts_vob l
 WHERE v.vob=l.vob AND l.tt=:strTT
 ORDER BY 1"
.head 6 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +  While SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 +  If NOT fHead
.head 8 -  ! Set strResult=strResult || sEOL || "  Виды док-тов:"
.head 8 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs4') || ':'
.head 8 -  Set fHead = TRUE
.head 7 -  Set strResult = strResult || sEOL || "    " || sCurLine
.head 6 +  If NOT fHead
.head 7 -  ! Set strResult=strResult || sEOL || "  Виды док-тов отсутствуют"
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTNotVidDoc')
.head 6 -  Set strResult = strResult || sEOL
.head 6 -  ! Визы
.head 6 -  Set fHead = FALSE
.head 6 -  Set sSqlText =
"SELECT l.priority || ' ' || c.name
 INTO :sCurLine
 FROM chklist c, chklist_tts l
 WHERE c.idchk=l.idchk AND l.tt=:strTT
 ORDER BY l.priority"
.head 6 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +  While SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 +  If NOT fHead
.head 8 -  ! Set strResult=strResult || sEOL || "  Группы контроля:"
.head 8 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs5') || ':'
.head 8 -  Set fHead = TRUE
.head 7 -  Set strResult = strResult || sEOL || "    " || sCurLine
.head 6 +  If NOT fHead
.head 7 -  ! Set strResult=strResult || sEOL || "  Группы контроля отсутствуют"
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTNotGroups')
.head 6 -  Set strResult = strResult || sEOL
.head 6 -  ! Пользователи
.head 6 -  Set fHead = FALSE
.head 6 -  Set sSqlText = "SELECT value INTO :nFLV FROM tts_flags WHERE fcode=0 AND tt=:strTT"
.head 6 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +  If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok and nFLV != 0
.head 7 -  Set sSqlText =
"SELECT s.id || ' ' || s.fio
 INTO :sCurLine
 FROM staff s, staff_tts l
 WHERE s.id=l.id AND l.tt=:strTT
 ORDER BY s.id"
.head 7 -  Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 7 +  While SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 8 +  If NOT fHead
.head 9 -  ! Set strResult=strResult || sEOL || "  Операция доступна на ввод следующим пользователям:"
.head 9 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTOperAccess') || ':'
.head 9 -  Set fHead = TRUE
.head 8 -  Set strResult = strResult || sEOL || "    " || sCurLine
.head 7 +  If NOT fHead
.head 8 -  ! Set strResult=strResult || sEOL || "  Операция доступна на ввод, но не дана ни одному пользователю"
.head 8 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTOperAccess1')
.head 6 +  Else
.head 7 -  ! Set strResult=strResult || sEOL || "  Операция недоступна на ввод"
.head 7 -  Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTOperAccess2')
.head 5 -  Return strResult
.head 2 +  Window Parameters
.head 3 -  Number: Option
.head 3 -  ! Number: nMode
.head 3 -  Number: nPar
.head 3 -  String: strPar01
.head 3 -  String: strPar02
.head 2 +  Window Variables
.head 3 -  Boolean: IsEdited
.head 3 -  Window Handle: hWndTab[*]
.head 3 -  String: TT   ! Текущий тип операции
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Инициализация lang-файла для tooltip'ов кнопок
.head 4 -  Call InitLabelLangFile()
.head 4 -  ! Настройка шаблонов операций
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_OperList.cTWndTitle'))
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Set TT = '   '
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalSetFocus(hWndTab[0])
.head 3 +  On UM_Populate
.head 4 -  Call SalSendMsg( hWndTab[picTabs.GetTop()], UM_Populate, 0, 0 )
.head 3 +  On UM_Insert
.head 4 -  Call SalSendMsg( hWndTab[picTabs.GetTop()], UM_Insert, 0, 0 )
.head 3 +  On UM_Update
.head 4 +  If picTabs.ApplyFormPageChanges()
.head 5 -  Call SqlCommitEx(hSql(), "Корректировка операции " || TT)
.head 5 -  Set IsEdited = FALSE
.head 5 -  Call SalDisableWindow( pbUpdate )
.head 4 +  Else
.head 5 -  Call SqlRollback( hSql() )
.head 3 +  On UM_Delete
.head 4 -  Call SalSendMsg( hWndTab[picTabs.GetTop()], UM_Delete, 0, 0 )
.head 3 +  On UM_Choose
.head 4 -  Call SalSendMsg( hWndTab[picTabs.GetTop()], UM_Choose, 0, 0 )
.head 3 +  On UM_CreateDoc
.head 4 -  Call SalSendMsg( hWndTab[picTabs.GetTop()], UM_CreateDoc, 0, lParam )
.head 3 +  On UM_Print
.head 4 -  Call SalSendMsg( hWndTab[picTabs.GetTop()], UM_Print, 0, 0 )
.head 3 +  On SAM_Close
.head 4 +  If IsEdited
.head 5 -  ! Настройки не сохранены! Сохранить?
.head 5 +  Select Case SalMessageBox( CurrentLangTable.GetAtomTitle('frm_OperList.cTMsgOperNotSave') || PutCrLf() ||
  CurrentLangTable.GetAtomTitle('frm_OperList.cTMsgSave'),
  CurrentLangTable.GetAtomTitle('frm_OperList.cTMsgOper'), MB_YesNoCancel | MB_IconQuestion )
.head 6 +  Case IDYES
.head 7 -  Call SalSendMsg( hWndForm, UM_Update, 0, 0 )
.head 7 -  Break
.head 6 +  Case IDNO
.head 7 -  Call SqlRollback( hSql() )
.head 7 -  Break
.head 6 +  Case IDCANCEL
.head 7 -  Return FALSE
.head 4 +  Else
.head 5 -  Call SqlRollback( hSql() )
.head 1 +  Dialog Box: Dlg_OperTts     ! TAB#0
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  8.457"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.208"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  7.686"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 3000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colTT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  0.783"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Uppercase
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  Column: colTT_NAME
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Название банковской операции
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 70
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  8.383"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  Column: colTT_BRANCH
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Отделение
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 30
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Left
.head 6 -  Width:  3.383"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  Column: colComplex
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 +  Functions
.head 5 +  Function: GetFirstEditableColumn
.head 6 -  Description: Получить первую редактируюмую колонку
.head 6 +  Returns
.head 7 -  Window Handle:
.head 6 +  Parameters
.head 7 -  Window Handle: hWndTbl
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nCol
.head 7 -  Window Handle: hWndCol
.head 6 +  Actions
.head 7 -  Set nCol=1
.head 7 +  Loop
.head 8 -  Set hWndCol = SalTblGetColumnWindow( hWndTbl, nCol, COL_GetPos )
.head 8 +  If hWndCol=hWndNULL
.head 9 -  Break
.head 8 +  If SalTblQueryColumnFlags(hWndCol, COL_Editable ) AND
SalIsWindowVisible( hWndCol )
.head 9 -  Break
.head 8 -  Set nCol=nCol+1
.head 7 -  Return hWndCol
.head 5 +  Function: RestorePos
.head 6 -  Description: Установить на старое место
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sTT
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nMinRow
.head 7 -  Number: nMaxRow
.head 6 +  Actions
.head 7 -  Call SalTblQueryScroll ( hWndForm, nTmp, nMinRow, nMaxRow )
.head 7 -  Set nRow = VisTblFindString (hWndForm, 0, colTT, sTT)
.head 7 +  If nRow = -1 or nRow > nMaxRow
.head 8 -  Set nRow=0
.head 7 -  Call SalTblSetContext( hWndForm, nRow )
.head 7 -  Call SalTblSetFocusRow( hWndForm, nRow )
.head 7 -  Call SalTblSetRowFlags( hWndForm, nRow, ROW_Selected, TRUE )
.head 4 +  Window Variables
.head 5 -  Window Handle: hCol
.head 5 -  !
.head 5 -  : cMain
.head 6 -  Class: cABSConnect
.head 5 -  : cF
.head 6 -  Class: cGenFilter
.head 5 -  : cQ
.head 6 -  Class: cGenQuery
.head 5 -  : cCstTab
.head 6 -  Class: cABSTab
.head 5 -  String: strDSql
.head 5 -  Boolean: bSortOrd
.head 5 -  Number: nCurRow
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 5 +  On UM_Insert
.head 6 +  If NOT SalTblAnyRows( hWndForm, ROW_New, 0 )
.head 7 -  Call SalTblDefineSplitWindow( hWndForm, 3, TBL_Split_Adjustable )
.head 6 -  Set nRow = SalTblInsertRow( hWndForm, TBL_MinRow )
.head 6 -  Set hCol = GetFirstEditableColumn( hWndForm )
.head 6 -  Call SalTblSetContext( hWndForm, nRow )
.head 6 -  Call SalTblSetFocusCell( hWndForm, nRow, hCol, 0, 1 )
.head 5 +  On UM_Delete
.head 6 -  Call SalSendMsg( hWndForm, SAM_RowHeaderDoubleClick, 0, 0 )
.head 5 +  On UM_Populate
.head 6 +  If strSqlPopulate != ''
.head 7 +  If fFilterAtStart
.head 8 +  If SetQueryFilter( cF )
.head 9 -  Set fFilterAtStart = NOT fFilterAtStart
.head 7 +  If NOT fFilterAtStart
.head 8 -  Call SalWaitCursor( TRUE )
.head 8 -  Call SalTblDefineSplitWindow( hWndForm, 0, FALSE )
.head 8 -  Set strDSql = cQ.GetFullSQLString( cF )
.head 8 -  Call SalTblPopulate( hWndForm, cMain.hSql(), T(strDSql), TBL_FillAll )
.head 8 -  Call SalSendMsg( hWndForm, SAM_User, 0, 0)
.head 8 -  ! Call RestorePos( hWndParent.frm_OperCard.TT )
.head 8 -  Call SalSendMsg( hWndForm, SAM_TblDoDetails, 0, 0)
.head 8 -  Call SalWaitCursor( FALSE )
.head 5 +  On UM_Update
.head 6 -  Call SalWaitCursor( TRUE )
.head 6 -  Call SaveInfoToLog( MSG_SaveDataRef(  ) || ' ' || strTitleAux )
.head 6 +  If strSqlDelete != ''
.head 7 -  Call SqlPrepare( cMain.hSql(), T(strSqlDelete) )
.head 7 -  Call SalTblDoDeletes( hWndForm, cMain.hSql(), ROW_MarkDeleted )
.head 6 +  If strSqlInsert != ''
.head 7 -  Call SqlPrepare( cMain.hSql(), T(strSqlInsert) )
.head 7 -  Call SalTblDoInserts( hWndForm, cMain.hSql(), TRUE )
.head 6 +  If strSqlUpdate != ''
.head 7 -  Call SqlPrepare( cMain.hSql(), T(strSqlUpdate) )
.head 7 -  Call SalTblDoUpdates( hWndForm, cMain.hSql(), TRUE )
.head 6 -  Call SalTblDefineSplitWindow( hWndForm, 0, FALSE )
.head 6 -  Call SalPostMsg( hWndForm, UM_Populate, 0, 0 )
.head 6 -  Call SalWaitCursor( FALSE )
.head 5 +  On UM_Choose
.head 6 +  If SetQueryFilter( tbl.cF )
.head 7 -  Call SalPostMsg( tbl, UM_Populate, 0, 0 )
.head 5 +  On SAM_TblDoDetails
.head 6 -  Set hWndParent.frm_OperCard.TT = colTT
.head 6 -  Set hWndParent.frm_OperCard.dfOpDesc = colTT ||'-'|| colTT_NAME
.head 6 -  Call hWndParent.frm_OperCard.picTabs.Enable( 3, colComplex )
.head 5 +  On SAM_ColumnSelectClick
.head 6 -  Call SalTblSetColumnFlags( SalNumberToWindowHandle(wParam), COL_Selected, FALSE )
.head 6 -  Set bSortOrd = not bSortOrd
.head 6 -  Call SalTblSortRows(tbl, SalTblQueryColumnID(SalNumberToWindowHandle(wParam)), bSortOrd)
.head 6 -  Call RestorePos( hWndParent.frm_OperCard.TT )
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 +  If NOT SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted, TRUE, ROW_Selected, ROW_MarkDeleted )
.head 7 -  Call SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted, FALSE, ROW_Selected, 0 )
.head 6 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  On WM_KeyUp
.head 6 +  If wParam=VK_Delete
.head 7 -  Call SalSendMsg( hWndForm, SAM_RowHeaderDoubleClick, 0, 0 )
.head 5 +  On SAM_KillFocus
.head 6 -  Set hWndParent.frm_OperCard.TT = colTT
.head 6 -  Set hWndParent.frm_OperCard.dfOpDesc = colTT ||'-'|| colTT_NAME
.head 5 +  On SAM_DoubleClick
.head 6 -  Call hWndParent.frm_OperCard.picTabs.BringToTop( 1, TRUE )
.head 5 +  On SAM_User
.head 6 -  Call RestorePos( hWndParent.frm_OperCard.TT )
.head 2 +  Functions
.head 3 +  Function: DoExportSelected
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  ! № строки и колонки для событий
.head 5 -  Number: nTmpRowNumber
.head 5 -  Number: nTmpPriRowNumber
.head 5 -  String: strTmpFileCont
.head 5 -  File Handle: hTmpFile
.head 5 -  Number: nTmpOptions
.head 5 -  String: strTmpFileName
.head 4 +  Actions
.head 5 +  If NOT SalTblAnyRows(tbl, ROW_Selected, 0)
.head 6 -  ! Ни одна операция не выбранна!
.head 6 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_OperList.cTMsgOperNotSelect'),
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop | MB_Ok)
.head 6 -  Return FALSE
.head 5 +  If SalModalDialog(dlg_OperExpOpts, hWndForm, strTmpFileName, nTmpOptions, nFlIns, tbl.colTT)
.head 6 +  If NOT nTmpOptions
.head 7 -  ! Ничего не выбранно для экспорта!
.head 7 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_OperList.cTMsgExpNotSelect'),
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop | MB_Ok)
.head 7 -  Return FALSE
.head 6 -  Set nTmpPriRowNumber = SalTblQueryContext(tbl)
.head 6 -  Set nTmpRowNumber = TBL_MinRow
.head 6 -  ! Сброс массива операций - подготовка функции SG_OperToString к работе
.head 6 -  Set strTmpFileCont = SG_OperToString('', '', 0)
.head 6 -  Set strTmpFileCont = 
"set lines 1000
set trimspool on
set serveroutput on size 1000000" || PutCrLf() || PutCrLf()
.head 6 -  Call WaitCursorOn()
.head 6 +  While TRUE
.head 7 +  If SalTblFindNextRow(tbl, nTmpRowNumber, ROW_Selected, 0)
.head 8 -  Call SalTblSetContext(tbl, nTmpRowNumber)
.head 8 -  Set strTmpFileCont = strTmpFileCont || SG_OperToString(tbl.colTT, tbl.colTT_NAME, nTmpOptions)
.head 7 +  Else
.head 8 -  Call WaitCursorOff()
.head 8 +  If strTmpFileCont
.head 9 -  Set strTmpFileCont = strTmpFileCont || PutCrLf() || 
"commit;" || PutCrLf()
.head 9 +  If SalFileOpen(hTmpFile, strTmpFileName, OF_Create | OF_ReadWrite)
.head 10 -  Call SalFileWrite(hTmpFile, strTmpFileCont, SalStrLength(strTmpFileCont))
.head 10 -  Call SalFileClose(hTmpFile)
.head 10 -  ! Операции сохранены в файле: strTmpFileName
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_OperList.cTMsgOperSaveToFile') || ': ' || strTmpFileName, '', MB_IconAsterisk | MB_Ok)
.head 9 +  Else
.head 10 -  ! Не могу создать файл: strTmpFileName
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_OperList.cTMsgFileNotCreate') || ': ' || strTmpFileName,
     CurrentLangTable.GetAtomTitle('cTErr'), MB_IconStop | MB_Ok)
.head 10 -  Return FALSE
.head 8 -  Call SalTblSetContext(tbl, nTmpPriRowNumber)
.head 8 -  Return TRUE
.head 3 -  !
.head 3 +  Function: SG_OperToString
.head 4 -  Description: Выгрузка операции в строку
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Код операции
.head 5 -  String: strTT
.head 5 -  ! Наименование операции
.head 5 -  String: strNAME
.head 5 -  ! Опции экспорта
.head 5 -  ! 1 - Выдавать сообщения о несуществующих счетах или валютах
! 2 - Подменять T00
! 4 - Флаги
! 8 - Доп. реквизиты
! 16 - Включать связанные операции
! 32 - Бал. счета
! 64 - Группы контроля
! 128 - Виды документов
! 256 - Распределение по папкам
! 512 - Резерв
! 1024 - Резерв
! 2047 - Все!
.head 5 -  Number: nOptions
.head 4 +  Static Variables
.head 5 -  String: strTT_List[*]
.head 5 -  Number: nTT_ListCount
.head 4 +  Local variables
.head 5 -  Number: i
.head 5 -  String: sEOL
.head 5 -  : hConnect
.head 6 -  Class: cABSConnect
.head 5 -  : hConnectAux
.head 6 -  Class: cABSConnect
.head 5 -  String: Result
.head 5 -  String: strProcVars
.head 5 -  String: strProcPart
.head 4 +  Actions
.head 5 -  ! Сброс имен для экспорта
.head 5 +  If NOT strTT
.head 6 -  Call SalArraySetUpperBound(strTT_List, 1, -1)
.head 6 -  Set nTT_ListCount = 0
.head 6 -  Return ''
.head 5 -  ! Проверка на необходимость экспорта (исключение повторного)
.head 5 +  Else
.head 6 +  If nTT_ListCount > 0
.head 7 -  Set i = 0
.head 7 +  While i < nTT_ListCount
.head 8 +  If strTT_List[i] = strTT
.head 9 -  ! Операция уже экспортировалась - экспортировать не надо!
.head 9 -  Return ''
.head 8 -  Set i=i+1
.head 6 -  ! Добавление текущей операциив в массив
.head 6 -  Call SalArraySetUpperBound(strTT_List, 1, nTT_ListCount)
.head 6 -  Set strTT_List[nTT_ListCount] = strTT
.head 6 -  Set nTT_ListCount=nTT_ListCount+1
.head 5 -  Set sEOL = SalNumberToChar(13) || SalNumberToChar(10)
.head 5 -  Call XConnectGetParams(hConnect)
.head 5 -  Call hConnectAux.Clone(hConnect, FALSE)
.head 5 -  Set Result = ''
.head 5 +  If hConnect.Connect() AND hConnectAux.Connect()
.head 6 -  ! Если со связ. операциями - экспортим сначала их
.head 6 +  If SG_CheckOption(nOptions,16)
.head 7 -  Set Result = Result ||
    SG_ExportRelatedOpers(
       hConnect.hSql(),
       strTT,
       nOptions)
.head 6 -  Set Result = Result || "prompt Создание / Обновление операции " || strTT || sEOL
.head 6 -  Set Result = Result || "prompt Наименование операции: " || strNAME || sEOL
.head 6 -  ! Уст. все переменные
.head 6 -  Set strProcVars = "cnt_  number;"
.head 6 -  ! Строю процедурную часть
.head 6 -  Set strProcPart = ''
.head 6 -  Set strProcPart = strProcPart ||
    SG_ExportMainProps(
       hConnect.hSql(),
       hConnectAux.hSql(),
       strTT,
       SG_CheckOption(nOptions,1),
       SG_CheckOption(nOptions,2)) || sEOL
.head 6 +  ! If SG_CheckOption(nOptions,4)
.head 7 -  Set strProcPart = strProcPart ||
    SG_ExportFlags(
       hConnect.hSql(),
       hConnectAux.hSql(),
       strTT) || sEOL
.head 6 +  If SG_CheckOption(nOptions,8)
.head 7 -  Set strProcPart = strProcPart ||
    SG_ExportAuxs(
       hConnect.hSql(),
       hConnectAux.hSql(),
       strTT) || sEOL
.head 6 +  If SG_CheckOption(nOptions,16)
.head 7 -  Set strProcPart = strProcPart ||
    SG_ExportCmpxs(
       hConnect.hSql(),
       hConnectAux.hSql(),
       strTT) || sEOL
.head 6 +  If SG_CheckOption(nOptions,32)
.head 7 -  Set strProcPart = strProcPart ||
    SG_ExportBals(
       hConnect.hSql(),
       hConnectAux.hSql(),
       strTT) || sEOL
.head 6 +  If SG_CheckOption(nOptions,128)
.head 7 -  Set strProcPart = strProcPart ||
    SG_ExportVobs(
       hConnect.hSql(),
       hConnectAux.hSql(),
       strTT) || sEOL
.head 6 +  If SG_CheckOption(nOptions,64)
.head 7 -  Set strProcPart = strProcPart ||
    SG_ExportChks(
       hConnect.hSql(),
       hConnectAux.hSql(),
       strTT) || sEOL
.head 6 +  If SG_CheckOption(nOptions,256)
.head 7 -  Set strProcPart = strProcPart ||
    SG_ExportFlds(
       hConnect.hSql(),
       hConnectAux.hSql(),
       strTT) || sEOL
.head 6 -  Set Result = Result || SG_WrapCommand(strProcVars, strProcPart, 0) || "/" || sEOL
.head 6 -  Call hConnect.Disconnect()
.head 5 -  Return Result || sEOL
.head 3 +  Function: SG_ExportRelatedOpers
.head 4 -  Description: Экспорт связанных операций
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandle
.head 5 -  ! Код операции
.head 5 -  String: strTT
.head 5 -  ! Опции экспорта
.head 5 -  Number: nOptions
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: Result
.head 5 -  String: strRelatedTT
.head 5 -  String: strRelatedNAME
.head 5 -  Number: nFetchRes
.head 4 +  Actions
.head 5 -  Set Result=''
.head 5 -  Set Result=Result || 'SG_ExportRelatedOpers: ' || strTT ||'
'
.head 5 -  Set Result=''
.head 5 +  If SqlPrepareAndExecute( hSqlHandle,
"SELECT B.TT, B.NAME INTO :strRelatedTT, :strRelatedNAME 
   FROM TTSAP A, TTS B
  WHERE A.TTAP=B.TT AND A.TT=:strTT " )
.head 6 +  While SqlFetchNext( hSqlHandle, nFetchRes )
.head 7 -  Set Result = Result || SG_OperToString(strRelatedTT, strRelatedNAME, nOptions )
.head 5 -  Return Result
.head 3 -  ! Start here
.head 3 +  Function: SG_ExportMainProps
.head 4 -  Description: Экспорт основных свойств
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandle
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandleAux
.head 5 -  ! Код операции
.head 5 -  String: strTT
.head 5 -  ! Выдавать ошибки
.head 5 -  Boolean: bErrors
.head 5 -  ! Подменять T00
.head 5 -  Boolean: bT00
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: Result
.head 5 -  String: Header
.head 5 -  !
.head 5 -  String: strColName[*]
.head 5 -  Number: nColType[*]
.head 5 -  String: strColValue[*]
.head 5 -  Number: nColValue[*]
.head 5 -  !
.head 5 -  Number: nTmpS6201
.head 5 -  Number: nTmpS7201
.head 5 -  String: strTmpTip
.head 5 -  Boolean: bTmpT00
.head 5 -  Number: nTmpKV
.head 5 -  !
.head 5 -  Number: nFetchRes
.head 4 +  Actions
.head 5 -  Set Header = 
"--------------------------------
-- Основные свойства операции --
--------------------------------
"
.head 5 -  Set Result = ''
.head 5 -  Call SalArraySetUpperBound(strColName, 1, 30)
.head 5 -  Call SalArraySetUpperBound(nColType, 1, 30)
.head 5 -  Call SalArraySetUpperBound(strColValue, 1, 30)
.head 5 -  Call SalArraySetUpperBound(nColValue, 1, 30)
.head 5 -  ! Метаописание TTS
.head 5 +  If TRUE
.head 6 -  ! TT, NAME, DK, NLSM, KV, NLSK, KVK, NLSS, NLSA, NLSB, MFOB, FLC, FLI, FLV, FLR,
 S, S2, SK, PROC, S3800, S6201, S7201, RANG, FLAGS, NAZN
.head 6 -  Set strColName[0]='tt'
.head 6 -  Set strColName[1]='name'
.head 6 -  Set strColName[2]='dk'
.head 6 -  Set strColName[3]='nlsm'
.head 6 -  Set strColName[4]='kv'
.head 6 -  Set strColName[5]='nlsk'
.head 6 -  Set strColName[6]='kvk'
.head 6 -  Set strColName[7]='nlss'
.head 6 -  Set strColName[8]='nlsa'
.head 6 -  Set strColName[9]='nlsb'
.head 6 -  Set strColName[10]='mfob'
.head 6 -  Set strColName[11]='flc'
.head 6 -  Set strColName[12]='fli'
.head 6 -  Set strColName[13]='flv'
.head 6 -  Set strColName[14]='flr'
.head 6 -  Set strColName[15]='s'
.head 6 -  Set strColName[16]='s2'
.head 6 -  Set strColName[17]='sk'
.head 6 -  Set strColName[18]='proc'
.head 6 -  Set strColName[19]='s3800'
.head 6 -  Set strColName[20]='rang'
.head 6 -  Set strColName[21]='flags'
.head 6 -  Set strColName[22]='nazn'
.head 6 -  Set nColType[0]=1
.head 6 -  Set nColType[1]=1
.head 6 -  Set nColType[2]=2
.head 6 -  Set nColType[3]=1
.head 6 -  Set nColType[4]=2
.head 6 -  Set nColType[5]=1
.head 6 -  Set nColType[6]=2
.head 6 -  Set nColType[7]=1
.head 6 -  Set nColType[8]=1
.head 6 -  Set nColType[9]=1
.head 6 -  Set nColType[10]=1
.head 6 -  Set nColType[11]=2
.head 6 -  Set nColType[12]=2
.head 6 -  Set nColType[13]=2
.head 6 -  Set nColType[14]=2
.head 6 -  Set nColType[15]=1
.head 6 -  Set nColType[16]=1
.head 6 -  Set nColType[17]=2
.head 6 -  Set nColType[18]=2
.head 6 -  Set nColType[19]=1
.head 6 -  Set nColType[20]=2
.head 6 -  Set nColType[21]=1
.head 6 -  Set nColType[22]=1
.head 5 +  If SqlPrepareAndExecute(hSqlHandle,
"SELECT TT, NAME, DK, NLSM,
	KV, NLSK, KVK, NLSS,
	NLSA, NLSB, MFOB, FLC,
	FLI, FLV, FLR, S,
	S2, SK, PROC, S3800,
	S6201, S7201, RANG, FLAGS, NAZN
   INTO :strColValue[0],:strColValue[1],:nColValue[2],:strColValue[3],
	:nColValue[4],:strColValue[5],:nColValue[6],:strColValue[7],
	:strColValue[8],:strColValue[9],:strColValue[10],:nColValue[11],
	:nColValue[12],:nColValue[13],:nColValue[14],:strColValue[15],
	:strColValue[16],:nColValue[17],:nColValue[18],:strColValue[19],
	:nTmpS6201,:nTmpS7201,:nColValue[20],:strColValue[21],:strColValue[22]
   FROM TTS
  WHERE TT=:strTT ")
.head 6 +  If SqlFetchNext(hSqlHandle, nFetchRes)
.head 7 -  Set Result = Result ||
    SG_Insert(1, 'tts',
       strColName,
       nColType,
       strColValue,
       nColValue, "tt='" || strTT || "'")
.head 7 +  If bT00
.head 8 -  Set bTmpT00=FALSE
.head 8 -  ! Если в нашей БД счет для оплаты T00 [NLSM]
.head 8 +  If nColValue[4]
.head 9 -  Set nTmpKV = nColValue[4]
.head 8 +  Else
.head 9 -  Set nTmpKV = GetBaseVal()
.head 8 +  If SqlPrepareAndExecute(hSqlHandleAux,
"SELECT TIP INTO :strTmpTip FROM ACCOUNTS WHERE NLS=:strColValue[3] AND KV=:nTmpKV" )
.head 9 +  If SqlFetchNext(hSqlHandleAux, nFetchRes)
.head 10 +  If strTmpTip = 'T00'
.head 11 -  Set bTmpT00 = TRUE
.head 11 -  Set Result = Result || SG_UpdateToT00(strTT, 'NLSM')
.head 8 -  ! Проверка на несуществ. счета выполняется только если не T00
.head 8 +  If NOT bTmpT00 AND bErrors AND strColValue[3]
.head 9 -  Set Result = Result || SG_CheckAccount(strTT, 'А для оплаты', strColValue[3], nColValue[4])
.head 8 -  Set bTmpT00 = FALSE
.head 8 -  ! Если в нашей БД счет для оплаты T00 [NLSK]
.head 8 +  If nColValue[6]
.head 9 -  Set nTmpKV = nColValue[6]
.head 8 +  Else
.head 9 -  Set nTmpKV = GetBaseVal()
.head 8 +  If SqlPrepareAndExecute(hSqlHandleAux,
"SELECT TIP INTO :strTmpTip FROM ACCOUNTS WHERE NLS=:strColValue[5] AND KV=:nTmpKV")
.head 9 +  If SqlFetchNext(hSqlHandleAux, nFetchRes)
.head 10 +  If strTmpTip = 'T00'
.head 11 -  Set bTmpT00 = TRUE
.head 11 -  Set Result = Result || SG_UpdateToT00(strTT, 'NLSK')
.head 8 -  ! Проверка на несуществ. счета выполняется только если не T00
.head 8 +  If NOT bTmpT00 AND bErrors AND strColValue[5]
.head 9 -  Set Result=Result || SG_CheckAccount(strTT, 'Б для оплаты', strColValue[5], nColValue[6])
.head 7 +  Else If bErrors
.head 8 -  ! Всегда проверяем на несуществующие счета
.head 8 +  If strColValue[3]
.head 9 -  Set Result=Result || SG_CheckAccount(strTT, 'А для оплаты', strColValue[3], nColValue[4])
.head 8 +  If strColValue[5]
.head 9 -  Set Result=Result || SG_CheckAccount(strTT, 'Б для оплаты', strColValue[5], nColValue[6])
.head 7 +  If bErrors
.head 8 +  If strColValue[8]
.head 9 -  Set Result=Result || SG_CheckAccount(strTT, 'А для ввода', strColValue[8], nColValue[4])
.head 8 +  If strColValue[9]
.head 9 -  Set Result=Result || SG_CheckAccount(strTT, 'Б для ввода', strColValue[9], nColValue[6])
.head 8 +  If strColValue[19]
.head 9 -  Set Result=Result || SG_CheckAccount(strTT, 'валютной позиции', strColValue[19], 0)
.head 8 +  If nColValue[13]=1
.head 9 -  Set Result = Result ||
"dbms_output.put_line('Не забудьте указать ваши маржинальные счета доходов и расходов для операции: " || strTT || " ');
"
.head 5 +  If Result
.head 6 -  Return Header || Result
.head 5 +  Else
.head 6 -  Return Result
.head 3 +  Function: SG_CheckAccount
.head 4 -  Description: Генерация кода для проверки существования счета
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Код операции
.head 5 -  String: strTT
.head 5 -  ! Тип счета в род. падеже
.head 5 -  String: strNLS_NAME
.head 5 -  ! № Счета
.head 5 -  String: strNLS
.head 5 -  ! Код валюты
.head 5 -  Number: nKV
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  ! Если счет вычисляется по формуле, не проверяем
.head 5 +  If SalStrScan(strNLS, '#') != -1
.head 6 -  Return ""
.head 5 +  If SalStrScan(strNLS, '?') != -1
.head 6 -  Return ""
.head 5 +  If nKV
.head 6 -  Return 
"begin
  select acc into cnt_ from accounts where nls='"||strNLS||"' and kv=" || SalNumberToStrX( nKV, 0 )|| ";
exception when no_data_found then
  dbms_output.put_line('Счет " || strNLS_NAME || " "|| strNLS || "(" || SalNumberToStrX( nKV, 0 ) || ") заданый в операции " || strTT || " не существует!');
end;
"
.head 5 +  Else
.head 6 -  Return 
"select count(*) into cnt_ from accounts where nls='" || strNLS || "';
if cnt_=0 then



  dbms_output.put_line('Счет " || strNLS_NAME || " "|| strNLS || " заданый в операции " || strTT || " не существует!');
end if;
"
.head 3 +  Function: SG_UpdateToT00
.head 4 -  Description: Генерация кода для обновления счета T00
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Операция
.head 5 -  String: strTT
.head 5 -  ! Поле
.head 5 -  String: strFLD
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return SG_WrapCommandExcept(
"UPDATE TTS
  SET "|| strFLD ||"=(SELECT MAX(NLS) FROM ACCOUNTS WHERE TIP='T00')
  WHERE tt='" || strTT || "';",
'','',0)
.head 3 +  ! Function: SG_ExportFlags
.head 4 -  Description: Экспорт флагов
.head 4 +  Returns 
.head 5 -  String: 
.head 4 +  Parameters 
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandle
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandleAux
.head 5 -  ! Код операции
.head 5 -  String: strTT
.head 4 -  Static Variables 
.head 4 +  Local variables 
.head 5 -  String: Result
.head 5 -  String: Header
.head 5 -  !
.head 5 -  String: strColName[*]
.head 5 -  Number: nColType[*]
.head 5 -  String: strColValue[*]
.head 5 -  Number: nColValue[*]
.head 5 -  !
.head 4 +  Actions 
.head 5 -  ! (MIK)   Флаги теперь не экспортим они идут в поле FLAGS(TTS)
.head 5 -  Return ''
.head 5 -  !
.head 5 -  Set Header =
"--------------------------------
------------ ФЛАГИ -------------
--------------------------------
"
.head 5 -  Set Result=''
.head 5 -  Call SalArraySetUpperBound( strColName, 1, 10 )
.head 5 -  Call SalArraySetUpperBound( nColType, 1, 10 )
.head 5 -  Call SalArraySetUpperBound( strColValue, 1, 10 )
.head 5 -  Call SalArraySetUpperBound( nColValue, 1, 10 )
.head 5 -  ! Метаописание TTS_FLAGS
.head 5 +  If TRUE
.head 6 -  ! TT, FCODE, VALUE
.head 6 -  Set strColName[0]='TT'
.head 6 -  Set strColName[1]='FCODE'
.head 6 -  Set strColName[2]='VALUE'
.head 6 -  Set nColType[0]=1
.head 6 -  Set nColType[1]=2
.head 6 -  Set nColType[2]=1
.head 5 +  If SqlPrepareAndExecute( hSqlHandle,
"SELECT TT, FCODE, VALUE
INTO
	:strColValue[0],:nColValue[1],:strColValue[2]
FROM TTS_FLAGS
WHERE TT=:strTT " )
.head 6 +  While SqlFetchNext( hSqlHandle, nFetchRes )
.head 7 -  Set Result=Result ||
SG_UpdateOrInsert(2, 'TTS_FLAGS',
		strColName,
		nColType,
		strColValue,
		nColValue,
		" TT='" || strTT || "' AND FCODE=" ||
		SalNumberToStrX( nColValue[1], 0 ) )
.head 5 +  If Result
.head 6 -  Return Header || Result
.head 5 +  Else 
.head 6 -  Return Result
.head 3 +  Function: SG_ExportAuxs
.head 4 -  Description: Экспорт доп. реквизитов
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandle
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandleAux
.head 5 -  ! Код операции
.head 5 -  String: strTT
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: Result
.head 5 -  String: Header
.head 5 -  !
.head 5 -  String: strColName[*]
.head 5 -  Number: nColType[*]
.head 5 -  String: strColValue[*]
.head 5 -  Number: nColValue[*]
.head 5 -  !
.head 4 +  Actions
.head 5 -  Set Header = 
"--------------------------------
---------- Реквизиты -----------
--------------------------------
"
.head 5 -  Set Result = ''
.head 5 -  Call SalArraySetUpperBound(strColName, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColType, 1, 10)
.head 5 -  Call SalArraySetUpperBound(strColValue, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColValue, 1, 10)
.head 5 -  ! Метаописание OP_FIELD
.head 5 +  If nFlIns & 8
.head 6 +  If TRUE
.head 7 -  ! TAG, NAME, FMT, BROWSER, NOMODIFY, VSPO_CHAR, CHKR
.head 7 -  Set strColName[0]='tag'
.head 7 -  Set strColName[1]='name'
.head 7 -  Set strColName[2]='fmt'
.head 7 -  Set strColName[3]='browser'
.head 7 -  Set strColName[4]='nomodify'
.head 7 -  Set strColName[5]='vspo_char'
.head 7 -  Set strColName[6]='chkr'
.head 7 -  Set strColName[7]=''
.head 7 -  Set nColType[0]=1
.head 7 -  Set nColType[1]=1
.head 7 -  Set nColType[2]=1
.head 7 -  Set nColType[3]=1
.head 7 -  Set nColType[4]=2
.head 7 -  Set nColType[5]=1
.head 7 -  Set nColType[6]=1
.head 6 +  If SqlPrepareAndExecute(hSqlHandle,
"SELECT A.TAG, A.NAME, A.FMT, A.BROWSER,
	A.NOMODIFY, A.VSPO_CHAR, A.CHKR
 INTO   :strColValue[0],:strColValue[1],:strColValue[2],:strColValue[3],
	:nColValue[4],:strColValue[5],:strColValue[6]
 FROM OP_FIELD A, OP_RULES B
 WHERE A.TAG=B.TAG AND B.TT=:strTT ")
.head 7 +  While SqlFetchNext(hSqlHandle, nFetchRes)
.head 8 -  Set Result = Result ||
    SG_Insert(0, 'op_field',
       strColName,
       nColType,
       strColValue,
       nColValue, '')
.head 5 -  ! Метаописание OP_RULES
.head 5 +  If TRUE
.head 6 -  ! TAG, TT, OPT, USED4INPUT, ORD, VAL, NOMODIFY
.head 6 -  Set strColName[0]='TAG'
.head 6 -  Set strColName[1]='TT'
.head 6 -  Set strColName[2]='OPT'
.head 6 -  Set strColName[3]='USED4INPUT'
.head 6 -  Set strColName[4]='ORD'
.head 6 -  Set strColName[5]='VAL'
.head 6 -  Set strColName[6]='NOMODIFY'
.head 6 -  Set strColName[7]=''
.head 6 -  Set nColType[0]=1
.head 6 -  Set nColType[1]=1
.head 6 -  Set nColType[2]=1
.head 6 -  Set nColType[3]=2
.head 6 -  Set nColType[4]=2
.head 6 -  Set nColType[5]=1
.head 6 -  Set nColType[6]=2
.head 5 +  If SqlPrepareAndExecute(hSqlHandle,
"SELECT TAG, TT, OPT,
	USED4INPUT, ORD, VAL, NOMODIFY
 INTO	:strColValue[0],:strColValue[1],:strColValue[2],
	:nColValue[3],:nColValue[4],:strColValue[5],:nColValue[6]
 FROM OP_RULES
 WHERE TT=:strTT ")
.head 6 +  While SqlFetchNext(hSqlHandle, nFetchRes)
.head 7 -  Set Result = Result ||
    SG_Insert(2, 'op_rules',
       strColName,
       nColType,
       strColValue,
       nColValue, '')
.head 5 -  Return Header || 
"delete from op_rules where tt='" || strTT || "';" || PutCrLf() || Result
.head 3 +  Function: SG_ExportCmpxs
.head 4 -  Description: Экспорт связей между операциями
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandle
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandleAux
.head 5 -  ! Код операции
.head 5 -  String: strTT
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: Result
.head 5 -  String: Header
.head 5 -  !
.head 5 -  String: strColName[*]
.head 5 -  Number: nColType[*]
.head 5 -  String: strColValue[*]
.head 5 -  Number: nColValue[*]
.head 5 -  !
.head 4 +  Actions
.head 5 -  Set Header = 
"--------------------------------
------ Связанные операции ------
--------------------------------
"
.head 5 -  Set Result = ''
.head 5 -  Call SalArraySetUpperBound(strColName, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColType, 1, 10)
.head 5 -  Call SalArraySetUpperBound(strColValue, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColValue, 1, 10)
.head 5 -  ! Метаописание TTSAP
.head 5 +  If TRUE
.head 6 -  ! TTAP, TT, DK
.head 6 -  Set strColName[0]='ttap'
.head 6 -  Set strColName[1]='tt'
.head 6 -  Set strColName[2]='dk'
.head 6 -  Set nColType[0]=1
.head 6 -  Set nColType[1]=1
.head 6 -  Set nColType[2]=2
.head 5 +  If SqlPrepareAndExecute(hSqlHandle,
"SELECT TTAP, TT, DK
 INTO	:strColValue[0],:strColValue[1],:nColValue[2]
 FROM TTSAP
 WHERE TT=:strTT " )
.head 6 +  While SqlFetchNext(hSqlHandle, nFetchRes)
.head 7 -  Set Result=Result ||
    SG_Insert(2, 'ttsap',
       strColName,
       nColType,
       strColValue,
       nColValue, '')
.head 5 -  Return Header || 
"delete from ttsap where tt='" || strTT || "';" || PutCrLf() || Result
.head 3 +  Function: SG_ExportBals
.head 4 -  Description: Экспорт бал. счетов
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandle
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandleAux
.head 5 -  ! Код операции
.head 5 -  String: strTT
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: Result
.head 5 -  String: Header
.head 5 -  !
.head 5 -  String: strColName[*]
.head 5 -  Number: nColType[*]
.head 5 -  String: strColValue[*]
.head 5 -  Number: nColValue[*]
.head 5 -  !
.head 4 +  Actions
.head 5 -  Set Header = 
"--------------------------------
------- Балансовые счета -------
--------------------------------
"
.head 5 -  Set Result = ''
.head 5 -  Call SalArraySetUpperBound(strColName, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColType, 1, 10)
.head 5 -  Call SalArraySetUpperBound(strColValue, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColValue, 1, 10)
.head 5 -  ! Метаописание PS_TTS
.head 5 +  If TRUE
.head 6 -  ! NBS, TT, DK
.head 6 -  Set strColName[0]='nbs'
.head 6 -  Set strColName[1]='tt'
.head 6 -  Set strColName[2]='dk'
.head 6 -  Set nColType[0]=1
.head 6 -  Set nColType[1]=1
.head 6 -  Set nColType[2]=2
.head 6 +  If bOB22
.head 7 -  Set strColName[3]='ob22'
.head 7 -  Set nColType[3]=1
.head 5 +  If SqlPrepareAndExecute(hSqlHandle,
"SELECT NBS, TT, DK " || IifS(bOB22=TRUE, ", OB22", "") || "
 INTO	:strColValue[0],:strColValue[1],:nColValue[2] " || IifS(bOB22=TRUE, ", :strColValue[3]", "") || "
 FROM PS_TTS
 WHERE TT=:strTT ")
.head 6 +  While SqlFetchNext(hSqlHandle, nFetchRes)
.head 7 -  Set Result = Result ||
    SG_Insert(2, 'ps_tts',
       strColName,
       nColType,
       strColValue,
       nColValue, '')
.head 5 -  Return Header || 
"delete from ps_tts where tt='" || strTT || "';" || PutCrLf() || Result
.head 3 +  Function: SG_ExportVobs
.head 4 -  Description: Экспорт Видов док-тов
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandle
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandleAux
.head 5 -  ! Код операции
.head 5 -  String: strTT
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: Result
.head 5 -  String: Header
.head 5 -  !
.head 5 -  String: strColName[*]
.head 5 -  Number: nColType[*]
.head 5 -  String: strColValue[*]
.head 5 -  Number: nColValue[*]
.head 5 -  !
.head 4 +  Actions
.head 5 -  Set Header = 
"--------------------------------
------- Виды документов --------
--------------------------------
"
.head 5 -  Set Result = ''
.head 5 -  Call SalArraySetUpperBound(strColName, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColType, 1, 10)
.head 5 -  Call SalArraySetUpperBound(strColValue, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColValue, 1, 10)
.head 5 -  ! Метаописание VOB
.head 5 +  If nFlIns & 128
.head 6 +  If TRUE
.head 7 -  ! VOB, NAME, FLV, REP_PREFIX
.head 7 -  Set strColName[0]='VOB'
.head 7 -  Set strColName[1]='NAME'
.head 7 -  Set strColName[2]='FLV'
.head 7 -  Set strColName[3]='REP_PREFIX'
.head 7 -  Set strColName[4]=''
.head 7 -  Set nColType[0]=2
.head 7 -  Set nColType[1]=1
.head 7 -  Set nColType[2]=2
.head 7 -  Set nColType[3]=1
.head 6 +  If SqlPrepareAndExecute(hSqlHandle,
"SELECT A.VOB, A.NAME, A.FLV, A.REP_PREFIX
 INTO	:nColValue[0],:strColValue[1],:nColValue[2],:strColValue[3]
 FROM VOB A, TTS_VOB B
 WHERE A.VOB=B.VOB AND B.TT=:strTT ")
.head 7 +  While SqlFetchNext(hSqlHandle, nFetchRes)
.head 8 -  Set Result = Result ||
    SG_Insert(0, 'vob',
       strColName,
       nColType,
       strColValue,
       nColValue, '')
.head 5 -  ! Метаописание TTS_VOB
.head 5 +  If TRUE
.head 6 -  ! VOB, TT
.head 6 -  Set strColName[0]='vob'
.head 6 -  Set strColName[1]='tt'
.head 6 -  Set strColName[2]=''
.head 6 -  Set nColType[0]=2
.head 6 -  Set nColType[1]=1
.head 5 +  If SqlPrepareAndExecute(hSqlHandle,
"SELECT VOB, TT
 INTO	:nColValue[0],:strColValue[1]
 FROM TTS_VOB
 WHERE TT=:strTT ")
.head 6 +  While SqlFetchNext(hSqlHandle, nFetchRes)
.head 7 -  Set Result=Result ||
    SG_Insert(2, 'tts_vob',
       strColName,
       nColType,
       strColValue,
       nColValue, '')
.head 5 -  Return Header || 
"delete from tts_vob where tt='" || strTT || "';" || PutCrLf() || Result
.head 3 +  Function: SG_ExportChks
.head 4 -  Description: Экспорт групп визирования
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandle
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandleAux
.head 5 -  ! Код операции
.head 5 -  String: strTT
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: Result
.head 5 -  String: Header
.head 5 -  !
.head 5 -  String: strColName[*]
.head 5 -  Number: nColType[*]
.head 5 -  String: strColValue[*]
.head 5 -  Number: nColValue[*]
.head 5 -  Long String: lsValue
.head 5 -  !
.head 4 +  Actions
.head 5 -  Set Header = 
"--------------------------------
-------- Группы контроля -------
--------------------------------
"
.head 5 -  Set Result = ''
.head 5 -  Call SalArraySetUpperBound(strColName, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColType, 1, 10)
.head 5 -  Call SalArraySetUpperBound(strColValue, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColValue, 1, 10)
.head 5 -  ! Метаописание CHKLIST
.head 5 +  If nFlIns & 64
.head 6 +  If TRUE
.head 7 -  ! IDCHK, NAME, COMM
.head 7 -  Set strColName[0]='idchk'
.head 7 -  Set strColName[1]='name'
.head 7 -  Set strColName[2]='comm'
.head 7 -  Set strColName[3]=''
.head 7 -  Set nColType[0]=2
.head 7 -  Set nColType[1]=1
.head 7 -  Set nColType[2]=1
.head 6 +  If SqlPrepareAndExecute(hSqlHandle,
"SELECT A.IDCHK, A.NAME, A.COMM
 INTO	:nColValue[0],:strColValue[1],:strColValue[2]
 FROM CHKLIST A, CHKLIST_TTS B
 WHERE A.IDCHK=B.IDCHK AND B.TT=:strTT ")
.head 7 +  While SqlFetchNext(hSqlHandle, nFetchRes)
.head 8 -  Set Result = Result ||
    SG_Insert(0, 'chklist',
       strColName,
       nColType,
       strColValue,
       nColValue, '')
.head 5 -  ! Метаописание CHKLIST_TTS
.head 5 +  If TRUE
.head 6 -  ! IDCHK, TT, PRIORITY, F_BIG_AMOUNT
.head 6 -  Set strColName[0]='idchk'
.head 6 -  Set strColName[1]='tt'
.head 6 -  Set strColName[2]='priority'
.head 6 -  Set strColName[3]='f_big_amount'
.head 6 -  Set strColName[4]='sqlval'
.head 6 -  Set strColName[5]='f_in_charge'
.head 6 -  Set strColName[6]=''
.head 6 -  Set nColType[0]=2
.head 6 -  Set nColType[1]=1
.head 6 -  Set nColType[2]=2
.head 6 -  Set nColType[3]=2
.head 6 -  Set nColType[4]=1
.head 6 -  Set nColType[5]=2
.head 5 -  Call SqlSetLongBindDatatype(5, 22)
.head 5 +  If SqlPrepareAndExecute(hSqlHandle,
"SELECT IDCHK, TT, PRIORITY, F_BIG_AMOUNT, sqlval, f_in_charge
 INTO	:nColValue[0],:strColValue[1],:nColValue[2],:nColValue[3],:lsValue,:nColValue[5]
 FROM CHKLIST_TTS
 WHERE TT=:strTT ")
.head 6 +  While SqlFetchNext(hSqlHandle, nFetchRes)
.head 7 -  Set strColValue[4] = lsValue
.head 7 -  Set Result = Result ||
    SG_Insert(2, 'chklist_tts',
       strColName,
       nColType,
       strColValue,
       nColValue, '')
.head 5 -  Return Header || 
"delete from chklist_tts where tt='" || strTT || "';" || PutCrLf() || Result
.head 3 +  Function: SG_ExportFlds
.head 4 -  Description: Экспорт папок
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandle
.head 5 -  ! Чем экспортить
.head 5 -  Sql Handle: hSqlHandleAux
.head 5 -  ! Код операции
.head 5 -  String: strTT
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: Result
.head 5 -  String: Header
.head 5 -  !
.head 5 -  String: strColName[*]
.head 5 -  Number: nColType[*]
.head 5 -  String: strColValue[*]
.head 5 -  Number: nColValue[*]
.head 5 -  !
.head 4 +  Actions
.head 5 -  Set Header = 
"--------------------------------
------------ Папки -------------
--------------------------------
"
.head 5 -  Set Result = ''
.head 5 -  Call SalArraySetUpperBound(strColName, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColType, 1, 10)
.head 5 -  Call SalArraySetUpperBound(strColValue, 1, 10)
.head 5 -  Call SalArraySetUpperBound(nColValue, 1, 10)
.head 5 -  ! Метаописание FOLDERS
.head 5 +  If nFlIns & 256
.head 6 +  If TRUE
.head 7 -  ! IDFO, NAME
.head 7 -  Set strColName[0]='IDFO'
.head 7 -  Set strColName[1]='NAME'
.head 7 -  Set strColName[2]=''
.head 7 -  Set nColType[0]=2
.head 7 -  Set nColType[1]=1
.head 6 +  If SqlPrepareAndExecute(hSqlHandle,
"SELECT A.IDFO, A.NAME
 INTO	:nColValue[0],:strColValue[1]
 FROM FOLDERS A, FOLDERS_TTS B
 WHERE A.IDFO=B.IDFO AND B.TT=:strTT ")
.head 7 +  While SqlFetchNext(hSqlHandle, nFetchRes)
.head 8 -  Set Result = Result ||
    SG_Insert(0, 'folders',
       strColName,
       nColType,
       strColValue,
       nColValue, '')
.head 5 -  ! Метаописание FOLDERS_TTS
.head 5 +  If TRUE
.head 6 -  ! IDFO, TT
.head 6 -  Set strColName[0]='idfo'
.head 6 -  Set strColName[1]='tt'
.head 6 -  Set strColName[2]=''
.head 6 -  Set nColType[0]=2
.head 6 -  Set nColType[1]=1
.head 5 +  If SqlPrepareAndExecute(hSqlHandle,
"SELECT IDFO, TT
 INTO	:nColValue[0],:strColValue[1]
 FROM FOLDERS_TTS
 WHERE TT=:strTT ")
.head 6 +  While SqlFetchNext(hSqlHandle, nFetchRes)
.head 7 -  Set Result = Result ||
    SG_Insert(2, 'folders_tts',
       strColName,
       nColType,
       strColValue,
       nColValue, '')
.head 5 -  Return Header || 
"delete from folders_tts where tt='" || strTT || "';" || PutCrLf() || Result
.head 3 +  Function: DumpOperationsToFile
.head 4 -  Description: Выгрузка всех показанных операций в текстовый файл
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  !
.head 5 -  : cForSelect
.head 6 -  Class: cABSConnect
.head 5 -  : cSelect
.head 6 -  Class: cGenQuery
.head 5 -  String: strSelect
.head 5 -  Number: nFetchRes
.head 5 -  String: strCurTT
.head 5 -  String: sEOL
.head 5 -  !
.head 5 -  File Handle: hFile
.head 5 -  String: sFileName
.head 4 +  Actions
.head 5 -  Set sEOL = SalNumberToChar(13) || SalNumberToChar(10)
.head 5 -  Call WaitCursorOn()
.head 5 -  ! Делаем соед.
.head 5 -  Call XConnectGetParams(cForSelect)
.head 5 +  If cForSelect.Connect()
.head 6 -  ! Получаем SQL через фильтр
.head 6 -  Call cSelect.Init('SELECT tt INTO :strCurTT FROM tts')
.head 6 -  Set strSelect = cSelect.GetFullSQLString(tbl.cF)
.head 6 -  ! Выполняем SQL
.head 6 +  If SqlPrepareAndExecute(cForSelect.hSql(), strSelect)
.head 7 -  ! Откр. файл
.head 7 -  Set sFileName = GetPrnDir() || "\\TTS" || SalNumberToStrX(SalDateHour(Date()), 0) || SalNumberToStrX(SalDateMinute(Date()), 0) || '.txt'
.head 7 +  If VisFileOpen(hFile, sFileName, OF_Create) = VTERR_Ok
.head 8 -  ! Выполняем выброс в файл
.head 8 +  Loop
.head 9 +  If SqlFetchNext(cForSelect.hSql(), nFetchRes) and (nFetchRes=FETCH_Ok)
.head 10 -  Call VisFileWriteString(hFile, SalStrRepeatX('-', 80) || sEOL)
.head 10 -  Call VisFileWriteString(hFile, hWndParent.frm_OperCard.OperationInfo(strCurTT))
.head 9 +  Else
.head 10 -  Break
.head 8 -  Call VisFileWriteString(hFile, SalStrRepeatX('-', 80) || sEOL)
.head 8 -  Call VisFileClose(hFile)
.head 8 -  ! Call DosDirectPrint( sFileName )
.head 8 -  ! Информация помещена в файл sFileName
.head 8 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_OperList.cTMsgInfToFile') || sEOL || sFileName,
     CurrentLangTable.GetAtomTitle('cTInfo'), MB_Ok | MB_IconAsterisk)
.head 6 -  Call cForSelect.Disconnect()
.head 5 -  Call WaitCursorOff()
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Window Handle: hWndParent
.head 3 -  String: strPassPar
.head 3 -  String: InParam[5]
.head 3 -  Window Handle: hWndObject
.head 3 -  !
.head 3 -  String: strSqlPopulate
.head 3 -  String: strSqlInsert
.head 3 -  String: strSqlDelete
.head 3 -  String: strSqlUpdate
.head 3 -  String: strFilterTblName ! Имя основной таблицы для фильтра
.head 3 -  String: strTitleAux
.head 3 -  ! !
.head 3 -  String: strPrintFileName ! Имя файла печати (без путей)
.head 3 -  Boolean: fFilterAtStart  ! Начинать население таблицы с фильтра
.head 3 -  Number: nTabInstance     ! Номер варианта таблицы длядинамической настройки
.head 3 -  : cGTLangTable
.head 4 -  Class: cAtomList
.head 3 -  String: sFuncName
.head 3 -  !
.head 3 -  Number: nFlIns
.head 3 -  !
.head 3 -  Boolean: bBranch
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call XConnectGetParams( tbl.cMain )
.head 4 +  If NOT tbl.cMain.Connect()
.head 5 -  Call SalWaitCursor( FALSE )
.head 5 -  Call SalEndDialog( hWndForm, 0 )
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 +  ! If Option = 9
.head 5 -   Call SalHideWindow( pbIns )
.head 5 -   Call SalHideWindow( pbDel )
.head 5 -   Call SalHideWindow( pbUpdate )
.head 5 -   Call SalHideWindow( pbToFile )
.head 5 -   Call SalHideWindow( pbExp )
.head 5 -   Call SalHideWindow( pbImp )
.head 5 -   Call SalHideWindow( pbExportSelected )
.head 5 -   Call SalTblSetColumnFlags ( colTT, COL_Editable, FALSE )
.head 5 -   Call SalTblSetColumnFlags ( colTT_NAME, COL_Editable, FALSE )
.head 4 -  Call SetWindowFont( hWndForm )
.head 4 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 4 -  Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('frm_OperList.cTWndTitle') )
.head 4 -  ! Set fSaved=TRUE
.head 4 -  Set strPrintFileName = 'opers.txt'
.head 4 -  Set bBranch = FieldInTable('BRANCH', 'TTS')
.head 4 +  If bBranch
.head 5 -  Call SalShowWindow(tbl.colTT_BRANCH)
.head 5 -  Set strSqlPopulate = '
    SELECT tts.tt,tts.name,count(ttsap.tt),tts.branch
    INTO   :hWndForm.colTT,:hWndForm.colTT_NAME,:hWndForm.colComplex,:hWndForm.colTT_BRANCH
    FROM   tts, ttsap
    WHERE  tts.tt=ttsap.tt(+)
    GROUP BY tts.tt,tts.name,tts.branch
    ORDER BY tt'
.head 4 +  Else
.head 5 -  Set strSqlPopulate = '
    SELECT tts.tt,tts.name,count(ttsap.tt)
    INTO   :hWndForm.colTT,:hWndForm.colTT_NAME,:hWndForm.colComplex
    FROM   tts, ttsap
    WHERE  tts.tt=ttsap.tt(+)
    GROUP BY tts.tt,tts.name
    ORDER BY tt'
.head 4 -  !
.head 4 -  ! Set strSqlPopulate = '
    SELECT tts.tt,tts.name,count(ttsap.tt)
    INTO   :hWndForm.colTT,:hWndForm.colTT_NAME,:hWndForm.colComplex
    FROM   tts, ttsap
    WHERE  tts.tt=ttsap.tt(+)
    GROUP BY tts.tt,tts.name
    ORDER BY tt'
.head 4 -  !
.head 4 -  Set strSqlInsert = 'INSERT INTO tts (tt,name,fli,dk) VALUES (:hWndForm.colTT,:hWndForm.colTT_NAME,0,1)'
.head 4 -  Set strSqlDelete = 'DELETE FROM tts WHERE tt=:hWndForm.colTT'
.head 4 -  Set strSqlUpdate = 'UPDATE tts SET name=:hWndForm.colTT_NAME WHERE tt=:hWndForm.colTT'
.head 4 -  Set strFilterTblName = 'tts'
.head 4 -  ! Set sFuncName = 'Конструктор операций'
.head 4 -  Set sFuncName = 'Конструктор операций'
.head 4 -  ! !
.head 4 +  If strFilterTblName != ''
.head 5 -  Call tbl.cF.Init( strFilterTblName, strFilterTblName )
.head 4 +  ! Else
.head 5 -   Call SalDisableWindow( pbFilter )
.head 4 -  ! !
.head 4 +  If strSqlPopulate != ''
.head 5 -  Call tbl.cQ.Init( strSqlPopulate )
.head 4 -  Call SalTblSetTableFlags( tbl, TBL_Flag_SelectableCols | TBL_Flag_SingleSelection, TRUE )
.head 4 -  Call SaveInfoToLog( CurrentLangTable.GetAtomTitle('frm_OperList.cTMsgToLogExecFunc') || ': ' || sFuncName )
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString( lParam )
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 2
.head 5 -  Return FALSE
.head 4 -  Set hWndParent  = SalNumberToWindowHandle(SalStrToNumber(InParam[0]))
.head 4 -  ! Set strOperId   = InParam[1]
.head 4 -  !
.head 4 -  Set hWndParent.frm_OperCard.hWndTab[0] = hWndForm
.head 4 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 3 +  On PAGEM_Activate
.head 4 +  If hWndParent
.head 5 -  Call SalSendMsg(tbl, SAM_User, 0, 0)
.head 3 +  On PAGEM_Apply
.head 4 -  Call SalSendMsg(tbl, UM_Update, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 4 -  Call WaitCursorOff()
.head 3 +  On UM_Insert
.head 4 -  Call SalSendMsg(tbl, UM_Insert, 0, 0)
.head 3 +  On UM_Delete
.head 4 -  Call SalSendMsg(tbl, UM_Delete, 0, 0)
.head 3 +  On UM_Choose
.head 4 -  Call SalSendMsg(tbl, UM_Choose, 0, 0)
.head 3 +  On UM_CreateDoc
.head 4 +  If lParam=1
.head 5 -  Call DumpOperationsToFile()
.head 4 +  If lParam=2
.head 5 -  Call DoExportSelected()
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX, nWinY, nWinW, nWinH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_OperTts.tbl,
     SalPixelsToFormUnits(hWndForm.Dlg_OperTts.tbl, nWinW, FALSE),
     SalPixelsToFormUnits(hWndForm.Dlg_OperTts.tbl, nWinH, TRUE))
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 3 +  On SAM_User
.head 4 -  Set tbl.colComplex = lParam
.head 1 +  Dialog Box: Dlg_OpCart      ! TAB#1
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Tab#1
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   1.71"
.head 4 -  Top:    0.8"
.head 4 -  Width:  12.1"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.135"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? No
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: None
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? No
.head 4 -  Size: 0.646"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Custom Control: ccSplitter0
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalHSplitter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name: XSal2_32.dll
.head 5 -  MS Windows Class Name: XSal:Splitter32
.head 5 -  Style:  0x00000000
.head 5 -  ExStyle:  0x00000000
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  4.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.31"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Etched Border? No
.head 5 -  Hollow? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Horizontal Scroll? No
.head 5 -  Tab Stop? None
.head 5 -  Tile To Parent? Yes
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Italic
.head 5 -  Text Color: Default
.head 5 -  Background Color: Dark Aqua
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Custom Control: ccSplitter1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalHSplitter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name: XSal2_32.dll
.head 5 -  MS Windows Class Name: XSal:Splitter32
.head 5 -  Style:  0x00000000
.head 5 -  ExStyle:  0x00000000
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  4.7"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.31"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Etched Border? No
.head 5 -  Hollow? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Horizontal Scroll? No
.head 5 -  Tab Stop? None
.head 5 -  Tile To Parent? Yes
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Italic
.head 5 -  Text Color: Default
.head 5 -  Background Color: Dark Aqua
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tbl1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   -0.014"
.head 6 -  Top:    0.74"
.head 6 -  Width:  12.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.083"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colNms
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Назначение  счета
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.614"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colNls
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Маска/Формула
 счета
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  4.471"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  Select Case lParam
.head 9 +  Case 0
.head 10 -  Set strAccA=colNls
.head 10 -  Break
.head 9 +  Case 1
.head 10 -  Set strAccB=colNls
.head 10 -  Break
.head 9 +  Case 2
.head 10 -  Set strBankA=colNls
.head 10 -  Break
.head 9 +  Case 3
.head 10 -  Set strBankB=colNls
.head 10 -  Break
.head 9 +  Case 4
.head 10 -  Set strAccVP=colNls
.head 10 -  Break
.head 9 +  Case 5
.head 10 +  If IfAccExists(colNls,nBaseCur,nAccInc)
.head 11 -  Break
.head 10 -  Return VALIDATE_Cancel
.head 9 +  Case 6
.head 10 +  If IfAccExists(colNls,nBaseCur,nAccExp)
.head 11 -  Break
.head 10 -  Return VALIDATE_Cancel
.head 8 -  Return VALIDATE_Ok
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  Column: colKv
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
Валюты
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Center
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  Select Case lParam
.head 9 +  Case 0
.head 10 -  Set strKvA=colKv
.head 10 -  Break
.head 9 +  Case 1
.head 10 -  Set strKvB=colKv
.head 10 -  Break
.head 9 +  Default
.head 10 -  Set colKv='x'
.head 8 -  Return VALIDATE_Ok
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  Column: colMfo
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
Банка
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  Select Case lParam
.head 9 +  Case 3
.head 10 -  Set strMfoB=colMfo
.head 10 -  Break
.head 9 +  Default
.head 10 -  Set colMfo='x'
.head 8 -  Return VALIDATE_Ok
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  Column: colSk
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Симв.
КП
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Center
.head 6 -  Width:  0.657"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  Select Case lParam
.head 9 +  Case 1
.head 10 -  Set strSk=colSk
.head 10 -  Break
.head 9 +  Default
.head 10 -  Set colSk='x'
.head 8 -  Return VALIDATE_Ok
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.frm_OperCard.Modified( )
.head 4 +  Functions
.head 5 +  Function: AddRow
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sNms
.head 7 -  String: sNls
.head 7 -  String: sKv
.head 7 -  String: sMfo
.head 7 -  String: sSk
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalTblSetRowFlags ( hWndForm, SalTblInsertRow( hWndForm, TBL_MaxRow ), ROW_New, FALSE )
.head 7 -  Set colNms=sNms
.head 7 -  Set colNls=sNls
.head 7 -  Set colKv =sKv
.head 7 -  Set colMfo=sMfo
.head 7 -  Set colSk =sSk
.head 5 +  Function: IfAccExists
.head 6 -  Description: Check to see if input account in GL
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 +  Parameters
.head 7 -  String: sNls
.head 7 -  Number: nKv
.head 7 -  Receive Number: nAcc
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If SqlPrepareAndExecute(hSql(),"SELECT acc INTO :nAcc FROM accounts WHERE kv=:nKv AND nls=:sNls" )
and not SqlFetchNext(hSql(), nFetchRes)
.head 8 -  Call SalMessageBox('Счет '||sNls||'/'||Str(nKv)||' не найден.', 'Внимание!', MB_IconHand)
.head 8 -  Return FALSE
.head 7 -  Return TRUE
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 5 +  On UM_Populate
.head 6 -  Call SalTblReset(hWndForm)
.head 6 -  ! Счет А/для ОПЛАТЫ
.head 6 -  Call AddRow(CurrentLangTable.GetAtomTitle('Dlg_OpCart.tbl1.cTAccA'), strAccA, strKvA, 'х', 'х')
.head 6 -  ! Счет Б/для ОПЛАТЫ
.head 6 -  Call AddRow(CurrentLangTable.GetAtomTitle('Dlg_OpCart.tbl1.cTAccB'), strAccB, strKvB, 'х', strSk)
.head 6 -  ! Счет банка А/для ВВОДА
.head 6 -  Call AddRow(CurrentLangTable.GetAtomTitle('Dlg_OpCart.tbl1.cTBankA'), strBankA, 'x', 'х', 'х')
.head 6 -  ! Счет банка Б/для ВВОДА
.head 6 -  Call AddRow(CurrentLangTable.GetAtomTitle('Dlg_OpCart.tbl1.cTBankB'), strBankB, 'x', strMfoB, 'х')
.head 6 -  ! Счет валютной позиции
.head 6 -  Call AddRow(CurrentLangTable.GetAtomTitle('Dlg_OpCart.tbl1.cTAccVP'), strAccVP, 'x', 'х', 'х')
.head 6 -  ! Счет маржинальных доходов
.head 6 -  Call AddRow(CurrentLangTable.GetAtomTitle('Dlg_OpCart.tbl1.cTAccInc'), strAccInc, 'x', 'х', 'х')
.head 6 -  ! Счет маржинальных расходов
.head 6 -  Call AddRow(CurrentLangTable.GetAtomTitle('Dlg_OpCart.tbl1.cTAccExp'), strAccExp, 'x', 'х', 'х')
.head 3 +  Child Table: tbl2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   -0.014"
.head 6 -  Top:    2.906"
.head 6 -  Width:  12.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colNam
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Параметр
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  3.629"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFormula
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значение
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  7.443"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 +  Select Case lParam
.head 9 +  Case 0
.head 10 -  Set strSum=colFormula
.head 10 -  Break
.head 9 +  Case 1
.head 10 -  Set strSum2=colFormula
.head 10 -  Break
.head 9 +  Case 2
.head 10 -  Set strNazn=colFormula
.head 10 -  Break
.head 9 +  Case 3
.head 10 -  Set strPriority=colFormula
.head 10 -  Break
.head 9 +  Default
.head 10 -  Set colFormula='x'
.head 8 -  Return VALIDATE_Ok
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.frm_OperCard.Modified( )
.head 4 +  Functions
.head 5 +  Function: AddRow
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  String: sNam
.head 7 -  String: sFormula
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 -  Call SalTblSetRowFlags ( hWndForm, SalTblInsertRow( hWndForm, TBL_MaxRow ), ROW_New, FALSE )
.head 7 -  Set colNam    =sNam
.head 7 -  Set colFormula=sFormula
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 5 +  On UM_Populate
.head 6 -  Call SalTblReset(hWndForm)
.head 6 -  ! Формула суммы-А документа
.head 6 -  Call AddRow(CurrentLangTable.GetAtomTitle('Dlg_OpCart.tbl2.cTSum'), strSum)
.head 6 -  ! Формула суммы-Б документа
.head 6 -  Call AddRow(CurrentLangTable.GetAtomTitle('Dlg_OpCart.tbl2.cTSum2'), strSum2)
.head 6 -  ! Назначение платежа по-умолчанию
.head 6 -  Call AddRow(CurrentLangTable.GetAtomTitle('Dlg_OpCart.tbl2.cTNazn'), strNazn)
.head 6 -  ! Приоритет транзакции
.head 6 -  Call AddRow(CurrentLangTable.GetAtomTitle('Dlg_OpCart.tbl2.cTPriority'), strPriority)
.head 2 +  Functions
.head 3 +  Function: Modified
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return hWndParent.frm_OperCard.Modified( )
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Window Handle: hWndParent
.head 3 -  String: strPassPar
.head 3 -  String: InParam[5]
.head 3 -  String: strOperId
.head 3 -  Window Handle: hWndObject
.head 3 -  !
.head 3 -  String: strSql
.head 3 -  Number: nDk
.head 3 -  Number: nFli
.head 3 -  Number: nMulti
.head 3 -  Number: nComplex
.head 3 -  Number: nBaseCur
.head 3 -  Number: nChild
.head 3 -  !
.head 3 -  String: strKvA
.head 3 -  String: strKvB
.head 3 -  String: strAccA
.head 3 -  String: strAccB
.head 3 -  String: strBankA
.head 3 -  String: strBankB
.head 3 -  String: strMfoB
.head 3 -  String: strAccVP
.head 3 -  String: strAccInc
.head 3 -  String: strAccExp
.head 3 -  String: strSk
.head 3 -  !
.head 3 -  String: strSum
.head 3 -  String: strSum2
.head 3 -  String: strNazn
.head 3 -  String: strPriority
.head 3 -  Number: nAccInc
.head 3 -  Number: nAccExp
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString( lParam )
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 2
.head 5 -  Return FALSE
.head 4 -  !
.head 4 -  Set hWndParent  = SalNumberToWindowHandle(SalStrToNumber(InParam[0]))
.head 4 -  Set hWndParent.frm_OperCard.hWndTab[1] = hWndForm
.head 3 +  On PAGEM_Activate
.head 4 +  If strOperId != hWndParent.frm_OperCard.TT
.head 5 -  Set strOperId=hWndParent.frm_OperCard.TT
.head 5 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 3 +  On PAGEM_Apply
.head 4 -  Set nComplex = frmInset.cbComplex
.head 4 -  Set nMulti   = frmInset.cbMulti
.head 4 -  Call SqlPrepareAndExecute( hSql(),
"UPDATE tts
    SET dk=:nDk,kv=:strKvA,kvk=:strKvB,nlsm=:strAccA,nlsk=:strAccB,
        flc=:nComplex,fli=:nFli,flv=:nMulti,
        nlsa=:strBankA,nlsb=:strBankB ,mfob=:strMfoB,s=:strSum ,s2=:strSum2,
        s3800=:strAccVP,s6201=:nAccInc,s7201=:nAccExp,
        sk=:strSk,rang=:strPriority,nazn=:strNazn
  WHERE tt=:strOperId")
.head 4 -  Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 3 +  On UM_Populate
.head 4 -  ! Свойств видов операции
.head 4 -  Call SqlPrepareAndExecute( hSql(),
"SELECT a.dk   , a.kv , a.kvk , a.nlsm, a.nlsk, a.flc,
        a.fli  , a.flv, a.nlsb, a.mfob, a.s   , a.s2  , a.sk ,
        a.s3800, b.nls, c.nls , a.rang, a.nlsa, a.nazn, a.s6201, a.s7201
 INTO :nDk, :strKvA, :strKvB   ,:strAccA,  :strAccB,  :nComplex,
      :nFli,:nMulti, :strBankB ,:strMfoB  ,:strSum ,  :strSum2,   :strSk,
      :strAccVP     ,:strAccInc,:strAccExp,:strPriority,:strBankA,:strNazn,
      :nAccInc,:nAccExp
 FROM tts a,  accounts b,  accounts c
WHERE a.s6201=b.acc (+) AND a.s7201=c.acc (+) AND a.tt=:strOperId")
.head 4 +  If SqlFetchNext( hSql(), nFetchRes )
.head 5 -  Set strBankA = VisStrTrim(strBankA)
.head 5 -  Set strBankB = VisStrTrim(strBankB)
.head 5 -  ! Проверка сложности
.head 5 -  Set nChild=0
.head 5 -  Set strSql='SELECT COUNT(*) INTO :nChild FROM ttsap WHERE tt=:strOperId'
.head 5 -  Call SqlPrepareAndExecute( hSql(), strSql )
.head 5 -  Call SqlFetchNext( hSql(), nFetchRes )
.head 5 -  ! Скрыть-Показать Закладку связанных ОП
.head 5 -  Call SalSendMsg( hWndForm, SAM_User, 0, nChild )
.head 5 -  ! Базовая валюта
.head 5 -  Set nBaseCur=GetBaseVal()
.head 5 -  ! Флаг доп. реквизитов
.head 5 +  ! If SqlPrepareAndExecute( hSql(), 'SELECT Value INTO :nTmp FROM tts_flags WHERE tt=:strOperId and fcode=35' )
.head 6 -   Call SqlFetchNext( hMainSql, nFetchRes )
.head 6 -   Call SqlClose( hMainSql )
.head 6 -   Set fAddRec= ( (nFetchRes=FETCH_Ok) AND (nTmp=1) )
.head 5 +  ! If fAddRec
.head 6 -   Call SalEnableWindow( tblOpRules )
.head 5 +  ! Else
.head 6 -   Call SalDisableWindow( tblOpRules )
.head 5 -  ! Call dlg_OperCard.TabActivateStart( hWndForm, 7 )
.head 5 -  Call SalWaitCursor ( FALSE )
.head 4 +  Else
.head 5 -  Set nDk  = 1
.head 5 -  Set strKvA = ''
.head 5 -  Set strKvB = ''
.head 5 -  Set strAccA = ''
.head 5 -  Set strAccB = ''
.head 5 -  Set nComplex = 0
.head 5 -  Set nFli = 0
.head 5 -  Set nMulti = 0
.head 5 -  Set strBankB = ''
.head 5 -  Set strMfoB = ''
.head 5 -  Set strSum = ''
.head 5 -  Set strSum2 = ''
.head 5 -  Set strSk = ''
.head 5 -  Set strAccVP = ''
.head 5 -  Set strAccInc = ''
.head 5 -  Set strAccExp = ''
.head 5 -  Set strPriority = ''
.head 5 -  Set strBankA = ''
.head 5 -  Set strNazn = ''
.head 4 -  Call SalSendMsg( tbl1, UM_Populate, 0, 0 )
.head 4 -  Call SalSendMsg( tbl2, UM_Populate, 0, 0 )
.head 4 -  Call SalSendMsg( hWndObject, UM_Populate, 0, 0 )
.head 4 +  ! If Option != 9
.head 5 -   Call LoadFromReg()
.head 4 +  ! Else
.head 5 -   Call picTabs.BringToTop( 6, TRUE )
.head 5 -   Call dlg_OperCard.TabActivateStart( hWndForm, 6 )
.head 3 +  On SAM_Create
.head 4 -  Call ccSplitter0.setStyle( XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE )
.head 4 -  Call ccSplitter0.setBarPosition( 65 )
.head 4 -  Call ccSplitter1.setBarPosition( 700 )
.head 4 -  !
.head 4 -  Call ccSplitter0.setTopFrame( SalCreateWindowEx( frmInset, hWndForm, 0,0,0,0, CREATE_AsChild ) )
.head 4 -  Call ccSplitter0.setBottomFrame( tbl1 )
.head 4 -  Call ccSplitter1.setTopFrame( ccSplitter0 )
.head 4 -  Call ccSplitter1.setBottomFrame( tbl2 )
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX, nWinY, nWinW, nWinH)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_OpCart.tbl1,nTmp,nWinH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_OpCart.tbl1,
     SalPixelsToFormUnits(hWndForm.Dlg_OpCart.tbl1, nWinW, FALSE),nWinH)
.head 4 -  Call SalGetWindowSize(hWndForm.Dlg_OpCart.tbl2,nTmp,nWinH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_OpCart.tbl2,
     SalPixelsToFormUnits(hWndForm.Dlg_OpCart.tbl2, nWinW, FALSE),nWinH)
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 3 +  On SAM_User
.head 4 -  Call SalSendMsg( hWndParent.frm_OperCard.hWndTab[0], SAM_User, 0, lParam )
.head 4 -  Call hWndParent.frm_OperCard.picTabs.Enable( 3, lParam )
.head 1 +  Form Window: frmInset
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? No
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   0.27"
.head 4 -  Top:    0.333"
.head 4 -  Width:  14.357"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 1.927"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Background Text: Тип банковской транзакции
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 50500
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.286"
.head 5 -  Top:    0.01"
.head 5 -  Width:  3.0"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Midnight Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgOperType
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbOperType
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.286"
.head 5 -  Top:    0.25"
.head 5 -  Width:  3.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.094"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbOperType.Init(hWndItem)
.head 7 -  Call cmbOperType.Populate(hSql(), 'fli', 'name', 'interbank', 'ORDER BY fli' )
.head 7 -  Call cmbOperType.SetSelectById(hWndParent.Dlg_OpCart.nFli)
.head 5 +  On SAM_Click
.head 6 -  Call hWndParent.Dlg_OpCart.Modified( )
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set hWndParent.Dlg_OpCart.nFli = cmbOperType.nCurrentId
.head 3 -  Background Text: Вид банковской транзакции
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Resource Id: 50501
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.286"
.head 5 -  Top:    0.01"
.head 5 -  Width:  4.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: Dark Blue
.head 4 -  Background Color: Default
.head 3 +  Data Field: bgDk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cLabelControl
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Class Default
.head 5 -  Data Type: Class Default
.head 5 -  Editable? Class Default
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Default
.head 6 -  Top:    Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Justify: Class Default
.head 5 -  Format: Class Default
.head 5 -  Country: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Input Mask: Class Default
.head 4 -  Message Actions
.head 3 +  Combo Box: cmbDk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.286"
.head 5 -  Top:    0.24"
.head 5 -  Width:  3.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 1.094"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On UM_ObjActivate
.head 6 +  If cmbDk.Init(hWndItem)
.head 7 -  Call cmbDk.Populate(hSql(), 'dk', 'name', 'dk', 'ORDER BY dk' )
.head 7 -  Call cmbDk.SetSelectById(hWndParent.Dlg_OpCart.nDk)
.head 5 +  On SAM_Click
.head 6 -  Call hWndParent.Dlg_OpCart.Modified( )
.head 6 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 6 -  Set hWndParent.Dlg_OpCart.nDk = cmbDk.nCurrentId
.head 3 +  Check Box: cbMulti
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Мультивалютная транзакция
.head 4 -  Window Location and Size
.head 5 -  Left:   8.286"
.head 5 -  Top:    0.333"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  ! Call SalSendMsg( cbMulti, SAM_User, 0, 0 )
.head 6 -  Set hWndParent.Dlg_OpCart.nMulti = cbMulti
.head 6 -  Call hWndParent.Dlg_OpCart.Modified( )
.head 5 +  ! On SAM_User
.head 6 +   If cbMulti
.head 7 -   Call SalEnableWindow( dfAccVP )
.head 7 -   Call SalEnableWindow( dfAccInc )
.head 7 -   Call SalEnableWindow( dfAccExp )
.head 6 +   Else
.head 7 -   Call SalDisableWindow( dfAccVP )
.head 7 -   Call SalDisableWindow( dfAccInc )
.head 7 -   Call SalDisableWindow( dfAccExp )
.head 3 +  Check Box: cbComplex
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000B00 5461624F44424F70 65720000
.enddata
.data CLASSPROPSSIZE
0000: 1C00
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сложная транзакция
.head 4 -  Window Location and Size
.head 5 -  Left:   8.286"
.head 5 -  Top:    0.073"
.head 5 -  Width:  3.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set hWndParent.Dlg_OpCart.nComplex = cbComplex
.head 6 -  Call SalSendMsg( hWndParent, SAM_User, 0, cbComplex )
.head 6 -  Call hWndParent.Dlg_OpCart.Modified( )
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Window Handle: hWndParent
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  !
.head 4 -  Set hWndParent=SalParentWindow( hWndForm )
.head 4 -  Set hWndParent.Dlg_OpCart.hWndObject=hWndForm
.head 3 +  On UM_Populate
.head 4 -  Call SalSendMsg( cmbDk,       UM_ObjActivate, 0, 0 )
.head 4 -  Call SalSendMsg( cmbOperType, UM_ObjActivate, 0, 0 )
.head 4 -  Set cbMulti=(hWndParent.Dlg_OpCart.nMulti=1)
.head 4 -  Set cbComplex=(hWndParent.Dlg_OpCart.nChild>0)
.head 1 +  Dialog Box: Dlg_OpFlgs      ! TAB#2
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  13.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.405"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tbl1
.data CLASSPROPSSIZE
0000: 1B00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 54616245504F7065 720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  12.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.69"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colN
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 2
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.95"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Имя флага
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  9.083"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colValue
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значение
флага
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On WM_KeyUp
.head 8 +  If wParam=VK_Insert
.head 9 -  Call SalSendMsg( hWndForm, SAM_DoubleClick, 0, 0 )
.head 8 +  ! Else If colN=35
.head 9 -   Set fAddRec=( colValue=1 )
.head 9 -   Call SalSendMsg( tblOpFlags, SAM_User, 0, 0 )
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.frm_OperCard.Modified( )
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strCode
.head 5 -  String: strName
.head 5 -  Number: nCheck
.head 5 -  Number: nWhatToCheck
.head 5 -  Number: nRes
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 5 +  On UM_Populate
.head 6 -  Call SalTblPopulate( hWndForm,hSql(),'SELECT a.fcode,b.name,a.value FROM tts_flags a,flags b WHERE a.fcode=b.code AND a.tt=:strOperId ORDER BY fcode', TBL_FillAll)
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 +  If NOT SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted, TRUE, ROW_Selected, ROW_MarkDeleted )
.head 7 -  Call SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted,FALSE, ROW_Selected, 0 )
.head 6 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  On SAM_DoubleClick
.head 6 +  If hWndParent.frm_OperCard.ShowPickList( hWndForm,
  'SELECT code,name FROM flags WHERE code NOT IN (SELECT fcode FROM tts_flags WHERE tt=\''||strOperId||'\') ORDER BY code',
   CurrentLangTable.GetAtomTitle('dlg_OperCard.cTOpFlags'),'',strCode,strName)=1
.head 7 -  Call SalTblSetContext( hWndForm, SalTblInsertRow( hWndForm, TBL_MaxRow ) )
.head 7 -  Set colN=SalStrToNumber( strCode )
.head 7 -  Set colName=strName
.head 7 -  Set colValue=0
.head 7 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  On UM_Update
.head 6 -  Set nRes = TBL_MinRow
.head 6 -  Set strFlags=SalStrRepeatX ('0', 64 )
.head 6 +  While SalTblFindNextRow( hWndForm, nRes, 0, ROW_MarkDeleted )
.head 7 -  Call SalTblSetContext( hWndForm, nRes )
.head 7 -  Set strFlags = SalStrReplaceX ( strFlags, colN, 1, Str(colValue) )
.head 6 -  Call SqlPrepareAndExecute( hSql(),"UPDATE tts SET flags=:strFlags WHERE tt=:strOperId")
.head 6 -  ! Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 6 -  ! Call SalWaitCursor(FALSE)
.head 5 +  On WM_KeyUp
.head 6 +  ! If wParam=VK_Insert
.head 7 -   Call SalSendMsg( hWndForm, SAM_DoubleClick, 0, 0 )
.head 6 +  If wParam=VK_Delete
.head 7 -  Call SalSendMsg( hWndForm, SAM_RowHeaderDoubleClick, 0, 0 )
.head 5 +  ! On SAM_User
.head 6 +   If fAddRec
.head 7 -   Call SalEnableWindow( tblOpRules )
.head 6 +   Else
.head 7 -   Call SalDisableWindow( tblOpRules )
.head 5 +  On SAM_KillFocus
.head 6 -  Set hWndCurrent=hWndForm
.head 3 +  Custom Control: ccSplitter
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalHSplitter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name: XSal2_32.dll
.head 5 -  MS Windows Class Name: XSal:Splitter32
.head 5 -  Style:  0x00000000
.head 5 -  ExStyle:  0x00000000
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  12.183"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 3.476"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Etched Border? No
.head 5 -  Hollow? Yes
.head 5 -  Vertical Scroll? No
.head 5 -  Horizontal Scroll? No
.head 5 -  Tab Stop? None
.head 5 -  Tile To Parent? Yes
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Italic
.head 5 -  Text Color: Default
.head 5 -  Background Color: Dark Aqua
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Child Table: tbl2
.data CLASSPROPSSIZE
0000: 1D00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000A00 54616245504F7065 7200000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.067"
.head 6 -  Top:    1.964"
.head 6 -  Width:  12.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 1.417"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colTag
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 5
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.95"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Имя реквизита
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.8"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOpt
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Обязательность
реквизита
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: String
.head 6 -  Justify: Right
.head 6 -  Width:  1.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: M
.head 8 -  Uncheck Value: O
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  Column: colUse4In
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Использовать
для ввода
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.433"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  Column: colOrd
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер реквизита
(для сортировки)
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.767"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  Column: colVal
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значение по
умолчанию
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 254
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.767"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.frm_OperCard.Modified( )
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strCode
.head 5 -  String: strName
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 5 +  On UM_Populate
.head 6 -  Call SalTblPopulate( hWndForm,hSql(),'SELECT a.tag,b.name,a.opt,a.used4input,a.ord, a.val FROM op_rules a,op_field b WHERE a.tag=b.tag AND a.tt=:strOperId ORDER BY a.ord,a.tag',TBL_FillAll)
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 +  If NOT SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted, TRUE, ROW_Selected, ROW_MarkDeleted )
.head 7 -  Call SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted,FALSE, ROW_Selected, 0 )
.head 6 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  On SAM_DoubleClick
.head 6 -  ! 'Реквизиты транзакции'
.head 6 +  If hWndParent.frm_OperCard.ShowPickList( hWndForm,
  'SELECT tag,name FROM op_field WHERE tag NOT IN (SELECT tag FROM op_rules WHERE tt=\''||strOperId||'\') ORDER BY tag',
   CurrentLangTable.GetAtomTitle('dlg_OperCard.cTOpRules'),'',strCode,strName)=1
.head 7 -  Call SalTblSetContext( hWndForm, SalTblInsertRow( hWndForm, TBL_MaxRow ) )
.head 7 -  Set colTag=strCode
.head 7 -  Set colName=strName
.head 7 -  Set colOpt='O'
.head 7 -  Set colUse4In=0
.head 7 -  Call SalSendMsg( hWndForm, UM_Update, 0, 0 )
.head 7 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  On UM_Update
.head 6 -  Call SqlPrepare( hSql(),'INSERT INTO op_rules (tag,tt,opt,used4input,ord,val) VALUES (:tbl2.colTag,:strOperId,:tbl2.colOpt,:tbl2.colUse4In,:tbl2.colOrd,:tbl2.colVal)')
.head 6 -  Call SalTblDoInserts( hWndForm,hSql(),TRUE )
.head 6 -  Call SqlPrepare( hSql(),'UPDATE op_rules SET opt=:tbl2.colOpt,used4input=:tbl2.colUse4In,ord=:tbl2.colOrd,val=:tbl2.colVal WHERE tt=:strOperId AND tag=:tbl2.colTag')
.head 6 -  Call SalTblDoUpdates( hWndForm, hSql(), TRUE )
.head 6 -  Call SqlPrepare( hSql(),'DELETE FROM op_rules WHERE tt=:strOperId AND tag=:tbl2.colTag')
.head 6 -  Call SalTblDoDeletes( hWndForm, hSql(), ROW_MarkDeleted )
.head 5 +  On WM_KeyUp
.head 6 +  ! If wParam=VK_Insert
.head 7 -   Call SalSendMsg( hWndForm, SAM_DoubleClick, 0, 0 )
.head 6 +  If wParam=VK_Delete
.head 7 -  Call SalSendMsg( hWndForm, SAM_RowHeaderDoubleClick, 0, 0 )
.head 5 +  On SAM_KillFocus
.head 6 -  Set hWndCurrent=hWndForm
.head 3 +  ! Data Field: dfDelIns
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 254
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    3.56"
.head 6 -  Width:  12.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Window Handle: hWndParent
.head 3 -  String: strPassPar
.head 3 -  String: InParam[5]
.head 3 -  String: strOperId
.head 3 -  Window Handle: hWndCurrent
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Set dfDelIns = CurrentLangTable.GetAtomTitle('bgDelIns')
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString( lParam )
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 2
.head 5 -  Return FALSE
.head 4 -  !
.head 4 -  Set hWndParent  = SalNumberToWindowHandle(SalStrToNumber(InParam[0]))
.head 4 -  Set hWndParent.frm_OperCard.hWndTab[2] = hWndForm
.head 3 +  On PAGEM_Activate
.head 4 +  If strOperId != hWndParent.frm_OperCard.TT
.head 5 -  Set strOperId=hWndParent.frm_OperCard.TT
.head 5 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 3 +  On PAGEM_Apply
.head 4 -  Call SalSendMsg(tbl1, UM_Update, 0, 0)
.head 4 -  Call SalSendMsg(tbl2, UM_Update, 0, 0)
.head 4 +  If hWndParent.frm_OperCard.picTabs.GetTop() = 2 
.head 5 -  Call SalSendMsg(tbl1, UM_Populate, 0, 0)
.head 5 -  Call SalSendMsg(tbl2, UM_Populate, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalSendMsg(tbl1, UM_Populate, 0, 0)
.head 4 -  Call SalSendMsg(tbl2, UM_Populate, 0, 0)
.head 4 -  Set hWndCurrent=hWndNULL
.head 4 -  Call WaitCursorOff()
.head 3 +  On UM_Insert
.head 4 -  Call SalSendMsg( hWndCurrent, SAM_DoubleClick, 0, 0 )
.head 3 +  On UM_Delete
.head 4 -  Call SalSendMsg( hWndCurrent, SAM_RowHeaderDoubleClick, 0, 0 )
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX, nWinY, nWinW, nWinH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_OpFlgs.ccSplitter, nWinW, 
     SalPixelsToFormUnits(hWndForm.Dlg_OpFlgs.ccSplitter, nWinH, TRUE)-0.4)
.head 4 -  ! Call SalSetWindowLoc(hWndForm.Dlg_OpFlgs.dfDelIns, 0.1, 
     SalPixelsToFormUnits(hWndForm.Dlg_OpFlgs.dfDelIns, nWinH, TRUE)-0.3 )
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 3 +  On SAM_Create
.head 4 -  Call ccSplitter.setTopFrame( tbl1 )
.head 4 -  Call ccSplitter.setBottomFrame( tbl2 )
.head 1 +  Dialog Box: Dlg_OpRels      ! TAB#3
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  13.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.607"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tbl
.data CLASSPROPSSIZE
0000: 2000
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000F00 546162436861696E 65644F7065720000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  12.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colTT
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
операции
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 3
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Имя связанной операции
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  8.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Инверсия
Д/К
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.117"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.frm_OperCard.Modified( )
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strCode
.head 5 -  String: strName
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 5 +  On UM_Populate
.head 6 -  Call SalTblPopulate( hWndForm,hSql(),'SELECT a.ttap,b.name,a.dk FROM ttsap a,tts b WHERE a.ttap=b.tt AND a.tt=:strOperId ORDER BY a.ttap',TBL_FillAll )
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 +  If NOT SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted, TRUE, ROW_Selected, ROW_MarkDeleted )
.head 7 -  Call SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted,FALSE, ROW_Selected, 0 )
.head 6 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  On SAM_DoubleClick
.head 6 -  ! 'Список операций
.head 6 +  If hWndParent.frm_OperCard.ShowPickList(hWndForm,
  'SELECT tt,name FROM tts WHERE (tt NOT IN (SELECT ttap FROM ttsap WHERE tt=\''||strOperId||'\')) AND tt<>\''||strOperId||'\' ORDER BY tt',
   CurrentLangTable.GetAtomTitle('dlg_OperCard.cTRelOpers'),'',strCode,strName )=1
.head 7 -  Call SalTblSetContext( hWndForm, SalTblInsertRow( hWndForm, TBL_MaxRow ) )
.head 7 -  Set colTT=strCode
.head 7 -  Set colName=strName
.head 7 -  Set colDC=0
.head 7 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  On UM_Update
.head 6 -  ! Insert
.head 6 -  Call SqlPrepare( hSql(),'INSERT INTO ttsap (ttap,tt,dk) VALUES (:colTT, :strOperId, :colDC)' )
.head 6 -  Call SalTblDoInserts( hWndForm,hSql(),TRUE )
.head 6 -  ! Update
.head 6 -  Call SqlPrepare( hSql(),'UPDATE ttsap SET dk=:colDC WHERE tt=:strOperId AND ttap=:colTT' )
.head 6 -  Call SalTblDoUpdates( hWndForm, hSql(), TRUE )
.head 6 -  ! Delete
.head 6 -  Call SqlPrepare( hSql(),'DELETE FROM ttsap WHERE tt=:strOperId AND ttap=:colTT' )
.head 6 -  Call SalTblDoDeletes( hWndForm, hSql(), ROW_MarkDeleted )
.head 5 +  On WM_KeyUp
.head 6 +  ! If wParam=VK_Insert
.head 7 -   Call SalSendMsg( hWndForm, SAM_DoubleClick, 0, 0 )
.head 6 +  If wParam=VK_Delete
.head 7 -  Call SalSendMsg( hWndForm, SAM_RowHeaderDoubleClick, 0, 0 )
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('bgDelIns') )
.head 3 +  ! Data Field: dfDelIns
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 254
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.067"
.head 6 -  Top:    2.869"
.head 6 -  Width:  12.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Window Handle: hWndParent
.head 3 -  String: strPassPar
.head 3 -  String: InParam[5]
.head 3 -  String: strOperId
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Set dfDelIns = CurrentLangTable.GetAtomTitle('bgDelIns')
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString( lParam )
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 2
.head 5 -  Return FALSE
.head 4 -  !
.head 4 -  Set hWndParent  = SalNumberToWindowHandle(SalStrToNumber(InParam[0]))
.head 4 -  Set hWndParent.frm_OperCard.hWndTab[3] = hWndForm
.head 3 +  On PAGEM_Activate
.head 4 +  If strOperId != hWndParent.frm_OperCard.TT
.head 5 -  Set strOperId=hWndParent.frm_OperCard.TT
.head 5 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 3 +  On PAGEM_Apply
.head 4 -  Call SalSendMsg(tbl, UM_Update, 0, 0)
.head 4 +  If hWndParent.frm_OperCard.picTabs.GetTop() = 3 
.head 5 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 3 +  On UM_Insert
.head 4 -  Call SalSendMsg( tbl, SAM_DoubleClick, 0, 0 )
.head 3 +  On UM_Delete
.head 4 -  Call SalSendMsg( tbl, SAM_RowHeaderDoubleClick, 0, 0 )
.head 3 +  ! On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX, nWinY, nWinW, nWinH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_OpRels.tbl, nWinW, 
     SalPixelsToFormUnits(hWndForm.Dlg_OpRels.tbl, nWinH, TRUE) - 0.4)
.head 4 -  Call SalSetWindowLoc(hWndForm.Dlg_OpRels.dfDelIns, 0.1, 
     SalPixelsToFormUnits(hWndForm.Dlg_OpRels.dfDelIns, nWinH, TRUE)-0.3 )
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX, nWinY, nWinW, nWinH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_OpRels.tbl,
     SalPixelsToFormUnits(hWndForm.Dlg_OpRels.tbl, nWinW, FALSE),
     SalPixelsToFormUnits(hWndForm.Dlg_OpRels.tbl, nWinH, TRUE))
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 1 +  Dialog Box: Dlg_OpNbss      ! TAB#4
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  11.314"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.063"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tbl
.data CLASSPROPSSIZE
0000: 1A00
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000900 546162466C616773 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  12.1"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? No
.head 4 +  Contents
.head 5 +  Column: colAccBNum
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Номер
счета
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 4
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  0.914"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colAccBName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Имя балансового счета
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  9.114"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colOb22
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: OB22
.head 6 -  Visible? Class Default
.head 6 -  Editable? Class Default
.head 6 -  Maximum Data Length: 2
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Center
.head 6 -  Width:  0.8"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_SetFocus
.head 8 -  Set sTmp = colOb22
.head 7 +  On WM_KeyUp
.head 8 +  If wParam = VK_F4
.head 9 +  If colAccBNum
.head 10 +  If hWndParent.frm_OperCard.ShowPickList(hWndForm,
   "select ob22, txt from sb_ob22 where r020='" || colAccBNum || "' order by ob22",
   colAccBNum || ' - OB22' , 'sb_ob22', strCode, strName) = 1
.head 11 -  Set colOb22 = strCode
.head 7 +  On SAM_AnyEdit
.head 8 +  If not SalIsNull(colOb22)
.head 9 -  Set colOb22 = sTmp
.head 5 +  Column: colDC
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Д/К
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  1.0"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Click
.head 8 -  Set n0=SalTblQueryContext ( hWndForm )
.head 8 +  While TRUE
.head 9 -  Call SalTblSetContext ( hWndForm, n0 )
.head 9 -  Set colDn=not colDn
.head 9 -  Call SetColumnImage( colDC, hImage10, hImage11, colDn )
.head 9 -  Call SalTblSetRowFlags( hWndForm, n0, ROW_Selected, FALSE )
.head 9 +  If CheckItOut()
.head 10 -  Break
.head 8 -  Call SetInclExcl(0,1)
.head 8 -  Call SetInclExcl(1,1)
.head 8 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  Column: colX   ! только/кроме
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Вкл/
Викл
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.643"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If GetGlobalOption('XPS_TTS')='Y'
.head 9 -  Call SalShowWindow( hWndItem )
.head 8 +  Else
.head 9 -  Call SalHideWindow( hWndItem )
.head 7 +  On SAM_Click
.head 8 -  Set colXn=not colXn
.head 8 -  Call SetColumnImage( hWndItem, hImage20, hImage21, colXn )
.head 8 -  Call SalTblSetRowFlags( hWndForm, lParam, ROW_Selected, FALSE )
.head 8 -  Call SetInclExcl(colDn,colXn)
.head 8 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  Column: colDn
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значение
Д/К
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On UM_ObjActivate
.head 8 +  If SalIsWindowVisible ( hWndItem )
.head 9 -  Call SalHideWindow( hWndItem )
.head 8 +  Else
.head 9 -  Call SalShowWindow( hWndItem )
.head 5 +  Column: colXn
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Значение
+/-
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.5"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On UM_ObjActivate
.head 8 +  If GetGlobalOption('XPS_TTS')='Y'
.head 9 +  If SalIsWindowVisible ( hWndItem )
.head 10 -  Call SalHideWindow( hWndItem )
.head 9 +  Else
.head 10 -  Call SalShowWindow( hWndItem )
.head 4 +  Functions
.head 5 +  Function: SetInclExcl
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Number: nDk
.head 7 -  Number: nXn
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  Number: nRow
.head 6 +  Actions
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(tbl, nRow, 0, 0)
.head 8 -  Call SalTblSetContext ( tbl, nRow )
.head 8 +  If tbl.colDn=nDk
.head 9 -  Set tbl.colXn=nXn
.head 9 -  Call SetColumnImage( tbl.colX, hImage20, hImage21, tbl.colXn )
.head 5 +  Function: SetColumnImage
.head 6 -  Description:
.head 6 -  Returns
.head 6 +  Parameters
.head 7 -  Window Handle: hWndCol
.head 7 -  Number: hImage0
.head 7 -  Number: hImage1
.head 7 -  Boolean: bCheck
.head 6 -  Static Variables
.head 6 -  Local variables
.head 6 +  Actions
.head 7 +  If bCheck
.head 8 -  Call XSalTblSetCellImage( hWndCol, hImage1, XSalTableWindow_ImgCenterCenter )
.head 7 +  Else
.head 8 -  Call XSalTblSetCellImage( hWndCol, hImage0, XSalTableWindow_ImgCenterCenter )
.head 5 +  Function: CheckItOut
.head 6 -  Description:
.head 6 +  Returns
.head 7 -  Boolean:
.head 6 -  Parameters
.head 6 -  Static Variables
.head 6 +  Local variables
.head 7 -  String: sNbs
.head 7 -  Number: n
.head 7 -  Number: nDk
.head 7 -  Number: nRow
.head 6 +  Actions
.head 7 -  ! для OB22 не проверяем на наличие одного БС неск. раз в Д/К
.head 7 +  If bOB22
.head 8 -  Return TRUE
.head 7 -  Set nRow = TBL_MinRow
.head 7 +  While SalTblFindNextRow(hWndForm, nRow, 0, ROW_MarkDeleted)
.head 8 -  Call SalTblSetContext(hWndForm, nRow)
.head 8 -  Set sNbs = tbl.colAccBNum
.head 8 -  Set nDk  = tbl.colDn
.head 8 -  Set n = 0
.head 8 +  While TRUE
.head 9 -  Set n = VisTblFindString(hWndForm, n, tbl.colAccBNum, sNbs)
.head 9 +  If n = -1
.head 10 -  Break
.head 9 -  Call SalTblSetContext(hWndForm, n)
.head 9 +  If n != nRow
.head 10 +  If tbl.colDn = nDk
.head 11 -  ! Плохо: Уже есть
.head 11 +  If nDk = 0
.head 12 -  ! Балансовый счет уже есть в списке~допустимых балансовых счетов по дебету! Модификация невозможна.
.head 12 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrNbsD') || PutCrLf() ||
     CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgUpdate'),
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok |  MB_IconStop )
.head 11 +  Else
.head 12 -  ! Балансовый счет уже есть в списке~допустимых балансовых счетов по кредиту! Модификация невозможна.
.head 12 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrNbsC') || PutCrLf() ||
     CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgUpdate'),
     CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok |  MB_IconStop )
.head 11 -  Return FALSE
.head 9 -  Set n = n + 1
.head 8 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 -  Return TRUE
.head 4 +  Window Variables
.head 5 -  String: strCode
.head 5 -  String: strName
.head 5 -  Number: hImage10
.head 5 -  Number: hImage11
.head 5 -  Number: hImage20
.head 5 -  Number: hImage21
.head 5 -  Number: n
.head 5 -  Number: n0
.head 5 -  Number: nDC
.head 5 -  String: sPK
.head 5 -  String: sSem
.head 5 -  String: sTmp
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 6 -  Set hImage10 = XSalImageFromResource( "bmpDebet" )
.head 6 -  Set hImage11 = XSalImageFromResource( "bmpKredit" )
.head 6 -  Set hImage20 = XSalImageFromResource( "bmpNegative" )
.head 6 -  Set hImage21 = XSalImageFromResource( "bmpPositive" )
.head 5 +  On UM_Populate
.head 6 -  Call SalTblPopulate( hWndForm, hSql(),
"SELECT a.nbs, b.name, a.dk, " || IifS(GetGlobalOption('XPS_TTS')='Y', "NVL(a.x,1)", "1") ||
        IifS(bOB22=TRUE, ", a.ob22", ", null") ||
"  INTO :colAccBNum, :colAccBName, :colDn, :colXn, :colOb22" || 
"  FROM ps_tts a, ps b WHERE a.nbs=b.nbs AND a.tt=:strOperId ORDER BY a.dk,a.nbs", TBL_FillAll)
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 +  If NOT SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted,  TRUE, ROW_Selected, ROW_MarkDeleted )
.head 7 -  Call SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted, FALSE, ROW_Selected, 0 )
.head 6 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  On SAM_DoubleClick
.head 6 +  If hWndParent.frm_OperCard.ShowPickList( hWndForm,
  'SELECT nbs,name FROM ps ORDER BY nbs',
   CurrentLangTable.GetAtomTitle('dlg_OperCard.cTBalAcc'),'ps',strCode,strName )=1
.head 7 -  Set nDC = 1
.head 7 -  Set n   = VisTblFindString (tbl, 0, tbl.colAccBNum, strCode)
.head 7 +  If n >= 0
.head 8 -  Call SalTblSetContext( hWndForm, n )
.head 8 -  Set nDC = tbl.colDn
.head 8 -  Set n   = VisTblFindString (tbl, n+1, tbl.colAccBNum, strCode)
.head 7 -  ! для OB22 допускается неск. записей с одним БС
.head 7 +  If n >= 0 and not bOB22 
.head 8 -  Call SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_OperCard.cTErrNbsDC') || PutCrLf() ||
  CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMsgInsert'),
  CurrentLangTable.GetAtomTitle('cTErr'), MB_Ok |  MB_IconStop )
.head 7 +  Else
.head 8 -  Call SalTblSetContext( hWndForm, SalTblInsertRow( hWndForm, TBL_MaxRow ) )
.head 8 -  Set colAccBNum =strCode
.head 8 -  Set colAccBName=strName
.head 8 -  Set colDn = not nDC
.head 8 -  Call SalSendMsg( hWndForm, SAM_FetchRowDone, 0, 0 )
.head 8 -  Call SetInclExcl(0,1)
.head 8 -  Call SetInclExcl(1,1)
.head 8 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  On UM_Update
.head 6 -  Call SalWaitCursor(FALSE)
.head 6 -  Call SqlPrepareAndExecute(hSql(), "DELETE FROM ps_tts WHERE tt=:strOperId")
.head 6 -  Set nRow = TBL_MinRow
.head 6 +  While SalTblFindNextRow(hWndForm, nRow, 0, ROW_MarkDeleted)
.head 7 -  Call SalTblSetContext(hWndForm, nRow)
.head 7 -  Call SqlPrepareAndExecute(hSql(), 
"INSERT INTO ps_tts (tt, nbs, dk" || 
        IifS(GetGlobalOption('XPS_TTS')='Y', ", x", "") || 
        IifS(bOB22=TRUE, ", ob22", "") || ")
 VALUES (:strOperId, :colAccBNum, :colDn" || 
        IifS(GetGlobalOption('XPS_TTS')='Y', ", :colXn", "") || 
        IifS(bOB22=TRUE, ", :colOb22", "") || ")")
.head 7 +  ! If GetGlobalOption('XPS_TTS')='Y'
.head 8 -  Call SqlPrepareAndExecute( hSql(),'INSERT INTO ps_tts (tt,nbs,dk,x) VALUES (:strOperId,:colAccBNum,:colDn,:colXn)' )
.head 7 +  ! Else
.head 8 -  Call SqlPrepareAndExecute( hSql(),'INSERT INTO ps_tts (tt,nbs,dk) VALUES (:strOperId, :colAccBNum, :colDn)' )
.head 6 -  ! Call SalPostMsg(hWndForm, UM_Populate, 0, 0)
.head 6 -  ! Call SalWaitCursor(FALSE)
.head 5 +  On WM_KeyUp
.head 6 +  ! If wParam=VK_Insert
.head 7 -   Call SalSendMsg( hWndForm, UM_Insert, 0, 0 )
.head 6 +  If wParam=VK_Delete
.head 7 -  Call SalSendMsg( hWndForm, SAM_RowHeaderDoubleClick, 0, 0 )
.head 6 +  If wParam=VK_F12
.head 7 -  Call SalSendMsg( colXn, UM_ObjActivate, 0, 0 )
.head 7 -  Call SalSendMsg( colDn, UM_ObjActivate, 0, 0 )
.head 5 +  On SAM_FetchRowDone
.head 6 -  Call SetColumnImage( tbl.colDC, hImage10, hImage11, tbl.colDn )
.head 6 -  Call SetColumnImage( tbl.colX,  hImage20, hImage21, tbl.colXn )
.head 5 +  On SAM_Destroy
.head 6 -  Call XSalImageClose( hImage10 )
.head 6 -  Call XSalImageClose( hImage11 )
.head 6 -  Call XSalImageClose( hImage20 )
.head 6 -  Call XSalImageClose( hImage21 )
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('bgDelIns') ||
  IifS(bOB22=TRUE, PutCrLf() || CurrentLangTable.GetAtomTitle('dlg_OperCard.bgF4Ob22'),"") )
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Window Handle: hWndParent
.head 3 -  String: strPassPar
.head 3 -  String: InParam[5]
.head 3 -  String: strOperId
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Set dfDelIns = CurrentLangTable.GetAtomTitle('bgDelIns')
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString( lParam )
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 2
.head 5 -  Return FALSE
.head 4 -  !
.head 4 -  Set hWndParent  = SalNumberToWindowHandle(SalStrToNumber(InParam[0]))
.head 4 -  Set hWndParent.frm_OperCard.hWndTab[4] = hWndForm
.head 4 -  !
.head 4 +  If not bOB22
.head 5 -  Call SalHideWindow(tbl.colOb22)
.head 3 +  On PAGEM_Activate
.head 4 +  If strOperId != hWndParent.frm_OperCard.TT
.head 5 -  Set strOperId=hWndParent.frm_OperCard.TT
.head 5 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 3 +  On PAGEM_Apply
.head 4 -  Call SalSendMsg(tbl, UM_Update, 0, 0)
.head 4 +  If hWndParent.frm_OperCard.picTabs.GetTop() = 4 
.head 5 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 4 -  Call WaitCursorOff()
.head 3 +  On UM_Insert
.head 4 -  Call SalSendMsg( tbl, SAM_DoubleClick, 0, 0 )
.head 3 +  On UM_Delete
.head 4 -  Call SalSendMsg( tbl, SAM_RowHeaderDoubleClick, 0, 0 )
.head 3 +  ! On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX, nWinY, nWinW, nWinH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_OpNbss.tbl, nWinW, 
     SalPixelsToFormUnits(hWndForm.Dlg_OpNbss.tbl, nWinH, TRUE) - 0.4)
.head 4 -  Call SalSetWindowLoc(hWndForm.Dlg_OpNbss.dfDelIns, 0.1, 
     SalPixelsToFormUnits(hWndForm.Dlg_OpNbss.dfDelIns, nWinH, TRUE)-0.3 )
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX, nWinY, nWinW, nWinH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_OpNbss.tbl,
     SalPixelsToFormUnits(hWndForm.Dlg_OpNbss.tbl, nWinW, FALSE),
     SalPixelsToFormUnits(hWndForm.Dlg_OpNbss.tbl, nWinH, TRUE))
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 1 +  Dialog Box: Dlg_OpVobs      ! TAB#5
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.5"
.head 4 -  Top:    0.5"
.head 4 -  Width:  13.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.619"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tbl
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65340000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  12.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colVOB
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.967"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Виды банковских документов
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  5.25"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colTemplate
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Файл шаблона
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.917"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colORD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Порядок сорт
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.55"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.frm_OperCard.Modified( )
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strCode
.head 5 -  String: strName
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 5 +  On UM_Populate
.head 6 -  Call SalTblPopulate( hWndForm, hSql(),
"SELECT a.vob, b.name, UPPER(b.rep_prefix) rep_prefix, a.ord
   FROM tts_vob a,vob b
  WHERE a.vob=b.vob AND a.tt=:strOperId ORDER BY a.ord ",TBL_FillAll )
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 +  If NOT SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted, TRUE, ROW_Selected, ROW_MarkDeleted )
.head 7 -  Call SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted,FALSE, ROW_Selected, 0 )
.head 6 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  On SAM_DoubleClick
.head 6 -  ! 'Документы'
.head 6 +  If hWndParent.frm_OperCard.ShowPickList(hWndForm,
  'SELECT vob,name FROM vob WHERE vob NOT IN (SELECT vob FROM tts_vob WHERE tt=\''||strOperId||'\') ORDER BY name',
   CurrentLangTable.GetAtomTitle('dlg_OperCard.cTVob'),'vob',strCode,strName )=1
.head 7 -  Call SalTblSetContext( hWndForm, SalTblInsertRow( hWndForm, TBL_MaxRow ) )
.head 7 -  Set colVOB=SalStrToNumber( strCode )
.head 7 -  Set colDName=strName
.head 7 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  On UM_Update
.head 6 -  Call SqlPrepare( hSql(),"INSERT INTO tts_vob (tt,vob,ord) VALUES (:strOperId, :colVOB, :colORD ) " )
.head 6 -  Call SalTblDoInserts( hWndForm, hSql(), TRUE )
.head 6 -  Call SqlPrepare( hSql(),"DELETE FROM tts_vob WHERE tt=:strOperId AND vob=:colVOB " )
.head 6 -  Call SalTblDoDeletes( hWndForm, hSql(), ROW_MarkDeleted )
.head 6 -  Call SqlPrepare( hSql(),"UPDATE tts_vob SET ord=:colORD WHERE tt=:strOperId AND vob=:colVOB " )
.head 6 -  Call SalTblDoUpdates( hWndForm, hSql(), TRUE )
.head 5 +  On WM_KeyUp
.head 6 +  ! If wParam=VK_Insert
.head 7 -   Call SalSendMsg( hWndForm, SAM_DoubleClick, 0, 0 )
.head 6 +  If wParam=VK_Delete
.head 7 -  Call SalSendMsg( hWndForm, SAM_RowHeaderDoubleClick, 0, 0 )
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('bgDelIns') )
.head 3 +  ! Data Field: dfDelIns
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 254
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.067"
.head 6 -  Top:    2.869"
.head 6 -  Width:  12.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Window Handle: hWndParent
.head 3 -  String: strPassPar
.head 3 -  String: InParam[5]
.head 3 -  String: strOperId
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Set dfDelIns = CurrentLangTable.GetAtomTitle('bgDelIns')
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString( lParam )
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 2
.head 5 -  Return FALSE
.head 4 -  !
.head 4 -  Set hWndParent  = SalNumberToWindowHandle(SalStrToNumber(InParam[0]))
.head 4 -  Set hWndParent.frm_OperCard.hWndTab[5] = hWndForm
.head 3 +  On PAGEM_Activate
.head 4 +  If strOperId != hWndParent.frm_OperCard.TT
.head 5 -  Set strOperId=hWndParent.frm_OperCard.TT
.head 5 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 3 +  On PAGEM_Apply
.head 4 -  Call SalSendMsg(tbl, UM_Update, 0, 0)
.head 4 +  If hWndParent.frm_OperCard.picTabs.GetTop() = 5 
.head 5 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 4 -  Call WaitCursorOff()
.head 3 +  On UM_Insert
.head 4 -  Call SalSendMsg( tbl, SAM_DoubleClick, 0, 0 )
.head 3 +  On UM_Delete
.head 4 -  Call SalSendMsg( tbl, SAM_RowHeaderDoubleClick, 0, 0 )
.head 3 +  ! On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX, nWinY, nWinW, nWinH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_OpVobs.tbl, nWinW, 
     SalPixelsToFormUnits(hWndForm.Dlg_OpVobs.tbl, nWinH, TRUE) - 0.4)
.head 4 -  Call SalSetWindowLoc(hWndForm.Dlg_OpVobs.dfDelIns, 0.1, 
     SalPixelsToFormUnits(hWndForm.Dlg_OpVobs.dfDelIns, nWinH, TRUE)-0.3 )
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX, nWinY, nWinW, nWinH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_OpVobs.tbl,
     SalPixelsToFormUnits(hWndForm.Dlg_OpVobs.tbl, nWinW, FALSE),
     SalPixelsToFormUnits(hWndForm.Dlg_OpVobs.tbl, nWinH, TRUE))
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 1 +  Dialog Box: Dlg_OpGrps      ! TAB#6
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   0.5"
.head 4 -  Top:    0.5"
.head 4 -  Width:  13.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.988"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tbl
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65350000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  12.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.833"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colGName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Группы контроля
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  6.857"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colCharged
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Подпись
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Class Default
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Drop Down List
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? No
.head 8 -  Auto Drop Down? Yes
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 +  List Values
.head 7 -  Text: Нет
.head 7 -  Text: Внтр
.head 7 -  Text: СЕП
.head 7 -  Text: Внтр+СЕП
.head 7 -  Text: Грп
.head 6 +  Message Actions
.head 7 +  On SAM_Validate
.head 8 -  Set nCharged=SalListQuerySelection( hWndItem )
.head 7 +  On SAM_Create
.head 8 +  If not(GetGlobalOption( 'VISASIGN' ) = '1' and GetGlobalOption( 'INTSIGN' ) = '2')
.head 9 -  Call SalHideWindow(hWndItem)
.head 7 +  On SAM_Click
.head 8 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  Column: colPriority
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Приоритеты
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On WM_KeyUp
.head 8 +  If wParam=VK_Insert
.head 9 -  Call SalSendMsg( hWndForm, SAM_DoubleClick, 0, 0 )
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  Column: colRespond
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Отв.
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Class Default
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? No
.head 8 -  Auto Drop Down? Yes
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If not(GetGlobalOption( 'VISASIGN' ) = '1' and GetGlobalOption( 'INTSIGN' ) = '2' and GetGlobalOption( 'RESPID' ) = '1')
.head 9 -  Call SalHideWindow(hWndItem)
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  Column: colConditi
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Усл.
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Center
.head 6 -  Width:  0.9"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Class Default
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? No
.head 8 -  Vertical Scroll? No
.head 8 -  Auto Drop Down? Yes
.head 8 -  Allow Text Editing? No
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value: 0
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 +  Message Actions
.head 7 +  On SAM_Create
.head 8 +  If not(GetGlobalOption( 'VISASIGN' ) = '1' and GetGlobalOption( 'INTSIGN' ) = '2')
.head 9 -  Call SalHideWindow(hWndItem)
.head 7 +  On SAM_AnyEdit
.head 8 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  Column: colSqlVal
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Условие визы
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: 2048
.head 6 -  Data Type: Long String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: nCharged
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strCode
.head 5 -  String: strName
.head 5 -  ! Error Handling
.head 5 -  Sql Handle: hSqlGlobal
.head 5 -  Number: nErr
.head 5 -  Number: nPos
.head 5 -  Long String: lsTmp
.head 5 -  Boolean: bTmp
.head 5 -  ! Number: nChrgd
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 5 +  On UM_Populate
.head 6 -  Call SalTblPopulate( hWndForm, hSql(),
'SELECT a.idchk,b.name,NVL(a.f_in_charge,4),a.priority,a.sqlval,NVL(bitand(a.flags,1),0)
   INTO :colId,:colGName,:nCharged,:colPriority,:colSqlVal,:colRespond
   FROM chklist_tts a,chklist b WHERE a.idchk=b.idchk AND a.tt=:strOperId
  ORDER BY a.priority',TBL_FillAll )
.head 6 -  Call VisTblAutoSizeColumn(tbl, hWndNULL)
.head 5 +  On SAM_FetchRowDone
.head 6 -  Call SalListSetSelect ( colCharged, nCharged )
.head 6 -  Set colConditi=(FALSE or colSqlVal)
.head 6 +  ! If colSqlVal
.head 7 -   Set colConditi=1
.head 6 +  ! Else
.head 7 -   Set colConditi=0
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 +  If NOT SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted, TRUE, ROW_Selected, ROW_MarkDeleted )
.head 7 -  Call SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted,FALSE, ROW_Selected, 0 )
.head 6 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  On SAM_DoubleClick
.head 6 +  If hWndParent.frm_OperCard.ShowPickList(hWndForm,
  'SELECT idchk,name FROM chklist WHERE idchk NOT IN (SELECT idchk FROM chklist_tts WHERE tt=\''||strOperId||'\') ORDER BY  name',
   CurrentLangTable.GetAtomTitle('dlg_OperCard.cTGrps'),'',strCode,strName )=1
.head 7 -  Call SalTblSetContext( hWndForm, SalTblInsertRow( hWndForm, TBL_MaxRow ) )
.head 7 -  Set colId=SalStrToNumber( strCode )
.head 7 -  Set colGName=strName
.head 7 -  Set colPriority=SalTblQueryContext ( hWndForm ) + 1
.head 7 -  Set colSqlVal=STRING_Null
.head 7 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  ! On UM_Update
.head 6 -  Call SqlPrepare( hSql(),'INSERT INTO chklist_tts (tt,idchk,priority,sqlval,f_in_charge,flags) VALUES (:strOperId, :colId, :colPriority, :colSqlVal, DECODE(:nCharged,4,NULL,:nCharged),:colRespond)' )
.head 6 -  Call SalTblDoInserts( hWndForm, hSql(), TRUE )
.head 6 -  Call SqlPrepare( hSql(),'UPDATE chklist_tts SET priority=:colPriority,sqlval=:colSqlVal,f_in_charge=DECODE(:nCharged,4,NULL,:nCharged),flags=NVL(bitand(flags,14),0)+:colRespond WHERE tt=:strOperId AND idchk=:colId' )
.head 6 -  Call SalTblDoUpdates( hWndForm, hSql(), TRUE )
.head 6 -  Call SqlPrepare( hSql(),'DELETE FROM chklist_tts WHERE tt=:strOperId AND idchk=:colId' )
.head 6 -  Call SalTblDoDeletes( hWndForm, hSql(), ROW_MarkDeleted )
.head 5 +  On UM_Update
.head 6 +  If SalTblAnyRows( hWndForm, ROW_New | ROW_Edited | ROW_MarkDeleted, 0 )
.head 7 -  Call SqlPrepare( hSql(),'INSERT INTO chklist_tts (tt,idchk,priority,sqlval,f_in_charge,flags) VALUES (:strOperId, :colId, :colPriority, :colSqlVal, DECODE(:nCharged,4,NULL,:nCharged),:colRespond)' )
.head 7 -  Call SalTblDoInserts( hWndForm, hSql(), TRUE )
.head 7 -  Call SqlPrepare( hSql(),'UPDATE chklist_tts SET priority=:colPriority,sqlval=:colSqlVal,f_in_charge=DECODE(:nCharged,4,NULL,:nCharged),flags=NVL(bitand(flags,14),0)+:colRespond WHERE tt=:strOperId AND idchk=:colId' )
.head 7 -  Call SalTblDoUpdates( hWndForm, hSql(), TRUE )
.head 7 -  Call SqlPrepare( hSql(),'DELETE FROM chklist_tts WHERE tt=:strOperId AND idchk=:colId' )
.head 7 -  Call SalTblDoDeletes( hWndForm, hSql(), ROW_MarkDeleted )
.head 7 -  ! Call SqlPrepareAndExecute( hSql(), 
"UPDATE OPER SET chk=NULL WHERE  ref IN (SELECT ref FROM ref_que) AND 
                  tt=:strOperId AND sos BETWEEN 0 AND 3 AND NEXTVISAGRP<>'!!'" )
.head 7 -  Call SqlPLSQLCommand(hSql(),"chk.reset_visa_history(strOperId)")
.head 5 +  On WM_KeyUp
.head 6 +  ! If wParam=VK_Insert
.head 7 -   Call SalSendMsg( hWndForm, SAM_DoubleClick, 0, 0 )
.head 6 +  If wParam=VK_Delete
.head 7 -  Call SalSendMsg( hWndForm, SAM_RowHeaderDoubleClick, 0, 0 )
.head 6 +  If wParam=VK_F4
.head 7 -  Call SalSendMsg( hWndForm, WM_RbuttonDblClick, 0, 0)
.head 5 +  On WM_RbuttonDblClick
.head 6 +  If SalTblAnyRows( tbl, ROW_Selected, 0 )
.head 7 -  Set lsTmp=colSqlVal
.head 7 -  ! 'Редактирование условия визы'
.head 7 -  Call SalModalDialog( dlg_MemoEditor, hWndForm, CurrentLangTable.GetAtomTitle('dlg_OperCard.cTGrpSqlVal'), bTmp, lsTmp )
.head 7 +  If bTmp
.head 8 -  Set colSqlVal=lsTmp
.head 8 -  Set colConditi=(FALSE or colSqlVal)
.head 8 -  Call SalTblSetRowFlags( tbl, SalTblQueryContext( tbl ), ROW_Edited, TRUE )
.head 8 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('bgF4')||PutCrLf()||CurrentLangTable.GetAtomTitle('bgDelIns') )
.head 3 +  ! Data Field: dfF4
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 254
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    2.571"
.head 6 -  Width:  12.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 3 +  ! Data Field: dfDelIns
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 254
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.067"
.head 6 -  Top:    2.869"
.head 6 -  Width:  12.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Window Handle: hWndParent
.head 3 -  String: strPassPar
.head 3 -  String: InParam[5]
.head 3 -  String: strOperId
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Set dfF4 = CurrentLangTable.GetAtomTitle('bgF4')
.head 4 -  ! Set dfDelIns = CurrentLangTable.GetAtomTitle('bgDelIns')
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString( lParam )
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 2
.head 5 -  Return FALSE
.head 4 -  !
.head 4 -  Set hWndParent  = SalNumberToWindowHandle(SalStrToNumber(InParam[0]))
.head 4 -  Set hWndParent.frm_OperCard.hWndTab[6] = hWndForm
.head 3 +  On PAGEM_Activate
.head 4 +  If strOperId != hWndParent.frm_OperCard.TT
.head 5 -  Set strOperId=hWndParent.frm_OperCard.TT
.head 5 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 3 +  On PAGEM_Apply
.head 4 -  Call SalSendMsg( tbl, UM_Update, 0, 0)
.head 4 +  If hWndParent.frm_OperCard.picTabs.GetTop() = 6 
.head 5 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalSendMsg( tbl, UM_Populate, 0, 0)
.head 4 -  Call WaitCursorOff()
.head 3 +  On UM_Insert
.head 4 -  Call SalSendMsg( tbl, SAM_DoubleClick, 0, 0 )
.head 3 +  On UM_Delete
.head 4 -  Call SalSendMsg( tbl, SAM_RowHeaderDoubleClick, 0, 0 )
.head 3 +  ! On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX, nWinY, nWinW, nWinH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_OpGrps.tbl,
     SalPixelsToFormUnits(hWndForm.Dlg_OpGrps.tbl, nWinW, FALSE),
     SalPixelsToFormUnits(hWndForm.Dlg_OpGrps.tbl, nWinH, TRUE)-0.7)
.head 4 -  Call SalSetWindowLoc(hWndForm.Dlg_OpGrps.dfF4, 0.1, 
     SalPixelsToFormUnits(hWndForm.Dlg_OpGrps.dfF4, nWinH, TRUE)-0.6 )
.head 4 -  Call SalSetWindowLoc(hWndForm.Dlg_OpGrps.dfDelIns, 0.1, 
     SalPixelsToFormUnits(hWndForm.Dlg_OpGrps.dfDelIns, nWinH, TRUE)-0.3 )
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX, nWinY, nWinW, nWinH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_OpGrps.tbl,
     SalPixelsToFormUnits(hWndForm.Dlg_OpGrps.tbl, nWinW, FALSE),
     SalPixelsToFormUnits(hWndForm.Dlg_OpGrps.tbl, nWinH, TRUE))
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 1 +  Dialog Box: Dlg_OpInfo      ! TAB#7
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  5.714"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.021"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Multiline Field: ml
.data CLASSPROPSSIZE
0000: 1700
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65360000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 1000000
.head 5 -  String Type: Long String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Border? Yes
.head 5 -  Word Wrap? Yes
.head 5 -  Vertical Scroll? Yes
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  11.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Courier New Cyr
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On UM_Print
.head 6 -  Call SaveInfo()
.head 2 +  Functions
.head 3 +  Function: SaveInfo
.head 4 -  Description:
.head 4 -  Returns
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  File Handle: hFile
.head 5 -  String: sFileName
.head 4 +  Actions
.head 5 -  Set sFileName=GetPrnDir() || "\\op_" || SalNumberToStrX( SalDateHour( Date() ), 0 ) || SalNumberToStrX( SalDateMinute( Date() ), 0 )
.head 5 -  Call VisFileOpen( hFile, sFileName, OF_Create )
.head 5 -  Call VisFileWriteString( hFile, ml )
.head 5 -  Call VisFileClose( hFile )
.head 5 -  Call DosDirectPrint( sFileName )
.head 3 +  ! Function: OperationInfo
.head 4 -   Description: Возвращает информацию об операции по коду
.head 4 +   Returns
.head 5 -   String:
.head 4 +   Parameters
.head 5 -   String: strTT
.head 4 -   Static Variables
.head 4 +   Local variables
.head 5 -   String: sCurLine
.head 5 -   String: sCurLine1
.head 5 -   String: sSqlText
.head 5 -   Number: nPiRes
.head 5 -   String: sEOL
.head 5 -   Number: nFLV
.head 5 -   Number: nFLC
.head 5 -   Boolean: fHead
.head 5 -   Number: n1
.head 5 -   String: s1
.head 5 -   String: s2
.head 5 -   String: strResult
.head 4 +   Actions
.head 5 -   Set sEOL = SalNumberToChar(13) || SalNumberToChar(10)
.head 5 -   Set strResult = ''
.head 5 -   Set sSqlText = "SELECT a.tt || '  ' || a.name || '(' || b.name || ')' INTO :sCurLine FROM tts a, dk b WHERE a.dk=b.dk and tt=:strTT"
.head 5 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 5 +   If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 6 -  ! Наименование
.head 6 -   Set strResult = strResult || sCurLine
.head 6 -   Set sSqlText = "SELECT b.name INTO :sCurLine FROM tts a,interbank b WHERE a.fli=b.fli and a.tt=:strTT"
.head 6 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +   If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Тип Операции: ' || sCurLine
.head 7 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgOperType') || ': ' || sCurLine
.head 6 -  ! Общие свойства
.head 6 -   Set sSqlText = "SELECT mfob INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 6 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +   If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    МФО Б: ' || sCurLine
.head 7 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgMfoB') || ': ' || sCurLine
.head 6 -   Set strResult = strResult || sEOL
.head 6 -  !
.head 6 -   Set sSqlText = "SELECT nlsm, kv INTO :sCurLine, :sCurLine1 FROM tts WHERE tt=:strTT"
.head 6 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +   If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Счет А для оплаты: '|| sCurLine
.head 7 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgAccA') || ': ' || sCurLine || IifS(sCurLine1!='','('||sCurLine1||')','')
.head 6 -  !
.head 6 -   Set sSqlText = "SELECT nlsk, kvk INTO :sCurLine, :sCurLine1 FROM tts WHERE tt=:strTT"
.head 6 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +   If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Счет Б для оплаты: '|| sCurLine
.head 7 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgAccB') || ': '|| sCurLine || IifS(sCurLine1!='','('||sCurLine1||')','')
.head 6 -  !
.head 6 -   Set sSqlText = "SELECT nlsa INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 6 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +   If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Счет А для ввода: ' || sCurLine
.head 7 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgBankA') || ': ' || sCurLine
.head 6 -  !
.head 6 -   Set sSqlText = "SELECT nlsb INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 6 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +   If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Счет Б для ввода: ' || sCurLine
.head 7 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgBankB') || ': ' || sCurLine
.head 6 -   Set strResult = strResult || sEOL
.head 6 -  !
.head 6 -   Set sSqlText = "SELECT sk INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 6 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +   If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Символ кассы: ' || sCurLine
.head 7 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgSKP') || ': ' || sCurLine
.head 6 -   Set strResult = strResult || sEOL
.head 6 -  !
.head 6 -   Set sSqlText = "SELECT s INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 6 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +   If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Формула суммы: ' || sCurLine
.head 7 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgSum') || ': ' || sCurLine
.head 6 -  !
.head 6 -   Set sSqlText = "SELECT s2 INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 6 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +   If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 -  ! Set strResult=strResult || sEOL || '    Формула суммы 2: ' || sCurLine
.head 7 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgSum2') || ': ' || sCurLine
.head 6 -  !
.head 6 -   Set sSqlText = "SELECT rang INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 6 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +   If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 -   Set strResult = strResult || sEOL
.head 7 -  ! Set strResult=strResult || sEOL || '    Приоритет: ' || sCurLine
.head 7 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTPriority') || ': ' || sCurLine
.head 6 -  ! Свойства мультивалютной
.head 6 -   Set sSqlText = "SELECT flv INTO :nFLV FROM tts WHERE tt=:strTT"
.head 6 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +   If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 +   If nFLV
.head 8 -   Set strResult = strResult || sEOL
.head 8 -  ! Set strResult=strResult || sEOL || "  Свойства мультивалютной операции"
.head 8 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTMultiVal')
.head 8 -  !
.head 8 -   Set sSqlText = "SELECT s3800 INTO :sCurLine FROM tts WHERE tt=:strTT"
.head 8 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 8 +   If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 9 -  ! Set strResult=strResult || sEOL || '    Счет вал. позиции: '||sCurLine
.head 9 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgAccVP') || ': '||sCurLine
.head 8 -  !
.head 8 -   Set sSqlText = "SELECT b.nls || '(' || b.kv || ')' INTO :sCurLine FROM tts a, accounts b WHERE a.s6201=b.acc and a.tt=:strTT"
.head 8 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 8 +   If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 9 -  ! Set strResult=strResult || sEOL || '    Счет доходов: ' || sCurLine
.head 9 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgAccInc') || ': ' || sCurLine
.head 8 -  !
.head 8 -   Set sSqlText = "SELECT b.nls || '(' || b.kv || ')' INTO :sCurLine FROM tts a, accounts b WHERE a.s7201=b.acc and a.tt=:strTT"
.head 8 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 8 +   If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 9 -  ! Set strResult=strResult || sEOL || '    Счет расходов: ' || sCurLine
.head 9 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.bgAccExp') || ': ' || sCurLine
.head 6 -  ! Связанные операции
.head 6 -   Set sSqlText = "SELECT flc INTO :nFLC FROM tts WHERE tt=:strTT"
.head 6 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +   If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 +   If nFLC
.head 8 -   Set strResult = strResult || sEOL
.head 8 -  ! Set strResult=strResult || sEOL || "  Связанные операции"
.head 8 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs2') || ':'
.head 8 -  !
.head 8 -   Set sSqlText =
"SELECT a.tt || ' ' || a.name, NVL(b.dk,0)
 INTO :sCurLine, :sCurLine1
 FROM tts a, ttsap b
 WHERE a.tt=b.ttap and b.tt=:strTT
 ORDER BY a.tt"
.head 8 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 8 +   While SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 9 -   Set strResult = strResult || sEOL || '    ' || sCurLine ||
    ' (' || CurrentLangTable.GetAtomTitle('dlg_OperCard.cTInvDC') || '=' || sCurLine1 || ')'
.head 6 -   Set strResult = strResult || sEOL
.head 6 -  ! Флаги
.head 6 -   Set fHead = FALSE
.head 6 -   Set sSqlText =
"SELECT f.code || ' - ' || f.name || ' (' || l.Value ||')'
 INTO :sCurLine
 FROM flags f, tts_flags l
 WHERE f.code=l.fcode AND l.tt=:strTT
 ORDER BY 1"
.head 6 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +   While SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 +   If NOT fHead
.head 8 -  ! Set strResult=strResult || sEOL || "  Флаги:"
.head 8 -   Set strResult=strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTFlags') || ':'
.head 8 -   Set fHead = TRUE
.head 7 -   Set strResult = strResult || sEOL || "    " || sCurLine
.head 6 +   If NOT fHead
.head 7 -  ! Set strResult=strResult || sEOL || "  Флаги отсутствуют"
.head 7 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTNotFlags')
.head 6 -   Set strResult = strResult || sEOL
.head 6 -  ! Доп. реквизиты
.head 6 -   Set fHead = FALSE
.head 6 -   Set sSqlText =
"SELECT l.ord || ' - <' || r.tag || '> ' || r.Name, l.opt, l.used4input, l.val
 INTO :sCurLine, :s1, :n1, :s2
 FROM op_field r, op_rules l
 WHERE r.tag=l.tag AND l.tt=:strTT
 ORDER BY l.ord, r.tag"
.head 6 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +   While SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 +   If NOT fHead
.head 8 -  ! Set strResult=strResult || sEOL || "  Доп. реквизиты:"
.head 8 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTDopR') || ':'
.head 8 -   Set fHead = TRUE
.head 7 +   If s1 = "M"
.head 8 -  ! Set s1="Обязательный"
.head 8 -   Set s1 = CurrentLangTable.GetAtomTitle('dlg_OperCard.cTOpt')
.head 7 +   Else
.head 8 -  ! Set s1="Необязательный"
.head 8 -   Set s1 = CurrentLangTable.GetAtomTitle('dlg_OperCard.cTNotOpt')
.head 7 +   If n1
.head 8 -  ! Set s1="Использовать для ввода," || s1
.head 8 -   Set s1 = CurrentLangTable.GetAtomTitle('dlg_OperCard.cTForInput') || "," || s1
.head 7 +   Else
.head 8 -  ! Set s1="Не использовать для ввода," || s1
.head 8 -   Set s1 = CurrentLangTable.GetAtomTitle('dlg_OperCard.cTNotForInput') || "," || s1
.head 7 -   Set strResult = strResult || sEOL || "    " || sCurLine || "(" || s1 || ")"
.head 7 +   If s2
.head 8 -   Set strResult = strResult || " - " || s2
.head 6 +   If NOT fHead
.head 7 -  ! Set strResult=strResult || sEOL || "  Доп. реквизиты отсутствуют"
.head 7 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTNotDopR')
.head 6 -  ! Бал. счета
.head 6 -   Set fHead = FALSE
.head 6 -   Set sSqlText =
"SELECT s.nbs || ' ' || s.name, l.dk
 INTO :sCurLine, :n1
 FROM ps s,ps_tts l
 WHERE s.nbs=l.nbs AND l.tt=:strTT
 ORDER BY 1"
.head 6 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +   While SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 +   If NOT fHead
.head 8 -   Set strResult = strResult || sEOL
.head 8 -  ! Set strResult=strResult || sEOL || "  Допустимые балансовые счета:"
.head 8 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTBalAcc') || ':'
.head 8 -   Set fHead = TRUE
.head 7 +   If n1
.head 8 -  ! Set s1="Кредитовать"
.head 8 -   Set s1 = CurrentLangTable.GetAtomTitle('dlg_OperCard.cTCred')
.head 7 +   Else
.head 8 -  ! Set s1="Дебетовать"
.head 8 -   Set s1 = CurrentLangTable.GetAtomTitle('dlg_OperCard.cTDeb')
.head 7 -   Set strResult=strResult || sEOL || "    " || sCurLine || " (" || s1 || ")"
.head 6 -   Set strResult = strResult || sEOL
.head 6 -  ! Виды док-тов
.head 6 -   Set fHead = FALSE
.head 6 -   Set sSqlText =
"SELECT v.name || ' (' || UPPER ( v.rep_prefix ) || ')'
 INTO :sCurLine
 FROM vob v, tts_vob l
 WHERE v.vob=l.vob AND l.tt=:strTT
 ORDER BY 1"
.head 6 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +   While SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 +   If NOT fHead
.head 8 -  ! Set strResult=strResult || sEOL || "  Виды док-тов:"
.head 8 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs4') || ':'
.head 8 -   Set fHead = TRUE
.head 7 -   Set strResult = strResult || sEOL || "    " || sCurLine
.head 6 +   If NOT fHead
.head 7 -  ! Set strResult=strResult || sEOL || "  Виды док-тов отсутствуют"
.head 7 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTNotVidDoc')
.head 6 -   Set strResult = strResult || sEOL
.head 6 -  ! Визы
.head 6 -   Set fHead = FALSE
.head 6 -   Set sSqlText =
"SELECT l.priority || ' ' || c.name
 INTO :sCurLine
 FROM chklist c, chklist_tts l
 WHERE c.idchk=l.idchk AND l.tt=:strTT
 ORDER BY l.priority"
.head 6 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +   While SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 7 +   If NOT fHead
.head 8 -  ! Set strResult=strResult || sEOL || "  Группы контроля:"
.head 8 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTabs5') || ':'
.head 8 -   Set fHead = TRUE
.head 7 -   Set strResult = strResult || sEOL || "    " || sCurLine
.head 6 +   If NOT fHead
.head 7 -  ! Set strResult=strResult || sEOL || "  Группы контроля отсутствуют"
.head 7 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTNotGroups')
.head 6 -   Set strResult = strResult || sEOL
.head 6 -  ! Пользователи
.head 6 -   Set fHead = FALSE
.head 6 -   Set sSqlText = "SELECT value INTO :nFLV FROM tts_flags WHERE fcode=0 AND tt=:strTT"
.head 6 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 6 +   If SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok and nFLV != 0
.head 7 -   Set sSqlText =
"SELECT s.id || ' ' || s.fio
 INTO :sCurLine
 FROM staff s, staff_tts l
 WHERE s.id=l.id AND l.tt=:strTT
 ORDER BY s.id"
.head 7 -   Call SqlPrepareAndExecute(hSql(), sSqlText)
.head 7 +   While SqlFetchNext(hSql(), nPiRes) and nPiRes=FETCH_Ok
.head 8 +   If NOT fHead
.head 9 -  ! Set strResult=strResult || sEOL || "  Операция доступна на ввод следующим пользователям:"
.head 9 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTOperAccess') || ':'
.head 9 -   Set fHead = TRUE
.head 8 -   Set strResult = strResult || sEOL || "    " || sCurLine
.head 7 +   If NOT fHead
.head 8 -  ! Set strResult=strResult || sEOL || "  Операция доступна на ввод, но не дана ни одному пользователю"
.head 8 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTOperAccess1')
.head 6 +   Else
.head 7 -  ! Set strResult=strResult || sEOL || "  Операция недоступна на ввод"
.head 7 -   Set strResult = strResult || sEOL || SalStrRepeatX(' ', 2) ||
    CurrentLangTable.GetAtomTitle('dlg_OperCard.cTOperAccess2')
.head 5 -   Return strResult
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Window Handle: hWndParent
.head 3 -  String: strPassPar
.head 3 -  String: InParam[5]
.head 3 -  String: strOperId
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString( lParam )
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 2
.head 5 -  Return FALSE
.head 4 -  !
.head 4 -  Set hWndParent  = SalNumberToWindowHandle(SalStrToNumber(InParam[0]))
.head 4 -  Set hWndParent.frm_OperCard.hWndTab[7] = hWndForm
.head 3 +  On PAGEM_Activate
.head 4 +  If strOperId != hWndParent.frm_OperCard.TT
.head 5 -  Set strOperId=hWndParent.frm_OperCard.TT
.head 5 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Set ml = hWndParent.frm_OperCard.OperationInfo(strOperId)
.head 3 +  On UM_Print
.head 4 -  Call SalSendMsg(ml, UM_Print, 0, 0)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX, nWinY, nWinW, nWinH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_OpInfo.ml,
     SalPixelsToFormUnits(hWndForm.Dlg_OpInfo.ml, nWinW, FALSE),
     SalPixelsToFormUnits(hWndForm.Dlg_OpInfo.ml, nWinH, TRUE))
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 1 +  Dialog Box: Dlg_OpFold      ! TAB#8
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  13.0"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.214"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Child Table: tbl
.data CLASSPROPSSIZE
0000: 1900
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D6537000000 00
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.0"
.head 6 -  Top:    0.0"
.head 6 -  Width:  12.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.5"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 2000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colFOLD
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.967"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование папки
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  8.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  String: strCode
.head 5 -  String: strName
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
.head 5 +  On UM_Populate
.head 6 -  Call SalTblPopulate( hWndForm,hSql(),
'SELECT a.idfo, b.name FROM folders_tts a, folders b
WHERE a.idfo=b.idfo AND a.tt=:strOperId ORDER BY b.name',TBL_FillAll )
.head 5 +  On SAM_RowHeaderDoubleClick
.head 6 +  If NOT SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted, TRUE, ROW_Selected, ROW_MarkDeleted )
.head 7 -  Call SalTblSetFlagsAnyRows( hWndForm, ROW_MarkDeleted,FALSE, ROW_Selected, 0 )
.head 6 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  On SAM_DoubleClick
.head 6 -  ! 'Папки'
.head 6 +  If hWndParent.frm_OperCard.ShowPickList(hWndForm,
  'SELECT idfo,name FROM folders WHERE idfo NOT IN (SELECT idfo FROM folders_tts WHERE tt=\''||strOperId||'\') ORDER BY name',
   CurrentLangTable.GetAtomTitle('dlg_OperCard.cTFold'),'idfo',strCode,strName )=1
.head 7 -  Call SalTblSetContext( hWndForm, SalTblInsertRow( hWndForm, TBL_MaxRow ) )
.head 7 -  Set colFOLD =SalStrToNumber( strCode )
.head 7 -  Set colFName=strName
.head 7 -  Call hWndParent.frm_OperCard.Modified( )
.head 5 +  On UM_Update
.head 6 -  Call SqlPrepare( hSql(),'INSERT INTO folders_tts (tt,idfo) VALUES (:strOperId, :colFOLD)' )
.head 6 -  Call SalTblDoInserts( hWndForm, hSql(), TRUE )
.head 6 -  Call SqlPrepare( hSql(),'DELETE FROM folders_tts WHERE tt=:strOperId AND idfo=:colFOLD' )
.head 6 -  Call SalTblDoDeletes( hWndForm, hSql(), ROW_MarkDeleted )
.head 5 -  ! Keyboard support
.head 5 +  On WM_KeyUp
.head 6 +  ! If wParam=VK_Insert
.head 7 -   Call SalSendMsg( hWndForm, SAM_DoubleClick, 0, 0 )
.head 6 +  If wParam=VK_Delete
.head 7 -  Call SalSendMsg( hWndForm, SAM_RowHeaderDoubleClick, 0, 0 )
.head 5 +  On SAM_TooltipSetText
.head 6 -  Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('bgDelIns') )
.head 3 +  ! Data Field: dfDelIns
.winattr
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: 254
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.05"
.head 6 -  Top:    3.56"
.head 6 -  Width:  12.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.end
.head 4 -  Message Actions 
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Window Handle: hWndParent
.head 3 -  String: strPassPar
.head 3 -  String: InParam[5]
.head 3 -  String: strOperId
.head 2 +  Message Actions
.head 3 +  On PAGEM_Initialize
.head 4 -  ! Меняем шрифты на окнах
.head 4 -  Call SetWindowFont(hWndForm)
.head 4 -  ! Присваиваем значения многоязыковым объектам
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  ! Set dfDelIns = CurrentLangTable.GetAtomTitle('bgDelIns')
.head 4 -  ! Инициализация
.head 4 -  Set strPassPar = SalNumberToHString( lParam )
.head 4 +  If SalStrTokenize(strPassPar, '', ';', InParam) < 2
.head 5 -  Return FALSE
.head 4 -  !
.head 4 -  Set hWndParent  = SalNumberToWindowHandle(SalStrToNumber(InParam[0]))
.head 4 -  Set hWndParent.frm_OperCard.hWndTab[8] = hWndForm
.head 3 +  On PAGEM_Activate
.head 4 +  If strOperId != hWndParent.frm_OperCard.TT
.head 5 -  Set strOperId=hWndParent.frm_OperCard.TT
.head 5 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 3 +  On PAGEM_Apply
.head 4 -  Call SalSendMsg(tbl, UM_Update, 0, 0)
.head 4 +  If hWndParent.frm_OperCard.picTabs.GetTop() = 8 
.head 5 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 3 +  On UM_Populate
.head 4 -  Call SalSendMsg(tbl, UM_Populate, 0, 0)
.head 4 -  Call WaitCursorOff()
.head 3 +  On UM_Insert
.head 4 -  Call SalSendMsg( tbl, SAM_DoubleClick, 0, 0 )
.head 3 +  On UM_Delete
.head 4 -  Call SalSendMsg( tbl, SAM_RowHeaderDoubleClick, 0, 0 )
.head 3 +  ! On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX, nWinY, nWinW, nWinH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_OpFold.tbl, nWinW, 
     SalPixelsToFormUnits(hWndForm.Dlg_OpFold.tbl, nWinH, TRUE) - 0.4)
.head 4 -  Call SalSetWindowLoc(hWndForm.Dlg_OpFold.dfDelIns, 0.1, 
     SalPixelsToFormUnits(hWndForm.Dlg_OpFold.dfDelIns, nWinH, TRUE)-0.3 )
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 3 +  On WM_Size
.head 4 -  Call GetClientRect(hWndForm, nWinX, nWinY, nWinW, nWinH)
.head 4 -  Call SalSetWindowSize(hWndForm.Dlg_OpFold.tbl,
     SalPixelsToFormUnits(hWndForm.Dlg_OpFold.tbl, nWinW, FALSE),
     SalPixelsToFormUnits(hWndForm.Dlg_OpFold.tbl, nWinH, TRUE))
.head 4 -  Call SalInvalidateWindow(hWndForm)
.head 1 +  Dialog Box: dlg_AllUsers
.head 2 -  Class: cGenericTableDlg
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Пользователи,  имеющие доступ к выполнению
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.963"
.head 4 -  Top:    2.188"
.head 4 -  Width:  9.55"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.869"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 18991
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 13
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 18992
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbOk
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set fOk = TRUE
.head 7 -  Set nUserId   = tbl.colID
.head 7 -  Set sUserName = tbl.colFIO
.head 7 -  Call SalEndDialog(dlg_AllUsers, 0)
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set fOk = FALSE
.head 7 -  Set nUserId   = 0
.head 7 -  Set sUserName = ''
.head 7 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 4 -  Line
.head 5 -  Resource Id: 18993
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Child Table: tbl
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableDlg
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.05"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colFIO
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Ф.И.О. Пользователя
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  7.517"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg(pbOk, SAM_Click, 0, 0)
.head 5 +  On UM_Populate
.head 6 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 6 -  Set nTmp = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 6 -  Call SalTblSetContext(hWndForm, nTmp)
.head 6 -  Set colID  = NUMBER_Null
.head 6 -  Set colFIO = 'Все пользователи'
.head 6 -  Call SalTblSetRowFlags(hWndForm, nTmp, ROW_New, FALSE)
.head 6 -  Call SalTblSetContext(hWndForm, 0)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Receive Boolean: fOk
.head 3 -  Receive Number: nUserId
.head 3 -  Receive String: sUserName
.head 2 +  Window Variables
.head 3 -  Number: nTmp
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, 'Користувачі')
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set strSqlPopulate = 
"select id,fio 
 into :dlg_AllUsers.tbl.colID, :dlg_AllUsers.tbl.colFIO 
 from staff where id<>-1"
.head 4 -  Set strSqlInsert = ""
.head 4 -  Set strSqlUpdate = ""
.head 4 -  Set strSqlDelete = ""
.head 4 -  Set strFilterTblName = "STAFF"
.head 4 -  Set strPrintFileName = ""
.head 4 -  Set nFlags = GT_ReadOnly
.head 4 -  Call SalSendClassMessage(UM_Create, 0, 0)
.head 1 +  Table Window: tbl_ZaprosUsers
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Користувачі, що мають доступ до запиту
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 30392
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 30393
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 30394
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: cUserId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № кор-ча
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalModalDialog(dlg_AllUsers, tbl_ZaprosUsers, bResult, nUserId, sUserFio)
.head 6 +  If bResult
.head 7 -  Set cUserId=nUserId
.head 7 -  Set cUserFio=sUserFio
.head 3 +  Column: cUserFio
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: П.І.Б.
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  4.55"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: SaveChanges
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number:
.head 4 +  Parameters
.head 5 -  Receive String: sErrMsg
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRow
.head 4 +  Actions
.head 5 +  If bDeletingMode
.head 6 -  Set nRow = TBL_MinRow
.head 6 -  Call SalTblSetContext ( tbl_ZaprosUsers, nRow )
.head 6 +  While SalTblFindNextRow (tbl_ZaprosUsers, nRow, ROW_MarkDeleted, 0 )
.head 7 -  Call SalTblSetContext (tbl_ZaprosUsers, nRow )
.head 7 +  If not SqlPrepareAndExecute(hSql(),
   " delete from zapros_users where kodz= :nKodz and 
     user_id=decode(nvl(:tbl_ZaprosUsers.cUserId,0),0,-1,:tbl_ZaprosUsers.cUserId)")
.head 8 -  Set sErrMsg="Ошибка удаления из таблицы zapros_users"
.head 8 -  Return -1
.head 5 -  !
.head 5 -  ! Inserting
.head 5 +  Else If bInsertingMode
.head 6 -  Set nRow = TBL_MinRow
.head 6 -  Call SalTblSetContext (tbl_ZaprosUsers, nRow )
.head 6 +  While SalTblFindNextRow (tbl_ZaprosUsers, nRow, ROW_New, 0 )
.head 7 -  Call SalTblSetContext ( tbl_ZaprosUsers, nRow )
.head 7 +  If not SqlPrepareAndExecute(hSql(),
   "insert into zapros_users values( :nKodz, decode(nvl(:tbl_ZaprosUsers.cUserId,0),0,-1,:tbl_ZaprosUsers.cUserId)) ")
.head 8 -  Set sErrMsg='Ошибка вставки в таблицу zapros_users'
.head 8 -  Return -1
.head 5 -  !
.head 5 -  Call SalWaitCursor(TRUE)
.head 5 -  Call SalTblPopulate(hWndForm, hSql(), T(strSqlPopulate), TBL_FillAll)
.head 5 -  Call SalWaitCursor(FALSE)
.head 5 -  Set bDeletingMode=FALSE
.head 5 -  Set bInsertingMode=FALSE
.head 5 -  Return 0
.head 2 +  Window Parameters
.head 3 -  Number: nKodz
.head 2 +  Window Variables
.head 3 -  Boolean: bResult
.head 3 -  Number: nUserId
.head 3 -  String: sUserFio
.head 3 -  Boolean: bInsertingMode
.head 3 -  Boolean: bDeletingMode
.head 3 -  String: sErrMsg
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Set strSqlPopulate= 
"select decode(id, -1, null, id), decode(id,-1,'Все пользователи',fio) 
 into :tbl_ZaprosUsers.cUserId, :tbl_ZaprosUsers.cUserFio 
 from zapros_users, staff where id=user_id and kodz="||SalNumberToStrX(nKodz,0)
.head 4 -  Set strSqlInsert = ""
.head 4 -  Set strSqlUpdate = ""
.head 4 -  Set strSqlDelete = ""
.head 4 -  Set strPrintFileName = ""
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On UM_Insert
.head 4 -  Set bInsertingMode=1
.head 4 -  Call SalSendClassMessage(  UM_Insert, wParam, lParam )
.head 3 +  On UM_Update
.head 4 +  If SaveChanges(sErrMsg)<0
.head 5 -  Call SalMessageBox(sErrMsg,'Внимание!',0)
.head 5 -  Call SqlRollback(hSql())
.head 4 +  Else
.head 5 -  Call SqlCommit(hSql())
.head 3 +  On UM_Delete
.head 4 -  Set bDeletingMode=TRUE
.head 4 -  Call SalSendClassMessage( UM_Delete, wParam, lParam )
.head 1 +  Dialog Box: dlg_PkeyData
.head 2 -  Class: cGenericTableDlg
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Пользователи,  имеющие доступ к выполнению
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Class Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   1.963"
.head 4 -  Top:    2.188"
.head 4 -  Width:  9.55"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 4.869"
.head 4 -  Height Editable? Class Default
.head 3 -  Absolute Screen Location? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 11
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 12
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 20
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 15
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 43408
.head 5 -  Class Child Ref Key: 19
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 13
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 23
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 14
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 43409
.head 5 -  Class Child Ref Key: 21
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbOk
.head 5 -  Class Child Ref Key: 16
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set fOk = TRUE
.head 7 -  Set sCode   = tab.colCode
.head 7 -  Call SalEndDialog(dlg_PkeyData, 0)
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 17
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Set fOk = FALSE
.head 7 -  Set sCode  = ''
.head 7 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 4 -  Line
.head 5 -  Resource Id: 43410
.head 5 -  Class Child Ref Key: 22
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTableDlg
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Child Table: tab
.head 4 -  Class Child Ref Key: 8
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenericTableDlg
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  View: Class Default
.head 5 -  Allow Row Sizing? Class Default
.head 5 -  Lines Per Row: Class Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Class Default
.head 5 -  Discardable? Class Default
.head 4 +  Contents
.head 5 +  Column: colCode
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.25"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class: cColumnLabeled
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? Class Default
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Class Default
.head 6 -  Data Type: Class Default
.head 6 -  Justify: Class Default
.head 6 -  Width:  7.417"
.head 6 -  Width Editable? Class Default
.head 6 -  Format: Class Default
.head 6 -  Country: Class Default
.head 6 -  Input Mask: Class Default
.head 6 -  Cell Options
.head 7 -  Cell Type? Class Default
.head 7 -  Multiline Cell? Class Default
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Class Default
.head 8 -  Vertical Scroll? Class Default
.head 8 -  Auto Drop Down? Class Default
.head 8 -  Allow Text Editing? Class Default
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Class Default
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 5 +  On SAM_DoubleClick
.head 6 -  Call SalSendMsg(pbOk, SAM_Click, 0, 0)
.head 5 +  On UM_Populate
.head 6 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 6 -  Set nTmp = SalTblInsertRow(hWndForm, TBL_MaxRow)
.head 6 -  Call SalTblSetContext(hWndForm, nTmp)
.head 6 -  Set colCode = '***'
.head 6 -  Set colName = CurrentLangTable.GetAtomTitle('dlg_PkeyData.forAll')
.head 6 -  Call SalTblSetRowFlags(hWndForm, nTmp, ROW_New, FALSE)
.head 6 -  Call SalTblSetContext(hWndForm, 0)
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  String: sParam   ! ='MOD' - Модули ='BNK' - банки
.head 3 -  Receive Boolean: fOk
.head 3 -  Receive String: sCode ! Код модуля/банка
.head 2 +  Window Variables
.head 3 -  Number: nTmp
.head 3 -  String: sWndTitle
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 +  If sParam = 'MOD'
.head 5 -  Set sWndTitle = CurrentLangTable.GetAtomTitle('dlg_PkeyData.wndTitleMOD')
.head 5 -  Set strSqlPopulate = 
"select mod_code, mod_name
 into :tab.colCode, :tab.colName
 from bars_supp_modules
 order by mod_code"
.head 5 -  Set strFilterTblName = "BARS_SUPP_MODULES"
.head 4 +  If sParam = 'BNK'
.head 5 -  Set sWndTitle = CurrentLangTable.GetAtomTitle('dlg_PkeyData.wndTitleBNK')
.head 5 -  Set strSqlPopulate = 
"select bank_code, bank_name
 into :tab.colCode,:tab.colName
 from bars_supp_banks
 order by bank_code"
.head 5 -  Set strFilterTblName = "BARS_SUPP_BANKS"
.head 4 -  !
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, sWndTitle)
.head 4 -  Call PrepareWindowEx(hWndForm)
.head 4 -  Set strSqlInsert = ""
.head 4 -  Set strSqlUpdate = ""
.head 4 -  Set strSqlDelete = ""
.head 4 -  Set strPrintFileName = ""
.head 4 -  Set nFlags = GT_ReadOnly
.head 4 -  Call SalSendClassMessage(UM_Create, 0, 0)
.head 1 +  ! cGenericTableDlg: dlg_PkeyData
.winattr class Dialog Box:
.head 2 -  Class: cGenericTableDlg
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Пользователи,  имеющие доступ к выполнению
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   1.963"
.head 4 -  Top:    2.188"
.head 4 -  Width:  9.55"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 4.869"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.end
.head 2 -   Description: 
.head 2 +   Tool Bar 
.head 3 +   Contents 
.head 4 +   Pushbutton: pbIns
.head 5 -   Message Actions 
.head 4 +   Pushbutton: pbDel
.head 5 -   Message Actions 
.head 4 +   Pushbutton: pbRefresh
.head 5 -   Message Actions 
.head 4 +   Pushbutton: pbUpdate
.head 5 -   Message Actions 
.head 4 -   Line 
.head 4 +   Pushbutton: pbSearch
.head 5 -   Message Actions 
.head 4 +   Pushbutton: pbFilter
.head 5 -   Message Actions 
.head 4 +   Pushbutton: pbPrint
.head 5 -   Message Actions 
.head 4 -   Line 
.head 4 +   Pushbutton: pbOk
.head 5 +   Message Actions 
.head 6 +   On SAM_Click
.head 7 -  ! Set fOk = TRUE
.head 7 -  ! Set nUserId   = tbl.colID
.head 7 -  ! Set sUserName = tbl.colFIO
.head 7 -   Call SalEndDialog(dlg_PkeyData, 0)
.head 4 +   Pushbutton: pbExit
.head 5 +   Message Actions 
.head 6 +   On SAM_Click
.head 7 -  ! Set fOk = FALSE
.head 7 -  ! Set nUserId   = 0
.head 7 -  ! Set sUserName = ''
.head 7 -   Call SalSendClassMessage(SAM_Click, 0, 0)
.head 4 -   Line 
.head 2 +   Contents 
.head 3 +   Child Table: tbl
.head 4 +   Contents 
.head 5 +   Column: colID
.head 6 -   List Values 
.head 6 -   Message Actions 
.head 5 +   Column: colFIO
.head 6 -   List Values 
.head 6 -   Message Actions 
.head 4 -   Functions 
.head 4 -   Window Variables 
.head 4 +   Message Actions 
.head 5 +   On SAM_Create
.head 6 -   Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 5 +   On SAM_DoubleClick
.head 6 -   Call SalSendMsg(pbOk, SAM_Click, 0, 0)
.head 2 -   Functions 
.head 2 +   Window Parameters 
.head 3 -  ! String: sParam   ! ='MOD' - Модули ='BNK' - банки
.head 3 -  ! Receive Boolean: fOk
.head 3 -  ! Receive String: sCode ! Код модуля/банка
.head 2 +   Window Variables 
.head 3 -   Number: nTmp
.head 2 +   Message Actions 
.head 3 +   On SAM_Create
.head 4 -   Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -   Call SalSetWindowText(hWndForm, 'Користувачі')
.head 4 -   Call PrepareWindowEx(hWndForm)
.head 4 -   Set strSqlPopulate = 
"select 'SDF', 'FGFGF' 
 into :tbl.colID, :tbl.colFIO 
 from staff"
.head 4 -   Set strSqlInsert = ""
.head 4 -   Set strSqlUpdate = ""
.head 4 -   Set strSqlDelete = ""
.head 4 -   Set strFilterTblName = "STAFF"
.head 4 -   Set strPrintFileName = ""
.head 4 -   Set nFlags = GT_ReadOnly
.head 4 -   Call SalSendClassMessage(UM_Create, 0, 0)
.head 1 +  Dialog Box: dlg_Pkey
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  6.667"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.512"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: dfLable1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.179"
.head 6 -  Width:  6.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfLable2
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.345"
.head 6 -  Width:  6.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfLable3
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.536"
.head 6 -  Width:  6.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfPKey
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    1.238"
.head 6 -  Width:  6.0"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Background Text: Ключ:
.head 4 -  Resource Id: 40570
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    0.929"
.head 5 -  Width:  0.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.583"
.head 5 -  Top:    1.571"
.head 5 -  Width:  1.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.417"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name: \BARS98\RESOURCE\BMP\APPLY.BMP
.head 4 -  Picture Transparent Color: Gray
.head 4 -  Image Style: Single
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set sPkey = dfPKey
.head 6 -  Call SalEndDialog(hWndForm, 0)
.head 3 -  Group Box:
.head 4 -  Resource Id: 40571
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    -0.012"
.head 5 -  Width:  6.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Line
.head 4 -  Resource Id: 60305
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Coordinates
.head 5 -  Begin X:  0.183"
.head 5 -  Begin Y:  0.821"
.head 5 -  End X:  6.283"
.head 5 -  End Y:  0.821"
.head 4 -  Visible? Yes
.head 4 -  Line Style: Etched
.head 4 -  Line Thickness: 7
.head 4 -  Line Color: Default
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nVSSSeq
.head 3 -  Receive String: sPkey
.head 2 -  Window Variables
.head 2 +  Message Actions
.head 3 -  ! If 
.head 3 +  On SAM_Create
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_Pkey.wndTitle'))
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SalSetWindowText(pbOk, CurrentLangTable.GetAtomTitle('dlg_Pkey.pbOk'))
.head 4 +  If nVSSSeq = NUMBER_Null
.head 5 -  Set dfLable1 = CurrentLangTable.GetAtomTitle('dlg_Pkey.lable1NoVSS')
.head 5 -  Set dfLable2 = CurrentLangTable.GetAtomTitle('dlg_Pkey.lable2NoVSS')
.head 5 -  Set dfLable3 = CurrentLangTable.GetAtomTitle('dlg_Pkey.lable3NoVSS')
.head 4 +  Else
.head 5 -  Set dfLable1 = CurrentLangTable.GetAtomTitle('dlg_Pkey.lable1WithVSS')||SalNumberToStrX(nVSSSeq,0)
.head 5 -  ! Set dfLable2 = SalNumberToStrX(nVSSSeq,0)
.head 4 -  Set dfPKey = sPkey
.head 4 -  !
.head 1 +  Table Window: tbl_FastReportEditor
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Редагування звітів FR
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  11.15"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 5.762"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If SqlPrepareAndExecute(hSql(),"
select bars_report.next_reportid
  into :nNewReportId 
  from dual")
.head 8 +  If not SqlFetchNext(hSql(),nTmp)
.head 9 -  Call SalMessageBox('Ошибка получения нового номмера отчета', 'Внимание!', MB_Ok)
.head 7 -  Call SalSendClassMessage(SAM_Click, 0, 0)
.head 7 -  Set tbl_FastReportEditor.id = nNewReportId
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 51620
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  5.05"
.head 6 -  Begin Y:  0.071"
.head 6 -  End X:  5.05"
.head 6 -  End Y:  0.536"
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.55"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.983"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.417"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.85"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 51621
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  4.383"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  4.383"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.517"
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 51622
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  2.4"
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  2.4"
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbEdit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.82"
.head 6 -  Top:    0.075"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? No
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? No
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: (none)
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: None
.head 5 -  Picture File Name: \BARS98\RESOURCE\BMP\EDIT.BMP
.head 5 -  Picture Transparent Color: Gray
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  ! Call Debug('params: '||SqlDatabase||' '||SqlUser||' '||SqlPassword||' '||GetTemplateDir()||' '||template)
.head 7 -  Call SalLoadApp ( 'frdesign.exe' , SqlDatabase||' '||SqlUser||' '||SqlPassword||' '||GetTemplateDir()||' '||template )
.head 7 -  !
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText(lParam, CurrentLangTable.GetAtomTitle('tbl_FastReportEditor.pbEdit'))
.head 2 +  Contents
.head 3 +  Column: id
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № Звіту
.head 4 -  Visible? Class Default
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  0.817"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: description
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Опис
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  4.6"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: template
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Шаблон
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  1.617"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: folder_id
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cColumnLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Class Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: folder_name
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenColComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Папка звіту
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Data Type: Class Default
.head 4 -  Justify: Class Default
.head 4 -  Width:  2.633"
.head 4 -  Width Editable? Class Default
.head 4 -  Format: Class Default
.head 4 -  Country: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  Cell Options
.head 5 -  Cell Type? Class Default
.head 5 -  Multiline Cell? Class Default
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Class Default
.head 6 -  Vertical Scroll? Class Default
.head 6 -  Auto Drop Down? Class Default
.head 6 -  Allow Text Editing? Class Default
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Class Default
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If folder_name.Init( hWndItem )
.head 7 -  Call folder_name.Populate(hSql(), 'IDF','NAME', 'REPORTSF','ORDER BY IDF' )
.head 7 -  ! Call folder_name.SetSelectById('M', 'Mail' )
.head 5 +  On SAM_AnyEdit
.head 6 -  Set folder_id = folder_name.GetKey( SalListQuerySelection( tbl_FastReportEditor.folder_name) )
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nNewReportId
.head 2 +  Message Actions
.head 3 +  On UM_Populate
.head 4 -  Call SalSendClassMessage(UM_Populate, 0, 0)
.head 3 +  On SAM_Create
.head 4 -  ! Call SalDisableWindow(pbIns)
.head 4 -  ! Call SalDisableWindow(pbDel)
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Set strSqlPopulate =
   "select id, description, param, idf
      into :tbl_FastReportEditor.id, :tbl_FastReportEditor.description, :tbl_FastReportEditor.template, :tbl_FastReportEditor.folder_id
      from reports
     where form = 'frm_FastReport'"
.head 4 -  Set strSqlUpdate =
   "update reports
       set description = :tbl_FastReportEditor.description,
           param       = :tbl_FastReportEditor.template,
           idf         = :tbl_FastReportEditor.folder_id
     where id = :tbl_FastReportEditor.id"
.head 4 -  Set strSqlInsert =
   "insert into reports(id, name, description, form, param, idf)
    values(:tbl_FastReportEditor.id, 'Empty', :tbl_FastReportEditor.description, 'frm_FastReport', :tbl_FastReportEditor.template, :tbl_FastReportEditor.folder_id)"
.head 4 -  Set strSqlDelete = "delete from reports where id = :tbl_FastReportEditor.id"
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_FetchRowDone
.head 4 -  Call folder_name.SetSelectById(folder_id)
.head 1 +  Dialog Box: dlg_addToFunc
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Внести кат. запит до переліку функцій
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  6.883"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 5.631"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Data Field: lblFuncCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.155"
.head 6 -  Width:  2.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.179"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfFuncCode
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.321"
.head 6 -  Width:  1.3"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: lbFuncName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.655"
.head 6 -  Width:  2.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.179"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfFuncName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.821"
.head 6 -  Width:  6.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: lbFunc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    1.155"
.head 6 -  Width:  2.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.179"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfFunc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    1.321"
.head 6 -  Width:  6.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: lbRole
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    1.655"
.head 6 -  Width:  2.9"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.19"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfRole
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    1.845"
.head 6 -  Width:  6.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 -  Frame
.head 4 -  Resource Id: 54842
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.017"
.head 5 -  Top:    4.571"
.head 5 -  Width:  6.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.75"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Pushbutton: pbOk
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ок
.head 4 -  Window Location and Size
.head 5 -  Left:   1.783"
.head 5 -  Top:    4.738"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set strMess = ''
.head 6 +  If SalStrLength(dfRole)  = 0 OR nRepType = 0 
.head 7 +  If SalStrLength(dfRole) = 0
.head 8 -  Set strMess = strMess || 'Не встановлено роль для функції'||PutCrLf()
.head 7 +  If nRepType = 0 
.head 8 -  Set strMess = strMess || 'Не выбрано тип звіту'
.head 6 -  !
.head 6 -  !
.head 6 +  If SalStrLength(strMess) > 0 
.head 7 -  Call SalMessageBox(strMess, 'Увага!',0 )
.head 6 +  Else
.head 7 -  Set nExecFlg = 1
.head 7 +  If SqlPLSQLCommand(hSql(), "abs_utils.add_func_cnt(dfFuncName, dfFunc, dfRole, dfFuncCode)")
.head 8 +  If cbAddToList = TRUE
.head 9 -  Set nStartFinishFlg = rbFinish
.head 9 -  Set nDefaultChecked = cbMandatory
.head 9 -  Set strRole = SalStrUpperX(dfRole)
.head 9 +  If not SqlPLSQLCommand(hSql(), "abs_utils.add_funclist_cnt(dfFuncCode, nStartFinishFlg, nDefaultChecked)") 
.head 10 -  Set nExecFlg = 0
.head 10 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_addToFunc.msg.ErrAddFuncList'), 
                   CurrentLangTable.GetAtomTitle('cTAt'),MB_IconStop )
.head 8 +  If nExecFlg = 1
.head 9 -  Call SqlCommit(hSql())
.head 9 -  Call SalMessageBox(CurrentLangTable.GetAtomTitle('dlg_addToFunc.msg.NewFuncAdded'), '', 0 )
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   3.583"
.head 5 -  Top:    4.738"
.head 5 -  Width:  Class Default
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog ( hWndForm, nTmp )
.head 3 +  Data Field: dfOutFileName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.25"
.head 6 -  Top:    3.155"
.head 6 -  Width:  3.333"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Set dfFunc  = getOperFunc(nKodz,dfOutFileName,nRepType,dfParams, cbAskParam ) 
.head 3 +  Combo Box: cmbReportType
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cGenComboBox_NumId
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.783"
.head 5 -  Top:    2.488"
.head 5 -  Width:  4.8"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.881"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Editable? Class Default
.head 4 -  String Type: Class Default
.head 4 -  Maximum Data Length: Class Default
.head 4 -  Sorted? Class Default
.head 4 -  Always Show List? Class Default
.head 4 -  Vertical Scroll? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Input Mask: Class Default
.head 4 -  List Initialization
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 +  If cmbReportType.Init( hWndItem )
.head 7 -  Call cmbReportType.Populate(hSql(), 'TYPEID','DESCRIPT', 'REP_TYPES','ORDER BY TYPEID' )
.head 5 +  On SAM_Click
.head 6 -  Set nRepType = cmbReportType.GetKey( SalListQuerySelection(cmbReportType) )
.head 6 -  Set dfFunc  = getOperFunc(nKodz,dfOutFileName,nRepType,dfParams, cbAskParam ) 
.head 3 +  Data Field: lbReportType
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    2.512"
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Data Field: dfParams
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   3.25"
.head 6 -  Top:    2.845"
.head 6 -  Width:  3.333"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Set dfFunc  = getOperFunc(nKodz,dfOutFileName,nRepType,dfParams, cbAskParam ) 
.head 3 -  Frame
.head 4 -  Resource Id: 22452
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.017"
.head 5 -  Top:    2.321"
.head 5 -  Width:  6.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.5"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 22451
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.017"
.head 5 -  Top:    -0.012"
.head 5 -  Width:  6.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 2.333"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 -  Frame
.head 4 -  Resource Id: 60331
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   -0.017"
.head 5 -  Top:    3.821"
.head 5 -  Width:  6.8"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.75"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Corners: Square
.head 4 -  Border Style: Etched
.head 4 -  Border Thickness: 1
.head 4 -  Border Color: Default
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbStart
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: на старт дня
.head 4 -  Window Location and Size
.head 5 -  Left:   3.483"
.head 5 -  Top:    3.905"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Radio Button: rbFinish
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cRadioButtonLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: на фініш дня
.head 4 -  Window Location and Size
.head 5 -  Left:   5.083"
.head 5 -  Top:    3.905"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Check Box: cbParams
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Значення параметрів
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    2.821"
.head 5 -  Width:  2.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If cbParams
.head 7 -  Call SalEnableWindow(dfParams)
.head 6 +  If NOT cbParams
.head 7 -  Set dfParams = ''
.head 7 -  Call SalDisableWindow(dfParams)
.head 6 -  Set dfFunc  = getOperFunc(nKodz,dfOutFileName,nRepType,dfParams, cbAskParam ) 
.head 3 +  Check Box: cbOutFileName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Ім'я вихідного файлу
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    3.155"
.head 5 -  Width:  2.7"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If cbOutFileName
.head 7 -  Call SalEnableWindow(dfOutFileName)
.head 6 +  If NOT cbOutFileName
.head 7 -  Set dfOutFileName = ''
.head 7 -  Call SalDisableWindow(dfOutFileName)
.head 6 -  Set dfFunc  = getOperFunc(nKodz,dfOutFileName,nRepType,dfParams, cbAskParam ) 
.head 3 +  Check Box: cbAskParam
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Виводити вікно запиту параметрів
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    3.488"
.head 5 -  Width:  3.3"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set dfFunc  = getOperFunc(nKodz,dfOutFileName,nRepType,dfParams, cbAskParam ) 
.head 3 +  Check Box: cbAddToList
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Додати у список виконання
.head 4 -  Window Location and Size
.head 5 -  Left:   0.183"
.head 5 -  Top:    3.905"
.head 5 -  Width:  2.9"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  If cbAddToList  = TRUE
.head 7 -  Call SalEnableWindow(rbStart)
.head 7 -  Call SalEnableWindow(rbFinish)
.head 7 -  Call SalEnableWindow(cbMandatory)
.head 6 +  Else
.head 7 -  Set cbMandatory = FALSE
.head 7 -  Call SalDisableWindow(rbStart)
.head 7 -  Call SalDisableWindow(rbFinish)
.head 7 -  Call SalDisableWindow(cbMandatory)
.head 3 +  Check Box: cbMandatory
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCheckBoxLabeled
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Обов'язкове виконання
.head 4 -  Window Location and Size
.head 5 -  Left:   3.483"
.head 5 -  Top:    4.155"
.head 5 -  Width:  2.5"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 -  Message Actions
.head 3 +  Picture: pic1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.883"
.head 5 -  Top:    2.821"
.head 5 -  Width:  0.3"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  File Name: D:\BARS98\RESOURCE\BMP\help2.bmp
.head 4 -  Storage: External
.head 4 -  Picture Transparent Color: White
.head 4 -  Fit: Scale
.head 4 -  Scaling
.head 5 -  Width:  100
.head 5 -  Height:  100
.head 4 -  Corners: Square
.head 4 -  Border Style: No Border
.head 4 -  Border Thickness: 1
.head 4 -  Tile To Parent? No
.head 4 -  Border Color: Default
.head 4 -  Background Color: 3D Face Color
.head 4 +  Message Actions
.head 5 +  On SAM_TooltipSetText
.head 6 -  Set strMess = "'gl.bd'"
.head 6 -  Return XSalTooltipSetText(lParam, 'Тут можна передати значення параметрів, що вводяться за допомогою діалогового вікна, наприклад так: ":sFdat1='||strMess||'"')
.head 2 +  Functions
.head 3 +  Function: getOperFunc
.head 4 -  Description: составить ф-цию для выполнения
.head 4 +  Returns
.head 5 -  String:
.head 4 +  Parameters
.head 5 -  Number: nKodz
.head 5 -  String: sOutFileName
.head 5 -  Number: nRepType
.head 5 -  String: sParams
.head 5 -  Boolean: sAskParams
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Return 'ExportCatQuery('||SalNumberToStrX(nKodz,0)||',"'||sOutFileName||
          '",'||SalNumberToStrX(nRepType,0)||',"'||sParams||'",'||IifS(sAskParams, 'TRUE','FALSE')||')'
.head 2 +  Window Parameters
.head 3 -  Number: nKodz
.head 2 +  Window Variables
.head 3 -  Number: nFuncNewCode
.head 3 -  Number: nFetchRes
.head 3 -  Number: nRepType
.head 3 -  Number: nDatesCnt
.head 3 -  Number: nStartFinishFlg ! 1 - финиш дня, 0- старт 
.head 3 -  Number: nExecFlg
.head 3 -  String: funcName
.head 3 -  String: strMess
.head 3 -  String: strRole
.head 3 -  Number: nDefaultChecked
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow(hWndForm)
.head 4 -  Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
.head 4 -  Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_addToFunc.Title'))
.head 4 -  !
.head 4 -  Set lblFuncCode = CurrentLangTable.GetAtomTitle('dlg_addToFunc.lbFuncCode')
.head 4 -  Set lbFuncName = CurrentLangTable.GetAtomTitle('dlg_addToFunc.lbFuncName')
.head 4 -  Set lbFunc = CurrentLangTable.GetAtomTitle('dlg_addToFunc.lbFunc')
.head 4 -  Set lbRole = CurrentLangTable.GetAtomTitle('dlg_addToFunc.lbRole')
.head 4 -  Set lbReportType = CurrentLangTable.GetAtomTitle('dlg_addToFunc.lbReportType')
.head 4 -  !
.head 4 -  !
.head 4 -  Set cbParams = CurrentLangTable.GetAtomTitle('dlg_addToFunc.cbParams')
.head 4 -  Set cbOutFileName = CurrentLangTable.GetAtomTitle('dlg_addToFunc.cbOutFileName')
.head 4 -  Set cbAskParam = CurrentLangTable.GetAtomTitle('dlg_addToFunc.cbAskParam')
.head 4 -  Set cbAddToList = CurrentLangTable.GetAtomTitle('dlg_addToFunc.cbAddToList')
.head 4 -  Set cbMandatory = CurrentLangTable.GetAtomTitle('dlg_addToFunc.cbMandatory')
.head 4 -  Set rbStart = CurrentLangTable.GetAtomTitle('dlg_addToFunc.rbStart')
.head 4 -  Set rbFinish = CurrentLangTable.GetAtomTitle('dlg_addToFunc.rbFinish')
.head 4 -  !
.head 4 -  !
.head 4 -  Set cbAskParam = FALSE
.head 4 -  Set cbOutFileName = FALSE
.head 4 -  Set cbParams = FALSE
.head 4 -  Set cbAddToList = FALSE
.head 4 -  !
.head 4 -  Call SalDisableWindow(dfParams)
.head 4 -  Call SalDisableWindow(dfOutFileName)
.head 4 -  Call SalDisableWindow(rbStart)
.head 4 -  Call SalDisableWindow(rbFinish)
.head 4 -  Call SalDisableWindow(cbMandatory)
.head 4 -  !
.head 4 +  If SqlPrepareAndExecute(hSql(),
 "select name into :funcName from zapros where kodz = :nKodz")
.head 5 +  If SqlFetchNext(hSql(),nFetchRes)
.head 6 -  Set dfFuncCode  = nFuncNewCode
.head 5 +  Else
.head 6 -  Call SalMessageBox('Невозможно получить новый номер отчета', 'Внимание!',0 )
.head 4 -  Set dfFuncName = funcName
.head 4 -  Set dfParams = ''
.head 4 -  Set nRepType = 0
.head 4 -  Set dfFuncCode = nFuncNewCode
.head 4 -  Set dfFunc  = getOperFunc(nKodz,dfOutFileName,nRepType,dfParams, cbAskParam ) 
