.head 0 +  Application Description: Библиотека функций обработки данных для
РЦК "ПетроКоммерц-Украина"
---------------------------------------
Разработчик: Сыропоршнев Д.Л. 2002
.head 1 -  Outline Version - 4.0.26
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400800000
0020: 0000000000BA0000 002C000000020000 0003000000000000 0073020000FCFFFF
0040: FFDEFFFFFF000000 0000000000F10300 005D020000010000 0000000000010000
0060: 000F4170706C6963 6174696F6E497465 6D02000000075769 6E646F77730D646C
0080: 6752434B5F457870 6F7274
.enddata
.data DT_MAKERUNDLG
0000: 02000000001D433A 5C4261727339385C 4C4942524152595C 424152533031322E
0020: 6578651D433A5C42 61727339385C4C49 42524152595C4241 52533031322E646C
0040: 6C1D433A5C426172 7339385C4C494252 4152595C42415253 3031322E61706300
0060: 000101011D433A5C 4261727339385C4C 4942524152595C42 4152533031322E72
0080: 756E1D433A5C4261 727339385C4C4942 524152595C424152 533031322E646C6C
00A0: 1D433A5C42617273 39385C4C49425241 52595C4241525330 31322E6170630000
00C0: 010101175C426172 7339385C42696E5C 424152533031322E 617064175C426172
00E0: 7339385C42696E5C 424152533031322E 646C6C175C426172 7339385C42696E5C
0100: 424152533031322E 6170630000010101 1D433A5C42617273 39385C4C49425241
0120: 52595C4241525330 31322E61706C1D43 3A5C426172733938 5C4C494252415259
0140: 5C42415253303132 2E646C6C1D433A5C 4261727339385C4C 4942524152595C42
0160: 4152533031322E61 70630000010101
.enddata
.head 2 -  Outline Window State: Normal
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
.head 3 -  Left:   -0.013"
.head 3 -  Top:    0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.969"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 1018B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left:   4.15"
.head 3 -  Top:    1.885"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.073"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left:   0.575"
.head 3 -  Top:    0.094"
.head 3 -  Width:  5.063"
.head 3 -  Height: 2.719"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left:   6.388"
.head 3 -  Top:    0.729"
.head 2 -  Fully Qualified External References? Yes
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? Yes
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  Dynalib: Global.apd
.head 2 -  Dynalib: Absapi.apd
.head 2 -  Dynalib: Docview.apd
.head 2 -  Dynalib: Nsiapi.apd
.head 2 -  !
.head 2 -  File Include: Genfcls.apl
.head 2 -  File Include: Genlabel.apl
.head 2 -  File Include: GenButn.apl
.head 2 -  File Include: VtCal.apl
.head 2 -  File Include: VtMeter.apl
.head 2 -  File Include: Gentbl.apl
.head 2 -  File Include: XSALSPL.APL
.head 2 -  File Include: Xsalcpt.apl
.head 2 -  File Include: Genlist.apl
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: MS Sans Serif
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: System Default
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: 3D Face Color
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 2 +  External Functions
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 4 -  Number: UM_DetailsChanged = SAM_User + 300
.head 3 +  User
.head 4 -  !
.head 4 -  Number: RckLimit_ReadOnly     = 0
.head 4 -  Number: RckLimit_EditNoApply  = 1
.head 4 -  Number: RckLimit_NoEditApply  = 2
.head 4 -  Number: RckLimit_EditAndApply = 3
.head 2 +  Resources
.head 2 +  Variables
.head 3 -  Boolean: bApdInited
.head 3 -  Window Handle: hWndBU
.head 3 -  Window Handle: hWndLim
.head 3 -  Window Handle: hWndTek
.head 3 -  !
.head 3 -  : cFPlan
.head 4 -  Class: cFinancialPlan
.head 2 +  Internal Functions
.head 3 +  Function: Ini012
.head 4 -  Description: инициализация библиотеки
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  String: strPathToLangResources
.head 5 -  String: strLangId
.head 5 -  String: strFileName
.head 4 +  Actions
.head 5 +  If not bApdInited
.head 6 -  Set strPathToLangResources = GetLangPath()
.head 6 -  Set strLangId = GetLang()
.head 6 -  Set strFileName = strPathToLangResources || "\\" || strLangId || "\\bars012.lng"
.head 6 +  If (not strLangId) or (not CurrentLangTable.InitFromFile(strFileName, strLangId))
.head 7 -  Call CurrentLangTable.Init()
.head 6 -  Set bApdInited = TRUE
.head 5 -  Return bApdInited
.head 3 +  Function: Sel012			! __exported
.head 4 -  Description: Главная селекторная функция
.head 4 -  Returns
.head 4 +  Parameters
.head 5 -  Window Handle: hWndParent
.head 5 -  Number: nPar
.head 5 -  String: strPar1
.head 5 -  String: strPar2
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Call Ini012()
.head 5 +  Select Case nPar
.head 6 +  Case 0 !! Экспорт докуменетов из АБС для РЦК
.head 7 -  Call SalModalDialog( dlgRCK_Export, hWndParent )
.head 7 -  Break
.head 6 +  Case 1 !! Заполнение кредитовых доп.реквизитов
.head 7 +  If not IsWindow(hWndBU)
.head 8 -  Set hWndBU = SalCreateWindow( BU, hWndMDI, nPar, strPar1, strPar2 )
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( BU )
.head 7 -  Break
.head 6 +  Case 3 !! Редактирование финансовых планов
.head 7 +  If not IsWindow(hWndLim)
.head 8 -  Set hWndLim = SalCreateWindow( frmRCK_Limits, hWndMDI, nPar )
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( hWndLim )
.head 7 -  Break
.head 6 +  Case 13 !! Посмотреть текущее состояние установленных и использованных лимитов
.head 7 +  If not IsWindow(hWndTek)
.head 8 -  Set hWndTek = SalCreateWindow( tblRCK_Tek, hWndMDI, nPar )
.head 7 +  Else
.head 8 -  Call SalBringWindowToTop ( hWndTek )
.head 7 -  Break
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 3543233371
0000: A90000006A000000 0000000000000000 0200000100FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F22003C00 000A630047656E46
0040: 696C746500727400 00000400001E0002 0400C9000100003F 8001F80000003704
0060: 0001F00D000000FF 1F110000DC000200 FF7F157000000001 00FFFF01
.enddata
.head 3 -  !
.head 3 +  Functional Class: cFinancialPlan
.head 4 -  Description: Описание финансового плана
.head 4 -  Derived From
.head 4 -  Class Variables
.head 4 +  Instance Variables
.head 5 -  Number: nSchemaId
.head 5 -  Date/Time: dtActDate
.head 5 -  String: strPeriod
.head 5 -  Date/Time: dtDctDate
.head 5 -  Boolean: fActive
.head 4 -  Functions
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window:
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field:
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton: ctb_pbSwitch
.head 3 -  Radio Button:
.head 3 -  Option Button:
.head 3 -  Check Box:
.head 3 -  Child Table:
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture:
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column:
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control: cMeter
.head 2 -  Application Actions
.head 1 +  Dialog Box: dlgRCK_Export
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: РЦК Экспорт...
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Type of Dialog: Modal
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  7.617"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 3.345"
.head 4 -  Height Editable? Yes
.head 3 -  Absolute Screen Location? Yes
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Экспорт данных в РЦК
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Group Box: Отчетная Дата: 
.head 4 -  Resource Id: 60354
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.067"
.head 5 -  Top:    0.024"
.head 5 -  Width:  1.883"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.619"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Tahoma
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Custom Control: ccDate
.data CLASSPROPSSIZE
0000: 4400
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000001010101 0101000000000001 01000000000A6464 2F4D4D2F79797979
0040: 00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCalendarDropDown
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.183"
.head 6 -  Top:    0.262"
.head 6 -  Width:  1.6"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.262"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call GetMonthArrayRus( strCMonth )
.head 6 -  Call GetWeekDayArray( strCDays )
.head 6 -  Call ccDate.SetMonthText( strCMonth )
.head 6 -  Call ccDate.SetWeekDayText( strCDays )
.head 6 -  Call ccDate.WeekStartSet( 2 )
.head 6 -  !
.head 6 +  If SqlPrepareAndExecute( hSqlAux2(), 'SELECT fdat INTO :dtRepDate FROM fdat' )
.head 7 +  While SqlFetchNext( hSqlAux2(), nFetchRes )
.head 8 -  Call ccDate.SpecialDate( SPECIAL_OneTime, dtRepDate, DAY_Unset, SEQ_Unset, COLOR_Black, COLOR_White, TRUE )
.head 5 +  On SAM_CustControlCmd
.head 6 +  If wParam = 2
.head 7 -  Call SalGetWindowText( hWndItem, strChosenDate, 15 )
.head 7 +  If strChosenDate
.head 8 -  Set dtRepDate = SalFmtFormatStrDateTime( strChosenDate, 'dd/MM/yyyy' )
.head 8 -  Call SetFileName( strBankNum )
.head 8 +  If NOT ccDate.IsSpecialDate( SPECIAL_OneTime, dtRepDate, DAY_Unset, SEQ_Unset )
.head 9 -  Call SalMessageBeep( MB_IconAsterisk )
.head 9 -  Call SalMessageBox( 'Данные за выбранный день отсутсвуют!', 'Внимание!', MB_Ok | MB_IconAsterisk )
.head 3 -  Group Box: Тип экспорта: 
.head 4 -  Resource Id: 60355
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.983"
.head 5 -  Top:    0.024"
.head 5 -  Width:  3.667"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.619"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Tahoma
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Radio Button: rbBAL
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Остатки
.head 4 -  Window Location and Size
.head 5 -  Left:   2.2"
.head 5 -  Top:    0.274"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 9
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalHideWindow( ccMovements )
.head 6 -  Call SalSendMsg( ccAccounts,  UM_Update, 0, 0 )
.head 6 -  Call SalSendMsg( ccMovements, UM_Update, 0, 0 )
.head 6 -  Set strExtention = 'BAL'
.head 6 -  Call SetFileName(strBankNum)
.head 3 +  Radio Button: rbMVT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Движения
.head 4 -  Window Location and Size
.head 5 -  Left:   3.85"
.head 5 -  Top:    0.274"
.head 5 -  Width:  1.4"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Arial
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalShowWindow( ccMovements )
.head 6 -  Call SalSendMsg( ccAccounts,  UM_Update, 0, 0 )
.head 6 -  Call SalSendMsg( ccMovements, UM_Update, 0, 0 ) 
.head 6 -  Set strExtention = 'MVT'
.head 6 -  Call SetFileName(strBankNum)
.head 3 -  Group Box: Файл: 
.head 4 -  Resource Id: 60356
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.067"
.head 5 -  Top:    0.643"
.head 5 -  Width:  5.583"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.631"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Tahoma
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfFileName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.15"
.head 6 -  Top:    0.881"
.head 6 -  Width:  5.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.262"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Arial
.head 5 -  Font Size: 9
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbRun
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbExecute
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выполнить
.head 4 -  Window Location and Size
.head 5 -  Left:   5.75"
.head 5 -  Top:    0.167"
.head 5 -  Width:  1.617"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Enter
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalDisableWindow( ccDate )
.head 6 -  Call SalDisableWindow( rbBAL )
.head 6 -  Call SalDisableWindow( rbMVT )
.head 6 -  Call SalDisableWindow( dfFileName )
.head 6 -  Call SalEnableWindow( pbCancel )
.head 6 -  !
.head 6 -  Call ExportData( rbMVT )
.head 6 -  !
.head 6 -  Call SalDisableWindow( pbCancel )
.head 6 -  Call SalEnableWindow( dfFileName )
.head 6 -  Call SalEnableWindow( rbMVT )
.head 6 -  Call SalEnableWindow( rbBAL )
.head 6 -  Call SalEnableWindow( ccDate )
.head 3 +  Pushbutton: pbExit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbOk
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Выход
.head 4 -  Window Location and Size
.head 5 -  Left:   5.767"
.head 5 -  Top:    0.786"
.head 5 -  Width:  1.617"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Esc
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: D:\BARS98\RESOURCE\BMP\DISCARD.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalEndDialog( hWndForm, 0 )
.head 3 -  Group Box: Индикатор процесса: 
.head 4 -  Resource Id: 60357
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.083"
.head 5 -  Top:    1.286"
.head 5 -  Width:  7.283"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.655"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Tahoma
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 +  Custom Control: ccAccounts
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.217"
.head 6 -  Top:    1.571"
.head 6 -  Width:  6.983"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Royal Blue
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 +  Message Actions
.head 5 +  On UM_Update
.head 6 -  Call ccAccounts.SetProgress( lParam )
.head 3 +  Custom Control: ccMovements
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cMeter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.217"
.head 6 -  Top:    1.964"
.head 6 -  Width:  6.983"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.321"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Tahoma
.head 5 -  Font Size: 8
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Jade
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 +  Message Actions
.head 5 +  On UM_Update
.head 6 -  Call ccMovements.SetProgress( lParam )
.head 3 +  Pushbutton: pbCancel
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cpbCancel
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Window Location and Size
.head 5 -  Left:   2.9"
.head 5 -  Top:    2.357"
.head 5 -  Width:  1.617"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: Class Default
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Picture File Name: D:\BARS98\RESOURCE\BMP\APPLY.BMP
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalDisableWindow( pbCancel )
.head 5 +  On SAM_Click
.head 6 -  Set fCancel = TRUE
.head 2 +  Functions
.head 3 +  Function: SetFileName
.head 4 -  Description: Сформировать имя фала экспорта
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  String: sPar
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set dfFileName = strExportPath || '\\' || strPrefix || sPar || 
                 SalFmtFormatDateTime( dtRepDate, 'ddMM') || '.' || strExtention
.head 5 -  Return TRUE
.head 3 +  Function: ExportData
.head 4 -  Description: Формирование экспортных файлов
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 +  Parameters
.head 5 -  Boolean: fIsMovements
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nRckSchemaId
.head 5 -  File Handle: hFile
.head 5 -  String: strLine
.head 5 -  : TCustomerAcc
.head 6 -  Class: cABSConnect
.head 5 -  : TAccPayments
.head 6 -  Class: cABSConnect
.head 5 -  !
.head 5 -  String: strBAL_Mfo
.head 5 -  String: strBAL_Nls
.head 5 -  String: strBAL_Date
.head 5 -  String: strBAL_In
.head 5 -  String: strBAL_Dob
.head 5 -  String: strBAL_Kob
.head 5 -  String: strBAL_Out
.head 5 -  !
.head 5 -  Number: nNumAcc
.head 5 -  Number: nI
.head 5 -  Number: nAcc
.head 5 -  Number: nInOst
.head 5 -  Number: nOutOst
.head 5 -  Number: nDos
.head 5 -  Number: nKos
.head 5 -  Number: nKv
.head 5 -  String: strCcyISO
.head 5 -  Number: nCcyDig
.head 5 -  !
.head 5 -  String: strMVT_Summ
.head 5 -  String: strMVT_DK
.head 5 -  String: strMVT_ND
.head 5 -  String: strMVT_BKode
.head 5 -  String: strMVT_DDat
.head 5 -  String: strMVT_VDat
.head 5 -  String: strMVT_MFOB
.head 5 -  String: strMVT_BankB
.head 5 -  String: strMVT_AccB
.head 5 -  String: strMVT_NameB
.head 5 -  String: strMVT_Nazn
.head 5 -  !
.head 5 -  Number: nNumMvt
.head 5 -  Number: nJ
.head 5 -  Number: nDK
.head 5 -  Number: nS
.head 5 -  Number: nRef
.head 5 -  Number: nStmt
.head 5 -  Number: nAccB
.head 5 -  String: strTxt
.head 5 -  String: strMfoa
.head 5 -  String: strMfob
.head 5 -  String: strNlsa
.head 5 -  String: strNlsb
.head 5 -  String: strNama
.head 5 -  String: strNamb
.head 5 -  String: strOTT
.head 5 -  String: strPTT
.head 5 -  String: strTip
.head 4 +  Actions
.head 5 -  Call XConnectGetParams( TCustomerAcc )
.head 5 +  If not TCustomerAcc.Connect()
.head 6 -  Call SalMessageBeep( MB_IconStop )
.head 6 -  Call SalMessageBox( 'Экспорт не выполнен: Invalid outer cursor!', 'Внутренняя ошибка!', MB_Ok )
.head 6 -  Return FALSE
.head 5 +  If not TAccPayments.Clone( TCustomerAcc, TRUE )
.head 6 -  Call SalMessageBeep( MB_IconStop )
.head 6 -  Call SalMessageBox( 'Экспорт не выполнен: Invalid inner cursor!', 'Внутренняя ошибка!', MB_Ok )
.head 6 -  Return FALSE
.head 5 -  Call SqlPrepareAndExecute(hSql(), "select rck_schema_id into :nRckSchemaId from rck_schema")
.head 5 +  While SqlFetchNext(hSql(), nFetchRes)
.head 6 -  Call SqlPrepareAndExecute( TCustomerAcc.hSql(), 'SELECT count(*) INTO :nNumAcc FROM rck_accounts where rck_schema_id=:nRckSchemaId' )
.head 6 +  If SqlFetchNext( TCustomerAcc.hSql(), nFetchRes )
.head 7 -  ! Set nNumAcc = 0
.head 7 -  Call SetFileName(PadL('00'||Str(nRckSchemaId),2))
.head 7 +  If NOT SalFileOpen( hFile, dfFileName, OF_Create | OF_Write | OF_Text | OF_Share_Exclusive )
.head 8 -  Call SalMessageBeep( MB_IconStop )
.head 8 -  Call SalMessageBox( 'Не удается открыть файл ' || dfFileName || ' !', 'Внимание!', MB_Ok | MB_IconStop)
.head 8 -  ! Return FALSE
.head 7 +  Else
.head 8 -  Set strBAL_Mfo  = GetBankMfo()
.head 8 -  Set strBAL_Date = SalFmtFormatDateTime( dtRepDate, 'ddMMyyyy')
.head 8 -  !
.head 8 -  Call SalWaitCursor( TRUE )
.head 8 -  Call SalWaitCursor( FALSE )
.head 8 -  ! По счетам клиентов
.head 8 -  ! If nNumAcc
.head 8 -  Call SalWaitCursor( TRUE )
.head 8 +  If SqlPrepareAndExecute( TCustomerAcc.hSql(), 
     'SELECT a.nls, a.acc, t.kv, t.lcv, t.dig INTO :strBAL_Nls, :nAcc, :nKv, :strCcyISO, :nCcyDig  
      FROM rck_accounts c, accounts a, tabval t, cust_acc ca 
      WHERE c.acc = a.acc AND a.kv = t.kv AND ca.acc=a.acc AND c.rck_schema_id=:nRckSchemaId 
      ORDER BY ca.rnk' )
.head 9 -  Call SalWaitCursor( FALSE )
.head 9 -  Set nI = 0
.head 9 -  Set fCancel = FALSE
.head 9 -  Call SalSendMsg( ccAccounts, UM_Update, 0, SalNumberRound( nI/nNumAcc*100 ) )
.head 9 -  Call SalYieldStartMessages( pbCancel )
.head 9 +  While not fCancel and SqlFetchNext( TCustomerAcc.hSql(), nFetchRes )
.head 10 +  If NOT nCcyDig
.head 11 -  Set nCcyDig = 2
.head 10 -  ! Движения
.head 10 +  If fIsMovements
.head 11 -  Call SalWaitCursor( TRUE )
.head 11 -  Call SqlPrepareAndExecute( TAccPayments.hSql(), 'SELECT count(*) INTO :nNumMvt FROM opldok WHERE acc = :nAcc and fdat= :dtRepDate AND sos=5' )
.head 11 +  If NOT SqlFetchNext( TAccPayments.hSql(), nFetchRes )
.head 12 -  Set nNumMvt = 0
.head 11 -  Call SalWaitCursor( FALSE )
.head 11 +  If nNumMvt
.head 12 -  Call SalWaitCursor( TRUE )
.head 12 +  If SqlPrepareAndExecute( TAccPayments.hSql(), 
     "SELECT o.ref, o.stmt, o.s, o.dk, o.txt, p.nd, p.nazn, to_char(p.datd,'DDMMYYYY'), to_char(p.vdat,'DDMMYYYY'),
             p.mfoa, p.mfob, p.nlsa, p.nlsb, p.nam_a, p.nam_b, o.tt, p.tt  
      INTO :nRef, :nStmt, :nS, :nDK, :strTxt, :strMVT_ND, :strMVT_Nazn, :strMVT_DDat, :strMVT_VDat, 
           :strMfoa, :strMfob, :strNlsa, :strNlsb, :strNama, :strNamb, :strOTT, :strPTT   
      FROM opldok o, oper p WHERE o.ref=p.ref AND o.acc=:nAcc AND o.fdat= :dtRepDate AND o.sos=5 
      ORDER BY o.dk, o.s" )
.head 13 -  Set nJ = 0
.head 13 -  Call SalSendMsg( ccMovements, UM_Update, 0, SalNumberRound( nJ/nNumMvt*100 ) )
.head 13 -  Call SalWaitCursor( TRUE )
.head 13 +  While SqlFetchNext( TAccPayments.hSql(), nFetchRes )
.head 14 -  Set strMVT_DK = SalNumberToStrX( nDK, 0 )
.head 14 -  ! Бюджетный код
.head 14 -  ! Обнуление кода + изменены кода доп. реквизитов (Eve)
.head 14 -  Set strMVT_BKode = ''
.head 14 +  If nDK = 0
.head 15 +  If strPTT = strOTT OR strOTT = 'NOS'
.head 16 +  If SqlPrepareAndExecute( hSqlAux2(), "SELECT value INTO :strMVT_BKode FROM operw WHERE ref=:nRef AND tag='RCK_D'" )
.head 17 -  Call SqlFetchNext( hSqlAux2(), nFetchRes )
.head 15 -  ! Для дочерних операций
.head 15 +  Else
.head 16 +  If SqlPrepareAndExecute( hSqlAux2(), "SELECT val INTO :strMVT_BKode FROM op_rules WHERE tt=:strOTT AND tag='RCK_D'" )
.head 17 -  Call SqlFetchNext( hSqlAux2(), nFetchRes )
.head 14 +  Else
.head 15 +  If SqlPrepareAndExecute( hSqlAux2(), "SELECT value INTO :strMVT_BKode FROM operw WHERE ref=:nRef AND tag='RCK_K'" )
.head 16 -  Call SqlFetchNext( hSqlAux2(), nFetchRes )
.head 14 -  ! Разделитель только точка
.head 14 -  Set strMVT_Summ = VisStrSubstitute( SalNumberToStrX( nS  / SalNumberPower( 10, nCcyDig ), nCcyDig ), ',', '.' )
.head 14 -  Set strMVT_DK = SalNumberToStrX( nDK, 0 )
.head 14 +  If strPTT = strOTT
.head 15 +  If strBAL_Nls = strNlsa
.head 16 -  Set strMVT_MFOB = strMfob
.head 16 -  Set strMVT_AccB = strNlsb
.head 16 -  Set strMVT_NameB = strNamb
.head 15 +  Else
.head 16 -  Set strMVT_MFOB = strMfoa
.head 16 -  Set strMVT_AccB = strNlsa
.head 16 -  Set strMVT_NameB = strNama
.head 15 +  If strMVT_MFOB = strBAL_Mfo
.head 16 +  If SqlPrepareAndExecute( hSqlAux2(), 
'SELECT c.nmk INTO :strMVT_NameB 
 FROM accounts a, cust_acc ca, customer c 
 WHERE ca.acc=a.acc AND c.rnk=ca.rnk AND 
       a.nls=:strMVT_AccB AND a.kv=:nKv' )
.head 17 -  Call SqlFetchNext( hSqlAux2(), nFetchRes )
.head 14 +  Else
.head 15 -  Set strMVT_Nazn = strTxt
.head 15 +  If SqlPrepareAndExecute( hSqlAux2(), 
'SELECT a.nls, a.tip, c.nmk 
 INTO :strMVT_AccB, :strTip, :strMVT_NameB 
 FROM opldok o, accounts a, cust_acc ca, customer c 
 WHERE a.acc=o.acc AND ca.acc=a.acc AND c.rnk=ca.rnk AND 
       o.ref = :nRef AND o.stmt=:nStmt AND o.dk=1-:nDK' )
.head 16 -  Call SqlFetchNext( hSqlAux2(), nFetchRes )
.head 15 +  If strTip = 'KAS'
.head 16 -  Set strMVT_MFOB = 'CASH'
.head 16 -  Set strMVT_BankB = ''
.head 15 +  Else
.head 16 -  Set strMVT_MFOB = strBAL_Mfo
.head 14 +  If strMVT_MFOB != 'CASH' AND SqlPrepareAndExecute( hSqlAux2(), "SELECT nb INTO :strMVT_BankB FROM banks WHERE mfo=:strMVT_MFOB" )
.head 15 -  Call SqlFetchNext( hSqlAux2(), nFetchRes )
.head 14 -  Set strLine = 
    Left( strBAL_Mfo, 9 )   || '|' ||
    Left( strBAL_Nls, 14 )  || IifS(nKv=GetBaseVal(),'',Left(Str(nKv),3))|| '|' ||
    Left( strBAL_Date, 10 ) || '|' ||
    Left( strMVT_Summ, 17 ) || '|' ||
    Left( strMVT_DK, 1 )    || '|' ||
    Left( strMVT_ND, 10 )   || '|' ||
    Left( strMVT_BKode, 10 )|| '|' ||
    Left( strMVT_DDat, 10 ) || '|' ||
    Left( strMVT_VDat, 10 ) || '|' ||
    '|' ||
    Left( strMVT_MFOB, 9 )  || '|' ||
    Left( strMVT_BankB, 38 )|| '|' ||
    Left( strMVT_AccB, 14 ) || '|' ||
    '|'   ||
    Left( strMVT_NameB, 38 )|| '|' ||
    Left( strMVT_Nazn, 160 )|| '|' ||
    '|'
.head 14 -  Call SalFilePutStr( hFile, strLine )
.head 14 -  Set nJ = nJ + 1
.head 14 -  Call SalSendMsg( ccMovements, UM_Update, 0, SalNumberRound( nJ/nNumMvt*100 ) )
.head 12 -  Call SalWaitCursor( FALSE )
.head 10 -  ! Остатки с оборотами
.head 10 +  Else
.head 11 -  Call SalWaitCursor( TRUE )
.head 11 +  If SqlPrepareAndExecute( TAccPayments.hSql(), 
     'SELECT dos, kos, ost INTO :nDos, :nKos, :nOutOst  
      FROM sal 
      WHERE acc = :nAcc AND fdat = :dtRepDate ORDER BY nls, kv' )
.head 12 +  If SqlFetchNext( TAccPayments.hSql(), nFetchRes )
.head 13 -  Set nInOst = nOutOst + nDos - nKos
.head 13 -  ! Разделитель только точка
.head 13 -  Set strBAL_In  = VisStrSubstitute( SalNumberToStrX( nInOst  / SalNumberPower( 10, nCcyDig ), nCcyDig ), ',', '.' )
.head 13 -  Set strBAL_Dob = VisStrSubstitute( SalNumberToStrX( nDos    / SalNumberPower( 10, nCcyDig ), nCcyDig ), ',', '.' )
.head 13 -  Set strBAL_Kob = VisStrSubstitute( SalNumberToStrX( nKos    / SalNumberPower( 10, nCcyDig ), nCcyDig ), ',', '.' )
.head 13 -  Set strBAL_Out = VisStrSubstitute( SalNumberToStrX( nOutOst / SalNumberPower( 10, nCcyDig ), nCcyDig ), ',', '.' )
.head 13 -  !
.head 13 -  Set strLine = Left( strBAL_Mfo, 9 ) || '|' || Left( strBAL_Nls, 14 ) || IifS(nKv=GetBaseVal(),'',Left(Str(nKv),3))|| '|' ||
    Left( strBAL_Date, 10 ) || '|' ||
    Left( strBAL_In, 17 )   || '|' ||
    Left( strBAL_Dob, 17 )  || '|' ||
    Left( strBAL_Kob, 17 )  || '|' ||
    Left( strBAL_Out, 17 )
.head 13 -  Call SalFilePutStr( hFile, strLine )
.head 11 -  Call SalWaitCursor( FALSE )
.head 10 -  Set nI = nI + 1
.head 10 -  Call SalSendMsg( ccAccounts, UM_Update, 0, SalNumberRound( nI/nNumAcc*100 ) )
.head 9 -  Call SalYieldStopMessages( )
.head 8 -  Call SalFileClose( hFile )
.head 5 -  Call TAccPayments.Disconnect(  )
.head 5 -  Call TCustomerAcc.Disconnect(  )
.head 5 -  Call SalWaitCursor( FALSE )
.head 5 -  Call SalMessageBeep( MB_IconAsterisk )
.head 5 -  Call SalMessageBox( 'Экспорт завершен!', 'Внимание!', MB_Ok )
.head 5 -  Return TRUE
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  String: strPrefix
.head 3 -  String: strBankNum
.head 3 -  String: strExtention
.head 3 -  String: strExportPath
.head 3 -  !
.head 3 -  String: strChosenDate
.head 3 -  Date/Time: dtRepDate
.head 3 -  !
.head 3 -  String: strCMonth[12]
.head 3 -  String: strCDays[7]
.head 3 -  !
.head 3 -  Boolean: fCancel
.head 3 -  Number: nFetchRes
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Call SalCenterWindow( hWndForm )
.head 4 -  Set rbBAL = TRUE
.head 4 -  Set strExtention = 'BAL'
.head 4 -  Set strPrefix  = GetGlobalOption( 'RCK_FP' )
.head 4 +  If NOT strPrefix
.head 5 -  Set strPrefix = 'XX'
.head 4 -  Set strBankNum = GetGlobalOption( 'RCK_BN' )
.head 4 +  If NOT strBankNum
.head 5 -  Set strBankNum = 'FF'
.head 4 -  !
.head 4 -  Call SalUseRegistry( FALSE, GetCompanyName() )
.head 4 -  Call SalGetProfileString( 'RCK', 'ExportDir', GetPrnDir(), strExportPath, GetIniFileName() )
.head 4 +  If Right( strExportPath, 1 ) = '\\' OR Right( strExportPath, 1 ) = '/'
.head 5 -  Set strExportPath = Left(strExportPath, Len(strExportPath)-1)
.head 4 -  !
.head 4 -  Call SalSendMsg( ccDate, SAM_CustControlCmd, 2, 0)
.head 3 +  On SAM_CreateComplete
.head 4 -  Call SalWaitCursor( FALSE )
.head 1 +  Table Window: BU
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: КРЕДИТОВЫЙ симвод для документов РЦК
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   0.26"
.head 4 -  Top:    0.292"
.head 4 -  Width:  13.533"
.head 4 -  Width Editable? Class Default
.head 4 -  Height: 6.469"
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: 20000
.head 3 -  Discardable? Yes
.head 2 -  Description: Подбор кредитового символа бюджетирования
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Top
.head 4 -  Visible? Class Default
.head 4 -  Size: 1.427"
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.3"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If obK
.head 8 -  Set i = TBL_MinRow
.head 8 +  While SalTblFindNextRow(hWndForm, i, 0,0 )
.head 9 -  Call SalTblFetchRow(hWndForm, i )
.head 9 +  If BU.colB=2
.head 10 -  If SqlPrepareAndExecute( hSqlAux2(),
 "UPDATE operw SET value=:BU.KEKB WHERE ref=:BU.colREF AND tag='RCK_K' ")
.head 9 +  If BU.colB=3
.head 10 -  If SqlPrepareAndExecute( hSqlAux2(),
 "INSERT INTO operw (ref,tag,value)
  VALUES ("||Str(BU.colREF)||",'RCK_K',"||Str(BU.KEKB)||")")
.head 8 -  Call SqlCommit( hSqlAux2() )
.head 7 +  If obD
.head 8 -  Set i = TBL_MinRow
.head 8 +  While SalTblFindNextRow(hWndForm, i, 0,0 )
.head 9 -  Call SalTblFetchRow(hWndForm, i )
.head 9 +  If BU.colB=2
.head 10 +  If not SqlPLSQLCommand( hSqlAux2(), "BARS.RCK.CHANGE_RCK_D(BU.colAcc, BU.colREF, BU.colTT, '"||Str(BU.KEKBold)||"', '"||Str(BU.KEKB)||"')" )
.head 11 -  Call SqlRollback( hSqlAux2() )
.head 9 +  If BU.colB=3
.head 10 +  If not SqlPLSQLCommand( hSqlAux2(), "BARS.RCK.APPLY_RCK_D(BU.colAcc, BU.colREF, BU.colTT, '"||Str(BU.KEKB)||"')" )
.head 11 -  Call SqlRollback( hSqlAux2() )
.head 8 -  Call SqlCommit( hSqlAux2() )
.head 7 -  Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.867"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Yes
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Оригинал документа ...'
.head 6 +  On SAM_Click
.head 7 +  If SalTblAnyRows( hWndForm, ROW_Selected, 0 )
.head 8 -  Call DocViewContentsEx (hWndMDI, BU.colREF)
.head 4 -  !
.head 4 +  Data Field: REF
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.767"
.head 7 -  Top:    0.417"
.head 7 -  Width:  1.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.226"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: #0
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 9
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: TT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.567"
.head 7 -  Top:    0.417"
.head 7 -  Width:  0.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.229"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: STT
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.167"
.head 7 -  Top:    0.417"
.head 7 -  Width:  8.3"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.229"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: NLSA
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.767"
.head 7 -  Top:    0.667"
.head 7 -  Width:  1.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.229"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: 8
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: KVA
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.567"
.head 7 -  Top:    0.667"
.head 7 -  Width:  0.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.229"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: NAMA
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.167"
.head 7 -  Top:    0.667"
.head 7 -  Width:  8.3"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.229"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: NLSB
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.767"
.head 7 -  Top:    0.917"
.head 7 -  Width:  1.8"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.229"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: KVB
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   3.567"
.head 7 -  Top:    0.917"
.head 7 -  Width:  0.6"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.229"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: NAMB
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   4.167"
.head 7 -  Top:    0.917"
.head 7 -  Width:  8.3"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.229"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Data Field: NAZN
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   1.767"
.head 7 -  Top:    1.167"
.head 7 -  Width:  10.7"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.229"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.083"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.517"
.head 6 -  Top:    -0.012"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.567"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 30957
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.0"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   10.183"
.head 6 -  Top:    0.821"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? No
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 30958
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   4.914"
.head 6 -  Top:    0.073"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 30959
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  1.95"
.head 6 -  Begin Y:  -0.024"
.head 6 -  End X:  1.95"
.head 6 -  End Y:  0.44"
.head 5 -  Visible? No
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Data Field: dDATA
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Editable? Yes
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   0.083"
.head 7 -  Top:    0.071"
.head 7 -  Width:  1.467"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.321"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Center
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Font Name: Arial Cyr
.head 6 -  Font Size: 10
.head 6 -  Font Enhancement: Bold
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 +  Message Actions
.head 6 +  On SAM_Validate
.head 7 -  Set sdat=SalFmtFormatDateTime( dDATA,'MM-dd-yyyy' )
.head 7 -  Call SalSendMsg( pbRefresh, SAM_Click,0, 0 )
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.433"
.head 6 -  Top:    0.071"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Background Text: Референс:
.head 5 -  Resource Id: 30960
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.367"
.head 6 -  Top:    0.417"
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.229"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: Счет А:
.head 5 -  Resource Id: 30961
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.367"
.head 6 -  Top:    0.667"
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: Счет Б:
.head 5 -  Resource Id: 30962
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.367"
.head 6 -  Top:    0.917"
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.229"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 -  Background Text: Назначение:
.head 5 -  Resource Id: 30963
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.367"
.head 6 -  Top:    1.167"
.head 6 -  Width:  1.35"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.226"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Justify: Left
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 4 +  Option Button: obD
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Д
.head 5 -  Window Location and Size
.head 6 -  Left:   3.9"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: None
.head 5 -  Button Style: Radio
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSetWindowText( hWndForm, 'ДЕБЕТОВЫЙ символ для документов РЦК' )
.head 7 -  Set nDKSimv = 0
.head 7 -  Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Дебетовый символ' )
.head 4 +  Option Button: obK
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: К
.head 5 -  Window Location and Size
.head 6 -  Left:   4.329"
.head 6 -  Top:    0.073"
.head 6 -  Width:  0.43"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.317"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Bold
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: None
.head 5 -  Button Style: Radio
.head 5 -  Image Style: Single
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 -  Call SalSetWindowText( hWndForm, 'КРЕДИТОВЫЙ символ для документов РЦК' )
.head 7 -  Set nDKSimv = 1
.head 7 -  Call SalSendMsg( hWndForm, UM_Populate, 0, 0 )
.head 6 +  On SAM_TooltipSetText
.head 7 -  Return XSalTooltipSetText( lParam, 'Кредитовый символ' )
.head 2 +  Contents
.head 3 +  Column: colNLS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ЛицСчет
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 14
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.557"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colND
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: № докум
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.1"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colS
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Сумма
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.314"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KEKB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Символ
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 6
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.814"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 +  If SqlPrepareAndExecute( hSqlAux2(),
   "SELECT RCK_SYMBOL_ID||' '|| RCK_SYMBOL_NAME
    INTO :sKEKB
    FROM RCK_SYMBOL
    WHERE RCK_SYMBOL_ID = :KEKB and RCK_SYMBOL_DK =1 and 
          RCK_SCHEMA_ID = :IDP " ) 
and not SqlFetchNext( hSqlAux2(), nFetchRes )
.head 7 -  Set sKEKB='Ош !'
.head 7 -  Set KEKB = NUMBER_Null
.head 7 -  Return VALIDATE_Ok
.head 6 -  Set colB=FLAGI(colB)
.head 6 -  Return VALIDATE_Ok
.head 3 +  Column: sKEKB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
 символа
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.414"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 +  Message Actions
.head 5 +  On SAM_Validate
.head 6 -  !
.head 6 -  Set i = SalListQuerySelection( hWndItem)
.head 6 -  Set KEKB = IifN(i>=0, mB[i], 0)
.head 6 -  Set colB=FLAGI(colB)
.head 6 -  Return VALIDATE_Ok
.head 3 -  !
.head 3 +  Column: IDP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
ЦО
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: 3
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.571"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: sIDP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
Центра Ответственности
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.957"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Drop Down List
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? No
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? No
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: colVDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
ввода
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colPDAT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Дата
валют.
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Date/Time
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Date
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colTT
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ОП
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colREF
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: РЕФ
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colISP
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ISP
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colDK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ДК
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKVA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: KVA
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colKVB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: KVB
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNLSA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: NLSA
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNAMA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: NLSA
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNLSB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: NLSA
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNAMB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: NLSA
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colNAZN
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: NLSA
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colB
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ДК
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: colAcc
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ACC
.head 4 -  Visible? No
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Left
.head 4 -  Width:  1.05"
.head 4 -  Width Editable? Yes
.head 4 -  Format: #0
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KEKBold
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Символ
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: 6
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.814"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 +  Functions
.head 3 +  Function: FLAGI
.head 4 -  Description:
.head 4 +  Returns
.head 5 -  Number: FLAG
.head 4 +  Parameters
.head 5 -  Number: FLAG1
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: FLAG2
.head 4 +  Actions
.head 5 +  If FLAG1=NUMBER_Null !! вставка
.head 6 -  Set FLAG2=3
.head 5 +  Else If FLAG1=1 !! обновление
.head 6 -  Set FLAG2=2
.head 5 +  Else !! сохранить состояние флага
.head 6 -  Set FLAG2=FLAG1
.head 5 -  Return FLAG2
.head 2 +  Window Parameters
.head 3 -  Number: nPar
.head 3 -  String: strPar1
.head 3 -  String: strPar2
.head 2 +  Window Variables
.head 3 -  Number: nFetchRes
.head 3 -  !
.head 3 -  Number: nKV
.head 3 -  Number: nD1
.head 3 -  Number: nD
.head 3 -  String: sD
.head 3 -  String: ss1
.head 3 -  String: fs
.head 3 -  String: sdat
.head 3 -  Number: nI
.head 3 -  Number: i
.head 3 -  ! Number: mG[*]
.head 3 -  Number: mB[*]
.head 3 -  Number: nDKSimv
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow( hWndForm )
.head 4 -  Call SetWindowFullSize( hWndForm )
.head 4 -  Call SalTblSetLockedColumns( hWndForm, 3)
.head 4 -  Call BU.cF.Init( 'Accounts', 'a' )
.head 4 -  !
.head 4 -  Set nKV=GetBaseVal()
.head 4 -  Set dDATA=GetBankDate()
.head 4 -  Set sdat=SalFmtFormatDateTime( dDATA,'MM-dd-yyyy' )
.head 4 -  Call SalSetWindowText( hWndForm, 'КРЕДИТОВЫЙ символ для документов РЦК' )
.head 4 -  Set obK = TRUE
.head 4 -  Set nDKSimv = 1
.head 4 -  Call SalMapEnterToTab(TRUE)
.head 3 +  On UM_Populate		!! hSql()
.head 4 -  Call SalWaitCursor( TRUE )
.head 4 -  Set fs = cF.GetFilterWhereClause( FALSE )
.head 4 -  Set BU.strSqlPopulate =
"SELECT nd, tt, ref, kv, kv2, dk, s, nlsa, nam_a, nlsb, nam_b, nazn
 INTO :BU.colND,  :BU.colTT,  :BU.colREF,:BU.colKVA,
      :BU.colKVB, :BU.colDK,  :BU.colS,  :BU.colNLSA,:BU.colNAMA,
      :BU.colNLSB,:BU.colNAMB,:BU.colNAZN
 FROM oper  WHERE ref in
(select p.ref
 from accounts a, opldok p, RCK_ACCOUNTS b
 where "||IifS(fs !="",fs||" and ","")||
       "a.acc=p.acc AND p.sos=5 AND a.acc=b.acc AND p.fdat= :sdat and p.dk=:nDKSimv )"
.head 4 -  Call SalTblPopulate( hWndForm, hSql(), T( BU.strSqlPopulate ||" ORDER BY 3"), TBL_FillAll )
.head 4 -  Call SalTblSetContext( hWndForm, 0 )
.head 4 -  Call SalTblSetRowFlags( hWndForm, 0, ROW_Selected, TRUE )
.head 4 -  Call SalSendMsg( hWndForm, SAM_TblDoDetails, 0,0)
.head 4 -  Call SalWaitCursor( FALSE )
.head 3 +  On SAM_FetchRowDone	!! hSqlAux2()
.head 4 -  If SqlPrepareAndExecute( hSqlAux2(),
   "SELECT o.acc, o.nls, b1.RCK_SCHEMA_ID, b1.RCK_SCHEMA_NAME
    INTO :colAcc, :colNLS,:IDP,:sIDP 
    FROM opl o, RCK_ACCOUNTS b , RCK_SCHEMA b1 
    WHERE o.ref=:colREF AND o.acc=b.acc AND
          b.RCK_SCHEMA_ID=b1.RCK_SCHEMA_ID and o.dk=:nDKSimv " ) 
and SqlFetchNext( hSqlAux2(), nFetchRes )
.head 4 -  !
.head 4 -  ! If SqlPrepareAndExecute( hSqlAux2(),
   "SELECT to_number(w.value),  RCK_SYMBOL_NAME , 1, to_number(w.value)
    INTO :KEKB, :sKEKB, :colB, :KEKBold 
    FROM operw w, RCK_SYMBOL  b
    WHERE  w.ref=:colREF AND w.tag='RCK_K' AND
       to_number(w.value) = b.RCK_SYMBOL_ID AND b.RCK_SCHEMA_ID =:IDP ") 
 and SqlFetchNext( hSqlAux2(), nFetchRes )
.head 4 -  If SqlPrepareAndExecute( hSqlAux2(),
   "SELECT to_number(w.value),  RCK_SYMBOL_NAME , 1, to_number(w.value)
    INTO :KEKB, :sKEKB, :colB, :KEKBold 
    FROM operw w, RCK_SYMBOL  b
    WHERE  w.ref=:colREF AND w.tag="||IifS(obK=TRUE,"'RCK_K'","'RCK_D'") ||" AND
       to_number(w.value) = b.RCK_SYMBOL_ID AND b.RCK_SCHEMA_ID =:IDP ") 
 and SqlFetchNext( hSqlAux2(), nFetchRes )
.head 4 -  !
.head 3 +  On SAM_TblDoDetails	!! hSqlAux()
.head 4 -  Set REF=colREF
.head 4 -  Set TT=colTT
.head 4 +  If SqlPrepareAndExecute( hSqlAux(),
  "SELECT t.name INTO :STT FROM tts t WHERE tt=:colTT ") 
and  SqlFetchNext( hSqlAux(), nFetchRes )
.head 5 -  Set NLSA=colNLSA
.head 5 -  Set KVA=colKVA
.head 5 -  Set NAMA=colNAMA
.head 5 -  Set NLSB=colNLSB
.head 5 -  Set KVB=colKVB
.head 5 -  Set NAMB=colNAMB
.head 5 -  Set NAZN=colNAZN
.head 4 -  !
.head 4 +  If SqlPrepareAndExecute(hSqlAux(),
"SELECT RCK_SYMBOL_ID, RCK_SYMBOL_ID||' '||RCK_SYMBOL_NAME 
 INTO :nD,:sD FROM RCK_SYMBOL 
 WHERE RCK_SYMBOL_DK ="||IifS(obK=TRUE,"1","0")||" and RCK_SCHEMA_ID=:IDP
 ORDER by 1")
.head 5 -  Set i=0
.head 5 -  Call SalArraySetUpperBound(mB, 1, -1)
.head 5 -  Call SalListClear(sKEKB)
.head 5 +  While SqlFetchNext(hSqlAux(), nI)
.head 6 -  Call SalListAdd(sKEKB, sD)
.head 6 -  Set mB[i]=nD
.head 6 -  Set i=i+1
.head 1 +  Form Window: frmRCK_Limits
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Yes
.head 2 -  Visible? No
.head 2 -  Display Settings
.head 3 -  Display Style? Etched
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   -1.35"
.head 4 -  Top:    0.625"
.head 4 -  Width:  15.9"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 7.048"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Установка и манипулирование лимитами по схемам
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: 0.405"
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbAdd
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbInsert
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.067"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Добавить новый план '
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( tblPlanList, UM_Insert, 0, 0 )
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDelete
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.5"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Удалить существующий план запись'
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( tblPlanList, UM_Delete, 0, 0 )
.head 4 +  Pushbutton: pbSave
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbUpdate
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.933"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Сохранить изменения в планах и лимитах'
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( hWndTable, UM_Update, 0, 0 )
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbRefresh
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   1.367"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Перечитать...'
.head 6 +  On SAM_Click
.head 7 -  Call SalSendMsg( hWndTable, UM_Populate, 0, 0 )
.head 4 -  Line
.head 5 -  Resource Id: 36322
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  1.917"
.head 6 -  Begin Y:  0.012"
.head 6 -  End X:  1.917"
.head 6 -  End Y:  0.417"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbApply
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbExecute
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.067"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 -  ! Выполняется по требованию или автоматически на смене даты (ИВАН)
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Преобразовать план в лимиты на счетах'
.head 6 +  On SAM_Click
.head 7 +  If SalMessageBox("Обновить ЛИМИТЫ согласно планам ? ",
"Предыдущие значения лимитов будут уничтожены ! ", MB_IconQuestion | MB_YesNo) = IDYES
.head 8 +  If SqlPLSQLCommand(hSql(), "rck.AKT_FINPLAN( tblPlanList.colPlanId, sErr )") 
.head 9 -  Set sErr = "RCK  - Лимиты установлены " 
.head 9 -  Call SqlCommitEx(hSql(),sErr)
.head 9 -  Call MessageNoWait( sErr, '' , 2 , 0 )
.head 9 -  Call SalSendMsg( tblPlanList, UM_Populate, 0, 0 )
.head 8 +  Else
.head 9 -  Call SqlRollback(hSql())
.head 9 -  Call MessageNoWait( sErr , 'Ошибка', 0, 1)
.head 4 +  Pushbutton: pbDetail
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbDetail
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.567"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Посмотреть текущее состояние установленных и использованных лимитов'
.head 6 +  On SAM_Click
.head 7 -  Call Sel012( hWndMDI, 13, '', '' )
.head 4 -  Line
.head 5 -  Resource Id: 36323
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Coordinates
.head 6 -  Begin X:  3.067"
.head 6 -  Begin Y:  -0.012"
.head 6 -  End X:  3.067"
.head 6 -  End Y:  0.393"
.head 5 -  Visible? Yes
.head 5 -  Line Style: Etched
.head 5 -  Line Thickness: 1
.head 5 -  Line Color: 3D Shadow Color
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: ctb_pbCancel
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   3.2"
.head 6 -  Top:    0.048"
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Set strTip = 'Закончить работу и закрыть окно'
.head 6 +  On SAM_Click
.head 7 -  Call SalDestroyWindow( hWndForm )
.head 4 +  ! Data Field: NMK
.winattr
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   7.217"
.head 7 -  Top:    0.131"
.head 7 -  Width:  6.083"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Left
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.end
.head 5 -  Message Actions 
.head 4 +  Combo Box: cmb_KV
.data INHERITPROPS
0000: 0100
.enddata
.data CLASSPROPS
0000: 5461624368696C64 4E616D6573000600 4E616D65330000
.enddata
.data CLASSPROPSSIZE
0000: 1700
.enddata
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenComboBox_NumId
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Window Location and Size
.head 6 -  Left:   9.683"
.head 6 -  Top:    0.107"
.head 6 -  Width:  3.017"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.429"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Editable? Yes
.head 5 -  String Type: String
.head 5 -  Maximum Data Length: 35
.head 5 -  Sorted? No
.head 5 -  Always Show List? No
.head 5 -  Vertical Scroll? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 5 -  List Initialization
.head 5 +  Message Actions
.head 6 +  On SAM_Create
.head 7 -  Call cmb_KV.Init(hWndItem)
.head 7 -  Call cmb_KV.Populate(hSql(),
"KV","LCV||'/'||NAME","TABVAL"," ORDER BY decode(kv,980,1,2), kv desc")
.head 7 -  Call SalListSetSelect(cmb_KV,0)
.head 7 -  ! Call SalSendMsg(cmb_KV, SAM_Click, 0, 0)
.head 6 +  On SAM_Click
.head 7 -  Set nKv = cmb_KV.GetKey(SalListQuerySelection(hWndItem))
.head 7 -  Call SalSendMsg( tblPlanRec, UM_Populate, 0, 0 )
.head 4 +  Check Box: cb_KV
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title: Все валюты
.head 5 -  Window Location and Size
.head 6 -  Left:   12.9"
.head 6 -  Top:    0.131"
.head 6 -  Width:  2.433"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.25"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 +  Message Actions
.head 6 +  On SAM_Click
.head 7 +  If cb_KV
.head 8 -  Call SalDisableWindow( cmb_KV )
.head 7 +  Else
.head 8 -  Call SalEnableWindow( cmb_KV )
.head 7 -  Call SalSendMsg( tblPlanRec, UM_Populate, 0, 0 )
.head 4 +  Data Field: dNP
.head 5 -  Class Child Ref Key: 0
.head 5 -  Class ChildKey: 0
.head 5 -  Class:
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Data
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Editable? No
.head 5 -  Display Settings
.head 6 -  Window Location and Size
.head 7 -  Left:   8.833"
.head 7 -  Top:    0.107"
.head 7 -  Width:  0.833"
.head 7 -  Width Editable? Yes
.head 7 -  Height: 0.25"
.head 7 -  Height Editable? Yes
.head 6 -  Visible? Yes
.head 6 -  Border? Yes
.head 6 -  Justify: Right
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Font Name: Default
.head 6 -  Font Size: Default
.head 6 -  Font Enhancement: Default
.head 6 -  Text Color: Default
.head 6 -  Background Color: Default
.head 6 -  Input Mask: Unformatted
.head 5 -  Message Actions
.head 2 +  Contents
.head 3 +  Custom Control: cVSplt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalVSplitter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   2.083"
.head 6 -  Top:    0.19"
.head 6 -  Width:  6.7"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 4.464"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Yes
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Custom Control: cHSplt
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalHSplitter
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.133"
.head 6 -  Top:    0.071"
.head 6 -  Width:  6.817"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 6.107"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Yes
.head 5 -  Etched Border? Yes
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Custom Control: cHSpltSub
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cXSalHSplitterInvisible
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.317"
.head 6 -  Top:    0.179"
.head 6 -  Width:  6.5"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 2.881"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 -  Message Actions
.head 3 +  Custom Control: ccDate
.data CLASSPROPSSIZE
0000: 4400
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010001
0020: 0200000000010101 0000000000000000 01000000000A6464 2F4D4D2F79797979
0040: 00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cCalendarDropDown
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  DLL Name:
.head 5 -  MS Windows Class Name:
.head 5 -  Style:  Class Default
.head 5 -  ExStyle:  Class Default
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   0.4"
.head 6 -  Top:    0.286"
.head 6 -  Width:  2.633"
.head 6 -  Width Editable? Class Default
.head 6 -  Height: 0.262"
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Border? Class Default
.head 5 -  Etched Border? Class Default
.head 5 -  Hollow? Class Default
.head 5 -  Vertical Scroll? Class Default
.head 5 -  Horizontal Scroll? Class Default
.head 5 -  Tab Stop? Class Default
.head 5 -  Tile To Parent? Class Default
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 12
.head 5 -  Font Enhancement: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  DLL Settings
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call GetMonthArrayRus( strCMonth )
.head 6 -  Call GetWeekDayArray( strCDays )
.head 6 -  Call ccDate.SetMonthText( strCMonth )
.head 6 -  Call ccDate.SetWeekDayText( strCDays )
.head 6 -  Call ccDate.WeekStartSet( 2 )
.head 6 -  Set strChsnDate = SalFmtFormatDateTime( SalDateCurrent(), 'dd/MM/yyyy' )
.head 5 +  On SAM_CustControlCmd
.head 6 +  If wParam = 2
.head 7 -  Call SalGetWindowText( hWndItem, strChsnDate, 15 )
.head 7 -  Call SalSendMsg( tblPlanList, UM_Populate, 0, 0 )
.head 3 +  Child Table: tblPlanList
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.267"
.head 6 -  Top:    0.714"
.head 6 -  Width:  6.583"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 2.333"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 9
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: Default
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colPlanId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Фин.
План
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  1.2"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSchemaId
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colActDate
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
начала
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.4"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colDeactDate
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Дата
окончания
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Date/Time
.head 6 -  Justify: Center
.head 6 -  Width:  1.517"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Date
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colPeriod
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title:
.head 6 -  Visible? No
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  Default
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colActive
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Фл.
Акт
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Left
.head 6 -  Width:  0.65"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Check Box
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value: 1
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 -  Window Variables
.head 4 +  Message Actions
.head 5 +  On SAM_Create
.head 6 -  Call SalPostMsg( tblPlanList, UM_Populate, 0, 0 )
.head 5 +  On UM_Populate
.head 6 +  If strT1Populate
.head 7 -  Call SalTblPopulate( tblPlanList, hSql(), strT1Populate, TBL_FillAll )
.head 7 -  Call SalSendMsg( tblPlanList, SAM_TblDoDetails, 0, 0 )
.head 7 -  Call SalSetFocus( tblPlanList )
.head 5 +  On UM_Insert
.head 6 -  Call SalTblInsertRow( tblPlanList, TBL_MaxRow )
.head 5 +  On UM_Delete
.head 6 +  If SalTblQueryRowFlags( tblPlanList, SalTblQueryContext( tblPlanList ), ROW_New )
.head 7 -  Call SalTblDeleteRow( tblPlanList, SalTblQueryContext( tblPlanList ), TBL_Adjust )
.head 6 +  Else If SalTblQueryRowFlags( tblPlanList, SalTblQueryContext( tblPlanList ), ROW_MarkDeleted )
.head 7 -  Call SalTblSetRowFlags( tblPlanList, SalTblQueryContext( tblPlanList ), ROW_MarkDeleted, FALSE )
.head 6 +  Else
.head 7 -  Call SalTblSetRowFlags( tblPlanList, SalTblQueryContext( tblPlanList ), ROW_MarkDeleted, TRUE )
.head 5 +  On UM_Update
.head 6 +  If strT1Insert
.head 7 +  If SqlPrepare( hSqlAux(), strT1Insert )
.head 8 -  Call SalTblDoInserts( tblPlanList, hSqlAux(), TRUE )
.head 6 +  If strT1Delete
.head 7 +  If SqlPrepare( hSqlAux(), strT1Delete )
.head 8 -  Call SalTblDoDeletes( tblPlanList, hSqlAux(), ROW_MarkDeleted )
.head 6 +  If strT1Update
.head 7 +  If SqlPrepare( hSqlAux(), strT1Update )
.head 8 -  Call SalTblDoUpdates( tblPlanList, hSqlAux(), TRUE )
.head 6 -  Call SqlCommitEx( hSqlAux(), 'Изменение финансовых планов' )
.head 6 -  Call SalSendMsg( tblPlanList, UM_Populate, 0, 0 )
.head 5 +  On SAM_TblDoDetails
.head 6 -  Set cFPlan.nSchemaId = colSchemaId
.head 6 -  Set cFPlan.dtActDate = colActDate
.head 6 -  Set cFPlan.dtDctDate = colDeactDate
.head 6 -  Set cFPlan.strPeriod = colPeriod
.head 6 -  Set cFPlan.fActive   = colActive
.head 6 -  Call SalSendMsg( frmRCK_SubScr, UM_Populate, 0, 0 )
.head 6 -  Set cb_KV = TRUE
.head 6 -  Call SalDisableWindow( cmb_KV )
.head 6 -  Call SalSendMsg( tblPlanRec, UM_Populate, 0, 0 )
.head 5 +  On SAM_SetFocus
.head 6 -  Set hWndTable = tblPlanList
.head 6 -  Call SalEnableWindow( pbAdd )
.head 6 -  Call SalEnableWindow( pbDel )
.head 5 +  On UM_DetailsChanged
.head 6 -  Set colSchemaId = cFPlan.nSchemaId
.head 6 -  Set colActDate = cFPlan.dtActDate 
.head 6 -  Set colDeactDate = cFPlan.dtDctDate
.head 6 -  Set colPeriod = cFPlan.strPeriod
.head 6 -  ! Set colActive = cFPlan.fActive
.head 6 -  Call SalTblSetRowFlags( tblPlanList, SalTblQueryContext( hWndItem ), ROW_Edited, TRUE )
.head 3 +  Child Table: tblPlanRec
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   7.167"
.head 6 -  Top:    0.131"
.head 6 -  Width:  8.367"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 5.298"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 9
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  View: Table
.head 5 -  Allow Row Sizing? No
.head 5 -  Lines Per Row: Default
.head 4 -  Memory Settings
.head 5 -  Maximum Rows in Memory: 1000
.head 5 -  Discardable? Yes
.head 4 +  Contents
.head 5 +  Column: colKV
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
Вал
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  0.567"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSymbID
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Код
символа
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  1.25"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  Column: colSymbName
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Наименование
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: String
.head 6 -  Justify: Left
.head 6 -  Width:  3.483"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 5 +  ! Column: colDK
.winattr
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Д/К
.head 6 -  Visible? Yes
.head 6 -  Editable? No
.head 6 -  Maximum Data Length: 1
.head 6 -  Data Type: String
.head 6 -  Justify: Center
.head 6 -  Width:  0.417"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.end
.head 6 -  List Values 
.head 6 -  Message Actions 
.head 5 +  Column: colLimit
.head 6 -  Class Child Ref Key: 0
.head 6 -  Class ChildKey: 0
.head 6 -  Class:
.head 6 -  Property Template:
.head 6 -  Class DLL Name:
.head 6 -  Title: Лимит
"коп"
.head 6 -  Visible? Yes
.head 6 -  Editable? Yes
.head 6 -  Maximum Data Length: Default
.head 6 -  Data Type: Number
.head 6 -  Justify: Right
.head 6 -  Width:  1.717"
.head 6 -  Width Editable? Yes
.head 6 -  Format: Unformatted
.head 6 -  Country: Default
.head 6 -  Input Mask: Unformatted
.head 6 -  Cell Options
.head 7 -  Cell Type? Standard
.head 7 -  Multiline Cell? No
.head 7 -  Cell DropDownList
.head 8 -  Sorted? Yes
.head 8 -  Vertical Scroll? Yes
.head 8 -  Auto Drop Down? No
.head 8 -  Allow Text Editing? Yes
.head 7 -  Cell CheckBox
.head 8 -  Check Value:
.head 8 -  Uncheck Value:
.head 8 -  Ignore Case? Yes
.head 6 -  List Values
.head 6 -  Message Actions
.head 4 -  Functions
.head 4 +  Window Variables
.head 5 -  Number: nRow
.head 5 -  Number: nExist
.head 5 -  Boolean: FL2
.head 4 +  Message Actions
.head 5 +  On SAM_SetFocus
.head 6 -  Set hWndTable = tblPlanRec
.head 6 -  Call SalDisableWindow( pbAdd )
.head 6 -  Call SalDisableWindow( pbDel )
.head 5 +  On UM_Populate
.head 6 -  ! Население второй таблицы
.head 6 -  Set dNP = tblPlanList.colPlanId
.head 6 -  Call SalTblPopulate( tblPlanRec, hSql(), strT2Populate || IifS( cb_KV,""," and t.kv=:nKv")||
" order by s.rck_symbol_id, t.kv ", TBL_FillAll )
.head 5 +  ! On SAM_FetchRowDone
.head 6 +  ! If colDK = '0'
.head 7 -  Set colDK = 'Д'
.head 6 +  ! Else
.head 7 -  Set colDK = 'K'
.head 5 +  On UM_Update
.head 6 -  Set nRow = TBL_MinRow
.head 6 -  Set FL2 = TRUE
.head 6 +  While SalTblFindNextRow( tblPlanRec, nRow, ROW_Edited, 0 )
.head 7 -  Call SalTblSetContext( tblPlanRec, nRow )
.head 7 -  If SqlPLSQLCommand(hSql(), 
"rck.LIM_FINPLAN
 (tblPlanList.colActive, dNP, tblPlanRec.colSymbID, tblPlanRec.colKV, tblPlanRec.colLimit )") 
.head 7 +  Else
.head 8 -  Set FL2 = FALSE
.head 8 -  Call SqlRollback(hSql())
.head 8 -  Break
.head 6 +  If FL2
.head 7 -  Call SqlCommitEx( hSqlAux(), 'Изменение содержания финансового плана id=' ||  Str(dNP) )
.head 7 -  Call SalSendMsg( hWndItem, UM_Populate, 0, 0 )
.head 6 +  Else
.head 7 -  Call SqlRollbackEx( hSqlAux(), 'Ош.Изменение финансового плана id=' || Str(dNP) )
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nEditMode
.head 2 +  Window Variables
.head 3 -  String: strT1Populate
.head 3 -  String: strT2Populate
.head 3 -  String: strT1Delete
.head 3 -  String: strT2Delete
.head 3 -  String: strT1Insert
.head 3 -  String: strT2Insert
.head 3 -  String: strT1Update
.head 3 -  String: strT2Update
.head 3 -  !
.head 3 -  String: strChsnDate
.head 3 -  String: strWinTitle
.head 3 -  Window Handle: hWndTable
.head 3 -  !
.head 3 -  String: strCMonth[12]
.head 3 -  String: strCDays[7]
.head 3 -  Number: nFetchRes
.head 3 -  ! от Суховой
.head 3 -  Boolean: bOPL 
.head 3 -  Number: nRow
.head 3 -  Number: nKv
.head 3 -  String: sErr
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call cVSplt.setLeftFrame ( cHSplt )
.head 4 -  Call cVSplt.setRightFrame( tblPlanRec )
.head 4 -  Call cVSplt.setBarPosition( 930 )
.head 4 -  Call cVSplt.setStyle( XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE )
.head 4 -  Call cHSplt.setTopFrame( cHSpltSub )
.head 4 -  Call cHSplt.setBottomFrame( SalCreateWindowEx( frmRCK_SubScr, hWndForm, 0,0,0,0, CREATE_AsChild ) )
.head 4 -  Call cHSplt.setBarPosition( 450 )
.head 4 -  Call cHSpltSub.setTopFrame( ccDate )
.head 4 -  Call cHSpltSub.setBottomFrame( tblPlanList )
.head 4 -  Call cHSpltSub.setBarPosition( 130 )
.head 4 -  Call cHSpltSub.setStyle( XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE )
.head 4 -  Call cHSplt.setBarSize( 2 )
.head 4 -  !
.head 4 -  ! Process Run Mode parameter
.head 4 +  Select Case nEditMode
.head 5 +  Case RckLimit_ReadOnly
.head 6 -  Call SalDisableWindow( pbAdd )
.head 6 -  Call SalDisableWindow( pbDel )
.head 6 -  Call SalDisableWindow( pbSave )
.head 6 -  Call SalDisableWindow( pbApply )
.head 6 -  Set strWinTitle = 'Просмотр финансовых планов'
.head 6 -  Break
.head 5 +  Case RckLimit_EditNoApply
.head 6 -  Call SalDisableWindow( pbApply )
.head 6 -  Set strWinTitle = 'Редактирование финансовых планов'
.head 6 -  Break
.head 5 +  Case RckLimit_NoEditApply
.head 6 -  Call SalDisableWindow( pbAdd )
.head 6 -  Call SalDisableWindow( pbDel )
.head 6 -  Call SalDisableWindow( pbSave )
.head 6 -  Set strWinTitle = 'Активирование финансовых планов'
.head 6 -  Break
.head 5 +  Default
.head 6 -  Set strWinTitle = 'Редактирование и активирование финансовых планов'
.head 6 -  Break
.head 4 -  !
.head 4 -  Set strT1Populate = 
"SELECT rck_fp_id, rck_schema_id, rck_fp_sdate, rck_fp_edate, 
        rck_fp_period, rck_fp_active
 INTO   :tblPlanList.colPlanId, :tblPlanList.colSchemaId, :tblPlanList.colActDate, :tblPlanList.colDeactDate,
        :tblPlanList.colPeriod, :tblPlanList.colActive
 FROM rck_finplan 
 WHERE TO_DATE(:strChsnDate, 'DD/MM/YYYY') BETWEEN rck_fp_sdate AND rck_fp_edate"
.head 4 -  !
.head 4 -  Set strT1Insert = 
"INSERT INTO rck_finplan 
 (rck_fp_id, rck_schema_id, rck_fp_sdate, rck_fp_edate, rck_fp_period, rck_fp_active) 
 VALUES 
 (:tblPlanList.colPlanId, :tblPlanList.colSchemaId, :tblPlanList.colActDate, :tblPlanList.colDeactDate,
  :tblPlanList.colPeriod, 0 )"
.head 4 -  !
.head 4 -  Set strT1Delete = "DELETE FROM rck_finplan WHERE rck_fp_id = :tblPlanList.colPlanId"
.head 4 -  !
.head 4 -  Set strT1Update = 
"UPDATE rck_finplan SET 
 rck_schema_id = :tblPlanList.colSchemaId, 
 rck_fp_sdate  = :tblPlanList.colActDate,
 rck_fp_edate  = :tblPlanList.colDeactDate,
 rck_fp_period = :tblPlanList.colPeriod  
 WHERE rck_fp_id = :tblPlanList.colPlanId"
.head 4 -  ! Население второй таблицы
.head 4 -  Set strT2Populate = 
"SELECT s.rck_symbol_id, s.rck_symbol_name, t.kv, 
 (SELECT r.rck_limit 
  FROM rck_finplanrec r 
  WHERE r.rck_fp_id=p.rck_fp_id AND 
        r.rck_symbol_id=s.rck_symbol_id) 
 INTO :tblPlanRec.colSymbID, 
      :tblPlanRec.colSymbName, 
      :tblPlanRec.colKV,
      :tblPlanRec.colLimit
 FROM rck_finplan p, rck_symbol s, tabval t 
 WHERE s.rck_schema_id = p.rck_schema_id AND 
       p.rck_fp_id = :tblPlanList.colPlanId and s.rck_symbol_dk = 0"
.head 4 -  !
.head 4 -  Set hWndTable = tblPlanList
.head 4 -  Call XSalTooltipSetUserDefault(  )
.head 4 -  Call SalSetWindowText( hWndForm, strWinTitle )
.head 4 -  Call SetWindowFullSize( hWndForm )
.head 3 +  On UM_DetailsChanged
.head 4 -  Call SalSendMsg( tblPlanList, UM_DetailsChanged, 0, 0 )
.head 1 +  Form Window: frmRCK_SubScr
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? Yes
.head 3 -  Minimizable? Yes
.head 3 -  System Menu? Yes
.head 3 -  Resizable? Yes
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  6.383"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.988"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description: Пдочиненная оконная форма для установки лимитов
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 -  Group Box: Схема 
.head 4 -  Resource Id: 39520
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    0.071"
.head 5 -  Width:  5.967"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.905"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: Код схемы
.head 4 -  Resource Id: 39521
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    0.333"
.head 5 -  Width:  1.267"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Наименование
.head 4 -  Resource Id: 39522
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.517"
.head 5 -  Top:    0.333"
.head 5 -  Width:  1.85"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.167"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfSchemaId
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Number
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    0.548"
.head 6 -  Width:  1.117"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.274"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call ReflectChandes()
.head 5 +  On SAM_Validate
.head 6 +  If MyValue = NUMBER_Null
.head 7 -  Set dfSchemaName = ''
.head 6 +  Else
.head 7 +  If SqlPrepareAndExecute( hSqlAux(), 'SELECT rck_schema_name INTO :dfSchemaName 
FROM rck_schema WHERE rck_schema_id = :dfSchemaId' ) 
.head 8 -  Call SqlFetchNext( hSqlAux(), nFetchRes )
.head 3 +  Data Field: dfSchemaName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   1.517"
.head 6 -  Top:    0.548"
.head 6 -  Width:  3.983"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.274"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Left
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 -  Message Actions
.head 3 +  Pushbutton: pbSchema
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class: cTBarButton
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: ?
.head 4 -  Window Location and Size
.head 5 -  Left:   5.55"
.head 5 -  Top:    0.536"
.head 5 -  Width:  0.4"
.head 5 -  Width Editable? Class Default
.head 5 -  Height: 0.286"
.head 5 -  Height Editable? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Keyboard Accelerator: Class Default
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Bold
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: Class Default
.head 4 -  Image Style: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Set strTmpSId = SalNumberToStrX( dfSchemaId, 0 )
.head 6 -  Set strTmpSNm = dfSchemaName
.head 6 +  If FunNSIGet( 'RCK_SCHEMA', 'RCK_SCHEMA_NAME', strTmpSId, strTmpSNm )
.head 7 -  Set dfSchemaId = SalStrToNumber( strTmpSId )
.head 7 -  Set dfSchemaName = strTmpSNm
.head 7 -  Call ReflectChandes()
.head 3 -  Group Box: Расписание 
.head 4 -  Resource Id: 39523
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    1.0"
.head 5 -  Width:  5.967"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.845"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Group Box: Статус 
.head 4 -  Resource Id: 39524
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.1"
.head 5 -  Top:    1.881"
.head 5 -  Width:  5.967"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.619"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: 3D Shadow Color
.head 4 -  Background Color: Default
.head 3 -  Background Text: Активизируется
.head 4 -  Resource Id: 39525
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   0.283"
.head 5 -  Top:    1.214"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Период
.head 4 -  Resource Id: 39526
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.95"
.head 5 -  Top:    1.226"
.head 5 -  Width:  0.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Background Text: Деактивируется
.head 4 -  Resource Id: 39527
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Window Location and Size
.head 5 -  Left:   4.2"
.head 5 -  Top:    1.202"
.head 5 -  Width:  1.7"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.202"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Justify: Left
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 +  Data Field: dfActDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   0.283"
.head 6 -  Top:    1.452"
.head 6 -  Width:  1.483"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.262"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call ReflectChandes()
.head 3 +  Combo Box: cmbPeriod
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Window Location and Size
.head 5 -  Left:   1.95"
.head 5 -  Top:    1.452"
.head 5 -  Width:  2.167"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 1.107"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Editable? Yes
.head 4 -  String Type: String
.head 4 -  Maximum Data Length: Default
.head 4 -  Sorted? No
.head 4 -  Always Show List? No
.head 4 -  Vertical Scroll? Yes
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 8
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 -  Input Mask: Unformatted
.head 4 +  List Initialization
.head 5 -  Text: Day
.head 5 -  Text: Week
.head 5 -  Text: Month
.head 5 -  Text: Quarter
.head 5 -  Text: Half a year
.head 5 -  Text: Year
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call ReflectChandes()
.head 5 +  On SAM_Click
.head 6 -  Set nDayQnt = 0
.head 6 +  If MyValue = 'Day'
.head 7 -  Set nDayQnt = 1
.head 6 +  Else If MyValue = 'Week'
.head 7 -  Set nDayQnt = 7
.head 6 +  Else If MyValue = 'Month'
.head 7 -  Set nDayQnt = 31
.head 6 +  Else If MyValue = 'Quarter'
.head 7 -  Set nDayQnt = 92
.head 6 +  Else If MyValue = 'Half a year'
.head 7 -  Set nDayQnt = 183
.head 6 +  Else If MyValue = 'Year'
.head 7 -  Set nDayQnt = 365
.head 6 +  If dfActDate
.head 7 -  Set dfDctDate = dfActDate + nDayQnt
.head 6 +  Else If dfDctDate
.head 7 -  Set dfActDate = dfDctDate - nDayQnt
.head 6 -  Call ReflectChandes()
.head 3 +  Data Field: dfDctDate
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: Date/Time
.head 5 -  Editable? Yes
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left:   4.2"
.head 6 -  Top:    1.452"
.head 6 -  Width:  1.483"
.head 6 -  Width Editable? Yes
.head 6 -  Height: 0.262"
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? Yes
.head 5 -  Justify: Center
.head 5 -  Format: Date
.head 5 -  Country: Default
.head 5 -  Font Name: Arial Cyr
.head 5 -  Font Size: 10
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Default
.head 5 -  Background Color: Default
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 +  On SAM_AnyEdit
.head 6 -  Call ReflectChandes()
.head 3 +  Check Box: cbStatus
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Используется в работе
.head 4 -  Window Location and Size
.head 5 -  Left:   0.3"
.head 5 -  Top:    2.119"
.head 5 -  Width:  2.833"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.25"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Font Name: Arial Cyr
.head 4 -  Font Size: 10
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call ReflectChandes()
.head 5 +  On SAM_Create
.head 6 -  Call SalDisableWindow( cbStatus )
.head 2 +  Functions
.head 3 +  Function: ReflectChandes
.head 4 -  Description: Отобразить изменения в деталях
.head 4 +  Returns
.head 5 -  Boolean:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 -  Local variables
.head 4 +  Actions
.head 5 -  Set cFPlan.nSchemaId = dfSchemaId
.head 5 -  Set cFPlan.dtActDate = dfActDate
.head 5 -  Set cFPlan.dtDctDate = dfDctDate
.head 5 -  Set cFPlan.strPeriod = SalStrLeftX( cmbPeriod, 1 )
.head 5 -  Set cFPlan.fActive   = cbStatus
.head 5 -  Call SalPostMsg( SalParentWindow( hWndForm ), UM_DetailsChanged, 0, 0 )
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Number: nFetchRes
.head 3 -  String: strTmpSId
.head 3 -  String: strTmpSNm
.head 3 -  Number: nDayQnt
.head 2 +  Message Actions
.head 3 +  On UM_Populate
.head 4 -  Set dfSchemaId = cFPlan.nSchemaId 
.head 4 -  ! Call SalHideWindow( cbStatus )
.head 4 -  Set dfSchemaName = ''
.head 4 -  Set dfActDate = cFPlan.dtActDate
.head 4 -  Set dfDctDate = cFPlan.dtDctDate
.head 4 +  If cFPlan.strPeriod
.head 5 -  Call SalListSelectString( cmbPeriod, -1, cFPlan.strPeriod )
.head 4 +  Else
.head 5 -  Call SalListSetSelect( cmbPeriod, -1 )
.head 4 -  Set cbStatus = cFPlan.fActive
.head 4 +  If SqlPrepareAndExecute( hSqlAux(), 'SELECT rck_schema_name INTO :dfSchemaName 
FROM rck_schema WHERE rck_schema_id = :dfSchemaId' ) 
.head 5 -  Call SqlFetchNext( hSqlAux(), nFetchRes )
.head 1 +  Table Window: tblRCK_Tek
.head 2 -  Class: cGenericTable
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title: Текущее состояние установленных и использованных лимитов
.head 2 -  Icon File:
.head 2 -  Accesories Enabled? Class Default
.head 2 -  Visible? Class Default
.head 2 -  Display Settings
.head 3 -  Visible at Design time? Yes
.head 3 -  Automatically Created at Runtime? Class Default
.head 3 -  Initial State: Class Default
.head 3 -  Maximizable? Class Default
.head 3 -  Minimizable? Class Default
.head 3 -  System Menu? Class Default
.head 3 -  Resizable? Class Default
.head 3 -  Window Location and Size
.head 4 -  Left:   Default
.head 4 -  Top:    Default
.head 4 -  Width:  Class Default
.head 4 -  Width Editable? Class Default
.head 4 -  Height: Class Default
.head 4 -  Height Editable? Class Default
.head 3 -  Font Name: Class Default
.head 3 -  Font Size: Class Default
.head 3 -  Font Enhancement: Class Default
.head 3 -  Text Color: Class Default
.head 3 -  Background Color: Class Default
.head 3 -  View: Class Default
.head 3 -  Allow Row Sizing? Class Default
.head 3 -  Lines Per Row: Class Default
.head 2 -  Memory Settings
.head 3 -  Maximum Rows in Memory: Class Default
.head 3 -  Discardable? Class Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Class Default
.head 4 -  Location? Class Default
.head 4 -  Visible? Class Default
.head 4 -  Size: Class Default
.head 4 -  Size Editable? Class Default
.head 4 -  Font Name: Class Default
.head 4 -  Font Size: Class Default
.head 4 -  Font Enhancement: Class Default
.head 4 -  Text Color: Class Default
.head 4 -  Background Color: Class Default
.head 3 +  Contents
.head 4 +  Pushbutton: pbIns
.head 5 -  Class Child Ref Key: 33
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDel
.head 5 -  Class Child Ref Key: 34
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbRefresh
.head 5 -  Class Child Ref Key: 35
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbUpdate
.head 5 -  Class Child Ref Key: 36
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 39528
.head 5 -  Class Child Ref Key: 37
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbSearch
.head 5 -  Class Child Ref Key: 38
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbFilter
.head 5 -  Class Child Ref Key: 44
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbDetails
.head 5 -  Class Child Ref Key: 39
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 +  Pushbutton: pbPrint
.head 5 -  Class Child Ref Key: 40
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 39529
.head 5 -  Class Child Ref Key: 41
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 4 +  Pushbutton: pbExit
.head 5 -  Class Child Ref Key: 42
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Property Template:
.head 5 -  Class DLL Name:
.head 5 -  Title:
.head 5 -  Window Location and Size
.head 6 -  Left:   Class Default
.head 6 -  Top:    Class Default
.head 6 -  Width:  Class Default
.head 6 -  Width Editable? Class Default
.head 6 -  Height: Class Default
.head 6 -  Height Editable? Class Default
.head 5 -  Visible? Class Default
.head 5 -  Keyboard Accelerator: Class Default
.head 5 -  Font Name: Class Default
.head 5 -  Font Size: Class Default
.head 5 -  Font Enhancement: Class Default
.head 5 -  Picture File Name:
.head 5 -  Picture Transparent Color: Class Default
.head 5 -  Image Style: Class Default
.head 5 -  Text Color: Class Default
.head 5 -  Background Color: Class Default
.head 5 -  Message Actions
.head 4 -  Line
.head 5 -  Resource Id: 39530
.head 5 -  Class Child Ref Key: 43
.head 5 -  Class ChildKey: 0
.head 5 -  Class: cGenericTable
.head 5 -  Coordinates
.head 6 -  Begin X:  Class Default
.head 6 -  Begin Y:  Class Default
.head 6 -  End X:  Class Default
.head 6 -  End Y:  Class Default
.head 5 -  Visible? Class Default
.head 5 -  Line Style: Class Default
.head 5 -  Line Thickness: Class Default
.head 5 -  Line Color: Class Default
.head 2 +  Contents
.head 3 +  Column: SCHEMA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
схемы
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.8"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KLI
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Код
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: RNK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Рег №
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  0.85"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: NMK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование
клиента
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  2.333"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: KEK
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Символ
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  1.283"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: LIM
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Установленный
лимит
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.483"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: OSTC
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Использованый
лимит

.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.483"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: DELTA
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Свободный
лимит

.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: Number
.head 4 -  Justify: Right
.head 4 -  Width:  1.517"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Decimal
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 -  !
.head 3 +  Column: SymName
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: Наименование символа
.head 4 -  Visible? Yes
.head 4 -  Editable? No
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  3.6"
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 3 +  Column: s8610
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title:
.head 4 -  Visible? No
.head 4 -  Editable? Yes
.head 4 -  Maximum Data Length: Default
.head 4 -  Data Type: String
.head 4 -  Justify: Left
.head 4 -  Width:  Default
.head 4 -  Width Editable? Yes
.head 4 -  Format: Unformatted
.head 4 -  Country: Default
.head 4 -  Input Mask: Unformatted
.head 4 -  Cell Options
.head 5 -  Cell Type? Standard
.head 5 -  Multiline Cell? No
.head 5 -  Cell DropDownList
.head 6 -  Sorted? Yes
.head 6 -  Vertical Scroll? Yes
.head 6 -  Auto Drop Down? No
.head 6 -  Allow Text Editing? Yes
.head 5 -  Cell CheckBox
.head 6 -  Check Value:
.head 6 -  Uncheck Value:
.head 6 -  Ignore Case? Yes
.head 4 -  List Values
.head 4 -  Message Actions
.head 2 -  Functions
.head 2 +  Window Parameters
.head 3 -  Number: nEditMode
.head 2 +  Window Variables
.head 3 -  Number: n980
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call PrepareWindow( hWndForm )
.head 4 -  Set tblRCK_Tek.nTabInstance=1 
.head 4 -  Call SetWindowFullSize( hWndForm )
.head 4 -  Call SalTblSetLockedColumns( hWndForm, 5)
.head 4 -  Set tblRCK_Tek.nFlags = GT_ReadOnly
.head 4 -  Set tblRCK_Tek.strFilterTblName = 'RCK_V'
.head 4 -  Set tblRCK_Tek.strPrintFileName = 'RCK_V'
.head 4 -  Set tblRCK_Tek.n980 = GetBaseVal()
.head 4 -  Set tblRCK_Tek.strSqlPopulate =
"SELECT RCK_V.rck_schema_id, RCK_V.KLI     ,   RCK_V.NMK     ,      RCK_V.rnk,
        RCK_V.KEK          , RCK_V.LIM/100 , - RCK_V.OSTC/100,
        s.rck_symbol_name  , RCK_V.NLS       
 INTO  :tblRCK_Tek.SCHEMA  ,:tblRCK_Tek.KLI, :tblRCK_Tek.NMK , :tblRCK_Tek.RNK,
       :tblRCK_Tek.KEK     ,:tblRCK_Tek.LIM, :tblRCK_Tek.OSTC,
       :tblRCK_Tek.SymName ,:tblRCK_Tek.s8610       
 FROM RCK_V, rck_symbol s 
 WHERE s.rck_schema_id = RCK_V.rck_schema_id AND 
       s.rck_symbol_id = RCK_V.KEK 
 ORDER BY   RCK_V.rck_schema_id, RCK_V.KLI, RCK_V.KEK "
.head 4 -  !
.head 4 -  Call SalSendClassMessage(SAM_Create, 0, 0)
.head 3 +  On SAM_FetchRowDone	
.head 4 -  Set tblRCK_Tek.DELTA = tblRCK_Tek.LIM - tblRCK_Tek.OSTC
.head 4 +  If tblRCK_Tek.DELTA < 0
.head 5 -  Call XSalTblSetRowBackColor( hWndForm, lParam, COLOR_Maize )
.head 3 -  On SAM_TblDoDetails	
