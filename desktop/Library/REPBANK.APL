Application Description: Разнообразные печатные отчеты комплекса. (С) УНИТИ-БАРС, 1997-2006
	Outline Version - 4.0.26
	Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000B80000 002C000000030000 0003000000730000 000C010000FCFFFF
0040: FFE5FFFFFFD7FFFF FFF8FFFFFFBE0200 00BA010000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.data DT_MAKERUNDLG
0000: 0200000000001C51 3A5C424152533938 5C4C494252415259 5C4162736170692E
0020: 646C6C1C513A5C42 41525339385C4C49 42524152595C4162 736170692E617063
0040: 00000101011C513A 5C4241525339385C 4C4942524152595C 4162736170692E72
0060: 756E1C513A5C4241 525339385C4C4942 524152595C416273 6170692E646C6C1C
0080: 513A5C4241525339 385C4C4942524152 595C416273617069 2E61706300000101
00A0: 01175C4241525339 385C42494E5C7265 7062616E6B2E6170 64165C4241525339
00C0: 385C42494E5C4162 736170692E646C6C 165C424152533938 5C42494E5C416273
00E0: 6170692E61706300 00010101001C513A 5C4241525339385C 4C4942524152595C
0100: 4162736170692E64 6C6C1C513A5C4241 525339385C4C4942 524152595C416273
0120: 6170692E61706300 00010101
.enddata
		Outline Window State: Normal
		Outline Window Location and Size
.data VIEWINFO
0000: 6600040003002D00 0000000000000000 0000B71E5D0E0500 1D00FFFF4D61696E
0020: 0000000000000000 0000000000000000 0000003B00010000 00000000000000E9
0040: 1E800A00008600FF FF496E7465726E61 6C2046756E637469 6F6E730000000000
0060: 0000000000000000 0000000000003200 0100000000000000 0000E91E800A0000
0080: DF00FFFF56617269 61626C6573000000 0000000000000000 0000000000000000
00A0: 3000010000000000 00000000F51E100D 0000F400FFFF436C 6173736573000000
00C0: 0000000000000000 0000000000000000
.enddata
.data VIEWSIZE
0000: D000
.enddata
			Left:   -0.013"
			Top:    0.0"
			Width:  8.013"
			Height: 4.969"
		Options Box Location
.data VIEWINFO
0000: 0418B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
			Visible? Yes
			Left:   4.15"
			Top:    1.885"
			Width:  3.8"
			Height: 2.073"
		Class Editor Location
			Visible? No
			Left:   0.575"
			Top:    0.094"
			Width:  5.063"
			Height: 2.719"
		Tool Palette Location
			Visible? No
			Left:   6.388"
			Top:    0.729"
		Fully Qualified External References? Yes
		Reject Multiple Window Instances? No
		Enable Runtime Checks Of External References? Yes
		Use Release 4.0 Scope Rules? No
	Libraries
		Dynalib: Global.apd
		Dynalib: Message.apd
		Dynalib: Absapi.apd
		Dynalib: Dfltrapi.apd
		Dynalib: OTCN.APD
		File Include: Constant.apl
		File Include: Genbutn.apl
		File Include: Genlabel.apl
		File Include: Genlist.apl
		File Include: Gentimer.apl
		File Include: Winbars2.apl
		File Include: Gentbl.apl
		File Include: Gentblf.apl
		File Include: strfnc.apl
		File Include: vtcal.apl
		File Include: VTCOMDLG.APL
		File Include: VTDOS.APL
		File Include: VTLBX.APL
		File Include: XSALCPT.APL
		File Include: XSALIMG.APL
		File Include: XSALSPL.APL
	Global Declarations
		Window Defaults
			Tool Bar
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Form Window
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Dialog Box
				Display Style? Etched
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Top Level Table Window
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: System Default
				Text Color: System Default
				Background Color: System Default
			Data Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Multiline Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Spin Field
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Background Text
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Pushbutton
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Radio Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Check Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Option Button
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
			Group Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Child Table Window
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			List Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Combo Box
				Font Name: Use Parent
				Font Size: Use Parent
				Font Enhancement: Use Parent
				Text Color: Use Parent
				Background Color: Use Parent
			Line
				Line Color: Use Parent
			Frame
				Border Color: Use Parent
				Background Color: 3D Face Color
			Picture
				Border Color: Use Parent
				Background Color: Use Parent
		Formats
			Number: 0'%'
			Number: #0
			Number: ###000
			Number: ###000;'($'###000')'
			Date/Time: hh:mm:ss AMPM
			Date/Time: hh:mm  dd-MM-yyyy
			Date/Time: dd-MM-yyyy hh:mm
			Date/Time: M/d/yy
			Date/Time: MM-dd-yy
			Date/Time: dd-MMM-yyyy
			Date/Time: MMM d, yyyy
			Date/Time: MMM d, yyyy hh:mm AMPM
			Date/Time: MMMM d, yyyy hh:mm AMPM
			Input: 99/99/99
			Number: ###00000
			Date/Time: dd/MM/yyyy
			Date/Time: dd/MM/yy
			Number: #00
			Number: #000
			Date/Time: dd-MM-yyyy hh:mm
			Date/Time: hh:mm dd-MM-yyyy 
			Date/Time: hh:mm  dd-MM-yyyy
			Date/Time: hh:mm  dd-MM-yyyy AMPM
			Date/Time: hhhh:mm  dd-MM-yyyy 
			Date/Time: hh:mm  dd-MM-yyyy 
		External Functions
			Library name: frprint.dll
				Function: PrintTemplate
					Description: Функция печати отчета по шаблонв FastReport
							!function PrintTemplate(Server: Pchar; User: PChar; Password: PChar; Template: PChar): integer; cdecl; external 'frprint.dll';
					Export Ordinal: 0
					Returns
						Number: INT
					Parameters
						String: LPSTR
						String: LPSTR
						String: LPSTR
						String: LPSTR
				! function PrintTemplate(Server: Pchar; User: PChar; Password: PChar; Template: PChar): integer; cdecl; external 'frprint.dll';
		Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
			System
			User
		Resources
			Icon: ICO_Folder
				File Name: \BARS98\RESOURCE\ICO\Folderg.ICO
		Variables
.data RESOURCE 0 0 1 1335972120
0000: 1E00000010000000 0000000000000000 020080010000008E 0100E00204000000
0020: FF3F
.enddata
			Window Handle: hWnd2
			Window Handle: hWnd3
			!
			Boolean: fLibInit		! Флаг инициализации библиотеки
			! ===========================================================
			! ===========================================================
			! - - - - - - - Переменные которые стоит сдесь оставить- - - - - - - - - 
			! ===========================================================
			Number: ID                      !! Код пользователя из staff
			String: IDNAME                  !! Имя пользователя из staff     
			String: app                     !! Код текущего приложения
			String: strRepDate              !! Дата отчета
			String: strBankDate
			String: g_strDbType		!! Тип отчетной БД
			: g_cRepCnc
				Class: cABSConnect
			!
			String: SHAP                    !! шапка отчета
			String: AMFO                    !! Наше МФО
			String: AQH                     !!  Наименование нашего банка
			String: DRUK                    !! Строка для отчета типа  'Printed : ..... '
			Number: FL_FORMAT               !!  если true - печать в rtf формате 
			Number: bFLS                    !! = TRUE без перекодировки, FALSE - с перекодировкой
			String: strBind                 !! Для Print ReportToFile
			String: strInput                !! Для Print ReportToFile
					
			! - - - - - - - - - -рабочие переменные - счетчики - - - - - - - - - - - - - - -  
			String: rab
			Number: nInd
			Number: nRet
			Number: nRowType
			Number: nFetchRes
			String: strDir   !!!! это имя файла-шаблона - его переименовали в strTmplPath
			!
			Window Handle: hWndLicParent
			! - - - - - - - - - - - - Поскольку в таблице report в поле param остались переменные - -
					! - - - - - - - - - - - - sFdat и sFdat2  -  оставим эти переменные - - - - - - - - - - - - - - - - - -
			String: sFdat          !! Дата отчета с (MM-DD-YYYY)
			String: sFdat2        !! Дата отчета по (MM-DD-YYYY)
					
					
			! ===========================================================
			! ===========================================================
			! - - - - - - - Новые переменные - - - - - - - - - - - - 
			! ===========================================================
			Number: nDay
			Number: nMonth
			Number: nYear
			String: strDateFrom	!! Дата отчета с (DD-MM-YYYY)
			String: strDateTo	!! Дата отчета по (DD-MM-YYYY)
			String: strMonth[12]	!! Наименов. месяце для календаря
			String: strWeekDays[7]	!! Дни недели для календаря
					
			String: strFileNameTxt	!! Имя файла отчета для TXT
			String: strFileNameRtf	!! Имя файла отчета для RTF
					
			String: strTmplPath	!! Путь + имя файла отчета-шаблона (*.qrp) 
			String: strExecForm	!! строка создания формы отчета (для SalCompileAndEvaluate(...) )
			String: strPrintPath	!!  директория куда печатать отчет (=GetPrintDir, а если значение в поле path таблицы report не пустое, тогда это значение)
					
			String: sDeviceDef	!! Параметры для печати отчета (*.rtf)
			String: sDriverDef	!!  - -//- -
			String: sPortDef	!!  - -//- -
			String: sDriverDefo	!!  - -//- -
					
					
			String: lstFiles[*]	!! список выбранных файлов
			Number: nFiles		!! кол-во выбранных файлов   
			!
			Window Handle: hFrm_Out
			Window Handle: hFrm_OutList
			!
			String: sAutoForm
			Number: nKOD
			Number: nNODEL
			! - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
		Internal Functions
			Function: Reports_Init
				Description: инициализация библиотеки
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					String: strPathToLangResources
					String: strLangId
					! !
					String: strFileName
					String: sTmp
					Number: nTmp
				Actions
					If NOT fLibInit
						Set strPathToLangResources = GetLangPath()
						Set strLangId = GetLang()
						Set strFileName = strPathToLangResources || "\\" || strLangId || "\\reports.lng"
						If (NOT strLangId) OR (NOT CurrentLangTable.InitFromFile( strFileName, strLangId ))
							Call CurrentLangTable.Init()
							!
							Call CurrentLangTable.AddAtom('cTAt','Внимание')
							Call CurrentLangTable.AddAtom('cTErr','Ошибка')
							Call CurrentLangTable.AddAtom('cTInfo','Информация')
							Call CurrentLangTable.AddAtom('cTErrFunc','функция возвратила ошибку')
							Call CurrentLangTable.AddAtom('cTSelectAcc','ОТБОР счетов для печати')
							Call CurrentLangTable.AddAtom('cTSelectSKP','ОТБОР СКП для печати')
							Call CurrentLangTable.AddAtom('cTSelectRNK','ОТБОР Рег.№ КЛИЕНТА для печати')
							Call CurrentLangTable.AddAtom('cTZagB','Балансовий')
							Call CurrentLangTable.AddAtom('cTZagU','Управлінський')
							Call CurrentLangTable.AddAtom('cTZagV','Позабалансовий')
							Call CurrentLangTable.AddAtom('cTZagO','облік')
							! ====================================================
							! frm_Out
							Call CurrentLangTable.AddAtom('frm_Out.cTWndTitle','Печатные отчеты')
							!
							Call CurrentLangTable.AddAtom('frm_Out.cTBTipNewFolder','Перейти к другой папке отчетов')
							Call CurrentLangTable.AddAtom('frm_Out.cTBTipWord','Сделать отчет в формате RTF')
							Call CurrentLangTable.AddAtom('frm_Out.cTBTipTxt','Сделать текстовый отчет')
							Call CurrentLangTable.AddAtom('frm_Out.cTBTipXML','Сделать отчет в формате XML')
							Call CurrentLangTable.AddAtom('frm_Out.cTBTipView','Просмотреть выбранный файл')
							Call CurrentLangTable.AddAtom('frm_Out.cTBTipPrint','Напечатать выбранный файл')
							Call CurrentLangTable.AddAtom('frm_Out.cTBTipExit','Выход')
							!
							Call CurrentLangTable.AddAtom('frm_Out.tblReps.Kod','Код')
							Call CurrentLangTable.AddAtom('frm_Out.tblReps.NAME','Наименование')
							Call CurrentLangTable.AddAtom('frm_Out.tblLstFiles.colFileName','Имя файла')
							Call CurrentLangTable.AddAtom('frm_Out.tblLstFiles.colRepDT','За')
							Call CurrentLangTable.AddAtom('frm_Out.tblLstFiles.colFileDT','Дата созд.')
							Call CurrentLangTable.AddAtom('frm_Out.tblLstFiles.colFileSize','Байт')
							!
							Call CurrentLangTable.AddAtom('frm_Out.cTErr1','Не удалось загрузить приложение')
							Call CurrentLangTable.AddAtom('frm_Out.cTErr22','на выполнении')
							Call CurrentLangTable.AddAtom('frm_Out.cTErr23','При вызове процедуры')
							Call CurrentLangTable.AddAtom('frm_Out.cTErr24','возникла ошибка')
							Call CurrentLangTable.AddAtom('frm_Out.cTErr25','числовая ошибка')
							Call CurrentLangTable.AddAtom('frm_Out.cTErr26','позиция ошибки')
							!
							Call CurrentLangTable.AddAtom('frm_Out.cTMsg1','В таблице')
							Call CurrentLangTable.AddAtom('frm_Out.cTMsg2','не заполнено ни одно из полей')
							Call CurrentLangTable.AddAtom('frm_Out.cTMsgPrinter','Умолчательный принтер')
							Call CurrentLangTable.AddAtom('frm_Out.cTMsgDat','Нет доступных дат для выбора')
							!
							Call CurrentLangTable.AddAtom('frm_Out.cTRO','Только для просмотра')
							! ====================================================
							!
							Call CurrentLangTable.AddAtom('frm_Lables.dfTo',  'По дату')
							Call CurrentLangTable.AddAtom('frm_Lables.dfFrom','C даты')
							Call CurrentLangTable.AddAtom('frm_Lables.aOn','За дату')
							! ====================================================
							! dlg_mas
							Call CurrentLangTable.AddAtom('dlg_mas.cTWndTitle','ОТБОР  СЧЕТОВ  ДЛЯ  ПЕЧАТИ')
							Call CurrentLangTable.AddAtom('dlg_mas.pb1','Утвердить')
							Call CurrentLangTable.AddAtom('dlg_mas.pb2','Отказаться')
							Call CurrentLangTable.AddAtom('dlg_mas.bgMaska','"Маска" для отбора:')
							! ====================================================
							! dlg_mas2
							Call CurrentLangTable.AddAtom('dlg_mas2.cTWndTitle','ОТБОР  ПРОВОДОК  ДЛЯ  ПЕЧАТИ')
							Call CurrentLangTable.AddAtom('dlg_mas2.pb1','Утвердить')
							Call CurrentLangTable.AddAtom('dlg_mas2.pb2','Отказаться')
							Call CurrentLangTable.AddAtom('dlg_mas2.bgMaskaD','"Маска"  ДЕБЕТА счета:')
							Call CurrentLangTable.AddAtom('dlg_mas2.bgMaskaC','"Маска"  КРЕДИТА счета:')
							! ====================================================
							! dlg_MonthAdd
							Call CurrentLangTable.AddAtom('dlg_MonthAdd.cTWndTitle','Выбор исполнителя')
							Call CurrentLangTable.AddAtom('dlg_MonthAdd.PB1','Печать выбранных')
							Call CurrentLangTable.AddAtom('dlg_MonthAdd.PB2','Печать ВСЕХ')
							Call CurrentLangTable.AddAtom('dlg_MonthAdd.PB3','Завершить')
							Call CurrentLangTable.AddAtom('dlg_MonthAdd.tbl1.Kod1', 'Код')
							Call CurrentLangTable.AddAtom('dlg_MonthAdd.tbl1.NAME1','НАИМЕНОВАНИЕ')
							Call CurrentLangTable.AddAtom('dlg_MonthAdd.cTMsgCase', 'Ничего не выбрано!')
							! ====================================================
							! frm_ARM
							Call CurrentLangTable.AddAtom('frm_ARM.cTWndTitle','КАРТОЧКА ПОЛЬЗОВАТЕЛЯ')
							Call CurrentLangTable.AddAtom('frm_ARM.PB1','Печать выбранных')
							Call CurrentLangTable.AddAtom('frm_ARM.PB2','Печать ВСЕХ')
							Call CurrentLangTable.AddAtom('frm_ARM.PB3','Завершить')
							Call CurrentLangTable.AddAtom('frm_ARM.tbl1.Kod1', 'Код')
							Call CurrentLangTable.AddAtom('frm_ARM.tbl1.NAME1','НАИМЕНОВАНИЕ')
							! ====================================================
							! frm_Balans
							Call CurrentLangTable.AddAtom('frm_Balans.cTWndTitle','Баланс банка')
							Call CurrentLangTable.AddAtom('frm_Balans.PB1','Печать выбранных')
							Call CurrentLangTable.AddAtom('frm_Balans.PB2','Печать ВСЕХ')
							Call CurrentLangTable.AddAtom('frm_Balans.PB3','Завершить')
							Call CurrentLangTable.AddAtom('frm_Balans.tbl1.Kod1', 'Код')
							Call CurrentLangTable.AddAtom('frm_Balans.tbl1.NAME1','НАИМЕНОВАНИЕ')
							! ====================================================
							! frm_KRED
							Call CurrentLangTable.AddAtom('frm_KRED.cTWndTitle','Подразделение для печати документов')
							Call CurrentLangTable.AddAtom('frm_KRED.pb1','Сводный документ')
							Call CurrentLangTable.AddAtom('frm_KRED.pb2','По подразделению')
							Call CurrentLangTable.AddAtom('frm_KRED.pb3','Завершить')
							Call CurrentLangTable.AddAtom('frm_KRED.tbl1.Kod1', 'Код')
							Call CurrentLangTable.AddAtom('frm_KRED.tbl1.NAME1','НАИМЕНОВАНИЕ')
							! ====================================================
							! frm_LicAcc
							Call CurrentLangTable.AddAtom('frm_LicAcc.cTWndTitle','Лицевые счета')
							Call CurrentLangTable.AddAtom('frm_LicAcc.cTWndTitle2','Клиенты')
							Call CurrentLangTable.AddAtom('frm_LicAcc.PB1','Печать выбранных')
							Call CurrentLangTable.AddAtom('frm_LicAcc.PB2','Печать ВСЕХ')
							Call CurrentLangTable.AddAtom('frm_LicAcc.PB3','Завершить')
							Call CurrentLangTable.AddAtom('frm_LicAcc.tbl1.Kod1', 'Код')
							Call CurrentLangTable.AddAtom('frm_LicAcc.tbl1.NAME1','НАИМЕНОВАНИЕ')
							Call CurrentLangTable.AddAtom('frm_LicAcc.cTMsgFileNotOpen','Невозможно открыть для записи файл')
							Call CurrentLangTable.AddAtom('frm_LicAcc.cTMsgProcNotExec','Не выполнена процедура')
							Call CurrentLangTable.AddAtom('frm_LicAcc.cTMsgFileNotClose','Невозможно закрыть файл')
							Call CurrentLangTable.AddAtom('frm_LicAcc.cTMsgFileNotDel','Не могу удалить файл нулевой длинны')
							Call CurrentLangTable.AddAtom('frm_LicAcc.cTRepKurs','Курс')
							Call CurrentLangTable.AddAtom('frm_LicAcc.cTRepD','Дб')
							Call CurrentLangTable.AddAtom('frm_LicAcc.cTRepC','Кр')
							! ====================================================
							! frm_Saldo
							Call CurrentLangTable.AddAtom('frm_Saldo.cTWndTitle','Оборотно-сальдовая ведомость')
							Call CurrentLangTable.AddAtom('frm_Saldo.PB1','Печать выбранных')
							Call CurrentLangTable.AddAtom('frm_Saldo.PB2','Печать ВСЕХ')
							Call CurrentLangTable.AddAtom('frm_Saldo.PB3','Завершить')
							Call CurrentLangTable.AddAtom('frm_Saldo.rb_All','Все счета')
							Call CurrentLangTable.AddAtom('frm_Saldo.rb_Rab','Рабочие счета')
							Call CurrentLangTable.AddAtom('frm_Saldo.rb_Ob', 'Счета с оборотами')
							Call CurrentLangTable.AddAtom('frm_Saldo.tbl1.Kod1', 'Код')
							Call CurrentLangTable.AddAtom('frm_Saldo.tbl1.NAME1','НАИМЕНОВАНИЕ')
							! ====================================================
							! frm_SaldoB
							Call CurrentLangTable.AddAtom('frm_SaldoB.cTWndTitle','Оборотно-сальдовая ведомость')
							Call CurrentLangTable.AddAtom('frm_SaldoB.cTWndTitle2','Оборотно-сальдовый баланс')
							Call CurrentLangTable.AddAtom('frm_SaldoB.pb_Print','Формировать')
							Call CurrentLangTable.AddAtom('frm_SaldoB.rb_All','Все счета')
							Call CurrentLangTable.AddAtom('frm_SaldoB.rb_Rab','Рабочие счета')
							Call CurrentLangTable.AddAtom('frm_SaldoB.rb_Ob', 'Счета с оборотами')
							! ====================================================
							! frm_Staff
							Call CurrentLangTable.AddAtom('frm_Staff.cTWndTitle','КАРТОЧКА ПОЛЬЗОВАТЕЛЯ')
							Call CurrentLangTable.AddAtom('frm_Staff.PB1','Печать выбранных')
							Call CurrentLangTable.AddAtom('frm_Staff.PB2','Печать ВСЕХ')
							Call CurrentLangTable.AddAtom('frm_Staff.PB3','Завершить')
							Call CurrentLangTable.AddAtom('frm_Staff.tbl1.Kod1', 'Код')
							Call CurrentLangTable.AddAtom('frm_Staff.tbl1.NAME1','НАИМЕНОВАНИЕ')
							Call CurrentLangTable.AddAtom('frm_Staff.cTRepARM','АРМы')
							Call CurrentLangTable.AddAtom('frm_Staff.cTRepTts','ОПЕРАЦИИ')
							Call CurrentLangTable.AddAtom('frm_Staff.cTRepChk','ГРУППЫ КОНТРОЛЯ ОПЕРАЦИЙ')
							Call CurrentLangTable.AddAtom('frm_Staff.cTRepGrp','ГРУППЫ ДОСТУПА К СЧЕТАМ')
							! ====================================================
							! frm_Stat
							Call CurrentLangTable.AddAtom('frm_Stat.cTRepIn', 'ВНУТРЕННИЕ')
							Call CurrentLangTable.AddAtom('frm_Stat.cTRepNMb','НАЧАЛЬНЫЕ МЕЖБАНКОВСКИЕ')
							Call CurrentLangTable.AddAtom('frm_Stat.cTRepKP', 'КАССА-ПРИХОД')
							Call CurrentLangTable.AddAtom('frm_Stat.cTRepKR', 'КАСА-ВИДАТКИ')
							Call CurrentLangTable.AddAtom('frm_Stat.cTRepOMb','ОТВЕТНЫЕ МЕЖБАНКОВСКИЕ')
							Call CurrentLangTable.AddAtom('frm_Stat.cTRepInV','ИНВАЛЮТНЫЕ')
							! ====================================================
							! frm_UniSal
							Call CurrentLangTable.AddAtom('frm_UniSal.cTMsg11','Ошибка')
							Call CurrentLangTable.AddAtom('frm_UniSal.cTMsg12','формирования отчета')
							! ====================================================
							! dlg_RepListF
							Call CurrentLangTable.AddAtom('dlg_RepListF.cTWndTitle','Папки отчетов')
							Call CurrentLangTable.AddAtom('dlg_RepListF.cTAll','Все')
							! ====================================================
							! frmRepQuery
							Call CurrentLangTable.AddAtom('frmRepQuery.cTWndTitle','Печать отчетов')
							Call CurrentLangTable.AddAtom('frmRepQuery.cTWndTitle1','Сформированные отчеты')
							Call CurrentLangTable.AddAtom('frmRepQuery.cTWndTitle2','Заявка на формирование отчета')
							! ====================================================
							! frmRepQ1
							Call CurrentLangTable.AddAtom('frmRepQ1.cTBTipRefresh','Перечитать данные')
							Call CurrentLangTable.AddAtom('frmRepQ1.cTBTipPrint','Печать отчета')
							Call CurrentLangTable.AddAtom('frmRepQ1.cTBTipDel','Удалить временные данные')
							Call CurrentLangTable.AddAtom('frmRepQ1.cTBTipCancel','Выйти')
							Call CurrentLangTable.AddAtom('frmRepQ1.tblRepQue.colId','№~отчета')
							Call CurrentLangTable.AddAtom('frmRepQ1.tblRepQue.colName','Название~отчета')
							Call CurrentLangTable.AddAtom('frmRepQ1.tblRepQue.colDat','Дата~заявки')
							Call CurrentLangTable.AddAtom('frmRepQ1.tblRepQue.colStatusName','Статус~отчета')
							Call CurrentLangTable.AddAtom('frmRepQ1.tblRepQue.colParams','Параметры~отчета')
							Call CurrentLangTable.AddAtom('frmRepQ1.cTMsgDel','Удалить временные данные для выделенных отчетов?')
							! ====================================================
							! frmRepQ2
							Call CurrentLangTable.AddAtom('frmRepQ2.bgFolder','Папка')
							Call CurrentLangTable.AddAtom('frmRepQ2.cTBTipRefresh','Перечитать данные')
							Call CurrentLangTable.AddAtom('frmRepQ2.cTBTipForm','Создать заявку')
							Call CurrentLangTable.AddAtom('frmRepQ2.tblRep.colId','№~отчета')
							Call CurrentLangTable.AddAtom('frmRepQ2.tblRep.colName','Название~отчета')
							Call CurrentLangTable.AddAtom('frmRepQ2.cTMsgQueryCreated','Создана заявка на формирование отчета')
							! ====================================================
						!
						! Call CurrentLangTable.SaveToFile('C:\\TEMP\\reps.lng','RUS')
						Set fLibInit = TRUE
					Return fLibInit
			Function: ShowOutForms			! __exported
				Description:
				Returns
				Parameters
					Window Handle: hW
					Number: nMode
				Static Variables
				Local variables
					Number: nID
				Actions
					Call Reports_Init()
					If nMode < 0
						If nMode = -1
							If SalModalDialog(dlg_RepListF, hW, nID)
								If hFrm_Out
									Call SalDestroyWindow( hFrm_Out )
								Set hFrm_Out=SalCreateWindow(frm_Out, hWndMDI, nID)
						If nMode = -2
							If not IsWindow(hWnd2)
								Set hWnd2 = SalCreateWindow(frmRepQuery, hW)
							Else
								Call SalBringWindowToTop(hWnd2)
						Else If nMode = -100
							If SalModalDialog(dlg_RepListF, hW, nID)
								If hFrm_OutList
									Call SalDestroyWindow( hFrm_OutList )
								Set hFrm_OutList = SalCreateWindow(frm_OutList, hWndMDI, nID)
					! стандвртаня форма выполнения отчетности в БАРС-е (без папок отчетов)
					Else If nMode = 0
						If hFrm_Out
							Call SalBringWindowToTop( hFrm_Out )
						Else
							Set hFrm_Out=SalCreateWindow(frm_Out, hW, nMode)
			Function: Maska_NLS
				Description:
				Returns
					String:
				Parameters
					String: slovo
				Static Variables
					String: mas
				Local variables
				Actions
					Set mas = '*'
					Call SalModalDialog(dlg_mas, hWndForm, mas, slovo)
					Return mas
			Function: Tmp_Kurs
				Description: построение временной таблицы лнкыщв на заданную
						дату
				Returns
					Boolean:
				Parameters
					Receive String: sid
					String: sdat
				Static Variables
				Local variables
					Boolean: fl
					String: sTmp
					String: sSql
					Number: nTmp
				Actions
					Set sTmp = SalStrTrimX(SalStrUpperX(GetDBMS()))
					Set sid = 't2_' || Str(GetUserId())
					If sTmp = 'ORACLE'
						Set sSql = "
								    SELECT table_name
								    INTO :sTmp
								    FROM user_tables
								    WHERE table_name=:sid"
					Else
						Set sSql = "
								    SELECT tabname
								    INTO :sTmp
								    FROM systables
								    WHERE tabname=:sid"
					! Вычитали из системной таблицы имя временной таблицы
					Call SqlPrepareAndExecute(hSqlAux(), sSql)
					! Удалить если есть
					If SqlFetchNext(hSqlAux(), nTmp)
						Call SqlPrepareAndExecute(hSqlAux(), "
								     DROP table " || sid)
					! Создать временную
					Call SqlPrepareAndExecute(hSqlAux(), "
							     CREATE table " || sid || " (kv int PRIMARY KEY,
							                                 kurs decimal(20,10))")
					! Населить временную
					If sTmp = 'ORACLE'
						Call SqlPrepareAndExecute(hSqlAux(), T("
								     INSERT
								     INTO " || sid || "(kv,kurs)
								     SELECT c.kv,c.rate_o/c.bsum
								     FROM cur_rates c
								     WHERE (c.kv,c.vdate)=(
								     SELECT u.kv,max(u.vdate)
								     FROM cur_rates u
								     WHERE u.kv=c.kv and u.vdate<= :sdat
								     GROUP BY u.kv)"))
					Else
						Call SqlPrepareAndExecute(hSqlAux(), T("
								     INSERT
								     INTO " || sid || "(kv,kurs)
								     SELECT c.kv,c.rate_o/c.bsum
								     FROM cur_rates c
								     WHERE c.vdate=(
								     SELECT max(u.vdate)
								     FROM cur_rates u
								     WHERE u.kv=c.kv and u.vdate<= :sdat) "))
					Call SqlPrepareAndExecute(hSqlAux(), "commit")
					Return fl
			Function: Selector			! __exported
				Description:
				Returns
					Boolean:
				Parameters
					Window Handle: hW
					Number: nP
				Static Variables
				Local variables
					String: sOdir
					String: sPath
					String: sFile
					String: sFile1
					File Handle: hFile
					File Handle: hSqlA
					Boolean: bFL
					Boolean: bU
					String: sMFO
					String: sSAB
					String: sNB
					String: sMFOU
					Number: nTmp
					Number: nMFO
					Number: nMFOU
					Number: nNull
					!
					String: sUchFormat
					String: sSqlCreate
				Actions
					If nP = 0
						! Определение ESC-последовательностей для печатных отчетов
						Call SalCreateWindow(tbl_idprn, hW)
					Else If nP = 1
						Call SalWaitCursor(TRUE)
						! запомнить текущий каталог в sOdir
						Call SalFileGetCurrentDirectory(sOdir)
						! Вычитать из .ini имя каталога для формирования файла Syymmdd.dbf в sPath
						Call SalUseRegistry(FALSE, '')
						Call SalGetProfileString('ElektroKlients', 'S_UchPath', GetPrnDir(), sPath,
								     GetIniFileName())
						Call SalGetProfileString('ElektroKlients', 'S_UchPath', GetPrnDir(), sPath,
								     GetIniFileName())
						Call SalGetProfileString('ElektroKlients', 'S_UchFormat', '0', sUchFormat,
								     GetIniFileName())
						! Создать (если нет) и сделать текущим каталог sPath
						Call SalFileCreateDirectory(sPath)
						Call SalFileSetCurrentDirectory(sPath)
						! Краткое имя файла sFile и полное sFile1
						Set sFile = 'S_Uch'
						Set sFile1 = sPath || IifS(Right(sPath,1)!='\\', '\\', '') || sFile || '.dbf'
						! Удаление sFile1 (если есть)
						If File(sFile1)
							Call SalFileOpen(hFile, sFile1, OF_Delete)
						! Работа с БД через ODBC
						Set SqlDatabase = 'dBase_Files'
						Set sSqlCreate = IifS(Val(sUchFormat)=1, "
								    CREATE
								    TABLE " || sFile || " (M_BA NUMBER(6),
								                           E_BA CHAR(4),
								                           H_BA CHAR(4),
								                           N_BA CHAR(38),
								                           K_SC NUMBER(14),
								                           N_MO CHAR(1),
								                           U_MO CHAR(1),
								                           M_BG NUMBER(6),
								                           M_UR NUMBER(6),
								                           F_BL CHAR(1),
								                           F_VA CHAR(1),
								                           F_SL CHAR(1),
								                           S_SS CHAR(10))", "
								    CREATE
								    TABLE " || sFile || " (MFO   NUMBER(6),
								                           NCKS  CHAR(4),
								                           NCKSO CHAR(4),
								                           NB    CHAR(38),
								                           KORSH NUMBER(14),
								                           N_MO  CHAR(1),
								                           U_MO  CHAR(1),
								                           MFO_G NUMBER(6),
								                           M_UR  NUMBER(6),
								                           F_BL  CHAR(1),
								                           F_VA  CHAR(1),
								                           F_SL  CHAR(1),
								                           S_SS  CHAR(10))")
						If SqlConnect(hSqlA)
							Set bFL = SqlPrepareAndExecute(hSqlA, sSqlCreate) and SqlPrepareAndExecute(hSql(), "
									    SELECT mfo,sab,nb,mfou
									    INTO :sMFO,:sSAB,:sNB,:sMFOU
									    FROM banks
									    WHERE (blk<>4 or blk is null) and (kodn<>4 or kodn is null)
									    ORDER BY 4,1")
							If bFL
								Set bU = TRUE
								Set nNull = NUMBER_Null
								While SqlFetchNext(hSql(), nTmp)
									Set nMFO = Val(sMFO)
									Set sNB = StrWinToDosX(sNB)
									Set nMFOU = Val(sMFOU)
									Set bFL = SqlPrepareAndExecute(hSqlA, "
											    INSERT
											    INTO " || sFile || "
											    VALUES (:nMFO,:sSAB,'',:sNB,:nNull,'','',:nNull,:nMFOU,'','','','')")
									If bU
										Set bU = bFL
								If bU
									Call SqlCommit(hSqlA)
									Call SalWaitCursor(FALSE)
									Call MessageNoWait('Создание ' || sFile1 || ' успешно завершено !', 'Сообщение',
											     17, 0)
								Else
									Call SqlRollback(hSqlA)
							Call SqlDisconnect(hSqlA)
						! Восстановление первичного текущего каталога
						Call SalFileSetCurrentDirectory(sOdir)
						Call SalWaitCursor(FALSE)
						Return bU
			Function: CurBalanceReval
				Description: Переоценка остатков в инвалюте 02-08-2001 (MIK)
				Returns
					Boolean:
				Parameters
				Static Variables
				Local variables
					Number: aKv[*]
					String: sKv[*]
					String: sLcv
					String: sErrTxt
					Number: i
					Number: nCount
					Number: nKv
					Number: nKvBas
					Date/Time: dDat
				Actions
					Set nKvBas=GetBaseVal()
					Set dDat = GetBankDate()
					! Set sErrTxt='Переоцінка залишків в інвалюті'
					If SqlPrepareAndExecute(hSql(), T("
							   SELECT kv,lcv FROM tabval INTO :nKv,:sLcv WHERE kv<>:nKvBas ORDER BY kv"))
						Set i=0
						While SqlFetchNext(hSql(), nFetchRes)
							Set aKv[i] = nKv
							Set sKv[i] = sLcv
							Set i = i + 1
						If i > 0
							Set nCount = 0
							! Call SalCreateWindow(win_meter, hWndForm, sErrTxt, i)
							While nCount < i
								Set nKv = aKv[nCount]
								! Call SalStatusSetText( hWndForm, 'Валюта '||sKv[nCount] )
								If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
									Call SalWaitCursor( TRUE )
									If SqlPLSQLCommand(hSql(), "p_rev(nKv,dDat)")
										Call SqlCommitEx(hSql(), sErrTxt||' по '|| SalNumberToStrX( nKv, 0 ) )
										Call SaveInfoToLog(sErrTxt||' по '|| SalNumberToStrX( nKv, 0 ) || ' - успешно.')
									Else
										Call SqlRollback(hSql())
										Call SaveInfoToLog(sErrTxt||' по '|| SalNumberToStrX( nKv, 0 ) || ' - ошибка.')
									Call SalWaitCursor( FALSE )
								Else
									Call MessageWarning('Для INFORMIX пока не реализовано')
									Return TRUE
								Set nCount = nCount + 1
								! Call SalSendMsg(win_meter, AM_MtrMove, 0, nCount)
							! Call SalStatusSetText( hWndForm, 'Готово' )
							! Call SalDestroyWindow(win_meter)
							Return TRUE
					Call MessageError('Не описаны инвалюты')
					Return FALSE
			! Function: NumberToStrFormat    
				                                                               Description: !! Превращает число в строку заданной длины (nLen) - дополняя впереди нулями
				                                                               Returns 
					                                                               String: strVal
				                                                               Parameters 
					                                                               Number: nVal
					                                                               Number: nLen
				                                                               Static Variables 
				                                                               Local variables 
					                                                               Number: i
					                                                               String: strVal
				                                                               Actions 
					                                                               Set i=10
					                                                               Set strVal = SalNumberToStrX(nVal,0)
					                                                               Loop 
						                                                               If i  > SalNumberPower (10 , nLen - 1) 
							                                                               Return strVal
							                                                               Break 
						                                                               If nVal < i 
							                                                               Set strVal =  '0' || strVal
						                                                               Set i = i * 10
			Function: DoReportToFile
				Description: !! Поскольку практически в каждой форме для печати отчета повторяется одно 
						           и то же, и все параметры являются глобальными -> эта процедура вынесена, как глобальная
				Returns
					Number: nVal
				Parameters
				Static Variables
				Local variables
				Actions
					! ! ! ==================================================
					! ! ! Начинаем печать в отчет
					! ! ! ==================================================
					Set strInput = strBind
					Call SalReportPrintToFile(hWndForm,
							                                                    strTmplPath,
							                                                    strPrintPath ||'/'|| IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt),
							                                                    strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
					If (nInd > 4 )
						Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
								
					! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
					Set frm_Out.dfPath = strPrintPath
					Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
					Return nInd
							
			Function: GetDigitForChar		! __exported
				Description: Возвращает строку  соответствующее букве СЭП  от 0 до Z в string формате
				Returns
					String: strRes
				Parameters
					String: strValIn
				Static Variables
				Local variables
					Number: nCharacter
					String: strValOut
				Actions
					! /////////////////////////////////////////////////////////////////////////////////////////////////////////////
					!
					Set nCharacter = SalStrLop ( strValIn )
					If (nCharacter > 48 AND nCharacter <58) OR ( nCharacter > 64 AND nCharacter <91 )
						If (nCharacter > 48 AND nCharacter <58)
							Set strValOut= NumberToStrFormat  ( nCharacter - 48 ,2, '0', TRUE) 
						Else
							Set strValOut = NumberToStrFormat  (nCharacter - 55,2, '0',TRUE ) 
					Else
						Set strValOut = '?'
					Return strValOut
					!
					! /////////////////////////////////////////////////////////////////////////////////////////////////////////////
			Function: AutoForm			! __exported
				Description:
				Returns
					Boolean:
				Parameters
					Number: nKod
					String: sPar
					String: sDateBeg
					String: sDateEnd
				Static Variables
				Local variables
					String: sDescription
					String: sForm
					String: sName
					String: sParam
					String: sMask
					Number: nNodel
					Number: nError
					Number: nErrorPos
					String: strRet
					Date/Time: dtRet
					Window Handle: hWndRet
				Actions
					! Call Debug('1')
					If SqlPrepareAndExecute(hSqlAux(), "
							   SELECT description,form,name,param,mask,nvl(nodel,0)
							   INTO :sDescription,:sForm,:sName,:sParam,:sMask,:nNodel
							   FROM REPORTS
							   WHERE id=:nKod and form<>'frm_DKU'
							   ORDER BY 1,2") and SqlFetchNext(hSqlAux(), nFetchRes)
					Else
						Return FALSE
					Set nKOD = nKod
					Set nNODEL = nNodel
					Set strTmplPath = GetTemplateDir() || "\\" || sName
					If sDateBeg = STRING_Null
						Set sFdat = SalFmtFormatDateTime(PreviousBankDay(GetBankDate(), Val(sPar)), 'MM-dd-yyyy')
					Else
						Set sFdat = sDateBeg
					If sDateEnd = STRING_Null
						Set sFdat2 = SalFmtFormatDateTime(PreviousBankDay(GetBankDate(), Val(sPar)), 'MM-dd-yyyy')
					Else
						Set sFdat2 = sDateEnd
					Set strDateFrom = Subs(sFdat, 4, 3)  || Left(sFdat, 3)  || Right(sFdat, 4)
					Set strDateTo   = Subs(sFdat2, 4, 3) || Left(sFdat2, 3) || Right(sFdat2, 4)
					Set strRepDate  = strDateFrom
					Set strFileNameTxt = IifS(sMask=STRING_Null, NumberToStrFormat(nKod, 3, '0', TRUE) || GetCharForDigit(SalStrToNumber(
							    SalStrMidX(sFdat, 0, 2))) || GetCharForDigit(SalStrToNumber(SalStrMidX(sFdat, 3, 2))) ||
							    NumberToStrFormat(nKod, 3, '0', TRUE), sMask) || '.txt'
					!
					Set SHAP = SalNumberToStrX(nKod, 0) || ' ' || sDescription
					Set DRUK = 'Printed: ' || SalFmtFormatDateTime(SalDateCurrent(), "dd/MM/yyyy hh:mm:ss")
					Set AMFO = GetBankMfo()
					Set AQH = GetBankName()
					! Set strRepDate  = strDateFrom
					! ==================================
					! - Генерируем строку вызова формы -
					! ==================================
					! Call Debug(strFileNameTxt)
					Set strExecForm = IifS(SalStrLowerX(SalStrLeftX(sForm, 3))='dlg', "SalModalDialog", IifS(SalStrLowerX(
							    SalStrLeftX(sForm, 3))='frm' or SalStrLowerX(SalStrLeftX(sForm, 3))='tbl', "SalCreateWindow", ''))
					! ===========================================================================================
					! - Получилась строка вызова типа "SalCreateWindow(frm_Out1, hWndForm, 3, 5)" -
					! ===========================================================================================
					! -  Поскольку в таблице report в поле param остались переменные sFdat и sFdat2 - присвоим их
					Set strExecForm = strExecForm || "(" || sForm || ",hWndForm," || sParam || "," || Str(not nNodel) || "," || Str(nKod) ||
							    ")"
					! Call Debug(strExecForm)
					! ===================================================
					! - Выполним отчет, и заново перенаселим лист бокс -
					! ===================================================
					! Call Debug('Before strExecForm=' || strExecForm)
					! Call Debug(strExecForm)
					Set FL_FORMAT = FALSE
					Set strPrintPath = GetPrnDir()
					Set sAutoForm = 'AUTO'
					! Set nError = 0
					Call XConnectGetParams(g_cRepCnc)
					If not g_cRepCnc.Connect()
						Return FALSE
					!
					Call SalCompileAndEvaluate(strExecForm, nError, nErrorPos, nRet, strRet, dtRet, hWndRet, FALSE, SalContextCurrent())
					Call SalDestroyWindow(hWndRet)
					!
					If g_cRepCnc.IsConnected()
						Call g_cRepCnc.Disconnect()
					! If not FL_FORMAT
						! Call Debug('zarez12Del - ' || strPrintPath || '/' || strFileNameTxt || ' - nNODEL = ' || Str(nNODEL))
						! Call zarez12Del(strPrintPath || '/' || strFileNameTxt, nKOD, sDeviceDef, not nNODEL)
					Call zarez12Del(strPrintPath || '/' || strFileNameTxt, nKOD, sDeviceDef, not nNODEL)
					Set sAutoForm = ''
					! Call Debug('Error = ' || Str(nError))
					! Call Debug('After strExecForm='||strExecForm)
					If nError
						! Call SalMessageBox('SalCompileAndEvaluate возвратила ошибку : ' || Str(nError) || ' на выполнении ** ' ||
								     strExecForm || ' **.  При вызове процедуры '|| strExecForm || ' возникла ошибка ' || strRet ||
								     ' числовая ошибка - ' || Str(nRet) || ' позиция ошибки ' || Str(nError), 'Внимание', 0)
						Call MessageNoWait('SalCompileAndEvaluate ' || CurrentLangTable.GetAtomTitle('cTErrFunc') || ' :' || Str(nError) ||
								     ' ' || CurrentLangTable.GetAtomTitle('frm_Out.cTErr22') || ' ** ' || strExecForm || ' **. ' ||
								     CurrentLangTable.GetAtomTitle('frm_Out.cTErr23') || ' ' || strExecForm || ' ' ||
								     CurrentLangTable.GetAtomTitle('frm_Out.cTErr24') || ' ' || strRet || ' ' ||
								     CurrentLangTable.GetAtomTitle('frm_Out.cTErr25') || ' - ' || Str(nRet) || ' ' ||
								     CurrentLangTable.GetAtomTitle('frm_Out.cTErr26') || ' ' || Str(nError),
								     CurrentLangTable.GetAtomTitle('cTAt'), 37, 1)
						! Call SalMessageBox('SalCompileAndEvaluate ' || CurrentLangTable.GetAtomTitle('cTErrFunc') || ' :' || Str(nError) ||
								     ' ' || CurrentLangTable.GetAtomTitle('frm_Out.cTErr22') || ' ** ' || strExecForm || ' **. ' ||
								     CurrentLangTable.GetAtomTitle('frm_Out.cTErr23') || '   ' || strExecForm || ' ' ||
								     CurrentLangTable.GetAtomTitle('frm_Out.cTErr24') || ' ' || strRet || '  ' ||
								  CurrentLangTable.GetAtomTitle('frm_Out.cTErr25') || ' - ' || Str(nRet) || '  ' ||
								  CurrentLangTable.GetAtomTitle('frm_Out.cTErr26') || ' ' || Str(nError), CurrentLangTable.GetAtomTitle('cTAt'), 0)
						Return FALSE
					Return TRUE
			Function: PreviousBankDay
				Description: возвращает ПРЕДЫДУЩИЙ БАНКОВСКИЙ день (от УКАЗАННОГО дня на УКАЗАННОЕ количество дней назад)
				Returns
					Date/Time:
				Parameters
					Date/Time: dDay
					Number: nDayMinus
				Static Variables
				Local variables
					Date/Time: dReturn
				Actions
					Set dReturn = dDay
					If nDayMinus > 0
						If SqlPrepareAndExecute(hSqlAux2(), "
								   SELECT fdat
								   INTO :dReturn
								   FROM (SELECT fdat fdat,rownum num
								         FROM fdat
								         WHERE fdat<:dDay
								         ORDER BY fdat DESC)
								   WHERE num=:nDayMinus") and SqlFetchNext(hSqlAux2(), nFetchRes)
					Return dReturn
		Named Menus
		Class Definitions
.data RESOURCE 0 0 1 487135908
0000: E404000017020000 0000000000000000 0200000700FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F8F003C00 000F63004465736B
0040: 746F704C00697374 426F782201C00000 0B00000083010D00 0000FFFFE40D0000
0060: 01FE00FF831A0000 0001FB00FF0F2700 0000EE0100FF3F34 00B800000100FFFF
0080: E04100000001FE00 FF834E00000001FB 00FF0F5B000000EE 0100FF3F6800B800
00A0: 000100FFFFE07500 000001FE00FF8382 00000001FB00FF0F 0180340011000100
00C0: 000B63E04469724C 69036C0000000400 3C0000010DFB00FF 6F0D00EE0100FFBF
00E0: 1AB9000100FFFFE6 270001FE00FF4301 80270000E0020000 000F81547265654C
0100: 690F52000000F003 000000EC010D00FF BF0DB9000100FFFF E61A0001FE00FF43
0120: 01805B0000060300 0C634669F86C654C 41BA00000007009E 00010DFD00FF370D
0140: 0001F700FFDF1ADC 000100FF7F277300 0100FFFFCD340001 FD00FF37410001F7
0160: 00FFDF4EDC000100 FF7F01C880410000 0400000D63526164 696F7C4C69868000
0180: 0000050000006701 0D00FFFFC90D0000 01FD00FF371A0001 F700FFDF27DC0001
01A0: 00FF7F3473000100 FFFF010180220000 000503000A634765 6E04466974657274
01C0: 00D8000004002302 04000001FA000007 8001000000FFC604 00010DFE00FF8311
01E0: 00000002FB00FF0F 15000000EE0100FF 3F01800622000600 00001A0B47444669
0200: 7F00F604008E0200 0100FE00C9800100 00BF04B100010D00 FFFFE6110002FE00
0220: FF9B150001FB00FF 0F
.enddata
			Form Window Class: cFrmOut
				Title:
				Icon File:
				Accesories Enabled? Yes
				Visible? No
				Display Settings
					Display Style? Class Default
					Visible at Design time? Yes
					Automatically Created at Runtime? Class Default
					Initial State: Class Default
					Maximizable? Class Default
					Minimizable? Class Default
					System Menu? Class Default
					Resizable? Class Default
					Window Location and Size
						Left:  
						Top:   
						Width:  13.25"
						Width Editable? Class Default
						Height: 5.94"
						Height Editable? Class Default
					Form Size
						Width:  Class Default
						Height: Class Default
						Number of Pages: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
				Next Class Child Key: 38
				List in Tool Palette? Yes
				Property Template:
				Class DLL Name:
				Description:
				Derived From
				Menu
				Tool Bar
					Display Settings
						Display Style? Class Default
						Location? Class Default
						Visible? Class Default
						Size: 0.45"
						Size Editable? Class Default
						Font Name: Class Default
						Font Size: Class Default
						Font Enhancement: Class Default
						Text Color: Class Default
						Background Color: Class Default
					Contents
						Pushbutton: pbNewFolder
							Class Child Ref Key: 0
							Class ChildKey: 1
							Class: ctb_pbInsert
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   0.133"
								Top:    0.071"
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name: \BARS98\RESOURCE\BMP\RECYCLE.BMP
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
								On SAM_Create
									! Set strTip= 'Перейти к другой папке отчетов'
									Set strTip = CurrentLangTable.GetAtomTitle('frm_Out.cTBTipNewFolder')
								On SAM_Click
									If SalModalDialog(dlg_RepListF, hWndMDI, nMode)
										Call DisablePb()
										Call SalSendMsg(tblReps, SAM_User, 0, 0)
						Line
							Resource Id: 57548
							Class Child Ref Key: 0
							Class ChildKey: 2
							Class:
							Coordinates
								Begin X:  0.683"
								Begin Y:  -0.048"
								End X:  0.683"
								End Y:  0.429"
							Visible? Yes
							Line Style: Etched
							Line Thickness: 1
							Line Color: Default
						Pushbutton: pbWord
							Class Child Ref Key: 0
							Class ChildKey: 3
							Class: ctb_pbOk
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   0.8"
								Top:    0.071"
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name: \BARS98\RESOURCE\BMP\WORD.BMP
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
								On SAM_Create
									! Set strTip= 'Сделать отчет в формате RTF'
									Set strTip = CurrentLangTable.GetAtomTitle('frm_Out.cTBTipWord')
								On SAM_Click
									Set FL_FORMAT = TRUE
									! -- wPram=5 для того чтоб знать что сообщение пришло от кнопки
									Call SalSendMsg(tblReps, SAM_DoubleClick, 5, 0)
						Pushbutton: pbTxt
							Class Child Ref Key: 0
							Class ChildKey: 4
							Class: ctb_pbOk
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   1.233"
								Top:    0.071"
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name: \BARS98\RESOURCE\BMP\DETAILS.BMP
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
								On SAM_Create
									! Set strTip= 'Сделать текстовый отчет'
									Set strTip = CurrentLangTable.GetAtomTitle('frm_Out.cTBTipTxt')
								On SAM_Click
									Set FL_FORMAT = FALSE
									! -- wPram=5 для того чтоб знать что сообщение пришло от кнопки
									Call SalSendMsg(tblReps, SAM_DoubleClick, 5, 0)
						Pushbutton: pbXML
							Class Child Ref Key: 0
							Class ChildKey: 5
							Class:
							Property Template:
							Class DLL Name:
							Title: XML
							Window Location and Size
								Left:   1.683"
								Top:    0.071"
								Width:  0.44"
								Width Editable? Yes
								Height: 0.321"
								Height Editable? Yes
							Visible? Yes
							Keyboard Accelerator: (none)
							Font Name: Default
							Font Size: Default
							Font Enhancement: Bold
							Picture File Name:
							Picture Transparent Color: None
							Image Style: Single
							Text Color: Red
							Background Color: Default
							Message Actions
								On SAM_TooltipSetText
									! Return XSalTooltipSetText( lParam, 'Сделать отчет в формате XML' )
									Return XSalTooltipSetText( lParam, CurrentLangTable.GetAtomTitle('frm_Out.cTBTipXML') )
								On SAM_Click
									Set FL_FORMAT = FALSE
									Set sTmpParams = tblReps.param
									! Заменим формат (2-й параметр) на '-1' - формат XML
									Set tblReps.param = Subs(tblReps.param,0,SalStrScan(tblReps.param,',')+1) || 
											'-1,' || 
											Subs(Subs(tblReps.param,SalStrScan(tblReps.param,',')+2,Len(tblReps.param)-SalStrScan(tblReps.param,',')),SalStrScan(Subs(tblReps.param,SalStrScan(tblReps.param,',')+2,Len(tblReps.param)-SalStrScan(tblReps.param,',')),',')+2,
											Len(Subs(tblReps.param,SalStrScan(tblReps.param,',')+2,Len(tblReps.param)-SalStrScan(tblReps.param,',')))-SalStrScan(Subs(tblReps.param,SalStrScan(tblReps.param,',')+2,Len(tblReps.param)-SalStrScan(tblReps.param,',')),','))
									! -- wPram=5 для того чтоб знать что сообщение пришло от кнопки
									Call SalSendMsg(tblReps, SAM_DoubleClick, 5, 0)
									Set tblReps.param = sTmpParams
						Line
							Resource Id: 57549
							Class Child Ref Key: 0
							Class ChildKey: 6
							Class:
							Coordinates
								Begin X:  2.2"
								Begin Y:  -0.048"
								End X:  2.2"
								End Y:  0.464"
							Visible? Yes
							Line Style: Etched
							Line Thickness: 1
							Line Color: Default
						Pushbutton: pbView
							Class Child Ref Key: 0
							Class ChildKey: 7
							Class: ctb_pbOk
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   2.317"
								Top:    0.071"
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name: \BARS98\RESOURCE\BMP\DOCVIEW.BMP
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
								On SAM_Create
									! Set strTip='Просмотреть выбранный файл'
									Set strTip = CurrentLangTable.GetAtomTitle('frm_Out.cTBTipView')
								On SAM_Click
									Set strPrintPath=dfPath
									Set nI = 0
									If (SalStrScan( tblLstFiles.colFileName ,  '.rtf' )!= -1)         !!== RTF format
										If (   SalLoadApp(GetEditorPath(), strPrintPath||'\\'||tblLstFiles.colFileName  )   = FALSE     )
											! Call SalMessageBox('Не удалось загрузить приложение SalLoadApp : GetEditorPath()','Внимание',0)
											Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Out.cTErr1') || ' SalLoadApp : GetEditorPath()',
													  CurrentLangTable.GetAtomTitle('cTAt'),0)
									Else !!== TXT format
										Call DirectView(strPrintPath|| '\\' || tblLstFiles.colFileName, tblReps.ACode)
						Pushbutton: pbPrint
							Class Child Ref Key: 0
							Class ChildKey: 8
							Class: ctb_pbPrint
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   2.767"
								Top:    0.071"
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name:
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
								On SAM_Create
									! Set strTip =  'Напечатать выбранный файл'
									Set strTip = CurrentLangTable.GetAtomTitle('frm_Out.cTBTipPrint')
								On SAM_Click
									Set strPrintPath=dfPath
									! ! - - - -  Заново установим нормальный принтер
									! Call SetDefaultPrinter()
									Set nI = TBL_MinRow
									While SalTblFindNextRow( tblLstFiles, nI, ROW_Selected, 0)
										Call SalTblSetContext( tblLstFiles, nI )
										If (SalStrScan( tblLstFiles.colFileName ,  '.rtf' )!= -1)         !!== RTF format
											If (   SalLoadApp(GetEditorPath(), strPrintPath||'\\'||tblLstFiles.colFileName  )   = FALSE     )
												! Call SalMessageBox('Не удалось загрузить приложение SalLoadApp : GetEditorPath()','Внимание',0)
												Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Out.cTErr1') || ' SalLoadApp : GetEditorPath()',
														  CurrentLangTable.GetAtomTitle('cTAt'),0)
										Else !!== TXT format
											Call DosDirectPrint(strPrintPath || '\\' || tblLstFiles.colFileName )
										Call SalTblSetRowFlags( tblLstFiles, nI ,ROW_Selected, FALSE)
										Set nI = nI + 1
						Line
							Resource Id: 57550
							Class Child Ref Key: 0
							Class ChildKey: 9
							Class:
							Coordinates
								Begin X:  3.317"
								Begin Y:  -0.012"
								End X:  3.317"
								End Y:  0.44"
							Visible? Yes
							Line Style: Etched
							Line Thickness: 1
							Line Color: Default
						Pushbutton: pbExit
							Class Child Ref Key: 0
							Class ChildKey: 10
							Class: ctb_pbOk
							Property Template:
							Class DLL Name:
							Title:
							Window Location and Size
								Left:   3.45"
								Top:    0.071"
								Width:  Class Default
								Width Editable? Class Default
								Height: Class Default
								Height Editable? Class Default
							Visible? Class Default
							Keyboard Accelerator: Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Picture File Name: \BARS98\RESOURCE\BMP\DISCARD.BMP
							Picture Transparent Color: Class Default
							Image Style: Class Default
							Text Color: Class Default
							Background Color: Class Default
							Message Actions
								On SAM_Create
									! Set strTip = 'Выход'
									Set strTip = CurrentLangTable.GetAtomTitle('frm_Out.cTBTipExit')
								On SAM_Click
									Call SalDestroyWindow(hWndForm)
				Contents
					Child Table: tblReps
						Class Child Ref Key: 0
						Class ChildKey: 11
						Class:
						Property Template:
						Class DLL Name:
						Display Settings
							Window Location and Size
								Left:   0.067"
								Top:    0.036"
								Width:  6.35"
								Width Editable? Yes
								Height: 4.988"
								Height Editable? Yes
							Visible? Yes
							Font Name: Default
							Font Size: Default
							Font Enhancement: Default
							Text Color: Default
							Background Color: Default
							View: Table
							Allow Row Sizing? No
							Lines Per Row: Default
						Memory Settings
							Maximum Rows in Memory: 5000
							Discardable? No
						Contents
							Column: colSort
								Class Child Ref Key: 0
								Class ChildKey: 22
								Class: cColumnLabeled
								Property Template:
								Class DLL Name:
								Title: Порядок
										печати
								Visible? No
								Editable? Class Default
								Maximum Data Length: Class Default
								Data Type: Number
								Justify: Right
								Width:  0.8"
								Width Editable? Class Default
								Format: Class Default
								Country: Class Default
								Input Mask: Class Default
								Cell Options
									Cell Type? Class Default
									Multiline Cell? Class Default
									Cell DropDownList
										Sorted? Class Default
										Vertical Scroll? Class Default
										Auto Drop Down? Class Default
										Allow Text Editing? Class Default
									Cell CheckBox
										Check Value:
										Uncheck Value:
										Ignore Case? Class Default
								List Values
								Message Actions
							Column: Kod
								Class Child Ref Key: 0
								Class ChildKey: 23
								Class: cColumnLabeled
								Property Template:
								Class DLL Name:
								Title: Код
								Visible? Class Default
								Editable? No
								Maximum Data Length: Class Default
								Data Type: Number
								Justify: Right
								Width:  0.8"
								Width Editable? Class Default
								Format: Class Default
								Country: Class Default
								Input Mask: Class Default
								Cell Options
									Cell Type? Class Default
									Multiline Cell? Class Default
									Cell DropDownList
										Sorted? Class Default
										Vertical Scroll? Class Default
										Auto Drop Down? Class Default
										Allow Text Editing? Class Default
									Cell CheckBox
										Check Value:
										Uncheck Value:
										Ignore Case? Class Default
								List Values
								Message Actions
							Column: NAME
								Class Child Ref Key: 0
								Class ChildKey: 24
								Class: cColumnLabeled
								Property Template:
								Class DLL Name:
								Title: Наименование отчета
								Visible? Class Default
								Editable? No
								Maximum Data Length: Class Default
								Data Type: Class Default
								Justify: Class Default
								Width:  9.0"
								Width Editable? Class Default
								Format: Class Default
								Country: Class Default
								Input Mask: Class Default
								Cell Options
									Cell Type? Class Default
									Multiline Cell? Class Default
									Cell DropDownList
										Sorted? Class Default
										Vertical Scroll? Class Default
										Auto Drop Down? Class Default
										Allow Text Editing? Class Default
									Cell CheckBox
										Check Value:
										Uncheck Value:
										Ignore Case? Class Default
								List Values
								Message Actions
							Column: FORM
								Class Child Ref Key: 0
								Class ChildKey: 25
								Class:
								Property Template:
								Class DLL Name:
								Title:
								Visible? No
								Editable? Yes
								Maximum Data Length: Default
								Data Type: String
								Justify: Left
								Width:  Default
								Width Editable? Yes
								Format: Unformatted
								Country: Default
								Input Mask: Unformatted
								Cell Options
									Cell Type? Standard
									Multiline Cell? No
									Cell DropDownList
										Sorted? Yes
										Vertical Scroll? Yes
										Auto Drop Down? No
										Allow Text Editing? Yes
									Cell CheckBox
										Check Value:
										Uncheck Value:
										Ignore Case? Yes
								List Values
								Message Actions
							Column: rep
								Class Child Ref Key: 0
								Class ChildKey: 26
								Class:
								Property Template:
								Class DLL Name:
								Title:
								Visible? No
								Editable? Yes
								Maximum Data Length: Default
								Data Type: String
								Justify: Left
								Width:  Default
								Width Editable? Yes
								Format: Unformatted
								Country: Default
								Input Mask: Unformatted
								Cell Options
									Cell Type? Standard
									Multiline Cell? No
									Cell DropDownList
										Sorted? Yes
										Vertical Scroll? Yes
										Auto Drop Down? No
										Allow Text Editing? Yes
									Cell CheckBox
										Check Value:
										Uncheck Value:
										Ignore Case? Yes
								List Values
								Message Actions
							Column: param
								Class Child Ref Key: 0
								Class ChildKey: 27
								Class:
								Property Template:
								Class DLL Name:
								Title:
								Visible? No
								Editable? Yes
								Maximum Data Length: Default
								Data Type: String
								Justify: Left
								Width:  Default
								Width Editable? Yes
								Format: Unformatted
								Country: Default
								Input Mask: Unformatted
								Cell Options
									Cell Type? Standard
									Multiline Cell? No
									Cell DropDownList
										Sorted? Yes
										Vertical Scroll? Yes
										Auto Drop Down? No
										Allow Text Editing? Yes
									Cell CheckBox
										Check Value:
										Uncheck Value:
										Ignore Case? Yes
								List Values
								Message Actions
							Column: NDAT
								Class Child Ref Key: 0
								Class ChildKey: 28
								Class:
								Property Template:
								Class DLL Name:
								Title:
								Visible? No
								Editable? Yes
								Maximum Data Length: Default
								Data Type: Number
								Justify: Left
								Width:  Default
								Width Editable? Yes
								Format: Unformatted
								Country: Default
								Input Mask: Unformatted
								Cell Options
									Cell Type? Standard
									Multiline Cell? No
									Cell DropDownList
										Sorted? Yes
										Vertical Scroll? Yes
										Auto Drop Down? No
										Allow Text Editing? Yes
									Cell CheckBox
										Check Value:
										Uncheck Value:
										Ignore Case? Yes
								List Values
								Message Actions
							Column: maska
								Class Child Ref Key: 0
								Class ChildKey: 29
								Class:
								Property Template:
								Class DLL Name:
								Title:
								Visible? No
								Editable? Yes
								Maximum Data Length: Default
								Data Type: String
								Justify: Left
								Width:  Default
								Width Editable? Yes
								Format: Unformatted
								Country: Default
								Input Mask: Unformatted
								Cell Options
									Cell Type? Standard
									Multiline Cell? No
									Cell DropDownList
										Sorted? Yes
										Vertical Scroll? Yes
										Auto Drop Down? No
										Allow Text Editing? Yes
									Cell CheckBox
										Check Value:
										Uncheck Value:
										Ignore Case? Yes
								List Values
								Message Actions
							Column: repw
								Class Child Ref Key: 0
								Class ChildKey: 30
								Class:
								Property Template:
								Class DLL Name:
								Title:
								Visible? No
								Editable? Yes
								Maximum Data Length: Default
								Data Type: String
								Justify: Left
								Width:  Default
								Width Editable? Yes
								Format: Unformatted
								Country: Default
								Input Mask: Unformatted
								Cell Options
									Cell Type? Standard
									Multiline Cell? No
									Cell DropDownList
										Sorted? Yes
										Vertical Scroll? Yes
										Auto Drop Down? No
										Allow Text Editing? Yes
									Cell CheckBox
										Check Value:
										Uncheck Value:
										Ignore Case? Yes
								List Values
								Message Actions
							Column: NoDel
								Class Child Ref Key: 0
								Class ChildKey: 36
								Class:
								Property Template:
								Class DLL Name:
								Title:
								Visible? No
								Editable? No
								Maximum Data Length: Default
								Data Type: Number
								Justify: Left
								Width:  Default
								Width Editable? Yes
								Format: Unformatted
								Country: Default
								Input Mask: Unformatted
								Cell Options
									Cell Type? Standard
									Multiline Cell? No
									Cell DropDownList
										Sorted? Yes
										Vertical Scroll? Yes
										Auto Drop Down? No
										Allow Text Editing? Yes
									Cell CheckBox
										Check Value:
										Uncheck Value:
										Ignore Case? Yes
								List Values
								Message Actions
							Column: ACode
								Class Child Ref Key: 0
								Class ChildKey: 37
								Class:
								Property Template:
								Class DLL Name:
								Title:
								Visible? No
								Editable? Yes
								Maximum Data Length: Default
								Data Type: String
								Justify: Left
								Width:  Default
								Width Editable? Yes
								Format: Unformatted
								Country: Default
								Input Mask: Unformatted
								Cell Options
									Cell Type? Standard
									Multiline Cell? No
									Cell DropDownList
										Sorted? Yes
										Vertical Scroll? Yes
										Auto Drop Down? No
										Allow Text Editing? Yes
									Cell CheckBox
										Check Value:
										Uncheck Value:
										Ignore Case? Yes
								List Values
								Message Actions
							Column: DbType
								Class Child Ref Key: 0
								Class ChildKey: 38
								Class:
								Property Template:
								Class DLL Name:
								Title:
								Visible? No
								Editable? Yes
								Maximum Data Length: Default
								Data Type: String
								Justify: Left
								Width:  Default
								Width Editable? Yes
								Format: Unformatted
								Country: Default
								Input Mask: Unformatted
								Cell Options
									Cell Type? Standard
									Multiline Cell? No
									Cell DropDownList
										Sorted? Yes
										Vertical Scroll? Yes
										Auto Drop Down? No
										Allow Text Editing? Yes
									Cell CheckBox
										Check Value:
										Uncheck Value:
										Ignore Case? Yes
								List Values
								Message Actions
						Functions
						Window Variables
							String: ShortFileName            !!  если есть маска для файла  типа  dd*сс*ДД?ww - превратим ее в ddссДДww
							Sql Handle: hS
							String: sFiltr
							: cF
								Class: cGenFilter
							String: sWndParams
						Message Actions
							On SAM_Create
								Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
								Call SalTblSetTableFlags(hWndForm, TBL_Flag_SelectableCols | TBL_Flag_SingleSelection, TRUE)
								Call cF.Init('V_REPORTS_LIST', 'R')
								Call SalSendMsg(hWndForm, SAM_User, 0, 0)
							On SAM_User
								Set strRet =''
								If EnhancedSecurity()
									Set strRet =' AND NVL(a.approve,0)=1 AND  date_is_valid(a.adate1,a.adate2,a.rdate1,a.rdate2)=1  '
								Set sFiltr =""
								Set sFiltr = cF.GetFilterWhereClause(FALSE)
								Call SalTblPopulate(hWndForm, hSql(),
										"SELECT r.id, r.description, r.form, r.name, r.param, r.ndat, r.mask, r.namew, nvl(r.nodel,0), r.dbtype " || 
										        IifS(isRepACode, ", upper(a.acode)", "") || "
										   INTO :tblReps.Kod, :tblReps.NAME, :tblReps.FORM, :tblReps.rep, 
										        :tblReps.param, :tblReps.NDAT, :tblReps.maska, :tblReps.repw, 
										        :tblReps.NoDel, :tblReps.DbType " || 
										        IifS(isRepACode, ", :tblReps.ACode", "") || "
										   FROM V_REPORTS_LIST r, app_rep a 
										  WHERE a.codeapp=:app and r.id=a.coderep and form<>'frm_DKU' " || strRet || 
										        IifS(sFiltr="",""," and "|| sFiltr ) || 
										        IifS(nMode=0, "", IifS(nMode=999999999, " AND r.idf is null", " AND r.idf="||Str(nMode) )) || "
										  ORDER BY 1,2", TBL_FillAll)  
								Set nOrderBy = ASC
								Call SalSetFocus(hWndForm)
								Call SalTblSetFocusRow(hWndForm, 0)
								Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
								If tblReps.NDAT = 0
									Call SalHideWindow(cCalendarFrom)
									Call SalHideWindow(cCalendarTo)
									Call SalHideWindow(frm_Lables.dfTo)
									Call SalHideWindow(frm_Lables.dfFrom)
								If tblReps.NDAT = 1
									Call SalHideWindow(cCalendarTo)
									Call SalShowWindow(cCalendarFrom)
									Set frm_Lables.dfFrom = CurrentLangTable.GetAtomTitle('frm_Lables.aOn')
									Call SalShowWindow(frm_Lables.dfFrom)
									Call SalHideWindow(frm_Lables.dfTo)
									Call SalSetFocus(frm_Lables.dfFrom)
								If tblReps.NDAT = 2
									Call SalShowWindow(cCalendarFrom)
									Call SalShowWindow(cCalendarTo)
									Set frm_Lables.dfFrom = CurrentLangTable.GetAtomTitle('frm_Lables.dfFrom')
									Call SalShowWindow(frm_Lables.dfTo)
									Call SalSetFocus(frm_Lables.dfFrom)
							On SAM_FetchRowDone
								If ACode = 'RO'
									Call XSalTblSetRowBackColor(hWndForm, lParam, SalColorFromRGB(230,255,230) ) ! светло-зеленый
							On SAM_TblDoDetails
								If isRepSec
									Call ClearPrnDir(strPrintPath)
								Set bRO = tblReps.ACode = 'RO'
								Call SalDisableWindow(pbView)
								Call SalDisableWindow(pbPrint)
								If (tblReps.rep = STRING_Null)
									Call SalDisableWindow(pbTxt)
								Else
									Call SalEnableWindow(pbTxt)
								If (tblReps.repw  = STRING_Null)
									Call SalDisableWindow(pbWord)
								Else
									Call SalEnableWindow(pbWord)
								If tblReps.FORM = 'frm_UniReport'
									If SqlPrepareAndExecute(hSql(), 
											"SELECT dbms_lob.getlength(xsl_data) INTO :nLen 
											 FROM zapros 
											 WHERE kodz=" || Subs(tblReps.param,1,SalStrScan(tblReps.param,',')) ) AND 
											SqlFetchNext(hSql(), nFetchRes)
										If nLen>0
											Call SalEnableWindow(pbXML)
										Else
											Call SalDisableWindow(pbXML)
									Else
										Call SalDisableWindow(pbXML)
								Else
									Call SalDisableWindow(pbXML)
								! ! =========================================================================
								! ! == По параметру NDAT - будем определять показывать ли календари
								! ! =========================================================================
								If tblReps.NDAT = 0
									Call SalHideWindow(cCalendarFrom)
									Call SalHideWindow(cCalendarTo)
									Call SalHideWindow(frm_Lables.dfTo)
									Call SalHideWindow(frm_Lables.dfFrom)
								If tblReps.NDAT = 1
									Call SalHideWindow(cCalendarTo)
									Call SalShowWindow(cCalendarFrom)
									Set frm_Lables.dfFrom = CurrentLangTable.GetAtomTitle('frm_Lables.aOn')
									Call SalShowWindow(frm_Lables.dfFrom)
									Call SalHideWindow(frm_Lables.dfTo)
									Call SalSetFocus(frm_Lables.dfFrom)
								If tblReps.NDAT = 2
									Call SalShowWindow(cCalendarFrom)
									Call SalShowWindow(cCalendarTo)
									Set frm_Lables.dfFrom = CurrentLangTable.GetAtomTitle('frm_Lables.dfFrom')
									Call SalShowWindow( frm_Lables.dfTo)
									Call SalSetFocus( frm_Lables.dfFrom)
								! ! =========================================================================
								! 1 == Населим список уже существующих файлов по данной маске отчета
								! ! =========================================================================
								Call SalTblReset(tblLstFiles)
								Call SalEnableWindow(cCalendarFrom)
								Call SalEnableWindow(cCalendarTo)
								Call SalEnableWindow(pbTxt)
								! =====================================================
								! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
								Set dfPath = strPrintPath
								Call SalSendMsg(dfPath, SAM_User, 0, 0)
							On SAM_ColumnSelectClick
								Call SalWaitCursor(TRUE)
								Set hColumn = SalNumberToWindowHandle(wParam)
								Set nOrderBy = Not nOrderBy
								Call SalTblSortRows(hWndForm, SalTblQueryColumnID( hColumn ), nOrderBy)
								Call SalTblSetColumnFlags(hColumn, COL_Selected, FALSE)
								Call SalWaitCursor(FALSE)
							On SAM_DoubleClick
								If isRepSec
									! Call ClearPrnDir(strPrintPath)
								! Устанавливаем g_cRepCnc - соединение с отчетной БД
										  (sRepDbAs или основная база)
								Set g_strDbType = tblReps.DbType
								If g_strDbType = 'REP'
									If sRepDbAs = ''
										Call SalMessageBox('Не установлены параметры соединения с отчетной БД', 'Внимание!', MB_IconStop | MB_Ok)
										Return FALSE
									Else
										Set SqlDatabase = sRepDbAs
										If not g_cRepCnc.Define(sRepDbAs, SqlUser, SqlPassword, TRUE)
											Call SalMessageBox('Не удалось установить соединение с отчетной БД', 'Внимание!', MB_IconStop | MB_Ok)
											Return FALSE
								Else
									Call XConnectGetParams(g_cRepCnc)
									If not g_cRepCnc.Connect()
										Return FALSE
									! If not cCncAux.Clone(g_cRepCnc, TRUE)
									! If not cCncAux2.Clone(g_cRepCnc, TRUE)
								!
								If GetGlobalOption('REPLOG')='1'
									Call SqlPrepareAndExecute(hSql(), "insert into test_replog(repid) values (:tblReps.Kod)")
									Call SqlCommit(hSql())
									!
									!
								Call SalTblQueryFocus(hWndForm, tek, hColumn)
								Set tek = lParam
								! ! =====================================================
								! ! ==========Дадим сообщение календарям
								! ! ========== SAM_User чтоб прочитать выбранную дату
								! ! ==========Дата в формате == 23-10-2001
								! ! =====================================================
								Call SalSendMsg(cCalendarFrom, SAM_User, 0, 0)
								Call SalSendMsg(cCalendarTo, SAM_User, 0, 0)
								! ! =====================================================
								! ! - Генерируем имя файла отчета - дата в имени файла отчета  -
								! ! - это дата "c"  (strDateFrom)
								! ! =====================================================
								If FL_FORMAT
									Set strFileNameRtf = (IifS(tblReps.maska=STRING_Null,
											                        NumberToStrFormat(tblReps.Kod, 3,'0',TRUE) ||
											                        GetCharForDigit( SalStrToNumber(SalStrMidX(strDateFrom, 0, 2) ) ) ||
											                        GetCharForDigit( SalStrToNumber(SalStrMidX(strDateFrom, 3, 2) ) )||
											                        NumberToStrFormat (ID,3,'0',TRUE),
											                      tblReps.maska) ) || '.rtf'
									Set strTmplPath = GetTemplateDir() || "\\" || tblReps.repw
									! ANNY_PRN Call SalPrtSetDefault(sDeviceDef, sDriverDef, sPortDef)
								Else
									Set strFileNameTxt = (IifS(tblReps.maska=STRING_Null,
											                        NumberToStrFormat (tblReps.Kod, 3, '0',TRUE)  ||
											                        GetCharForDigit( SalStrToNumber( SalStrMidX(strDateFrom, 0, 2) ) )||
											                        GetCharForDigit( SalStrToNumber( SalStrMidX(strDateFrom, 3, 2) ) )||
											                        NumberToStrFormat (ID,3, '0',TRUE),
											                      tblReps.maska) ) ||  '.txt'
									Set strTmplPath = GetTemplateDir() || "\\" || tblReps.rep
									! - - - -  Установка єтого принтера как default  нужна лишь для того чтоб
											! - - - -  при формировании текстового отчета  -  были нормальные параметры вывода
									! Call SalPrtSetDefault('Generic / Text Only', 'WINSPOOL', 'FILE:')
											
								!
								Set SHAP = SalNumberToStrX(tblReps.Kod, 0) || ' ' ||  tblReps.NAME
								Set DRUK = 'Printed: ' || SalFmtFormatDateTime(SalDateCurrent(), "dd/MM/yyyy hh:mm:ss")
								Set strRepDate  = strDateFrom
								!
									                                                                      Call SalDisableWindow(pbPrint)
								!
								! Генерируем строку вызова формы -
									                                                                      Call SalDisableWindow(pbPrint)
								! Должны получить строку вызова окна, типа:  SalCreateWindow(frm_Out1, hWndForm, 3,5)
									                                                                      Call SalDisableWindow(pbPrint)
								Set strExecForm = IifS( SalStrLowerX(SalStrLeftX(tblReps.FORM, 3))='dlg',
										    "SalModalDialog",
										    IifS((  SalStrLowerX(SalStrLeftX(tblReps.FORM, 3))='frm'  or   SalStrLowerX(SalStrLeftX(tblReps.FORM, 3))='tbl' ) ,
										    "SalCreateWindow",  '' ))
								!
								!
								! Поскольку в таблице report в поле param остались переменные sFdat и sFdat2  -  присвоим их
									                                                                      Call SalDisableWindow(pbPrint)
								Set sFdat  = SalStrMidX(strDateFrom, 3, 2 ) || '-' || SalStrMidX(strDateFrom, 0, 2) || '-' || SalStrMidX(strDateFrom, 6, 4)
								Set sFdat2 = SalStrMidX(strDateTo,   3, 2 ) || '-' || SalStrMidX(strDateTo,   0, 2) || '-' || SalStrMidX(strDateTo, 6, 4)
								!
								!
								Set sWndParams =  tblReps.param||','||IifS(tblReps.NoDel, 'FALSE', 'TRUE')
								!
								If tblReps.FORM = 'frm_UniReport'
									! для кат. запросов в параметры добавляем код. печ. отчета
									Set sWndParams = sWndParams||','||SalNumberToStrX(tblReps.Kod,0)
								!
								If tblReps.FORM = 'frm_FastReport'
									! отчеты через FastReport
									Set sWndParams = SalNumberToStrX(tblReps.Kod,0)||',"'||param||'"'
								!
								Set strExecForm = strExecForm || "(" || tblReps.FORM || ",hWndForm," || sWndParams || ")"
								!
								!
								! Call Debug('Строка вызова: '||strExecForm)
								! Выполним отчет, и заново перенаселим лист бокс
								Call SalCompileAndEvaluate(strExecForm, nError, nErrorPos, 
										  nRet, strRet, dtRet, hWndRet, FALSE, SalContextCurrent())
								If (nError)
									! Call SalMessageBox('SalCompileAndEvaluate возвратила ошибку :'||Str(nError) ||
											                                              '  на выполнении  ** ' ||  strExecForm || ' ** .   При вызове процедуры   '||  strExecForm || ' возникла ошибка '|| strRet ||
											                                              '  числовая ошибка - '|| Str(nRet)||
											                                              '  позиция ошибки '||Str(nError)  ,  'Внимание', 0)
									Call SalMessageBox('SalCompileAndEvaluate - ' || 
											  CurrentLangTable.GetAtomTitle('cTErrFunc') || ' :'    || Str(nError) || '  ' || 
											  CurrentLangTable.GetAtomTitle('frm_Out.cTErr22') || '  ** ' || strExecForm || ' ** .   ' || 
											  CurrentLangTable.GetAtomTitle('frm_Out.cTErr23') || '   '   || strExecForm || ' '  || 
											  CurrentLangTable.GetAtomTitle('frm_Out.cTErr24') || ' '     || strRet      || '  ' || 
											  CurrentLangTable.GetAtomTitle('frm_Out.cTErr25') || ' - '   || Str(nRet)   || '  ' || 
											  CurrentLangTable.GetAtomTitle('frm_Out.cTErr26') || ' '     || Str(nError)  ,  
											  CurrentLangTable.GetAtomTitle('cTAt'), 0)
								If g_cRepCnc.IsConnected()
									Call g_cRepCnc.Disconnect()
								! If cCncAux.IsConnected()
									                                              Call cCncAux.Disconnect()
								! If cCncAux2.IsConnected()
									                                              Call cCncAux2.Disconnect()
								! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
								Set dfPath = strPrintPath
								Call SalSendMsg(dfPath, SAM_User, 0, 0)
								! ! ==== Выставим  тип отчета по default
										! ==== (тоесть коггда отчет делают двойным clickom  (wParam <> 5) )
								If (wParam != 5)
									If (tblReps.rep  = STRING_Null )
										Set FL_FORMAT = TRUE
										If (tblReps.repw  = STRING_Null )
											! В таблице reports не заполнено ни одно из полей : namew, name
											Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Out.cTMsg1') || ' reports ' || 
													     CurrentLangTable.GetAtomTitle('frm_Out.cTMsg2') || ' : namew, name ', 
													     CurrentLangTable.GetAtomTitle('cTAt'), 0)
									Else
										Set FL_FORMAT = FALSE
							On SAM_RowHeaderClick
								If ACode = 'RO'
									! 'Только для просмотра'
									Call XSalTooltipSetColors(COLOR_Black, SalColorFromRGB(230,255,230))
									Call XSalTooltipShow(hWndForm, CurrentLangTable.GetAtomTitle('frm_Out.cTRO'))
									Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
							On SAM_Destroy
								! ====== Поставим настройки принтера назад 
								! ANNY_PRN Call SalPrtSetDefault(sDeviceDef, sDriverDef, sPortDef)
								! Call SaveInfoToLog( 'Умолчательный принтер - SET: Device=' || sDeviceDef ||
										', Drv=' || sDriverDef || ', Port=' || sPortDef)
								Call SaveInfoToLog( CurrentLangTable.GetAtomTitle('frm_Out.cTMsgPrinter') || ' - SET: Device=' || sDeviceDef ||
										', Drv=' || sDriverDef || ', Port=' || sPortDef)
							On UM_ReportFinish
								If not FL_FORMAT
									! Set dfFileName = GetPrnDir() || '\\' || strFileName
									Call zarez12Del(strPrintPath ||'/'|| strFileNameTxt, tblReps.Kod, sDeviceDef, NOT NoDel)
									! Call zarez12(strPrintPath ||'/'|| strFileNameTxt, tblReps.Kod, sDeviceDef)
									! и т.д. ???
								Call SalSetFocus(tblLstFiles)
								! Call frm_Out.SetDefaultPrinter()
							On WM_RbuttonUp
								If SetQueryFilter(cF)
									Call SalSendMsg(hWndForm, SAM_User, 0, 0)
					Child Table: tblLstFiles
						Class Child Ref Key: 0
						Class ChildKey: 12
						Class:
						Property Template:
						Class DLL Name:
						Display Settings
							Window Location and Size
								Left:   7.183"
								Top:    3.952"
								Width:  5.533"
								Width Editable? Yes
								Height: 0.798"
								Height Editable? Yes
							Visible? Yes
							Font Name: Default
							Font Size: Default
							Font Enhancement: Default
							Text Color: Default
							Background Color: Default
							View: Table
							Allow Row Sizing? No
							Lines Per Row: Default
						Memory Settings
							Maximum Rows in Memory: 50000
							Discardable? No
						Contents
							Column: colFileName
								Class Child Ref Key: 0
								Class ChildKey: 31
								Class: cColumnLabeled
								Property Template:
								Class DLL Name:
								Title: Имя файла
								Visible? Class Default
								Editable? No
								Maximum Data Length: Class Default
								Data Type: Class Default
								Justify: Class Default
								Width:  1.4"
								Width Editable? Class Default
								Format: Class Default
								Country: Class Default
								Input Mask: Class Default
								Cell Options
									Cell Type? Class Default
									Multiline Cell? Class Default
									Cell DropDownList
										Sorted? Class Default
										Vertical Scroll? Class Default
										Auto Drop Down? Class Default
										Allow Text Editing? Class Default
									Cell CheckBox
										Check Value:
										Uncheck Value:
										Ignore Case? Class Default
								List Values
								Message Actions
							Column: colRepDT
								Class Child Ref Key: 0
								Class ChildKey: 32
								Class: cColumnLabeled
								Property Template:
								Class DLL Name:
								Title: За 
								Visible? Class Default
								Editable? No
								Maximum Data Length: Class Default
								Data Type: Class Default
								Justify: Class Default
								Width:  0.6"
								Width Editable? Class Default
								Format: Class Default
								Country: Class Default
								Input Mask: Class Default
								Cell Options
									Cell Type? Class Default
									Multiline Cell? Class Default
									Cell DropDownList
										Sorted? Class Default
										Vertical Scroll? Class Default
										Auto Drop Down? Class Default
										Allow Text Editing? Class Default
									Cell CheckBox
										Check Value:
										Uncheck Value:
										Ignore Case? Class Default
								List Values
								Message Actions
							Column: colFileDT
								Class Child Ref Key: 0
								Class ChildKey: 33
								Class: cColumnLabeled
								Property Template:
								Class DLL Name:
								Title: Дата созд.
								Visible? Class Default
								Editable? No
								Maximum Data Length: Class Default
								Data Type: Class Default
								Justify: Class Default
								Width:  1.5"
								Width Editable? Class Default
								Format: Class Default
								Country: Class Default
								Input Mask: Class Default
								Cell Options
									Cell Type? Class Default
									Multiline Cell? Class Default
									Cell DropDownList
										Sorted? Class Default
										Vertical Scroll? Class Default
										Auto Drop Down? Class Default
										Allow Text Editing? Class Default
									Cell CheckBox
										Check Value:
										Uncheck Value:
										Ignore Case? Class Default
								List Values
								Message Actions
							Column: colFileSize
								Class Child Ref Key: 0
								Class ChildKey: 34
								Class: cColumnLabeled
								Property Template:
								Class DLL Name:
								Title: Байт
								Visible? Class Default
								Editable? No
								Maximum Data Length: Class Default
								Data Type: Number
								Justify: Class Default
								Width:  0.8"
								Width Editable? Class Default
								Format: Class Default
								Country: Class Default
								Input Mask: Class Default
								Cell Options
									Cell Type? Class Default
									Multiline Cell? Class Default
									Cell DropDownList
										Sorted? Class Default
										Vertical Scroll? Class Default
										Auto Drop Down? Class Default
										Allow Text Editing? Class Default
									Cell CheckBox
										Check Value:
										Uncheck Value:
										Ignore Case? Class Default
								List Values
								Message Actions
							Column: colSort
								Class Child Ref Key: 0
								Class ChildKey: 35
								Class:
								Property Template:
								Class DLL Name:
								Title:
								Visible? No
								Editable? Yes
								Maximum Data Length: Default
								Data Type: String
								Justify: Left
								Width:  Default
								Width Editable? Yes
								Format: Unformatted
								Country: Default
								Input Mask: Unformatted
								Cell Options
									Cell Type? Standard
									Multiline Cell? No
									Cell DropDownList
										Sorted? Yes
										Vertical Scroll? Yes
										Auto Drop Down? No
										Allow Text Editing? Yes
									Cell CheckBox
										Check Value:
										Uncheck Value:
										Ignore Case? Yes
								List Values
								Message Actions
						Functions
						Window Variables
						Message Actions
							On SAM_Create
								Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
								Call SalTblSetTableFlags( hWndForm, TBL_Flag_GrayedHeaders|TBL_Flag_SingleSelection, FALSE )
								Call SalTblSetTableFlags( hWndForm, TBL_Flag_SuppressRowLines|TBL_Flag_SuppressLastColLine, TRUE )
							On SAM_DoubleClick
								Call SalSendMsg (pbView, SAM_Click, 0, 0 )
							On SAM_SetFocus
								If colFileSize >= 0
									Call SalSendMsg(tblLstFiles, SAM_TblDoDetails, 0, 0)
							On SAM_TblDoDetails
								Call SalEnableWindow(pbView)
								If bRO
									Call SalDisableWindow(pbPrint)
								Else
									Call SalEnableWindow(pbPrint)
					Data Field: dfPath
						Class Child Ref Key: 0
						Class ChildKey: 13
						Class:
						Property Template:
						Class DLL Name:
						Data
							Maximum Data Length: Default
							Data Type: String
							Editable? Yes
						Display Settings
							Window Location and Size
								Left:   7.15"
								Top:    2.881"
								Width:  2.386"
								Width Editable? Yes
								Height: 0.3"
								Height Editable? Yes
							Visible? Yes
							Border? Yes
							Justify: Left
							Format: Unformatted
							Country: Default
							Font Name: Default
							Font Size: 10
							Font Enhancement: Default
							Text Color: Default
							Background Color: Default
							Input Mask: Unformatted
						Message Actions
							On WM_LbuttonDblClick
								Call SalModalDialog(dlg_DirSelect, hWndForm)
							! ======  Это сообщение будет посылатся каждый раз когда в dfPath ===============================
									!======  (путь к отчету) будет меняться  - т.е. будем перечитывать содержимое каталога==========
							On SAM_User
								Set strFileMask= IifS(tblReps.maska=STRING_Null,   NumberToStrFormat (tblReps.Kod, 3, '0',TRUE) ||'*.*' 
										                                   ,tblReps.maska )
								Set nFiles=VisDosEnumFiles( strPrintPath || '\\' || strFileMask, FA_Standard, strFileList)
								Call SalTblReset( tblLstFiles )
								! ===  сфокусируем на только что созданном файле
								Set nI = 0
								Set nNewRow=0
								Set strFileNewAdded =  IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt)  
								While nI < nFiles
									Call SalTblInsertRow ( tblLstFiles, nNewRow )					
									Call SalTblSetContext ( tblLstFiles, nNewRow )					
									Call SalTblSetRowFlags( tblLstFiles, nNewRow ,ROW_New, FALSE)
									Set tblLstFiles.colFileName = strFileList[ nI ]
									!
									Call SalFileGetDateTime( strPrintPath || '\\' || strFileList[ nI ],  dFileDT )
									Set tblLstFiles.colFileDT =SalFmtFormatDateTime ( dFileDT, 'dd-MM-yy  hhhh:mm'  )
									Set tblLstFiles.colSort = SalFmtFormatDateTime ( dFileDT, 'yyyyMMddhhhhmm'  )
									!
									Set tblLstFiles.colFileSize = VisFileGetSize( strPrintPath || '\\' || strFileList[ nI ] )
									Set tblLstFiles.colRepDT = GetDigitForChar (  SalStrMidX ( strFileList[ nI ], 3, 1 ) ) || '-' || GetDigitForChar ( SalStrMidX ( strFileList[ nI ], 4, 1 ) )
									If lstFiles[nI] = strFileNewAdded
										Set nNewAdded = nI
									Set nI = nI + 1
								If (  nNewAdded  != -1)
									Call SalTblSetContext ( tblLstFiles, nNewAdded )
								If not SalTblSortRows( tblLstFiles, SalTblQueryColumnID( tblLstFiles.colSort ), TBL_SortDecreasing )
									Call Debug('Cannot sort By '||SalNumberToStrX(SalWindowHandleToNumber (hColumn),0))
					Custom Control: cSpltMain
						Class Child Ref Key: 0
						Class ChildKey: 14
						Class: cXSalVSplitter
						Property Template:
						Class DLL Name:
						Display Settings
							DLL Name:
							MS Windows Class Name:
							Style:  Class Default
							ExStyle:  Class Default
							Title:
							Window Location and Size
								Left:   0.186"
								Top:    0.24"
								Width:  8.7"
								Width Editable? Class Default
								Height: 4.0"
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Etched Border? Class Default
							Hollow? Class Default
							Vertical Scroll? Class Default
							Horizontal Scroll? Class Default
							Tab Stop? Class Default
							Tile To Parent? Yes
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							DLL Settings
						Message Actions
					Custom Control: cCalendarFrom
.data CLASSPROPSSIZE
0000: 4400
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010000
0020: 0200000001010101 0101000000000000 01000000000A6464 2F4D4D2F79797979
0040: 00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
						Class Child Ref Key: 0
						Class ChildKey: 15
						Class: cCalendarDropDown
						Property Template:
						Class DLL Name:
						Display Settings
							DLL Name:
							MS Windows Class Name:
							Style:  Class Default
							ExStyle:  Class Default
							Title:
							Window Location and Size
								Left:   7.05"
								Top:    1.488"
								Width:  1.2"
								Width Editable? Class Default
								Height: 0.25"
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Etched Border? Class Default
							Hollow? Class Default
							Vertical Scroll? Class Default
							Horizontal Scroll? Class Default
							Tab Stop? Class Default
							Tile To Parent? Class Default
							Font Name: Class Default
							Font Size: 12
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							DLL Settings
						Message Actions
							On SAM_Create
								Call GetMonthArray( strMonth ) 
								Call GetWeekDayArray( strWeekDays )
								Call cCalendarFrom.SetMonthText( strMonth ) 
								Call cCalendarFrom.SetWeekDayText( strWeekDays )
								! ! - - - - - - - - - - - - Инициализация дат календаря  cCalendarFrom - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - -
								Call cCalendarFrom.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Sunday, SEQ_Unset,  COLOR_Black, COLOR_Gray, TRUE)
								Call cCalendarFrom.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Monday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
								Call cCalendarFrom.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Tuesday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
								Call cCalendarFrom.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Wednesday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
								Call cCalendarFrom.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Thursday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
								Call cCalendarFrom.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Friday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
								Call cCalendarFrom.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Saturday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
								Call cCalendarFrom.SpecialDate(SPECIAL_OneTime, GetBankDate(), DAY_Unset, SEQ_Unset, COLOR_Blue,  COLOR_Cyan, TRUE)
								Call SqlPrepareAndExecute(  hSql(), T("SELECT fdat  INTO :dSelect  FROM fdat")  )
								Set nI = 0
								While SqlFetchNext(hSql(), nFetchRes)
									Call cCalendarFrom.SpecialDate(SPECIAL_OneTime, dSelect,  DAY_Unset, SEQ_Unset, COLOR_Blue, COLOR_Cyan, TRUE)
									Set nI = nI + 1
								If nI = 0
									! Нет доступных дат для выбора
									Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Out.cTMsgDat'),
											     CurrentLangTable.GetAtomTitle('cTAt'), 0)
								Call SalSetWindowText(  cCalendarFrom,  strBankDate)
							On SAM_User
								Call SalGetWindowText( hWndItem, strDateFrom, 12 )
					Custom Control: cCalendarTo
.data CLASSPROPSSIZE
0000: 4400
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010000
0020: 0200000001010101 0101000000000000 01000000000A6464 2F4D4D2F79797979
0040: 00000000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
						Class Child Ref Key: 0
						Class ChildKey: 16
						Class: cCalendarDropDown
						Property Template:
						Class DLL Name:
						Display Settings
							DLL Name:
							MS Windows Class Name:
							Style:  Class Default
							ExStyle:  Class Default
							Title:
							Window Location and Size
								Left:   8.75"
								Top:    1.524"
								Width:  0.914"
								Width Editable? Class Default
								Height: 0.25"
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Etched Border? Class Default
							Hollow? Class Default
							Vertical Scroll? Class Default
							Horizontal Scroll? Class Default
							Tab Stop? Class Default
							Tile To Parent? Class Default
							Font Name: Class Default
							Font Size: 12
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							DLL Settings
						Message Actions
							On SAM_Create
								Call GetMonthArray( strMonth ) 
								Call GetWeekDayArray( strWeekDays )
								Call cCalendarTo.SetMonthText( strMonth ) 
								Call cCalendarTo.SetWeekDayText( strWeekDays )
								! ! - - - - - - - - - - - - Инициализация дат календаря  cCalendarTo - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - -
								Call cCalendarTo.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Sunday, SEQ_Unset,  COLOR_Black, COLOR_Gray, TRUE)
								Call cCalendarTo.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Monday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
								Call cCalendarTo.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Tuesday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
								Call cCalendarTo.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Wednesday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
								Call cCalendarTo.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Thursday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
								Call cCalendarTo.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Friday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
								Call cCalendarTo.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Saturday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
								Call cCalendarTo.SpecialDate(SPECIAL_OneTime, GetBankDate(), DAY_Unset, SEQ_Unset, COLOR_Blue,  COLOR_Cyan, TRUE)
								Call cCalendarTo.SpecialDate(SPECIAL_OneTime, GetBankDate(), DAY_Unset, SEQ_Unset, COLOR_Blue,  COLOR_Cyan, TRUE)
								Call SqlPrepareAndExecute(  hSql(), T("SELECT fdat  INTO :dSelect  FROM fdat")  )
								Set nI = 0
								While SqlFetchNext(hSql(), nFetchRes)
									Call cCalendarTo.SpecialDate(SPECIAL_OneTime, dSelect,  DAY_Unset, SEQ_Unset, COLOR_Blue, COLOR_Cyan, TRUE)
									Set nI = nI + 1
								If nI = 0
									! Нет доступных дат для выбора
									Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Out.cTMsgDat'), 
											     CurrentLangTable.GetAtomTitle('cTAt'),0)
								Call SalSetWindowText(  cCalendarTo,  strBankDate )
							On SAM_User
								Call SalGetWindowText( hWndItem, strDateTo, 12 )
					Custom Control: cSpltRightB
						Class Child Ref Key: 0
						Class ChildKey: 17
						Class: cXSalHSplitterInvisible
						Property Template:
						Class DLL Name:
						Display Settings
							DLL Name:
							MS Windows Class Name:
							Style:  Class Default
							ExStyle:  Class Default
							Title:
							Window Location and Size
								Left:   7.017"
								Top:    2.738"
								Width:  5.867"
								Width Editable? Class Default
								Height: 2.202"
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Etched Border? Class Default
							Hollow? Class Default
							Vertical Scroll? Class Default
							Horizontal Scroll? Class Default
							Tab Stop? Class Default
							Tile To Parent? Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							DLL Settings
						Message Actions
					Custom Control: cSpltRight
						Class Child Ref Key: 0
						Class ChildKey: 18
						Class: cXSalHSplitter
						Property Template:
						Class DLL Name:
						Display Settings
							DLL Name:
							MS Windows Class Name:
							Style:  Class Default
							ExStyle:  Class Default
							Title:
							Window Location and Size
								Left:   6.733"
								Top:    0.107"
								Width:  6.3"
								Width Editable? Class Default
								Height: 4.917"
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Etched Border? Class Default
							Hollow? Class Default
							Vertical Scroll? Class Default
							Horizontal Scroll? Class Default
							Tab Stop? Class Default
							Tile To Parent? Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							DLL Settings
						Message Actions
					Custom Control: cSpltRightT
						Class Child Ref Key: 0
						Class ChildKey: 19
						Class: cXSalHSplitterInvisible
						Property Template:
						Class DLL Name:
						Display Settings
							DLL Name:
							MS Windows Class Name:
							Style:  Class Default
							ExStyle:  Class Default
							Title:
							Window Location and Size
								Left:   6.867"
								Top:    0.19"
								Width:  5.983"
								Width Editable? Class Default
								Height: 2.024"
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Etched Border? Class Default
							Hollow? Class Default
							Vertical Scroll? Class Default
							Horizontal Scroll? Class Default
							Tab Stop? Class Default
							Tile To Parent? Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							DLL Settings
						Message Actions
					Custom Control: cSpltRightTB
						Class Child Ref Key: 0
						Class ChildKey: 20
						Class: cXSalVSplitterInvisible
						Property Template:
						Class DLL Name:
						Display Settings
							DLL Name:
							MS Windows Class Name:
							Style:  Class Default
							ExStyle:  Class Default
							Title:
							Window Location and Size
								Left:   6.983"
								Top:    1.369"
								Width:  2.9"
								Width Editable? Class Default
								Height: 0.51"
								Height Editable? Class Default
							Visible? Class Default
							Border? Class Default
							Etched Border? Class Default
							Hollow? Class Default
							Vertical Scroll? Class Default
							Horizontal Scroll? Class Default
							Tab Stop? Class Default
							Tile To Parent? Class Default
							Font Name: Class Default
							Font Size: Class Default
							Font Enhancement: Class Default
							Text Color: Class Default
							Background Color: Class Default
							DLL Settings
						Message Actions
				Class Variables
				Instance Variables
					Number: nMode	! № папки (0 - все, 999999999 - без папки)
					!
					Boolean: isRepSec
					Boolean: isRepACode
					Boolean: bRO
					String: sRepDbAs
					Number: nWndX
					Number: nWndY
					String: strPath   
					String: strFileMask
					! - -  Эти переменные есть в главных обьявлениях по возможности их нужно от туда убрать
					Number: tek  !! текущая строка выбраного отчета
					Number: nFilesForPrn[*]       !! Если выбрали для печати несколько файлов
					Number: nI
					Date/Time: dSelect                !!
					Date/Time: dFileDT               !!
					! - - - Переменные для вычитки инфы о файлах 
					String: strFileList[*]
					Number: nNewRow
					Number: nNewAdded   
					String: strFileNewAdded
					Window Handle: hColumn  
					Number: nOrderBy   
					Number: nOrderByDT   
					Number: nRow
					Number: nKod
					!
					Number: nError                    !! Для возврата ошибок при вызове SalCompileAndEvaluate
					Number: nErrorPos              !!  - -//- -  
					Number: nRet                      !!  - -//- -  
					String: strRet                       !!  - -//- - 
					Date/Time: dtRet                 !!  - -//- -
					Window Handle: hWndRet   !!  - -//- -
					!
					String: sTmpParams
					Number: nLen
					Date/Time: dDat
				Functions
					Function: DisablePb
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
						Actions
							Call SalDisableWindow(pbWord)
							Call SalDisableWindow(pbTxt)
							Call SalDisableWindow(pbXML)
							Call SalDisableWindow(pbView)
							Call SalDisableWindow(pbPrint)
					Function: DirectView	
						Description: Функция просмотра документов
						Returns
							Boolean:
						Parameters
							String: strFName
							String: sACode
						Static Variables
						Local variables
							Boolean: fRet
						Actions
							Set fRet = SalLoadApp('DVIEW.EXE' || IifS(sACode="RO", ' /NOPRN', ''), SalStrUpperX(strFName))
							Return fRet
					Function: ExportXML1	!Временная для Сбербанка (из zapros без параметров)
						Description:
						Returns
						Parameters
							Number: nKODZ
						Static Variables
						Local variables
							String: sFileName
							File Handle: hF
							Number: nL
							Number: i
							Long String: sXML
						Actions
							If SqlPrepareAndExecute(hSql(), 
									"SELECT namef, dbms_lob.getlength(xsl_data) 
									 INTO :sFileName, :nL 
									 FROM zapros WHERE kodz=:nKODZ" ) AND 
									SqlFetchNext( hSql(), nFetchRes )
								If nL > 0
									If sFileName = ''
										Set sFileName = GetPrnDir() ||'\\'|| NumberToStrFormat (tblReps.Kod, 3, '0',TRUE)  ||
												GetCharForDigit( SalStrToNumber( SalStrMidX(strDateFrom, 0, 2) ) )||
												GetCharForDigit( SalStrToNumber( SalStrMidX(strDateFrom, 3, 2) ) )||
												NumberToStrFormat (GetUserId(),3, '0',TRUE) || '.txt'
									If SqlPLSQLCommand( hSql(), "n_(nKODZ)" )
										Call SqlCommit( hSql() )
										Call SqlPrepareAndExecute(hSql(), 
												"SELECT dbms_lob.getlength(xml_data)
												 INTO :nL
												 FROM xml_storage
												 WHERE uri=to_char(:nKODZ) ")
										Call SqlFetchNext(hSql(),nFetchRes)
										Call SalFileOpen( hF, sFileName, OF_Create|OF_Write|OF_Text )
										If nL > 0
											Call SqlSetLongBindDatatype( 1, 22 )
											Set i = 1
											While i < nL
												Call SqlPrepareAndExecute(hSql(), 
														"SELECT dbms_lob.substr((select xml_data from xml_storage
														        where uri=to_char(:nKODZ)),2000,:i)
														 INTO :sXML
														 FROM dual")
												Call SqlFetchNext(hSql(), nFetchRes)
												Call SalFileSeek( hF, i-1, FILE_SeekBegin )
												Call SalFileWrite( hF, sXML, 2000 )
												Set i = i + 2000
										Call SalFileClose( hF )
								Else
									Call SalMessageBox('Отсутствует XSL-выражение для запроса №' || SalNumberToStrX( nKODZ, 0 ) || '!' || PutCrLf() ||
											     'Невозможно создать XML-отчет.', 'Внимание!', MB_IconStop | MB_Ok)
							Else
								Call SalMessageBox('Нельзя прочитать параметры запроса №' || SalNumberToStrX( nKODZ, 0 ) || '!', 'Ошибка', MB_IconStop | MB_Ok)
					Function: ClearPrnDir
						Description:
						Returns
							Boolean:
						Parameters
							String: sPrnDir
						Static Variables
						Local variables
							String: smFile[*]
							Number: nCount
							Number: i
						Actions
							Call SalArraySetUpperBound(smFile, 1, -1)
							Set nCount = VisDosEnumFiles(sPrnDir || '\\*.*', FA_Standard, smFile)
							If nCount > 0 ! обработка файлов
								Set i = 0
								While i < nCount
									Call VisFileSetAttribute(sPrnDir || '\\' || smFile[i], FA_ReadOnly, FALSE)
									Call VisFileDelete(sPrnDir || '\\' || smFile[i])
									Set i = i + 1
							Return TRUE
				Message Actions
					On SAM_Create
						Call SetWindowFullSize(hWndForm)
						Call SetWindowFont(hWndForm)
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
						Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_Out.cTWndTitle'))
						Call XSalTooltipSetUserDefault()
						If GetGlobalOption('XMLAPPLY') != '1'
							Call SalHideWindow(pbXML)
						Set isRepSec   = GetGlobalOption('REP_SEC')  = '1'
						Set isRepACode = GetGlobalOption('REPACODE') = '1'
						Set sRepDbAs = GetGlobalOption('REPDBAS')
						!
						Call cSpltMain.setLeftFrame(tblReps)
						Call cSpltMain.setRightFrame(cSpltRight)
						Call cSpltMain.setBarPosition(650)
								
						Call cSpltRight.setBarSize(20)
						Call cSpltRight.setTopFrame(cSpltRightT)
						Call cSpltRight.setBottomFrame(cSpltRightB)
						Call cSpltRight.setBarPosition(110)
						Call cSpltRight.setStyle(XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE)
								
						Call cSpltRightB.setBarSize(1)
						Call cSpltRightB.setBarPosition(84)
						Call cSpltRightB.setStyle(XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE)
						Call cSpltRightB.setTopFrame(dfPath)
						Call cSpltRightB.setBottomFrame(tblLstFiles)
								
						Call cSpltRightT.setBarSize(1)
						Call cSpltRightT.setBarPosition(490)
						Call cSpltRightT.setStyle(XSalSplitter_NotResizable | XSalSplitter_Frame1AbsSize, TRUE)
						Call cSpltRightT.setBottomFrame(cSpltRightTB)
						Call cSpltRightT.setTopFrame(SalCreateWindowEx( frm_Lables, hWndForm, 0,0,0,0, CREATE_AsChild))
						Call cSpltRightTB.setRightFrame(cCalendarTo)
						Call cSpltRightTB.setLeftFrame(cCalendarFrom)
						Call cSpltRightTB.setBarSize(1)
								
						! ! - - - -  Это сделано чтоб перерисвывались Lables
						Call SalGetWindowSize(hWndForm, nWndX, nWndY)
						Call SalSetWindowSize(hWndForm, nWndX, nWndY)
								
						Set strPrintPath = GetPrnDir()
						Set dfPath = strPrintPath
						If isRepSec
							Call ClearPrnDir(strPrintPath)
						!
						! - - - - - - - - - -  Инициализация переменных - - - - - - - - - - - 
						Call DisablePb()
						Set AMFO = GetBankMfo()
						! Set bFLS = GetAccountStructure(nTmp, nTmp, nTmp, nTmp)
								  ! Старый план счетов
						Set tek = 0
						Set FL_FORMAT = FALSE          !! По умолчанию текстовый формат
						Set AQH = GetBankName()
						Set strBankDate = SalFmtFormatDateTime( GetBankDate(), 'dd/MM/yyyy')
						Set app = GetCodeApp()
						Set ID = GetUserId()
						Call SqlPrepareAndExecute(hSql(), T("
								     SELECT fio
								     INTO :IDNAME
								     FROM staff
								     WHERE id=:ID"))
						Call SqlFetchNext(hSql(), nFetchRes)
					On WM_Size
						If wParam = SIZE_MAXIMIZED
							Call SetWindowFullSize(hWndForm)
					On SAM_CreateComplete
						Call WaitCursorOff()
					On SAM_Destroy
						If isRepSec
							Call ClearPrnDir(strPrintPath)
						If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
							Call XRoleUnset(hSql(), 'ShowOutForms(hWndMDI,' ||
									     SalNumberToStrX(nMode,0) || ')')
						Set hFrm_Out=hWndNULL
			Functional Class: cQueryBind
				Description: Описывает структуру бинд-переменных
				Derived From
				Class Variables
				Instance Variables
					String: sName
					String: sSemantic
					String: sType
					String: sVal
					String: sDescSQL    ! SQL строка, которая описывает параметр
				Functions
		Default Classes
			MDI Window: cBaseMDI
			Form Window:
			Dialog Box:
			Table Window:
			Quest Window:
			Data Field:
			Spin Field:
			Multiline Field:
			Pushbutton: ctb_pbCancel
			Radio Button: cRadioButtonLabeled
			Option Button:
			Check Box:
			Child Table:
			Quest Child Window: cQuickDatabase
			List Box:
			Combo Box: cGenComboBox_NumId
			Picture:
			Vertical Scroll Bar:
			Horizontal Scroll Bar:
			Column:
			Background Text:
			Group Box:
			Line:
			Frame:
			Custom Control: cXSalVSplitterInvisible
		Application Actions
			On SAM_AppStartup
				! Set AMFO=GetBankMfo()
				! Set AQH=GetBankName()
				! Set AQH=StrWinToDosX(AQH)
	Dialog Box: dlg_RepListF  !! Папки отчетов
		Class:
		Property Template:
		Class DLL Name:
		Title: Папки отчетов
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   0.625"
				Top:    0.625"
				Width:  8.083"
				Width Editable? Yes
				Height: 5.417"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Список папок отчетов с древовидным интерфейсом
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			List Box: lbReportsF
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cOutlineListBox
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   0.043"
					Top:    0.042"
					Width:  7.871"
					Width Editable? Class Default
					Height: 4.219"
					Height Editable? Class Default
				Visible? Class Default
				Multiple selection? Class Default
				Sorted? Yes
				Vertical Scroll? Class Default
				Font Name: Arial Cyr
				Font Size: 9
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: 3D Highlight Color
				Horizontal Scroll? Yes
				List Initialization
				Message Actions
					On SAM_Create
						Call lbReportsF.SetStyle( LBS_ShowNoTree | LBS_ShowHorzScrollBar | LBS_ShowSelectTextPicture | LBS_VisExtensions |  LBS_FmtMixedcase)
						Call nRepNodes.Init( )
						Set hRoot = lbReportsF.GetRoot()
						Set nNodeId = -1
						If hRoot
							Call nRepNodes.New(0, hRoot, nNodeId, 'Отчеты', 'ошибка построения меню', '', '', 0)
							Call SqlPrepareAndExecute(hSql(),
									"SELECT distinct nvl(f.idf,999999999), nvl(f.name,' ...') 
									 INTO :nIdF, :sNameF 
									 FROM reports r, reportsf f, app_rep a 
									 WHERE a.codeapp=:sAppName AND a.coderep=r.id AND r.idf=f.idf(+) 
									 UNION 
									 SELECT 0, ' " || CurrentLangTable.GetAtomTitle('dlg_RepListF.cTAll') || "' FROM dual 
									 ORDER BY 2 ")
							While SqlFetchNext(hSql(), nFetchRes)
								Set hCurNode = lbReportsF.LoadChild( hRoot, hPicFolderNormal, hPicFolderNormal, sNameF, nIdF, 0 )
								Set nNodeId  = nNodeId - 1
								Call nRepNodes.New( nNodeId, hCurNode, 0, sNameF, '', '', '', 0)
							Call lbReportsF.ShowOutline( 0 )
					On SAM_Click
						Call SalSendClassMessage( SAM_Click, wParam, lParam)
						Set nIndexItem = VisListGetFocusIndex(hWndItem)
					On SAM_DoubleClick
						Call SalSendClassMessage( SAM_DoubleClick, wParam, lParam)
						Set nIndexItem = VisListGetFocusIndex( hWndItem )
						Call SalSendMsg( pbAction, SAM_Click, nIndexItem, 0 )
			Pushbutton: pbAction
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbDetail
				Property Template:
				Class DLL Name:
				Title: Открыть
				Window Location and Size
					Left:   4.9"
					Top:    4.344"
					Width:  1.443"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Enter
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set nIdF = lbReportsF.GetItemValue( lbReportsF.GetItemHandle( nIndexItem ))
						Set nMode = nIdF
						Call SalEndDialog(hWndForm, TRUE)
			Pushbutton: pbExit
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   6.429"
					Top:    4.344"
					Width:  1.443"
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Esc
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, FALSE)
		Functions
		Window Parameters
			Receive Number: nMode
		Window Variables
			Number: hPicFolderNormal
			String: sAppName
			!
			: nRepNodes
				Class: cNodeList
			Number: hRoot
			Number: hCurNode
			Number: nNodeId
			Number: nIndexItem
			!
			Number: nIdF
			String: sNameF
			!
			Number: nListWidth
			Number: nListHeight
			Number: nButtonTop
			Number: nButtonLeft
		Message Actions
			On SAM_Create
				Call SalCenterWindow(hWndForm)
				Call SetWindowFont(hWndForm)
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('dlg_RepListF.cTWndTitle') )
				Set hPicFolderNormal = VisPicLoad( PIC_LoadSWinRes | PIC_FormatIcon | PIC_LoadSmallIcon, 'ICO_Folder', '' )
				Set sAppName = GetCodeApp()
			On SAM_Destroy
				Call VisPicFree(hPicFolderNormal)
				Call SalSetFocus(SalParentWindow(hWndForm))
			On WM_Size
				Call GetClientRect( hWndForm, nButtonTop, nButtonLeft, nListWidth, nListHeight )
				Set nButtonLeft = SalPixelsToFormUnits( hWndForm, nListWidth, FALSE ) - 3.4
				Set nButtonTop = SalPixelsToFormUnits( hWndForm, nListHeight, TRUE ) - 0.55
				Set nListWidth = SalPixelsToFormUnits( hWndForm, nListWidth, FALSE )
				Set nListHeight = SalPixelsToFormUnits( hWndForm, nListHeight, TRUE )
				Call SalSetWindowLoc( lbReportsF, 0, 0 )
				Call SalSetWindowSize( lbReportsF, nListWidth, nListHeight - 0.7 )
				Call SalSetWindowLoc( pbAction, nButtonLeft, nButtonTop )
				Call SalSetWindowLoc( pbExit, nButtonLeft + 1.7, nButtonTop )
	Dialog Box: dlg_mas2
		Class:
		Property Template:
		Class DLL Name:
		Title: ОТБОР  ПРОВОДОК  ДЛЯ  ПЕЧАТИ
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   0.625"
				Top:    0.625"
				Width:  5.533"
				Width Editable? Yes
				Height: 1.76"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Маска отбора
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: "Маска"  ДЕБЕТА счета:
				Resource Id: 18054
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.186"
					Top:    0.119"
					Width:  3.029"
					Width Editable? Yes
					Height: 0.19"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Dark Red
				Background Color: Default
			Data Field: bgMaskaD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: masD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 14
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.257"
						Top:    0.094"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Red
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Background Text: "Маска"  КРЕДИТА счета:
				Resource Id: 61437
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.043"
					Top:    0.488"
					Width:  3.143"
					Width Editable? Yes
					Height: 0.19"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Midnight Blue
				Background Color: Default
			Data Field: bgMaskaC
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: masK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 14
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.243"
						Top:    0.469"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Dark Blue
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pb1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Утвердить
				Window Location and Size
					Left:   0.557"
					Top:    1.01"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.344"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Enter
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set masD=SalStrTrimX(masD)
						Set masK=SalStrTrimX(masK)
						Call SalEndDialog(hWndForm, 0)
			Pushbutton: pb2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Отказаться
				Window Location and Size
					Left:   2.843"
					Top:    1.01"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.344"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Esc
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Dark Red
				Background Color: Default
				Message Actions
					On SAM_Click
						Set masD='-'
						Call SalEndDialog(hWndForm, 0)
		Functions
		Window Parameters
			Receive String: maskD
			Receive String: maskK
		Window Variables
		Message Actions
			On SAM_Create
				Call SalCenterWindow(hWndForm)
				Call SetWindowFont(hWndForm)
				Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
				Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('dlg_mas2.cTWndTitle') )
				Set masD='*'
				Set masK='*'
			On SAM_Destroy
				Set maskD= StrMatches2Like( masD )
				Set maskK= StrMatches2Like( masK )
	Dialog Box: dlg_PROV
		Class:
		Property Template:
		Class DLL Name:
		Title: ОТБОР проводок для печати реестра
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   0.625"
				Top:    0.625"
				Width:  8.883"
				Width Editable? Yes
				Height: 2.167"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: Код операции:
				Resource Id: 41072
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    0.06"
					Width:  2.029"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: TT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 3
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.317"
						Top:    0.024"
						Width:  0.671"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If SqlPrepareAndExecute( hSql(),
								"SELECT tt,name INTO :tt, :sTT FROM  tts WHERE tt=:TT")
								and SqlFetchNext( hSql(), nTmp ) 
						Return VALIDATE_Ok
			Data Field: sTT
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.0"
						Top:    0.024"
						Width:  5.614"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Background Text: Код валюты:
				Resource Id: 41073
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    0.274"
					Width:  2.029"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: KV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 3
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.317"
						Top:    0.238"
						Width:  0.671"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If SqlPrepareAndExecute( hSql(),
								  "SELECT kv,name INTO :kv,:sKV FROM tabval WHERE kv=:KV")
								and SqlFetchNext(  hSql(), nTmp )
						Return VALIDATE_Ok
			Data Field: sKV
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.0"
						Top:    0.238"
						Width:  5.614"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Background Text: Маска Сч.дебет:
				Resource Id: 41074
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    0.5"
					Width:  2.029"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: NLSD
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.317"
						Top:    0.464"
						Width:  2.357"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						Set nlsd=SalStrTrimX(StrMatches2Like( NLSD ))
						Return VALIDATE_Ok
			!
			Background Text: Маска Сч.кредит:
				Resource Id: 41075
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    0.738"
					Width:  2.029"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: NLSK
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.317"
						Top:    0.702"
						Width:  2.357"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						Set nlsk=SalStrTrimX(StrMatches2Like( NLSK ))
						Return VALIDATE_Ok
			!
			Background Text: Код исполнителя
				Resource Id: 733
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.183"
					Top:    1.0"
					Width:  2.029"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: ISP
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 3
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.317"
						Top:    0.964"
						Width:  0.671"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If SqlPrepareAndExecute( hSql(),
								  "SELECT id,fio INTO :isp,:sFIO FROM staff WHERE id=:ISP")
								and SqlFetchNext(  hSql(), nTmp )
						Return VALIDATE_Ok
			Data Field: sFIO
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   3.0"
						Top:    0.964"
						Width:  5.614"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			!
			Pushbutton: pb1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Утвердить
				Window Location and Size
					Left:   3.517"
					Top:    1.44"
					Width:  1.529"
					Width Editable? Yes
					Height: 0.344"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Enter
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set shap=sTT||" "||sKV
						Call SalEndDialog(hWndForm, 1)
		Functions
		Window Parameters
			Receive String: tt
			Receive Number: kv
			Receive String: nlsd
			Receive String: nlsk
			Receive String: shap
			Receive Number: isp
		Window Variables
			Number: nTmp
		Message Actions
			On SAM_Create
				Call SalCenterWindow(hWndItem)
				Set KV=kv
				Set ISP=isp
			On SAM_Destroy
	Dialog Box: dlg_mas
		Class:
		Property Template:
		Class DLL Name:
		Title: ОТБОР  СЧЕТОВ  ДЛЯ  ПЕЧАТИ
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   0.625"
				Top:    0.625"
				Width:  5.533"
				Width Editable? Yes
				Height: 1.5"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Маска отбора
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: "Маска" для отбора:
				Resource Id: 41076
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.057"
					Top:    0.125"
					Width:  2.529"
					Width Editable? Yes
					Height: 0.19"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: bgMaska
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Data Field: mas
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 14
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   2.657"
						Top:    0.107"
						Width:  2.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pb1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Утвердить
				Window Location and Size
					Left:   0.557"
					Top:    0.594"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.344"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Enter
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Set mas=SalStrTrimX(mas)
						Call SalEndDialog(dlg_mas, 0)
			Pushbutton: pb2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Отказаться
				Window Location and Size
					Left:   2.843"
					Top:    0.594"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.344"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Esc
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Dark Red
				Background Color: Default
				Message Actions
					On SAM_Click
						Set mas='-'
						Call SalEndDialog(dlg_mas, 0)
		Functions
		Window Parameters
			Receive String: mask
			String: slovo
		Window Variables
		Message Actions
			On SAM_Create
				Call SalCenterWindow(hWndForm)
				Call SetWindowFont(hWndForm)
				Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
				Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('dlg_mas.cTWndTitle') )
				! Call SalSetWindowText( hWndForm," ОТБОР "||slovo||" для печати")
				Call SalSetWindowText( hWndForm, slovo )
				Set mas=mask
			On SAM_Destroy
				Set mask=   StrMatches2Like( mas )
				! Set mask=IifS( mas !='*',  StrMatches2Like( mas ) ,   '' )
				! Set mask=IifS( mas !='*',  " and trim(Nls) LIKE \'" || StrMatches2Like( mas ) || "\'",   ' ' )
	Dialog Box: dlg_PeriodSet
		Class:
		Property Template:
		Class DLL Name:
		Title: Установка периода отчета
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  5.514"
				Width Editable? Yes
				Height: 1.49"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Установить период времени для отчета
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: С:
				Resource Id: 24847
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.386"
					Top:    0.208"
					Width:  0.457"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfDate1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 10
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   0.971"
						Top:    0.167"
						Width:  1.586"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If SalIsNull( hWndItem )
							Return VALIDATE_OkClearFlag
						If NOT SalIsValidDateTime( hWndItem )
							Call SalMessageBox('Неверный формат даты!', 'Внимание!', MB_Ok)
							Return VALIDATE_Cancel
						Set strDat1 = dfDate1
						Return VALIDATE_Ok
			Background Text: По:
				Resource Id: 24848
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   2.7"
					Top:    0.208"
					Width:  0.529"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Data Field: dfDate2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: 10
					Data Type: String
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   3.314"
						Top:    0.167"
						Width:  1.586"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
					On SAM_Validate
						If SalIsNull( hWndItem )
							Return VALIDATE_OkClearFlag
						If NOT SalIsValidDateTime( hWndItem )
							Call SalMessageBox('Неверный формат даты!', 'Внимание!', MB_Ok)
							Return VALIDATE_Cancel
						Set strDat1 = dfDate2
						Return VALIDATE_Ok
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Утвердить
				Window Location and Size
					Left:   0.657"
					Top:    0.625"
					Width:  1.7"
					Width Editable? Yes
					Height: 0.333"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: Enter
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						If SalIsNull (dfDate1) Or SalIsNull (dfDate2)
							Call SalMessageBox('Незаполнены поля дат!', 'Внимание!', MB_Ok)
							Return FALSE
						Call SalEndDialog( hWndForm, 1 )
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Отказаться
				Window Location and Size
					Left:   3.0"
					Top:    0.625"
					Width:  1.7"
					Width Editable? Yes
					Height: 0.333"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Dark Red
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( hWndForm, 0 )
		Functions
		Window Parameters
			Receive String: strDat1
			Receive String: strDat2
		Window Variables
		Message Actions
			On SAM_Create
				Call SalCenterWindow( hWndForm )
				Set dfDate1 = strDat1
				Set dfDate2 = strDat2
	Form Window: frm_Ndok
		Class:
		Property Template:
		Class DLL Name:
		Title: Баланс банка
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.838"
				Top:    0.688"
				Width:  7.7"
				Width Editable? Yes
				Height: 3.677"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Документы разные
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
		Functions
		Window Parameters
			String: sdat
			String: sdat2
			Number: para
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			String: ss
			String: maska
			Number: GRK 
			Number: KV
			Number: nKV
			Date/Time: PDAT
			Date/Time: VDAT
			Number: UD
			Number: DK
			Number: REF
			String: ND
			String: MFOA
			String: NLSA
			String: MFOB
			String: NLSB
			String: NLS1
			String: NLS2
			String: TT
			String: TT1
			Number: S
			Number: SQ
			Number: UU
			String: NAM
			String: NAMV
			!
			String: tex1
			String: tex2
			String: strTitle2
			!
			Number: nUserId
			String: shap1
			!
			Number: ISP
			String: WHERE_ISP
			!
			String: DTKB
			Number: DIG
		Message Actions
			On SAM_Create
				Call SetWindowFont(hWndForm)
				Call cCnc.Clone(g_cRepCnc, TRUE)
				Set SHAP = SHAP || ' ' || strDateFrom
				If para != 522 or para != 523 or para != 526 or para != 527
					Set strTitle2 = strDateFrom
				If para = 7 or para = 8
					Set shap1 = 'BLK '
				Set nKV = GetBaseVal()
				Set TT1 = GetBankMfo()
				Set strBind = 'GRK,KV,PDAT,UD,DK,REF,ND,MFOA,NLSA,MFOB,NLSB,S,SQ,TT' ! наши переменные
				Set strInput = strBind
				Set nInd = RPT_NoToolbar ! парамерт для управления печатью отчета
				If para = 1 ! незавизированные N
					Set ss = T("   
							    SELECT c.idchk,o.kv,o.tt,o.pdat,o.userid,o.dk,o.ref,o.nd,o.mfoa,o.nlsa,o.mfob,o.nlsb,o.s/100,
							           gl.p_icurval(o.kv,o.s, :sdat )/100,c.name,t.name
							    FROM oper O, chklist_tts CT, chklist C, tabval T
							    INTO :GRK,:KV,:TT,:PDAT,:UD,:DK,:REF,:ND,:MFOA,:NLSA,:MFOB,:NLSB,:S,:SQ,:NAM,:NAMV
							    WHERE O.sos=:para and O.tt=CT.tt and C.idchk=CT.idchk and t.kv=o.kv and date(o.vdat)<= :sdat  and
							          C.idchk=p_getcatl(o.tt,length(rtrim(o.chk))/6+1)
							    ORDER BY 1,2,3,4,5,6,7,8")
				Else If para = 314 ! реестр для єл кл
					Set strBind = 'GRK,KV,PDAT,UD,DK,REF,ND,MFOA,NLSA,MFOB,NLSB,S,SQ,TT,DTKB'
					Set strInput = strBind
					! Set maska = Maska_NLS("счетов")
					Set maska = Maska_NLS(CurrentLangTable.GetAtomTitle('cTSelectAcc'))
					If maska='-'
						Call SalDestroyWindow( hWndForm )
						Return FALSE
					Set ss = T("
							    SELECT a.kv,o.nlsa,o.nd,o.nlsb,TO_NUMBER(o.mfob),o.nam_b,o.s,o.nazn,TO_NUMBER(c.okpo),c.rnk,c.nmk,a.isp,o.pdat,
							           TO_CHAR(k.datedokkb,'DD/MM/YYYY HH24:MI:SS')
							    INTO :KV,:NLSA,:ND,:NLSB,:DK,:MFOB,:S,:MFOA,:SQ,:REF,:TT,:UD,:PDAT,:DTKB
							    FROM accounts a, oper o, customer c, cust_acc cu, klp k, klpond kp
							    WHERE a.acc=cu.acc and cu.rnk=c.rnk and a.kv=o.kv and a.nls=o.NLSA and o.sos=5 and o.ref=kp.ref and
							          kp.pond=k.pond and kp.filename=k.naex and o.tt like 'KL%' and o.vdat= :sdat and
							          ltrim(rtrim(o.nlsa)) LIKE \'" || SalStrTrimX(maska) || "\'
							    ORDER BY a.isp,c.rnk,a.nls,a.kv,o.s")
				Else If para = 315 ! реестр для єл кл (по виконавцю лише)  
					Set strBind = 'GRK,KV,PDAT,UD,DK,REF,ND,MFOA,NLSA,MFOB,NLSB,S,SQ,TT,DTKB'
					Set strInput = strBind
					! Set maska = Maska_NLS("счетов")
					Set maska = Maska_NLS(CurrentLangTable.GetAtomTitle('cTSelectAcc'))
					If maska='-'
						Call SalDestroyWindow( hWndForm )
						Return FALSE
					Call SqlPrepareAndExecute(cCnc.hSql(), T("
							     SELECT id
							     INTO :nUserId
							     FROM staff
							     WHERE logname=user"))
					Call SqlFetchNext(cCnc.hSql(), nFetchRes)
					Set ss = T("
							    SELECT a.kv,o.nlsa,o.nd,o.nlsb,TO_NUMBER(o.mfob),o.nam_b,o.s,o.nazn,TO_NUMBER(c.okpo),c.rnk,c.nmk,a.isp,o.pdat,
							           TO_CHAR(k.datedokkb,'DD/MM/YYYY HH24:MI:SS')
							    INTO :KV,:NLSA,:ND,:NLSB,:DK,:MFOB,:S,:MFOA,:SQ,:REF,:TT,:UD,:PDAT,:DTKB
							    FROM accounts a, oper o, customer c, cust_acc cu, klp k, klpond kp
							    WHERE a.acc=cu.acc and cu.rnk=c.rnk and a.kv=o.kv and a.nls=o.NLSA and o.sos=5 and o.ref=kp.ref and
							          kp.pond=k.pond and kp.filename=k.naex and a.isp=" || Str(nUserId) || " and o.tt like 'KL%' and
							          o.vdat= :sdat and ltrim(rtrim(o.nlsa)) LIKE \'" || SalStrTrimX(maska) || "\'
							    ORDER BY a.isp,c.rnk,a.nls,a.kv,o.s")
				Else If para = 21 or para = 31 or para = 41 ! РЕЕСТР ПРОВОДОК
						                                            ! за день для КБ
						                                            ! на Украине
					Set TT1 = ''
					If para = 21
						Set nKV = NUMBER_Null
					Set NLS1 = ''
					Set NLS2 = ''
					Set ISP = NUMBER_Null
					If SalModalDialog(dlg_PROV, hWndForm, TT1, nKV, NLS1, NLS2, SHAP, ISP) != 1
						Call SalDestroyWindow(hWndForm)
						Return FALSE
					Set NAM = " p.fdat between  :sdat  and  :sdat2 + 0.9999 "
					If TT1 != ''
						Set NAM = NAM || " and p.tt='" || TT1 || "' "
					If nKV != NUMBER_Null
						Set NAM = NAM || " and p.kv=" || Str(nKV) 
					If NLS1 != ''
						Set NAM = NAM || " and trim(p.nlsd) LIKE \'" || NLS1 || "\'"
					If NLS2 != ''
						Set NAM = NAM || " and trim(p.nlsk) LIKE \'" || NLS2 || "\'"
					If ISP
						Set WHERE_ISP = ' WHERE isp=:ISP '
					Else
						Set WHERE_ISP = ''
					If para = 31
						Set ss = T("
								    SELECT decode(p.tt,o.tt,o.sk,NVL(t.sk,o.sk)),p.nlsd,p.nlsk,p.s
								    FROM provodki p, oper o, tts t
								    INTO :KV,:NLSA,:NLSB,:S
								    WHERE p.ref=o.ref and o.sk>0 and o.sk<40 and t.tt=p.tt and " || NAM || "
								    ORDER BY 1,2,3")
					Else If para = 41
						If strDateTo != strDateFrom
							Set strTitle2 = 'період з ' || strDateFrom || ' по ' || strDateTo
						Set ss = T("
								    SELECT p.nlsk,p.fdat,p.s,decode(o.nlsa,p.nlsk,o.NAM_A,NAM_B),w1.value,'сч.факт: ' || w2.value,p.nazn
								    FROM provodki p, oper o, operw w1, operw w2
								    INTO :NLSB,:PDAT,:S,:MFOA,:MFOB,:NLSA,:TT
								    WHERE p.ref=o.ref and o.sk>0 and o.sk<40 and p.ref=w1.ref(+) and w1.tag(+)='FIO' and p.ref=w2.ref(+) and
								          w2.tag(+)='KOPL' and " || NAM || "
								    ORDER BY 1,2,3")
					Else If para = 21
						If strDateTo != strDateFrom
							Set strTitle2 = 'період з ' || strDateFrom || ' по ' || strDateTo
						Set ss = T("
								    SELECT tt,ref,kv,nlsd,s,gl.p_icurval(kv,s,fdat),nlsk,nazn,fdat       
								    FROM provodki p
								    INTO :TT,:REF,:KV,:NLSA,:S,:SQ,:NLSB,:MFOA,:PDAT
								    WHERE (accd in (select acc from saldo" || WHERE_ISP || ") or
								           acck in (select acc from saldo" || WHERE_ISP || ") ) and " || NAM || "
								   ORDER BY kv,tt,fdat,s")
				! Else If para=-1  ! сторнированные S
					                                                            Set ss=T("   
							    SELECT c.idchk,o.kv,o.tt,o.pdat,o.userid,o.dk,o.ref,o.nd,o.mfoa,o.nlsa,o.mfob,
							           o.nlsb,o.s/100,gl.p_icurval(o.kv,o.s, :sdat )/100,c.name,t.name
							    FROM oper O, chklist_tts CT, chklist C, tabval T
							    INTO :GRK,:KV,:TT,:PDAT,:UD,:DK,:REF,:ND,:MFOA,:NLSA,:MFOB,:NLSB,:S,:SQ,:NAM,:NAMV
							    WHERE O.sos=-1 and O.tt=CT.tt and C.idchk= CT.idchk and t.kv=o.kv and
							          date(o.vdat)= :sdat  and C.idchk=p_getcatl(o.tt,length(rtrim(o.chk))/6)
							    ORDER BY 1,2,3,4,5,6,7,8")
				! Else If para=2   ! оплаченные внутренные и начальные V
					                                                                        Set ss = T("  SELECT 
							 o.kv, o.tt, o.pdat, o.userid,o.dk,  o.ref, o.nd,o.mfoa,o.nlsa,o.mfob,
							  o.nlsb, o.s/100,  gl.p_icurval (o.kv, o.s,  :sdat   )/100, t.name
							FROM  oper O,  tabval T
							INTO :KV, :TT, :PDAT, :UD, :DK,:REF, :ND, :MFOA, :NLSA, :MFOB,  :NLSB, :S, :SQ, :NAMV 
							WHERE  o.sos=5 and  o.tt <>'K2A' and o.mfoa = " || AMFO || " and   t.kv=o.kv  and 
							 date(o.vdat) =  :sdat                      
							ORDER BY 1,2,3,4,5,6 ")
				! Else If para=2.5 ! оплаченные внутренные
					! Изменена сортировка (Ivan)
					                                                                        Set ss = T("  SELECT 
							 o.kv, o.tt, o.pdat, o.userid,o.dk,  o.ref, o.nd,o.mfoa,o.nlsa,o.mfob,
							  o.nlsb, o.s/100,  gl.p_icurval (o.kv, o.s,  :sdat   )/100, t.name
							FROM  oper O,  tabval T
							INTO :KV, :TT, :PDAT, :UD, :DK,:REF, :ND, :MFOA, :NLSA, :MFOB,  :NLSB, :S, :SQ, :NAMV 
							WHERE  o.sos=5 and  
							       o.tt not in ('K2A','K2Q') and 
							       o.mfoa = " || AMFO || " and 
							       o.mfob = " || AMFO || " and 
							       t.kv=o.kv  and 
							       date(o.vdat) =  :sdat                      
							ORDER BY o.kv, o.dk, o.s ")
				! Else If para=3   ! оплаченные межбанковские M
					! Изменена сортировка (Ivan)
					                                                                        Set ss = T(" SELECT o.dk, o.kv, o.tt, o.pdat, o.userid, o.dk,
							      o.ref, o.nd,o.mfoa,o.nlsa,o.mfob,  o.nlsb,
							      o.s/100, gl.p_icurval(o.kv, o.s, :sdat  )/100, t.name
							FROM  oper O,  tabval T
							INTO  :GRK, :KV, :TT, :PDAT, :UD, :DK,:REF, :ND, :MFOA, :NLSA, :MFOB, :NLSB, :S, :SQ, :NAMV 
							WHERE  o.sos=5 and   o.mfoa <> o.mfob and o.tt <>'K2A' and
							        o.mfoa = " || AMFO || " and  t.kv=o.kv and  date(o.vdat) =  :sdat                     
							ORDER BY  1,2,13 ")
					! Set ss = T(" SELECT o.dk, o.kv, o.tt, o.pdat, o.userid, o.dk,
							      o.ref, o.nd,o.mfoa,o.nlsa,o.mfob,  o.nlsb,
							      o.s/100, gl.p_icurval(o.kv, o.s, :sdat  )/100, t.name
							FROM  oper O,  tabval T
							INTO  :GRK, :KV, :TT, :PDAT, :UD, :DK,:REF, :ND, :MFOA, :NLSA, :MFOB, :NLSB, :S, :SQ, :NAMV 
							WHERE  o.sos=5 and   o.mfoa <> o.mfob and o.tt <>'K2A' and
							        o.mfoa = " || AMFO || " and  t.kv=o.kv and  date(o.vdat) =  :sdat                     
							ORDER BY  o.dk, o.kv, o.pdat, o.userid, o.mfob ")
				Else If para = 4   ! оплаченные ответные O
					! Изменена сортировка (Ivan)
					Set ss = T("
							    SELECT o.dk,o.kv,o.dat_a,o.dk,o.ref,
							           substr(decode(sep.version,2,translate(o.nd,sep.win_,sep.dos_),o.nd),1,200),o.mfoa,o.nlsa,o.mfob,o.nlsb,
							           o.s/100,gl.p_icurval(o.kv,o.s, :sdat )/100,t.name
							    FROM arc_rrp O, tabval T
							    INTO :GRK,:KV,:PDAT,:DK,:REF,:ND,:MFOA,:NLSA,:MFOB,:NLSB,:S,:SQ,:NAMV
							    WHERE o.sos=5 and o.mfoa<>o.mfob and o.mfob=" || AMFO || " and t.kv=o.kv and o.dat_b BETWEEN :sdat and
							          :sdat + 0.9999
							    ORDER BY 1,2,11")
					! Set ss = T(" SELECT o.dk,o.kv,o.dat_a,o.dk,o.ref,o.nd,
							  o.mfoa,o.nlsa,o.mfob,o.nlsb,o.s/100,
							  gl.p_icurval(o.kv, o.s, :sdat  )/100, t.name
							FROM  arc_rrp O,  tabval T
							INTO  :GRK,:KV,:PDAT,:DK,:REF,:ND,:MFOA,:NLSA,:MFOB,:NLSB,:S,:SQ,:NAMV 
							WHERE  o.sos=5 and  o.mfoa <> o.mfob and
							     o.mfob = " || AMFO || " and  t.kv=o.kv and date(o.dat_b) = :sdat                   
							ORDER BY o.dk, o.mfoa, o.s ")                
				Else If para = 5 or para = 3 ! ГРН-док исп/ВСЕ введенные вручную не касса
					Set SHAP = SHAP || IifS(para=5, ':' || IDNAME, '')
					Set ss = T("
							    SELECT o.userid,o.ref,o.nd,o.nlsa,o.mfob,o.nlsb,o.s/100
							    FROM oper O, tts S
							    INTO :UD,:REF,:ND,:NLSA,:MFOB,:NLSB,:S
							    WHERE o.tt=s.tt " || IifS(para=5, " and o.userid=:ID", "") || " and o.kv=:nKV and o.vdat= :sdat and
							          substr(s.flags,1,1)=1 and s.flv=0 and o.sk is null and o.sos=5
							    ORDER BY 1,2")
				Else If para = 6   ! форвард F
					Set ss = T("
							    SELECT o.vdat,o.kv,o.tt,o.pdat,o.userid,o.dk,o.ref,o.nd,o.mfoa,o.nlsa,o.mfob,o.nlsb,o.s/100,
							           gl.p_icurval(o.kv,o.s, :sdat )/100,t.name
							    FROM oper O, tabval T
							    INTO :VDAT,:KV,:TT,:PDAT,:UD,:DK,:REF,:ND,:MFOA,:NLSA,:MFOB,:NLSB,:S,:SQ,:NAMV
							    WHERE o.sos=3 and t.kv=o.kv and o.tt <>'K2A' and o.pdat<= :sdat
							    ORDER BY 1,2,3,4,5,6")
				Else If para = 7   ! межбанковские заблокированые
					Set ss = T("
							    SELECT o.kv,o.tt,o.pdat,a.blk,o.dk,o.ref,o.nd,o.mfoa,o.nlsa,o.mfob,o.nlsb,o.s/100,
							           gl.p_icurval(o.kv,o.s, :sdat )/100,t.name,o.userid
							    FROM oper O, tabval T, arc_rrp a
							    INTO :KV,:TT,:PDAT,:UD,:DK,:REF,:ND,:MFOA,:NLSA,:MFOB,:NLSB,:S,:SQ,:NAMV,:UU
							    WHERE o.sos=5 and o.mfoa<>o.mfob and a.ref=o.ref and a.blk>0 and o.mfoa=" || AMFO || " and t.kv=o.kv and
							          date(o.vdat)<= :sdat
							    ORDER BY o.kv,o.pdat,o.userid,o.dk,o.mfob")
				! - - - -  - 71 отчет В КАТАЛОГИЗИРОВАННЫХ на CKTR (ANNY)
				! Else If para = 71 ! межбанковские Висящие на транзитах
					! Set name = 1 Начальные незаквитованные
					! Set name = 2 Начальные неотобранные
					! Set name = 3 Ответные заблокированные
					! Set name = 4 Возврат контролера (ждет оплаты бухг.)
					                                                               Set ss = "
							    SELECT 1,dk,mfoa,nlsa,blk,ref,nd,mfob,nlsb,s/100,DAT_A
							    INTO :GRK,:DK,:MFOA,:NLSA,:UD,:REF,:ND,:MFOB,:NLSB,:S,
							         :PDAT
							    FROM arc_rrp  
							    WHERE mfoa= " || AMFO || " and 
							          fn_b in (select fn from zag_b
							                   where otm<5 and 
							                   (nvl(blk,0) >0 or (nvl(blk,0)=0 and sos=3)))
							    UNION ALL
							    SELECT 2,dk,mfoa,nlsa,blk,ref,nd,mfob,nlsb,s/100,DAT_A
							    FROM arc_rrp
							    WHERE mfoa= " || AMFO || " and fn_b is null and
							          ((nvl(blk,0)=0 and sos=3) or nvl(blk,0)>0)
							    UNION ALL
							    SELECT 3,dk,mfoa,nlsa,blk,ref,nd,mfob,nlsb,s/100,DAT_A
							    FROM arc_rrp
							    WHERE mfob= " || AMFO || "  and 
							          mfoa!= " || AMFO || " and 
							          (nvl(blk,0)>0 or (nvl(blk,0)=0 and sos=3))
							    UNION ALL
							    SELECT 4,dk,mfoa,nlsa,blk,ref,nd,mfob,nlsb,s/100,DAT_A
							    FROM arc_rrp
							    WHERE rec in (select rec_in
							                  from bp_back
							                  where rec_out is null)
							    ORDER BY 1,2,3,4"
				Else If para = 72  ! Реестр автопроводок за день
					Set ss = T("
							    SELECT p.tt,p.ref,p.s,decode(p.tt,o.tt,o.MFOA,''),decode(p.tt,o.tt,nvl(o.NLSA,p.NLSD),p.NLSD),
							           decode(p.tt,o.tt,o.MFOB,''),decode(p.tt,o.tt,nvl(o.NLSB,p.NLSK),p.NLSK)
							    INTO :TT,:REF,:S,:MFOA,:NLSA,:MFOB,:NLSB
							    FROM oper o, tts t, (select distinct d1.TT tt,d1.REF ref,d2.NLS nlsd,least(d1.S,k1.S)/100 s,d1.FDAT fdat,
							                                         k2.NLS nlsk
							                         from opldok d1, opldok k1, accounts d2, accounts k2
							                         where d1.sos=5 and d1.dk=0 and d1.fdat= :sdat  and d1.acc=d2.acc and k1.sos=5 and k1.dk=1 and
							                               k1.fdat= :sdat  and k1.acc=k2.acc and d1.fdat=k1.fdat and d1.ref=k1.ref and
							                               d1.tt=k1.tt and d2.kv=k2.kv) p
							     WHERE t.tt=p.tt and substr(t.flags,1,1)<>'1' and p.ref=o.ref   
							     ORDER BY p.tt,decode(p.tt,o.tt,o.MFOA,''),substr(decode(p.tt,o.tt,nvl(o.NLSA,p.NLSD),p.NLSD),1,4),
							              substr(decode(p.tt,o.tt,nvl(o.NLSA,p.NLSD),p.NLSD),6,9),decode(p.tt,o.tt,o.MFOB,''),    
							              substr(decode(p.tt,o.tt,nvl(o.NLSB,p.NLSK),p.NLSK),1,4),
							              substr(decode(p.tt,o.tt,nvl(o.NLSB,p.NLSK),p.NLSK),6,9)")
				Else If para = 73  ! Реестр документов полученных и оплаченных  
						                   ! по системе КЛИЕНТ-БАНК за день (ДНЕПР)
					! TT = SAB, MFOA = NMK
					Set ss = T("
							    SELECT o.nd,o.nlsa,o.mfob,o.nlsb,o.s/100,c.sab,c.nmk
							    INTO :ND,:NLSA,:MFOB,:NLSB,:S,:TT,:MFOA
							    FROM oper o, arc_rrp r, accounts a, customer c, cust_acc u
							    WHERE o.vdat= :sdat  and o.sos=5 and o.tt='R00' and o.ref=r.ref and r.sos>3 and r.ref_a is not null and
							          a.nls=o.nlsa and a.kv=:nKV and a.acc=u.acc and u.rnk=c.rnk
							    ORDER BY 6,2,5")
					! Set ss = T("
							    SELECT nd,nlsa,mfob,nlsb,s/100,sab,nmk
							    INTO :ND,:NLSA,:MFOB,:NLSB,:S,:TT,:MFOA
							    FROM temp_pdp    
							    ORDER BY 6,2,5")
				! - - - -  - 74 отчет В КАТАЛОГИЗИРОВАННЫХ на IGR (ANNY)
				! Else If para = 74  ! Реестр документов полученных и оплаченных
						                   ! по системе КЛИЕНТ-БАНК
					! TT = SAB, MFOA = NMK
					                                                               Set ss = T("
							    SELECT o.nd,o.nlsa,o.mfob,o.nlsb,o.s/100,c.sab,c.nmk
							    INTO :ND,:NLSA,:MFOB,:NLSB,:S,:TT,:MFOA
							    FROM oper o, accounts a, customer c, cust_acc u
							    WHERE o.vdat= :sdat  and o.sos=5 and (o.tt='KL1' or o.tt='KL2') and
							          a.nls=o.nlsa and a.kv=:nKV and a.acc=u.acc and u.rnk=c.rnk
							    ORDER BY 6,2,5")
					! Set ss = T("
							    SELECT nd,nlsa,mfob,nlsb,s/100,sab,nmk
							    INTO :ND,:NLSA,:MFOB,:NLSB,:S,:TT,:MFOA
							    FROM temp_pdp    
							    ORDER BY 6,2,5")
				! Else If para=8   ! межб поверненi казначейством щеНЕ подтвержд бухг
					                                                                        Set ss = T(" SELECT  o.kv, o.tt, o.pdat, a.blk,o.dk,
							      o.ref, o.nd,o.mfoa,o.nlsa,o.mfob,  o.nlsb,
							      o.s/100, gl.p_icurval(o.kv, o.s, :sdat  )/100, t.name,o.userid
							FROM  oper O,  tabval T, arc_rrp a 
							INTO :KV,:TT,:PDAT,:UD,:DK,:REF,:ND,:MFOA,:NLSA,:MFOB,:NLSB,:S,:SQ,:NAMV,:UU 
							WHERE  o.sos=5 and   o.mfoa <> o.mfob and  a.ref =o.ref and a.blk < 0 and 
							        o.mfoa = " || AMFO || " and  t.kv=o.kv and  date(o.vdat) =  :sdat                     
							ORDER BY  o.kv, o.pdat, o.userid,o.dk, o.mfob ")
				Else If para = 81  ! По образцу о Маршавиной
					! Set maska = Maska_NLS("счетов")
					Set maska = Maska_NLS(CurrentLangTable.GetAtomTitle('cTSelectAcc'))
					If maska='-'
						Call SalDestroyWindow( hWndForm )
						Return FALSE
					Set ss = T("
							    SELECT substr(s.nls,1,4),p.userid,o.ref,o.tt,o.fdat,s.kv,s.nls,p.nd,(1-o.dk)*o.s/100,o.dk*o.s/100,
							           (1-o.dk)*gl.p_icurval(s.kv,o.s,o.fdat)/100,o.dk*gl.p_icurval(s.kv,o.s,o.fdat)/100
							    FROM opldok o, sal s, oper p
							    INTO :MFOA,:UD,:REF,:TT,:PDAT,:KV,:NLSA,:ND,:S,:DK,:SQ,:GRK
							    WHERE o.ref=p.ref and o.sos=5 and o.acc=s.acc and s.fdat=o.fdat and s.fdat= :sdat  and
							          ltrim(rtrim(s.nls)) LIKE \'" || SalStrTrimX(maska) || "\'
							    ORDER BY s.fdat,s.kv,s.nls,o.dk,o.s")
				Else If para = 82  ! Реестр опер. K2C - K2D для Черкасс
					Set strTitle2 = 'період з ' || strDateFrom || ' по ' || strDateTo
					Set ss = T("
							    SELECT ref,tt,nd,vdat,kv,decode(dk,1,mfoa,mfob),decode(dk,1,nlsa,nlsb),decode(dk,1,mfob,mfoa),
							           decode(dk,1,nlsb,nlsa),s
							    INTO :REF,:TT,:ND,:PDAT,:KV,:MFOA,:NLSA,:MFOB,:NLSB,:S
							    FROM oper
							    WHERE sos=5 and tt in ('K2C','K2D') and vdat>= :sdat  and vdat <= :sdat2
							    ORDER BY vdat,tt,kv,mfoa,substr(nlsa,1,4),substr(nlsa,6,9),mfob,substr(nlsb,1,4),substr(nlsb,6,9)")
					! Set ss = T("
							    SELECT ref, tt, nd, vdat, kv,
							                     decode(dk,1,mfoa,mfob),
							                     decode (dk,1,nlsa,nlsb),
							                     decode(dk,1,mfob,mfoa),
							                     decode (dk,1,nlsb,nlsa), s  
							    INTO :REF, :TT, :ND, :PDAT, :KV,
							                :MFOA, :NLSA,
							                :MFOB, :NLSB,  :S 
							   FROM  oper   
							  WHERE sos=5 and
							                 tt in ('015','001') and  
							                vdat >= :sdat  and  vdat <= :sdat2   
							         ORDER BY   vdat, tt,  kv, mfoa, 
							                                  substr(nlsa,1,4),substr(nlsa,6,9),
							                                  mfob, substr(nlsb,1,4), substr(nlsb,6,9) ")
				Else If para = 9   ! межб поверненi казначейством подтвержд бухг
					Set ss = T("
							    SELECT o.kv,o.tt,o.pdat,a.blk,o.dk,o.ref,o.nd,o.mfoa,o.nlsa,o.mfob,o.nlsb,o.s/100,
							           gl.p_icurval(o.kv,o.s, :sdat )/100,t.name,o.userid
							    FROM oper O, tabval T, arc_rrp a
							    INTO :KV,:TT,:PDAT,:UD,:DK,:REF,:ND,:MFOA,:NLSA,:MFOB,:NLSB,:S,:SQ,:NAMV,:UU
							    WHERE o.sos=-1 and o.mfoa<>o.mfob and a.ref=o.ref and a.blk<0 and o.mfoa=" || AMFO || " and t.kv=o.kv and
							          date(o.vdat)= :sdat
							    ORDER BY o.kv,o.pdat,o.userid,o.dk,o.mfob")
				! по Пользователю
				Else If para = 51  ! Внутренние нац вал оплаченные сегодня
					Set SHAP = SHAP || ':' || IDNAME
					Set ss = T("
							    SELECT decode(substr(nlsa,1,1),8,8,decode(substr(nlsa,1,1),9,9,0)),dk,tt,ref,nd,nlsa,nlsb,s/100,nazn,vdat
							    FROM oper 
							    INTO :GRK,:DK,:TT,:REF,:ND,:NLSA,:NLSB,:S,:MFOA,:PDAT 
							    WHERE '100' not in (substr(nlsa,1,3),substr(nlsb,1,3)) AND kv=kv2 AND kv=:nKV AND userid=:ID AND sos=5 AND
							          mfoa=mfob AND vdat= :sdat AND
							          tt not in ('PS3','PG5','PMC','OVR','KRP','PS7','PSA','PG1','PKM','PO7','VDY')
							    ORDER BY 1,s")
				Else If para = 52  ! ВНЕШНИЕ нац вал оплаченные сегодня
					Set SHAP = SHAP || ':' || IDNAME
					Set ss = T("
							    SELECT dk,tt,ref,nd,nlsa,mfob,nlsb,s/100,nazn,vdat
							    FROM oper
							    INTO :DK,:TT,:REF,:ND,:NLSA,:MFOB,:NLSB,:S,:MFOA,:PDAT
							    WHERE kv=kv2 AND kv=:nKV AND userid=:ID AND sos=5 AND mfoa=:TT1 AND mfoa<>mfob AND vdat= :sdat AND
							          tt != 'PS7'
							    ORDER BY s")
				Else If para = 53  ! ВАЛ оплаченные сегодня
					Set SHAP = SHAP || ':' || IDNAME
					Set ss = T("
							    SELECT kv,kv2,dk,tt,ref,nd,nlsa,nlsb,s/100,s2/100,nazn,vdat
							    FROM oper
							    INTO :KV,:GRK,:DK,:TT,:REF,:ND,:NLSA,:NLSB,:S,:SQ,:MFOA,:PDAT
							    WHERE (kv<>:nKV OR kv2<>:nKV) AND userid=:ID AND sos=5 AND vdat= :sdat
							    ORDER BY kv,s")
				! Все по АБС
				Else If para = 510 ! Внутренние нац вал оплаченные сегодня
					Set ss = T("
							    SELECT decode(substr(nlsa,1,1),8,8,decode(substr(nlsa,1,1),9,9,0)),userid,dk,tt,ref,nd,nlsa,nlsb,s/100,nazn,vdat
							    FROM oper 
							    INTO :GRK,:UD,:DK,:TT,:REF,:ND,:NLSA,:NLSB,:S,:MFOA,:PDAT
							    WHERE '100' not in (substr(nlsa,1,3),substr(nlsb,1,3)) AND kv=kv2 AND kv=:nKV AND sos=5 AND mfoa=mfob AND
							          vdat= :sdat
							    ORDER BY 1,s")
				Else If para = 520 ! ВНЕШНИЕ нац вал оплаченные сегодня
					Set ss = T("
							    SELECT userid,dk,tt,ref,nd,nlsa,mfob,nlsb,s/100,nazn,vdat
							    FROM oper
							    INTO :UD,:DK,:TT,:REF,:ND,:NLSA,:MFOB,:NLSB,:S,:MFOA,:PDAT
							    WHERE kv=kv2 AND kv=:nKV AND sos=5 AND mfoa<>mfob AND mfoa=:TT1 AND vdat= :sdat
							    ORDER BY s")
				Else If para = 522 ! Ведомость автом.перекрытия счетов(Kазнач-во)
					Set ss = T(" 
							    SELECT o.ref,o.tt,o.vdat,o.nd,o.s/100,o.mfoa,o.nlsa,o.mfob,o.nlsb
							    FROM  oper o, accounts a
							    INTO :REF,:TT,:PDAT,:ND,:S,:MFOA,:NLSA,:MFOB,:NLSB
							    WHERE o.mfoa=:TT1 AND o.mfoa=o.mfob AND a.nbs in ('3122','3112','3132') AND o.nlsa=a.nls AND o.kv=o.kv2 AND
							          o.kv=:nKV AND o.sos=5 AND o.vdat= :sdat  AND o.ref in (SELECT ref
							                    FROM opldok k
							                    WHERE a.acc=k.acc
							                    GROUP BY ref
							                    HAVING count(*)=1)
							    ORDER BY decode(o.nlsb,'311240101',0,'312286106',1,'312296109',2,3),o.nlsb,o.s")
				Else If para = 523 ! Реестр поступлений по общ.фонду(Kазнач-во)
					Set strTitle2 = 'період з ' || strDateFrom || ' по ' || strDateTo
					Set ss = T(" 
							    SELECT o.mfoa,b.nb,sum(o.s)/100,o.vdat
							    FROM oper o, banks b
							    INTO :MFOA,:NLSA,:S,:PDAT
							    WHERE o.mfoa=b.mfo AND o.vdat>= :sdat  AND o.vdat<= :sdat2 AND o.nlsb in (select nls from K_3112)
							    GROUP BY o.mfoa,b.nb,o.vdat
							    ORDER BY o.mfoa")
					! Set ss = T(" 
							      SELECT   o.mfoa,  b.nb, sum(o.s)/100, o.vdat
							      FROM  oper o, banks b   
							      INTO   :MFOA, :NLSA, :S, :PDAT
							      WHERE   o.mfoa= b.mfo  AND  o.vdat =  :sdat
							                        AND o.nlsb in ( select nls from K_3112  )                        
							      GROUP BY  o.mfoa,  b.nb, o.vdat      
							      ORDER BY  o.mfoa  ")
				Else If para = 524 ! Реестр поступлений по 3717
					If SqlPrepareAndExecute(cCnc.hSql(), T("
							   SELECT  :sdat ,to_char( :sdat2, 'dd-mm-yyyy')
							   INTO :PDAT,:TT
							   FROM dual")) and SqlFetchNext(cCnc.hSql(), KV)
						Set ss = T("
								    SELECT o.mfoa,b.nb,o.nlsb,sum(o.s)/100
								    FROM  oper o, banks b
								    INTO  :MFOA,:NLSA,:NLSB,:S
								    WHERE o.sos=5 AND o.mfoa=b.mfo AND substr(o.nlsb,1,4)='3717' AND o.vdat>= :sdat  AND o.vdat<= :sdat2
								    GROUP BY o.mfoa,b.nb,o.nlsb
								    ORDER BY o.mfoa,o.nlsb")
				! -- оьтчет 525 перенесла в каталогизированн. 20.05.2002 Anny
				! Else If para=525 ! Надходження коштів від Держмиткому(ГУДКУ)(Inna)
					                                                               Set strBind = 'NLSA,TT,REF,NAM,S,SQ,UU,UD'  ! наши переменные
					                                                               Set strInput = strBind
					                                                               Set ss = T("
							SELECT a.nls, m.id, m.iid, m.name,
							sum(decode(o.dk,1,decode(o.fdat, :sdat ,o.s,0),0)),
							sum(decode(o.dk,1,decode(trunc(o.fdat,'MM'),trunc( :sdat ,'MM'),o.s,0),0)),
							sum(decode(o.dk,1,o.s,0)), sum(decode(o.dk,1,0,o.s))
							FROM accounts a, mytkom m, opldok o, specparam s
							INTO  :NLSA, :TT, :REF, :NAM, :S, :SQ, :UU, :UD
							WHERE a.nbs=3111 and a.acc=s.acc and
							      s.s230=m.id and o.acc=s.acc and
							      o.sos=5 and o.fdat <= :sdat  and o.fdat >= '23-JUL-2001'
							GROUP BY a.nls, m.id, m.iid, m.name
							ORDER BY  m.id,a.nls ")
				Else If para = 526 ! Реестр поступлений по спец.фонду (ГУДКУ) (Inna)
					Set strTitle2 = 'період з ' || strDateFrom || ' по ' || strDateTo
					Set ss = T("
							    SELECT o.mfoa,b.nb,sum(o.s)/100,o.vdat
							    FROM oper o, banks b
							    INTO :MFOA,:NLSA,:S,:PDAT
							    WHERE o.mfoa=b.mfo AND (o.vdat BETWEEN  :sdat  AND  :sdat2) AND o.nlsb IN (SELECT a.nls
							                                                                               FROM accounts a, fonds f
							                                                                               WHERE a.nbs=3122 AND f.kod=2 AND
							                                                                                     substr(a.nls,6,3)=f.s230)
							    GROUP BY o.mfoa,b.nb,o.vdat
							    ORDER BY o.mfoa")
				Else If para = 527 ! Реестр поступлений по "позичкам" (ГУДКУ)(Inna)
					Set strTitle2 = 'період з ' || strDateFrom || ' по ' || strDateTo
					Set ss = T("
							    SELECT o.mfoa,b.nb,sum(o.s)/100,o.vdat
							    FROM oper o, banks b
							    INTO :MFOA,:NLSA,:S,:PDAT
							    WHERE o.mfoa=b.mfo AND (o.vdat BETWEEN  :sdat  AND  :sdat2) AND o.nlsb in (SELECT a.nls
							                                                                               FROM accounts a, fonds f
							                                                                               WHERE a.nbs IN (3123,3122) AND
							                                                                                     f.kod=3 AND
							                                                                                     substr(a.nls,6,3)=f.s230)
							    GROUP BY o.mfoa,b.nb,o.vdat
							    ORDER BY o.mfoa")
				Else If para = 530 ! ВАЛ оплаченные сегодня
					Set ss = T("
							    SELECT userid,kv,kv2,dk,tt,ref,nd,nlsa,nlsb,s/100,s2/100,nazn,vdat
							    FROM oper 
							    INTO :UD,:KV,:GRK,:DK,:TT,:REF,:ND,:NLSA,:NLSB,:S,:SQ,:MFOA,:PDAT
							    WHERE (kv<>:nKV OR kv2<>:nKV) AND sos=5 AND vdat= :sdat
							    ORDER BY userid,kv,s")
				!
				! Else If para=531 !Выписка для корпоративных клиентов (ANNY)
					                                                               Set tex1 = GetGlobalOption('BIG_SEG')
					                                                               If tex1
						! Make end of transaction and start new
						                                                               Call SqlCommit( hSql() )
						! to avoid error with set transaction...
						                                                               Call SqlPrepareAndExecute(hSql(), 'SET TRANSACTION USE ROLLBACK SEGMENT ' || SalStrUpperX( strRBSName ))
						                                                               Call SqlPLSQLCommand(hSql(), 'p_lickk(user_id,sFdat, sFdat2)')
					                                                               Set ss = T(" sFdat, sFdat2
							       SELECT userid, kv, kv2, dk, tt, ref, nd,
							                        nlsa, nlsb, s/100, s2/100, nazn, vdat
							       FROM  oper 
							       INTO :UD, :KV, :GRK, :DK, :TT, :REF, :ND,
							                :NLSA, :NLSB,:S, :SQ,  :MFOA , :PDAT
							WHERE  (kv<>:nKV OR kv2<>:nKV) AND  sos=5  AND  vdat =  :sdat                      
							ORDER BY userid, kv, s ")
					!
					                                                               If not SqlPLSQLCommand(hSql(), "P_dku" || para || " (ID,dRab,dRab2,maska)")
						                                                               Return FALSE
					                                                               If not SqlCommitEx(hSql(), 'Подготовка для печати DKU отчетов')
						                                                               Return FALSE
					                                                               Return TRUE
				!
				! по Подразделению
				Else If (para = 511 or para = 521 or para = 531) and SqlPrepareAndExecute(cCnc.hSql(), "
						     SELECT o.id,o.name
						     INTO :UU,:tex1
						     FROM otd_user u, otdel o
						     WHERE u.userid=:ID AND o.id=u.otd") and SqlFetchNext(cCnc.hSql(), KV)
					Set SHAP = SHAP || ':' || tex1
					If para = 511 ! Внутренние нац вал оплаченные сегодня 
						Set ss = T("
								    SELECT decode(substr(nlsa,1,1),8,8,decode(substr(nlsa,1,1),9,9,0)),o.userid,o.dk,o.tt,ref,o.nd,o.nlsa,o.nlsb,
								           o.s/100,o.nazn,o.vdat
								    FROM oper o, otd_user u
								    INTO :GRK,:UD,:DK,:TT,:REF,:ND,:NLSA,:NLSB,:S,:MFOA,:PDAT
								    WHERE o.sos=5 AND u.userid=o.userid AND u.otd=:UU AND '100' not in (substr(o.nlsa,1,3),substr(o.nlsb,1,3)) AND
								          o.kv=o.kv2 AND o.kv=:nKV AND o.mfoa=o.mfob AND o.vdat= :sdat
								    ORDER BY 1,2,o.s")
					Else If para = 521 ! ВНЕШНИЕ нац вал оплаченные сегодня 
						Set ss = T("
								    SELECT o.userid,o.dk,o.tt,o.ref,o.nd,o.nlsa,o.mfob,o.nlsb,o.s/100,o.nazn,o.vdat
								    FROM oper o,otd_user u 
								    INTO :UD,:DK,:TT,:REF,:ND,:NLSA,:MFOB,:NLSB,:S,:MFOA,:PDAT
								    WHERE o.sos=5 AND u.userid=o.userid AND u.otd=:UU AND o.mfoa=:TT1 AND o.kv=o.kv2 AND o.kv=:nKV AND
								          o.mfoa<>o.mfob AND o.vdat=  :sdat
								    ORDER BY o.s")
					Else If para = 531 ! ВАЛ оплаченные сегодня 
						Set ss = T("
								    SELECT o.userid,o.kv,o.kv2,o.dk,o.tt,o.ref,o.nd,o.nlsa,o.nlsb,o.s/100,o.s2/100,o.nazn,o.vdat
								    FROM oper o, otd_user u
								    INTO :UD,:KV,:GRK,:DK,:TT,:REF,:ND,:NLSA,:NLSB,:S,:SQ,:MFOA,:PDAT
								    WHERE u.userid=o.userid AND u.otd=:UU AND (kv<>:nKV OR kv2<>:nKV) AND o.sos=5 AND o.vdat=  :sdat
								    ORDER BY o.kv,o.s")
				Else If para = 540 ! ВАЛ кассовые журналы
					Set strBind = 'GRK,KV,PDAT,UD,DK,REF,ND,MFOA,NLSA,MFOB,NLSB,S,SQ,TT,DIG'
					Set strInput = strBind
					! Set maska = Maska_NLS("счета")
					Set maska = Maska_NLS(CurrentLangTable.GetAtomTitle('cTSelectAcc'))
					If maska = '-'
						Call SalDestroyWindow(hWndForm)
						Return TRUE
					Set ss = T("
							    SELECT p.userid,o.fdat,p.nd,o.dk,o.ref,o.tt,o.s/100,t.lcv || ' ' || t.name,
							           decode(p.nlsa || a.kv,a.nls || a.kv,p.nlsb,p.nlsa)+0,a.nls,a.nms,decode(p.tt,o.tt,p.nazn,tts.name),
							           (1-o.dk)*o.s/100,o.dk*o.s/100,t.dig
							    INTO :UD,:PDAT,:ND,:DK,:REF,:TT,:S,:MFOB,:KV,:NLSA,:MFOA,:NLSB,:SQ,:GRK,:DIG
							    FROM opldok o, sal a, tabval t, oper p, tts
							    WHERE substr(a.nbs,1,3)='100' AND a.nls LIKE '" || maska || "' AND a.kv<>:nKV AND o.sos=5 AND p.ref=o.ref AND
							          tts.tt=p.tt AND o.fdat= :sdat  AND a.fdat=o.fdat AND o.acc=a.acc AND a.kv=t.kv
							UNION ALL
							   SELECT distinct o.userid,o1.fdat,o.nd,o1.dk,o1.ref,o1.tt,o1.s/poWer(10,t.dig),t.lcv || ' ' || t.name,a2.nls+0,a1.nls,
							          a1.nms,decode(O.tt,o1.tt,O.nazn,tts.name),(1-o1.dk)*o1.s/poWer(10,t.dig),o1.dk*o1.s/poWer(10,t.dig),t.dig
							   FROM opldok o1, sal a1, opldok o2, accounts a2, oper o, tabval t, tts
							   WHERE o.sos=5 AND o.ref=o1.ref AND o.ref=o2.ref AND A1.ACC=O1.ACC AND substr(a1.nbs,1,3)='110' AND A2.ACC=O2.ACC AND
							         substr(a2.nbs,1,3)='100' AND a1.nls LIKE '" || maska || "' AND o1.fdat= :sdat  AND a1.kv<>:nKV AND
							         a1.fdat=o1.fdat AND a1.kv=t.kv AND tts.tt=o1.tt
							UNION ALL
							   SELECT distinct o.userid,o.vdat,o.nd,o.dk,o.ref,o.tt,o.s/poWer(10,t.dig),t.lcv || ' ' || t.name,
							          decode(substr(o.nlsa,1,3),substr(o.nlsb,1,3),o.nlsb,a.nls)+0,a.nls,a.nms,decode(O.tt,o.tt,O.nazn,tts.name),
							          (1-o.dk)*o.s/poWer(10,t.dig),o.dk*o.s/poWer(10,t.dig),t.dig
							   FROM accounts a, oper o, tabval t, tts
							   WHERE o.sos=5 AND a.nls=o.nlsa AND a.kv=o.kv AND substr(o.nlsa,1,3)='110' AND substr(o.nlsb,1,3)='110' AND
							         a.nls LIKE '" || maska || "' AND o.vdat= :sdat  AND a.kv<>:nKV AND a.kv=t.kv AND tts.tt=o.tt
							   ORDER BY 8,10,4,7")
				Else If para = 20  ! РЕЕСТР ПРОВОДОК задень для ПИКРИИ
					Set ss = "
							    SELECT p.dk,p.ref,p.nls,substr('0000000' || g.nls,-9,9),t.lcv,p.s/100,gl.p_icurval(p.kv,p.s,p.fdat)/100,
							           substr(p.nazn,1,20),p.tt
							    INTO :DK,:REF,:NLSB,:NLS2,:TT,:S,:SQ,:NAM,:TT1
							    FROM opl p, tabval t, geo_tab g
							    WHERE p.sos=5 and p.acc=g.acc and p.kv=t.kv and DATE(fdat)= :sdat
							    UNION ALL
							    SELECT 1,to_NUMBER(NULL),to_CHAR(NULL),substr('0000000' || g.nls,-9,9),t.lcv,to_NUMBER(NULL),
							           (gl.p_icurval(s.kv,s.ost+s.dos-s.kos,s.fdat)-gl.p_icurval(s.kv,s.ost+s.dos-s.kos,s.fdat-1))/100,'',''
							    FROM sal s, tabval t, geo_tab g
							    WHERE s.acc=g.acc AND s.kv=t.kv AND date(fdat)= :sdat AND s.kv<>" || Str(GetBaseVal()) || "
							    ORDER BY 2,9,5,6,1"
					Set ss = T(ss)
					Set strBind = 'REF,NLSA,NLSB,NLS1,NLS2,TT,S,SQ,NAM' !! наши переменные
					Set strInput = strBind
				Else
					Set SHAP = ''
				Call SalHideWindow(hWndForm)
				! ======================= !
				! Начинаем печать в отчет !
				! ======================= !
				Call SalReportPrintToFile(hWndForm, strTmplPath, strPrintPath || '/' || IifS(FL_FORMAT, strFileNameRtf, strFileNameTxt),
						     strBind, strInput, 1, RPT_PrintAll, 1, 1, FL_FORMAT, nInd)
				If nInd > 4
					! Call SalMessageBox('SalReportPrintToFile - возвратил ошибку ' || Str(nInd), 'Внимание', 0)
					Call SalMessageBox('SalReportPrintToFile - ' || CurrentLangTable.GetAtomTitle('cTErrFunc') || ' ' || Str(nInd),
							     CurrentLangTable.GetAtomTitle('cTAt'), 0)
				! ==== Посылаем сообщение, чтоб перечитался список файлов для новой директории
				Set frm_Out.dfPath = strPrintPath
				Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
				Call SalDestroyWindow(hWndForm)
			On SAM_ReportStart      !! приготовить SELECT
				Return SqlPrepare(cCnc.hSql(), ss)
			On SAM_ReportFetchInit   
				Return SqlExecute(cCnc.hSql())
			On SAM_ReportFetchNext  !! вычитать очередную строку
				If para = 20
					While SqlFetchNext(cCnc.hSql(), nFetchRes)
						If SQ != 0
							If DK = 0
								Set NLSA = NLSB
								Set NLS1 = NLS2
							Else
								If S = NUMBER_Null 
									Set NLSA = STRING_Null
									Set NLSB = STRING_Null
									If SQ < 0
										Set NLS1 = NLS2
										Set NLS2 = '000019404'
										Set SQ = -SQ
									Else
										Set NLS1 = '000019404'
								Return TRUE
					Return FALSE
				Else
					If SqlFetchNext(cCnc.hSql(), nFetchRes)
						If para = 6
							Set GRK = SalDateYear(VDAT) * 10000 + SalDateMonth(VDAT) * 100 + SalDateDay(VDAT)
						If para = 4
							Set ND = StrDosToWinX(ND)
						If para = 5 and TT != TT1
							Set GRK = GRK + 1
							Set TT1 = TT
						Return TRUE
					Else
						Return FALSE
			On SAM_ReportNotify	!! информировать ОТЧЕТ о глобальных переменных 
				If lParam = RPT_BeforeReportHeader  !! только для заголовка 
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'SHAP', SHAP)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'AMFO', AMFO)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'AQH', AQH)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'SHAP1', strTitle2)
				If lParam = RPT_BeforeBreakHeader1 and para < 20
					Set rab = ''
					If para < 2
						Set rab = NAM
					Else If para = 6
						Set rab = SalFmtFormatDateTime(VDAT, 'dd-MM-yyyy')
					Else If para = 5
						Set rab = NAM
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'NAM', rab)
				If lParam = RPT_BeforeBreakHeader2 and para < 20 !! KV
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'NAMV', NAMV)
			On SAM_ReportFinish
				Call SalSendMsg(frm_Out.tblReps, UM_ReportFinish, 0, 0)
			On SAM_Destroy
				If cCnc.IsConnected()
					Call cCnc.Disconnect()
	Dialog Box: dlg_MonthAdd   !! Исп. в frm_Month
		Class:
		Property Template:
		Class DLL Name:
		Title: Выбор исполнителя
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  10.4"
				Width Editable? Yes
				Height: 5.595"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Child Table: tbl1 !! исполнители
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.333"
						Top:    0.238"
						Width:  9.65"
						Width Editable? Yes
						Height: 4.5"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Blue
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 3000
					Discardable? No
				Contents
					Column: Kod1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.786"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NAME1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: НАИМЕНОВАНИЕ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  6.786"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
					On SAM_DoubleClick
						Call SalSendMsg( dlg_MonthAdd.PB1, SAM_Click, 0, 0 )
			Pushbutton: PB1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Печать выбранных
				Window Location and Size
					Left:   3.85"
					Top:    4.845"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Midnight Blue
				Background Color: Default
				Message Actions
					On SAM_Click
						Loop
							Set sExecList=''
							Set nRow=TBL_MinRow
							Loop
								If SalTblFindNextRow (  tbl1, nRow, ROW_Selected, 0 )
									Call SalTblSetContext( tbl1,nRow )
									If sExecList
										Set sExecList=sExecList || ', ' || SalNumberToStrX( tbl1.Kod1, 0 )
									Else
										Set sExecList=' AND ISP IN ( ' || SalNumberToStrX( tbl1.Kod1, 0 )
								Else
									Break
							If sExecList
								Set sExecList=sExecList || ') '
							Else
								! Call SalMessageBox( 'Ничего не выбрано!', 'Ошибка', 0 )
								Call SalMessageBox( CurrentLangTable.GetAtomTitle('dlg_MonthAdd.cTMsgCase'), 
										  CurrentLangTable.GetAtomTitle('cTErr'), 0 )
								Break
							Call SalEndDialog( dlg_MonthAdd, 99 )
							Break
			Pushbutton: PB2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Печать ВСЕХ
				Window Location and Size
					Left:   1.25"
					Top:    4.845"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Midnight Blue
				Background Color: Default
				Message Actions
					On SAM_Click
						Set sExecList=''
						Call SalEndDialog( dlg_MonthAdd, 99 )
			Pushbutton: PB3 !! завершить
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Завершить
				Window Location and Size
					Left:   6.45"
					Top:    4.845"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Black
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalEndDialog( dlg_MonthAdd, 0 )
		Functions
		Window Parameters
		Window Variables
			Number: nRow
			String: sExecList
		Message Actions
			On SAM_Create
				Call SalCenterWindow(hWndForm)
				Call SetWindowFont(hWndForm)
				Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
				Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('dlg_MonthAdd.cTWndTitle') )
				Set sExecList=''
				Call SalTblPopulate( dlg_MonthAdd.tbl1, hSql(),
						'SELECT id, fio INTO :tbl1.Kod1, :tbl1.NAME1 FROM staff WHERE type=1'
						, TBL_FillAll )
				Call WaitCursorOff()
			On SAM_Destroy
				Call WaitCursorOn()
	Table Window: tbl_idprn
		Class: cGenericTable
		Property Template:
		Class DLL Name:
		Title: Определение ESC-последовательностей для печатных отчетов
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Normal
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   0.025"
				Top:    0.427"
				Width:  12.883"
				Width Editable? Class Default
				Height: 5.821"
				Height Editable? Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
			View: Class Default
			Allow Row Sizing? Class Default
			Lines Per Row: Class Default
		Memory Settings
			Maximum Rows in Memory: Class Default
			Discardable? Class Default
		Description: Определение ESC-последовательностей для печатных
				отчетов
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbIns
					Class Child Ref Key: 33
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDel
					Class Child Ref Key: 34
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbRefresh
					Class Child Ref Key: 35
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbUpdate
					Class Child Ref Key: 36
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 39380
					Class Child Ref Key: 37
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbSearch
					Class Child Ref Key: 38
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbFilter
					Class Child Ref Key: 44
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbDetails
					Class Child Ref Key: 39
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 40
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 39381
					Class Child Ref Key: 41
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 42
					Class ChildKey: 0
					Class: cGenericTable
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 39382
					Class Child Ref Key: 43
					Class ChildKey: 0
					Class: cGenericTable
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
		Contents
			Column: col_id
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
						отчета
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: Number
				Justify: Right
				Width:  0.7"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Drop Down List
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
					On SAM_Create
						Call SalListPopulate(hWndItem, hSqlAux2(), T('SELECT id FROM reports'))
			Column: col_printer
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Тип принтера
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.317"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: col_12
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Разделение
						листов
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  1.117"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Check Box
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value: 1
						Uncheck Value: 0
						Ignore Case? Yes
				List Values
				Message Actions
			Column: col_escline
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: ESC-последовательность
				Visible? Yes
				Editable? Yes
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  9.283"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: col_rowid
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Rowid
				Visible? No
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  Default
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
		Window Parameters
		Window Variables
			String: sDriver
			String: sPort
		Message Actions
			On SAM_Create
				! Set nFlags = GT_NoRet
				Call SalCenterWindow(hWndForm)
				Call SalDisableWindow(pbSearch)
				Call SalDisableWindow(pbDetails)
				Call SalDisableWindow(pbPrint)
				Set strSqlPopulate = T('
						    SELECT id,dvc,cse,chr12,rowid
						    INTO :col_id,:col_printer,:col_escline,:col_12,:col_rowid
						    FROM reprint
						    ORDER BY id,dvc')
				Set strSqlUpdate = T('
						    UPDATE reprint
						    SET cse=:col_escline,id=:col_id,chr12=:col_12
						    WHERE rowid=:col_rowid')
				Set strSqlInsert = T('
						    INSERT
						    INTO reprint (id,dvc,cse,chr12)
						    VALUES (:col_id,:col_printer,:col_escline,:col_12)')
				Set strSqlDelete = T('
						    DELETE
						    FROM reprint
						    WHERE id=:col_id and dvc=:col_printer')
				Call SalSendClassMessage(SAM_Create, wParam, lParam)
				! Call VisTblAutoSizeColumn(hWndForm, hWndNULL)
			On UM_Insert
				Call SalSendClassMessage(UM_Insert, 0, 0)
				Call SalPrtGetDefault(tbl_idprn.col_printer, sDriver, sPort)
			On SAM_Destroy
				If SalStrTrimX(SalStrUpperX(GetDBMS())) = 'ORACLE'
					Call XRoleUnset(hSql(), 'SetESC(hWndMDI)')
	Form Window: frm_Repbot
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  10.971"
				Width Editable? Yes
				Height: 5.344"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
		Functions
		Window Parameters
		Window Variables
		Message Actions
	Form Window: frm_Balans    !! Баланс по валютам 32 номинал
		Class:
		Property Template:
		Class DLL Name:
		Title: Баланс банка
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.838"
				Top:    0.688"
				Width:  10.0"
				Width Editable? Yes
				Height: 5.5"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Баланс
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Child Table: tbl1 !! исполнители или валюты
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.067"
						Top:    0.048"
						Width:  9.667"
						Width Editable? Yes
						Height: 4.5"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Blue
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 3000
					Discardable? No
				Contents
					Column: Kod1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.567"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NAME1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: НАИМЕНОВАНИЕ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  7.283"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
						Call SalTblPopulate(tbl1, cCnc.hSql(), T("
								     SELECT kv,name
								     FROM tabval
								     WHERE kv IN (select kv from accounts)
								     ORDER BY 1"), TBL_FillAll)
					On SAM_DoubleClick
						Call FU_SAL()
						Call SalSetFocus(tbl1)
					On SAM_User
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(tbl1, nRow, nTmp, 0)
							Call SalTblSetContext(tbl1, nRow)
							If nRow >= 0
								Call FU_SAL()
						Call SalSendMsg(tbl1, SAM_Create, 0, 0)
			Pushbutton: PB1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Печать выбранных
				Window Location and Size
					Left:   3.6"
					Top:    4.643"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Midnight Blue
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nTmp=ROW_Selected
						Call SalSendMsg( tbl1, SAM_User, 0, 0 )
			Pushbutton: PB2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Печать ВСЕХ
				Window Location and Size
					Left:   1.0"
					Top:    4.643"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Midnight Blue
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nTmp = 0
						Call SalSendMsg( tbl1, SAM_User, 0, 0 )
			Pushbutton: PB3 !! завершить
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Завершить
				Window Location and Size
					Left:   6.2"
					Top:    4.643"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalDestroyWindow(frm_Balans)
		Functions
			Function: FU_SAL
				Description: Печать баланса по ОДНОМУ
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalWaitCursor(TRUE)
					! ===Старый код======================================
					! Set strFileName = SalStrLeftX(strFileName,
							    SalStrScan(strFileName, '.')+1) ||
							    SalNumberToStrX(tbl1.Kod1, 0)
					! ===^Старый код=====================================
							
							
					Set KV = tbl1.Kod1
					! ==================================================
					! Начинаем печать в отчет
					! ==================================================
					Set strFileNameTxt=SalStrLeftX( strFileNameTxt, 9)
							    ||SalStrRightX('000'||SalNumberToStrX( KV, 0 ),3)
					! Call Debug('strFileNameTxt')
					Call SalReportPrintToFile( hWndForm,
							     strTmplPath, 
							     strPrintPath ||'/'|| IifS(FL_FORMAT, 
							     strFileNameRtf,  strFileNameTxt),
							     strBind,strInput,1,RPT_PrintAll,1,1,
							        FL_FORMAT,nInd)
					If (nInd > 4 )
						! Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
						Call SalMessageBox(' SalReportPrintToFile - ' || 
								  CurrentLangTable.GetAtomTitle('cTErrFunc') || ' '|| SalNumberToStrX(nInd,0) ,
								  CurrentLangTable.GetAtomTitle('cTAt'), 0 )
					! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
					If sAutoForm != 'AUTO'
						Set frm_Out.dfPath = strPrintPath
						Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
					! ===Старый код======================================
					! Call SalReportPrintToFile(hWndForm, strDir, GetPrnDir() ||
							     '/' || IifS(FL_FORMAT, strFileName1, strFileName),
							     strBind, strInput, 1, RPT_PrintAll, 1, 1, FL_FORMAT,
							     nInd)
					! If not FL_FORMAT
						                                                                 Call zarez12(GetPrnDir() || '\\' || strFileName, frm_Out.tbl1.Kod,   frm_Out.tbl1.sDeviceDef)
					! ===^Старый код=====================================
					If not FL_FORMAT
						If sAutoForm = 'AUTO'
							Call zarez12Del(strPrintPath || '/' || strFileNameTxt, nKOD, sDeviceDef, bDelOnNull)
						Else
							Call zarez12Del(strPrintPath || '/' || strFileNameTxt, frm_Out.tblReps.Kod, sDeviceDef, bDelOnNull)
					Call SalWaitCursor(FALSE)
		Window Parameters
			String: sdat
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			: cCncAux
				Class: cABSConnect
			Number: B1
			Number: KV
			Number: K
			Number: R
			Number: G
			String: NBS
			Number: DOS
			Number: KOS
			Number: OSTD
			Number: OSTK
			Number: nRow
			Number: nTmp
			String: sTmp
			!
			Number: PAGE
			Boolean: fNewClass
			!
			Number: nDig
			Number: DIG
		Message Actions
			On SAM_Create
				! Call Debug('0')
				Call SalCenterWindow(hWndForm)
				Call SetWindowFont(hWndForm)
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_Balans.cTWndTitle'))
				Call cCnc.Clone(g_cRepCnc, TRUE)
				Call cCncAux.Clone(cCnc, TRUE)
				Set strBind = 'B1,KV,K,R,G,NBS,DOS,KOS,OSTD,OSTK'
				Set strBind = strBind||',DIG'
				Set strInput = strBind
			On SAM_ReportStart
				Set PAGE = 0
				Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
						     'RUK', GetGlobalOption('BOSS'))
				Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
						     'GLB', GetGlobalOption('ACCMAN'))
				Set sTmp = T("
						    SELECT nbs,-SUM(decode(sign(ost),-1,ost,0))/100,
						           SUM(decode(sign(ost), 1,ost,0))/100,SUM(dos)/100,
						           SUM(kos)/100
						    FROM sal
						    INTO :NBS,:OSTD,:OSTK,:DOS,:KOS
						    WHERE kv=:KV and fdat= :sdat
						          and nbs is not null
						    GROUP BY nbs
						    ORDER BY nbs")
				Call SqlPrepare(cCnc.hSql(), sTmp)
			On SAM_ReportFetchInit
				Return SqlExecute(cCnc.hSql())
			On SAM_ReportFetchNext
				If SqlFetchNext(cCnc.hSql(), nFetchRes)
					Set K = SalStrToNumber(SalStrLeftX(NBS, 1))
					Set R = SalStrToNumber(SalStrLeftX(NBS, 2))
					Set G = SalStrToNumber(SalStrLeftX(NBS, 3))
					Set B1 = IifN(K<8, 1, IifN(K<9, 8, 9))
					! проверка на 3 знака
					Call SqlPrepareAndExecute(cCncAux.hSql(), "
							SELECT dig INTO :nDig
							FROM tabval
							WHERE kv = :KV" )
					If not SqlFetchNext(cCncAux.hSql(), nFetchRes )
						Return FALSE
					Set DOS  = DOS*SalNumberPower( 10,2-nDig )
					Set KOS  = KOS*SalNumberPower( 10,2-nDig )
					Set OSTD = OSTD*SalNumberPower( 10,2-nDig )
					Set OSTK = OSTK*SalNumberPower( 10,2-nDig )
					Set DIG = nDig 
					!
					Return TRUE
				Else
					Return FALSE
			On SAM_ReportNotify
				If lParam = RPT_BeforeBreakHeader1
					Set PAGE = 1
					Set fNewClass = TRUE
					Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam),
							     'PAGE', PAGE)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'aMFO', AMFO)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'aQH', AQH)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'Report_date', strRepDate)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'SHAP', SHAP)
					!
					Call SqlPrepareAndExecute(cCncAux.hSql(), "
							     SELECT lcv || ' ' || name
							     INTO :sTmp
							     FROM tabval
							     WHERE kv=:KV")
					Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'NAMV', sTmp)
					! Set sTmp = IifS(B1=1, 'Балансовий', IifS(B1=8,
							    'Управлінський', 'Позабалансовий')) || ' облік'
					Set sTmp = IifS(B1=1, 
							  CurrentLangTable.GetAtomTitle('cTZagB'), IifS(B1=8,
							  CurrentLangTable.GetAtomTitle('cTZagU'), 
							  CurrentLangTable.GetAtomTitle('cTZagV'))) || ' ' || 
							  CurrentLangTable.GetAtomTitle('cTZagO')
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'ZAGO', sTmp)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'sR', GetUserRealName())
					!
				If lParam = RPT_DoneBreakHeader1
					Set fNewClass = FALSE
				If lParam = RPT_BeforePageHeader
					If not fNewClass
						Set PAGE = PAGE + 1
						Call SalReportSetNumberVar(
								     SalNumberToWindowHandle(wParam), 'PAGE', PAGE)
				If lParam = RPT_BeforeBreakHeader2
					Call SqlPrepareAndExecute(cCncAux.hSql(), T("
							     SELECT name[1,70]
							     INTO :sTmp
							     FROM ps
							     WHERE nbs+0=:K"))
					Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'sK', sTmp)
				If lParam = RPT_BeforeBreakHeader3
					Call SqlPrepareAndExecute(cCncAux.hSql(), T("
							     SELECT name[1,70]
							     INTO :sTmp
							     FROM ps
							     WHERE nbs+0=:R"))
					Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'sR', sTmp)
				If lParam = RPT_BeforeBreakHeader4
					Call SqlPrepareAndExecute(cCncAux.hSql(), T("
							     SELECT name[1,70]
							     INTO :sTmp
							     FROM ps
							     WHERE nbs+0=:G"))
					Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'sG', sTmp)
			On SAM_ReportFinish
				Call SalSendMsg(frm_Out.tblReps, UM_ReportFinish, 0, 0)
			On SAM_Destroy
				If cCnc.IsConnected()
					Call cCnc.Disconnect()
				If cCncAux.IsConnected()
					Call cCncAux.Disconnect()
	Form Window: frm_BalansS   !! СВОДНЫЙ  Баланс   31 эквивалент
		Class:
		Property Template:
		Class DLL Name:
		Title: Баланс банка
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.838"
				Top:    0.688"
				Width:  7.125"
				Width Editable? Yes
				Height: 3.563"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: СВОДНЫЙ  Баланс
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
		Functions
		Window Parameters
			String: sDat
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			: cCncAux
				Class: cABSConnect
			Number: n980
			Number: B1
			Number: K
			Number: R
			Number: G
			String: NBS
			String: NBS_3929
			String: sDatMax
			String: sTmp
			String: sid
			String: ss
			Number: DOS
			Number: KOS
			Number: OSTD
			Number: OSTK
			Number: OSTVD
			Number: OSTVK
			Number: PAGE
			Date/Time: dRab
			Boolean: fNewClass
		Message Actions
			On SAM_Create
				Call SetWindowFont(frm_BalansS)
				Call WaitCursorOn()
				If sAutoForm != 'AUTO'
					Call cCnc.Clone(g_cRepCnc, TRUE)
					Call cCncAux.Clone(cCnc, TRUE)
				Set n980 = GetBaseVal()
				If sAutoForm != 'AUTO'
					If SqlPrepareAndExecute(cCncAux.hSql(),
							  "SELECT val Into :NBS_3929 FROM params WHERE par='NBS_3929'") 
							and SqlFetchNext(cCncAux.hSql(), nFetchRes)
				Else
					If SqlPrepareAndExecute(hSqlAux(),
							  "SELECT val Into :NBS_3929 FROM params WHERE par='NBS_3929'") 
							and SqlFetchNext(hSqlAux(), nFetchRes)
				! Call Debug('3 = ' || sAutoForm)
				Set NBS_3929 = IifS(NBS_3929!='', NBS_3929, '0')
				Set strBind = 'B1,K,R,G,NBS,DOS,KOS,OSTD,OSTK'
				! !!! Для Казначейства со входящими остатками - Заменить B001S.qrp на B001SV.qrp
				If Left(GetBankMfo(),1) = '8'
					Set strBind =strBind || ',OSTVD,OSTVK'
				Call SalHideWindow(frm_BalansS)
				! ==================================================
				! Начинаем печать в отчет
				! ==================================================
				! Call Debug(strPrintPath || '/' || IifS(FL_FORMAT, strFileNameRtf, strFileNameTxt))
				Call SalReportPrintToFile(frm_BalansS,
						     strTmplPath, 
						     strPrintPath || '/' || IifS(FL_FORMAT, strFileNameRtf, strFileNameTxt),
						     strBind, strBind, 1, RPT_PrintAll, 1, 1, FL_FORMAT, nInd)
				If nInd > 4
					! Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
					Call SalMessageBox('SalReportPrintToFile - ' || CurrentLangTable.GetAtomTitle('cTErrFunc') || ' ' ||
							     SalNumberToStrX(nInd, 0),  CurrentLangTable.GetAtomTitle('cTAt'), 0)
				! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
				If sAutoForm != 'AUTO'
					Set frm_Out.dfPath = strPrintPath
					Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
				Call SalDestroyWindow(frm_BalansS)
				Call WaitCursorOff()
			On SAM_ReportStart
				! Call Debug('SAM_ReportStart')
				Set PAGE = 0
				Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'RUK', GetGlobalOption('BOSS'))
				Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'GLB', GetGlobalOption('ACCMAN'))
				! Call Debug('1')
				If sAutoForm != 'AUTO'
					Call SqlPrepareAndExecute(cCnc.hSql(), "
							     SELECT to_char(max(fdat),'mm-dd-yyyy')
							     INTO :sDatMax
							     FROM fdat")
					Call SqlFetchNext(cCnc.hSql(), nFetchRes)
				Else
					Call SqlPrepareAndExecute(hSql(), "
							     SELECT to_char(max(fdat),'mm-dd-yyyy')
							     INTO :sDatMax
							     FROM fdat")
					Call SqlFetchNext(hSql(), nFetchRes)
				!
				! Call Debug('2')
				If GetGlobalOption('SALDOB') = '1'
					If GetBankDate() = SalFmtFormatStrDateTime(sDat, 'MM-dd-yyyy') ! Если тек день то делать
						! Call Debug('2a')
						Call CurBalanceReval()
						! Call Debug('2b')
					Set ss = "
							    SELECT s.NBS,sum(s.dos),sum(s.kos),
							           -sum(decode(sign(s.ost),-1,s.ost,0)),
							           sum(decode(sign(s.ost), 1,s.ost,0))
							    INTO :NBS,:DOS,:KOS,:OSTD,:OSTK
							    FROM sal s
							    WHERE s.kv=:n980 and s.fdat= :sDat  and
							          (s.dos>0 or s.kos>0 or s.ost<>0)
							           and s.nbs is not null 
							      and s.nbs<>:NBS_3929
							    GROUP BY s.NBS
							    UNION ALL
							    SELECT s.NBS,sum(s.dos),sum(s.kos),
							           -sum(decode(sign(s.ost),-1,s.ost,0)),
							           sum(decode(sign(s.ost), 1,s.ost,0))
							    FROM sal s
							    WHERE s.kv=:n980 and s.fdat= :sDat  and
							          (s.dos-s.kos<>0 or s.ost<>0)
							           and s.nbs is not null 
							      and s.nbs=:NBS_3929 
							    GROUP BY s.NBS
							    UNION ALL
							    SELECT s.NBS,sum(s.dos),sum(s.kos),
							           -sum(decode(sign(s.ost),-1,s.ost,0)),
							           sum(decode(sign(s.ost), 1,s.ost,0))
							    FROM salB s
							    WHERE s.kv<>:n980 and s.fdat= :sDat  and
							          (s.dos>0 or s.kos>0 or s.ost<>0)
							           and s.nbs is not null
							    GROUP BY s.NBS
							    ORDER BY 1"
				Else If Left(GetBankMfo(),1) = '8'
					Set ss = "
							 SELECT NBS,
							         -sum(decode(sign(ost+dos-kos),-1, ost+dos-kos,0)),
							          sum(decode(sign(ost+dos-kos), 1, ost+dos-kos,0)),
							          sum(dos),
							          sum(kos),
							         -sum(decode(sign(ost),-1,ost,0)),
							          sum(decode(sign(ost), 1, ost,0))
							 INTO :NBS, :OSTVD,:OSTVK, :DOS,:KOS, :OSTD,:OSTK
							 FROM sal
							 WHERE fdat= :sDat  and (dos>0 or kos>0 or ost<>0) and nbs is not null
							 GROUP BY NBS
							UNION ALL
							 SELECT a.nbs,
							        -sum(decode(sign(ost+decode(v1.fdat, :sDat ,v1.dos,0)-decode(v1.fdat, :sDat ,v1.kos,0)),
							                     -1,
							                     ost+decode(v1.fdat, :sDat ,v1.dos,0)-decode(v1.fdat, :sDat ,v1.kos,0),
							                     0)),
							         sum(decode(sign(ost+decode(v1.fdat, :sDat ,v1.dos,0)-decode(v1.fdat, :sDat ,v1.kos,0)),
							                     1,
							                     ost+decode(v1.fdat, :sDat ,v1.dos,0)-decode(v1.fdat, :sDat ,v1.kos,0),
							                     0)),
							        sum(decode(v1.fdat, :sDat ,v1.dos,0)),
							        sum(decode(v1.fdat, :sDat ,v1.kos,0)),
							       -sum(decode(sign(ost),-1, ost,0)),
							        sum(decode(sign(ost), 1, ost,0))
							 FROM accounts_its a, vypiska v1
							 WHERE a.nbs>4999 AND a.nls=v1.nls AND
							     (a.nls,v1.fdat) = (select v2.nls,max(v2.fdat)
							                         from vypiska v2
							                         where v2.nls=a.nls and
							                               v2.fdat<=  :sDat
							                         group by v2.nls)
							 GROUP BY a.nbs
							 ORDER BY 1"
					! Set ss = "
							    SELECT NBS,
							           sum(dos),sum(kos),
							          -sum(decode(sign(ost),-1,ost,0)),
							           sum(decode(sign(ost), 1, ost,0))
							    INTO :NBS,:DOS,:KOS,:OSTD,:OSTK
							    FROM sal
							    WHERE fdat= :sDat  and (dos>0 or kos>0 or ost<>0)
							          and nbs is not null
							    GROUP BY NBS
							    union all
							    select a.nbs,
							    sum(decode(v1.fdat, :sDat ,v1.dos,0)),
							    sum(decode(v1.fdat, :sDat ,v1.kos,0)),
							   -sum(decode(sign(ost),-1, ost,0)),
							    sum(decode(sign(ost), 1, ost,0))
							    FROM accounts_its a, vypiska v1
							    WHERE a.nbs>4999 AND a.nls=v1.nls AND
							     (a.nls,v1.fdat) = (select v2.nls,max(v2.fdat)
							                         from vypiska v2
							                         where v2.nls=a.nls and
							                               v2.fdat<=  :sDat
							                         group by v2.nls)
							    GROUP BY a.nbs
							    ORDER BY 1"
				Else
					Set ss = "
							    SELECT s.NBS,sum(gl.p_icurval(s.kv,s.dos,s.fdat)),
							           sum(gl.p_icurval(s.kv,s.kos,s.fdat)),
							           -sum(decode(sign(s.ost),-1,
							           gl.p_icurval(s.kv,s.ost,s.fdat),0)),
							           sum(decode(sign(s.ost),1,
							           gl.p_icurval(s.kv,s.ost,s.fdat),0))
							    INTO :NBS,:DOS,:KOS,:OSTD,:OSTK
							    FROM sal s
							    WHERE s.fdat= :sDat and (s.dos>0 or s.kos>0 or s.ost<>0)
							          and s.nbs is not null
							    GROUP BY s.NBS
							    ORDER BY s.NBS"
				! Call Debug('3')
				If sAutoForm != 'AUTO'
					Call SqlPrepare(cCnc.hSql(), T(ss))
				Else
					Call SqlPrepare(hSql(), T(ss))
				! Call Debug('4')
			On SAM_ReportFetchInit
				! Call Debug('SAM_ReportFetchInit')
				If sAutoForm != 'AUTO'
					Return SqlExecute(cCnc.hSql())
				Else
					Return SqlExecute(hSql())
			On SAM_ReportFetchNext
				If sAutoForm != 'AUTO'
					If SqlFetchNext(cCnc.hSql(), nFetchRes)
						Set K = SalStrToNumber(SalStrLeftX(NBS, 1))
						Set R = SalStrToNumber(SalStrLeftX(NBS, 2))
						Set G = SalStrToNumber(SalStrLeftX(NBS, 3))
						Set B1 = IifN(K<8, 1, IifN(K<9, 8, 9))
						If NBS_3929 != STRING_Null and  NBS=NBS_3929
							If DOS > KOS
								Set DOS = DOS - KOS
								Set KOS = 0
							Else If DOS < KOS
								Set KOS = KOS - DOS
								Set DOS = 0
							Else
								Set DOS = 0
								Set KOS = 0
						Return TRUE
					Else
						Return FALSE
				Else
					If SqlFetchNext(hSql(), nFetchRes)
						Set K = SalStrToNumber(SalStrLeftX(NBS, 1))
						Set R = SalStrToNumber(SalStrLeftX(NBS, 2))
						Set G = SalStrToNumber(SalStrLeftX(NBS, 3))
						Set B1 = IifN(K<8, 1, IifN(K<9, 8, 9))
						If NBS_3929 != STRING_Null and  NBS=NBS_3929
							If DOS > KOS
								Set DOS = DOS - KOS
								Set KOS = 0
							Else If DOS < KOS
								Set KOS = KOS - DOS
								Set DOS = 0
							Else
								Set DOS = 0
								Set KOS = 0
						Return TRUE
					Else
						Return FALSE
			On SAM_ReportNotify
				If lParam = RPT_BeforeBreakHeader1 !! заголовок баланса
					Set PAGE = 1
					Set fNewClass = TRUE
					Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam), 'PAGE', PAGE)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'SHAP1', GetUserRealName())
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'SHAP', SHAP)
					If sAutoForm = 'AUTO'
						Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'ZAGO', IifS(B1=1, 'Балансов', IifS(B1=8,
								     'Управлінськ', 'Позабалансов')) || 'ий облік')
					Else
						! Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'ZAGO', IifS(B1=1, 'Балансов', IifS(B1=8,
								     'Управлінськ', 'Позабалансов')) || 'ий облік')
						Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'ZAGO', IifS(B1=1,
								     CurrentLangTable.GetAtomTitle('cTZagB'), IifS(B1=8, CurrentLangTable.GetAtomTitle('cTZagU'),
								     CurrentLangTable.GetAtomTitle('cTZagV'))) || ' ' || CurrentLangTable.GetAtomTitle('cTZagO'))
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'aMFO', AMFO)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'aQH', AQH)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'Report_date', strRepDate)
				If lParam=RPT_DoneBreakHeader1   !! заголовок баланса
					Set fNewClass = FALSE
				If lParam=RPT_BeforePageHeader	 !! заголовок на странице
					If not fNewClass
						Set PAGE = PAGE + 1
						Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam), 'PAGE', PAGE)
				If lParam=RPT_BeforeBreakHeader2 !! заголовок класа
					If sAutoForm != 'AUTO'
						Call SqlPrepareAndExecute(cCncAux.hSql(), "
								     SELECT name
								     INTO :sTmp
								     FROM ps
								     WHERE nbs+0=:K")
						Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
					Else
						Call SqlPrepareAndExecute(hSqlAux(), "
								     SELECT name
								     INTO :sTmp
								     FROM ps
								     WHERE nbs+0=:K")
						Call SqlFetchNext(hSqlAux(), nFetchRes)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'sK', sTmp)
				If lParam = RPT_BeforeBreakHeader3 !! заголовок раздела
					If sAutoForm != 'AUTO'
						Call SqlPrepareAndExecute(cCncAux.hSql(), "
								     SELECT name
								     INTO :sTmp
								     FROM ps
								     WHERE nbs+0=:R")
						Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
					Else
						Call SqlPrepareAndExecute(hSqlAux(), "
								     SELECT name
								     INTO :sTmp
								     FROM ps
								     WHERE nbs+0=:R")
						Call SqlFetchNext(hSqlAux(), nFetchRes)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'sR', sTmp)
				If lParam = RPT_BeforeBreakHeader4 !! заголовок группы
					If sAutoForm != 'AUTO'
						Call SqlPrepareAndExecute(cCncAux.hSql(), "
								     SELECT name
								     INTO :sTmp
								     FROM ps
								     WHERE nbs+0=:G")
						Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
					Else
						Call SqlPrepareAndExecute(hSqlAux(), "
								     SELECT name
								     INTO :sTmp
								     FROM ps
								     WHERE nbs+0=:G")
						Call SqlFetchNext(hSqlAux(), nFetchRes)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'sG', sTmp)
			On SAM_ReportFinish
				! Call Debug('SAM_ReportFinish')
				! If sDat != sDatMax
					! Call SqlPrepareAndExecute(hSqlAux(), "DROP table " || sid)
					! Call SqlPrepareAndExecute(hSqlAux(), "commit")
				If sAutoForm != 'AUTO'
					Call SalSendMsg(frm_Out.tblReps, UM_ReportFinish, 0, 0)
				! Else 
					                                  If not FL_FORMAT
						                                  Call Debug('zarez12Del - ' || strPrintPath || '/' || strFileNameTxt || ' - nNODEL = ' || Str(nNODEL))
						                                  Call zarez12Del(strPrintPath || '/' || strFileNameTxt, nKOD, sDeviceDef, not nNODEL)
			On SAM_Destroy
				! Call Debug('SAM_Destroy')
				If sAutoForm != 'AUTO'
					If cCnc.IsConnected()
						Call cCnc.Disconnect()
					If cCncAux.IsConnected()
						Call cCncAux.Disconnect()
	Dialog Box: dlg_DirSelect
		Class:
		Property Template:
		Class DLL Name:
		Title: Директория отчета
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: System Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  4.267"
				Width Editable? Yes
				Height: 3.536"
				Height Editable? Yes
			Absolute Screen Location? No
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   2.5"
					Top:    2.667"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call SalEndDialog(hWndForm, 0)
					On SAM_SetFocus
						Call SalStatusSetText(hWndForm, 'Завершить')
			Pushbutton: pbOk
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cpbOk
				Property Template:
				Class DLL Name:
				Title: Выбрать
				Window Location and Size
					Left:   0.6"
					Top:    2.667"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Set strPrintPath = SalStrLeftX ( lbDir.GetSelectedDir()   ,  SalStrLength(lbDir.GetSelectedDir() ) - 1 )
						Set frm_Out.dfPath = SalStrUpperX( strPrintPath )
						Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
						Call SalEndDialog(hWndForm, 0)
			Combo Box: cmbDrive
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cDriveComboBox
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   -0.014"
					Top:    2.156"
					Width:  4.1"
					Width Editable? Class Default
					Height: 1.063"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Click
						Call lbDir.Populate (cmbDrive.GetSelectedDrive() )
			Frame
				Resource Id: 63313
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   -0.014"
					Top:    2.488"
					Width:  4.2"
					Width Editable? Yes
					Height: 0.75"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Frame
				Resource Id: 63314
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   -0.014"
					Top:    0.031"
					Width:  4.2"
					Width Editable? Yes
					Height: 2.542"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			Frame
				Resource Id: 63315
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   -0.014"
					Top:    2.156"
					Width:  4.1"
					Width Editable? Yes
					Height: 0.333"
					Height Editable? Yes
				Visible? Yes
				Corners: Square
				Border Style: Etched
				Border Thickness: 1
				Border Color: Default
				Background Color: Default
			List Box: lbDir
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cDirListBox
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   -0.014"
					Top:    0.073"
					Width:  4.1"
					Width Editable? Class Default
					Height: 2.083"
					Height Editable? Class Default
				Visible? Class Default
				Multiple selection? Class Default
				Sorted? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Horizontal Scroll? Class Default
				List Initialization
				Message Actions
		Functions
		Window Parameters
		Window Variables
			String: strCurrDir
		Message Actions
			On SAM_Create
				Call SalFileGetCurrentDirectory( strCurrDir )
				Call SalFileSetCurrentDirectory( strPrintPath )	
				Call lbDir.Populate (strPrintPath)
				Call SalCenterWindow( hWndForm )
			On SAM_Close
				Call SalFileSetCurrentDirectory( strCurrDir )	
	Form Window: frm_UniSal    !! Универсальная Сальдовка в номинале и в эквиваленте
		Class:
		Property Template:
		Class DLL Name:
		Title: Оборотно-сальдовая ведомость
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.838"
				Top:    0.688"
				Width:  5.333"
				Width Editable? Yes
				Height: 2.188"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Оборотно-сальдовая ведомость
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
		Functions
		Window Parameters
			Number: nSortMode	! тип сортировки и группировки
			String: sDat 		! дата
			Number: fAllInUse	! использовать все счета (альтернатива - только SALDO)
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			: cCncAux
				Class: cABSConnect
			String: strBankMfo
			String: strBankName
			String: strQuery
			String: strOrderBy
			!
			Number: nPar
			Number: nTmp
			String: sPdat
			Number: nOstF
			Number: nOstQ
			Number: KV
			String: NBS
			Date/Time: DAPP
			String: NLS
			Number: DOS
			Number: KOS
			Number: OSTID
			Number: OSTIK
			Number: DOSQ
			Number: KOSQ
			Number: OSTIDQ
			Number: OSTIKQ
			String: NMS
			Number: ISP
			String: LCV
			! String: sIsp
			String: sGrB
			String: NAMV
			! String: sP1
			!
			Number: nRow
			: cQSaldo
				Class: cGenQuery
			: cFSaldo
				Class: cGenFilter
			!
			Number: nDig
			Number: DIG
		Message Actions
			On SAM_Create
				Call SetWindowFont(hWndForm)
				Call SalWaitCursor(TRUE)
				Call cCnc.Clone(g_cRepCnc, TRUE)
				Call cCncAux.Clone(cCnc, TRUE)
				!
				Call SalHideWindow( hWndForm )
						
				! ===== Старый код = имя файла формируется при выборкеотчета ===========
				! Set strFileName = SalStrLeftX(strFileName, SalStrScan(strFileName, '.')+1) ||
						                  SalStrRightX( SalNumberToStrX( GetUserId(), 0 ), 3 )
						
				Set strBind = 'KV,NBS,DAPP,NLS,DOS,KOS,OSTID,OSTIK,DOSQ,KOSQ,OSTIDQ,OSTIKQ,NMS,ISP,LCV'
				Set strInput = strBind
				Call cFSaldo.Init( 'SAL', 'A' )
				!
				Set nPar=0
				If nPar=0 !! Сальдовка
					Set strQuery =
							'SELECT a.dapp,a.kv,a.nbs,a.nls,a.ost/100,a.dos/100,a.kos/100,
							        gl.p_icurval(a.kv,a.ost,a.fdat)/100,
							        gl.p_icurval(a.kv,a.dos,a.fdat)/100,
							        gl.p_icurval(a.kv,a.kos,a.fdat)/100,a.nms,a.isp,t.lcv
							   INTO :DAPP,:KV,:NBS,:NLS,:nOstF,:DOS,:KOS,:nOstQ,:DOSQ,:KOSQ,:NMS,:ISP,:LCV
							   FROM sal a,tabval t
							   WHERE (a.dazs IS NULL OR a.dazs > :sDat ) AND a.fdat = :sDat AND a.kv=t.kv '
				!
				Else If nPar=1 !! Деб обороты (сумма и кол) по БС
					! Set strBind = 'KV,NBS,NLS,DOS,KOS,DOSQ,NMS,ISP'
					Set strQuery =
							"SELECT a.kv, a.nbs, a.nls, a.dos/100,
							        gl.p_icurval(a.kv,a.dos,a.fdat)/100,
							        a.nms, count(*)
							 INTO :KV,:NBS,:NLS,:DOS,:DOSQ,:NMS,:ISP,:KOS
							 FROM sal a, opldok o
							 WHERE o.dk=0 AND o.fdat=a.fdat AND o.acc=a.acc AND a.dos>0 AND a.fdat= :sDat "
				If NOT fAllInUse
					Set strQuery = strQuery || ' AND a.acc IN (SELECT acc FROM saldo)'
					! Set strOrderBy = 'isp,'
				If nPar=1
					Set strQuery = strQuery ||" GROUP BY a.kv, a.nbs, a.nls, a.dos, a.fdat,a.nms,a.isp"
				Select Case nSortMode
					Case 0		! Балансовый счет, код валюты
						Set strOrderBy = 'SUBSTR(a.nls,1,4)||SUBSTR(a.nls,6),a.kv'
						Set strBind = strBind||',DIG'
						Set strInput = strBind
						Break
					Case 1		! Код валюты, балансовый счет
						Set strOrderBy = 'a.kv,SUBSTR(a.nls,1,4)||SUBSTR(a.nls,6)'
						Break
					Default
						Set strOrderBy = 'a.kv,a.nbs'
						Break
				! Set strOrderBy = strOrderBy || ',substr(nls,1,4)||substr(nls,6)'
				Set strQuery = strQuery || ' ORDER BY ' || strOrderBy
				!
				Call cQSaldo.Init(  strQuery )
				Call SetQueryFilter( cFSaldo )
				!
				! Call SalReportPrintToFile(hWndForm, strDir, GetPrnDir() || '/' || IifS(FL_FORMAT, strFileName1, strFileName),
						     strBind, strBind, 1, RPT_PrintAll, 1, 1, FL_FORMAT, nInd)
				! ==================================================
				! Начинаем печать в отчет
				! ==================================================
				Call SalReportPrintToFile(hWndForm, 
						                                                        strTmplPath, 
						                                                        strPrintPath ||'/'|| IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt),
						                                                        strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
				If nInd>4
					! Call SalMessageBox( 'Ошибка '||SalNumberToStrX(nInd,0)||' формирования отчета', 'Внимание', MB_IconStop )
					Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_UniSal.cTMsg11') || ' '||SalNumberToStrX(nInd,0)||' ' || 
							  CurrentLangTable.GetAtomTitle('frm_UniSal.cTMsg12'), 
							  CurrentLangTable.GetAtomTitle('cTAt'), MB_IconStop )
				! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
				Set frm_Out.dfPath = strPrintPath
				Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
				!
				Call SalWaitCursor(FALSE)
				Call SalDestroyWindow(hWndForm)
				Return TRUE
			On SAM_ReportStart
				Call SqlPrepare(cCnc.hSql(), T( cQSaldo.GetFullSQLString( cFSaldo )))
			On SAM_ReportFetchInit
				Return SqlExecute(cCnc.hSql())
			On SAM_ReportFetchNext
				If NOT fAllInUse
					Set ISP = NUMBER_Null
				If SqlFetchNext(cCnc.hSql(), nFetchRes)
					! проверка на 3 знака
					Call SqlPrepareAndExecute(cCncAux.hSql(), "
							SELECT dig INTO :nDig
							FROM tabval
							WHERE kv = :KV")
					If not SqlFetchNext(cCncAux.hSql(), nFetchRes)
						Return FALSE
					Set nOstF = nOstF*SalNumberPower( 10,2-nDig )
					Set DOS   = DOS*SalNumberPower( 10,2-nDig )
					Set KOS   = KOS*SalNumberPower( 10,2-nDig )
					! Set nOstQ = nOstQ*SalNumberPower( 10,2-nDig )
					! Set DOSQ  = DOSQ*SalNumberPower( 10,2-nDig )
					! Set KOSQ  = KOSQ*SalNumberPower( 10,2-nDig )
					Set DIG   = nDig 
					!
					If nOstF<0
						Set OSTID  = -nOstF
						Set OSTIDQ = -nOstQ
						Set OSTIK  = 0
						Set OSTIKQ = 0
					Else
						Set OSTID  = 0
						Set OSTIDQ = 0
						Set OSTIK  = nOstF
						Set OSTIKQ = nOstQ
					Return TRUE
				Else
					Return FALSE
			On SAM_ReportNotify
				If lParam=RPT_BeforeReportHeader
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'aMFO',  AMFO)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'aNAME', AQH)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'Report_date', strRepDate)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'SHAP', SHAP)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'FIO',  IDNAME)
			On SAM_ReportFinish
				Call SalSendMsg( frm_Out.tblReps, UM_ReportFinish, 0, 0)
			On SAM_Destroy
				If cCnc.IsConnected()
					Call cCnc.Disconnect()
				If cCncAux.IsConnected()
					Call cCncAux.Disconnect()
	Form Window: frm_BalansOB  !! Баланс по валютам (без ГРН) номинал в один файл для Ощадбанка
		Class:
		Property Template:
		Class DLL Name:
		Title: Баланс банка
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.838"
				Top:    0.688"
				Width:  3.717"
				Width Editable? Yes
				Height: 1.286"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Баланс
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: Формирование...
				Resource Id: 19793
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.133"
					Top:    0.095"
					Width:  1.8"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Left
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
		Functions
			Function: FU_SAL
				Description: Печать баланса по ОДНОМУ
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalWaitCursor(TRUE)
					! ==================================================
					! Начинаем печать в отчет
					! ==================================================
					Call SalReportPrintToFile(hWndForm, 
							                                              strTmplPath, 
							                                               strPrintPath ||'/'|| IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt),
							                                               strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
					If (nInd > 4 )
						Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
								
					! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
					Set frm_Out.dfPath = strPrintPath
					Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
							
					Call SalWaitCursor(FALSE)
		Window Parameters
			String: sdat
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			: cCncAux
				Class: cABSConnect
			Number: B1
			Number: KV
			Number: K
			Number: R
			Number: G
			String: NBS
			Number: DOS
			Number: KOS
			Number: OSTD
			Number: OSTK
			Number: nRow
			Number: nTmp
			String: sTmp
			!
			Number: PAGE
			Boolean: fNewClass
		Message Actions
			On SAM_Create
				Call SalCenterWindow( frm_BalansOB )
				Call cCnc.Clone(g_cRepCnc, TRUE)
				Call cCncAux.Clone(cCnc, TRUE)
				Set strBind = 'B1,KV,K,R,G,NBS,DOS,KOS,OSTD,OSTK'
				Set strInput = strBind
				Call FU_SAL()
				Call SalDestroyWindow( frm_BalansOB )
			On SAM_ReportStart
				Set PAGE = 0
				Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
						     'RUK', GetGlobalOption('BOSS'))
				Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
						     'GLB', GetGlobalOption('ACCMAN'))
				Set sTmp = T("
						    SELECT kv,nbs,-SUM(decode(sign(ost),-1,ost,0))/100,
						           SUM(decode(sign(ost), 1,ost,0))/100,SUM(dos)/100,
						           SUM(kos)/100
						    FROM sal
						    INTO :KV,:NBS,:OSTD,:OSTK,:DOS,:KOS
						    WHERE fdat= :sdat and kv<>980
						    GROUP BY kv,nbs
						    HAVING SUM(ost)<>0 OR SUM(dos)<>0 OR SUM(kos)<>0
						    ORDER BY kv,nbs")
				Call SqlPrepare(cCnc.hSql(), sTmp)
			On SAM_ReportFetchInit
				Return SqlExecute(cCnc.hSql())
			On SAM_ReportFetchNext
				If SqlFetchNext(cCnc.hSql(), nFetchRes)
					Set K = SalStrToNumber(SalStrLeftX(NBS, 1))
					Set R = SalStrToNumber(SalStrLeftX(NBS, 2))
					Set G = SalStrToNumber(SalStrLeftX(NBS, 3))
					Set B1 = IifN(K<8, 1, IifN(K<9, 8, 9))
					Return TRUE
				Else
					Return FALSE
			On SAM_ReportNotify
				If lParam = RPT_BeforeReportHeader
					!
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'aMFO', AMFO)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'aQH', AQH)
					!
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'Report_date', strRepDate)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'SHAP', SHAP)
				If lParam = RPT_BeforeBreakHeader1
					!
					Call SqlPrepareAndExecute(cCncAux.hSql(), "
							     SELECT lcv || ' ' || name
							     INTO :sTmp
							     FROM tabval
							     WHERE kv=:KV")
					Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'NAMV', sTmp)
				If lParam = RPT_BeforeBreakHeader2
					Set PAGE = 1
					Set fNewClass = TRUE
					Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam),
							     'PAGE', PAGE)
					Set sTmp = IifS(B1=1, 'Балансовий', IifS(B1=8,
							    'Управлінський', 'Позабалансовий')) || ' облік'
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'ZAGO', sTmp)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'sR', GetUserRealName())
					!
				If lParam = RPT_DoneBreakHeader2
					Set fNewClass = FALSE
				If lParam = RPT_BeforePageHeader
					If not fNewClass
						Set PAGE = PAGE + 1
						Call SalReportSetNumberVar(
								     SalNumberToWindowHandle(wParam), 'PAGE', PAGE)
				If lParam = RPT_BeforeBreakHeader3
					Call SqlPrepareAndExecute(cCncAux.hSql(), T("
							     SELECT name[1,70]
							     INTO :sTmp
							     FROM ps
							     WHERE nbs+0=:K"))
					Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'sK', sTmp)
				If lParam = RPT_BeforeBreakHeader4
					Call SqlPrepareAndExecute(cCncAux.hSql(), T("
							     SELECT name[1,70]
							     INTO :sTmp
							     FROM ps
							     WHERE nbs+0=:R"))
					Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'sR', sTmp)
				If lParam = RPT_BeforeBreakHeader5
					Call SqlPrepareAndExecute(cCncAux.hSql(), T("
							     SELECT name[1,70]
							     INTO :sTmp
							     FROM ps
							     WHERE nbs+0=:G"))
					Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'sG', sTmp)
			On SAM_ReportFinish
				Call SalSendMsg(frm_Out.tblReps, UM_ReportFinish, 0, 0)
			On SAM_Destroy
				If cCnc.IsConnected()
					Call cCnc.Disconnect()
				If cCncAux.IsConnected()
					Call cCncAux.Disconnect()
	Form Window: frm_JS        !! журнал открытых счетов
		Class:
		Property Template:
		Class DLL Name:
		Title: Баланс банка
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.838"
				Top:    0.688"
				Width:  7.125"
				Width Editable? Yes
				Height: 3.563"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
		Functions
		Window Parameters
			String: sdat
			String: sdat2
			String: sim
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			String: CUT
			Number: RNK
			String: NMK
			String: NLS
			String: NBS
			Number: KV
			Number: KURS
			String: NMS
			Number: SV
			Number: SG
			Number: SK
			Date/Time: DAOS
			String: ISP
			Date/Time: DAZS
			Number: PAP
			Number: POS
			String: CUTN
			String: maska
			String: ss
		Message Actions
			On SAM_Create
				Call SetWindowFont(hWndForm)
				Call cCnc.Clone(g_cRepCnc, TRUE)
				Set strBind='CUT,RNK,NMK,NLS,KV,NMS,DAOS,ISP,DAZS,PAP,POS'
				! Set maska=Maska_NLS("счетов")
				Set maska = Maska_NLS(CurrentLangTable.GetAtomTitle('cTSelectAcc'))
				If maska='-'
					Call SalDestroyWindow( hWndForm )
					Return FALSE
				Set strInput=strBind
				If sim='*' 	  !! всех по типу клиента
					Set ss=T("
							SELECT a.nbs, t.name, r.rnk, r.nmk[1,38], a.nls,
							       a.nms[1,38], a.kv, a.daos, r.okpo, a.dazs, a.pap,a.pos
							INTO  :CUT, :CUTN, :RNK, :NMK, :NLS, :NMS, :KV,
							      :DAOS, :ISP, :DAZS, :PAP,:POS
							FROM  Customer r, Accounts a, Cust_acc ra,  Custtype t
							WHERE r.rnk=ra.rnk and a.acc=ra.acc and t.custtype=r.custtype "||
							     IifS(maska !='*'," AND trim(a.nls) LIKE \'"||SalStrTrimX(maska)||"\'",'')||"
							ORDER BY r.custtype,  r.rnk, a.nls, a.kv")
				Else If sim='B'	  !! всех (сорт.по БС)
					Set strBind='CUT,RNK,NMK,NBS,NLS,KV,NMS,DAOS,ISP,DAZS,PAP,POS'
					Set strInput=strBind
					Set ss=T("
							SELECT r.custtype,t.name, r.rnk, r.nmk[1,38],a.nbs, a.nls,
							       a.nms[1,38], a.kv, a.daos, r.okpo, a.dazs, a.pap,a.isp
							INTO  :CUT, :CUTN, :RNK, :NMK, :NBS, :NLS, :NMS, :KV,
							      :DAOS, :ISP, :DAZS, :PAP,:POS
							FROM  Customer r, Accounts a, Cust_acc ra,  Custtype t
							WHERE r.rnk=ra.rnk and a.acc=ra.acc and t.custtype=r.custtype "||
							     IifS(maska !='*'," AND trim(a.nls) LIKE \'"||SalStrTrimX(maska)||"\'",'')||"
							ORDER BY a.nbs, substr(a.nls,6,9), a.kv ")
				Else If sim='N'	  !! всех по исполнителям
					Set ss = T("
							        SELECT a.isp,t.fio, r.rnk, r.nmk[1,38], a.nls, a.nms[1,38], a.kv,
							                 a.daos,r.okpo, a.dazs, a.pap, a.pos
							        INTO :CUT,:CUTN,:RNK,:NMK,:NLS,:NMS, :KV,:DAOS,
							                   :ISP,:DAZS,:PAP,:POS
							        FROM Customer r, Accounts a, Cust_acc ra, Staff t
							         WHERE   r.rnk=ra.rnk and a.acc=ra.acc  and  a.isp=t.id "||
							      IifS(maska !='*'," AND trim(a.nls) LIKE \'"||SalStrTrimX(maska)||"\'",'')||"
							ORDER BY a.isp, r.rnk, a.nls, a.kv")
				Else If sim='D'	  !! всех действующих по исполнителям
					Set ss = T("
							SELECT a.isp,t.fio, r.rnk, r.nmk[1,38], a.nls, a.nms[1,38], a.kv,
							       a.daos,r.okpo, a.dazs, a.pap, A.POS
							INTO :CUT,:CUTN,:RNK,:NMK,:NLS,:NMS, :KV,:DAOS,:ISP,:DAZS,:PAP,:POS
							FROM  Customer r, Accounts a, Cust_acc ra, Staff t
							WHERE r.rnk=ra.rnk and a.acc=ra.acc and a.dazs is null
							and a.isp=t.id "||
							IifS(maska !='*'," AND trim(a.nls) LIKE \'"||
							SalStrTrimX(maska)||"\'",'')||"
							ORDER BY a.isp, r.rnk, a.nls, a.kv")
				Else If sim='ND'  !! всех по исполнителям и по датам
					Set sdat  = SalFmtFormatDateTime(SalFmtFormatStrDateTime( sdat,  "MM-dd-yyyy" ), "dd/MM/yyyy")
					Set sdat2 = SalFmtFormatDateTime(SalFmtFormatStrDateTime( sdat2, "MM-dd-yyyy" ), "dd/MM/yyyy")
					Set sdat  = SalFmtFormatDateTime(SalFmtFormatStrDateTime( sdat,  "dd/MM/yyyy" ), "MM-dd-yyyy")
					Set sdat2 = SalFmtFormatDateTime(SalFmtFormatStrDateTime( sdat2, "dd/MM/yyyy" ), "MM-dd-yyyy")
					Set ss = T("
							        SELECT a.isp,t.fio, r.rnk, r.nmk[1,38], a.nls, a.nms[1,38], a.kv,
							                 a.daos,r.okpo, a.dazs, a.pap, a.pos
							        INTO :CUT,:CUTN,:RNK,:NMK,:NLS,:NMS, :KV,:DAOS,
							                   :ISP,:DAZS,:PAP,:POS
							        FROM Customer r, Accounts a, Cust_acc ra, Staff t
							        WHERE   r.rnk=ra.rnk and a.acc=ra.acc  and
							                date(a.daos) >= :sdat  and  date(a.daos) <= :sdat2
							                and a.isp=t.id "||
							      IifS(maska !='*'," AND trim(a.nls) LIKE \'"||SalStrTrimX(maska)||"\'",'')||"
							ORDER BY a.isp, r.rnk, a.nls, a.kv")
				! Else If sim='U'	  !! обновление счетов
					                                                               Set ss = T("
							SELECT to_char(a.chgdate,'dd-mm-yyyy'),r.rnk,r.nmk[1,38] ,a.nls,a.nms[1,38] ,
							       a.kv,a.daos, r.okpo, a.dazs, a.pap, A.POS
							INTO :CUT,:RNK,:NMK,:NLS,:NMS,:KV,:DAOS,:ISP,:DAZS,:PAP,:POS
							FROM  Customer r, Accounts_update a, Cust_acc ra
							WHERE r.rnk=ra.rnk and a.acc=ra.acc AND a.chgdate>=  :sdat  and a.chgdate<=  :sdat2 "||
							      IifS(maska !='*'," AND trim(a.nls) LIKE \'"||SalStrTrimX(maska)||"\'",'')||"
							ORDER BY a.chgdate,2,4,6")
				Else If sim='Z'	  !! всех закрытых по исп за период
					Set ss = T("
							SELECT a.isp,t.fio, r.rnk, r.nmk[1,38], a.nls, a.nms[1,38], a.kv,
							       a.daos,r.okpo, a.dazs, a.pap, A.POS   
							INTO :CUT,:CUTN,:RNK,:NMK,:NLS,:NMS, :KV,:DAOS,:ISP,:DAZS,:PAP,:POS   
							FROM  Customer r, Accounts a, Cust_acc ra, Staff t   
							WHERE r.rnk=ra.rnk and a.acc=ra.acc and a.dazs is not null   
							and  a.dazs>=  :sdat  and a.dazs<=  :sdat2     
							and a.isp=t.id   "||
							IifS(maska !='*'," AND trim(a.nls) LIKE \'"||  
							SalStrTrimX(maska)||"\'",'')  ||  "
							   ORDER BY a.isp, r.rnk, a.nls, a.kv  ")
				! Else If sim='LS'  !! по лицевым счетам
					                                                               Set sdat  = SalFmtFormatDateTime(SalFmtFormatStrDateTime( sdat,  "MM-dd-yyyy" ), "dd/MM/yyyy")
					                                                               Set sdat2 = SalFmtFormatDateTime(SalFmtFormatStrDateTime( sdat2, "MM-dd-yyyy" ), "dd/MM/yyyy")
					                                                               Set sdat  = SalFmtFormatDateTime(SalFmtFormatStrDateTime( sdat,  "dd/MM/yyyy" ), "MM-dd-yyyy")
					                                                               Set sdat2 = SalFmtFormatDateTime(SalFmtFormatStrDateTime( sdat2, "dd/MM/yyyy" ), "MM-dd-yyyy")
					                                                               Set ss = T("
							SELECT r.custtype, t.name, r.rnk, r.nmk[1,38], a.nls,
							      a.nms[1,38] , a.kv, a.daos, r.okpo, a.dazs, a.pap,A.POS
							INTO  :CUT,:CUTN,:RNK,:NMK,:NLS,:NMS,:KV,:DAOS,:ISP,:DAZS,:PAP,:POS
							FROM Customer r, Accounts a, Cust_acc ra, Custtype t WHERE
							      r.rnk=ra.rnk and a.acc=ra.acc and
							      t.custtype=r.custtype and date(a.daos) >= :sdat   and
							      date(a.daos) <= :sdat2  "||
							      IifS(maska !='*'," AND trim(a.nls) LIKE \'"||SalStrTrimX(maska)||"\'",'')||"
							ORDER BY  r.custtype, a.nls, a.kv")
				Else !! по датам
					Set sdat  = SalFmtFormatDateTime(SalFmtFormatStrDateTime( sdat,  "MM-dd-yyyy" ), "dd/MM/yyyy")
					Set sdat2 = SalFmtFormatDateTime(SalFmtFormatStrDateTime( sdat2, "MM-dd-yyyy" ), "dd/MM/yyyy")
					Set sdat  = SalFmtFormatDateTime(SalFmtFormatStrDateTime( sdat,  "dd/MM/yyyy" ), "MM-dd-yyyy")
					Set sdat2 = SalFmtFormatDateTime(SalFmtFormatStrDateTime( sdat2, "dd/MM/yyyy" ), "MM-dd-yyyy")
					Set ss = T("
							SELECT r.custtype, t.name, r.rnk, r.nmk[1,38], a.nls,
							      a.nms[1,38] , a.kv, a.daos, r.okpo, a.dazs, a.pap,A.POS
							INTO  :CUT,:CUTN,:RNK,:NMK,:NLS,:NMS,:KV,:DAOS,:ISP,:DAZS,:PAP,:POS
							FROM Customer r, Accounts a, Cust_acc ra, Custtype t WHERE
							      r.rnk=ra.rnk and a.acc=ra.acc and
							      t.custtype=r.custtype and date(a.daos) >= :sdat   and
							      date(a.daos) <= :sdat2  "||
							      IifS(maska !='*'," AND trim(a.nls) LIKE \'"||SalStrTrimX(maska)||"\'",'')||"
							ORDER BY r.custtype, r.rnk, a.nls, a.kv")
				Call WaitCursorOn()
				Call SalHideWindow(hWndForm)
				! Call SalReportPrintToFile(hWndForm,strDir,GetPrnDir()||
						     '/'|| IifS(FL_FORMAT,strFileName1,strFileName),
						     strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
				! ==================================================
				! Начинаем печать в отчет
				! ==================================================
				Call SalReportPrintToFile(hWndForm, strTmplPath, 
						 strPrintPath ||'/'|| IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt),
						 strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
				If nInd >4
					! Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
					Call SalMessageBox(' SalReportPrintToFile - ' || 
							  CurrentLangTable.GetAtomTitle('cTErrFunc') || ' ' || SalNumberToStrX(nInd,0), 
							  CurrentLangTable.GetAtomTitle('cTAt'), 0 )
				! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
				Set frm_Out.dfPath = strPrintPath
				Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
				Call SalDestroyWindow(hWndForm)
			On SAM_ReportStart ! приготовить SELECT
				Return SqlPrepare(cCnc.hSql(), ss)
			On SAM_ReportFetchInit
				Return SqlExecute(cCnc.hSql())
			On SAM_ReportFetchNext
				Return SqlFetchNext(cCnc.hSql(), nFetchRes)
			On SAM_ReportNotify
				If lParam=RPT_BeforeBreakHeader1
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'AMFO',AMFO)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'AQH',AQH)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'SHAP',
							SHAP||' ' || IifS( sim='*' or sim='B' or sim='N' or  sim='U', '',strDateFrom||" - "||strDateTo||" " )||
							IifS(sim='B','',IifS(sim='U',CUT,CUTN)) )
			On SAM_Destroy
				If cCnc.IsConnected()
					Call cCnc.Disconnect()
				Call WaitCursorOff()
			On SAM_ReportFinish
				Call SalSendMsg( frm_Out.tblReps, UM_ReportFinish, 0, 0)
	Form Window: frm_KJ
		Class:
		Property Template:
		Class DLL Name:
		Title: Баланс банка
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.838"
				Top:    0.688"
				Width:  7.125"
				Width Editable? Yes
				Height: 3.563"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
		Functions
		Window Parameters
			String: sdat
			Number: UD
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			String: ss
			Number: npp
			!
			String: maska
			Number: DK
			String: KAS
			String: ND
			String: NLS
			Number: SK
			Number: S
			Number: S1
			String: FIO
			String: strRBSName
			! Date/Time: dRab
		Message Actions
			On SAM_Create
				Call cCnc.Clone(g_cRepCnc, TRUE)
				Set strBind = 'DK,KAS,ND,NLS,SK,S,S1' !! наши переменные
				Set strInput =strBind !! переменные в отчете
				If SalStrTrimX(SalStrUpperX(GetDBMS()))='ORACLE'
					Set strRBSName = GetGlobalOption( 'RNBURBCK' )
					Set ID = GetUserId()
					If strRBSName
						! ! Make end of transaction and start new
						Call SqlCommit(cCnc.hSql())
						! ! to avoid error with set transaction...
						Call SqlPrepareAndExecute(cCnc.hSql(), 'SET TRANSACTION USE ROLLBACK SEGMENT ' || SalStrUpperX(strRBSName) )
					If not SqlPLSQLCommand(cCnc.hSql(), "P_KJ(ID,sdat,sdat)")
						Return FALSE
				If UD>0
					Set ss =
							"SELECT DK,kas,ND,nls,sk,S/100
							 INTO :DK,:KAS,:ND,:NLS,:SK,:S FROM tmp_kj
							WHERE id=:ID and ud=id ORDER BY 2,1,3,4"
				Else
					! Set maska=Maska_NLS("счетов")
					Set maska=Maska_NLS(CurrentLangTable.GetAtomTitle('cTSelectAcc'))
					If maska = '-'
						Call SalDestroyWindow(hWndForm)
						Return TRUE
					Set ss =
							"SELECT DK,kas,ND,nls,sk,S/100
							 INTO :DK,:KAS,:ND,:NLS,:SK,:S FROM tmp_kj
							WHERE id=:ID and kas LIKE '" || maska || "'
							 ORDER BY 2,1,3,4"
				! Set ss = T("/
						SELECT p.dk, s.kv||' '||s.nls||' '||s.nms, o.ND,
						       decode(s.nls, o.nlsa, o.nlsb, o.nlsa ),
						       decode(p.tt,o.tt,o.SK,t.sk), p.S/100
						  FROM  OPER O, OPLDOK P, accounts S, tts t
						   INTO :DK,:KAS,:ND,:NLS,:SK,:S
						   WHERE  p.acc=s.acc AND
						          s.tip='KAS' AND
						          p.fdat = :sdat  AND
						          t.tt=p.tt AND
						          o.ref=p.ref AND p.SOS=5"||
						IifS(ID=0, ""," and o.userid= :ID ") || "
						ORDER BY 2,1,3,4 ")
				Call WaitCursorOn()
				Call SalHideWindow(hWndForm)
				! Call SalReportPrintToFile(hWndForm,strDir,
						                      GetPrnDir()||'/'|| IifS(FL_FORMAT,strFileName1,strFileName),strBind,strInput,
						                        1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
				! ==================================================
				! Начинаем печать в отчет
				! ==================================================
				Call SalReportPrintToFile(hWndForm, 
						                                                        strTmplPath, 
						                                                        strPrintPath ||'/'|| IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt),
						                                                        strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
				If (nInd > 4 )
					! Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
					Call SalMessageBox(' SalReportPrintToFile - ' || 
							  CurrentLangTable.GetAtomTitle('cTErrFunc') || ' ' || SalNumberToStrX(nInd,0), 
							  CurrentLangTable.GetAtomTitle('cTAt'),0 )
				! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
				Set frm_Out.dfPath = strPrintPath
				Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
				Call SalDestroyWindow(hWndForm)
			On SAM_ReportStart
				Call SqlPrepare(cCnc.hSql(), ss)
			On SAM_ReportFetchInit
				Return SqlExecute(cCnc.hSql())
			On SAM_ReportFetchNext
				If SqlFetchNext(cCnc.hSql(), nFetchRes)
					Set S1=S*(1-DK)
					Return TRUE
				Else
					Return FALSE
			On SAM_ReportNotify
				If lParam=RPT_BeforeBreakHeader1  !! KAS
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'AMFO', AMFO)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'AQH', AQH)
					! Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'SHAP',SHAP||' '||sd1)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'SHAP',SHAP||' '||strDateFrom)
					If ID !=0
						Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'FIO', GetUserRealName())
			On SAM_ReportFinish
				Call SalSendMsg( frm_Out.tblReps, UM_ReportFinish, 0, 0)
			On SAM_Destroy
				If cCnc.IsConnected()
					Call cCnc.Disconnect()
				Call WaitCursorOff()
	Form Window: frm_KRED
		Class:
		Property Template:
		Class DLL Name:
		Title: Подразделение для печати документов
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   1.75"
				Top:    0.927"
				Width:  10.0"
				Width Editable? Yes
				Height: 5.5"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Кредиты
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Child Table: tbl1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.067"
						Top:    0.048"
						Width:  9.683"
						Width Editable? Yes
						Height: 4.5"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Blue
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 3000
					Discardable? No
				Contents
					Column: Kod1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.567"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NAME1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: НАИМЕНОВАНИЕ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  7.3"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
			Pushbutton: pb1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Сводный документ
				Window Location and Size
					Left:   0.983"
					Top:    4.679"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Dark Blue
				Background Color: Default
				Message Actions
					On SAM_Click
						Set N = 0
						Set nKto = 1 
						Call PRINT()
			Pushbutton: pb2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: По подразделению
				Window Location and Size
					Left:   3.6"
					Top:    4.679"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: MS Sans Serif
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Midnight Blue
				Background Color: Default
				Message Actions
					On SAM_Click
						Set N=tbl1.Kod1
						Set strFileNameTxt=SalStrLeftX( strFileNameTxt, 5 ) || NumberToStrFormat(N,3,'0', TRUE) 
						Set nKto = 2
						Call PRINT()
			Pushbutton: pb3
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Завершить
				Window Location and Size
					Left:   6.2"
					Top:    4.679"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalDestroyWindow(hWndForm)
		Functions
			Function: PRINT
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalWaitCursor(TRUE)
					! Для налоговой декларации
					If nPara >85 and nPara <100
						If P4 = 1 !! 1 кв для одиночек и для свода - одинаковый
							Set TIPD = "
									    SELECT 0
									    INTO :S2
									    FROM dual"
						Else
							If N > 0 !! одиночка
								Set TIPD = "
										    SELECT " || IifS(P4=2, "s1", IifS(P4=3, "s1+s2",
										           "s1+s2+s3")) || "
										    INTO :S2
										    FROM nal_it
										    WHERE rnk(+)=:N and gg=:P5 and dd=:DD and rr=:RR"
							Else !! свод
								Set TIPD = "
										    SELECT " || IifS(P4=2, "SUM(s1)", IifS(P4=3,
										           "SUM(s1+s2)", "SUM(s1+s2+s3)")) || "
										    INTO :S2
										    FROM nal_it
										    WHERE gg=:P5 and dd=:DD and rr=:RR"
						! сброс показателей
						If SqlPrepareAndExecute(cCnc.hSql(),
								   "SELECT BARS.NAL.nal_null FROM DUAL")
								and SqlFetchNext(cCnc.hSql(), nFetchRes)
					!
					! ==================================================
					! Начинаем печать в отчет
					! ==================================================
					Call SalReportPrintToFile(hWndForm, 
							  strTmplPath, 
							  strPrintPath ||'/'|| IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt),
							  strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
					If nInd > 4
						! Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
						Call SalMessageBox(' SalReportPrintToFile - ' || 
								  CurrentLangTable.GetAtomTitle('cTErrFunc') || ' ' || SalNumberToStrX(nInd,0), 
								  CurrentLangTable.GetAtomTitle('cTAt'), 0 )
					! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
					Set frm_Out.dfPath = strPrintPath
					Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
					If not FL_FORMAT
						Call zarez12Del(  strPrintPath || '\\' || strFileNameTxt,  frm_Out.tblReps.Kod,  sDeviceDef, bDelOnNull)
					Call SalWaitCursor(FALSE)
		Window Parameters
			String: sdat
			String: sdat2
			Number: para
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			: cCncAux
				Class: cABSConnect
			: cCncAux2
				Class: cABSConnect
			Number: nKto  !! 1-гл НБУ, 2-обл НБУ, 3 -КБ
			Number: nPara
			Number: NN
			Number: KV
			String: ISO
			String: CC_ID
			String: NLS
			String: NAME
			Number: S
			Number: PRO
			Date/Time: DATN
			Date/Time: DATP
			String: NAMV
			Number: S1
			Number: S2
			Number: SS1
			Number: SS2
			String: TIPD
			String: VIDO
			String: maska
			Number: P
			Number: PP1
			Number: N
			Number: N1
			Number: N2
			Number: NN1
			Date/Time: DAT0
			Date/Time: DAT1
			Date/Time: DAT2
			Date/Time: DAT3
			Date/Time: DAT4
			Date/Time: DAT5
			Date/Time: DAT6
			Number: V1
			Number: V2
			Number: V3
			Number: V4
			Number: V5
			Number: V6
			Number: P1
			Number: P2
			Number: P3
			Number: P4
			Number: P5
			Number: P6
			String: DDR[*]
			! ДЛЯ НАЛОГОВОЙ ДЕКЛАРАЦИИ
			String: RR
			String: ss
			String: DD
			String: PP
			Long String: NMS
			String: SDD
			String: sdat3
			!
			String: ISNULL
			String: CTYPE
			String: CNUM_CST
			String: CNUM_YEAR
			String: CNUM_NUM
			String: MVM_FEAT
			!
			String: S_OKPO
			String: S_NAME
			String: S_ADRES
			String: S_TYPE
			String: S_TAXID
			!
			String: R_OKPO
			String: R_NAME
			String: R_ADRES
			String: R_TYPE
			String: R_TAXID
			!
			String: F_OKPO
			String: F_NAME
			String: F_ADRES
			String: F_TYPE
			String: F_TAXID
			!
			String: F_COUNTRY
			String: UAH_NLS
			String: UAH_MFO
			String: CCY_NLS
			String: CCY_MFO
			Number: KURS
			Number: CMODE_CODE
			String: DOC
			!
			Date/Time: CDAT
			Date/Time: NDAT
			Date/Time: MDAT
			Date/Time: ALLOW_DAT
			Date/Time: BEG_DATE
			Date/Time: END_DATE
			!
			Number: nDig
			String: DAT_O
		Message Actions
			On SAM_Create
				Call SalCenterWindow(hWndForm)
				Call SetWindowFont(hWndForm)
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_KRED.cTWndTitle'))
				Call cCnc.Clone(g_cRepCnc, TRUE)
				Call cCncAux.Clone(cCnc, TRUE)
				Call cCncAux2.Clone(cCnc, TRUE)
				! Call SalWaitCursor( TRUE )
				Set nPara = para
				!
				Call SalHideWindow(tbl1)
				Set CC_ID = strDateTo
				If nPara = 31 or nPara = 58 or nPara = 59 or nPara = 60 or nPara=33
					Set strBind = 'V6,NAME,V5,NAMV,V1,V2,V3,S,P1,P2,P3,P4'
					If nPara = 31     ! - - - - - - перешел в каталогизированные  на CKTR
						Set ss =T(
								"SELECT a.CLASS, c.NAME, decode(a.pap,1,-1,1),
								        substr(b.NBS,1,1), substr(b.NBS,1,2),substr(b.NBS,1,3),b.NBS,
								        decode(a.pap,1,-1,1)*sum(b.OST+b.DOS-b.KOS),
								        sum(b.DOS), sum(b.KOS), decode(a.pap,1,-1,1)*sum(b.OST)
								 INTO  :V6,:NAME,:V5,:V1,:V2,:V3,:S,:P1,:P2,:P3,:P4
								 FROM (SELECT nbs NBS, sum(dos) DOS,sum(kos) KOS,sum(ost) OST
								       FROM sal WHERE (ost<>0 or dos+kos>0) AND fdat= :sdat  GROUP BY nbs
								     UNION ALL
								       SELECT a.nbs, sum(decode(v.fdat, :sdat ,v.dos,0)),
								              sum(decode(v.fdat, :sdat ,v.kos,0)), sum(v.ost)
								       FROM accounts_its a, vypiska v
								       WHERE a.nbs>4999 AND v.nls=a.nls AND (a.nls,v.fdat) =
								         (select nls,max(fdat) from vypiska
								          where nls=a.nls and fdat<=  :sdat  group by nls)
								       GROUP BY a.nbs
								       ) b,
								       ps a, cs c
								WHERE b.nbs=a.nbs and a.class=c.class
								GROUP BY a.CLASS,c.NAME,decode(a.pap,1,-1,1),b.NBS
								ORDER BY a.CLASS,c.NAME,decode(a.pap,1,-1,1),b.NBS ")
					Else If nPara = 58 or nPara = 59  or nPara = 60
						If nPara = 58
							Set TIPD=
									"SELECT min(fdat),max(fdat) INTO :DAT1,:DAT2 FROM fdat
									 WHERE to_char(fdat,'MMYYYY')=to_char( :sdat  ,'MMYYYY')"
						Else If nPara = 59
							Set TIPD=
									"SELECT min(fdat),max(fdat) INTO :DAT1,:DAT2 FROM fdat
									 WHERE to_char(fdat,'QYYYY')=to_char( :sdat  ,'QYYYY')"
						Else If nPara = 60
							Set TIPD=
									"SELECT min(fdat),max(fdat) INTO :DAT1,:DAT2 FROM fdat
									 WHERE to_char(fdat,'YYYY')=to_char( :sdat  ,'YYYY')"
						If SqlPrepareAndExecute(cCncAux2.hSql(), T(TIPD))
								and SqlFetchNext(cCncAux2.hSql(), N)
							Set ss =
									"SELECT a.CLASS,c.NAME, decode(a.pap,1,-1,1),
									        substr(b.NBS,1,1), substr(b.NBS,1,2),substr(b.NBS,1,3),b.NBS,
									        sum(b.OST+b.DOS-b.KOS)* decode(a.pap,1,-1,1),
									        sum(b.DOS), sum(b.KOS), sum(b.OST)* decode(a.pap,1,-1,1)
									 INTO  :V6,:NAME,:V5,  :V1,:V2,:V3,:S, :P1,:P2,:P3,:P4
									 FROM (SELECT nbs NBS,sum(fdos(acc,:DAT1,:DAT2)) DOS,
									              sum(fkos(acc,:DAT1,:DAT2)) KOS, sum(ost) OST
									       FROM sal WHERE fdat=:DAT2 
									       GROUP BY nbs
									     UNION ALL
									       SELECT a.nbs,
									              sum(fdos_its(a.nls,:DAT1,:DAT2)),sum(fkos_its(a.nls,:DAT1,:DAT2)), sum(v.ost)
									       FROM accounts_its a, vypiska v
									       WHERE a.nbs>4999 AND v.nls=a.nls AND (a.nls,v.fdat) =
									             (select nls,max(fdat) from vypiska
									              where nls=a.nls and fdat<=:DAT2 group by nls)
									       GROUP BY a.nbs
									       ) b,
									       ps a, cs c
									WHERE b.nbs=a.nbs and a.class=c.class  
									GROUP BY a.CLASS,c.NAME,decode(a.pap,1,-1,1),b.NBS
									HAVING (sum(b.DOS)>0 or sum(b.KOS)>0 or sum(b.OST)>0)
									ORDER BY a.CLASS,c.NAME,decode(a.pap,1,-1,1),b.NBS "
					Else If nPara = 33
						Set strBind='ISO,DAT1,NLS,V1,V2,S1,S2,NAME,N'
						! Set PP=SalStrTrimX(Maska_NLS("счетов"))
						Set PP=SalStrTrimX(Maska_NLS(CurrentLangTable.GetAtomTitle('cTSelectAcc')))
						If PP='-'
							Call SalDestroyWindow( hWndForm )
							Return FALSE
						Set ss =T(
								"SELECT substr(NLS,1,4), DAPP, NLS,
								    decode(Sign(ost),-1,OST/100,0),  decode(Sign(ost),1,OST/100,0),
								    DOS/100, KOS/100, NMS, ISP
								 INTO :ISO,:DAT1,:NLS,:V1,:V2,:S1,:S2,:NAME,:N
								 FROM (SELECT dapp DAPP, nls NLS, ost OST, dos DOS,kos KOS, nms NMS,isp ISP
								       FROM sal  WHERE (ost<>0 or dos+kos>0) AND fdat = :sdat
								      UNION ALL
								       SELECT to_date(null),a.nls,v.ost,
								              decode(v.fdat, :sdat ,v.dos,0),
								              decode(v.fdat, :sdat ,v.kos,0), '', 0
								       FROM accounts_its a, vypiska v
								       WHERE a.nbs>4999 AND v.nls=a.nls AND (a.nls,v.fdat) =
								         (select nls,max(fdat) from vypiska
								          where nls=a.nls and fdat<=  :sdat  group by nls)
								        ) " || IifS(PP !='%', "
								 WHERE trim(NLS) LIKE \'" ||PP|| "\'",'') || "
								 ORDER BY substr(nls,1,4), substr(nls,6,9)")
					Set strInput=strBind
				Else If nPara=20 ! бюджет КБ
					Set strBind='P5,V5,ISO,TIPD,VIDO,P,P1,P2,N,NAME,S1,S2,S'
					Set CC_ID= Subs(sdat,7,4) || Subs(sdat,1,2)
					If SqlPrepareAndExecute(cCnc.hSql(),
							  "SELECT min(fdat),max(fdat)  INTO :DAT1,:DAT2
							   FROM fdat   WHERE to_char(fdat,'YYYYMM')=:CC_ID" )
							and SqlFetchNext(cCnc.hSql(), nFetchRes)
						Set ss=
								"SELECT substr(k.kekb,1,1)*100000,
								        substr(k.kekb,1,2)*10000,
								        substr(k.kekb,1,4)*100, k.kekb, k.name,
								        count(s.acc),
								        nvl(ABS(sum( fkosn(s.kv, s.acc, s.fdat, s.fdat )-
								                                fdosn(s.kv, s.acc, s.fdat, s.fdat )
								                              )        ),0)
								 INTO :P,:P1,:P2,:N,:NAME , :S,:S2
								 FROM kekb k,sal s
								 WHERE substr(k.kekb,5,2) <>'00' AND
								       s.nlsalt=k.kekb AND to_char(s.fdat,'YYYYMM')=:CC_ID
								GROUP BY k.kekb,k.name"
						Set PP=Subs(CC_ID,5,2)
						If SqlPrepareAndExecute(cCnc.hSql(),
								"SELECT name_rus INTO :SDD FROM META_MONTH where n="||PP )
							Call SqlFetchNext(cCnc.hSql(), nFetchRes)
							Set SDD=SDD || ' ' || Subs(CC_ID,1,4) || ' р.'
				Else If nPara=23 ! Там декл
					Set strBind=
							'CDAT,ISNULL,NDAT,MDAT,CTYPE,CNUM_CST,CNUM_YEAR,CNUM_NUM,MVM_FEAT,'||
							'S_OKPO,S_NAME,S_ADRES,S_TYPE,S_TAXID,R_OKPO,R_NAME,R_ADRES,R_TYPE,'||
							'R_TAXID,F_OKPO,F_NAME,F_ADRES,F_TYPE,F_TAXID,F_COUNTRY,UAH_NLS,'||
							'UAH_MFO,CCY_NLS,CCY_MFO,KV,KURS,S,ALLOW_DAT,CMODE_CODE,DOC,'||
							'BEG_DATE,END_DATE'
					Set strInput=strBind
					Set ss=T("select  DOC,S,
							CDAT, ISNULL, NDAT, MDAT, CTYPE, CNUM_CST,
							CNUM_YEAR, CNUM_NUM, MVM_FEAT,
							S_OKPO,S_NAME,S_ADRES,S_TYPE,S_TAXID,
							R_OKPO,R_NAME,R_ADRES,R_TYPE,R_TAXID,
							F_OKPO,F_NAME,F_ADRES,F_TYPE,F_TAXID,
							F_COUNTRY,UAH_NLS,UAH_MFO,CCY_NLS,CCY_MFO,
							KV, KURS,ALLOW_DAT,CMODE_CODE,
							beg_DATE,end_DATE
							into :DOC,:S,
							:CDAT,:ISNULL,:NDAT,:MDAT,:CTYPE,:CNUM_CST,
							:CNUM_YEAR,:CNUM_NUM,:MVM_FEAT,
							:S_OKPO,:S_NAME,:S_ADRES,:S_TYPE,:S_TAXID,
							:R_OKPO,:R_NAME,:R_ADRES,:R_TYPE,:R_TAXID,
							:F_OKPO,:F_NAME,:F_ADRES,:F_TYPE,:F_TAXID,
							:F_COUNTRY,:UAH_NLS,:UAH_MFO,:CCY_NLS,:CCY_MFO,
							:KV, :KURS, :ALLOW_DAT, :CMODE_CODE,
							:BEG_DATE,:END_DATE
							from vmd
							WHERE dat >= :sdat AND dat-0.9999 <= :sdat2 order by F_OKPO, CDAT" )
				Else If nPara=0
					Set DAT_O=Subs(sdat,4,2) ||'.'|| Subs(sdat,1,2)||'.'||Subs(sdat,7,4)
					Set CC_ID= Subs(sdat,7,4) || Subs(sdat,1,2)||Subs(sdat,4,2)
					Call SqlPrepareAndExecute(cCncAux.hSql(), T("SELECT count(*) INTO :S FROM customer
							WHERE custtype in (2,3) and (date_off is null or to_char(date_off,'YYYYMMDD') > :CC_ID  ) "))
					Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
					Set strBind='NAME,S,S1,S2,DAT_O'
					Set strInput=strBind
					If SalStrTrimX(SalStrUpperX( GetDBMS()  )) = 'ORACLE'
						Set ss="
								SELECT oe.oe, substr(oe.name, 1,40),
								       sum(iif_n(c.custtype,2,0,1,0)),sum(iif_n(c.custtype,3,0,1,0))
								INTO :NN,:NAME,:S1,:S2
								FROM customer c, oe
								WHERE c.custtype in (2,3) AND
								      (date_off is null or to_char(date_off,'YYYYMMDD') > :CC_ID )    AND
								      oe.oe (+) = trunc(c.oe/1000)*1000
								GROUP BY oe.oe, substr(oe.name,1,40)  
								ORDER BY 1 "
					Else
						Set ss="
								SELECT oe.oe, oe.name[1,40],
								       sum(iif_n(c.custtype,2,0,1,0)),sum(iif_n(c.custtype,3,0,1,0))
								INTO :NN,:NAME,:S1,:S2
								FROM customer c, OUTER corps co, OUTER oe oe
								WHERE c.custtype in (2,3) AND
								      (date_off is null or date_off > to_date( :sdat )  )  AND
								      c.rnk = co.rnk (+) AND
								      oe.oe (+) = trunc(co.oe/1000)*1000
								GROUP BY oe.oe, oe.name[1,40]
								ORDER BY 1 "
				Else If nPara=-1
					! Set maska=Maska_NLS("счетов")
					Set maska=Maska_NLS(CurrentLangTable.GetAtomTitle('cTSelectAcc'))
					If maska = '-'
						Call SalDestroyWindow(hWndForm)
						Return FALSE
					Set strBind='NLS,SK,VDAT,S1,S2,NAZN,NLS2'
					Set strInput='NLS,KV,DATN,S1,S2,NAME,ISO'
					Set ss=T("SELECT nlsa,sk,vdat,s,nazn[1,40],nlsb
							INTO :NLS,:SK,:VDAT,:S,:NAZN,:NLS2
							INTO :NLS,:KV,:DATN,:S,:NAME,:ISO
							 FROM oper WHERE sk>0 AND sos=5 AND vdat >= :sdat  AND vdat <= :sdat2  AND
							        trim( nlsa) LIKE '" || maska || "'  ORDER BY 1,2,3 " )
					Set ss=T("SELECT nlsa,sk,vdat,s,nazn[1,40],nlsb
							INTO :NLS,:KV,:DATN,:S,:NAME,:ISO
							FROM oper WHERE sk>0 AND sos=5 AND vdat >= :sdat  AND vdat <= :sdat2  AND
							        trim( nlsa) LIKE '" || maska || "'  ORDER BY 1,2,3 " )
					! Set ss=T("SELECT nlsa,sk,vdat,s,nazn[1,40],nlsb
							INTO :NLS,:SK,:VDAT,:S,:NAZN,:NLS2
							 FROM oper WHERE sk>0 AND sos=5 AND vdat >= :sdat  AND vdat <= :sdat2  AND
							        trim( nlsa) LIKE '" || maska || "'  ORDER BY 1,2,3 " )
				! Для налоговой декларации
				Else If (nPara >85 and nPara <100 ) 
					Set strBind='DD,RR,PP,NMS,S2,S1,SS1'
					If nPara =99 
						Set SDD='@ '
					Else
						Set SDD=Subs(SHAP,5,2)
					!
					Set ss=
							"SELECT dd,rr, pp,nms||NVL(nms1,''), formula, nls, formul1
							 INTO :DD,:RR,:PP,:NMS,              :maska, :NLS,:VIDO
							 FROM  nal_dec
							 WHERE dd='"||SalStrTrimX(SDD)||"' ORDER BY ord "
					!
					Set N =GetIdRnk()
					Set N1=Val(GetOurRnk())
					If SqlPrepareAndExecute(cCnc.hSql(), "SELECT val INTO :ISO FROM params WHERE par='APP'")
						Call SqlFetchNext(cCnc.hSql(), nFetchRes)
					!
					Set P4= Val(SalStrLeftX(sdat,2)) /3 !! Тек.квартал
					Set P5=Val(SalStrRightX(sdat,4))    !! Тек год
					If ISO='NU'  !!  НБУ
						Set P4= Val(SalStrLeftX(sdat,2)) /3 !! Тек.квартал
						If N1 = N  !!  в центре
							Set nKto=1
							Call SalTblPopulate(tbl1, cCnc.hSql(),
									 "SELECT rnk,nmk FROM customer
									 WHERE rnk in (SELECT rnk FROM cust_acc) AND rnk<>:N
									 ORDER BY 1", TBL_FillAll)
							Call SalWaitCursor( FALSE)
							Call SalShowWindow(tbl1)
						Else !!  в области
							Set nKto=2
							Call PRINT()
							Call SalDestroyWindow(hWndForm)
					If ISO='GB'  !!  Гл.банк с сетью филиалов
						Set P4= Val(SalStrLeftX(sdat,2)) /3 !! Тек.квартал
						! Set nKto =1
						Set nKto =2
						Call SalTblPopulate(tbl1, cCnc.hSql(),
								 "SELECT rnk,nmk FROM customer WHERE rnk in (SELECT rnk FROM nu_rnk ) ORDER BY 1", 
								 TBL_FillAll)
						Call SalWaitCursor( FALSE)
						Call SalShowWindow(tbl1)
					Else !! в КБ
						Set nKto=3
						Set P4= SalNumberRound( (Val(Subs(sdat,1,2))+1) /3 )
						Call PRINT()
						Call SalDestroyWindow(hWndForm)
					! было 
					! If ISO='NU'  !!  НБУ
						                                                               Set P4= Val(SalStrLeftX(sdat,2)) /3 !! Тек.квартал
						                                                               If N1 = N  !!  в центре
							                                                               Set nKto=1
							                                                               Call SalTblPopulate(tbl1,hSql(),
									 "SELECT rnk,nmk FROM customer
									 WHERE rnk in (SELECT rnk FROM cust_acc) AND rnk<>:N
									 ORDER BY 1", TBL_FillAll)
							                                                               Call SalWaitCursor( FALSE)
							                                                               Call SalShowWindow(tbl1)
						                                                               Else !!  в области
							                                                               Set nKto=2
							                                                               Call PRINT()
							                                                               Call SalDestroyWindow(hWndForm)
					! Else !! в КБ
						                                                               Set nKto=3
						                                                               Set P4= SalNumberRound( (Val(Subs(sdat,1,2))+1) /3 )
						                                                               Call PRINT()
						                                                               Call SalDestroyWindow(hWndForm)
					!
				Else
					Call PRINT()
					Call SalDestroyWindow(hWndForm)
				!
				Set strInput=strBind
				!
			On SAM_ReportStart
				! Call Debug('Вибрано дату '||CC_ID)
				Call SqlPrepare(cCnc.hSql(), ss)
			On SAM_ReportFetchInit
				Return SqlExecute(cCnc.hSql())
			On SAM_ReportFetchNext
				If SqlFetchNext(cCnc.hSql(), nFetchRes)
					If nPara =-1
						If KV<40
							Set S1=S/100
							Set S2=NUMBER_Null
						Else
							Set S1=NUMBER_Null
							Set S2=S/100
						Return TRUE
					Else If nPara=0
						If NN=NUMBER_Null
							Set NAME='Не визначено'
					Else If nPara >85 and nPara <100
						If NLS =STRING_Null and maska = STRING_Null !! нет показателя
							Set S1=0
							Set S2=0
							Set SS1=0
						Else
							! S1 - Сальдо или формула на дату (нарастающий итог)
							If maska=STRING_Null !! первичный
								Set NAME="SELECT BARS.NAL.nal1(:N,:DD,:RR, :sdat ) INTO :S1 FROM DUAL"
							Else !! сложный
								Set NAME="SELECT BARS.NAL."|| maska || "(:N, :sdat ) INTO :S1 FROM DUAL"
							If SqlPrepareAndExecute( cCncAux.hSql(),T(NAME))
									and SqlFetchNext(cCncAux.hSql(), nFetchRes)
							Else
								Set S1=0
							Set SS1=S1
							!
							! S2 - сумма пред периодов
							If SqlPrepareAndExecute( cCncAux.hSql(),TIPD)
									and SqlFetchNext(cCncAux.hSql(), nFetchRes)
									and S2 !=NUMBER_Null
								If VIDO != STRING_Null
									Set V5 = S1 - S2 !! текущий квартал
									If SqlPrepareAndExecute( cCncAux.hSql(),
											"SELECT BARS.NAL." || VIDO || "(:N, :P4, :P5, :V5)
											 INTO :SS1 FROM DUAL" )
											and SqlFetchNext(cCncAux.hSql(), nFetchRes)
									Else
										Set SS1=0
							Else
								Set S2=0
					Else If nPara =23 ! Там декл
						Set S_NAME=StrDosToWinX( S_NAME)
						Set R_NAME=StrDosToWinX( R_NAME)
						Set F_NAME=StrDosToWinX( F_NAME)
						Set CTYPE=StrDosToWinX( CTYPE)
						Set S_ADRES=StrDosToWinX( S_ADRES)
						Set R_ADRES=StrDosToWinX( R_ADRES)
						Set F_ADRES=StrDosToWinX( F_ADRES)
						Set DOC=StrDosToWinX( DOC)
					Else If nPara =20 ! бюджет КБ
						If SqlPrepareAndExecute( cCncAux.hSql(),
								  "SELECT k0.name, k1.name,k2.name
								   INTO :ISO,:TIPD,:VIDO
								   FROM  kekb k0, kekb k1, kekb k2
								   WHERE k0.kekb=:P AND k1.kekb=:P1 AND k2.kekb=:P2")
								and SqlFetchNext(cCncAux.hSql(), nFetchRes)
						Else
						If SqlPrepareAndExecute( cCncAux.hSql(),
								  "SELECT s INTO :S1 FROM kekb_plan WHERE kekb=:N AND yyyymm=:CC_ID")
								and SqlFetchNext(cCncAux.hSql(), nFetchRes)
						Else
							Set S1=0
						Set V5=-1
						Set P5=0
						If P<300000
							Set P5=1
							If P<200000
								Set V5=1
					Else If nPara =33
						! проверка на 3 знака
						Call SqlPrepareAndExecute( cCncAux.hSql(), "
								SELECT DISTINCT t.dig INTO :nDig
								FROM tabval t, sal s
								WHERE t.kv=s.kv and s.nls=:NLS " )
						If not SqlFetchNext( cCncAux.hSql(), nFetchRes )
							Return FALSE
						Set V1 = V1*SalNumberPower( 10,2-nDig )
						Set V2 = V2*SalNumberPower( 10,2-nDig )
						Set S1 = S1*SalNumberPower( 10,2-nDig )
						Set S2 = S2*SalNumberPower( 10,2-nDig )
						!
					Return TRUE
				Return FALSE
			On SAM_ReportNotify
				If nPara <0
					If lParam=RPT_BeforeReportHeader
						Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'AMFO',AMFO)
						Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'AQH',AQH)
						Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'SHAP',SHAP||' з '||strDateFrom||' по '||strDateTo )
					If lParam=RPT_BeforeBreakHeader1
						If nPara =-1
							Set ss="SELECT nms INTO :NAMV FROM accounts WHERE nls=:NLS AND kv="||Str(GetBaseVal())
							Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'SHAP1',
									'СКП    Дата   Рах.каси          Надходження         Видача    Призначення платежу')
						Else If nPara =-2
							Set ss="SELECT NAME INTO :NAMV FROM SK WHERE SK=:KV"
							Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'SHAP1',
									'СК Рах.каси       Рах.клієнта      Дата          Надходження          Видача')
						Else If nPara =-3
							Set ss="SELECT nms INTO :NAMV FROM accounts WHERE nls=:ISO AND kv="||Str(GetBaseVal())
							Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'SHAP1',
									'СК   Рах.клієнта       Дата            Надходження             Видача')
						Call SqlPrepareAndExecute( cCncAux.hSql(),T(ss))
						Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
						Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'NMS',NAMV)
				Else
					If lParam=RPT_BeforeReportHeader
						Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam),'NREP', nPara )
						Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'SDAT',strDateFrom)
						Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'strBankName',GetBankName())
						Call SalReportSetDateTimeVar(SalNumberToWindowHandle(wParam),'DAT1',DAT1)
						Call SalReportSetDateTimeVar(SalNumberToWindowHandle(wParam),'DAT2',DAT2)
						If nPara =20
							Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'sd1',SDD)
							Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'strBankName',GetBankName())
						Else If nPara >85 and nPara <100
							If nKto=2 and
									SqlPrepareAndExecute( cCncAux.hSql(),
									"SELECT c.nmk,c.okpo,c.adr,p.telr||', '||p.telb,p.ruk,p.buh
									 INTO :DDR[1], :DDR[2], :DDR[3], :DDR[4], :DDR[5], :DDR[6]
									 FROM customer c, " ||IifS(ISO='GB', "custbank","corps")|| " p
									 WHERE c.rnk=p.rnk (+) AND c.rnk=:N " )
								Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
							!
							Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam),'KV',P4)
							Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam),'GOD',P5)
							Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'NBANK',
									IifS(nKto=2,DDR[1],GetBankName()))
							Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'OKPO',
									IifS(nKto=2,DDR[2],Str(GetBankOkpo())))
							Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'ADR',  DDR[3])
							Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'TEL',  DDR[4])
							Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'SHAP',SHAP )
					If lParam=RPT_BeforeBreakHeader1 and nPara =14
						Call SqlPrepareAndExecute( cCncAux.hSql(), T("SELECT lcv,name INTO :ISO,:NAMV FROM tabval where kv=:KV"))
						Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
						Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'ISO',ISO)
						Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'NAMV',NAMV)
					If lParam=RPT_BeforeBreakFooter1 and nPara =9
						Set ss="
								SELECT  sum(gl.p_icurval(a.kv,a.s,  :sdat  ))/100,
								       -sum(fostn(a.accs,  :sdat ,  :sdat  ))/100
								INTO :S1,:S2    FROM cc_accp z, cc_add a
								WHERE z.nd=a.nd  AND  a.adds=0  AND z.mpawn=:NN "
						Call SqlPrepareAndExecute( cCncAux.hSql(), T(ss))
						Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
						Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam),'S1',S1)
						Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam),'S2',S2)
				If lParam=RPT_BeforeReportFooter
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'FIO',GetUserRealName())
					If nPara =9
						Call SqlPrepareAndExecute( cCncAux.hSql(),T("
								SELECT sum(gl.p_icurval(a.kv,a.s,  :sdat  ))/100,
								      -sum(fostn(a.accs,  :sdat ,  :sdat  ))/100
								INTO :S1,:S2 FROM cc_accp z,cc_add a WHERE z.nd=a.nd AND a.adds=0"))
						Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
						Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam),'S1',S1)
						Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam),'S2',S2)
					Else If nPara >85 and nPara <100
						Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'RUK',
								IifS(nKto=2,DDR[5],GetGlobalOption('BOSS')))
						Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'GLB',
								IifS(nKto=2,DDR[6],GetGlobalOption('ACCMAN')))
			On SAM_ReportFinish
				Call SalSendMsg( frm_Out.tblReps, UM_ReportFinish, 0, 0)
			On SAM_Destroy
				Call SalWaitCursor( FALSE )
				If cCncAux.IsConnected()
					Call cCncAux.Disconnect()
				If cCncAux2.IsConnected()
					Call cCncAux2.Disconnect()
				If cCnc.IsConnected()
					Call cCnc.Disconnect()
	Form Window: frm_MANY
		Class:
		Property Template:
		Class DLL Name:
		Title: Лицевые счета
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.838"
				Top:    0.688"
				Width:  6.767"
				Width Editable? Yes
				Height: 3.988"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Денежное обращение
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
		Functions
		Window Parameters
			String: sdat
			String: sdat2
			Number: para
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			: cCncAux2
				Class: cABSConnect
			String: maska
			String: maska1
			String: NMS
			String: NLS
			String: NLS2
			String: NLS_KAS
			Number: SK
			String: TT
			Date/Time: VDAT
			Number: S
			Number: BASEVAL
			Number: S1
			Number: S2
			Number: S02_32
			Number: S40_61
			Number: KOL_
			Number: REF
			Number: DOS
			Number: KOS
			Number: OSTI
			Number: OSTV
			String: NAZN
			String: ss1
			String: strRBSName
			String: ss2
			String: ND
		Message Actions
			On SAM_Create
				Call SetWindowFont(hWndForm)
				Call cCnc.Clone(g_cRepCnc, TRUE)
				Call cCncAux2.Clone(cCnc, TRUE)
				Set BASEVAL = GetBaseVal()
				! Set maska = Maska_NLS(  IifS( para=2, "СКП" ,  "счетов" ) )
				Set maska = Maska_NLS(  IifS( para=2, 
						  CurrentLangTable.GetAtomTitle('cTSelectSKP'),  
						  CurrentLangTable.GetAtomTitle('cTSelectAcc')) )
				! If ( para=2 or para=1) 
				! Else
					                                                               Set maska = Maska_NLS(  "счетов"  )
				If SalStrTrimX(SalStrUpperX(GetDBMS()))='ORACLE'
					Set strRBSName = GetGlobalOption( 'RNBURBCK' )
					Set ID = GetUserId()
					If strRBSName
						! ! Make end of transaction and start new
						Call SqlCommit(cCnc.hSql())
						! ! to avoid error with set transaction...
						Call SqlPrepareAndExecute(cCnc.hSql(), 'SET TRANSACTION USE ROLLBACK SEGMENT ' || SalStrUpperX( strRBSName ) )
					If not SqlPLSQLCommand(cCnc.hSql(), "P_KJ(ID, sdat,sdat2)")
						Return FALSE
					! If not SqlPLSQLCommand(hSql(), "P_KJ(ID, '11-09-2001','11-09-2001')")   --- this works 
						                                                               Return FALSE
				Set strBind = 'NLS,SK,VDAT,S1,S2,S,NAZN,NLS2,REF,TT'
				Set strInput=strBind
				If para = 1 !! 84
					If maska = '-'
						Call SalDestroyWindow(hWndForm)
					! Set maska1 = Maska_NLS("СКП")
					Set maska1 = Maska_NLS(CurrentLangTable.GetAtomTitle('cTSelectSKP'))
					If maska1 = '-'
						Call SalDestroyWindow(hWndForm)
					Set ss1 = T("
							    SELECT nls, sk, fdat ,s, kas,ref, tt
							    INTO :NLS,:SK,:VDAT,:S,:NLS2,:REF, :TT
							    FROM tmp_kj
							    WHERE id=:ID and nls LIKE '" || maska || "'
							             and sk LIKE '" || maska1 || "'
							   ORDER BY 1,2,3")
				If para = 2
					! If maska = '-'
						                                                               Call SalDestroyWindow(hWndForm)
					Set ss1 = T("
							    SELECT kas,sk,nls, fdat ,s,ref
							    INTO :NLS2,:SK,:NLS,:VDAT,:S,:REF
							    FROM tmp_kj
							    WHERE id=:ID and sk LIKE '" || maska || "'
							    ORDER BY 2,1,3,4,5")
				If para = 3 !! 7
					If maska = '-'
						Call SalDestroyWindow(hWndForm)
					Set ss1 = T("
							    SELECT kas, sk, nls,fdat, s , ref
							    INTO :NLS2,:SK,:NLS,:VDAT,:S,:REF
							    FROM tmp_kj
							    WHERE id=:ID and kas LIKE '" || maska || "'
							    ORDER BY 1,2,3,4,5")
				If para = 4 !! 131
					Set strBind =
							'NLS,SK,VDAT,S1,S2,DOS,KOS,OSTV,OSTI,S02_32,S40_61'
					Set ss1 = T("
							    SELECT s.dos,s.kos,s.ost,s.ost+s.dos-s.kos,
							          t.kas,t.sk, t.fdat, Sum(t.s)
							    INTO :DOS,:KOS,:OSTI,:OSTV,:NLS,:SK,:VDAT,:S
							    FROM tmp_kj t, sal s
							    WHERE t.id=:ID and t.fdat=s.fdat and t.acc=s.acc AND
							          s.nls LIKE '" || maska || "'
							    GROUP BY s.dos,s.kos,s.ost,s.ost+s.dos-s.kos, t.kas,t.sk,t.fdat
							    ORDER BY t.kas,t.sk")
				If para = 5 !! 141   (OAB 17.12.2001)
					Set strBind =
							'NLS,SK,VDAT,S1,S2,DOS,KOS,OSTV,OSTI,S02_32,S40_61'
					Set ss1 = T("
							    SELECT substr(t.kas,1,4), t.sk, t.fdat, Sum(t.s),
							           Sum(s.dos),Sum(s.kos),Sum(s.ost),Sum(s.ost+s.dos-s.kos)
							    INTO :NLS,:SK,:VDAT,:S,:DOS,:KOS,:OSTI,:OSTV
							    FROM tmp_kj t, sal s
							    WHERE t.id=:ID and t.fdat=s.fdat and t.acc=s.acc AND
							          substr(s.nls,1,4) LIKE '" || maska || "'
							    GROUP BY substr(t.kas,1,4),t.sk,t.fdat
							    ORDER BY substr(t.kas,1,4) ,t.sk")
				If para=10
					Set strBind='NLS2,NMS,NLS,S,VDAT,ND,SK'
					Set ss1 = T("
							SELECT t.kas,  t.nls,  c.nmk,  t.fdat,   t.SK,  t.s/100, t.nd
							 FROM customer c, cust_acc cu, tmp_kj t
							 INTO :NLS2, :NLS, :NMS, :VDAT, :SK,  :S,  :ND
							WHERE C.RNK=Cu.RNK and Cu.ACC=t.ACC and
							       t.fdat >=  :sdat   and t.fdat <=  :sdat2   AND
							          t.nls LIKE '" || maska || "'
							      ORDER BY t.kas,  t.nls,   t.fdat,   t.nd,  t.sk")
				If para = 11 !! 134
					If maska = '-'
						Call SalDestroyWindow(hWndForm)
					Set ss1 = T("
							    SELECT p.nls,decode(p.tt,o.tt,o.sk,t.sk),p.fdat,p.s,
							           o.nlsb,p.ref, p.tt
							    INTO :NLS,:SK,:VDAT,:S,:NLS2,:REF,:TT
							    FROM oper o, opl p, tts t
							    WHERE o.ref=p.ref and o.sk>0 and p.sos=5 and
							          p.fdat>= :sdat  and p.fdat<= :sdat2  and
							          p.nls<>o.nlsb and p.tt=t.tt and p.kv=980 and
							          p.nls LIKE '" || maska || "'
							    ORDER BY 1,2,3")
				! ==================================================
				! Начинаем печать в отчет
				! ==================================================
				Set strInput = strBind
				Call SalReportPrintToFile(hWndForm, 
						                                             strTmplPath, 
						                                             strPrintPath ||'/'|| IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt),
						                                             strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
				Call SalWaitCursor( FALSE )
				If nInd > 4 
					! Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
					Call SalMessageBox(' SalReportPrintToFile - ' || 
							  CurrentLangTable.GetAtomTitle('cTErrFunc') || ' '|| SalNumberToStrX(nInd,0) , 
							  CurrentLangTable.GetAtomTitle('cTAt'), 0 )
				! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
				Set frm_Out.dfPath = strPrintPath
				Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
				Call SalDestroyWindow(hWndForm)
			On SAM_ReportStart
				Call SqlPrepare(cCnc.hSql(), ss1)
				Set NLS_KAS=''
			On SAM_ReportFetchInit
				Return SqlExecute(cCnc.hSql())
			On SAM_ReportFetchNext
				If SqlFetchNext(cCnc.hSql(), nFetchRes)
					If NLS_KAS!=NLS
						Set S02_32=0
						Set S40_61=0
						Set NLS_KAS=NLS
					If SK<40
						Set S1=S/100
						Set S2=NUMBER_Null
						Set S40_61=NUMBER_Null
						If SK<33
							Set S02_32=S02_32+S1
							Set NLS_KAS=NLS
							Set KOL_=NUMBER_Null
						If SK>=32
							Set KOL_=KOL_+1
						If SK>32 AND KOL_>=1
							Set S02_32=NUMBER_Null
					Else
						Set S1=NUMBER_Null
						Set S2=S/100
						If (S40_61>0) OR (NLS != NLS_KAS) OR KOL_>=1
							Set S02_32=NUMBER_Null
						If SK>61 AND KOL_>=1
							Set S40_61=NUMBER_Null
						If SK>39 and SK<62
							Set S40_61=S40_61+S2
							Set NLS_KAS=NLS
							Set KOL_=NUMBER_Null
						If SK>=61
							Set KOL_=KOL_+1
					Return TRUE
				Else
					Return FALSE
			On SAM_ReportNotify
				If S02_32>0 AND SK>39
					Set S02_32=NUMBER_Null
					Set S40_61=NUMBER_Null
				If lParam=RPT_BeforeReportHeader
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'AMFO',AMFO)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'AQH',AQH)
					If para = 4 or para = 5 !! 131,141
						Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'SHAP',SHAP||' за '||strDateFrom )
					Else
						Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'SHAP',SHAP||' з '||strDateFrom||' по '||strDateTo )
				If lParam=RPT_BeforeBreakHeader1
					If para=1
						Set ss2="SELECT nms INTO :NMS FROM accounts WHERE nls=:NLS AND kv=:BASEVAL"
					If para=2
						Set ss2="SELECT NAME INTO :NMS FROM SK WHERE SK=:SK"
					If para=11
						Set ss2="SELECT  nms INTO :NMS FROM accounts  WHERE nls=:NLS AND kv=:BASEVAL"
					If para=3
						Set ss2="SELECT nms INTO :NMS FROM accounts WHERE nls=:NLS2 AND kv=:BASEVAL"
					If para<4 or para=11
						Call SqlPrepareAndExecute(cCncAux2.hSql(),T(ss2))
						Call SqlFetchNext(cCncAux2.hSql(), nFetchRes)
						Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'NMS',NMS)
			On SAM_ReportFinish
				Call SalSendMsg( frm_Out.tblReps, UM_ReportFinish, 0, 0)
			On SAM_Destroy
				If cCnc.IsConnected()
					Call cCnc.Disconnect()
				If cCncAux2.IsConnected()
					Call cCncAux2.Disconnect()
				Call SalWaitCursor( FALSE )
	Form Window: frm_Month     !! Сумма накопленых оборотов за месяц
		Class:
		Property Template:
		Class DLL Name:
		Title: Баланс банка
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.838"
				Top:    0.688"
				Width:  7.125"
				Width Editable? Yes
				Height: 3.563"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Сумма накопленых оборотов за месяц
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
		Functions
			Function: GetExecList
				Description: Получение списка исполнителей в виде условия к SQL SELECT
				Returns
					Number:
				Parameters
				Static Variables
				Local variables
				Actions
					Return SalModalDialog( dlg_MonthAdd, hWndMDI )
		Window Parameters
			String: sdat
			String: sdat2
			Number: para
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			: cCncAux
				Class: cABSConnect
			Number: KV
			Number: NBS
			Number: DOS
			Number: KOS
			Number: OSTVD
			Number: OSTVK
			Number: OSTID
			Number: OSTIK
			String: NMS
			String: maska
			!
			Boolean: fFetch
			! !
			String: sEqSimble
			!
			Number: nDig
			String: sExecList
		Message Actions
			On SAM_Create
				Call SetWindowFont(hWndForm)
				Call cCnc.Clone(g_cRepCnc, TRUE)
				Call cCncAux.Clone(cCnc, TRUE)
				Set maska='-'
				! Set maska=Maska_NLS("счетов")
				Set maska=Maska_NLS(CurrentLangTable.GetAtomTitle('cTSelectAcc'))
				If maska='-'
					Call SalDestroyWindow(hWndForm)
					Call WaitCursorOff()
				Call WaitCursorOn()
				Set strInput='KV,NBS,OSTVD,OSTVK,DOS,KOS,OSTID,OSTIK,NMS'
				Set strBind=strInput
				! Значение para:
						0(>2) - лиц. счет все счета
						1 - бал. счет все счета
						3 - лиц. счет нац. валюта
						4 - лиц. счет ин. валюта
						5 - лиц. счет нац. валюта по исп.
						6 - лиц. счет ин. валюта по исп.
				! Символ сравнения
				Set sEqSimble=''
				! Доп. условие SQL SELECT для выбора исполнителей
				Set sExecList=''
				If para>2
					Select Case para
						Case 3
							Set sEqSimble='='
							Set para=1
							Break
						Case 4
							Set sEqSimble='<>'
							Set para=1
							Break
						Case 5
							Set sEqSimble='='
							Set para=1
							If GetExecList() !=99
								Call SalDestroyWindow(hWndForm)
								Call WaitCursorOff()
							Break
						Case 6
							Set sEqSimble='<>'
							Set para=1
							If GetExecList() !=99
								Call SalDestroyWindow(hWndForm)
								Call WaitCursorOff()
							Break
				! Call SalReportPrintToFile(hWndForm, strDir, GetPrnDir() || '/'
						     || IifS(FL_FORMAT, strFileName1, strFileName), strBind,
						     strInput, 1, RPT_PrintAll, 1, 1, FL_FORMAT, nInd)
				! ==================================================
				! Начинаем печать в отчет
				! ==================================================
				Call SalReportPrintToFile(hWndForm, 
						                                              strTmplPath, 
						                                              strPrintPath ||'/'|| IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt),
						                                              strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
				If (nInd > 4 )
					! Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
					Call SalMessageBox(' SalReportPrintToFile - ' || 
							  CurrentLangTable.GetAtomTitle('cTErrFunc') || ' '|| SalNumberToStrX(nInd,0) , 
							  CurrentLangTable.GetAtomTitle('cTAt'), 0 )
				! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
				Set frm_Out.dfPath = strPrintPath
				Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
				Call SalDestroyWindow(hWndForm)
				Call WaitCursorOff()
			On SAM_ReportStart
				If sEqSimble
					Call SqlPrepare(cCnc.hSql(), T(
							"SELECT NLS,kv,
							  NVL(fost(acc, :sdat )+
							      fdos(acc, :sdat , :sdat )-
							      fkos(acc, :sdat , :sdat ), 0),
							  NVL(fost(acc, :sdat2 ),0),
							  NVL(fdos(acc, :sdat , :sdat2 ),0),
							  NVL(fkos(acc, :sdat , :sdat2 ),0),
							  nms
							 INTO :NBS,:KV,:OSTVD,:OSTID,:DOS,:KOS,:NMS
							 FROM saldo
							WHERE (dazs IS NULL or dazs>= :sdat  ) AND trim(nls) LIKE '"||maska||"' AND
							  kv " || sEqSimble || SalNumberToStrX( GetBaseVal(), 0 ) ||
							  sExecList || "
							ORDER BY kv, SUBSTR(nls,1,4),SUBSTR(nls,6,9)"))
				Else
					Call SqlPrepare(cCnc.hSql(), T(
							"SELECT "||IifS(para=1,"nbs+0","NLS+0")||",kv,
							  NVL(fost(acc, :sdat )+
							      fdos(acc, :sdat , :sdat )-
							      fkos(acc, :sdat , :sdat ), 0),
							  NVL(fost(acc, :sdat2 ),0),
							  NVL(fdos(acc, :sdat , :sdat2 ),0),
							  NVL(fkos(acc, :sdat , :sdat2 ),0),
							  nms
							 INTO :NBS,:KV,:OSTVD,:OSTID,:DOS,:KOS,:NMS
							 FROM saldo
							WHERE (dazs IS NULL or dazs>= :sdat  ) AND trim(nls) LIKE '"||maska||"'
							 " ||
							sExecList || "
							ORDER BY kv,SUBSTR(nls,1,4),SUBSTR(nls,6,9)"))
			On SAM_ReportFetchInit
				Return SqlExecute(cCnc.hSql())
			On SAM_ReportFetchNext
				Loop
					If SqlFetchNext(cCnc.hSql(), nFetchRes)
						! проверка на 3 знака
						Call SqlPrepareAndExecute(cCncAux.hSql(), "
								SELECT dig INTO :nDig
								FROM tabval
								WHERE kv = :KV")
						If not SqlFetchNext(cCncAux.hSql(), nFetchRes)
							Return FALSE
						Set OSTVD = OSTVD*SalNumberPower( 10,2-nDig )
						Set OSTID = OSTID*SalNumberPower( 10,2-nDig )
						Set DOS   = DOS*SalNumberPower( 10,2-nDig )
						Set KOS   = KOS*SalNumberPower( 10,2-nDig )
						!
						If OSTVD !=0 or OSTID !=0 or DOS !=0 or KOS !=0
							If OSTVD <0
								Set OSTVK=0
								Set OSTVD=-OSTVD
							Else
								Set OSTVK=OSTVD
								Set OSTVD=0
							If OSTID <0
								Set OSTIK=0
								Set OSTID=-OSTID
							Else
								Set OSTIK=OSTID
								Set OSTID=0
							Return TRUE
					Else
						Return FALSE
			On SAM_ReportNotify
				If lParam=RPT_BeforeReportHeader
					! Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'B_date', sd1)
					! Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'E_date', sd2)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'B_date', strDateFrom)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'E_date', strDateTo)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'SHAP1',SHAP)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'aMFO', AMFO)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'aQH', AQH)
			On SAM_ReportFinish
				Call SalSendMsg( frm_Out.tblReps, UM_ReportFinish, 0, 0)
			On SAM_Destroy
				If cCnc.IsConnected()
					Call cCnc.Disconnect()
				If cCncAux.IsConnected()
					Call cCncAux.Disconnect()
				Call SalWaitCursor(FALSE)
	Form Window: frm_NLS       !! Информация по ЛС
		Class:
		Property Template:
		Class DLL Name:
		Title: Лицевые счета
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.838"
				Top:    0.688"
				Width:  7.1"
				Width Editable? Yes
				Height: 4.083"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Особовi рахунки
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
		Functions
		Window Parameters
			Number: ni    !! 1 -сальдовка: 2-Только сумма оборотов: 3-средний остаток
			String: sdat    !! С даты
			String: sdat2   !! По дату
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			: cCncAux
				Class: cABSConnect
			Number: KV
			String: NLS
			String: NMS
			Date/Time: FDAT1
			Number: VS1
			Number: DOS1
			Number: KOS1
			Number: IX1
			String: ss
			String: SHAP1
			String: maska
			Boolean: asd
			!
			Number: nDig
			Number: DIG
		Message Actions
			On SAM_Create
				Call SetWindowFont(hWndForm)
				Call cCnc.Clone(g_cRepCnc, TRUE)
				Call cCncAux.Clone(cCnc, TRUE)
				! Set maska = Maska_NLS("счетов")
				Set maska = Maska_NLS(CurrentLangTable.GetAtomTitle('cTSelectAcc'))
				If maska='-'
					Call SalDestroyWindow( hWndForm )
					Return FALSE
				Set strBind = 'KV,NLS,NMS,FDAT1,VS1,DOS1,KOS1,IX1'
				Set strInput=strBind
				If maska = '*'
					Call SalDestroyWindow(hWndForm)
				If ni = 1 !! -сальдовка
					Set ss = T("
							    SELECT kv,nls,nms,fdat,(ost+dos-kos)/100,dos/100,
							           kos/100,ost/100
							    INTO :KV,:NLS,:NMS,:FDAT1,:VS1,:DOS1,:KOS1,:IX1
							    FROM SAL
							    WHERE DATE(fdat)>= :sdat  and date(fdat)<= :sdat2  and
							          ((ost+dos-kos)<>0 or dos<>0 or kos<>0) and
							          trim(nls) LIKE \'" || SalStrTrimX(maska) || "\'
							    ORDER BY kv,nls,fdat")
					Set SHAP1 = 'Дата        Вхідний залишок         Дебет' ||
							    '           Кредит    Вихідний залишок'
				If ni = 2 !! Только сумма оборотов
					Set ss = T("
							    SELECT kv,nls,nms,SUM(dos)/100,SUM(kos)/100,
							           SUM(gl.p_icurval(kv,dos,fdat))/100,
							           SUM(gl.p_icurval(kv,kos,fdat))/100
							    INTO :KV,:NLS,:NMS,:DOS1,:KOS1,:VS1,:IX1
							    FROM SAL
							    WHERE date(fdat)>= :sdat  and date(fdat) <= :sdat2  and
							          dos+kos<>0 and trim(nls) LIKE \'" ||
							          SalStrTrimX(maska) || "\'
							    GROUP BY kv,nls,nms
							    ORDER BY nls,kv")
					Set SHAP1 = '  ВАЛ             Обороти-Дебет         ' ||
							    'Обороти-Кредит'
					Set strBind = strBind||',DIG'
					Set strInput=strBind
				If ni = 3 !! средний остаток
					Set ss = T("
							    SELECT kv,nls,nms,SUM(ost)/100,COUNT(fdat),
							           (ROUND(SUM(ost)/COUNT(fdat),0))/100
							    INTO :KV,:NLS,:NMS,:VS1,:DOS1,:IX1
							    FROM SAL
							    WHERE date(fdat)>= :sdat  and date(fdat) <= :sdat2  and
							          trim(nls) LIKE \'" || SalStrTrimX(maska) || "\'
							    GROUP BY kv,nls,nms
							    ORDER BY nls,kv")
					Set SHAP1 = ' ВАЛ          Сума залишків       Кількість' ||
							    ' дат     Середній залишок'
				If ni = 4 !! -сальдовка  исполнителя
					Set ss = T("
							    SELECT kv,nls,nms,fdat,(ost+dos-kos)/100,dos/100,
							           kos/100,ost/100
							    INTO :KV,:NLS,:NMS,:FDAT1,:VS1,:DOS1,:KOS1,:IX1
							    FROM SAL
							    WHERE DATE(fdat)>= :sdat  and date(fdat)<= :sdat2  and
							          ((ost+dos-kos)<>0 or dos<>0 or kos<>0) and  isp=:ID and
							          trim(nls) LIKE \'" || SalStrTrimX(maska) || "\'
							    ORDER BY kv,nls,fdat")
					Set SHAP1 = 'Дата        Вхідний залишок         Дебет' ||
							    '           Кредит    Вихідний залишок'
				Call SalHideWindow(hWndForm)
				Call SalWaitCursor(TRUE)
				! Call SalReportPrintToFile(hWndForm, strDir, GetPrnDir() || '/'
						     || IifS(FL_FORMAT, strFileName1, strFileName), strBind,
						     strInput, 1, RPT_PrintAll, 1, 1, FL_FORMAT, nInd)
				! ==================================================
				! Начинаем печать в отчет
				! ==================================================
				Call SalReportPrintToFile(hWndForm, 
						                                              strTmplPath, 
						                                              strPrintPath ||'/'|| IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt),
						                                              strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
				If (nInd > 4 )
					! Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
					Call SalMessageBox(' SalReportPrintToFile - ' || 
							  CurrentLangTable.GetAtomTitle('cTErrFunc') || ' '|| SalNumberToStrX(nInd,0) , 
							  CurrentLangTable.GetAtomTitle('cTErrFunc'), 0 )
				! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
				Set frm_Out.dfPath = strPrintPath
				Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
				Call SalWaitCursor(FALSE)
				Call SalDestroyWindow(hWndForm)
			On SAM_ReportStart
				Return SqlPrepare(cCnc.hSql(),ss)
			On SAM_ReportFetchInit
				Return SqlExecute(cCnc.hSql())
			On SAM_ReportFetchNext
				! Return SqlFetchNext(hSql(), nFetchRes)
				If SqlFetchNext(cCnc.hSql(), nFetchRes)
					! проверка на 3 знака
					Call SqlPrepareAndExecute(cCncAux.hSql(), "
							SELECT dig INTO :nDig
							FROM tabval
							WHERE kv = :KV")
					If not SqlFetchNext(cCncAux.hSql(), nFetchRes)
						Return FALSE
					! Set VS1  = VS1*SalNumberPower( 10,2-nDig )
					Set DOS1 = DOS1*SalNumberPower( 10,2-nDig )
					Set KOS1 = KOS1*SalNumberPower( 10,2-nDig )
					! Set IX1  = IX1*SalNumberPower( 10,2-nDig )
					!
					Set DIG = nDig
					Return TRUE
			On SAM_ReportNotify
				If lParam = RPT_BeforeReportHeader
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'AMFO', AMFO)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'AQH', AQH)
					! Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'SHAP', SHAP || ' з ' || sd1 || ' по ' || sd2)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'SHAP', SHAP || ' з ' || strDateFrom || ' по ' || strDateTo)
					If ni=4
						Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
								     'IDNAME', IDNAME)
				If lParam = RPT_BeforeBreakHeader1
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'SHAP1', SHAP1)
			On SAM_ReportFinish
				Call SalSendMsg(frm_Out.tblReps, UM_ReportFinish, 0, 0)
			On SAM_Destroy
				If cCnc.IsConnected()
					Call cCnc.Disconnect()
				If cCncAux.IsConnected()
					Call cCncAux.Disconnect()
				Call SalWaitCursor(FALSE)
	Form Window: frm_OBMEN     !! отчет по обмену наличной валюты
		Class:
		Property Template:
		Class DLL Name:
		Title: Баланс банка
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.838"
				Top:    0.688"
				Width:  7.125"
				Width Editable? Yes
				Height: 3.563"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
		Functions
		Window Parameters
			Number: ni
			String: sdat
			String: sdat2
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			: cCncAux
				Class: cABSConnect
			String: FIO
			String: ss
			String: ISO
			String: NAME
			Number: DIG
			Number: BSUM
			Number: NPP
			Number: DIGN
			Number: KV
			Number: SV1
			Number: SN1
			Number: SV2
			Number: SN2
			Number: K1
			Number: K2
			Number: n980
		Message Actions
			On SAM_Create
				Call SetWindowFont(hWndForm)
				Call WaitCursorOn()
				Call cCnc.Clone(g_cRepCnc, TRUE)
				Call cCncAux.Clone(cCnc, TRUE)
				Set n980=GetBaseVal()
				Set strBind = 'NPP,KV,ISO,NAME,SV1,SN1,K1,SV2,SN2,K2' !! наши переменные
				Set strInput=strBind
				!
				If ni=0 !! По банку
					Set ss=T("
							 SELECT o.KV,SUM(o.S*o.dk),SUM(o.S2*o.dk),SUM(o.S*(1-o.dk)),SUM(o.S2*(1-o.dk))
							 INTO :KV,:SV1,:SN1,:SV2,:SN2
							 FROM oper o, tts t
							 WHERE o.sos=5 AND o.tt=t.tt  AND t.flv=1 AND o.nlsa[1,3]='100' AND o.nlsb[1,3]='100' AND
							   o.kv<>:n980 AND o.kv2=:n980 AND
							   o.vdat >= :sdat  AND o.vdat<= :sdat2
							 GROUP BY o.KV ORDER BY o.KV ")
				Else If ni<0 !! По отделу
					If SqlPrepareAndExecute(cCnc.hSql(),
							   "SELECT o.id,o.name   INTO :K1,:FIO
							    FROM otd_user u, otdel o
							    WHERE u.userid=:ID AND o.id=u.otd")
							and SqlFetchNext(cCnc.hSql(), KV)
						Set ss=T("
								 SELECT o.KV,SUM(o.S*o.dk),SUM(o.S2*o.dk),SUM(o.S*(1-o.dk)),SUM(o.S2*(1-o.dk))
								 INTO :KV,:SV1,:SN1,:SV2,:SN2
								 FROM oper o, tts t, otd_user u
								 WHERE u.userid=o.userid AND u.otd="||Str(K1)||" AND
								   o.sos=5 AND o.tt=t.tt  AND t.flv=1 AND o.nlsa[1,3]='100' AND
								   o.kv<>:n980 AND o.kv2=:n980 AND
								   o.vdat>= :sdat  AND o.vdat<= :sdat2
								 GROUP BY o.KV ORDER BY o.KV ")
				Else !! По испол
					Set ss=T("
							 SELECT o.KV,SUM(o.S*o.dk),SUM(o.S2*o.dk),SUM(o.S*(1-o.dk)),SUM(o.S2*(1-o.dk))
							 INTO :KV,:SV1,:SN1,:SV2,:SN2
							 FROM oper o, tts t
							 WHERE o.userid=:ID AND o.sos=5 AND o.tt=t.tt
							       AND t.flv=1 AND o.nlsa[1,3]='100' AND
							   o.kv<>:n980 AND o.kv2=:n980 AND
							   o.vdat>= :sdat  AND o.vdat<= :sdat2
							 GROUP BY o.KV ORDER BY o.KV ")
				!
				Set NPP=0
				Set DIGN=100
				Call SalHideWindow(hWndForm)
				! ==================================================
				! Начинаем печать в отчет
				! ==================================================
				Call SalReportPrintToFile(hWndForm, 
						                                                        strTmplPath, 
						                                                        strPrintPath ||'/'|| IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt),
						                                                        strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
				If (nInd > 4 )
					! Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
					Call SalMessageBox(' SalReportPrintToFile - ' || 
							  CurrentLangTable.GetAtomTitle('cTErrFunc') || ' '|| SalNumberToStrX(nInd,0) , 
							  CurrentLangTable.GetAtomTitle('cTAt'), 0 )
				! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
				Set frm_Out.dfPath = strPrintPath
				Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
				Call SalDestroyWindow(hWndForm)
			On SAM_ReportStart
				Return SqlPrepare(cCnc.hSql(),ss)
			On SAM_ReportFetchInit
				Return SqlExecute(cCnc.hSql())
			On SAM_ReportFetchNext  !! вычитать очередную строку
				If SqlFetchNext(cCnc.hSql(), nFetchRes)
					Call SqlPrepareAndExecute(cCncAux.hSql(),
							T("SELECT t.lcv,t.name[1,16],POWER(10,t.dig), c.bsum
							   INTO :ISO,:NAME,:DIG,:BSUM
							   FROM tabval t, cur_rates c
							   WHERE t.kv=:KV AND t.kv=c.kv AND
							         c.vdate in
							(SELECT MAX(c1.vdate) FROM cur_rates c1 WHERE c1.kv=c.kv)"))
					Call SqlFetchNext(cCncAux.hSql(),nFetchRes)
					! Set NAME=StrWinToDosX(NAME)
					Set NPP=NPP+1
					!
					If SV1>0
						Set K1=(SN1*DIG*BSUM)/(SV1*DIGN)
						Set SV1=SV1/DIG
					Else
						Set K1=0
					If SV2>0
						Set K2=(SN2*DIG*BSUM)/(SV2*DIGN)
						Set SV2=SV2/DIG
					Else
						Set K2=0
					!
					Set SN1=SN1/DIGN
					Set SN2=SN2/DIGN
					Return TRUE
				Else
					Return FALSE
			On SAM_ReportNotify           !! информировать ОТЧЕТ о глобальных переменных
				If lParam=RPT_BeforeReportHeader  !! только для заголовка
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'AMFO',AMFO)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'AQH',AQH)
					! Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'SHAP',SHAP||
							" "||sd1||IifS(sdat=sdat2,''," - "||sd2))
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'SHAP',SHAP||
							" "||strDateFrom||IifS(sdat=sdat2,''," - "||strDateTo))
					If ni != 0
						Call SqlPrepareAndExecute(cCncAux.hSql(), T("SELECT fio INTO :FIO FROM staff WHERE id=:ni"))
						Call SqlFetchNext(cCncAux.hSql(),nFetchRes)
						Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'FIO',SalNumberToStrX(ni,0)||"." ||FIO)
			On SAM_Destroy
				If cCnc.IsConnected()
					Call cCnc.Disconnect()
				If cCncAux.IsConnected()
					Call cCncAux.Disconnect()
				Call WaitCursorOff()
			On SAM_ReportFinish
				Call SalSendMsg( frm_Out.tblReps, UM_ReportFinish, 0, 0)
	Form Window: frm_Okrug     !! Сальдовка по ВЕШАЛКАМ
		Class:
		Property Template:
		Class DLL Name:
		Title: Пустышка
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   1.55"
				Top:    0.344"
				Width:  6.767"
				Width Editable? Yes
				Height: 0.857"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Сальдовка по Веш (MIK 29-03-2001)
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
		Functions
		Window Parameters
			String: sdat
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			: cCncAux
				Class: cABSConnect
			String: LCV
			String: NLS
			Number: DOS
			Number: KOS
			Number: OSTD
			Number: OSTK
			!
			Number: nDig
		Message Actions
			On SAM_Create
				Call SetWindowFont(hWndForm)
				Call WaitCursorOn()
				Call cCnc.Clone(g_cRepCnc, TRUE)
				Call cCncAux.Clone(cCnc, TRUE)
				Set strBind = 'LCV,NLS,DOS,KOS,OSTD,OSTK'
				Set strInput = strBind
				! Call SalReportPrintToFile(hWndForm,strDir,GetPrnDir()||'/'|| IifS(FL_FORMAT,strFileName1,strFileName),strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
				! ==================================================
				! Начинаем печать в отчет
				! ==================================================
				Call SalReportPrintToFile(hWndForm, 
						                                                        strTmplPath, 
						                                                        strPrintPath ||'/'|| IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt),
						                                                        strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
				If (nInd > 4 )
					! Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
					Call SalMessageBox(' SalReportPrintToFile - ' || 
							  CurrentLangTable.GetAtomTitle('cTErrFunc') || ' '|| SalNumberToStrX(nInd,0) , 
							  CurrentLangTable.GetAtomTitle('cTAt'),0 )
				! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
				Set frm_Out.dfPath = strPrintPath
				Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
				Call SalDestroyWindow(hWndForm)
				Call WaitCursorOff()
			On SAM_ReportStart
				Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'RUK',GetGlobalOption('BOSS'))
				Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'GLB',GetGlobalOption('ACCMAN'))
				Return SqlPrepare(cCnc.hSql(), T("
						     SELECT t.lcv,b.nls, b.dos,b.kos,
						      -decode(sign(b.ost),-1,b.ost,0),
						       decode(sign(b.ost), 1,b.ost,0)
						     FROM salb b,tabval t
						     WHERE b.kv=t.kv AND b.fdat=:sdat AND
						          (b.nls,b.kv) IN (SELECT s0000,kv from tabval)
						     ORDER BY t.lcv
						     INTO :LCV,:NLS,:DOS,:KOS,:OSTD,:OSTK"))
			On SAM_ReportFetchInit
				Return SqlExecute(cCnc.hSql())
			On SAM_ReportFetchNext
				!
				If SqlFetchNext(cCnc.hSql(), nFetchRes)
					! проверка на 3 знака
					Call SqlPrepareAndExecute(cCncAux.hSql(), "
							SELECT dig INTO :nDig
							FROM tabval
							WHERE lcv = :LCV")
					If not SqlFetchNext(cCncAux.hSql(), nFetchRes)
						Return FALSE
					Set DOS  = DOS*SalNumberPower( 10,-nDig )
					Set KOS  = KOS*SalNumberPower( 10,-nDig )
					Set OSTD = OSTD*SalNumberPower( 10,-nDig )
					Set OSTK = OSTK*SalNumberPower( 10,-nDig )
					!
					Return TRUE
				!
			On SAM_ReportNotify
				If lParam = RPT_BeforeReportHeader
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'aMFO', AMFO)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'aQH', AQH)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'Report_date', strRepDate)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							     'SHAP', SHAP)
			On SAM_ReportFinish
				Call SalSendMsg(frm_Out.tblReps, UM_ReportFinish, 0, 0)
			On SAM_Destroy
				If cCnc.IsConnected()
					Call cCnc.Disconnect()
				If cCncAux.IsConnected()
					Call cCncAux.Disconnect()
	Form Window: frm_Saldo     !! Сальдовка в номинале 33,34,35,38
		Class:
		Property Template:
		Class DLL Name:
		Title: Оборотно-сальдовая ведомость
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.838"
				Top:    0.688"
				Width:  10.0"
				Width Editable? Yes
				Height: 5.5"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Оборотно-сальдовая ведомость
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Child Table: tbl1 !! исполнители или валюты
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.083"
						Top:    0.393"
						Width:  9.633"
						Width Editable? Yes
						Height: 4.155"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Blue
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 3000
					Discardable? No
				Contents
					Column: Kod1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.567"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NAME1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: НАИМЕНОВАНИЕ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  7.283"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
						Set SS=T( " SELECT " || IifS(para=0,
								 " id,fio FROM staff  WHERE type=1", "kv,name FROM tabval " )  || " order by 1" )
						Call SalTblPopulate(tbl1, cCnc.hSql(), SS , TBL_FillAll)
					On SAM_DoubleClick
						Call FU_SAL(tbl1.Kod1)
						Call SalSetFocus(tbl1)
					On SAM_User
						Set nRow=TBL_MinRow
						Loop
							If SalTblFindNextRow (  tbl1, nRow, nTmp, 0 )
								Call SalTblSetContext( tbl1,nRow )
								If nRow >=0
									Call FU_SAL(tbl1.Kod1)
							Else
								Break
						Call SalSendMsg( tbl1, SAM_Create, 0, 0 )
			Pushbutton: PB1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Печать выбранных
				Window Location and Size
					Left:   3.6"
					Top:    4.69"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Midnight Blue
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nTmp=ROW_Selected
						Call SalSendMsg( tbl1, SAM_User, 0, 0 )
			Pushbutton: PB2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Печать ВСЕХ
				Window Location and Size
					Left:   1.0"
					Top:    4.69"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Midnight Blue
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nTmp=0
						Call SalSendMsg( tbl1, SAM_User, 0, 0 )
			Pushbutton: PB3 !! завершить
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Завершить
				Window Location and Size
					Left:   6.2"
					Top:    4.69"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Black
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalDestroyWindow(frm_Saldo)
			Radio Button: rb_All
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cRadioButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Все счета
				Window Location and Size
					Left:   0.1"
					Top:    0.071"
					Width:  2.2"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Radio Button: rb_Rab
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cRadioButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Рабочие счета
				Window Location and Size
					Left:   3.017"
					Top:    0.071"
					Width:  2.2"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Radio Button: rb_Ob
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cRadioButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Счета с оборотами
				Window Location and Size
					Left:   5.933"
					Top:    0.071"
					Width:  2.7"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
		Functions
			Function: FU_SAL
				Description: Печать сальдовки по ОДНОМУ
				Returns
				Parameters
					Number: nP11
				Static Variables
				Local variables
				Actions
					Call SalWaitCursor(TRUE)
					Set strFileNameTxt  = SalStrLeftX( strFileNameTxt, 5) || NumberToStrFormat (nP11, 3, '0',TRUE) || '.txt'
					If para=3
						Set SS = T("
								 SELECT app,kv,nbs+0,nls,ost/100,dos/100,kos/100,nms,isp
								 INTO :dtFdat,:nKv,:nBal,:nNls,:nOstf,:nDos,:nKos,:sNms,:ISPO
								 FROM sal
								 WHERE " || "kv=" || Str(nP11) ||
								      IifS(rb_Rab, " and (dos>0 or kos>0 or ost<>0)",
								      IifS(rb_Ob, " AND (dos>0 or kos>0)", "")) || " and
								      (dazs IS NULL or dazs> :sDat ) and
								      fdat= :sDat " || IifS(maska!='%', " and
								      trim(nls) LIKE \'" || SalStrTrimX(maska) || "\'", '') || "
								 ORDER BY kv,SUBSTR(nls,1,4) || SUBSTR(nls,6,9)")
					Else
						Set SS = T("
								    SELECT dapp,kv,nbs+0,nls,ost/100,dos/100,kos/100,nms,isp
								    INTO :dtFdat,:nKv,:nBal,:nNls,:nOstf,:nDos,:nKos,:sNms,
								         :ISPO
								    FROM sal
								    WHERE " || IifS(para=0, "isp=", "kv=") || Str(nP11) ||
								          IifS(rb_Rab, " and (dos>0 or kos>0 or ost<>0)",
								          IifS(rb_Ob, " AND (dos>0 or kos>0)", "")) || " and
								          (dazs IS NULL or dazs> :sDat ) and
								          fdat= :sDat " || IifS(maska!='%', " and
								          trim(nls) LIKE \'" || SalStrTrimX(maska) || "\'",
								          '') || "
								    ORDER BY kv,SUBSTR(nls,1,4) || SUBSTR(nls,6,9)")
					! ==================================================
					! Начинаем печать в отчет
					! ==================================================
					Call SalReportPrintToFile(hWndForm, strTmplPath, 
							      strPrintPath ||'/'|| IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt),
							      strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
					If (nInd > 4 )
						! Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
						Call SalMessageBox(' SalReportPrintToFile - ' || 
								  CurrentLangTable.GetAtomTitle('cTErrFunc') || ' '|| SalNumberToStrX(nInd,0) , 
								  CurrentLangTable.GetAtomTitle('cTAt'),0 )
					! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
					Set frm_Out.dfPath = strPrintPath
					Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
					If not FL_FORMAT
						Call zarez12Del( strPrintPath || '\\' || strFileNameTxt, frm_Out.tblReps.Kod, sDeviceDef, bDelOnNull)
					Call SalWaitCursor(FALSE)
		Window Parameters
			Number: para
			! !! 0 -  сортировано по ИСП, ВАЛ,БС, СЧЕТУ
			! !! 1 -  сортировано по 0, ВАЛ,БС, СЧЕТУ
			! !! 2 - для АПБ
			! !! 3 -  то же, что и 1 , но дата посл.движения- это ДЕЙСТВИТ.дата посл.движения(а не DAPP) 
			String: sDat ! дата
			Number: nP1 ! код ИСП
			Number: nP2 ! код ВАЛ
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			: cCncAux
				Class: cABSConnect
			String: strBankMfo
			String: strBankName
			!
			Number: nKv
			Number: nBal
			Number: nTmp
			Number: ISPO
			String: ISP
			String: sPdat
			Date/Time: dtFdat
			Number: nNls
			Number: nDos
			Number: nKos
			Number: nOstf
			Number: nOstfD
			Number: nOstfK
			Number: nOsti
			Number: nOstiD
			Number: nOstiK
			String: sNms
			String: sKv
			String: sIsp
			String: sGrB
			String: SS
			String: maska
			String: NAMV
			String: sP1
			! Number: nto
			Number: nRow
			!
			Number: nDig
			Number: DIG
		Message Actions
			On SAM_Create
				Call SalCenterWindow(hWndForm)
				Call SetWindowFont(hWndForm)
				Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
				Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('frm_Saldo.cTWndTitle') )
				Call cCnc.Clone(g_cRepCnc, TRUE)
				Call cCncAux.Clone(cCnc, TRUE)
				Set strBind = 'nKv,nBal,dtFdat,nNls,nDos,nKos,nOstiD,nOstiK,sNms,ISPO'
				Set rb_Rab = TRUE
				Set strInput = 'KV,NBS,FDAT,NLS,DOS,KOS,OSTID,OSTIK,NMS,ISPO'
				Call SalHideWindow(tbl1)
				Call SalHideWindow(PB1)
				Call SalHideWindow(PB3)
				If para=2  !! сальдовка АПБ
					Call SalWaitCursor(TRUE)
					Set sP1 = IifS(para=2, 'c.nls[12,14]', 'c.nls[7,8]')
					Set SS = T("
							    SELECT iif_d(a.fdat, :sDat ,a.pdat,a.fdat,a.fdat),
							           a.fdat," || sP1 ||
							           ",c.nls,(a.ostf-a.dos+a.kos)/100,
							           iif_d(a.fdat, :sDat ,0,a.dos,0)/100,
							           iif_d(a.fdat, :sDat ,0,a.kos,0)/100,c.nms,t.name
							    FROM saldoa a, accounts c, tabval t
							    WHERE c.acc=a.acc and c.kv=t.kv and c.kv=980 and
							          a.fdat IN (SELECT max(b.fdat)
							                     FROM saldoa b
							                     WHERE a.acc=b.acc and b.fdat<= :sDat
							                     GROUP BY b.acc) and " || sP1 ||
							                           " >= 0 and c.nls[1,4] in
							                           ('3902','3903')
							    ORDER BY 3,4
							    INTO :sPdat,:dtFdat,:nBal,:nNls,:nOstf,:nDos,:nKos,
							         :sNms,:NAMV")
					! Call SalReportPrintToFile(hWndForm, strDir, GetPrnDir() ||
							     '/'|| IifS(FL_FORMAT, strFileName1, strFileName),
							     strBind, strInput, 1, RPT_PrintAll, 1, 1, FL_FORMAT,
							     nInd)
					! ==================================================
					! Начинаем печать в отчет
					! ==================================================
					Call SalReportPrintToFile(hWndForm, 
							                                              strTmplPath, 
							                                              strPrintPath ||'/'|| IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt),
							                                              strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
					If (nInd > 4 )
						! Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
						Call SalMessageBox(' SalReportPrintToFile - ' || 
								  CurrentLangTable.GetAtomTitle('cTErrFunc') || ' '|| SalNumberToStrX(nInd,0) , 
								  CurrentLangTable.GetAtomTitle('cTAt'),0 )
					! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
					Set frm_Out.dfPath = strPrintPath
					Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
					Call SalWaitCursor(FALSE)
					Call SalDestroyWindow(frm_Saldo)
				Else
					! Set maska = Maska_NLS("счетов")
					Set maska = Maska_NLS(CurrentLangTable.GetAtomTitle('cTSelectAcc'))
					If maska = '-'
						Call SalDestroyWindow(hWndForm)
						Return FALSE
					Set strBind = strBind||',DIG'
					Set strInput = strInput||',DIG'
					If nP1 > 0
						Call FU_SAL(nP1)
						Call SalDestroyWindow(frm_Saldo)
					Else
						Call SalShowWindow(tbl1)
						Call SalShowWindow(PB1)
						Call SalShowWindow(PB3)
			On SAM_ReportStart
				Call SqlPrepare(cCnc.hSql(),SS)
			On SAM_ReportFetchInit
				Return SqlExecute(cCnc.hSql())
			On SAM_ReportFetchNext
				If SqlFetchNext(cCnc.hSql(), nFetchRes)
					! проверка на 3 знака
					Call SqlPrepareAndExecute(cCncAux.hSql(), "
							SELECT dig INTO :nDig
							FROM tabval
							WHERE kv = :nKv")
					If not SqlFetchNext(cCncAux.hSql(), nFetchRes)
						Return FALSE
					Set nOstf = nOstf*SalNumberPower( 10,2-nDig )
					Set nDos  = nDos*SalNumberPower( 10,2-nDig )
					Set nKos  = nKos*SalNumberPower( 10,2-nDig )
					!
					Set nOstiD = IifN(nOstf<0,-nOstf,0)
					Set nOstiK = IifN(nOstf<0,0,nOstf)
					Set DIG = nDig
					If para = 1 or para=3
						Set ISPO =NUMBER_Null
					Return TRUE
					!
				Else
					Return FALSE
			On SAM_ReportNotify
				If lParam=RPT_BeforeBreakHeader1  !! исполнитель
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'aMFO',  AMFO)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'aNAME', AQH)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'Report_date', strRepDate)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'SHAP',  SHAP)
					Call SqlPrepareAndExecute(cCncAux.hSql(),T("SELECT fio INTO :ISP FROM  staff WHERE id=:ISPO "  ) )
					Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'ISP',ISP)
				If lParam=RPT_BeforeBreakHeader2
					Call SqlPrepareAndExecute(cCncAux.hSql(),T("SELECT lcv||' '||name INTO :NAMV FROM  tabval WHERE kv=:nKv" ) )
					Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'NAMV',NAMV)
				If lParam=RPT_BeforeBreakFooter1
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'ISP',IifS(para=0,ISP,''))
			On SAM_ReportFinish
				Call SalSendMsg( frm_Out.tblReps, UM_ReportFinish, 0, 0)
			On SAM_Destroy
				If cCnc.IsConnected()
					Call cCnc.Disconnect()
				If cCncAux.IsConnected()
					Call cCncAux.Disconnect()
	Form Window: frm_SaldoB    !! Сальдовка по БС в номинале и экв
		Class:
		Property Template:
		Class DLL Name:
		Title: Оборотно-сальдовая ведомость
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.838"
				Top:    0.688"
				Width:  5.35"
				Width Editable? Yes
				Height: 2.583"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Оборотно-сальдовая ведомость по БС 71,22,60
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Radio Button: rb_All
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Все счета
				Window Location and Size
					Left:   1.217"
					Top:    0.226"
					Width:  2.2"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Radio Button: rb_Rab
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Рабочие счета
				Window Location and Size
					Left:   1.217"
					Top:    0.595"
					Width:  2.2"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Radio Button: rb_Ob
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Счета с оборотами
				Window Location and Size
					Left:   1.217"
					Top:    0.976"
					Width:  2.7"
					Width Editable? Yes
					Height: 0.25"
					Height Editable? Yes
				Visible? Yes
				Font Name: Default
				Font Size: 10
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
				Message Actions
			Pushbutton: pb_Print
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Формировать
				Window Location and Size
					Left:   1.85"
					Top:    1.595"
					Width:  1.6"
					Width Editable? Class Default
					Height: 0.452"
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name: \BARS98\RESOURCE\BMP\EXECUTE.BMP
				Picture Transparent Color: Gray
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Click
						Call WaitCursorOn()
						If xx = 0 !! Сальдовка
							Set rab = T("
									    SELECT s.nbs,s.nls,s.kv,t.lcv,s.nms,s.dapp, s.dos/100,s.kos/100,s.ost/100,
									           gl.p_icurval(s.kv,s.ost,s.fdat)/100,s.isp
									    INTO :BAL,:NLS,:KV,:LCV,:NMS,:FDAT,:DOS,:KOS,:OSTID,:EOSD,:ISP
									    FROM sal s, tabval t
									    WHERE " ||
									      IifS(NBS>0, "substr(s.nls,1,1)<>:NBS and ", "") ||
									      IifS(frm_SaldoB.rb_Rab," (s.dos>0 or s.kos>0 or s.ost<>0) and ",
									      IifS(frm_SaldoB.rb_Ob, " (s.dos>0 or s.kos>0) and ", "")) ||
									      " (s.dazs IS NULL OR s.dazs> :sDat  ) AND s.kv=t.kv and s.fdat= :sDat  AND
									        trim(s.nls) LIKE '" || maska || "'
									    ORDER BY 1,3,SUBSTR(nls,6)")
							! Set rab = T("
									    SELECT s.nbs,s.nls,s.kv,t.lcv,s.nms,s.fdat, s.dos/100,s.kos/100,s.ost/100,
									           gl.p_icurval(s.kv,s.ost,s.fdat)/100,s.isp
									    INTO :BAL,:NLS,:KV,:LCV,:NMS,:FDAT,:DOS,:KOS,:OSTID,:EOSD,:ISP
									    FROM sal s, tabval t
									    WHERE " ||
									      IifS(NBS>0, "substr(s.nls,1,1)<>:NBS and ", "") ||
									      IifS(frm_SaldoB.rb_Rab," (s.dos>0 or s.kos>0 or s.ost<>0) and ",
									      IifS(frm_SaldoB.rb_Ob, " (s.dos>0 or s.kos>0) and ", "")) ||
									      " (s.dazs IS NULL OR s.dazs> :sDat  ) AND s.kv=t.kv and s.fdat= :sDat  AND
									        trim(s.nls) LIKE '" || maska || "'
									    ORDER BY 1,3,SUBSTR(nls,6)")
						Else If xx = 1 !! Баланс
							Set rab = T("
									    SELECT s.nbs,s.kv,t.lcv,SUM(s.dos)/100,
									           SUM(s.kos)/100,SUM(s.ost)/100,
									           SUM(gl.p_icurval(s.kv,s.ost,s.fdat))/100
									    INTO :BAL,:KV,:LCV,:DOS,:KOS,:OSTID,:EOSD
									    FROM sal s, tabval t
									    WHERE " ||
									     IifS(rb_Rab, "(s.dos>0 or s.kos>0 or s.ost<>0) and ",
									     IifS(rb_Ob,  "(s.dos>0 or s.kos>0) and ", "")) ||
									      " s.kv=t.kv and s.fdat= :sDat  and trim(s.nls) LIKE '" ||
									          maska || "'
									    GROUP BY s.nbs,s.kv,t.lcv
									    ORDER BY 1,3,2")
						Else If xx = 4 !! Оборотно-сальдовая ведомость c эквивалентами
							Set strBind = 'BAL,NLS,KV,LCV,NAMV,NMS,FDAT,DOS,EDOS,KOS,EKOS,OSTID,EOSD,OSTIK,EOSK,ISP'
							Set strInput=strBind
							Set rab = T("
									    SELECT s.nbs, s.nls, s.kv, t.lcv, t.name, s.nms, s.app, 
									           s.dos/100,gl.p_icurval(s.kv,s.dos,s.fdat)/100,
									           s.kos/100,gl.p_icurval(s.kv,s.kos,s.fdat)/100,
									           s.ost/100,gl.p_icurval(s.kv,s.ost,s.fdat)/100,s.isp
									    INTO :BAL,:NLS,:KV,:LCV,:NAMV,:NMS,:FDAT,:DOS,:EDOS,:KOS,:EKOS,
									         :OSTID,:EOSD,:ISP
									    FROM sal s, tabval t
									    WHERE " ||
									      IifS(NBS>0, "substr(s.nls,1,1)<>:NBS and ", "") ||
									      IifS(frm_SaldoB.rb_Rab," (s.dos>0 or s.kos>0 or s.ost<>0) and ",
									      IifS(frm_SaldoB.rb_Ob, " (s.dos>0 or s.kos>0) and ", "")) ||
									      " (s.dazs IS NULL OR s.dazs> :sDat  ) AND s.kv=t.kv AND s.fdat= :sDat  AND
									        trim(s.nls) LIKE '" || maska || "'
									    ORDER BY 1,3,SUBSTR(nls,6)")
						Else
							Set rab = T(
									"SELECT s.nbs,s.nls,s.kv,t.lcv,s.nms,s.dapp,s.dos/100,s.kos/100,s.ost, s.isp
									 INTO :BAL, :NLS,:KV,:LCV,:NMS,:FDAT,:DOS,:KOS,:OSTID, :ISP
									 FROM sal s, tabval t  WHERE " ||
									  IifS(NBS>0, "substr(s.nls,1,1)<>:NBS and ", "") ||
									  IifS(frm_SaldoB.rb_Rab," (s.dos>0 or s.kos>0 or s.ost<>0) and ",
									  IifS(frm_SaldoB.rb_Ob, " (s.dos>0 or s.kos>0) and ", "")) ||
									  IifS(xx=3," s.acc in (select acc from saldo) AND ","") ||
									  " s.kv=t.kv and s.fdat= :sDat  and trim(s.nls) LIKE '" || maska || "'
									    ORDER BY kv, substr(nls,1,4)||substr(nls,6,9)" )
						! ==================================================
						! Начинаем печать в отчет
						! ==================================================
						Call SalReportPrintToFile(hWndForm, 
								                                              strTmplPath, 
								                                              strPrintPath ||'/'|| IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt),
								                                              strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
						If (nInd > 4 )
							! Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
							Call SalMessageBox(' SalReportPrintToFile - ' || 
									  CurrentLangTable.GetAtomTitle('cTErrFunc') || ' '|| SalNumberToStrX(nInd,0) , 
									  CurrentLangTable.GetAtomTitle('cTAt'), 0 )
						! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
						Set frm_Out.dfPath = strPrintPath
						Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
						Call WaitCursorOff()
						Call SalDestroyWindow(hWndForm)
		Functions
		Window Parameters
			Number: xx
			String: sDat
			String: NAMB
			Number: NBS
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			: cCncAux
				Class: cABSConnect
			String: maska
			String: BAL
			String: KLA
			String: RAZ
			String: GRU
			String: NLS
			Number: KV
			String: LCV
			String: NAMV
			Date/Time: FDAT
			Date/Time: DAPP
			Number: DOS
			Number: KOS
			Number: OSTID
			Number: OSTIK
			Number: EDOS
			Number: EKOS
			String: NMS
			Number: EOSD
			Number: EOSK
			Number: ISP
			!
			Number: nDig
			Number: n980
		Message Actions
			On SAM_Create
				Call SalCenterWindow(hWndForm)
				Call SetWindowFont(hWndForm)
				Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
				Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('frm_SaldoB.cTWndTitle') )
				Call cCnc.Clone(g_cRepCnc, TRUE)
				Call cCncAux.Clone(cCnc, TRUE)
				If xx = 1
					! Call SalSetWindowText( hWndForm, 'Оборотно-сальдовый баланс' )
					Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('dfrm_SaldoB.cTWndTitle2') )
				Set n980=GetBaseVal()
				Set strBind = 'KLA,RAZ,GRU,BAL,NLS,KV,LCV,FDAT,DOS,KOS,OSTID,'
						    || 'OSTIK,NMS,EOSD,EOSK,ISP'
				Set strInput = strBind
				Set nInd = RPT_NoToolbar
				! Set maska = Maska_NLS("счетов")
				Set maska = Maska_NLS(CurrentLangTable.GetAtomTitle('cTSelectAcc'))
				If maska = '-'
					Call SalDestroyWindow(hWndForm)
					Return FALSE
				Set rb_Rab = TRUE
			On SAM_ReportStart
				Call SqlPrepare(cCnc.hSql(),rab)
			On SAM_ReportFetchInit
				Return SqlExecute(cCnc.hSql())
			On SAM_ReportFetchNext
				If SqlFetchNext(cCnc.hSql(), nFetchRes)
					! While (OSTID= 0 and  DOS = 0  and  KOS = 0)
						                                                                   If NOT SqlFetchNext(hSql(), nFetchRes)
							                                                                   Return FALSE
					!
					! проверка на 3 знака
					Call SqlPrepareAndExecute(cCncAux.hSql(), "
							SELECT dig INTO :nDig
							FROM tabval
							WHERE kv = :KV")
					If not SqlFetchNext(cCncAux.hSql(), nFetchRes)
						Return FALSE
					Set DOS  = DOS*SalNumberPower( 10,2-nDig )
					Set KOS  = KOS*SalNumberPower( 10,2-nDig )
					Set OSTID= OSTID*SalNumberPower( 10,2-nDig )
					Set EOSD = EOSD*SalNumberPower( 10,2-nDig )
					!
					If OSTID < 0
						Set OSTID = -OSTID
						Set OSTIK  = 0
						Set EOSD = -EOSD
						Set EOSK  = 0
					Else
						Set OSTIK = OSTID
						Set OSTID = 0
						Set EOSK  = EOSD
						Set EOSD = 0
					Set KLA=SalStrLeftX( BAL, 1 )
					Set RAZ=SalStrLeftX( BAL, 2 )
					Set GRU=SalStrLeftX( BAL, 3 )
					Return TRUE
				Else
					Return FALSE
			On SAM_ReportNotify
				If lParam=RPT_BeforeReportHeader
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'aMFO', AMFO)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'aNAME', AQH)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'Report_date',StrWinToDosX(strRepDate))
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'SHAP',SHAP)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'SHAP1',GetUserRealName())
			On SAM_ReportFinish
				Call SalSendMsg( frm_Out.tblReps, UM_ReportFinish, 0, 0)
			On SAM_Destroy
				If cCnc.IsConnected()
					Call cCnc.Disconnect()
				If cCncAux.IsConnected()
					Call cCncAux.Disconnect()
	Form Window: frm_SKP       !! ЗВІТ по СКП 5, 40
		Class:
		Property Template:
		Class DLL Name:
		Title: Баланс банка
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.838"
				Top:    0.688"
				Width:  7.125"
				Width Editable? Yes
				Height: 3.563"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
		Functions
		Window Parameters
			String: sdat
			String: sdat2
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			: cCncAux2
				Class: cABSConnect
			String: ss2
			String: NAME
			Number: VX
			Number: KV
			Number: SK
			Number: DOS
			Number: KOS
			Number: S02_32
			Number: S40_61
			String: strRBSName
		Message Actions
			On SAM_Create
				Call SetWindowFont(hWndForm)
				Call SalWaitCursor(TRUE)
				Call cCnc.Clone(g_cRepCnc, TRUE)
				Call cCncAux2.Clone(cCnc, TRUE)
				Set S02_32=NUMBER_Null
				Set S40_61=NUMBER_Null
				Set KV=GetBaseVal()
				If SalStrTrimX(SalStrUpperX(GetDBMS()))='ORACLE'
					Set strRBSName = GetGlobalOption( 'RNBURBCK' )
					Set ID = GetUserId()
					If strRBSName
						! ! Make end of transaction and start new
						Call SqlCommit(cCnc.hSql())
						! ! to avoid error with set transaction...
						Call SqlPrepareAndExecute(cCnc.hSql(), 'SET TRANSACTION USE ROLLBACK SEGMENT ' || SalStrUpperX( strRBSName ) )
					If not SqlPLSQLCommand(cCnc.hSql(), "P_KJ(ID,sdat,sdat2)")
						Return FALSE
				Set strBind = 'VX,SK,DOS,KOS,S02_32,S40_61' !! наши переменные
				Set strInput=strBind
				Set ss2=T("SELECT -SUM(ost+dos-kos)/100
						 INTO :VX FROM sal WHERE tip='KAS' AND kv=:KV AND fdat= :sdat ")
				If SqlPrepareAndExecute(cCnc.hSql(), ss2)
					Call SqlFetchNext(cCnc.hSql(), nFetchRes)
				Set ss2 = T("
						    SELECT t.sk, Sum(decode(t.DK,0,t.S,0))/100, SUM(decode(t.DK,1,t.S,0))/100
						    INTO :SK, :DOS, :KOS
						    FROM tmp_kj t
						    WHERE t.id=:ID
						    GROUP BY t.sk
						    ORDER BY t.sk")
				! Set ss2=T("
						SELECT SK, SUM(decode(DK,0,S,0))/100, SUM(decode(DK,1,S,0))/100
						INTO :SK, :DOS, :KOS
						FROM ( Select decode(p.tt,o.tt,o.sk,t.sk) SK, p.dk DK,  p.s S
						       From opldok p, oper o, tts t, accounts a
						       Where o.ref=p.ref and t.tt=p.tt and a.acc=p.acc and a.tip='KAS' and
						             p.fdat BETWEEN  :sdat  AND  :sdat2  and  o.sos=5 and
						            ( p.dk=0 and decode( p.tt,o.tt,o.sk,t.sk)<40 or
						              p.dk=1 and decode( p.tt,o.tt,o.sk,t.sk)>39    )
						       Union all
						       Select decode(p.dk,0,39,66),           p.dk,     p.s
						       From opldok p, oper o, tts t, accounts a
						       Where o.ref=p.ref and t.tt=p.tt and a.acc=p.acc and a.tip='KAS' and
						             p.fdat BETWEEN  :sdat  AND  :sdat2  and  o.sos=5 and
						            (           decode(p.tt,o.tt,o.sk,t.sk) is null or
						             p.dk=1 and decode( p.tt,o.tt,o.sk,t.sk)<40     or
						             p.dk=0 and decode( p.tt,o.tt,o.sk,t.sk)>39 )
						      )
						GROUP BY SK
						ORDER BY SK")
				! Set ss2=T("
						SELECT decode(p.tt,o.tt,o.SK,t.sk),
						       SUM(decode(p.dk,0,p.s,0))/100,
						       SUM(decode(p.dk,1,p.s,0))/100
						INTO :SK, :DOS, :KOS
						FROM  accounts a, OPER O, OPLDOK P, tts t
						WHERE  a.kv=:KV  and  p.acc=a.acc AND a.tip='KAS' AND
						       p.fdat >= :sdat   AND  p.fdat <= :sdat2  AND
						       o.ref=p.ref  AND  p.SOS = 5  AND t.tt=p.tt
						GROUP BY decode(p.tt,o.tt,o.SK,t.sk)
						ORDER BY 1")
				Call SalWaitCursor(FALSE)
				Call SalHideWindow(hWndForm)
				! Call SalReportPrintToFile(hWndForm,strDir,GetPrnDir()||'/'|| IifS(FL_FORMAT,strFileName1,strFileName),strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
				! ==================================================
				! Начинаем печать в отчет
				! ==================================================
				Call SalReportPrintToFile(hWndForm, 
						                                              strTmplPath, 
						                                              strPrintPath ||'/'|| IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt),
						                                              strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
				If (nInd > 4 )
					! Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
					Call SalMessageBox(' SalReportPrintToFile - ' || 
							  CurrentLangTable.GetAtomTitle('cTErrFunc') || ' '|| SalNumberToStrX(nInd,0) ,
							  CurrentLangTable.GetAtomTitle('cTAt'), 0 )
				! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
				Set frm_Out.dfPath = strPrintPath
				Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
				Call SalDestroyWindow(hWndForm)
			On SAM_ReportStart             !! приготовить SELECT
				Return SqlPrepare(cCnc.hSql(), ss2)
			On SAM_ReportFetchInit
				Return SqlExecute(cCnc.hSql())
			On SAM_ReportFetchNext
				If SqlFetchNext(cCnc.hSql(), nFetchRes)
					If SK<40
						Set S40_61=NUMBER_Null
						If SK<33
							Set S02_32=S02_32+DOS
						If SK>32
							Set S02_32=NUMBER_Null
					Else
						If S40_61>0
							Set S02_32=NUMBER_Null
						If SK>39 and SK<62
							Set S40_61=S40_61+KOS
						If SK>61
							Set S40_61=NUMBER_Null
					Return TRUE
				Else
					Return FALSE
				! Return SqlFetchNext(hSql(), nFetchRes)
			On SAM_ReportNotify
				If lParam=RPT_BeforeReportHeader
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'AMFO', AMFO)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'AQH', AQH)
					! Set rab=SHAP||' '|| sd1 || IifS(sdat=sdat2,'',' - '||sd2)
					Set rab=SHAP||' '|| strDateFrom || IifS(sdat=sdat2,'',' - '||strDateTo)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'SHAP', rab)
				If lParam=RPT_BeforeDetail
					Call SqlPrepareAndExecute(cCncAux2.hSql(),
							"SELECT name INTO :NAME FROM sk WHERE sk=:SK")
					Call SqlFetchNext(cCncAux2.hSql(), nFetchRes)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'NAME',NAME)
			On SAM_Destroy
				! Set bFrmTorg=FALSE
				! Set dlg_OutForms.rb0=TRUE
				If cCnc.IsConnected()
					Call cCnc.Disconnect()
				If cCncAux2.IsConnected()
					Call cCncAux2.Disconnect()
				Call WaitCursorOff()
			On SAM_ReportFinish
				Call SalSendMsg( frm_Out.tblReps, UM_ReportFinish, 0, 0)
	Form Window: frm_Staff     !! Карточка пользователя
		Class:
		Property Template:
		Class DLL Name:
		Title: КАРТОЧКА ПОЛЬЗОВАТЕЛЯ
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.838"
				Top:    0.688"
				Width:  10.217"
				Width Editable? Yes
				Height: 5.655"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Карточка пользователя
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Child Table: tbl1 !!Карточка пользователя
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.067"
						Top:    0.036"
						Width:  9.667"
						Width Editable? Yes
						Height: 4.5"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Blue
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 3000
					Discardable? No
				Contents
					Column: Kod1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.567"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NAME1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: НАИМЕНОВАНИЕ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  7.283"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
						Call SalTblPopulate(tbl1, cCnc.hSql(), T( " SELECT  id,fio FROM staff  order by 1" ) , TBL_FillAll)
					On SAM_DoubleClick
						Call FU_SAL(tbl1.Kod1)
						Call SalSetFocus(tbl1)
					On SAM_User
						Set nRow=TBL_MinRow
						Loop
							If SalTblFindNextRow (  tbl1, nRow, nTmp, 0 )
								Call SalTblSetContext( tbl1,nRow )
								If nRow >=0
									Call FU_SAL(tbl1.Kod1)
							Else
								Break
						Call SalSendMsg( tbl1, SAM_Create, 0, 0 )
			Pushbutton: PB1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Печать выбранных
				Window Location and Size
					Left:   3.6"
					Top:    4.655"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Midnight Blue
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nTmp=ROW_Selected
						Call SalSendMsg( tbl1, SAM_User, 0, 0 )
			Pushbutton: PB2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Печать ВСЕХ
				Window Location and Size
					Left:   1.0"
					Top:    4.655"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Midnight Blue
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nTmp=0
						Call SalSendMsg( tbl1, SAM_User, 0, 0 )
			Pushbutton: PB3 !! завершить
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Завершить
				Window Location and Size
					Left:   6.2"
					Top:    4.655"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Black
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalDestroyWindow(  frm_Staff )
		Functions
			Function: FU_SAL
				Description: !! Карточка пользователя
				Returns
				Parameters
					Number: nP11
				Static Variables
				Local variables
					String: aa
					String: subst
					!
					String: strSecurApp
					String: strSecurTts
					String: strSecurChk
					String: strSecurGrp
				Actions
					Call SalWaitCursor(TRUE)
					If EnhancedSecurity()
						Set strSecurApp = " AND NVL(R.approve,0)=1 AND date_is_valid(R.adate1,R.adate2,R.rdate1,R.rdate2)=1 "
						Set strSecurTts = " AND NVL(T.approve,0)=1 AND date_is_valid(T.adate1,T.adate2,T.rdate1,T.rdate2)=1 "
						Set strSecurChk = " AND NVL(H.approve,0)=1 AND date_is_valid(H.adate1,H.adate2,H.rdate1,H.rdate2)=1 "
						Set strSecurGrp = " AND NVL(G.approve,0)=1 AND date_is_valid(G.adate1,G.adate2,G.rdate1,G.rdate2)=1 "
					Set aa = SalNumberToStrX(nP11, 0)
					Set subst = GetSubstListId(nP11, TRUE)
					! Set strFileName = SalStrLeftX(strFileName,
							    SalStrScan(strFileName, '.')+1 ) || SalStrRightX(aa, 3)
					Set strFileNameTxt = SalStrLeftX( strFileNameTxt, 5 ) || NumberToStrFormat (nP11, 3, '0',TRUE) || '.txt'
					Set SS = "
							    SELECT id,fio,logname,type,tabn
							    INTO :ID1,:FIO,:LOGN,:ISP,:TABN
							    FROM staff
							    WHERE id=" || aa
					Call SqlPrepareAndExecute(cCncAux.hSql(), T(SS))
					Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
					Set SS = T("
							    SELECT 1, a.codeapp, a.name, Null
							    INTO :NNP,:KODP,:NAMEP,:SECG
							    FROM applist_staff R, applist A
							    WHERE r.id IN (" || subst || ") and r.codeapp=a.codeapp
							    UNION ALL
							    SELECT 2, b.tt, b.name, Null
							    FROM staff_tts T, tts B
							    WHERE t.id IN (" || subst || ") and t.tt=b.tt
							    UNION ALL
							    SELECT 3, c.idchk || '', c.name, Null
							    FROM staff_chk H, chklist C
							    WHERE h.id IN (" || subst || ") and h.chkid=c.idchk
							    UNION ALL
							    SELECT 4, d.id || '', d.name, g.secg
							    FROM groups_staff G, groups D
							    WHERE g.idu IN (" || subst || ") and g.idg=d.id 
							    UNION ALL                                                 
							    SELECT 5, d.kodf ||' '||d.a017, d.semantic, Null    
							    FROM STAFF_KLF00 O, KL_F00 D                              
							    WHERE o.id IN (" || subst || ") and o.kodf=d.kodf and o.a017=d.a017
							    ORDER BY 1,2")
					! Call SalReportPrintToFile(hWndForm, strDir, GetPrnDir() ||
							     '/'|| IifS(FL_FORMAT, strFileName1, strFileName),
							     strBind, strInput, 1, RPT_PrintAll, 1, 1, FL_FORMAT,
							     nInd)
					! ==================================================
					! Начинаем печать в отчет
					! ==================================================
					Call SalReportPrintToFile(hWndForm, 
							  strTmplPath, 
							  strPrintPath ||'/'|| IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt),
							  strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
					If (nInd > 4 )
						! Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
						Call SalMessageBox(' SalReportPrintToFile - ' || 
								  CurrentLangTable.GetAtomTitle('cTErrFunc') || ' '|| SalNumberToStrX(nInd,0) , 
								  CurrentLangTable.GetAtomTitle('cTAt'), 0 )
					! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
					Set frm_Out.dfPath = strPrintPath
					Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
							
					If not FL_FORMAT
						! Call zarez12(GetPrnDir() || '\\' || strFileName, frm_Out.tbl1.Kod,
								     frm_Out.tbl1.sDeviceDef)
						Call zarez12Del(  strPrintPath || '\\' || strFileNameTxt, frm_Out.tblReps.Kod, sDeviceDef, bDelOnNull)
					Call SalWaitCursor(FALSE)
		Window Parameters
			Number: nP1
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			: cCncAux
				Class: cABSConnect
			Number: NNP
			String: KODP
			String: NAMEP
			Number: ID1
			String: FIO
			String: LOGN
			String: SS
			String: TABN
			Number: ISP
			Number: nRow
			Number: nTmp
			Number: SECG
		Message Actions
			On SAM_Create
				Call SalCenterWindow(hWndForm)
				Call SetWindowFont(hWndForm)
				Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
				Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('frm_Staff.cTWndTitle') )
				Call cCnc.Clone(g_cRepCnc, TRUE)
				Call cCncAux.Clone(cCnc, TRUE)
				Set strBind = 'NNP,KODP,NAMEP,SECG'
				Set strInput=strBind
				Call SalHideWindow(  tbl1 )
				Call SalHideWindow(  PB1 )
				Call SalHideWindow(  PB3 )
				If nP1 > 0 !! по одному
					Call FU_SAL(nP1)
					Call SalDestroyWindow( frm_Staff)
				Call SalShowWindow(  tbl1 )
				Call SalShowWindow(  PB1 )
				Call SalShowWindow(  PB3 )
			On SAM_ReportStart
				Call SqlPrepare(cCnc.hSql(), SS)
			On SAM_ReportFetchInit
				Return SqlExecute(cCnc.hSql())
			On SAM_ReportFetchNext
				If SqlFetchNext(cCnc.hSql(), nFetchRes)
					! If not bFLS
						                                                                               Set NAMEP=StrWinToDosX(NAMEP)
					Return TRUE
			On SAM_ReportNotify
				If lParam=RPT_BeforeReportHeader
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'SHAP',SHAP)
					Call SalReportSetNumberVar( SalNumberToWindowHandle(wParam),'ID', ID1)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'TABN',TABN)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'LOGN',LOGN)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'FIO', FIO)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							 'ISPO', IifS(ISP=1,"ISP",""))
				If lParam=RPT_BeforeBreakHeader1
					! Set FIO=IifS(NNP=1,'АРМы:',
							 IifS(NNP=2,'ОПЕРАЦИИ',IifS(NNP=3,'ГРУППЫ КОНТРОЛЯ ОПЕРАЦИЙ','ГРУППЫ ДОСТУПА К СЧЕТАМ')))
					Set FIO=IifS(NNP=1,
							  CurrentLangTable.GetAtomTitle('frm_Staff.cTRepArm') || ':', 
							  IifS(NNP=2,CurrentLangTable.GetAtomTitle('frm_Staff.cTRepTts'),
							  IifS(NNP=3,CurrentLangTable.GetAtomTitle('frm_Staff.cTRepChk'),
							  IifS(NNP=4,CurrentLangTable.GetAtomTitle('frm_Staff.cTRepGrp'),
							  CurrentLangTable.GetAtomTitle('frm_Staff.cTRepFotc')))))
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'RESU', FIO)
			On SAM_ReportFinish
				Call SalSendMsg( frm_Out.tblReps, UM_ReportFinish, 0, 0)
			On SAM_Destroy
				If cCnc.IsConnected()
					Call cCnc.Disconnect()
				If cCncAux.IsConnected()
					Call cCncAux.Disconnect()
				Call SalWaitCursor( FALSE )
	Form Window: frm_Stat      !! Статистика Переоценка 9,..
		Class:
		Property Template:
		Class DLL Name:
		Title: Баланс банка
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.838"
				Top:    0.688"
				Width:  7.125"
				Width Editable? Yes
				Height: 3.563"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
		Functions
		Window Parameters
			String: sdat
			Number: para
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			: cCncAux
				Class: cABSConnect
			: cCncAux2
				Class: cABSConnect
			String: ss
			!
			Number: VP
			Number: TIP
			Number: ISP
			Number: DK
			Number: KV
			Number: KOL
			Number: S
			Number: SQ
			Number: n980
			String: NLS
			String: sTmp
			String: maska
			!
			Date/Time: dtPrev
			!
			Number: nDig
			String: sTmp1
		Message Actions
			On SAM_Create
				Call SetWindowFont(hWndForm)
				Call cCnc.Clone(g_cRepCnc, TRUE)
				Call cCncAux.Clone(cCnc, TRUE)
				Call cCncAux2.Clone(cCnc, TRUE)
				Set n980=GetBaseVal()
				Set nInd = RPT_NoToolbar !! парамерт для управления печатью отчета
				If para=1  !! Протокол оплаты
					Set strBind = 'TIP,ISP,DK,KV,KOL,S,SQ,VP'  !! наши переменные
					Set ss="
							SELECT '1',o.userid,o.dk,o.kv,o.vp,count(*),sum(o.s)/100 ,sum(o.s)/100   
							INTO :TIP,:ISP,:DK,:KV,:VP,:KOL,:S,:SQ    
							FROM oper o 
							WHERE o.sos=5 and o.kv=:n980 and o.mfoa=o.mfob 
							   and  o.pdat between :sdat   and :sdat + 1
							GROUP BY o.userid,o.dk,o.kv,o.vp    
							UNION all    
							SELECT '2',o.userid,o.dk,o.kv,o.vp, count(*),sum(o.s)/100, sum(o.s)/100    
							FROM  OPER o WHERE o.sos=5 and o.kv=:n980 and o.mfoa <>o.mfob and   
							      o.mfoa= " || AMFO || " 
							 and  o.pdat between :sdat   and :sdat + 1
							GROUP BY o.userid,o.dk,o.kv,o.vp    
							UNION all    
							SELECT '5',0,o.dk,o.kv,0,count(*),sum(o.s)/100,sum(o.s)/100     
							FROM  arc_rrp o WHERE o.sos=5 and o.kv=:n980 and o.mfoa <> o.mfob and    
							      o.mfob = " || AMFO || " 
							and  o.dat_b between :sdat   and :sdat + 1  
							GROUP BY  o.dk,o.kv    
							UNION all    
							SELECT '6',o.userid,o.dk,o.kv,o.vp,count(*),sum(o.s)/100 ,sum( gl.p_icurval(o.kv, o.s,  :sdat  )/100)     
							FROM  oper o WHERE o.sos=5 and o.kv<>:n980 
							and  o.pdat between :sdat   and :sdat + 1
							GROUP BY  o.userid,o.dk,o.kv,o.vp   ORDER BY 1,2,3,4"     
					! Set ss="
							SELECT '1',o.userid,o.dk,o.kv,o.vp,count(*),sum(o.s)/100 ,sum(o.s)/100   
							INTO :TIP,:ISP,:DK,:KV,:VP,:KOL,:S,:SQ    
							FROM oper o WHERE o.sos=5 and    
							     o.kv=:n980 and o.mfoa=o.mfob and  TRUNC(o.pdat) = :sdat    
							GROUP BY o.userid,o.dk,o.kv,o.vp    
							UNION all    
							SELECT '2',o.userid,o.dk,o.kv,o.vp, count(*),sum(o.s)/100, sum(o.s)/100    
							FROM  OPER o WHERE o.sos=5 and o.kv=:n980 and o.mfoa <>o.mfob and   
							      o.mfoa= " || AMFO || " and TRUNC(o.pdat) =  TO_DATE(:sdat, 'MM-DD-YYYY')       
							GROUP BY o.userid,o.dk,o.kv,o.vp    
							UNION all   
							SELECT '5',0,o.dk,o.kv,0,count(*),sum(o.s)/100,sum(o.s)/100   
							FROM  arc_rrp o WHERE o.sos=5 and o.kv=:n980 and o.mfoa <> o.mfob and   
							      o.mfob = " || AMFO || " and  TRUNC(o.dat_b) =  TO_DATE(:sdat, 'MM-DD-YYYY')       
							GROUP BY  o.dk,o.kv   
							UNION all   
							SELECT '6',o.userid,o.dk,o.kv,o.vp,count(*),sum(o.s)/100 ,sum( gl.p_icurval(o.kv, o.s,  :sdat  )/100)    
							FROM  oper o WHERE o.sos=5 and o.kv<>:n980 and  TRUNC(o.pdat) =  TO_DATE(:sdat, 'MM-DD-YYYY')      
							GROUP BY  o.userid,o.dk,o.kv,o.vp    
							ORDER BY 1,2,3,4"    
				Else If para=2 !! Ведомость курсовых разниц
					If SqlPrepareAndExecute(cCnc.hSql(),
							T('SELECT max(fdat) INTO :dtPrev FROM fdat WHERE fdat < :sdat '))     
						Call SqlFetchNext(cCnc.hSql(), nFetchRes)
					! Set maska=Maska_NLS("счетов")   
					Set maska=Maska_NLS(CurrentLangTable.GetAtomTitle('cTSelectAcc'))
					Call SalDateToStr ( dtPrev, sTmp1 )
					If maska='-'
						Call SalDestroyWindow( hWndForm )
						Return FALSE
					Set strBind = 'KV,NLS,S,SQ,KOL'  !! наши переменные
					Set ss="SELECT
							kv,nls,ost/100,gl.p_icurval(kv,ost,fdat)/100,
							( gl.p_icurval(kv,ost+dos-kos,fdat)-
							  gl.p_icurval(kv,ost+dos-kos,:dtPrev))/100
							INTO :KV,:NLS,:S,:SQ,:KOL FROM sal
							WHERE  kv<>"||Str(GetBaseVal())||" AND fdat= :sdat  "||
							IifS(maska !='%'," AND trim(nls) LIKE \'"||SalStrTrimX(maska)||"\'",'')||"
							ORDER BY kv,nbs,nls "
				Set strInput =strBind
				Call WaitCursorOn()
				Call SalHideWindow(hWndForm)
				! ==================================================
				! Начинаем печать в отчет
				! ==================================================
				Call SalReportPrintToFile(hWndForm, 
						                                              strTmplPath, 
						                                              strPrintPath ||'/'|| IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt),
						                                              strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
				If (nInd > 4 )
					! Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
					Call SalMessageBox(' SalReportPrintToFile - ' || 
							  CurrentLangTable.GetAtomTitle('cTErrFunc') || ' '|| SalNumberToStrX(nInd,0) , 
							  CurrentLangTable.GetAtomTitle('cTAt'), 0 )
				! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
				Set frm_Out.dfPath = strPrintPath
				Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
				Call SalDestroyWindow(hWndForm)
			On SAM_ReportStart             !! приготовить SELECT
				Return SqlPrepare(cCnc.hSql(),T(ss))
				! Return SqlPrepare(hSql(),ss)
			On SAM_ReportFetchInit
				Return SqlExecute(cCnc.hSql())
			On SAM_ReportFetchNext  !! вычитать очередную строку
				If para=1
					! Return SqlFetchNext(hSql(), nFetchRes)
					!
					If SqlFetchNext(cCnc.hSql(), nFetchRes)
						! проверка на 3 знака
						Call SqlPrepareAndExecute(cCncAux.hSql(), "
								SELECT dig INTO :nDig  
								FROM tabval   
								WHERE kv = :KV" )  
						If not SqlFetchNext(cCncAux.hSql(), nFetchRes )
							Return FALSE
						Set S  = S*SalNumberPower( 10,2-nDig )
						Set SQ = SQ*SalNumberPower( 10,2-nDig )
						!
						Return TRUE
					!
				Else If para=2
					While SqlFetchNext(cCnc.hSql(), nFetchRes)
						! проверка на 3 знака
						Call SqlPrepareAndExecute(cCncAux.hSql(), "
								SELECT dig INTO :nDig
								FROM tabval
								WHERE kv = :KV")
						If not SqlFetchNext(cCncAux.hSql(), nFetchRes)
							Return FALSE
						Set S  = S*SalNumberPower( 10,2-nDig )
						Set SQ = SQ*SalNumberPower( 10,2-nDig )
						Set KOL= KOL*SalNumberPower( 10,2-nDig )
						!
						If KOL != 0
							Return TRUE
					Return FALSE
			On SAM_ReportNotify           !! информировать ОТЧЕТ о глобальных переменных
				If lParam=RPT_BeforeReportHeader and para=1 !! только для заголовка
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'AMFO', AMFO)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'AQH', AQH)
					! Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'SHAP', SHAP||' '||sd1)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'SHAP', SHAP||' '||strDateFrom)
				If lParam=RPT_BeforeBreakHeader1 and para=1
					If TIP=1
						! Set rab='ВНУТРЕННИЕ'
						Set rab = CurrentLangTable.GetAtomTitle('frm_Stat.cTRepIn')
					Else If TIP=2
						! Set rab='НАЧАЛЬНЫЕ МЕЖБАНКОВСКИЕ'
						Set rab = CurrentLangTable.GetAtomTitle('frm_Stat.cTRepNMb')
					Else If TIP=3
						! Set rab='КАССА-ПРИХОД'
						Set rab = CurrentLangTable.GetAtomTitle('frm_Stat.cTRepKP')
					Else If TIP=4
						! Set rab='КАСА-ВИДАТКИ'
						Set rab = CurrentLangTable.GetAtomTitle('frm_Stat.cTRepKR')
					Else If TIP=5
						! Set rab='ОТВЕТНЫЕ МЕЖБАНКОВСКИЕ'
						Set rab = CurrentLangTable.GetAtomTitle('frm_Stat.cTRepOMb')
					Else If TIP=6
						! Set rab='ИНВАЛЮТНЫЕ'
						Set rab = CurrentLangTable.GetAtomTitle('frm_Stat.cTRepInV')
					Else
						Set rab=''
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'MAKET',rab)
				!
				If lParam=RPT_BeforeReportHeader and para=2
					! Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'DAT',sd1)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'DAT',strDateFrom)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'aMFO',GetBankMfo())
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'aQH',GetBankName())
				If lParam=RPT_BeforeBreakHeader1 and para=2
					Call SqlPrepareAndExecute(cCncAux2.hSql(), T(
							"SELECT t.name||'  '||r.bsum||' '||t.lcv||' = '||r.rate_o
							 INTO  :sTmp  FROM cur_rates r, tabval t
							 WHERE t.kv=r.kv and r.kv=:KV and r.vdate =
							  (select MAX(vdate) FROM cur_rates WHERE kv=:KV and vdate<=  :sdat )" ))
					If SqlFetchNext(cCncAux2.hSql(), nFetchRes)
						Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'NAMV',sTmp||' '||GetBaseLcv())
			On SAM_Destroy
				If cCnc.IsConnected()
					Call cCnc.Disconnect()
				If cCncAux.IsConnected()
					Call cCncAux.Disconnect()
				If cCncAux2.IsConnected()
					Call cCncAux2.Disconnect()
				Call WaitCursorOff()
			On SAM_ReportFinish
				Call SalSendMsg( frm_Out.tblReps, UM_ReportFinish, 0, 0)
	Form Window: frm_Torg
		Class:
		Property Template:
		Class DLL Name:
		Title: Баланс банка
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.838"
				Top:    0.688"
				Width:  7.125"
				Width Editable? Yes
				Height: 3.563"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Торговая выручка
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
		Functions
		Window Parameters
			String: sdat
			String: sdat2
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			Number: nInd
			String: ss
			!
			String: NMK
			Number: SK
			Number: S
			String: ND
			String: NAZN
			Date/Time: DAT
		Message Actions
			On SAM_Create
				Call SetWindowFont(hWndForm)
				Call cCnc.Clone(g_cRepCnc, TRUE)
				Set strBind='NMK,SK,S,ND,NAZN,DAT' ! наши                                                                    ! переменные
				Set ss = T("
						SELECT trim(c.nmk)||'('|| trim(a.nls)||')',
						     o.SK, p.fdat, o.s/100, o.nd, o.nazn[1,40]
						 FROM CUSTOMER C,CUST_ACC CA,ACCOUNTS A,OPER O,OPLDOK P
						 INTO :NMK, :SK, :DAT, :S, :ND, :NAZN
						WHERE C.RNK=CA.RNK and CA.ACC=A.ACC and
						      A.NLS=O.NLSA and A.ACC=P.ACC  and
						      A.kv=o.KV AND o.kv=o.kv2 AND a.kv=980 AND
						      P.SOS=5 and P.REF=O.REF and P.DK = 1 AND
						      o.SK in (2,3) and
						      p.fdat >= :sdat  and p.fdat <= :sdat2
						      ORDER BY 1,2,3,4 ")
				Call WaitCursorOn()
				Call SalHideWindow(hWndForm)
				! Call SalReportPrintToFile(hWndForm,strDir,GetPrnDir()||'/'|| IifS(FL_FORMAT,strFileName1,strFileName),strBind,strBind,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
				! ==================================================
				! Начинаем печать в отчет
				! ==================================================
				Call SalReportPrintToFile(hWndForm, 
						                                              strTmplPath, 
						                                              strPrintPath ||'/'|| IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt),
						                                              strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
				If (nInd > 4 )
					! Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
					Call SalMessageBox(' SalReportPrintToFile - ' || 
							  CurrentLangTable.GetAtomTitle('cTErrFunc') || ' '|| SalNumberToStrX(nInd,0) , 
							  CurrentLangTable.GetAtomTitle('cTAt'), 0 )
				! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
				Set frm_Out.dfPath = strPrintPath
				Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
				Call SalDestroyWindow(hWndForm)
			On SAM_ReportStart ! приготовить SELECT
				Return SqlPrepare(cCnc.hSql(), ss)
			On SAM_ReportFetchInit
				Return SqlExecute(cCnc.hSql())
			On SAM_ReportFetchNext ! вычитать очередную строку
				Return SqlFetchNext(cCnc.hSql(), nFetchRes)
			On SAM_ReportNotify
				If lParam = RPT_BeforeReportHeader !  только для заголовка
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'AMFO',AMFO)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'AQH', AQH)
					! Set rab = SHAP||' ' || sd1||' - '||sd2
					Set rab = SHAP||' ' || strDateFrom||' - '||strDateTo
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'SHAP',rab)
			On SAM_Destroy
				! Set bFrmTorg=FALSE
				! Set dlg_OutForms.rb0=TRUE
				If cCnc.IsConnected()
					Call cCnc.Disconnect()
				Call WaitCursorOff()
			On SAM_ReportFinish
				Call SalSendMsg( frm_Out.tblReps, UM_ReportFinish, 0, 0)
	Table Window: tbl_LicSep   !! Выписки - участникам ВПС
		Class:
		Property Template:
		Class DLL Name:
		Title: Банки
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   1.413"
				Top:    0.083"
				Width:  8.067"
				Width Editable? Yes
				Height: 5.381"
				Height Editable? Yes
			Font Name: MS Sans Serif
			Font Size: 8
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
			View: Table
			Allow Row Sizing? No
			Lines Per Row: Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? No
		Description: Выписки - участникам ВПС
		Named Menus
		Menu
			Menu Item: Всех
				Resource Id: 61222
				Keyboard Accelerator: F1
				Status Text:
				Menu Settings
					Enabled when:
					Checked when:
				Menu Actions
					Set nRowType=0
					Call SalSendMsg(hWndForm, SAM_User, 0, 0)
				Menu Item Name:
			Menu Item: Выбранные
				Resource Id: 61223
				Keyboard Accelerator: (none)
				Status Text:
				Menu Settings
					Enabled when:
					Checked when:
				Menu Actions
					Set nRowType=ROW_Selected
					Call SalSendMsg(hWndForm, SAM_User, 0, 0)
				Menu Item Name:
			Menu Item: Выход
				Resource Id: 61224
				Keyboard Accelerator: F10
				Status Text:
				Menu Settings
					Enabled when:
					Checked when:
				Menu Actions
					Call SalSetFocus(hWndLicParent)
					Call SalDestroyWindow(tbl_LicSep)
				Menu Item Name:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Bottom
				Visible? No
				Size: 0.4"
				Size Editable? Yes
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Column: mfo
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МФО
				Visible? Yes
				Editable? No
				Maximum Data Length: 9
				Data Type: String
				Justify: Right
				Width:  0.967"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sab
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
				Visible? Yes
				Editable? No
				Maximum Data Length: 4
				Data Type: String
				Justify: Center
				Width:  0.643"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nb
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование банка
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  5.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: MIK
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					! Set strFileName = '@_' || sab ||
							    Sep98md( SalDateConstruct  (  SalStrToNumber(SalStrRightX(sdat, 4)), 
							                                                             SalStrToNumber(SalStrLeftX(sdat, 2)), 
							                                                             SalStrToNumber( SalStrMidX(sdat, 3, 2)), 
							                                                             0, 0, 0)
							                      ) || '.L00'
					Set strFileNameTxt = '@_' || sab ||
							    Sep98md( SalDateConstruct  (  SalStrToNumber(SalStrRightX(sdat, 4)), 
							                                                             SalStrToNumber(SalStrLeftX(sdat, 2)), 
							                                                             SalStrToNumber( SalStrMidX(sdat, 3, 2)), 
							                                                             0, 0, 0)
							                      ) || '.L00'
					Call WaitCursorOn()
					! ==================================================
					! Начинаем печать в отчет
					! ==================================================
					Call SalReportPrintToFile(hWndForm, 
							                                              strTmplPath, 
							                                              strPrintPath ||'/'|| IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt),
							                                              strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
					If (nInd > 4 )
						Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
								
					! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
					Set frm_Out.dfPath = strPrintPath
					Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
					If not FL_FORMAT
						! Call zarez12(GetPrnDir() || '\\' || strFileName, frm_Out.tbl1.Kod,
								     frm_Out.tbl1.sDeviceDef)
						Call zarez12Del( strPrintPath  || '\\' || strFileNameTxt, frm_Out.tblReps.Kod, sDeviceDef, bDelOnNull)
					Call WaitCursorOff()
			! Function: to32x
				                                                                              Description:
				                                                                              Returns
					                                                                              String:
				                                                                              Parameters
					                                                                              Number: n1
				                                                                              Static Variables
				                                                                              Local variables
					                                                                              String: s1
					                                                                              Number: n2
				                                                                              Actions
					                                                                              Set s1=''
					                                                                              While n1>=36
						                                                                              Set n2=SalNumberMod(n1, 36)
						                                                                              Set n1=(n1-SalNumberMod(n1, 36))/36
						                                                                              If n2<10
							                                                                              Set n2=n2+48
						                                                                              Else
							                                                                              Set n2=n2+55
						                                                                              Set s1=SalNumberToChar( n2)||s1
					                                                                              Set s1=s1||SalStrRepeatX( '0', 12)
					                                                                              Return SalStrLeftX(s1,8) || '.' || SalStrMidX( s1, 9,3)
		Window Parameters
			String: sdat
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			: cCncAux
				Class: cABSConnect
			String: sKv
			Number: nIsp
			Number: nNls
			Number: nDk
			Number: nS
			Number: nOstf
			Date/Time: dtPdat
			String: sNms
			Number: nRef
			String: sText
			String: sTt
			String: strBankMfo
			Number: nRow
			String: strBankName
			!
			Number: nKv
			Number: nNlsk
			Number: nDos
			Number: nKos
			Date/Time: dtFdat
			Number: nAcc
			Number: nVob
			Number: nMfo
			Number: nMfoB
			String: sNd
			String: sNda
			String: sNdb
			String: sSql
			String: sIsp
			String: sNls
			Number: nInd
			String: sNd1
			String: sMfo1
			String: sNamk1
			String: lmfo
		Message Actions
			On SAM_Create
				Call SalCenterWindow(hWndForm)
				Call SetWindowFont(hWndForm)
				!
				Call cCnc.Clone(g_cRepCnc, TRUE)
				Call cCncAux.Clone(cCnc, TRUE)
				Set strBankMfo=GetBankMfo()
				! Set bTblLicSep = TRUE
				!
				Set strBind='sKv,nIsp,nNls,nDos,nKos,sText,sTt'
				Set strInput='KV,ISP,NLS,DOS,KOS,TEXT,TT'
				Set sSql=
						T("SELECT UNIQUE t.lcv,c.isp,c.nls,o.dk,o.s,a.ostf,a.pdat,c.nms, o.ref,o.txt, o.tt
						 INTO  :sKv,  :nIsp,:nNls,:nDk,:nS,:nOstf,:dtPdat,:sNms,:nRef,:sText,:sTt
						FROM opldok o,saldoa a,accounts c,bank_acc k,tabval t,
						OUTER zag_a za,OUTER zag_b zb
						where  c.kv=t.kv and o.acc=a.acc  and o.acc=c.acc and  o.acc=k.acc and
						o.sos=5 and  k.mfo=:lmfo and
						((c.tip='TUR' or c.tip='TUD') and a.dos<>a.kos or c.tip = 'L00') and
						   o.fdat=a.fdat and a.fdat=:sdat  and o.ref=za.ref (+) and o.ref=zb.ref (+)
						order by 1,2,3,4,5")
				Call WaitCursorOn()
				Call SalTblPopulate(hWndForm, cCnc.hSql(),T("
						SELECT mfo, sab, nb FROM Banks
						 WHERE mfop=:strBankMfo AND (kodn=0 OR kodn=4 OR kodn=6)
						 INTO  :tbl_LicSep.mfo, :tbl_LicSep.sab, :tbl_LicSep.nb"), TBL_FillAll)
				Call WaitCursorOff()
			On SAM_User
				Call WaitCursorOn()
				Set nRow=TBL_MinRow
				Loop
					If SalTblFindNextRow(hWndForm, nRow, nRowType, 0)
						Call SalTblFetchRow(hWndForm, nRow)
						Call SalStatusSetText(hWndForm, sab)
						Call MIK()
					Else
						Break
				Call WaitCursorOff()
				Call SalStatusSetText(hWndForm, 'Готово')
			! On SAM_Destroy
				                                                                              Set bTblLicSep = FALSE
			On SAM_ReportStart
				Set lmfo=tbl_LicSep.mfo
				Return SqlPrepare(cCncAux.hSql(), sSql)
			On SAM_ReportFetchInit
				Return SqlExecute(cCncAux.hSql())
			On SAM_ReportFetchNext
				If SqlFetchNext(cCncAux.hSql(), nFetchRes)
					Set nOstf=nOstf/100
					If nDk=0
						Set nDos=nS/100
						Set nKos=0
					Else
						Set nDos=0
						Set nKos=nS/100
					Set sText=SalStrLeftX( sText,12 )||SalStrRightX( SalStrRepeatX( ' ',18)|| SalNumberToStrX( nRef, 0),18)
					Return TRUE
				Return FALSE
			On SAM_ReportNotify
				If lParam=RPT_BeforeBreakHeader2
					Call SalReportSetStringVar( SalNumberToWindowHandle( wParam), 'aMFO', GetBankMfo() )
					Call SalReportSetStringVar( SalNumberToWindowHandle( wParam ), 'aQH', GetBankName())
				If lParam=RPT_BeforeBreakHeader3
					Call SalReportSetNumberVar( SalNumberToWindowHandle( wParam ), 'ACC', nAcc )
					Call SalReportSetNumberVar( SalNumberToWindowHandle( wParam ), 'OSTF', nOstf )
					Call SalReportSetStringVar( SalNumberToWindowHandle( wParam ), 'NMS', sNms )
					Call SalReportSetDateTimeVar( SalNumberToWindowHandle( wParam ), 'FDAT', dtFdat )
					Call SalReportSetDateTimeVar( SalNumberToWindowHandle( wParam ), 'PDAT', dtPdat )
					Call SalReportSetStringVar(SalNumberToWindowHandle( wParam ), 'DETAIL', "Iм'я  файлу         Референцiя" )
			On SAM_ReportFinish
				Call SalSendMsg( frm_Out.tblReps, UM_ReportFinish, 0, 0)
			On SAM_Destroy
				If cCnc.IsConnected()
					Call cCnc.Disconnect()
				If cCncAux.IsConnected()
					Call cCncAux.Disconnect()
	Form Window: frm_LicAcc    !! Особовi рахунки
		Class:
		Property Template:
		Class DLL Name:
		Title: Лицевые счета
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.838"
				Top:    0.688"
				Width:  10.933"
				Width Editable? Yes
				Height: 5.702"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Особовi рахунки
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Child Table: tbl1 !! исполнители или валюты
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.067"
						Top:    0.048"
						Width:  9.65"
						Width Editable? Yes
						Height: 4.5"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Blue
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 3000
					Discardable? No
				Contents
					Column: id
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: № п.п.
						Visible? No
						Editable? Yes
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  0.629"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: Kod1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: Код
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: Number
						Justify: Left
						Width:  1.014"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NAME1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class:
						Property Template:
						Class DLL Name:
						Title: НАИМЕНОВАНИЕ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  6.786"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
						If para=24 or  para=26
							Call SalTblPopulate (tbl1, cCnc.hSql(), 
									     " SELECT id, rnk, nmk INTO :tbl1.id,:tbl1.Kod1,:tbl1.NAME1 
									       FROM corp_rnk", TBL_FillAll )
							Call SalShowWindow(tbl1.id)
						Else
							Call SalHideWindow(tbl1.id)
							If sXXX = "K" OR sXXX = "k"
								Call SalTblPopulate(tbl1, cCnc.hSql(),
										"SELECT rnk,nmk  INTO :tbl1.Kod1, :tbl1.NAME1 FROM customer WHERE stmt=3 order by 1"  , TBL_FillAll)
								! Call SalSetWindowText ( frm_LicAcc,"Клиенты"  )
								Call SalSetWindowText ( frm_LicAcc, CurrentLangTable.GetAtomTitle('frm_LicAcc.cTWndTitle2') )
							Else
								! Call Debug("SELECT " || IifS(nOpt =0," id,fio FROM staff  WHERE type=1",
										   "kv,name FROM tabval " )  || " order by 1" )
								Call SalTblPopulate(tbl1, cCnc.hSql(),
										 " SELECT INTO :tbl1.Kod1, :tbl1.NAME1 " || 
										   IifS(nOpt =0, " id,fio FROM staff WHERE type=1",  " kv,name FROM tabval ")||
										 " order by 1"  , TBL_FillAll)
					On SAM_DoubleClick
						Call FU_SAL(tbl1.Kod1)
						Call SalSetFocus(tbl1)
					On SAM_User
						Set nRow=TBL_MinRow
						Loop
							If SalTblFindNextRow (  tbl1, nRow, nTmp, 0 )
								Call SalTblSetContext( tbl1,nRow )
								If nRow >=0
									! Для выписки НБУ создаем файл если есть данные
									If para=201 
										If SqlPrepareAndExecute(cCnc.hSql(),
												"select acc from tmp_lic where
												acc in (SELECT acc FROM cust_acc WHERE rnk=:tbl1.Kod1)
												and ID=:ID") and SqlFetchNext(cCnc.hSql(), nFetchRes ) 
											Call FU_SAL(tbl1.Kod1)
									Else
										Call FU_SAL(tbl1.Kod1) 
							Else
								Break
						Call SalSendMsg( tbl1, SAM_Create, 0, 0 )
			Pushbutton: PB1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Печать выбранных
				Window Location and Size
					Left:   3.583"
					Top:    4.655"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Midnight Blue
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nTmp=ROW_Selected
						Call SalSendMsg( tbl1, SAM_User, 0, 0 )
			Pushbutton: PB2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Печать ВСЕХ
				Window Location and Size
					Left:   0.983"
					Top:    4.655"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Midnight Blue
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nTmp=0
						Call SalSendMsg( tbl1, SAM_User, 0, 0 )
			Pushbutton: PB3 !! завершить
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Завершить
				Window Location and Size
					Left:   6.183"
					Top:    4.655"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Black
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalDestroyWindow( frm_LicAcc )
		Functions
			! Function: to32x
				                                                                  Description:
				                                                                  Returns
					                                                                  String:
				                                                                  Parameters
					                                                                  Number: n1
				                                                                  Static Variables
				                                                                  Local variables
					                                                                  String: s1
					                                                                  Number: n2
				                                                                  Actions
					                                                                  Set s1=''
					                                                                  While n1>=36
						                                                                  Set n2=SalNumberMod(n1, 36 )
						                                                                  Set n1=(n1-SalNumberMod(n1, 36 ))/36
						                                                                  If n2<10
							                                                                  Set n2=n2+48
						                                                                  Else
							                                                                  Set n2=n2+55
						                                                                  Set s1 = SalNumberToChar(n2) || s1
					                                                                  Set s1=s1||SalStrRepeatX('0', 12)
					                                                                  Return SalStrLeftX(s1,8) || '.' || SalStrMidX(s1, 9,3)
			Function: FU_SAL
				Description: Печать ЛС по ОДНОМУ
				Returns
				Parameters
					Number: nP11
				Static Variables
				Local variables
					Number: Rnk
					Number: H2
					Number: i
					Number: nTmp
					String: Sab3
					Long String: sSql
					File Handle: hFileIn
					Long String: sFileLine
				Actions
					! Call Debug(' IN FU_SAL')
					Call SalWaitCursor(TRUE)
					Set strFileNameTxt = SalStrLeftX(strFileNameTxt, 5) ||  NumberToStrFormat( nP11, 3, '0',TRUE) || '.txt'
					! Выписки по корпоративным клиентам
					!
					If para=24 or para=26
						If para=24
							Set sSql=  " SELECT decode( crd_pere, 0,
									              '0'||lpadchr(nls, '0',14)||
									              to_char(fdat,'YYYYMMDD')||
									              to_char(dapp,'YYYYMMDD')||
									              lpadchr(to_char( sign(ostf)*ostf),' ',19)||
									              decode(sign(ostf),-1, '-','+')||
									              lpad(to_char(bis),6)||lpad(to_char(dosq),19)||
									              lpad(to_char(s),6)||lpad(to_char(kosq),19)||
									              lpad(to_char( sign(ostf+kosq-dosq)*(ostf+kosq-dosq)),19)||
									              decode(sign(ostf+kosq-dosq),-1, '-','+'),
									           decode( sign(s),0,'2','1')||decode( sign(s), -1, '-',0, '7','+')
									           ||lpadchr(to_char(vob), '0', 9)
									           ||lpadchr(nlsalt,'0',14)
									           ||lpadchr( nvl(nlskalt,'              '),'0',14)
									           ||rpad(nmk2,40)
									           ||lpadchr(mfo,'0',9)
									           ||lpadchr(nlsk,'0' ,14)
									           ||lpadchr(nvl(okpo,'              '),'0',14)
									           ||rpad(namk,40)
									           ||'01'
									           ||rpadchr(nvl(nd,' '),'?',10)   
									           ||lpad(to_char((sign(s))*s),19)
									           ||to_char(dapp,'YYYYMMDDHH24MI') 
									           ||nvl( to_char(datp,'YYYYMMDDHH24MI'), '            ') )
									           ||rpad(nazn,254) 
									INTO :sFileLine          
									FROM tmp_lic WHERE id=user_id 
									ORDER BY fdat,  decode(crd_pere, 0, nls, decode(sign(s), -1,nls, nlsk )) desc, crd_pere "
							Set strFileNameTxt='v'||SalStrRightX(sFdat,2)||SalStrMidX(sFdat,3,2)||SalStrLeftX(sFdat,2)||'.ZZZ'
							If sFdat!=sFdat2
								Set strFileNameTxt='v'||SalStrRightX(sFdat,2)||SalStrMidX(sFdat,3,2)||SalStrLeftX(sFdat,2)||'.'||
										              GetCharForDigit(SalDateHour(SalDateCurrent()))|| 
										              NumberToStrFormatX(SalDateMinute ( SalDateCurrent() ),2,'0','R')
						Else
							Set sSql="  SELECT 
									decode(bis,
									  0, '0|'||lpadchr(mfo,'0',9)||'|'||lpadchr(nls,'0',14)||'|'||kv||
									    '|'||rpadchr(nvl(okpo,' '),' ',14)||'|'||lpadchr(dosq,'0',14)||'|'||lpadchr(dospq,'0',14)||
									    '|'||lpadchr(kosq,'0',14)||'|'||lpadchr(kospq,'0',14)||
									    '|'||lpadchr(ostf,'0',14)||'|'||lpadchr(ostpf,'0',14)||'|'||
									    rpadchr('0','0',60)||'|'||rpadchr(' ',' ',60)||'|'||rpadchr(' ',' ',60)||'|'||
									    rpadchr(' ',' ',60)||'|'||rpadchr(' ',' ',60)||'|      |      |      |          |00| |000000000|'||
									    rpadchr('0','0',14)||'|000|'||rpadchr(' ',' ',38)||'|'||rpadchr(' ',' ',14)||
									    '|000000000|00000000000000|000|'||rpadchr(' ',' ',38)||'|'||rpadchr(' ',' ',14)||'|'||
									    '0000000000000000|000|0000000000000000|'||rpadchr(' ',' ',160)||'|'||
									    rpadchr('0','0',60)||'|'||rpadchr(' ',' ',60)||'|'||rpadchr(' ',' ',60)||'|'||rpadchr(' ',' ',60)||'|'||
									    rpadchr(' ',' ',60)||'|',
									 1, '1|000000000|00000000000000|000|              |00000000000000|00000000000000|00000000000000|00000000000000|00000000000000|00000000000000|'||
									    rpadchr('0','0',60)||'|'||rpadchr(' ',' ',60)||'|'||rpadchr(' ',' ',60)||'|'||rpadchr(' ',' ',60)||'|'||rpadchr(' ',' ',60)||
									    '|'||to_char(datp,'YYMMDD')||'|'||nvl(to_char(datd,'YYMMDD'),'      ')||'|'||nvl(to_char(vdat,'YYMMDD'),'      ')||
									    '|'||rpadchr(nd,' ',10)||'|'||rpadchr(isp,'0',2)||'|'||decode(sign(s), -1, '0', 1, '1', '2')||
									    '|'||lpadchr(vob,'0',9)||'|'||lpadchr(nls,'0',14)||'|'||kv||'|'||rpadchr(nmk2,' ',38)||'|'||rpadchr(nvl(nlskalt,' '),' ',14)||
									    '|'||lpadchr(mfo,'0',9)||'|'||lpadchr(nlsk,'0',14)||'|'||kv||'|'||rpadchr(namk,' ',38)||'|'||rpadchr(nvl(okpo,' '),' ',14)||
									    '|'||lpadchr(sign(s)*s,'0',16)||'|'||kv||'|'||lpadchr( sign(ostfq)*ostfq,'0',16)||'|'||rpadchr( nvl(nazn,' '),' ',160)||'|'||
									    rpadchr('0','0',60)||'|'||rpadchr(' ',' ',60)||'|'||rpadchr(' ',' ',60)||'|'||rpadchr(' ',' ',60)||'|'||
									    rpadchr(' ',' ',60)||'|', 
									 '2|         |'||lpadchr(isp,'0',14)||'|'||'000|              |00000000000000|00000000000000|00000000000000|00000000000000|00000000000000|00000000000000|'||
									    rpadchr('0','0',60)||'|'||rpadchr(' ',' ',60)||'|'||rpadchr(' ',' ',60)||'|'||rpadchr(' ',' ',60)||'|'||rpadchr(' ',' ',60)||
									   '|      |      |      |          |00| |000000000|'||
									   rpadchr('0','0',14)||'|000|'||rpadchr(' ',' ',38)||'|'||rpadchr(' ',' ',14)||
									   '|000000000|00000000000000|000|'||rpadchr(' ',' ',38)||'|'||rpadchr(' ',' ',14)||'|'||
									   '0000000000000000|000|0000000000000000|'||rpadchr(' ',' ',160)||'|'||
									   rpadchr('0','0',60)||'|'||rpadchr(' ',' ',60)||'|'||rpadchr(' ',' ',60)||'|'||rpadchr(' ',' ',60)||'|'||
									   rpadchr(' ',' ',60)||'|' )
									INTO :sFileLine     
									from tmp_lic  
									order by fdat,  decode(bis, 0, nls, decode(sign(s), -1,nls, nlsk )) desc, bis "
							If SqlPrepareAndExecute(cCnc.hSql(), 
									     T(" SELECT sab INTO :strFileNameTxt FROM banks WHERE mfo=f_ourmfo"))
								While SqlFetchNext(cCnc.hSql(), i)
							Set strFileNameTxt='T'||strFileNameTxt||GetCharForDigit(SalStrToNumber(SalStrRightX(sFdat,2)))||
									                     GetCharForDigit(SalStrToNumber(SalStrMidX(sFdat,3,2)))||
									                     GetCharForDigit(SalStrToNumber(SalStrLeftX(sFdat,2)))||'.'||
									                     StrToStrFormat(SalNumberToStrX(tbl1.id,0),2,'0', TRUE)||'?'
							Set strFileNameTxt=SalStrLeftX(strFileNameTxt, SalStrLength(strFileNameTxt)-1)||
									                   GetNextFileSess(strFileNameTxt,1,1)
						If not  SalFileOpen ( hFileIn,strPrintPath||'\\'||strFileNameTxt, OF_Write )
							! Call SalMessageBox(' Невозможно открыть для записи файл '|| strPrintPath||'\\'||strFileNameTxt, 'Внимание!',0)
							Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_LicAcc.cTMsgFileNotOpen') || ' ' || strPrintPath||'\\'||strFileNameTxt, 'Внимание!',0)
							Call SalWaitCursor (FALSE )
							Return -1
						Else
							If not Podgot_LICS(ID, sFdat, sFdat2, SalNumberToStrX(nP11,0), para)   !! накопление  во временные таблицы
								! Call SalMessageBox('Не выполнена процедура P_LIC'||SalNumberToStrX(para,0), 'Ошибка', MB_IconStop)
								Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_LicAcc.cTMsgProcNotExec') || ' P_LIC'||SalNumberToStrX(para,0), 'Ошибка', MB_IconStop)
								Return -1 
							If SqlPrepareAndExecute(cCnc.hSql(), T(sSql) )
								Set nTmp=0
								Set i=0
								While SqlFetchNext(cCnc.hSql(), i)
									Call SalFilePutStr( hFileIn,  sFileLine )
									Set nTmp=nTmp+1
							If not SalFileClose ( hFileIn )
								! Call SalMessageBox(' Невозможно закрыть файл '||strPrintPath||'\\'||strFileNameTxt, 'Внимание!',0)
								Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_LicAcc.cTMsgFileNotClose') || ' '||strPrintPath||'\\'||strFileNameTxt, 'Внимание!',0)
								Call SalWaitCursor (FALSE )
								Return -1
							! -- если данных нету - удалить файл
							If ( nTmp=0 and VisFileFind(strPrintPath||'/'||strFileNameTxt))
								If VisFileDelete (strPrintPath||'\\'||strFileNameTxt) < 0
									! Call SalMessageBox('Не могу удалить файл нулевой длинны - '||strPrintPath||'\\'||strFileNameTxt,'Внимание',0)
									Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_LicAcc.cTMsgFileNotDel') || ' - '||strPrintPath||'\\'||strFileNameTxt,'Внимание',0)
									Call SalWaitCursor ( FALSE )
									Return -1
							!
						! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
						Set frm_Out.dfPath = strPrintPath
						Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
						Return -1
					!
					!
					Set RNK1 = -1
					Set ISP1 = -1
					Set KV = -1
					If sXXX = "k" or sXXX = "K"
						If sXXX = "k"
							Set Rnk=Val(Subs(maska,2,8))
						Else
							Set Rnk=tbl1.Kod1
						If SqlPrepareAndExecute(cCnc.hSql(),
								 "SELECT substr(sab ,1,4) INTO :Sab3 FROM customer
								  WHERE rnk=:Rnk AND stmt=3" )
								and SqlFetchNext(cCnc.hSql(), nFetchRes )
							If fNBU !! лицевые счета в файл для НБУ
								Set H2=SalDateHour (SalDateCurrent())
								Set H2=H2 + IifN(H2<10, 48, 55)
								! ***   Выписка для НБУ - имя файла   *** 
								! их SAB + наш SAB + '.l' +день 
								! Set strFileNameTxt= Sab3||GetBankSab()||'.l'||
										       SalStrRightX(SalNumberToStrX((SalDateDay(SalDateCurrent ())+100),0),2)
								Set strFileNameTxt= Sab3||GetBankSab()||'.l'||
										       SalStrMidX(sFdat,3,2)
								! ***********************************
							Else
								Set H2=SalDateHour (SalDateCurrent())
								Set H2=H2 + IifN(H2<10, 48, 55)
								If GetBankMfo()='300465'
									! Эксклюзивно для ОЩАДБАНКА (Иван) 
									Set strFileNameTxt='LS' || IifS(para=1, '$', '^') || SalStrRightX( Sab3, 3 ) ||
											Sep98md(SalDateCurrent()) || '.' ||
											SalNumberToChar( H2 ) ||
											SalStrRightX(
											'00' || SalNumberToStrX( SalDateMinute( SalDateCurrent() ),0),
											2 )
								Else
									Set strFileNameTxt='LS' || IifS(para=1, '$', '^') || Sab3 ||
											Sep98md(SalDateCurrent()) || '.' ||
											SalNumberToChar( H2 ) ||
											SalStrRightX(
											'00' || SalNumberToStrX( SalDateMinute( SalDateCurrent() ),0),
											2 )
					! ==================================================
					! Начинаем печать в отчет
					! ==================================================
					Call SalReportPrintToFile(hWndForm, 
							            strTmplPath, 
							            strPrintPath ||'/'|| IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt),
							            strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
					If (nInd > 4 )
						! Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
						Call SalMessageBox(' SalReportPrintToFile - ' || 
								  CurrentLangTable.GetAtomTitle('cTErrFunc') || ' '|| SalNumberToStrX(nInd,0) ,
								  CurrentLangTable.GetAtomTitle('cTAt'), 0 )
					! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
					Set frm_Out.dfPath = strPrintPath
					Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
					If not FL_FORMAT
						! Call zarez12(GetPrnDir() || '\\' || strFileName,frm_Out.tbl1.Kod,frm_Out.tbl1.sDeviceDef)
						Call zarez12Del(  strPrintPath ||'/'|| strFileNameTxt, frm_Out.tblReps.Kod, sDeviceDef, bDelOnNull)
					! Call Debug(' AT THE END OF FU_SAL')
					Call SalWaitCursor(FALSE)
			Function: GetNextFileSess
				Description: Дает новое расширение (сеанс файла)
				Returns
					String:
				Parameters
					String: strFileName
					Number: nValLen
					Number: nStart
				Static Variables
				Local variables
					String: strRet
					String: strTmp
					Number: nTmp
					String: strFileList[*]
					Number: i
					Number: nFiles
					Number: nMaxNum
					Number: nStartPos
				Actions
					Set nFiles=VisDosEnumFiles( strPrintPath || '\\' || strFileName, FA_Standard, strFileList)
					If nFiles < 0
						Return StrToStrFormat(SalNumberToStrX(nStart,0), nValLen,'0',TRUE)
					Set i=1
					Set strTmp='?'
					While i<nValLen
						Set strTmp = strTmp||'?'
						Set i=i+1
					Set nMaxNum=0
					Set i=0
					Set nStartPos=SalStrScan(strFileName, strTmp)
					While i <= nFiles -1
						Set nTmp = SalStrToNumber(    SalStrMidX(strFileList[i],  nStartPos, nValLen  ) )
						If (  nTmp > nMaxNum )
							Set nMaxNum =nTmp
						Set i=i+1
					Return StrToStrFormat(SalNumberToStrX(nMaxNum+1,0), nValLen,'0', TRUE)
			Function: StrToDateX
				Description:
				Returns
					Date/Time:
				Parameters
					String: sDate
					String: sFormat
				Static Variables
				Local variables
					Date/Time: Result
					: cCnc1
						Class: cABSConnect
					Number: nFetchRes
				Actions
					Set Result=DATETIME_Null
					! Call XConnectGetParams( cCnc )
					If cCnc1.Clone(cCnc, TRUE)
						If SqlPrepareAndExecute( cCnc1.hSql(),
								"SELECT TO_DATE('" || sDate || "','" || sFormat || "')
								 INTO :Result
								 FROM dual ")
							Call SqlFetchNext(cCnc1.hSql(), nFetchRes)
						Call cCnc1.Disconnect()
					Return Result
			Function: DateToStrX
				Description:
				Returns
					String:
				Parameters
					Date/Time: dDate
					String: sFormat
				Static Variables
				Local variables
					String: Result
				Actions
					Call SalFmtFormatDateTime( dDate, Result )
					Return Result
			Function: StrToStrFormat
				Description: !! Превращает строку в строку заданной длины (nLen) - дополняя впереди символом
				Returns
					String: strVal
				Parameters
					String: sVal
					Number: nLen
					String: strChar
					Boolean: bAlign ! - -  true = right,   false = left
				Static Variables
				Local variables
					Number: i
					String: strRet
				Actions
					Set i=SalStrLength(sVal)
					Set strRet = sVal
					While i < nLen
						If bAlign
							Set strRet = strChar||strRet
						Else
							Set strRet =strRet|| strChar
						Set i=i+1
					Return strRet
		Window Parameters
			Number: ID      !! пользователь
			Number: nOpt    !! =0 - сортировать по исп, =2 - сортировать по счетам
			String: sFdat   !! С даты
			String: sFdat2  !! По дату
			String: sXX     !! ='8' для ВКлючения 8, #'8' для ИСКлючения
			Number: nP1     !! исполнитель (0-все)
			Number: nXX     !! 1 cо всеми переоценками
			String: sXXX    !! "k"  - ПО КЛИЕНТУ, иначе - по маске счета
			Number: para
			Number: nSpace
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			: cCncAux
				Class: cABSConnect
			!
			String: sSql
			String: sSqlW
			String: sSqlR
			String: sSqlS
			String: sSqlT
			String: sSqlK
			String: sIsp
			String: oIsp
			Number: nRow
			Number: nTmp
			String: NLS
			String: NAMV
			String: NMS
			String: NMK
			String: ND
			String: MFO
			String: NLSK
			String: NAMK
			String: NLSALT
			String: NLSKALT
			String: NAZN
			String: TT
			String: ISO
			String: MF
			String: NB
			String: OKPO
			Date/Time: FDAT
			Date/Time: DAPP
			Date/Time: DATD
			Number: ISP
			Number: ISP1
			Number: RNK
			Number: RNK1
			Number: KV
			Number: KV1
			Number: ACC
			Number: WD
			Number: USI
			Number: REF
			Number: SK
			Number: VOB
			Number: BIS
			Number: OSTF
			Number: OSTF1
			Number: S
			Number: SQ
			Number: SQV
			Number: SQY
			Number: SQY1
			Number: OBD
			Number: OBK
			Number: OBDQ
			Number: OBKQ
			String: PROB
			String: PROB3
			String: FIO
			String: maska
			String: maska2
			Number: nrab
			String: sTmp2
			Date/Time: dTmp2
			Number: OBD_P
			Number: OBK_P
			Number: OST_P
			Number: OBDQ_P
			Number: OBKQ_P
			Number: OSTQ_P
			Number: nDig
			Number: DIG
			Boolean: fNBU
		Message Actions
			On SAM_Create
				Call SalCenterWindow(hWndItem)
				Call SetWindowFont(hWndForm)
				Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
				Call SalSetWindowText( hWndForm, CurrentLangTable.GetAtomTitle('frm_LicAcc.cTWndTitle') )
				Call cCnc.Clone(g_cRepCnc, TRUE)
				Call cCncAux.Clone(cCnc, TRUE)
				Set PROB3=Spac(nSpace)
				! Set fNBU=SqlFetchNext( hSql(), nFetchRes )
				If SqlPrepareAndExecute(cCnc.hSql(), "SELECT isnbubank() INTO :fNBU FROM dual ")
					Call SqlFetchNext(cCnc.hSql(), nFetchRes)
				!
				! Выписка для корпоративных клиентов (ANNY)
				If para=24 or para=26
					Call SalShowWindow(tbl1)
				!
				Else
					If SqlPrepareAndExecute(cCnc.hSql(),
							 "SELECT val FROM params
							  WHERE par='NBUBANK' and val='1'" )
					Call SalHideWindow(tbl1)
					Call SalStrRepeatX( ' ', nSpace)
					Call SalHideWindow(PB1)
					Call SalHideWindow(PB3)
					Set nrab = SalStrLength(sXX)
					Set sSqlW = "
							    FROM tmp_lic
							    WHERE " || IifS(nrab=0, "", "substr(nls,1,1)<>:sXX and ")
					If para = 12 !! отчет для ПИКРИИ
						Call SalModalDialog(dlg_mas2, hWndForm, maska, maska2)
						If maska = '-'
							Call SalDestroyWindow(hWndForm)
							Return TRUE
						Call SalWaitCursor(TRUE)
						If not Podgot_LICS(ID, sFdat, sFdat2, maska, 1) !! накопление  во временные таблицы
							! Call SalMessageBox('Не выполнена процедура P_LIC' || SalNumberToStrX(para, 0), 'Ошибка', MB_IconStop)
							Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_LicAcc.cTMsgProcNotExec') || ' P_LIC' || SalNumberToStrX(para, 0), 'Ошибка', MB_IconStop)
						Else
							Set strBind = 'NLS,KV,ISO,FDAT,S,SQ,ND,NLSK,REF,NAZN'
							Set strInput = strBind
							Set sSql = "
									    SELECT l.nls,l.kv,l.fdat,l.s/100,
									           gl.p_icurval(l.kv,l.s,l.fdat)/100,l.nd,l.nlsk,
									           l.ref,l.nazn,t.lcv
									    INTO :NLS,:KV,:FDAT,:S,:SQ,:ND,:NLSK,:REF,:NAZN,:ISO
									    FROM tmp_lic l, tabval t
									    WHERE l.kv=t.kv and l.s<0 and
									          ltrim(rtrim(l.nlsk)) LIKE \'" ||
									          SalStrTrimX(maska2) || "\' and
									          ltrim(rtrim(l.nls))  LIKE \'" ||
									          SalStrTrimX(maska) || "\'
									    ORDER BY l.kv,l.fdat,l.ref "
							Call FU_SAL(1)
						Call SalDestroyWindow(frm_LicAcc)
						Return TRUE
					!
					If sXXX = "k"
						! Set maska='@' || Maska_NLS("Рег.№ КЛИЕНТА ")
						Set maska='@' || Maska_NLS(CurrentLangTable.GetAtomTitle('cTSelectRNK'))
					Else If sXXX = "K" 
						If para = 201
							Set maska =StrMatches2Like('*')
						Else
							! Set maska = Maska_NLS("счетов") 
							Set maska = Maska_NLS(CurrentLangTable.GetAtomTitle('cTSelectAcc'))
					Else
						! Set maska=Maska_NLS("счетов")
						Set maska=Maska_NLS(CurrentLangTable.GetAtomTitle('cTSelectAcc'))
					If maska = '-'
						Call SalDestroyWindow(frm_LicAcc)
						Return TRUE
					! *** Ветка для обработки отчета входящих документов
					If para = 21
						Set MF=GetBankMfo()
						Set sSqlW="
								 FROM arc_rrp a, banks b, accounts c
								 WHERE a.mfob=:MF and  a.dk in (1,3)  and
								       a.dat_a BETWEEN TO_DATE('" || sFdat  || "','MM-DD-YYYY') and
								                       TO_DATE('" || sFdat2 || "','MM-DD-YYYY') + 0.9999 and
								       a.mfoa=b.mfo " ||
								       IifS(maska !='*'," AND trim(a.nlsb) LIKE \'"||SalStrTrimX(maska)||"\'",'')||"
								       and a.nlsb=c.nls and a.kv=c.kv  "
					Else
						Call SalWaitCursor( TRUE )
						! Call Debug('Podgot_LICS(ID,sFdat,sFdat2,'||maska||','||SalNumberToStrX(para,0))
						! Call Debug('Before podot lic')
						If not Podgot_LICS(ID,sFdat,sFdat2, maska,
								   IifN(para=1 and nXX=1,11, para) ) !!  накопление  во временные таблицы
							! Call SalMessageBox( 'Не выполнена процедура P_LIC'||SalNumberToStrX(para,0), 'Ошибка', MB_IconStop )
							! Call SalMessageBox( 'Не выполнена процедура P_LIC'|| Str(IifN(para=1 and nXX=1,11, para) ), 'Ошибка', MB_IconStop )
							Call SalMessageBox( CurrentLangTable.GetAtomTitle('frm_LicAcc.cTMsgProcNotExec') || ' P_LIC'|| Str(IifN(para=1 and nXX=1,11, para) ), 'Ошибка', MB_IconStop )
							Call SalDestroyWindow(frm_LicAcc)
							Return TRUE
						! Call Debug('After podot lic')
						If para=2
							Set para=0
						Call SalWaitCursor( FALSE )
					! ***
					Set sSqlS= T("SELECT fio INTO :FIO FROM staff WHERE id = :ISP " )
					Set sSqlT= T("SELECT lcv,name INTO :ISO,:NAMV FROM tabval WHERE kv=:KV")
					Set sSqlR= T("SELECT r.nmk,r.rnk INTO :NMK,:RNK FROM customer r,cust_acc ra WHERE ra.acc=:ACC and ra.rnk=r.rnk ")
					Set strBind='ACC,NLS,KV,ISO,FDAT,S,ND,MFO,NLSK,NAMK,USI,REF,
							             RNK,NAZN,OSTF,TT,DAPP,SK'
					!
					If para=0    !!   ГРН
						Set sSql="
								 SELECT isp,nls,kv,nms,acc,fdat,wd,s/100,nd,mfo,nlsk,
								        namk,userid,ref,sk,nazn,tt,ostf/100,dapp
								  INTO :ISP,:NLS,:KV,:NMS,:ACC,:FDAT,:WD,:S,:ND,:MFO,:NLSK,
								       :NAMK,:USI,:REF,:SK,:NAZN,:TT,:OSTF,:DAPP  "
					If para=1    !!   ВАЛ
						If GetBankMfo()='220101107'
							Set strBind=
									'ACC,NLS,KV,ISO,FDAT,S,SQ,ND,NLSK,NAMK,USI,REF,RNK,NAZN,OSTF,SQV,SQY,TT,DAPP,NLSALT,NLSKALT'
							Set sSql="
									 SELECT isp,nls,kv,nms,acc,fdat,wd,s/100,
									        gl.p_icurval(kv,s,fdat)/100,
									        nd,nlsk,namk,userid,ref,nazn,tt,ostf/100,
									        gl.p_icurval(kv,ostf,dapp)/100,
									        gl.p_icurval(kv,osti,fdat)/100,
									        dapp, nlsalt, nlskalt
									  INTO :ISP,:NLS,:KV,:NMS,:ACC,:FDAT,:WD,:S,
									       :SQ,:ND,:NLSK,:NAMK,:USI,:REF,:NAZN,:TT,:OSTF,
									       :SQV,:SQY,:DAPP,:NLSALT,:NLSKALT "
						Else
							Set strBind='ACC,NLS,KV,ISO,FDAT,S,SQ,ND,NLSK,NAMK,USI,REF,RNK,NAZN,OSTF,SQV,SQY,TT,DAPP'
							Set strBind=strBind||',DIG'
							Set sSql="
									 SELECT isp,nls,kv,nms,acc,fdat,wd,s/100,
									        gl.p_icurval(kv,s,fdat)/100,
									        nd,nlsk,namk,userid,ref,nazn,tt,ostf/100,
									        gl.p_icurval(kv,ostf,dapp)/100,
									        gl.p_icurval(kv,osti,fdat)/100,
									        dapp
									  INTO :ISP,:NLS,:KV,:NMS,:ACC,:FDAT,:WD,:S,
									       :SQ,:ND,:NLSK,:NAMK,:USI,:REF,:NAZN,:TT,:OSTF,
									       :SQV,:SQY,:DAPP "
					If para=20   !!   ГРН (MIK)
						Set strBind='ACC,NLS,KV,ISO,FDAT,S,ND,MFO,NLSK,NAMK,USI,REF,RNK,NAZN,OSTF,TT,DAPP,SK,OKPO,NB,VOB'
						Set sSql="
								 SELECT isp, nls, kv, nms, acc, fdat, wd, s/100, nd, mfo, nlsk,
								        namk,userid,ref,sk,nazn,tt,ostf/100,dapp,okpo,nb,vob,bis
								  INTO :ISP,:NLS,:KV,:NMS,:ACC,:FDAT,:WD,:S,:ND,:MFO,:NLSK,
								       :NAMK,:USI,:REF,:SK,:NAZN,:TT,:OSTF,:DAPP,:OKPO,:NB,:VOB,:BIS  "
					If para=201  !!   Вып. для НБУ 
						Set strBind='ACC,NLS,KV,ISO,FDAT,S,ND,MFO,NLSK,NAMK,USI,REF,RNK,NAZN,OSTF,TT,DAPP,SK,OKPO,NB,VOB'
						Set sSql="
								 SELECT isp, nls, kv, nms, acc, fdat, wd, s/100, nd, mfo, nlsk,
								        namk,userid,ref,sk,substr(nazn,1,254),tt,ostf/100,dapp,okpo,nb,vob,bis
								  INTO :ISP,:NLS,:KV,:NMS,:ACC,:FDAT,:WD,:S,:ND,:MFO,:NLSK,
								       :NAMK,:USI,:REF,:SK,:NAZN,:TT,:OSTF,:DAPP,:OKPO,:NB,:VOB,:BIS  "
						Set sSqlW = "
								    FROM tmp_lic
								    WHERE " || IifS(nrab=0, "", "substr(nls,1,1)<>:sXX and ")
					If para=21   !!   Для Сбер.банка
						Set sSqlT=""
						Set sSqlR=""
						Set sSqlS= T( "SELECT fio INTO :FIO FROM staff WHERE id = :ISP " )
						Set strBind='NLS,REF,FDAT,DAPP,ND,DATD,KV,S,MFO,NB,NLSK,NAMK,OKPO,NAZN,SK,WD'
						Set sSql = "
								    SELECT a.rec,c.isp,a.nlsb,substr(decode(sep.version,2,translate(a.nam_b,sep.win_,sep.dos_),a.nam_b),1,200),
								           substr(decode(sep.version,2,translate(a.nd,sep.win_,sep.dos_),a.nd),1,200),a.datd,a.kv,a.s/100,
								           a.mfoa,b.nb,a.nlsa,substr(decode(sep.version,2,translate(a.nam_a,sep.win_,sep.dos_),a.nam_a),1,200),
								           a.id_a,substr(decode(sep.version,2,translate(a.nazn,sep.win_,sep.dos_),a.nazn),1,200),a.bis,a.dk
								    INTO :REF,:ISP,:NLS,:NMS,:ND,:DATD,:KV,:S,:MFO,:NB,:NLSK,:NAMK,:OKPO,:NAZN,:SK,:WD "
					!
					Set strInput=strBind
					!
					If para=10   !!   ГРН-процессинговые, выход
						Set sSql=T("
								SELECT isp,nls,kv,nms,acc,fdat,wd,s/100,nd,mfo,nlsk,ref,tt,ostf/100,dapp
								INTO  :ISP,:NLS,:KV,:NMS,:ACC,:FDAT,:WD,:S,:ND,:MFO,:NLSK,:REF,:TT,:OSTF,:DAPP
								FROM  tmp_lic  WHERE  id=:ID ORDER  BY isp, nls, kv, s/100 " )
						Call FU_SAL(ID)
						Call SalDestroyWindow(frm_LicAcc)
						Return TRUE
					Set sSql = sSql || sSqlW
					If para!=21
						Set sSql=  sSql || " id=:ID "
					!
					! ORDER BY
					!
					If sXXX != 'K' OR sXXX = STRING_Null
						If nP1 > 0   !!   по одному исп все валюты
							Set sSql=T( sSql || " and isp=:nP1 ORDER BY substr(nls,1,4)||substr(nls,6,9), kv, fdat, s/100, ref, nvl(bis, 0)")
							Call FU_SAL(nP1)
							Call SalDestroyWindow(frm_LicAcc)
							Return TRUE
						If nOpt=2    !!   по БС
							Set sSql=T(sSql || " ORDER BY substr(nls,1,4)||substr(nls,6,9), kv, fdat, s/100, ref, nvl(bis, 0)")
							Call FU_SAL(ID)
							Call SalHideWindow(  hWndForm )
							! Call SalDestroyWindow(frm_LicAcc)
							Return TRUE
					!
					If para = 21
						Set sSql=  T(sSql ||  " and c.isp=:tbl1.Kod1  ORDER BY a.nlsb, a.dat_a, a.fn_a, a.rec_a " )
					Else
						If sXXX = 'K'
							! Сортируем по д/к затем по сумме
							Set sSql=  sSql || " AND acc IN ( SELECT acc FROM cust_acc WHERE rnk=:tbl1.Kod1 ) ORDER BY substr(nls,1,4)||substr(nls,6,9), kv, fdat,decode(s/abs(s),1,1,0),abs(s) "
						Else
							Set sSql=  T(sSql ||  " and isp=:tbl1.Kod1 ORDER BY substr(nls,1,4)||substr(nls,6,9), kv, fdat, s/100, ref, nvl(bis, 0) " )
					!
				Call SalShowWindow(  tbl1 )
				Call SalShowWindow(  PB1 )
				Call SalShowWindow(  PB3 )
			On SAM_ReportStart
				Call SqlPrepare(cCnc.hSql(), sSql)
			On SAM_ReportFetchInit
				Return SqlExecute(cCnc.hSql())
			On SAM_ReportFetchNext
				If SqlFetchNext(cCnc.hSql(), nFetchRes)
					If para=20   !! ГРН (MIK) Чистка БИСов
						If BIS>1   !! Бисы не суммируем
							Set S=0
					If para !=12 !! отчет HE для ПИКРИИ
						If para != 10  !! не процессинг
							If para != 21  !! Для выписок входящих исключаем
								If RNK1 != ACC
									Set RNK1 = ACC
									If SqlPrepareAndExecute( cCncAux.hSql(), sSqlR)
										Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
								If para=1 and KV1 != KV
									Set KV1 = KV
									If SqlPrepareAndExecute( cCncAux.hSql(), sSqlT)
										Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
							If ISP1 != ISP
								Set ISP1 = ISP
								If SqlPrepareAndExecute( cCncAux.hSql(), sSqlS)
									Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
						If (para != 20 and para!=201 and para != 0  and para != 1 and
								   ( TT= 'R01' or TT= 'D01'  or  para = 21 ))   !! из ARC_RRP
							Set ND  =StrDosToWinX(ND)
							Set NAMK=StrDosToWinX(NAMK)
							Set NAZN=StrDosToWinX(NAZN)
							Set NMS =StrDosToWinX(NMS)
						! If (para != 20 and para != 0  and para != 1 and
								   ( TT= 'R01' or TT= 'D01'  or  para = 21 )) or
								  ( para=0 and ( TT= 'R01' or TT= 'D01'))    !! из ARC_RRP
							                                                                  Set ND  =StrDosToWinX(ND)
							                                                                  Set NAMK=StrDosToWinX(NAMK)
							                                                                  Set NAZN=StrDosToWinX(NAZN)
							                                                                  Set NMS =StrDosToWinX(NMS)
					! проверка на 3 знака
					Call SqlPrepareAndExecute( cCncAux.hSql(), "
							SELECT dig INTO :nDig
							FROM tabval
							WHERE kv = :KV" )
					If not SqlFetchNext( cCncAux.hSql(), nFetchRes )
						Return FALSE
					Set S    = S*SalNumberPower( 10,2-nDig )
					! Set SQ   = SQ*SalNumberPower( 10,2-nDig )
					Set OSTF = OSTF*SalNumberPower( 10,2-nDig )
					! Set SQV  = SQV*SalNumberPower( 10,2-nDig )
					! Set SQY  = SQY*SalNumberPower( 10,2-nDig )
					!
					Set DIG  = nDig 
					Return TRUE
			On SAM_ReportNotify
				If lParam=RPT_BeforeReportHeader !! Перед началом формирования
					Call SalReportSetStringVar( SalNumberToWindowHandle(wParam), 'SDAT1',
								SalFmtFormatDateTime( StrToDateX( sFdat, 'MM-DD-YYYY' ), 'dd/MM/yyyy' ) )
					Call SalReportSetStringVar( SalNumberToWindowHandle(wParam), 'SDAT2',
								SalFmtFormatDateTime( StrToDateX( sFdat2, 'MM-DD-YYYY' ), 'dd/MM/yyyy' ) )
				If lParam=RPT_BeforeBreakHeader1 !! смена счета
					! Для итога за период (EVE)
					Set OBD_P=0
					Set OBK_P=0
					Set OBDQ_P=0
					Set OBKQ_P=0
					Set OST_P=OSTF
					Set OSTQ_P=SQV
					!
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'AMFO', AMFO)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'AQH', AQH)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'NMK', NMK)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'NMS', NMS)
					Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam), 'ISP', ISP)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'FIO', FIO)
					If para=1 !! инвалюта
						Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'NAMV',NAMV)
				If lParam=RPT_BeforeBreakHeader2 !! Смена даты
					Set OBD=0
					Set OBK=0
					Set OBDQ=0
					Set OBKQ=0
					If para=1
						! информация о курсе
						If SqlPrepareAndExecute( cCncAux.hSql(),
								     "SELECT bsum||' '||'"||ISO||"'||' = '||rate_o INTO :rab FROM cur_rates
								      WHERE kv=:KV and vdate=
								        (select MAX(vdate) from cur_rates where vdate<=:FDAT)")
								and SqlFetchNext(cCncAux.hSql(), nFetchRes)
							! Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
									'KURS','Курс:'||SalStrLeftX( rab, 30) )
							Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
									'KURS',CurrentLangTable.GetAtomTitle('frm_LicAcc.cTRepKurs') || ':'||SalStrLeftX( rab, 30) )
						! информация о переоценке
						If SqlPrepareAndExecute(cCncAux.hSql(),
								   "SELECT gl.p_icurval(:KV,dos-kos,:FDAT)/100 INTO :nrab
								    FROM saldoa WHERE acc=:ACC and fdat=:FDAT")
							If not SqlFetchNext(cCncAux.hSql(), nFetchRes)
								Set nrab=0
						Else
							Set nrab=0
						Set nrab = SQY - SQV + nrab
						Set PROB=''
						If nrab !=0
							Set PROB = SalNumberToStrX(SalNumberAbs(nrab),2)
							If nrab < 0
								Set PROB=PROB || PROB3
								Set OBDQ= - nrab
								! Переоценка за период (EVE)
								Set OBDQ_P=OBDQ_P - nrab
							Else
								Set OBKQ= nrab
								! Переоценка за период (EVE)
								Set OBKQ_P=OBKQ_P + nrab
						Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'PEREOC',PROB)
						!
					Set rab=IifS(OSTF<0,
							  CurrentLangTable.GetAtomTitle('frm_LicAcc.cTRepD') || ':',IifS(OSTF>0,
							  CurrentLangTable.GetAtomTitle('frm_LicAcc.cTRepC') || ':',''))
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'VS',rab)
					Set OSTF1 = OSTF - OBD + OBK
				If lParam=RPT_BeforeDetail
					If S<0
						Set OBD=OBD-S
						! Для итога за период (EVE)
						Set OBD_P=OBD_P-S
						Set OBDQ_P=OBDQ_P-SQ
						!
						Set OBDQ=OBDQ-SQ
						Set PROB=PROB3
					Else
						Set OBK=OBK+S
						! Для итога за период (EVE)
						Set OBK_P=OBK_P+S
						Set OBKQ_P=OBKQ_P+SQ
						!
						Set OBKQ=OBKQ+SQ
						Set PROB=''
					Set rab = SalNumberToStrX(SalNumberAbs(S),2) || PROB
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam), 'SS', rab)
					If S<0
						Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam), 'S_D', SalNumberAbs(S))
						Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam), 'S_K', 0)
					Else
						Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam), 'S_D', 0)
						Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam), 'S_K', SalNumberAbs(S))
					If para=1
						Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
								 'SSQ', SalNumberToStrX(SalNumberAbs(SQ),2) || PROB)
						If S<0
							Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam), 'SQ_D', SalNumberAbs(SQ))
							Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam), 'SQ_K', 0)
						Else
							Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam), 'SQ_D', 0)
							Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam), 'SQ_K', SalNumberAbs(SQ))
				If lParam=RPT_BeforeBreakFooter2
					Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam),  'OBD', OBD)
					Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam),  'OBK', OBK)
					! Set rab=IifS(OSTF1<0,'Дб:',IifS(OSTF1>0,'Кр:',''))
					Set rab=IifS(OSTF1<0,
							  CurrentLangTable.GetAtomTitle('frm_LicAcc.cTRepD') || ':',IifS(OSTF1>0,
							  CurrentLangTable.GetAtomTitle('frm_LicAcc.cTRepD') || ':',''))
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'VYS',rab)
					If para=1
						Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam),'OBDQ', OBDQ)
						Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam),'OBKQ', OBKQ)
				If lParam=RPT_BeforeBreakFooter1
					! Для итога за период (EVE)
					Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam),  'OBD_P', OBD_P)
					Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam),  'OBK_P', OBK_P)
					Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam),  'OBDQ_P', OBDQ_P)
					Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam),  'OBKQ_P', OBKQ_P)
					! Set rab=IifS(OSTF1<0,'Дб:',IifS(OSTF1>0,'Кр:',''))
					Set rab=IifS(OSTF1<0,
							  CurrentLangTable.GetAtomTitle('frm_LicAcc.cTRepD') || ':',IifS(OSTF1>0,
							  CurrentLangTable.GetAtomTitle('frm_LicAcc.cTRepD') || ':',''))
					Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam),  'OST_P', OST_P-OBD_P+OBK_P)
					Call SalReportSetNumberVar(SalNumberToWindowHandle(wParam),  'OSTQ_P', OSTQ_P-OBDQ_P+OBKQ_P)
					!
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'FIO',FIO)
			On SAM_ReportFinish
				Call SalSendMsg( frm_Out.tblReps, UM_ReportFinish, 0, 0)
			On SAM_Destroy
				Call SalWaitCursor(FALSE)
				If cCnc.IsConnected()
					Call cCnc.Disconnect()
				If cCncAux.IsConnected()
					Call cCncAux.Disconnect()
			On SAM_CreateComplete
				If para!=201 AND nOpt=2 AND sXXX!='K'
					Call SalDestroyWindow(frm_LicAcc)
				! If nOpt=2  AND para !=201   !!   по БС
					                                                            Call SalDestroyWindow(frm_LicAcc)
	Table Window: tbl_LicSepOB !! Выписки - участникам ВПС для ОЩАДБАНКА
		Class:
		Property Template:
		Class DLL Name:
		Title: Банки
		Icon File:
		Accesories Enabled? Yes
		Visible? Yes
		Display Settings
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   1.413"
				Top:    0.083"
				Width:  8.067"
				Width Editable? Yes
				Height: 5.381"
				Height Editable? Yes
			Font Name: MS Sans Serif
			Font Size: 8
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
			View: Table
			Allow Row Sizing? No
			Lines Per Row: Default
		Memory Settings
			Maximum Rows in Memory: 1000
			Discardable? No
		Description: Выписки - участникам ВПС
		Named Menus
		Menu
			Menu Item: Всех
				Resource Id: 60213
				Keyboard Accelerator: F1
				Status Text:
				Menu Settings
					Enabled when:
					Checked when:
				Menu Actions
					Set nRowType=0
					Call SalSendMsg(hWndForm, SAM_User, 0, 0)
				Menu Item Name:
			Menu Item: Выбранные
				Resource Id: 60214
				Keyboard Accelerator: (none)
				Status Text:
				Menu Settings
					Enabled when:
					Checked when:
				Menu Actions
					Set nRowType=ROW_Selected
					Call SalSendMsg(hWndForm, SAM_User, 0, 0)
				Menu Item Name:
			Menu Item: Выход
				Resource Id: 60215
				Keyboard Accelerator: F10
				Status Text:
				Menu Settings
					Enabled when:
					Checked when:
				Menu Actions
					Call SalSetFocus(hWndLicParent)
					Call SalDestroyWindow(tbl_LicSepOB)
				Menu Item Name:
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Bottom
				Visible? No
				Size: 0.4"
				Size Editable? Yes
				Font Name: MS Sans Serif
				Font Size: 8
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Column: mfo
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: МФО
				Visible? Yes
				Editable? No
				Maximum Data Length: 9
				Data Type: String
				Justify: Right
				Width:  0.967"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: sab
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Код
				Visible? Yes
				Editable? No
				Maximum Data Length: 4
				Data Type: String
				Justify: Center
				Width:  0.643"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
			Column: nb
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Title: Наименование банка
				Visible? Yes
				Editable? No
				Maximum Data Length: Default
				Data Type: String
				Justify: Left
				Width:  5.717"
				Width Editable? Yes
				Format: Unformatted
				Country: Default
				Input Mask: Unformatted
				Cell Options
					Cell Type? Standard
					Multiline Cell? No
					Cell DropDownList
						Sorted? Yes
						Vertical Scroll? Yes
						Auto Drop Down? No
						Allow Text Editing? Yes
					Cell CheckBox
						Check Value:
						Uncheck Value:
						Ignore Case? Yes
				List Values
				Message Actions
		Functions
			Function: MIK
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					! Для Ощадбанка изменено имя файла
					Set strFileNameTxt= '$W' || sab || Sep98md(SalDateConstruct(
							    SalStrToNumber(SalStrRightX(sdat, 4)), SalStrToNumber(
							    SalStrLeftX(sdat, 2)), SalStrToNumber(
							    SalStrMidX(sdat, 3, 2)), 0, 0, 0)) || '.001'
					Call WaitCursorOn()
					! Call SalReportPrintToFile(hWndForm, strDir, GetPrnDir() ||
							     '/' || strFileName, strBind, strInput, 1, RPT_PrintAll,
							     1, 1, FALSE, nInd)
					! ==================================================
					! Начинаем печать в отчет
					! ==================================================
					Call SalReportPrintToFile(hWndForm, 
							                                                        strTmplPath, 
							                                                        strPrintPath ||'/'|| IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt),
							                                                        strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
					If (nInd > 4 )
						Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
								
					! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
					Set frm_Out.dfPath = strPrintPath
					Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
					If not FL_FORMAT
						! Call zarez12(GetPrnDir() || '\\' || strFileName, frm_Out.tbl1.Kod,
								     frm_Out.tbl1.sDeviceDef)
						Call zarez12Del(  strPrintPath ||'/'|| strFileNameTxt,  frm_Out.tblReps.Kod, sDeviceDef, bDelOnNull)
					Call WaitCursorOff()
			! Function: to32x
				                                                                             Description:
				                                                                             Returns
					                                                                             String:
				                                                                             Parameters
					                                                                             Number: n1
				                                                                             Static Variables
				                                                                             Local variables
					                                                                             String: s1
					                                                                             Number: n2
				                                                                             Actions
					                                                                             Set s1=''
					                                                                             While n1>=36
						                                                                             Set n2=SalNumberMod(n1, 36)
						                                                                             Set n1=(n1-SalNumberMod(n1, 36))/36
						                                                                             If n2<10
							                                                                             Set n2=n2+48
						                                                                             Else
							                                                                             Set n2=n2+55
						                                                                             Set s1=SalNumberToChar( n2)||s1
					                                                                             Set s1=s1||SalStrRepeatX( '0', 12)
					                                                                             Return SalStrLeftX(s1,8) || '.' || SalStrMidX( s1, 9,3)
		Window Parameters
			String: sdat
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			: cCncAux
				Class: cABSConnect
			String: sKv
			Number: nIsp
			Number: nNls
			Number: nDk
			Number: nS
			Number: nOstf
			Date/Time: dtPdat
			String: sNms
			Number: nRef
			String: sText
			String: sTt
			String: strBankMfo
			Number: nRow
			String: strBankName
			!
			Number: nKv
			Number: nNlsk
			Number: nDos
			Number: nKos
			Date/Time: dtFdat
			Number: nAcc
			Number: nVob
			Number: nMfo
			Number: nMfoB
			String: sNd
			String: sNda
			String: sNdb
			String: sSql
			String: sIsp
			String: sNls
			Number: nInd
			String: sNd1
			String: sMfo1
			String: sNamk1
			String: lmfo
		Message Actions
			On SAM_Create
				Call SalCenterWindow(hWndForm)
				Call SetWindowFont(hWndForm)
				Call cCnc.Clone(g_cRepCnc, TRUE)
				Call cCncAux.Clone(cCnc, TRUE)
				!
				Set strBankMfo=GetBankMfo()
				! Set bTblLicSep = TRUE
				!
				Set strBind='sKv,nIsp,nNls,nDos,nKos,sText,sTt'
				Set strInput='KV,ISP,NLS,DOS,KOS,TEXT,TT'
				Set sSql=
						T("SELECT UNIQUE t.lcv,c.isp,c.nls,o.dk,o.s,a.ostf,a.pdat,c.nms, o.ref,o.txt, o.tt
						 INTO  :sKv,  :nIsp,:nNls,:nDk,:nS,:nOstf,:dtPdat,:sNms,:nRef,:sText,:sTt
						FROM opldok o,saldoa a,accounts c,bank_acc k,tabval t,
						OUTER zag_a za,OUTER zag_b zb
						where  c.kv=t.kv and o.acc=a.acc  and o.acc=c.acc and  o.acc=k.acc and
						o.sos=5 and  k.mfo=:lmfo and
						((c.tip='TUR' or c.tip='TUD') and a.dos<>a.kos or c.tip = 'L00') and
						   o.fdat=a.fdat and a.fdat=:sdat  and o.ref=za.ref (+) and o.ref=zb.ref (+)
						order by 1,2,3,4,5")
				Call WaitCursorOn()
				Call SalTblPopulate(hWndForm, cCnc.hSql(),T("
						SELECT mfo, sab, nb FROM Banks
						 WHERE mfop=:strBankMfo AND (kodn=0 OR kodn=4 OR kodn=6)
						 INTO  :tbl_LicSepOB.mfo, :tbl_LicSepOB.sab, :tbl_LicSepOB.nb"), TBL_FillAll)
				Call WaitCursorOff()
			On SAM_User
				Call WaitCursorOn()
				Set nRow=TBL_MinRow
				Loop
					If SalTblFindNextRow(hWndForm, nRow, nRowType, 0)
						Call SalTblFetchRow(hWndForm, nRow)
						Call SalStatusSetText(hWndForm, sab)
						Call MIK()
					Else
						Break
				Call WaitCursorOff()
				Call SalStatusSetText(hWndForm, 'Готово')
			! On SAM_Destroy
				                                                                             Set bTblLicSep = FALSE
			On SAM_ReportStart
				Set lmfo=tbl_LicSepOB.mfo
				Return SqlPrepare(cCncAux.hSql(), sSql)
			On SAM_ReportFetchInit
				Return SqlExecute(cCncAux.hSql())
			On SAM_ReportFetchNext
				If SqlFetchNext(cCncAux.hSql(), nFetchRes)
					Set nOstf=nOstf/100
					If nDk=0
						Set nDos=nS/100
						Set nKos=0
					Else
						Set nDos=0
						Set nKos=nS/100
					Set sText=SalStrLeftX( sText,12 )||SalStrRightX( SalStrRepeatX( ' ',18)|| SalNumberToStrX( nRef, 0),18)
					Return TRUE
				Return FALSE
			On SAM_ReportNotify
				If lParam=RPT_BeforeBreakHeader2
					Call SalReportSetStringVar( SalNumberToWindowHandle( wParam), 'aMFO', GetBankMfo() )
					Call SalReportSetStringVar( SalNumberToWindowHandle( wParam ), 'aQH', GetBankName())
				If lParam=RPT_BeforeBreakHeader3
					Call SalReportSetNumberVar( SalNumberToWindowHandle( wParam ), 'ACC', nAcc )
					Call SalReportSetNumberVar( SalNumberToWindowHandle( wParam ), 'OSTF', nOstf )
					Call SalReportSetStringVar( SalNumberToWindowHandle( wParam ), 'NMS', sNms )
					Call SalReportSetDateTimeVar( SalNumberToWindowHandle( wParam ), 'FDAT', dtFdat )
					Call SalReportSetDateTimeVar( SalNumberToWindowHandle( wParam ), 'PDAT', dtPdat )
					Call SalReportSetStringVar(SalNumberToWindowHandle( wParam ), 'DETAIL', "Iм'я  файлу         Референцiя" )
			On SAM_ReportFinish
				Call SalSendMsg( frm_Out.tblReps, UM_ReportFinish, 0, 0)
			On SAM_Destroy
				If cCnc.IsConnected()
					Call cCnc.Disconnect()
				If cCncAux.IsConnected()
					Call cCncAux.Disconnect()
	Form Window: frm_ARM       !! Карточка ARM-a
		Class:
		Property Template:
		Class DLL Name:
		Title: КАРТОЧКА ПОЛЬЗОВАТЕЛЯ
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.838"
				Top:    0.688"
				Width:  10.567"
				Width Editable? Yes
				Height: 5.655"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Карточка ARM-a
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Child Table: tbl1 !!
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.083"
						Top:    0.048"
						Width:  9.6"
						Width Editable? Yes
						Height: 4.5"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Bold
					Text Color: Dark Blue
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 3000
					Discardable? No
				Contents
					Column: Kod1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Код
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  0.567"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: NAME1
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: НАИМЕНОВАНИЕ
						Visible? Yes
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  7.283"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
						Call SalTblPopulate(tbl1, cCnc.hSql(), T("SELECT codeapp,name FROM applist order by 1") , TBL_FillAll)
					On SAM_DoubleClick
						Call FU_SAL(tbl1.Kod1)
						Call SalSetFocus(tbl1)
					On SAM_User
						Set nRow=TBL_MinRow
						Loop
							If SalTblFindNextRow (  tbl1, nRow, nTmp, 0 )
								Call SalTblSetContext( tbl1,nRow )
								If nRow >=0
									Call FU_SAL(tbl1.Kod1)
							Else
								Break
						Call SalSendMsg( tbl1, SAM_Create, 0, 0 )
			Pushbutton: PB1
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Печать выбранных
				Window Location and Size
					Left:   3.583"
					Top:    4.714"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Midnight Blue
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nTmp=ROW_Selected
						Call SalSendMsg( tbl1, SAM_User, 0, 0 )
			Pushbutton: PB2
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Печать ВСЕХ
				Window Location and Size
					Left:   0.983"
					Top:    4.714"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Midnight Blue
				Background Color: Default
				Message Actions
					On SAM_Click
						Set nTmp=0
						Call SalSendMsg( tbl1, SAM_User, 0, 0 )
			Pushbutton: PB3 !! завершить
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cPushButtonLabeled
				Property Template:
				Class DLL Name:
				Title: Завершить
				Window Location and Size
					Left:   6.183"
					Top:    4.714"
					Width:  2.6"
					Width Editable? Yes
					Height: 0.298"
					Height Editable? Yes
				Visible? Yes
				Keyboard Accelerator: (none)
				Font Name: Default
				Font Size: 10
				Font Enhancement: Bold
				Picture File Name:
				Picture Transparent Color: None
				Image Style: Single
				Text Color: Default
				Background Color: Default
				Message Actions
					On SAM_Click
						Call SalDestroyWindow(  frm_ARM )
		Functions
			Function: FU_SAL
				Description:
				Returns
				Parameters
					String: sP11
				Static Variables
				Local variables
				Actions
					Call SalWaitCursor(TRUE)
					Set aa = sP11
					! Set strFileName = aa || '.' || SalStrRightX(
							    SalNumberToStrX(ID, 0), 3)
					Set strFileNameTxt = '#'||aa ||NumberToStrFormat (ID,3,'0',TRUE) || '.txt'
					Call SqlPrepareAndExecute(cCncAux.hSql(), T("
							     SELECT name
							     INTO :FIO
							     FROM applist
							     WHERE codeapp=:aa"))
					Call SqlFetchNext(cCncAux.hSql(), nFetchRes)
					Set SS = T("
							    SELECT 1,a.codeoper,a.name
							    INTO :NNP,:KODP,:NAMEP
							    FROM operlist a, operapp p
							    WHERE a.codeoper=p.codeoper and p.codeapp='" || aa || "'
							    UNION ALL
							    SELECT 2,a.id,a.description
							    FROM reports a, app_rep p
							    WHERE a.id=p.coderep and p.codeapp='" || aa || "'
							    UNION ALL
							    SELECT 4,a.id,a.fio
							    FROM staff a, applist_staff p
							    WHERE a.id=p.id and p.codeapp='" || aa || "'
							    UNION ALL
							    SELECT 3,a.tabid,a.semantic
							    FROM meta_tables a, refapp p
							    WHERE a.tabid=p.tabid and p.codeapp='" || aa || "'
							    ORDER BY 1,2")
					! ==================================================
					! Начинаем печать в отчет
					! ==================================================
					Call SalReportPrintToFile(hWndForm, 
							                                                        strTmplPath, 
							                                                        strPrintPath ||'/'|| IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt),
							                                                        strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
					If (nInd > 4 )
						! Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
						Call SalMessageBox(' SalReportPrintToFile - ' || 
								  CurrentLangTable.GetAtomTitle('cTErrFunc') || ' ' || SalNumberToStrX(nInd,0) ,
								  CurrentLangTable.GetAtomTitle('cTAt'), 0 )
					! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
					Set frm_Out.dfPath = strPrintPath
					Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
					If not FL_FORMAT
						Call zarez12Del(GetPrnDir() || '\\' || strFileNameTxt, frm_Out.tblReps.Kod,  sDeviceDef, bDelOnNull)
					Call SalWaitCursor(FALSE)
		Window Parameters
			String: sP1
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			: cCncAux
				Class: cABSConnect
			Number: NNP
			Number: KODP
			String: NAMEP
			Number: ID1
			String: FIO
			String: SS
			String: aa
			Number: ISP
			Number: nRow
			Number: nTmp
		Message Actions
			On SAM_Create
				Call SalCenterWindow(hWndForm)
				Call SetWindowFont(hWndForm)
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frm_ARM.cTWndTitle'))
				Call cCnc.Clone(g_cRepCnc, TRUE)
				Call cCncAux.Clone(cCnc, TRUE)
				Set strBind = 'NNP,KODP,NAMEP'
				Set strInput = strBind
				Call SalHideWindow(  tbl1 )
				Call SalHideWindow(  PB1 )
				Call SalHideWindow(  PB3 )
				If sP1 != ''
					Call FU_SAL(sP1)
					Call SalDestroyWindow( frm_ARM)
				Call SalShowWindow(  tbl1 )
				Call SalShowWindow(  PB1 )
				Call SalShowWindow(  PB3 )
			On SAM_ReportStart
				Call SqlPrepare(cCnc.hSql(), SS)
			On SAM_ReportFetchInit
				Return SqlExecute(cCnc.hSql())
			On SAM_ReportFetchNext
				If SqlFetchNext(cCnc.hSql(), nFetchRes)
					If not bFLS
						Set NAMEP=StrWinToDosX(NAMEP)
					Return TRUE
			On SAM_ReportNotify
				If lParam=RPT_BeforeReportHeader
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							 'SHAP',IifS(bFLS,SHAP,StrWinToDosX(SHAP)))
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'ID', aa)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							'FIO', IifS(bFLS,FIO,StrWinToDosX(FIO)))
				If lParam=RPT_BeforeBreakHeader1
					Set FIO=IifS(NNP=1,'ФУНКЦИЙ',
							 IifS(NNP=2,'ОТЧЕТОВ',IifS(NNP=3,'СПРАВОЧНИКОВ',
							'ПОЛЬЗОВАТЕЛЕЙ')))||':'
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),
							'RESU', IifS(bFLS,FIO,StrWinToDosX(FIO)))
			On SAM_ReportFinish
				Call SalSendMsg( frm_Out.tblReps, UM_ReportFinish, 0, 0)
			On SAM_Destroy
				If cCnc.IsConnected()
					Call cCnc.Disconnect()
				If cCncAux.IsConnected()
					Call cCncAux.Disconnect()
				Call SalWaitCursor( FALSE )
	Form Window: frm_Lables
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  1.867"
				Width Editable? Yes
				Height: 0.321"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Data Field: dfFrom
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cFieldLabel
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   0.283"
						Top:    0.071"
						Width:  0.01"
						Width Editable? Yes
						Height: 0.01"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Default
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
			Data Field: dfTo
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cFieldLabel
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: String
					Editable? No
				Display Settings
					Window Location and Size
						Left:   1.083"
						Top:    0.095"
						Width:  0.4"
						Width Editable? Yes
						Height: 0.167"
						Height Editable? Yes
					Visible? Yes
					Border? No
					Justify: Center
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: 10
					Font Enhancement: Default
					Text Color: Default
					Background Color: 3D Face Color
					Input Mask: Unformatted
				Message Actions
			Custom Control: cSpltMain
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalVSplitterInvisible
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   0.186"
						Top:    0.073"
						Width:  4.1"
						Width Editable? Class Default
						Height: 1.0"
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Yes
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
		Functions
		Window Parameters
		Window Variables
			Number: nWndX
			Number: nWndY
			Number: nWndH
			Number: nWndW
			Number: nWndX2
			Number: nWndY2
		Message Actions
			On SAM_Create
				Call SetWindowFont( hWndForm )
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call cSpltMain.setLeftFrame( dfFrom)
				Call cSpltMain.setRightFrame( dfTo )
				Call cSpltMain.setStyle( XSalSplitter_NotResizable , TRUE )
	Form Window: frm_UniReport	!! Универсальный отчет 
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  2.514"
				Width Editable? Yes
				Height: 0.385"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Универсальный отчет 
				строится на базе каталогизированных запросов
				см. Q:\BARS98.DOC\MANUAL\QURY_SYS.DOC
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
		Functions
			! Function: MMddyyyyToDate	
				                         Description: Из символьной дати  типа  Informix   ->  в  дату
				                         Returns 
					                         Date/Time: 
				                         Parameters 
					                         String: sDat
				                         Static Variables 
				                         Local variables 
					                         Number: nYear
					                         Number: nMonth
					                         Number: nDay
					                         Date/Time: dtBankDate
				                         Actions 
					                         Set nDay=SalStrToNumber(SalStrMidX(sDat, 3, 2))
					                         Set nMonth=SalStrToNumber(SalStrMidX(sDat, 0, 2))
					                         Set nYear=SalStrToNumber(SalStrMidX(sDat, 6, 4))
					                         Set dtBankDate=SalDateConstruct(nYear, nMonth, nDay, 0, 0, 0)
					                         Return dtBankDate
		Window Parameters
			! Номер каталогизированного запроса
			Number: nQueryNo
			! Формат экспорта каталогизированного запроса
			Number: nFormat
			! C 
			String: sFdat
			! По
			String: sFdat2
			! Значения параметров
			String: sParams
			! Показывать диалог ввода параметров
			Boolean: fAskParams
			! Не использовать стандартное имя файла, предлагаемое генератором отчетов
					  если TRUE - имя формируемого файла берется из настройки запроса или из параметров отчета
			Boolean: fOverrideFilename
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
			! Код печатного отчета
			Number: nKodRep
		Window Variables
			Date/Time: dDate
			Date/Time: dDate2
			String: sAddParams
			String: sOutFile
		Message Actions
			On SAM_Create
				! Call Debug('frm_UniReport start')
				Call SalWaitCursor(TRUE)
				! Проц. формирования лицевых
				! Определяем имя файла
				Set dDate = MMddyyyyToDate(sFdat)
				Set dDate2 = MMddyyyyToDate(sFdat2)
				Set sAddParams = ":sFdat1='" || SalFmtFormatDateTime(dDate, 'dd/MM/yyyy') || "'," ||
						                 ":sFdat2='" || SalFmtFormatDateTime(dDate2, 'dd/MM/yyyy') || "'"
				If sParams
					Set sParams = sParams || sAddParams
				Else
					Set sParams = sAddParams
				! Использую каталогизированный запрос
				If (nFormat = 3 or nFormat = 6) and not fOverrideFilename
					If nFormat = 6 and not strFileNameRtf
						Set sOutFile = VisStrSubstitute(strFileNameTxt, '.txt', '.rtf')
					Else If nFormat = 3 and not strFileNameTxt
						Set sOutFile = VisStrSubstitute(strFileNameRtf, '.rtf', '.txt')
					Else
						Set sOutFile = IifS(nFormat=6, strFileNameRtf, strFileNameTxt)
				Else
					Set sOutFile = ""
				If sAutoForm != 'AUTO'
					Call ExportCatQueryRep(
							     g_cRepCnc,
							     nQueryNo,
							     sOutFile,
							     nFormat,
							     sParams,
							     fAskParams,
							     bDelOnNull,
							     frm_Out.bRO,
							     nKodRep )
				Else
					Call ExportCatQueryRep(
							     g_cRepCnc,
							     nQueryNo,
							     sOutFile,
							     nFormat,
							     sParams,
							     fAskParams,
							     bDelOnNull,
							     TRUE,
							     nKodRep)
				! Финиш
				If sAutoForm != 'AUTO'
					! Call Debug('noauto')
					Set frm_Out.dfPath = strPrintPath
					! Посылаем сообщение чтоб перечитался список файлов для новой директории
					Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
					! Call SalSendMsg( frm_Out.tblReps, UM_ReportFinish, 0, 0)
				! Else 
					                         Call Debug('auto')
				!
				Call SalWaitCursor(FALSE)
				Call SalDestroyWindow(hWndForm)
	Form Window: frm_Blok       !! НБУ.Перелiк блокованих рахункiв
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? No
			Automatically Created at Runtime? No
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   0.838"
				Top:    0.688"
				Width:  7.7"
				Width Editable? Yes
				Height: 3.677"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description: Блокированние счета
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
		Functions
		Window Parameters
			Number: para
			! String: sdat2
			! String: sdat
			! Удалять пустые строки отчета
			Boolean: bDelOnNull
		Window Variables
			: cCnc
				Class: cABSConnect
			String: ss
			!
			String: BLOK
			Number: ISP
			String: NLS
			Number: OST
			Number: KL
			String: NMS
		Message Actions
			On SAM_Create
				Call SetWindowFont(hWndForm)
				Call cCnc.Clone(g_cRepCnc, TRUE)
				Set strBind = 'BLOK,ISP,NLS,OST,KL,NMS'
				Set strInput = strBind
				Set nInd = RPT_NoToolbar ! парамерт для управления печатью отчета
				If para = 0
					Set ss = T("
							   SELECT 'Бл. Дт', A.ISP, A.NLS, A.OSTC,
							        C.RNK , A.NMS
							   INTO :BLOK, :ISP, :NLS, :OST, :KL, :NMS
							   FROM ACCOUNTS A, CUST_ACC B, CUSTOMER C
							   WHERE A.BLKD<>0 AND A.ACC=B.ACC AND B.RNK=C.RNK
							   UNION ALL
							   SELECT 'Бл. Кт', A.ISP, A.NLS, A.OSTC,
							        C.RNK , A.NMS
							   FROM ACCOUNTS A, CUST_ACC B, CUSTOMER C
							   WHERE A.BLKK<>0 AND A.ACC=B.ACC AND B.RNK=C.RNK
							   ORDER BY 1,2,3")
				Call SalHideWindow(hWndForm)
				! ==================================================
				! Начинаем печать в отчет
				! ==================================================
				Call SalReportPrintToFile(hWndForm,
						                                                        strTmplPath,
						                                                        strPrintPath ||'/'|| IifS(FL_FORMAT, strFileNameRtf,  strFileNameTxt),
						                                                        strBind,strInput,1,RPT_PrintAll,1,1,FL_FORMAT,nInd)
				If (nInd > 4 )
					! Call SalMessageBox(' SalReportPrintToFile - возвратил ошибку '|| SalNumberToStrX(nInd,0) ,'Внимание',0 )
					Call SalMessageBox(' SalReportPrintToFile - ' || 
							  CurrentLangTable.GetAtomTitle('cTErrFunc') || ' ' || SalNumberToStrX(nInd,0) ,
							  CurrentLangTable.GetAtomTitle('cTAt'),0 )
				! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
				Set frm_Out.dfPath = strPrintPath
				Call SalSendMsg(frm_Out.dfPath, SAM_User, 0, 0)
						
				Call SalDestroyWindow(hWndForm)
			On SAM_ReportStart             !! приготовить SELECT
				Return SqlPrepare(cCnc.hSql(), ss)
			On SAM_ReportFetchInit
				Return SqlExecute(cCnc.hSql())
			On SAM_ReportFetchNext  !! вычитать очередную строку
				If SqlFetchNext(cCnc.hSql(), nFetchRes)
					Return TRUE
				Else
					Return FALSE
			On SAM_ReportNotify	!! информировать ОТЧЕТ о глобальных переменных
				If lParam=RPT_BeforeReportHeader  !! только для заголовка
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'AMFO', AMFO)
					Call SalReportSetStringVar(SalNumberToWindowHandle(wParam),'AQH', AQH)
			On SAM_ReportFinish
				Call SalSendMsg( frm_Out.tblReps, UM_ReportFinish, 0, 0)
			On SAM_Destroy
				If cCnc.IsConnected()
					Call cCnc.Disconnect()
	Form Window: frm_Out
		Class: cFrmOut
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbNewFolder
					Class Child Ref Key: 1
					Class ChildKey: 0
					Class: cFrmOut
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 57551
					Class Child Ref Key: 2
					Class ChildKey: 0
					Class: cFrmOut
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbWord
					Class Child Ref Key: 3
					Class ChildKey: 0
					Class: cFrmOut
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbTxt
					Class Child Ref Key: 4
					Class ChildKey: 0
					Class: cFrmOut
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbXML
					Class Child Ref Key: 5
					Class ChildKey: 0
					Class: cFrmOut
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 57552
					Class Child Ref Key: 6
					Class ChildKey: 0
					Class: cFrmOut
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbView
					Class Child Ref Key: 7
					Class ChildKey: 0
					Class: cFrmOut
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 8
					Class ChildKey: 0
					Class: cFrmOut
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 57553
					Class Child Ref Key: 9
					Class ChildKey: 0
					Class: cFrmOut
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 10
					Class ChildKey: 0
					Class: cFrmOut
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
		Contents
			Child Table: tblReps
				Class Child Ref Key: 11
				Class ChildKey: 0
				Class: cFrmOut
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: colSort
						Class Child Ref Key: 22
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: Kod
						Class Child Ref Key: 23
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: NAME
						Class Child Ref Key: 24
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: FORM
						Class Child Ref Key: 25
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: rep
						Class Child Ref Key: 26
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: param
						Class Child Ref Key: 27
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: NDAT
						Class Child Ref Key: 28
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: maska
						Class Child Ref Key: 29
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: repw
						Class Child Ref Key: 30
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: col10
						Class Child Ref Key: 36
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: col11
						Class Child Ref Key: 37
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: col12
						Class Child Ref Key: 38
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
					On SAM_RowHeaderClick
						If tblReps.FORM = 'frm_UniReport'
							Set sZaprosPkey=''
							Set sZaprosId=''
							Call SqlPrepareAndExecute(hSql(), 
									  T("SELECT pkey, to_char(kodz)
									     FROM zapros INTO :sZaprosPkey, :sZaprosId  
									     WHERE kodz=to_number(substr(:param, 1, instr(:param,',')-1) )" ))
							Call SqlFetchNext(hSql(), nFetchRes)
							Set sZaprosPkey =  sZaprosPkey||' ('||sZaprosId||')'
						Else
							Set sZaprosPkey='не каталагізований'
						Call XSalTooltipSetColors(COLOR_Blue, COLOR_LightGray)
						Call XSalTooltipShow(hWndForm, sZaprosPkey)
						Call XSalTooltipSetColors(COLOR_Black, COLOR_White)
			Child Table: tblLstFiles
				Class Child Ref Key: 12
				Class ChildKey: 0
				Class: cFrmOut
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: colFileName
						Class Child Ref Key: 31
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colRepDT
						Class Child Ref Key: 32
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colFileDT
						Class Child Ref Key: 33
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colFileSize
						Class Child Ref Key: 34
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSort
						Class Child Ref Key: 35
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
			Data Field: dfPath
				Class Child Ref Key: 13
				Class ChildKey: 0
				Class: cFrmOut
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Custom Control: cSpltMain
				Class Child Ref Key: 14
				Class ChildKey: 0
				Class: cFrmOut
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cCalendarFrom
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010000
0020: 0200000001010101 0101000000000000 01000000000A6464 2F4D4D2F79797979
0040: 00000000
.enddata
.data CLASSPROPSSIZE
0000: 4400
.enddata
				Class Child Ref Key: 15
				Class ChildKey: 0
				Class: cFrmOut
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cCalendarTo
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010000
0020: 0200000001010101 0101000000000000 01000000000A6464 2F4D4D2F79797979
0040: 00000000
.enddata
.data CLASSPROPSSIZE
0000: 4400
.enddata
				Class Child Ref Key: 16
				Class ChildKey: 0
				Class: cFrmOut
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cSpltRightB
				Class Child Ref Key: 17
				Class ChildKey: 0
				Class: cFrmOut
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cSpltRight
				Class Child Ref Key: 18
				Class ChildKey: 0
				Class: cFrmOut
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cSpltRightT
				Class Child Ref Key: 19
				Class ChildKey: 0
				Class: cFrmOut
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cSpltRightTB
				Class Child Ref Key: 20
				Class ChildKey: 0
				Class: cFrmOut
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
		Functions
		Window Parameters
			Number: nModeEx	! № папки (0 - все, 999999999 - без папки)
		Window Variables
			String: sZaprosPkey
			String: sZaprosId
		Message Actions
			On SAM_Create
				Set nMode = nModeEx
				Call SalSendClassMessage(SAM_Create, 0, 0)
	Form Window: frm_OutList
		Class: cFrmOut
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? Class Default
		Visible? Class Default
		Display Settings
			Display Style? Class Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Class Default
			Initial State: Class Default
			Maximizable? Class Default
			Minimizable? Class Default
			System Menu? Class Default
			Resizable? Class Default
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  Class Default
				Width Editable? Class Default
				Height: Class Default
				Height Editable? Class Default
			Form Size
				Width:  Class Default
				Height: Class Default
				Number of Pages: Class Default
			Font Name: Class Default
			Font Size: Class Default
			Font Enhancement: Class Default
			Text Color: Class Default
			Background Color: Class Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Class Default
				Location? Class Default
				Visible? Class Default
				Size: Class Default
				Size Editable? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
			Contents
				Pushbutton: pbNewFolder
					Class Child Ref Key: 1
					Class ChildKey: 0
					Class: cFrmOut
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 57554
					Class Child Ref Key: 2
					Class ChildKey: 0
					Class: cFrmOut
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbWord
					Class Child Ref Key: 3
					Class ChildKey: 0
					Class: cFrmOut
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbTxt
					Class Child Ref Key: 4
					Class ChildKey: 0
					Class: cFrmOut
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbXML
					Class Child Ref Key: 5
					Class ChildKey: 0
					Class: cFrmOut
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 57555
					Class Child Ref Key: 6
					Class ChildKey: 0
					Class: cFrmOut
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbView
					Class Child Ref Key: 7
					Class ChildKey: 0
					Class: cFrmOut
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Pushbutton: pbPrint
					Class Child Ref Key: 8
					Class ChildKey: 0
					Class: cFrmOut
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
				Line
					Resource Id: 57556
					Class Child Ref Key: 9
					Class ChildKey: 0
					Class: cFrmOut
					Coordinates
						Begin X:  Class Default
						Begin Y:  Class Default
						End X:  Class Default
						End Y:  Class Default
					Visible? Class Default
					Line Style: Class Default
					Line Thickness: Class Default
					Line Color: Class Default
				Pushbutton: pbExit
					Class Child Ref Key: 10
					Class ChildKey: 0
					Class: cFrmOut
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
		Contents
			Child Table: tblReps
				Class Child Ref Key: 11
				Class ChildKey: 0
				Class: cFrmOut
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: colSort
						Class Child Ref Key: 22
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: Kod
						Class Child Ref Key: 23
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: NAME
						Class Child Ref Key: 24
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: FORM
						Class Child Ref Key: 25
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: rep
						Class Child Ref Key: 26
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: param
						Class Child Ref Key: 27
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: NDAT
						Class Child Ref Key: 28
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: maska
						Class Child Ref Key: 29
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: repw
						Class Child Ref Key: 30
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: col10
						Class Child Ref Key: 36
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: col11
						Class Child Ref Key: 37
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: col12
						Class Child Ref Key: 38
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
					Function: AppendFile
						Description:
						Returns
						Parameters
						Static Variables
						Local variables
							String: sPrintFileName
							File Handle: hPrintFile
							File Handle: hF
							Number: nNum
							Number: nLen
							Long String: sStr
							Number: i
							Number: j
						Actions
							Set sPrintFileName = smFileName[0]
							If NOT SalFileOpen(hPrintFile, sPrintFileName, OF_Text | OF_ReadWrite)
								Call Debug('Error open file ' || sPrintFileName)
								Return FALSE
							Set nNum = 0
							Loop
								Call SalFileSeek(hPrintFile, nNum, FILE_SeekBegin)
								Set nLen = SalFileRead(hPrintFile, sStr, 2000)
								Set nNum = nNum + nLen
								If nLen < 2000
									Break
							If nNum
								Set nNum = nNum - 1
							Set i = 1
							While i < nFileNum
								Call SalFileSeek(hPrintFile, nNum, FILE_SeekBegin)
								If NOT SalFileOpen(hF, smFileName[i], OF_Text | OF_Read)
									Call Debug('Error open file ' || smFileName[i])
									Break
								Set j = 1
								Call SalFileSeek(hF, j, FILE_SeekBegin)
								Loop
									Set nLen = SalFileRead(hF, sStr, 2000)
									Call SalFileWrite(hPrintFile, sStr, 2000)
									Set j = j + nLen
									If nLen < 2000
										Break
									Call SalFileSeek(hF, j, FILE_SeekBegin)
								Set nNum = nNum + j - 2
								Call SalFileClose(hF)
								Call SalFileOpen(hF, smFileName[i], OF_Delete)
								Set i = i + 1
							Call SalFileClose(hPrintFile)
					Function: FormFile
						Description:
						Returns
						Parameters
							! Номер каталогизированного запроса
							Number: nQueryNo
							! Формат экспорта каталогизированного запроса
							Number: nFormat
							! C
							String: sFdat
							! По
							String: sFdat2
							! Значения параметров
							String: sParams
							! Показывать диалог ввода параметров
							Boolean: fAskParams
							! Не использовать стандартное имя файла, предлагаемое генератором отчетов
									  если TRUE - имя формируемого файла берется из настройки запроса или из параметров отчета
							Boolean: fOverrideFilename
							! Удалять пустые строки
							Boolean: bDelOnNull
							!
							Receive String: sOutFile
						Static Variables
						Local variables
							Date/Time: dDate
							Date/Time: dDate2
							String: sAddParams
						Actions
							Call SalWaitCursor( TRUE )
							! Проц. формирования лицевых
							! Определяем имя файла
							Set dDate=MMddyyyyToDate( sFdat )
							Set dDate2=MMddyyyyToDate( sFdat2 )
							Set sAddParams=
									":sFdat1='" || SalFmtFormatDateTime( dDate, 'dd/MM/yyyy' )|| "'," ||
									":sFdat2='" || SalFmtFormatDateTime( dDate2, 'dd/MM/yyyy' )|| "'"
							If sParams
								Set sParams = sParams || sAddParams
							Else
								Set sParams = sAddParams
							! Использую каталогизированный запрос
							If (nFormat=3 OR nFormat=6) AND NOT fOverrideFilename
								If nFormat=6 AND NOT strFileNameRtf
									Set sOutFile=VisStrSubstitute( strFileNameTxt, '.txt', '.rtf' )
								Else If nFormat=3 AND NOT strFileNameTxt
									Set sOutFile=VisStrSubstitute( strFileNameRtf, '.rtf', '.txt' )
								Else
									Set sOutFile=IifS( nFormat=6, strFileNameRtf,  strFileNameTxt)
							Else
								Set sOutFile=""
							Call ExportCatQueryEx(
									   nQueryNo,
									   sOutFile,
									   nFormat,
									   sParams,
									   fAskParams,
									   bDelOnNull)
							Call SalWaitCursor( FALSE )
				Window Variables
					Number: nSort
					Number: nRow
					String: InParam[*]
					! ! Номер каталогизированного запроса
					Number: nQueryNo_
					! ! Формат экспорта каталогизированного запроса
					Number: nFormat_
					! ! C
					String: sFdat_
					! ! По
					String: sFdat2_
					! ! Значения параметров
					String: sParams_
					! ! Показывать диалог ввода параметров
					Boolean: fAskParams_
					! ! Не использовать стандартное имя файла, предлагаемое генератором отчетов
							  если TRUE - имя формируемого файла берется из настройки запроса или из параметров отчета
					Boolean: fOverrideFilename_
					! !
					String: sOutFile_
					! !
					String: smFileName[*]
					Number: nFileNum
				Message Actions
					On SAM_User
						Set nSort = 0
						Call SalSendClassMessage(SAM_User, 0, 0)
					On SAM_FetchRowDone
						Set nSort = nSort + 1
						Set colSort = nSort
					On SAM_DoubleClick
						Call SalTblSortRows(hWndForm, SalTblQueryColumnID(colSort), 1)
						Set nFileNum = 0
						Set nRow = TBL_MinRow
						While SalTblFindNextRow(hWndForm, nRow, 0, 0)
							Call SalTblSetContext(hWndForm, nRow)
							If colSort
								Call SalSendMsg(cCalendarFrom, SAM_User, 0, 0)
								Call SalSendMsg(cCalendarTo,   SAM_User, 0, 0)
								If FL_FORMAT
									Set strFileNameRtf  =(   IifS(tblReps.maska=STRING_Null,
											                                                       NumberToStrFormat (tblReps.Kod, 3,'0',TRUE) ||
											                                                       GetCharForDigit( SalStrToNumber(SalStrMidX(strDateFrom, 0, 2) ) ) ||
											                                                       GetCharForDigit( SalStrToNumber(SalStrMidX(strDateFrom, 3, 2) ) )||
											                                                        NumberToStrFormat (ID,3,'0',TRUE),
											                                               tblReps.maska )    )    ||   '.rtf'
									Set strTmplPath = GetTemplateDir() || "\\" || tblReps.repw
									! ANNY_PRN Call SalPrtSetDefault(sDeviceDef, sDriverDef, sPortDef)
								Else
									Set strFileNameTxt   =(   IifS( tblReps.maska=STRING_Null,
											                                                     NumberToStrFormat (tblReps.Kod, 3, '0',TRUE)  ||
											                                                     GetCharForDigit( SalStrToNumber( SalStrMidX(strDateFrom, 0, 2) ) )||
											                                                     GetCharForDigit( SalStrToNumber( SalStrMidX(strDateFrom, 3, 2) ) )||
											                                                     NumberToStrFormat (ID,3, '0',TRUE),
											                                         tblReps.maska  )  )    ||  '.txt'
									Set strTmplPath = GetTemplateDir() || "\\" || tblReps.rep
									! - - - -  Установка єтого принтера как default  нужна лишь для того чтоб
											! - - - -  при формировании текстового отчета  -  были нормальные параметры вывода
									! Call SalPrtSetDefault('Generic / Text Only', 'WINSPOOL', 'FILE:')
											
									! Call Debug('Setting default to Generic / Text Only')
								!
								Set SHAP = SalNumberToStrX(tblReps.Kod, 0) || ' ' ||  tblReps.NAME
								Set DRUK = 'Printed: ' || SalFmtFormatDateTime(SalDateCurrent(), "dd/MM/yyyy hh:mm:ss")
								Set strRepDate  = strDateFrom
								! ! - - - - - - - -    Поскольку в таблице report в поле param
										!- - - - - - - - -   остались переменные sFdat и sFdat2  -  присвоим их
									                                                                           Call SalDisableWindow(pbPrint)
								Set sFdat  = SalStrMidX(strDateFrom, 3, 2 ) || '-' || SalStrMidX(strDateFrom, 0, 2) || '-' || SalStrMidX(strDateFrom, 6, 4)
								Set sFdat2 = SalStrMidX(strDateTo, 3, 2 )   || '-' || SalStrMidX(strDateTo,   0, 2) || '-' || SalStrMidX(strDateTo, 6, 4)
								!
								Call SalStrTokenize(tblReps.param, '', ',', InParam)
								Set nQueryNo_ = SalStrToNumber(InParam[0])
								Set nFormat_  = SalStrToNumber(InParam[1])
								Set sFdat_    = sFdat
								Set sFdat2_   = sFdat2
								Set sParams_  = SalStrMidX(InParam[4], 1, Len(InParam[4])-2)
								Set fAskParams_ = IifN(SalStrTrimX(InParam[5])='TRUE',1,0 )
								Set fOverrideFilename_ = IifN(SalStrTrimX(InParam[6])='TRUE',1,0 )
								Call FormFile(nQueryNo_, nFormat_, sFdat, sFdat2, sParams_,
										  fAskParams_, fOverrideFilename_, NOT hWndForm.tblReps.NoDel, sOutFile_)
								Set smFileName[nFileNum] = sOutFile_
								Set nFileNum = nFileNum + 1
						If nFileNum > 1
							Call AppendFile()
						! ! ==== Посылаем сообщение чтоб перечитался список файлов для новой директории
						Set dfPath = strPrintPath
						Call SalSendMsg(dfPath, SAM_User, 0, 0)
						! ! ==== Выставим  тип отчета по default
								! ==== (тоесть коггда отчет делают двойным clickom  (wParam <> 5) )
						If (wParam != 5)
							If (tblReps.rep  = STRING_Null )
								Set FL_FORMAT = TRUE
								If (tblReps.repw  = STRING_Null )
									! Call SalMessageBox('В таблице reports не заполнено ни одно из полей : namew, name ', 'Внимание',0)
									Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Out.cTMsg1') || ' reports ' ||
											  CurrentLangTable.GetAtomTitle('frm_Out.cTMsg2') || ' : namew, name ',
											  CurrentLangTable.GetAtomTitle('cTAt'), 0)
							Else
								Set FL_FORMAT = FALSE
			Child Table: tblLstFiles
				Class Child Ref Key: 12
				Class ChildKey: 0
				Class: cFrmOut
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					View: Class Default
					Allow Row Sizing? Class Default
					Lines Per Row: Class Default
				Memory Settings
					Maximum Rows in Memory: Class Default
					Discardable? Class Default
				Contents
					Column: colFileName
						Class Child Ref Key: 31
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colRepDT
						Class Child Ref Key: 32
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colFileDT
						Class Child Ref Key: 33
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colFileSize
						Class Child Ref Key: 34
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSort
						Class Child Ref Key: 35
						Class ChildKey: 0
						Class: cFrmOut
						Property Template:
						Class DLL Name:
						Title:
						Visible? Class Default
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
				Window Variables
				Message Actions
			Data Field: dfPath
				Class Child Ref Key: 13
				Class ChildKey: 0
				Class: cFrmOut
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Custom Control: cSpltMain
				Class Child Ref Key: 14
				Class ChildKey: 0
				Class: cFrmOut
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cCalendarFrom
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010000
0020: 0200000001010101 0101000000000000 01000000000A6464 2F4D4D2F79797979
0040: 00000000
.enddata
.data CLASSPROPSSIZE
0000: 4400
.enddata
				Class Child Ref Key: 15
				Class ChildKey: 0
				Class: cFrmOut
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cCalendarTo
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010000
0020: 0200000001010101 0101000000000000 01000000000A6464 2F4D4D2F79797979
0040: 00000000
.enddata
.data CLASSPROPSSIZE
0000: 4400
.enddata
				Class Child Ref Key: 16
				Class ChildKey: 0
				Class: cFrmOut
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cSpltRightB
				Class Child Ref Key: 17
				Class ChildKey: 0
				Class: cFrmOut
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cSpltRight
				Class Child Ref Key: 18
				Class ChildKey: 0
				Class: cFrmOut
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cSpltRightT
				Class Child Ref Key: 19
				Class ChildKey: 0
				Class: cFrmOut
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
			Custom Control: cSpltRightTB
				Class Child Ref Key: 20
				Class ChildKey: 0
				Class: cFrmOut
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Class Default
						Top:    Class Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
		Functions
		Window Parameters
			Number: nModeEx	! № папки (0 - все, 999999999 - без папки)
		Window Variables
		Message Actions
			On SAM_Create
				Set nMode = nModeEx
				Call SalShowWindow(tblReps.colSort)
				Call SalEnableWindow(tblReps.colSort)
				Call SalSendClassMessage(SAM_Create, 0, 0)
	Form Window: frmRepQuery
		Class:
		Property Template:
		Class DLL Name:
		Title: Печать отчетов
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  14.0"
				Width Editable? Yes
				Height: 8.0"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
				Pushbutton: pbCancel
					Class Child Ref Key: 0
					Class ChildKey: 0
					Class: ctb_pbCancel
					Property Template:
					Class DLL Name:
					Title:
					Window Location and Size
						Left:   1.7"
						Top:    0.095"
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? No
					Keyboard Accelerator: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Picture File Name:
					Picture Transparent Color: Class Default
					Image Style: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Message Actions
						On SAM_Click
							Call SalDestroyWindow(hWndForm)
		Contents
			Custom Control: cHSpl
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cXSalHSplitter
				Property Template:
				Class DLL Name:
				Display Settings
					DLL Name:
					MS Windows Class Name:
					Style:  Class Default
					ExStyle:  Class Default
					Title:
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Etched Border? Class Default
					Hollow? Class Default
					Vertical Scroll? Class Default
					Horizontal Scroll? Class Default
					Tab Stop? Class Default
					Tile To Parent? Yes
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					DLL Settings
				Message Actions
		Functions
			Function: RefreshQueries
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalSendMsg(frmRepQ1.tblRepQue, UM_Populate, 0, 0)
			Function: Cancel
				Description:
				Returns
				Parameters
				Static Variables
				Local variables
				Actions
					Call SalDestroyWindow(hWndForm)
		Window Parameters
		Window Variables
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call SetWindowFullSize(hWndForm)
				Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('frmRepQuery.cTWndTitle'))
				Call PrepareWindowEx(hWndForm)
				Call cHSpl.setBarSize(5)
				Call cHSpl.setBarPosition(300)
				Call cHSpl.setTopFrame(SalCreateWindowEx(frmRepQ1, hWndForm, 0,0,0,0, CREATE_AsChild))
				Call cHSpl.setBottomFrame(SalCreateWindowEx(frmRepQ2, hWndForm, 0,0,0,0, CREATE_AsChild))
				Call SalColorSet(cHSpl, COLOR_IndexWindow, SalColorFromRGB(180,210,255))
				! Сформированные отчеты;Заявка на формирование отчета
				Call SalSetWindowText(cHSpl, CurrentLangTable.GetAtomTitle('frmRepQuery.cTWndTitle1') || ';' ||
						     CurrentLangTable.GetAtomTitle('frmRepQuery.cTWndTitle2'))
	Form Window: frmRepQ1
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  16.5"
				Width Editable? Yes
				Height: 6.786"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Pushbutton: pbRefresh
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbRefresh
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.1"
					Top:    0.1"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						! Перечитать данные
						Set strTip = CurrentLangTable.GetAtomTitle('frmRepQ1.cTBTipRefresh')
					On SAM_Click
						Call SalSendMsg(tblRepQue, UM_Populate, 0, 0)
			Pushbutton: pbPrint
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbPrint
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   0.55"
					Top:    0.095"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						! Печать отчета
						Set strTip = CurrentLangTable.GetAtomTitle('frmRepQ1.cTBTipPrint')
					On SAM_Click
						Call SalSendMsg(tblRepQue, SAM_DoubleClick, 0, 0)
			Pushbutton: pbDel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbDelete
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.0"
					Top:    0.095"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						! Удалить временные данные
						Set strTip = CurrentLangTable.GetAtomTitle('frmRepQ1.cTBTipDel')
					On SAM_Click
						Call tblRepQue.delRep()
			Line
				Resource Id: 51795
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Coordinates
					Begin X:  1.55"
					Begin Y:  -0.071"
					End X:  1.55"
					End Y:  0.548"
				Visible? Yes
				Line Style: Etched
				Line Thickness: 1
				Line Color: Default
			Pushbutton: pbCancel
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbCancel
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   1.7"
					Top:    0.095"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						! Выйти
						Set strTip = CurrentLangTable.GetAtomTitle('frmRepQ1.cTBTipCancel')
					On SAM_Click
						Call frmRepQuery.Cancel()
			Pushbutton: pbTimer
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cTimer
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   Default
					Top:    Default
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On UM_TimerFired
						Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
			Child Table: tblRepQue
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    0.5"
						Width:  15.683"
						Width Editable? Yes
						Height: 5.405"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 10000
					Discardable? Yes
				Contents
					Column: colQueryId
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: №
						Visible? Yes
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.2"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colId
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: №
								звіту
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.2"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назва
								звіту
						Visible? Class Default
						Editable? No
						Maximum Data Length: 210
						Data Type: Class Default
						Justify: Class Default
						Width:  4.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colDat
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Дата
								заявки
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Date/Time
						Justify: Center
						Width:  2.0"
						Width Editable? Class Default
						Format: DateTime
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colStatusId
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colStatusName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Статус
						Visible? Class Default
						Editable? Yes
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  2.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
							On SAM_SetFocus
								Set sTmp = colStatusName
							On SAM_AnyEdit
								Set colStatusName = sTmp
							On VTM_LeftClick
								If colComm
									Call XSalTooltipSetColors(COLOR_Black, SalColorFromRGB(255, 255, 200))
									Call XSalTooltipShow(hWndForm, colComm)
									Call XSalTooltipSetColors(COLOR_Black, SalColorFromRGB(255, 255, 200))
					Column: colParams
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Параметри
						Visible? Class Default
						Editable? No
						Maximum Data Length: Default
						Data Type: String
						Justify: Left
						Width:  6.0"
						Width Editable? Yes
						Format: Unformatted
						Country: Default
						Input Mask: Unformatted
						Cell Options
							Cell Type? Standard
							Multiline Cell? No
							Cell DropDownList
								Sorted? Yes
								Vertical Scroll? Yes
								Auto Drop Down? No
								Allow Text Editing? Yes
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Yes
						List Values
						Message Actions
					Column: colKeyParams
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: 4000
						Data Type: Long String
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colXmlParams
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: 4000
						Data Type: Long String
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colComm
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: 4000
						Data Type: Long String
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colSId
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colForm
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colTemplate
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title:
						Visible? No
						Editable? Class Default
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  Class Default
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
					Function: delRep
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
							Number: nRow
						Actions
							! Удалить временные данные для выделенных отчетов?
							If SalMessageBox(CurrentLangTable.GetAtomTitle('frmRepQ1.cTMsgDel'), 
									   CurrentLangTable.GetAtomTitle('cTAt'), MB_IconQuestion | MB_YesNo) = IDYES
								Set nRow = TBL_MinRow
								While SalTblFindNextRow(hWndForm, nRow, ROW_Selected, 0)
									Call SalTblSetContext(hWndForm, nRow)
									! If not SqlPLSQLCommand(hSql(), "rs.clear_report_query(colId, colKeyParams)")
										            Call SqlRollbackEx(hSql(), "REP. Ошибка удаления временных данных для отчета №" || Str(colId) || " " || colName)
										            Return FALSE
									If not SqlPLSQLCommand(hSql(), "rs.clear_report_query(colQueryId)")
										Call SqlRollbackEx(hSql(), "REP. Ошибка удаления временных данных для отчета №" || Str(colId) || " " || colName)
										Return FALSE
									Call SqlCommitEx(hSql(), "REP. Удалены временные данные для отчета №" || Str(colId) || " " || colName)
								Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
							Return TRUE
					Function: SetRowsColor
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
							Number: nRow
						Actions
							Set nRow = TBL_MinRow
							While SalTblFindNextRow(hWndForm, nRow, 0 ,0)
								Call SalTblSetContext(hWndForm, nRow)
								! синий
								If colStatusId = 'START'
									Call SetTblRowColor(hWndForm, COLOR_Blue)
								! зеленый
								Else If colStatusId = 'PROCESS'
									Call SetTblRowColor(hWndForm, COLOR_DarkGreen)
								! светло-зеленый
								Else If colStatusId = 'DONE'
									Call XSalTblSetRowBackColor(hWndForm, nRow, SalColorFromRGB(230,255,230))
								! розовый
								Else If colStatusId = 'ERROR'
									Call XSalTblSetRowBackColor(hWndForm, nRow, SalColorFromRGB(255,200,200))
							Return TRUE
					Function: PrintRepOld
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
							Number: nSId
							String: sKeyParams
							String: sFileName
						Actions
							If colSId
								Set nSId = colSId
								Set sKeyParams = colKeyParams
								If colForm = 'frm_UniReport'
									If ExportRepData(nSId, sFileName)
										If sFileName
											If not SqlPLSQLCommand(hSql(), "rs.set_status(colQueryId, 'PRINTED', STRING_Null)")
												Call SqlRollbackEx(hSql(), "REP. Не удалось поменять статус отчета " || Str(colId))
											Else
												Call SqlCommitEx(hSql(), "REP. Изменен статус отчета " || Str(colId) || " => PRINTED")
												Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
											If SalStrScan(sFileName, '.rtf') != -1
												If not SalLoadApp(GetEditorPath(), sFileName)
													! Не удалось загрузить приложение SalLoadApp : GetEditorPath()
													Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Out.cTErr1') || ' SalLoadApp : GetEditorPath()',
															     CurrentLangTable.GetAtomTitle('cTAt'), 0)
											Else
												If not SalLoadApp('DVIEW.EXE', sFileName)
													! Не удалось загрузить приложение DVIEW.EXE
													Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Out.cTErr1') || ' DVIEW.EXE',
															     CurrentLangTable.GetAtomTitle('cTAt'), 0)
								Else
									Call SalLoadApp(GetDir() || '\\bin\\fastreport\\FastReport.Print.exe', SqlDatabase || ' ' || SqlUser || ' ' || SqlPassword || ' ' || GetTemplateDir() || '\\' || colTemplate || ' ' || Str(colQueryId))
									If not SqlPLSQLCommand(hSql(), "rs.set_status(colQueryId, 'PRINTED', STRING_Null)")
										Call SqlRollbackEx(hSql(), "REP. Не удалось поменять статус отчета " || Str(colId))
									Else
										Call SqlCommitEx(hSql(), "REP. Изменен статус отчета " || Str(colId) || " => PRINTED")
										Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
							Return TRUE
					Function: PrintRep
						Description:
						Returns
							Boolean:
						Parameters
						Static Variables
						Local variables
						Actions
							If colQueryId and ( colStatusId = 'DONE' or colStatusId = 'PRINTED' or colStatusId = 'CREATEDFILE' )
								! Call SaveInfoToLog(GetDir() || '\\bin\\fastreport\\FastReport.Print.exe' || ' ' || SqlDatabase || ' ' || SqlUser || ' ' || SqlPassword || ' ' || GetTemplateDir() || '\\' || colTemplate || ' ' || Str(colQueryId))
								Call SalLoadApp(GetDir() || '\\bin\\fastreport\\FastReport.Print.exe', SqlDatabase || ' ' || SqlUser || ' ' || SqlPassword || ' ' || GetTemplateDir() || '\\' || colTemplate || ' ' || Str(colQueryId))
								Call SalSendMsg(pbRefresh, SAM_Click, 0, 0)
							Return TRUE
				Window Variables
					String: sTmp
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
						Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
						Call SalSendMsg(hWndForm, UM_Populate, 0, 0)
					On UM_Populate
						Call SqlSetLongBindDatatype(3, 22)
						Call SqlSetLongBindDatatype(4, 22)
						Call SqlSetLongBindDatatype(8, 22)
						Call SalTblPopulate(hWndForm, hSqlAux(), 
								"select q.query_id, q.rep_id, q.rep_desc, q.key_params, q.xml_params, q.creation_time,
								        q.status_id, substr(q.stats_name,1,254), q.stats_comm, q.session_id,
								        r.form, z.rpt_template
								   into :colQueryId, :colId, :colName, :colKeyParams, :colXmlParams, :colDat,
								        :colStatusId, :colStatusName, :colComm, :colSId, :colForm, :colTemplate
								   from v_cbirep_represults q, reports r, zapros z
								  where q.rep_id = r.id
								    and substr(r.param, 1, instr(r.param,',')-1) = to_char(z.kodz)
								  order by q.creation_time", TBL_FillAll)
						Call SetRowsColor()
						Call SalTblSetContext(hWndForm, 0)
						Call SalTblSetFocusRow(hWndForm, 0)
						Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
					On SAM_FetchRowDone
						Set colParams = GetRepParamsStr(colId, colXmlParams)
					On SAM_TblDoDetails
						If colStatusId = 'DONE' or colStatusId = 'PRINTED' or colStatusId = 'CREATEDFILE'
							Call SalEnableWindow(pbPrint)
						Else
							Call SalDisableWindow(pbPrint)
					On SAM_DoubleClick
						Call PrintRep()
		Functions
		Window Parameters
		Window Variables
			Number: nUserId
			!
			Number: nWinX0
			Number: nWinY0
			Number: nWinWidth
			Number: nWinHeigh
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Call pbTimer.Init(20, 0, TRUE)
				Set nUserId = GetUserId()
			On WM_Size
				Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeigh)
				Call SalSetWindowSize(hWndForm.frmRepQ1.tblRepQue,
						     SalPixelsToFormUnits(hWndForm.frmRepQ1.tblRepQue, nWinWidth, FALSE),
						     SalPixelsToFormUnits(hWndForm.frmRepQ1.tblRepQue, nWinHeigh, TRUE)-0.5)
				Call SalInvalidateWindow(hWndForm)
	Form Window: frmRepQ2
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  13.867"
				Width Editable? Yes
				Height: 6.5"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
			Background Text: Папка:
				Resource Id: 52403
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   0.0"
					Top:    0.2"
					Width:  1.0"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: bgFolder
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cLabelControl
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Class Default
					Data Type: Class Default
					Editable? Class Default
				Display Settings
					Window Location and Size
						Left:   Default
						Top:    Default
						Width:  Class Default
						Width Editable? Class Default
						Height: Class Default
						Height Editable? Class Default
					Visible? Class Default
					Border? Class Default
					Justify: Class Default
					Format: Class Default
					Country: Class Default
					Font Name: Class Default
					Font Size: Class Default
					Font Enhancement: Class Default
					Text Color: Class Default
					Background Color: Class Default
					Input Mask: Class Default
				Message Actions
			Combo Box: cmbRepFolders
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: cGenComboBox_NumId
				Property Template:
				Class DLL Name:
				Window Location and Size
					Left:   1.1"
					Top:    0.15"
					Width:  4.0"
					Width Editable? Class Default
					Height: 4.44"
					Height Editable? Class Default
				Visible? Class Default
				Editable? Class Default
				String Type: Class Default
				Maximum Data Length: Class Default
				Sorted? Class Default
				Always Show List? Class Default
				Vertical Scroll? Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Input Mask: Class Default
				List Initialization
				Message Actions
					On SAM_Create
						If cmbRepFolders.Init(hWndItem)
							Call cmbRepFolders.Populate(hSql(), 'folder_id', 'folder_name', 'v_cbirep_repfolderslist', 
									     "where codeapp = '" || sCodeApp || "' order by folder_name")
							Call cmbRepFolders.Add(-1, 'Всі')
							Call cmbRepFolders.SetSelectById(-1)
							Call SalSendMsg(cmbRepFolders, SAM_Click, 0, 0)
					On SAM_Click
						Call SalSendClassMessage(SAM_Click, 0, 0)
						Set nFolderId = cmbRepFolders.nCurrentId
						Call SalSendMsg(tblRep, UM_Populate, 0, 0)
			Background Text: № звіту:
				Resource Id: 5449
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Window Location and Size
					Left:   5.3"
					Top:    0.2"
					Width:  1.2"
					Width Editable? Yes
					Height: 0.167"
					Height Editable? Yes
				Visible? Yes
				Justify: Right
				Font Name: Default
				Font Size: Default
				Font Enhancement: Bold
				Text Color: Default
				Background Color: Default
			Data Field: dfRepId
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Data
					Maximum Data Length: Default
					Data Type: Number
					Editable? Yes
				Display Settings
					Window Location and Size
						Left:   6.5"
						Top:    0.15"
						Width:  1.0"
						Width Editable? Yes
						Height: 0.25"
						Height Editable? Yes
					Visible? Yes
					Border? Yes
					Justify: Left
					Format: Unformatted
					Country: Default
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					Input Mask: Unformatted
				Message Actions
			Pushbutton: pbRefresh
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbRefresh
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   7.7"
					Top:    0.1"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						! Перечитать данные
						Set strTip = CurrentLangTable.GetAtomTitle('frmRepQ2.cTBTipRefresh')
					On SAM_Click
						If not SalIsNull(dfRepId)
							Call cmbRepFolders.SetSelectById(-1)
							Call SalSendMsg(cmbRepFolders, SAM_Click, 0, 0)
						Else
							Call SalSendMsg(tblRep, UM_Populate, 0, 0)
			Line
				Resource Id: 52409
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Coordinates
					Begin X:  8.2"
					Begin Y:  -0.048"
					End X:  8.2"
					End Y:  0.512"
				Visible? Yes
				Line Style: Etched
				Line Thickness: 1
				Line Color: Default
			Pushbutton: pbForm
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class: ctb_pbExecute
				Property Template:
				Class DLL Name:
				Title:
				Window Location and Size
					Left:   8.3"
					Top:    0.1"
					Width:  Class Default
					Width Editable? Class Default
					Height: Class Default
					Height Editable? Class Default
				Visible? Class Default
				Keyboard Accelerator: Class Default
				Font Name: Class Default
				Font Size: Class Default
				Font Enhancement: Class Default
				Picture File Name:
				Picture Transparent Color: Class Default
				Image Style: Class Default
				Text Color: Class Default
				Background Color: Class Default
				Message Actions
					On SAM_Create
						! Создать заявку
						Set strTip = CurrentLangTable.GetAtomTitle('frmRepQ2.cTBTipForm')
					On SAM_Click
						Call SalSendMsg(tblRep, SAM_DoubleClick, 0, 0)
			Child Table: tblRep
				Class Child Ref Key: 0
				Class ChildKey: 0
				Class:
				Property Template:
				Class DLL Name:
				Display Settings
					Window Location and Size
						Left:   0.0"
						Top:    0.5"
						Width:  11.183"
						Width Editable? Yes
						Height: 3.333"
						Height Editable? Yes
					Visible? Yes
					Font Name: Default
					Font Size: Default
					Font Enhancement: Default
					Text Color: Default
					Background Color: Default
					View: Table
					Allow Row Sizing? No
					Lines Per Row: Default
				Memory Settings
					Maximum Rows in Memory: 10000
					Discardable? Yes
				Contents
					Column: colId
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: №
								звіту
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Number
						Justify: Right
						Width:  1.2"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
					Column: colName
						Class Child Ref Key: 0
						Class ChildKey: 0
						Class: cColumnLabeled
						Property Template:
						Class DLL Name:
						Title: Назва
								звіту
						Visible? Class Default
						Editable? No
						Maximum Data Length: Class Default
						Data Type: Class Default
						Justify: Class Default
						Width:  8.0"
						Width Editable? Class Default
						Format: Class Default
						Country: Class Default
						Input Mask: Class Default
						Cell Options
							Cell Type? Class Default
							Multiline Cell? Class Default
							Cell DropDownList
								Sorted? Class Default
								Vertical Scroll? Class Default
								Auto Drop Down? Class Default
								Allow Text Editing? Class Default
							Cell CheckBox
								Check Value:
								Uncheck Value:
								Ignore Case? Class Default
						List Values
						Message Actions
				Functions
					Function: CreateQuery
						Description:
						Returns
							Boolean:
						Parameters
							Number: nRepId
						Static Variables
						Local variables
							Number: nKodz
							String: sParam
							Long String: lsBindVars
							Long String: lsDefVars
							Long String: lsBindSql
						Actions
							Call SqlSetLongBindDatatype(2, 22)
							Call SqlSetLongBindDatatype(3, 22)
							Call SqlSetLongBindDatatype(4, 22)
							If not SqlPrepareAndExecute(hSql(),
									"select kodz, param, bindvars, default_vars, bind_sql
									   into :nKodz, :sParam, :lsBindVars, :lsDefVars, :lsBindSql
									   from v_cbirep_repparams
									  where rep_id = :nRepId")
								Return FALSE
							If not SqlFetchNext(hSql(), nFetchRes)
								Return FALSE
							Set lsXmlParams = ''
							If lsBindVars
								If not SetQueryBindsDat(hWndMDI, sParam, lsBindVars, lsDefVars, lsBindSql, lsXmlParams)
									Call WaitCursorOff()
									Return FALSE
							!
							Call SalWaitCursor(TRUE)
							If not SqlPLSQLCommand(hSql(), "create_report_query(nRepId, lsXmlParams)")
								Call SqlRollbackEx(hSql(), "REP. Ошибка создания заявки на формирование отчета №" || Str(colId) || " " || colName)
								Call SalWaitCursor(FALSE)
								Return FALSE
							Call SqlCommitEx(hSql(), "REP. Создана заявка на формирование отчета №" || Str(colId) || " " || colName)
							Call SalWaitCursor(FALSE)
							! Создана заявка на формирование отчета №colId
							Call MessageNoWait(CurrentLangTable.GetAtomTitle('frmRepQ2.cTMsgQueryCreated') || " №" || Str(colId), 
									     CurrentLangTable.GetAtomTitle('cTInfo'), 5, 0)
							Return TRUE
				Window Variables
				Message Actions
					On SAM_Create
						Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
						Call SalTblSetTableFlags(hWndForm, TBL_Flag_SingleSelection, TRUE)
					On UM_Populate
						Call SalTblPopulate(hWndForm, hSql(), 
								"select r.rep_id, r.rep_desc
								   into :colId, :colName
								   from v_cbirep_replist r
								  where r.codeapp = :sCodeApp" ||
								        IifS(nFolderId=-1, "", " and r.folder_id = :nFolderId") ||
								        IifS(dfRepId=NUMBER_Null, "", " and r.rep_id = :dfRepId") || "
								  order by r.rep_id", TBL_FillAll)
						Call SalTblSetContext(hWndForm, 0)
						Call SalTblSetFocusRow(hWndForm, 0)
						Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
					On SAM_DoubleClick
						If CreateQuery(colId)
							Call frmRepQuery.RefreshQueries()
		Functions
		Window Parameters
		Window Variables
			Number: nFolderId
			String: sCodeApp
			Long String: lsXmlParams
			!
			Number: nWinX0
			Number: nWinY0
			Number: nWinWidth
			Number: nWinHeigh
			Number: nWW
			Number: nWH
		Message Actions
			On SAM_Create
				Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				Set sCodeApp = GetCodeApp()
			On SAM_CreateComplete
				Call SalSendMsg(tblRep, UM_Populate, 0, 0)
				Call SalSetFocus(dfRepId)
			On WM_Size
				Call GetClientRect(hWndForm, nWinX0, nWinY0, nWinWidth, nWinHeigh)
				Call SalSetWindowSize(hWndForm.frmRepQ2.tblRep,
						     SalPixelsToFormUnits(hWndForm.frmRepQ2.tblRep, nWinWidth, FALSE),
						     SalPixelsToFormUnits(hWndForm.frmRepQ2.tblRep, nWinHeigh, TRUE)-0.5)
				Call SalInvalidateWindow(hWndForm)
	! Dialog Box: dlgBindSet
.winattr
		Class:
		Property Template:
		Class DLL Name:
		Title: Параметры запроса...
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Type of Dialog: Modal
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  8.0"
				Width Editable? Yes
				Height: 4.05"
				Height Editable? Yes
			Absolute Screen Location? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
.end
		                Description: Назначение параметров запроса
		                Tool Bar 
			                Contents 
		                Contents 
			                Background Text: С даты
			                Data Field: bgFrom
				                Message Actions 
			                Custom Control: cCalendarFrom
.data CLASSPROPSSIZE
0000: 4200
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010000
0020: 0200000001010101 0101000000000000 01000000000A6464 2F4D4D2F79797979
0040: 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				                Message Actions 
					                On SAM_Create
						                Call GetMonthArray(strMonth) 
						                Call GetWeekDayArray(strWeekDays)
						                Call cCalendarFrom.SetMonthText(strMonth) 
						                Call cCalendarFrom.SetWeekDayText(strWeekDays)
						! ! - - - - - - - - - - - - Инициализация дат календаря  cCalendarFrom - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - -
						                Call cCalendarFrom.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Sunday,    SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                Call cCalendarFrom.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Monday,    SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                Call cCalendarFrom.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Tuesday,   SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                Call cCalendarFrom.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Wednesday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                Call cCalendarFrom.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Thursday,  SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                Call cCalendarFrom.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Friday,    SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                Call cCalendarFrom.SpecialDate(SPECIAL_Weekly, DATETIME_Null, DAY_Saturday,  SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                Call cCalendarFrom.SpecialDate(SPECIAL_OneTime, GetBankDate(), DAY_Unset,    SEQ_Unset, COLOR_Blue,  COLOR_Cyan, TRUE)
						                Call SqlPrepareAndExecute(hSql(), "select fdat into :dSelect from fdat")
						                Set i = 0
						                While SqlFetchNext(hSql(), nFetchRes)
							                Call cCalendarFrom.SpecialDate(SPECIAL_OneTime, dSelect,  DAY_Unset, SEQ_Unset, COLOR_Blue, COLOR_Cyan, TRUE)
							                Set i = i + 1
						                If i = 0
							! Нет доступных дат для выбора
							                Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Out.cTMsgDat'),
									     CurrentLangTable.GetAtomTitle('cTAt'), 0)
						                Call SalSetWindowText(cCalendarFrom,  strBankDate)
					                On SAM_User
						                Call SalGetWindowText(hWndItem, strDateFrom, 12)
			                Background Text: По дату
			                Data Field: bgTo
				                Message Actions 
			                Custom Control: cCalendarTo
.data CLASSPROPSSIZE
0000: 4200
.enddata
.data CLASSPROPS
0000: 56543A43616C656E 646172436F6D626F 426F78002B000100 0000010101010000
0020: 0200000001010101 0101000000000000 01000000000A6464 2F4D4D2F79797979
0040: 0000
.enddata
.data INHERITPROPS
0000: 0100
.enddata
				                Message Actions 
					                On SAM_Create
						                Call GetMonthArray(strMonth)
						                Call GetWeekDayArray(strWeekDays)
						                Call cCalendarTo.SetMonthText(strMonth) 
						                Call cCalendarTo.SetWeekDayText(strWeekDays)
						! ! - - - - - - - - - - - - Инициализация дат календаря  cCalendarTo - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - -
						                Call cCalendarTo.SpecialDate(SPECIAL_Weekly,  DATETIME_Null, DAY_Sunday,    SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                Call cCalendarTo.SpecialDate(SPECIAL_Weekly,  DATETIME_Null, DAY_Monday,    SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                Call cCalendarTo.SpecialDate(SPECIAL_Weekly,  DATETIME_Null, DAY_Tuesday,   SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                Call cCalendarTo.SpecialDate(SPECIAL_Weekly,  DATETIME_Null, DAY_Wednesday, SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                Call cCalendarTo.SpecialDate(SPECIAL_Weekly,  DATETIME_Null, DAY_Thursday,  SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                Call cCalendarTo.SpecialDate(SPECIAL_Weekly,  DATETIME_Null, DAY_Friday,    SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                Call cCalendarTo.SpecialDate(SPECIAL_Weekly,  DATETIME_Null, DAY_Saturday,  SEQ_Unset, COLOR_Black, COLOR_Gray, TRUE)
						                Call cCalendarTo.SpecialDate(SPECIAL_OneTime, GetBankDate(), DAY_Unset,     SEQ_Unset, COLOR_Blue,  COLOR_Cyan, TRUE)
						                Call SqlPrepareAndExecute(hSql(), "select fdat into :dSelect from fdat")
						                Set i = 0
						                While SqlFetchNext(hSql(), nFetchRes)
							                Call cCalendarTo.SpecialDate(SPECIAL_OneTime, dSelect,  DAY_Unset, SEQ_Unset, COLOR_Blue, COLOR_Cyan, TRUE)
							                Set i = i + 1
						                If i = 0
							! Нет доступных дат для выбора
							                Call SalMessageBox(CurrentLangTable.GetAtomTitle('frm_Out.cTMsgDat'), 
									     CurrentLangTable.GetAtomTitle('cTAt'),0)
						                Call SalSetWindowText(cCalendarTo, strBankDate)
					                On SAM_User
						                Call SalGetWindowText(hWndItem, strDateTo, 12)
			                Child Table: tblBinds
				                Contents 
					                Column: colN
						                List Values 
						                Message Actions 
					                Column: colBindName
						                List Values 
						                Message Actions 
					                Column: colVal
						                List Values 
						                Message Actions 
							                On SAM_AnyEdit
								                If cBinds[colN].sDescSQL != ''
									                Set colVal = sTmp
									                Call SalSendMsg(colVal, SAM_DoubleClick, 0, 0)
							                On SAM_Validate
								                Set cBinds[colN].sVal = colVal
								                Return VALIDATE_Ok
							! По двойному клику - показать таблицу-справочник для параметра
							                On SAM_DoubleClick
								                If cBinds[colN].sDescSQL != ''
									                Call SalCreateWindow(tbl_BindSQL, hWndForm, cBinds[colN])
							                On SAM_SetFocus
								                Set sTmp = colVal
				                Functions 
				                Window Variables 
					                Number: nRowNew
					                Boolean: fHasParams
					                String: sTmp
					                Boolean: bFdat1
					                Boolean: bFdat2
					                Boolean: bParams
				                Message Actions 
					                On SAM_Create
						                Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
					                On UM_Populate
						                Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
						                Set ni = 0
						                Set fHasParams=FALSE
						                Set bFdat1 = FALSE
						                Set bFdat2 = FALSE
						                Set bParams = FALSE
						                Loop 
							                If ni >= nBindsNum
								                Break 
							! If DebuggingOn AND NOT cBinds[ni].sSemantic
								                  Set cBinds[ni].sSemantic=cBinds[ni].sName
							                If cBinds[ni].sName = ':sFdat1'
								                Set bFdat1 = TRUE
								                Call SalShowWindowAndLabel(bgFrom)
								                Call SalShowWindow(cCalendarFrom)
								                If NOT fHasParams
									                Set fHasParams=TRUE
							                Else If cBinds[ni].sName = ':sFdat2'
								                Set bFdat2 = TRUE
								                Call SalShowWindowAndLabel(bgTo)
								                Call SalShowWindow(cCalendarTo)
								                If NOT fHasParams
									                Set fHasParams=TRUE
							                Else If cBinds[ni].sSemantic
								                Set bParams = FALSE
								                Set nRowNew = SalTblInsertRow( hWndItem, TBL_MaxRow )
								                Call SalTblSetRowFlags( hWndItem, nRowNew, ROW_New, FALSE )
								                Call SalTblSetContext( hWndItem, nRowNew )
								                Set colN = ni
								                Set colBindName = cBinds[ni].sSemantic
								                Set colVal  = cBinds[ni].sVal
								                If NOT fHasParams
									                Set fHasParams=TRUE
							                Set ni = ni + 1
						                If NOT fHasParams
							                Call SalEndDialog(dlgBindSet, 1)
							                Return FALSE
						                If bFdat1 and not bFdat2
							                Call SalSetWindowLabelText(bgFrom, 'За')
						                If not bParams
							                Call SalHideWindow(hWndForm)
						                Call SalSetFocus(hWndForm)
						                Call SalTblSetFocusRow(hWndForm, 0)
						                Call SalTblSetFocusCell(hWndForm, 0, colVal, 0, 0)
						                Call SalSendMsg(hWndForm, SAM_TblDoDetails, 0, 0)
					                On SAM_TblDoDetails
						                If cBinds[colN].sDescSQL != ''
							                Call SalEnableWindow(pbRef)
						                Else 
							                Call SalDisableWindow(pbRef)
			                Frame 
			                Pushbutton: pbRef
				                Message Actions 
					                On SAM_Click
						                Call SalSendMsg(tblBinds.colVal, SAM_DoubleClick, 0, 0)
			                Pushbutton: pbOk
				                Message Actions 
					                On SAM_Click
						                Call setXmlParams()
						                Call SalEndDialog(hWndForm, 1)
			                Pushbutton: pbCancel
				                Message Actions 
					                On SAM_Click
						                Call SalEndDialog(hWndForm, 0)
		                Functions 
			                Function: GetQueryBindsList
				                Description: Получить список бинд переменных запроса (до/переписать)
						с установкой
				                Returns 
					                Number: 
				                Parameters 
					                String: sParams
					                String: sParamsSQL ! Описание SQL для параметра
					                : sBinds[*]
				                Static Variables 
				                Local variables 
					                Number: nBNum
					                Number: nCount
					                String: strBindName
					                : P
					                : ParamSQL
				                Actions 
					                Set nBNum = 0
					                Call P.Clear( )
					                Call ParamSQL.Clear()
					                If sParams != ''
						                Call P.SetParams(sParams)
					                If sParamsSQL != ''
						                Call ParamSQL.SetParams(sParamsSQL)
					!
					                Set nCount = P.ParamsCount()
					                While nBNum < nCount
						                Set strBindName = P.ParamName(nBNum)
						                Set sBinds[nBNum].sName = strBindName
						                Set sBinds[nBNum].sType = 'S'
						                Set sBinds[nBNum].sSemantic = P.GetAsString(strBindName)
						                Set sBinds[nBNum].sVal = ''
						                If ParamSQL.IndexOf(strBindName) > -1
							                Set sBinds[nBNum].sDescSQL = ParamSQL.GetAsString(strBindName)
						                Else 
							                Set sBinds[nBNum].sDescSQL = ''
						!
						                Set nBNum = nBNum + 1
					                Return nCount
			                Function: setXmlParams
				                Description: 
				                Returns 
					                Boolean: 
				                Parameters 
				                Static Variables 
				                Local variables 
					                String: sDat
				                Actions 
					                Set lsXmlParams = ''
					                Set i = 0
					                While i < nBindsNum
						                If cBinds[i].sName = ':sFdat1'
							                Call SalGetWindowText(cCalendarFrom, sDat, 12)
							                Set lsXmlParams = lsXmlParams || '<Param ID="' || cBinds[i].sName || '" Value="' || sDat || '" />'
						                Else If cBinds[i].sName = ':sFdat2'
							                Call SalGetWindowText(cCalendarTo, sDat, 12)
							                Set lsXmlParams = lsXmlParams || '<Param ID="' || cBinds[i].sName || '" Value="' || sDat || '" />'
						                Else 
							                Set lsXmlParams = lsXmlParams || '<Param ID="' || cBinds[i].sName || '" Value="' || cBinds[i].sVal || '" />'
						                Set i = i + 1
					                If lsXmlParams
						                Set lsXmlParams = '<ReportParams>' || lsXmlParams || '</ReportParams>'
					                Return TRUE
		                Window Parameters 
			                String: sParams
			                Long String: lsBindVars
			                Long String: lsDefVars
			                Long String: lsBindSql
			                Receive Long String: lsXmlParams
		                Window Variables 
			                : cBinds[*]
			                : cPar
			                String: sParam
			                Number: nBindsNum
			                Number: ni
			                String: InParam[*]
			                Number: i
			                Date/Time: dSelect
		                Message Actions 
			                On SAM_Create
				                Call SalCenterWindow(hWndForm)
				                Call SetWindowFont(hWndForm)
				                Call SalSendMsgToChildren(hWndForm, UM_QueryLabelText, 0, 0)
				                Call SalSetWindowText(hWndForm, CurrentLangTable.GetAtomTitle('dlg_BindSet.cTWndTitle'))
				                Call SalMapEnterToTab(TRUE)
				! Разбор параметров
				                Set nBindsNum = GetQueryBindsList(lsBindVars, lsBindSql, cBinds)
				! Диалог
				                If nBindsNum > 0
					! Установка умолч. значений параметров
					                If lsDefVars
						                Call cPar.SetParams(lsDefVars)
						                Set i = 0
						                While i < nBindsNum
							                If cPar.IndexOf(cBinds[i].sName) >= 0
								                Set cBinds[i].sVal = cPar.GetAsString(cBinds[i].sName)
								! Set sBinds[i].sSemantic=sBinds[i].sName
								                If At(':sFdat1', cBinds[i].sName) > 0
									                Set cBinds[i].sSemantic = VisStrSubstitute(cBinds[i].sName, ':sFdat1', 'Дата с (за)')
								                If At(':sFdat2', cBinds[i].sName) > 0
									                Set cBinds[i].sSemantic = VisStrSubstitute(cBinds[i].sName, ':sFdat2', 'Дата по')
								! Call Debug(sBinds[i].sName)
							                Set i = i + 1
						                Call cPar.Clear()
					! Вызов диалога
					! If NOT SetQueryBinds(hWndMDI, sBinds, nBindsCount)
						                  Call WaitCursorOff()
						                  Return FALSE
					! Call WaitCursorOn()
				! Добавление параметров переданных в sParams
				                Call SalStrTokenize(sParams, '', ',', InParam)
				                Set sParam = InParam[4]
				                If sParam
					                Call cPar.SetParams(sParam)
					                Set i = 0
					                While i < nBindsNum
						                If cPar.IndexOf(cBinds[i].sName) >= 0
							                Set cBinds[i].sVal = cPar.GetAsString(cBinds[i].sName)
						                Set i = i + 1
				                Call WaitCursorOff()
				                Call SalSendMsg(tblBinds, UM_Populate, 0, 0)
			                On SAM_Destroy
				                Call SalMapEnterToTab(FALSE)
	! Table Window: tbl_BindSQL
.winattr
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  8.567"
				Width Editable? Yes
				Height: 3.429"
				Height Editable? Yes
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
			View: Table
			Allow Row Sizing? Yes
			Lines Per Row: Default
		Memory Settings
			Maximum Rows in Memory: 30000
			Discardable? Yes
.end
		                Description: 
		                Named Menus 
		                Menu 
		                Tool Bar 
			                Contents 
		                Contents 
		                Functions 
		                Window Parameters 
			                : param
		                Window Variables 
			                Number: nRow
			                Number: i
			                String: sParamSql
			!
			                String: sReferenceTitle   ! Наименование справочника
			                String: sReferenceName    ! Имя таблицы для справочника
			                String: sKeyName  ! Ключ справочника, значение которого пойдет  в значение параметра
			                String: sWHEREClause      ! WHERE условие для справочника
			                String: sColumnList       ! Список колонок, которые показывать в справочнике
			!
			                Number: nTabId            ! Номер таб
			                Number: nKeyColId         ! Номер поля ключа
			                String: sColTitle         ! Наименование колонки
			                String: saColTitle[*]     ! Наименование колонки
			                Window Handle: hColumn
			                String: sColName          ! имя колонки таблицы
			                Number: nColWidth         ! визуальная ширина колонки
			                Number: naColWidth[*]
			                Number: nColNum           ! количество колонок
			!
			                String: sTmp
		                Message Actions 
			                On SAM_Create
				                Call SalCenterWindow ( hWndForm )
				                Call SetWindowFont( hWndForm )
				                Call SalSendMsgToChildren( hWndForm, UM_QueryLabelText, 0, 0 )
				!
				! имя справочника
				                Set i=SalStrScan ( param.sDescSQL, '|' )
				                Set sReferenceName=SalStrLeftX(param.sDescSQL, i)
				!
				! имя ключа, которое должно быть подставлено в параметр(ключ)
				                Set sTmp=SalStrRightX(param.sDescSQL, SalStrLength(param.sDescSQL) - i - 1)
				                Set i=SalStrScan ( sTmp, '|' )
				                If i<0
					                Set sKeyName= sTmp
				                Else 
					                Set sKeyName= SalStrLeftX(sTmp, i)
					!
					! список полей
					                Set sTmp=SalStrRightX(sTmp, SalStrLength(sTmp) - i - 1)
					                Set i=SalStrScan ( sTmp, '|' )
					                If i < 0
						                Set sColumnList= sTmp
					                Else 
						                Set sColumnList= SalStrLeftX(sTmp, i)
						!
						! условие WHERE
						                If SalStrLength(sTmp) > SalStrLength(sColumnList)+ 1
							                Set sWHEREClause=SalStrRightX(sTmp, SalStrLength(sTmp) - i - 1)
					!
				! Call Debug('sReferenceName='||sReferenceName||'  sKeyName='||sKeyName||'  sColumnList='||sColumnList||' sWHEREClause='||sWHEREClause)
				! Вытащим наименование справочника
				                Set sParamSql = 'SELECT  semantic, tabid
						                 INTO   :sReferenceTitle, :nTabId
						                 FROM meta_tables
						                 WHERE  tabname=:sReferenceName '
				                If SqlPrepareAndExecute(hSql(), sParamSql)
					                If SqlFetchNext(hSql(), nRow)
						                Call SalSetWindowText ( hWndForm, sReferenceTitle )
						                Set nColNum=0
						                Set sParamSql = 'SELECT  colname,semantic,showwidth
								                 INTO :sColName, :sColTitle, :nColWidth
								                 FROM meta_columns
								                 WHERE  tabid=:nTabId '||
								                   IifS(sColumnList='','',
								                       " AND colname IN ('"||sKeyName||"','"||StrReplaceChr(sColumnList, ",", "','",0)||"') ")||
								                 'ORDER BY showpos'
						! Call Debug(sParamSql)
						                Set nColNum=0
						! Вытащим все колонки
						                If SqlPrepareAndExecute(hSql(), sParamSql)
							                Set sParamSql=''
							                While SqlFetchNext(hSql(), nRow)
								                Set sParamSql = sParamSql ||  IifS (sParamSql='', sColName, ', '||sColName)
								                Set saColTitle[nColNum]=sColTitle
								                Set naColWidth[nColNum]=nColWidth
								! если єто колонка ключа для параметра - запомнить для нее номер
								                If (sColName = sKeyName)
									                Set nKeyColId=nColNum+1
								                Set nColNum=nColNum+1
							                Set sParamSql='SELECT '||sParamSql||' FROM '||sReferenceName ||' '||StrReplaceChr(sWHEREClause,'"',"'",0)
							                If not SalTblPopulate ( hWndForm, hSql(), sParamSql, TBL_FillAll )
								! Call SalMessageBox('Невозможно выполнить население справочника', 'Внимание!',0)
								                Call SalMessageBox(CurrentLangTable.GetAtomTitle('tbl_BindSQL.cTErrNsi'),
										  CurrentLangTable.GetAtomTitle('cTAt'),0)
							!
							                Set i=0
							                While i < nColNum
								                Set hColumn= SalTblGetColumnWindow ( hWndForm, i+1, COL_GetPos)
								                Call SalTblSetColumnTitle ( hColumn, saColTitle[i] )
								                Call SalTblSetColumnWidth( hColumn, naColWidth[i] )
								                Call SalTblSetColumnFlags (
										   SalTblGetColumnWindow ( hWndForm, i+1, COL_GetID ),
										   COL_Editable, FALSE )
								                Set i=i+1
					                Else 
						! Call SalMessageBox('Справочник '||sReferenceName||' не описан в Базе Мета Данных', 'Внимание!', 0)
						                Call SalMessageBox(CurrentLangTable.GetAtomTitle('tbl_BindSQL.cTNsi') || ' ' || sReferenceName || ' ' ||
								  CurrentLangTable.GetAtomTitle('tbl_BindSQL.cTNsiNotBMD'),
								  CurrentLangTable.GetAtomTitle('cTAt'), 0)
						                Call SalDestroyWindow ( hWndForm)
			                On SAM_DoubleClick
				                Call SalTblGetColumnText ( hWndForm, nKeyColId, sKeyName )
				                Set dlgBindSet.tblBinds.colVal=sKeyName
				                Set param.sVal=sKeyName
				                Call SalDestroyWindow ( hWndForm)
	Form Window: frm_FastReport
		Class:
		Property Template:
		Class DLL Name:
		Title:
		Icon File:
		Accesories Enabled? No
		Visible? Yes
		Display Settings
			Display Style? Default
			Visible at Design time? Yes
			Automatically Created at Runtime? Yes
			Initial State: Normal
			Maximizable? Yes
			Minimizable? Yes
			System Menu? Yes
			Resizable? Yes
			Window Location and Size
				Left:   Default
				Top:    Default
				Width:  3.017"
				Width Editable? Yes
				Height: 0.738"
				Height Editable? Yes
			Form Size
				Width:  Default
				Height: Default
				Number of Pages: Dynamic
			Font Name: Default
			Font Size: Default
			Font Enhancement: Default
			Text Color: Default
			Background Color: Default
		Description:
		Named Menus
		Menu
		Tool Bar
			Display Settings
				Display Style? Default
				Location? Top
				Visible? Yes
				Size: Default
				Size Editable? Yes
				Font Name: Default
				Font Size: Default
				Font Enhancement: Default
				Text Color: Default
				Background Color: Default
			Contents
		Contents
		Functions
		Window Parameters
			Number: nReportId
			String: sTemplate
		Window Variables
			String: sTemplatePath
		Message Actions
			On SAM_Create
				!
				Call SalHideWindow(frm_Out.cCalendarFrom)
				Call SalHideWindow(frm_Out.cCalendarTo)
				Call SalWaitCursor(FALSE)
				Set sTemplatePath = GetTemplateDir() || "\\" || sTemplate
				Call PrintTemplate(SqlDatabase,SqlUser,SqlPassword, sTemplatePath )
				Call SalDestroyWindow(hWndForm) 
